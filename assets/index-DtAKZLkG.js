var iM=Object.defineProperty;var nM=(B,_,T)=>_ in B?iM(B,_,{enumerable:!0,configurable:!0,writable:!0,value:T}):B[_]=T;var sM=(B,_)=>()=>(_||B((_={exports:{}}).exports,_),_.exports);var Gn=(B,_,T)=>(nM(B,typeof _!="symbol"?_+"":_,T),T);var oM=sM(exports=>{(function(){const _=document.createElement("link").relList;if(_&&_.supports&&_.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))E(W);new MutationObserver(W=>{for(const X of W)if(X.type==="childList")for(const q of X.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&E(q)}).observe(document,{childList:!0,subtree:!0});function T(W){const X={};return W.integrity&&(X.integrity=W.integrity),W.referrerPolicy&&(X.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?X.credentials="include":W.crossOrigin==="anonymous"?X.credentials="omit":X.credentials="same-origin",X}function E(W){if(W.ep)return;W.ep=!0;const X=T(W);fetch(W.href,X)}})();/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function makeMap(B,_){const T=new Set(B.split(","));return E=>T.has(E)}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=B=>B.charCodeAt(0)===111&&B.charCodeAt(1)===110&&(B.charCodeAt(2)>122||B.charCodeAt(2)<97),isModelListener=B=>B.startsWith("onUpdate:"),extend$1=Object.assign,remove$2=(B,_)=>{const T=B.indexOf(_);T>-1&&B.splice(T,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn$2=(B,_)=>hasOwnProperty$1.call(B,_),isArray$4=Array.isArray,isMap$1=B=>toTypeString(B)==="[object Map]",isSet$1=B=>toTypeString(B)==="[object Set]",isDate$1=B=>toTypeString(B)==="[object Date]",isRegExp$2=B=>toTypeString(B)==="[object RegExp]",isFunction=B=>typeof B=="function",isString$1=B=>typeof B=="string",isSymbol$1=B=>typeof B=="symbol",isObject$3=B=>B!==null&&typeof B=="object",isPromise=B=>(isObject$3(B)||isFunction(B))&&isFunction(B.then)&&isFunction(B.catch),objectToString$1=Object.prototype.toString,toTypeString=B=>objectToString$1.call(B),toRawType=B=>toTypeString(B).slice(8,-1),isPlainObject=B=>toTypeString(B)==="[object Object]",isIntegerKey=B=>isString$1(B)&&B!=="NaN"&&B[0]!=="-"&&""+parseInt(B,10)===B,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=B=>{const _=Object.create(null);return T=>_[T]||(_[T]=B(T))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(B=>B.replace(camelizeRE,(_,T)=>T?T.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(B=>B.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(B=>B.charAt(0).toUpperCase()+B.slice(1)),toHandlerKey=cacheStringFunction(B=>B?`on${capitalize(B)}`:""),hasChanged=(B,_)=>!Object.is(B,_),invokeArrayFns=(B,_)=>{for(let T=0;T<B.length;T++)B[T](_)},def=(B,_,T,E=!1)=>{Object.defineProperty(B,_,{configurable:!0,enumerable:!1,writable:E,value:T})},looseToNumber=B=>{const _=parseFloat(B);return isNaN(_)?B:_},toNumber=B=>{const _=isString$1(B)?Number(B):NaN;return isNaN(_)?B:_};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),GLOBALS_ALLOWED="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error",isGloballyAllowed=makeMap(GLOBALS_ALLOWED);function normalizeStyle(B){if(isArray$4(B)){const _={};for(let T=0;T<B.length;T++){const E=B[T],W=isString$1(E)?parseStringStyle(E):normalizeStyle(E);if(W)for(const X in W)_[X]=W[X]}return _}else if(isString$1(B)||isObject$3(B))return B}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(B){const _={};return B.replace(styleCommentRE,"").split(listDelimiterRE).forEach(T=>{if(T){const E=T.split(propertyDelimiterRE);E.length>1&&(_[E[0].trim()]=E[1].trim())}}),_}function normalizeClass(B){let _="";if(isString$1(B))_=B;else if(isArray$4(B))for(let T=0;T<B.length;T++){const E=normalizeClass(B[T]);E&&(_+=E+" ")}else if(isObject$3(B))for(const T in B)B[T]&&(_+=T+" ");return _.trim()}function normalizeProps(B){if(!B)return null;let{class:_,style:T}=B;return _&&!isString$1(_)&&(B.class=normalizeClass(_)),T&&(B.style=normalizeStyle(T)),B}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(B){return!!B||B===""}function looseCompareArrays(B,_){if(B.length!==_.length)return!1;let T=!0;for(let E=0;T&&E<B.length;E++)T=looseEqual(B[E],_[E]);return T}function looseEqual(B,_){if(B===_)return!0;let T=isDate$1(B),E=isDate$1(_);if(T||E)return T&&E?B.getTime()===_.getTime():!1;if(T=isSymbol$1(B),E=isSymbol$1(_),T||E)return B===_;if(T=isArray$4(B),E=isArray$4(_),T||E)return T&&E?looseCompareArrays(B,_):!1;if(T=isObject$3(B),E=isObject$3(_),T||E){if(!T||!E)return!1;const W=Object.keys(B).length,X=Object.keys(_).length;if(W!==X)return!1;for(const q in B){const Y=B.hasOwnProperty(q),te=_.hasOwnProperty(q);if(Y&&!te||!Y&&te||!looseEqual(B[q],_[q]))return!1}}return String(B)===String(_)}function looseIndexOf(B,_){return B.findIndex(T=>looseEqual(T,_))}const toDisplayString=B=>isString$1(B)?B:B==null?"":isArray$4(B)||isObject$3(B)&&(B.toString===objectToString$1||!isFunction(B.toString))?JSON.stringify(B,replacer,2):String(B),replacer=(B,_)=>_&&_.__v_isRef?replacer(B,_.value):isMap$1(_)?{[`Map(${_.size})`]:[..._.entries()].reduce((T,[E,W],X)=>(T[stringifySymbol(E,X)+" =>"]=W,T),{})}:isSet$1(_)?{[`Set(${_.size})`]:[..._.values()].map(T=>stringifySymbol(T))}:isSymbol$1(_)?stringifySymbol(_):isObject$3(_)&&!isArray$4(_)&&!isPlainObject(_)?String(_):_,stringifySymbol=(B,_="")=>{var T;return isSymbol$1(B)?`Symbol(${(T=B.description)!=null?T:_})`:B};/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(_=!1){this.detached=_,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!_&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(_){if(this._active){const T=activeEffectScope;try{return activeEffectScope=this,_()}finally{activeEffectScope=T}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(_){if(this._active){let T,E;for(T=0,E=this.effects.length;T<E;T++)this.effects[T].stop();for(T=0,E=this.cleanups.length;T<E;T++)this.cleanups[T]();if(this.scopes)for(T=0,E=this.scopes.length;T<E;T++)this.scopes[T].stop(!0);if(!this.detached&&this.parent&&!_){const W=this.parent.scopes.pop();W&&W!==this&&(this.parent.scopes[this.index]=W,W.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(B){return new EffectScope(B)}function recordEffectScope(B,_=activeEffectScope){_&&_.active&&_.effects.push(B)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(B){activeEffectScope&&activeEffectScope.cleanups.push(B)}let activeEffect;class ReactiveEffect{constructor(_,T,E,W){this.fn=_,this.trigger=T,this.scheduler=E,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,recordEffectScope(this,W)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pauseTracking();for(let _=0;_<this._depsLength;_++){const T=this.deps[_];if(T.computed&&(triggerComputed(T.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),resetTracking()}return this._dirtyLevel>=4}set dirty(_){this._dirtyLevel=_?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let _=shouldTrack,T=activeEffect;try{return shouldTrack=!0,activeEffect=this,this._runnings++,preCleanupEffect(this),this.fn()}finally{postCleanupEffect(this),this._runnings--,activeEffect=T,shouldTrack=_}}stop(){this.active&&(preCleanupEffect(this),postCleanupEffect(this),this.onStop&&this.onStop(),this.active=!1)}}function triggerComputed(B){return B.value}function preCleanupEffect(B){B._trackId++,B._depsLength=0}function postCleanupEffect(B){if(B.deps.length>B._depsLength){for(let _=B._depsLength;_<B.deps.length;_++)cleanupDepEffect(B.deps[_],B);B.deps.length=B._depsLength}}function cleanupDepEffect(B,_){const T=B.get(_);T!==void 0&&_._trackId!==T&&(B.delete(_),B.size===0&&B.cleanup())}function effect(B,_){B.effect instanceof ReactiveEffect&&(B=B.effect.fn);const T=new ReactiveEffect(B,NOOP,()=>{T.dirty&&T.run()});_&&(extend$1(T,_),_.scope&&recordEffectScope(T,_.scope)),(!_||!_.lazy)&&T.run();const E=T.run.bind(T);return E.effect=T,E}function stop(B){B.effect.stop()}let shouldTrack=!0,pauseScheduleStack=0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const B=trackStack.pop();shouldTrack=B===void 0?!0:B}function pauseScheduling(){pauseScheduleStack++}function resetScheduling(){for(pauseScheduleStack--;!pauseScheduleStack&&queueEffectSchedulers.length;)queueEffectSchedulers.shift()()}function trackEffect(B,_,T){if(_.get(B)!==B._trackId){_.set(B,B._trackId);const E=B.deps[B._depsLength];E!==_?(E&&cleanupDepEffect(E,B),B.deps[B._depsLength++]=_):B._depsLength++}}const queueEffectSchedulers=[];function triggerEffects(B,_,T){pauseScheduling();for(const E of B.keys()){let W;E._dirtyLevel<_&&(W??(W=B.get(E)===E._trackId))&&(E._shouldSchedule||(E._shouldSchedule=E._dirtyLevel===0),E._dirtyLevel=_),E._shouldSchedule&&(W??(W=B.get(E)===E._trackId))&&(E.trigger(),(!E._runnings||E.allowRecurse)&&E._dirtyLevel!==2&&(E._shouldSchedule=!1,E.scheduler&&queueEffectSchedulers.push(E.scheduler)))}resetScheduling()}const createDep=(B,_)=>{const T=new Map;return T.cleanup=B,T.computed=_,T},targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");function track(B,_,T){if(shouldTrack&&activeEffect){let E=targetMap.get(B);E||targetMap.set(B,E=new Map);let W=E.get(T);W||E.set(T,W=createDep(()=>E.delete(T))),trackEffect(activeEffect,W)}}function trigger(B,_,T,E,W,X){const q=targetMap.get(B);if(!q)return;let Y=[];if(_==="clear")Y=[...q.values()];else if(T==="length"&&isArray$4(B)){const te=Number(E);q.forEach((ne,ae)=>{(ae==="length"||!isSymbol$1(ae)&&ae>=te)&&Y.push(ne)})}else switch(T!==void 0&&Y.push(q.get(T)),_){case"add":isArray$4(B)?isIntegerKey(T)&&Y.push(q.get("length")):(Y.push(q.get(ITERATE_KEY)),isMap$1(B)&&Y.push(q.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$4(B)||(Y.push(q.get(ITERATE_KEY)),isMap$1(B)&&Y.push(q.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap$1(B)&&Y.push(q.get(ITERATE_KEY));break}pauseScheduling();for(const te of Y)te&&triggerEffects(te,4);resetScheduling()}function getDepFromReactive(B,_){const T=targetMap.get(B);return T&&T.get(_)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(B=>B!=="arguments"&&B!=="caller").map(B=>Symbol[B]).filter(isSymbol$1)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const B={};return["includes","indexOf","lastIndexOf"].forEach(_=>{B[_]=function(...T){const E=toRaw(this);for(let X=0,q=this.length;X<q;X++)track(E,"get",X+"");const W=E[_](...T);return W===-1||W===!1?E[_](...T.map(toRaw)):W}}),["push","pop","shift","unshift","splice"].forEach(_=>{B[_]=function(...T){pauseTracking(),pauseScheduling();const E=toRaw(this)[_].apply(this,T);return resetScheduling(),resetTracking(),E}}),B}function hasOwnProperty(B){isSymbol$1(B)||(B=String(B));const _=toRaw(this);return track(_,"has",B),_.hasOwnProperty(B)}class BaseReactiveHandler{constructor(_=!1,T=!1){this._isReadonly=_,this._isShallow=T}get(_,T,E){const W=this._isReadonly,X=this._isShallow;if(T==="__v_isReactive")return!W;if(T==="__v_isReadonly")return W;if(T==="__v_isShallow")return X;if(T==="__v_raw")return E===(W?X?shallowReadonlyMap:readonlyMap:X?shallowReactiveMap:reactiveMap).get(_)||Object.getPrototypeOf(_)===Object.getPrototypeOf(E)?_:void 0;const q=isArray$4(_);if(!W){if(q&&hasOwn$2(arrayInstrumentations,T))return Reflect.get(arrayInstrumentations,T,E);if(T==="hasOwnProperty")return hasOwnProperty}const Y=Reflect.get(_,T,E);return(isSymbol$1(T)?builtInSymbols.has(T):isNonTrackableKeys(T))||(W||track(_,"get",T),X)?Y:isRef(Y)?q&&isIntegerKey(T)?Y:Y.value:isObject$3(Y)?W?readonly(Y):reactive(Y):Y}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(_=!1){super(!1,_)}set(_,T,E,W){let X=_[T];if(!this._isShallow){const te=isReadonly(X);if(!isShallow(E)&&!isReadonly(E)&&(X=toRaw(X),E=toRaw(E)),!isArray$4(_)&&isRef(X)&&!isRef(E))return te?!1:(X.value=E,!0)}const q=isArray$4(_)&&isIntegerKey(T)?Number(T)<_.length:hasOwn$2(_,T),Y=Reflect.set(_,T,E,W);return _===toRaw(W)&&(q?hasChanged(E,X)&&trigger(_,"set",T,E):trigger(_,"add",T,E)),Y}deleteProperty(_,T){const E=hasOwn$2(_,T);_[T];const W=Reflect.deleteProperty(_,T);return W&&E&&trigger(_,"delete",T,void 0),W}has(_,T){const E=Reflect.has(_,T);return(!isSymbol$1(T)||!builtInSymbols.has(T))&&track(_,"has",T),E}ownKeys(_){return track(_,"iterate",isArray$4(_)?"length":ITERATE_KEY),Reflect.ownKeys(_)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(_=!1){super(!0,_)}set(_,T){return!0}deleteProperty(_,T){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),shallowReadonlyHandlers=new ReadonlyReactiveHandler(!0),toShallow=B=>B,getProto$2=B=>Reflect.getPrototypeOf(B);function get$1(B,_,T=!1,E=!1){B=B.__v_raw;const W=toRaw(B),X=toRaw(_);T||(hasChanged(_,X)&&track(W,"get",_),track(W,"get",X));const{has:q}=getProto$2(W),Y=E?toShallow:T?toReadonly:toReactive;if(q.call(W,_))return Y(B.get(_));if(q.call(W,X))return Y(B.get(X));B!==W&&B.get(_)}function has$4(B,_=!1){const T=this.__v_raw,E=toRaw(T),W=toRaw(B);return _||(hasChanged(B,W)&&track(E,"has",B),track(E,"has",W)),B===W?T.has(B):T.has(B)||T.has(W)}function size(B,_=!1){return B=B.__v_raw,!_&&track(toRaw(B),"iterate",ITERATE_KEY),Reflect.get(B,"size",B)}function add$2(B){B=toRaw(B);const _=toRaw(this);return getProto$2(_).has.call(_,B)||(_.add(B),trigger(_,"add",B,B)),this}function set(B,_){_=toRaw(_);const T=toRaw(this),{has:E,get:W}=getProto$2(T);let X=E.call(T,B);X||(B=toRaw(B),X=E.call(T,B));const q=W.call(T,B);return T.set(B,_),X?hasChanged(_,q)&&trigger(T,"set",B,_):trigger(T,"add",B,_),this}function deleteEntry(B){const _=toRaw(this),{has:T,get:E}=getProto$2(_);let W=T.call(_,B);W||(B=toRaw(B),W=T.call(_,B)),E&&E.call(_,B);const X=_.delete(B);return W&&trigger(_,"delete",B,void 0),X}function clear(){const B=toRaw(this),_=B.size!==0,T=B.clear();return _&&trigger(B,"clear",void 0,void 0),T}function createForEach(B,_){return function(E,W){const X=this,q=X.__v_raw,Y=toRaw(q),te=_?toShallow:B?toReadonly:toReactive;return!B&&track(Y,"iterate",ITERATE_KEY),q.forEach((ne,ae)=>E.call(W,te(ne),te(ae),X))}}function createIterableMethod(B,_,T){return function(...E){const W=this.__v_raw,X=toRaw(W),q=isMap$1(X),Y=B==="entries"||B===Symbol.iterator&&q,te=B==="keys"&&q,ne=W[B](...E),ae=T?toShallow:_?toReadonly:toReactive;return!_&&track(X,"iterate",te?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:le,done:ue}=ne.next();return ue?{value:le,done:ue}:{value:Y?[ae(le[0]),ae(le[1])]:ae(le),done:ue}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(B){return function(..._){return B==="delete"?!1:B==="clear"?void 0:this}}function createInstrumentations(){const B={get(X){return get$1(this,X)},get size(){return size(this)},has:has$4,add:add$2,set,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},_={get(X){return get$1(this,X,!1,!0)},get size(){return size(this)},has:has$4,add:add$2,set,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},T={get(X){return get$1(this,X,!0)},get size(){return size(this,!0)},has(X){return has$4.call(this,X,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},E={get(X){return get$1(this,X,!0,!0)},get size(){return size(this,!0)},has(X){return has$4.call(this,X,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(X=>{B[X]=createIterableMethod(X,!1,!1),T[X]=createIterableMethod(X,!0,!1),_[X]=createIterableMethod(X,!1,!0),E[X]=createIterableMethod(X,!0,!0)}),[B,T,_,E]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(B,_){const T=_?B?shallowReadonlyInstrumentations:shallowInstrumentations:B?readonlyInstrumentations:mutableInstrumentations;return(E,W,X)=>W==="__v_isReactive"?!B:W==="__v_isReadonly"?B:W==="__v_raw"?E:Reflect.get(hasOwn$2(T,W)&&W in E?T:E,W,X)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},shallowReadonlyCollectionHandlers={get:createInstrumentationGetter(!0,!0)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(B){switch(B){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(B){return B.__v_skip||!Object.isExtensible(B)?0:targetTypeMap(toRawType(B))}function reactive(B){return isReadonly(B)?B:createReactiveObject(B,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(B){return createReactiveObject(B,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(B){return createReactiveObject(B,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function shallowReadonly(B){return createReactiveObject(B,!0,shallowReadonlyHandlers,shallowReadonlyCollectionHandlers,shallowReadonlyMap)}function createReactiveObject(B,_,T,E,W){if(!isObject$3(B)||B.__v_raw&&!(_&&B.__v_isReactive))return B;const X=W.get(B);if(X)return X;const q=getTargetType(B);if(q===0)return B;const Y=new Proxy(B,q===2?E:T);return W.set(B,Y),Y}function isReactive(B){return isReadonly(B)?isReactive(B.__v_raw):!!(B&&B.__v_isReactive)}function isReadonly(B){return!!(B&&B.__v_isReadonly)}function isShallow(B){return!!(B&&B.__v_isShallow)}function isProxy(B){return B?!!B.__v_raw:!1}function toRaw(B){const _=B&&B.__v_raw;return _?toRaw(_):B}function markRaw(B){return Object.isExtensible(B)&&def(B,"__v_skip",!0),B}const toReactive=B=>isObject$3(B)?reactive(B):B,toReadonly=B=>isObject$3(B)?readonly(B):B;class ComputedRefImpl{constructor(_,T,E,W){this.getter=_,this._setter=T,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ReactiveEffect(()=>_(this._value),()=>triggerRefValue(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!W,this.__v_isReadonly=E}get value(){const _=toRaw(this);return(!_._cacheable||_.effect.dirty)&&hasChanged(_._value,_._value=_.effect.run())&&triggerRefValue(_,4),trackRefValue(_),_.effect._dirtyLevel>=2&&triggerRefValue(_,2),_._value}set value(_){this._setter(_)}get _dirty(){return this.effect.dirty}set _dirty(_){this.effect.dirty=_}}function computed$1(B,_,T=!1){let E,W;const X=isFunction(B);return X?(E=B,W=NOOP):(E=B.get,W=B.set),new ComputedRefImpl(E,W,X||!W,T)}function trackRefValue(B){var _;shouldTrack&&activeEffect&&(B=toRaw(B),trackEffect(activeEffect,(_=B.dep)!=null?_:B.dep=createDep(()=>B.dep=void 0,B instanceof ComputedRefImpl?B:void 0)))}function triggerRefValue(B,_=4,T){B=toRaw(B);const E=B.dep;E&&triggerEffects(E,_)}function isRef(B){return!!(B&&B.__v_isRef===!0)}function ref$1(B){return createRef(B,!1)}function shallowRef(B){return createRef(B,!0)}function createRef(B,_){return isRef(B)?B:new RefImpl(B,_)}class RefImpl{constructor(_,T){this.__v_isShallow=T,this.dep=void 0,this.__v_isRef=!0,this._rawValue=T?_:toRaw(_),this._value=T?_:toReactive(_)}get value(){return trackRefValue(this),this._value}set value(_){const T=this.__v_isShallow||isShallow(_)||isReadonly(_);_=T?_:toRaw(_),hasChanged(_,this._rawValue)&&(this._rawValue=_,this._value=T?_:toReactive(_),triggerRefValue(this,4))}}function triggerRef(B){triggerRefValue(B,4)}function unref(B){return isRef(B)?B.value:B}function toValue$1(B){return isFunction(B)?B():unref(B)}const shallowUnwrapHandlers={get:(B,_,T)=>unref(Reflect.get(B,_,T)),set:(B,_,T,E)=>{const W=B[_];return isRef(W)&&!isRef(T)?(W.value=T,!0):Reflect.set(B,_,T,E)}};function proxyRefs(B){return isReactive(B)?B:new Proxy(B,shallowUnwrapHandlers)}class CustomRefImpl{constructor(_){this.dep=void 0,this.__v_isRef=!0;const{get:T,set:E}=_(()=>trackRefValue(this),()=>triggerRefValue(this));this._get=T,this._set=E}get value(){return this._get()}set value(_){this._set(_)}}function customRef(B){return new CustomRefImpl(B)}function toRefs$1(B){const _=isArray$4(B)?new Array(B.length):{};for(const T in B)_[T]=propertyToRef(B,T);return _}class ObjectRefImpl{constructor(_,T,E){this._object=_,this._key=T,this._defaultValue=E,this.__v_isRef=!0}get value(){const _=this._object[this._key];return _===void 0?this._defaultValue:_}set value(_){this._object[this._key]=_}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(_){this._getter=_,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(B,_,T){return isRef(B)?B:isFunction(B)?new GetterRefImpl(B):isObject$3(B)&&arguments.length>1?propertyToRef(B,_,T):ref$1(B)}function propertyToRef(B,_,T){const E=B[_];return isRef(E)?E:new ObjectRefImpl(B,_,T)}const TrackOpTypes={GET:"get",HAS:"has",ITERATE:"iterate"},TriggerOpTypes={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"};/**
* @vue/runtime-core v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];function warn$1(B,..._){pauseTracking();const T=stack.length?stack[stack.length-1].component:null,E=T&&T.appContext.config.warnHandler,W=getComponentTrace();if(E)callWithErrorHandling(E,T,11,[B+_.map(X=>{var q,Y;return(Y=(q=X.toString)==null?void 0:q.call(X))!=null?Y:JSON.stringify(X)}).join(""),T&&T.proxy,W.map(({vnode:X})=>`at <${formatComponentName(T,X.type)}>`).join(`
`),W]);else{const X=[`[Vue warn]: ${B}`,..._];W.length&&X.push(`
`,...formatTrace(W)),console.warn(...X)}resetTracking()}function getComponentTrace(){let B=stack[stack.length-1];if(!B)return[];const _=[];for(;B;){const T=_[0];T&&T.vnode===B?T.recurseCount++:_.push({vnode:B,recurseCount:0});const E=B.component&&B.component.parent;B=E&&E.vnode}return _}function formatTrace(B){const _=[];return B.forEach((T,E)=>{_.push(...E===0?[]:[`
`],...formatTraceEntry(T))}),_}function formatTraceEntry({vnode:B,recurseCount:_}){const T=_>0?`... (${_} recursive calls)`:"",E=B.component?B.component.parent==null:!1,W=` at <${formatComponentName(B.component,B.type,E)}`,X=">"+T;return B.props?[W,...formatProps(B.props),X]:[W+X]}function formatProps(B){const _=[],T=Object.keys(B);return T.slice(0,3).forEach(E=>{_.push(...formatProp(E,B[E]))}),T.length>3&&_.push(" ..."),_}function formatProp(B,_,T){return isString$1(_)?(_=JSON.stringify(_),T?_:[`${B}=${_}`]):typeof _=="number"||typeof _=="boolean"||_==null?T?_:[`${B}=${_}`]:isRef(_)?(_=formatProp(B,toRaw(_.value),!0),T?_:[`${B}=Ref<`,_,">"]):isFunction(_)?[`${B}=fn${_.name?`<${_.name}>`:""}`]:(_=toRaw(_),T?_:[`${B}=`,_])}function assertNumber(B,_){}const ErrorCodes={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",WATCH_GETTER:2,2:"WATCH_GETTER",WATCH_CALLBACK:3,3:"WATCH_CALLBACK",WATCH_CLEANUP:4,4:"WATCH_CLEANUP",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER"},ErrorTypeStrings$1={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://github.com/vuejs/core ."};function callWithErrorHandling(B,_,T,E){try{return E?B(...E):B()}catch(W){handleError(W,_,T)}}function callWithAsyncErrorHandling(B,_,T,E){if(isFunction(B)){const W=callWithErrorHandling(B,_,T,E);return W&&isPromise(W)&&W.catch(X=>{handleError(X,_,T)}),W}if(isArray$4(B)){const W=[];for(let X=0;X<B.length;X++)W.push(callWithAsyncErrorHandling(B[X],_,T,E));return W}}function handleError(B,_,T,E=!0){const W=_?_.vnode:null;if(_){let X=_.parent;const q=_.proxy,Y=`https://vuejs.org/error-reference/#runtime-${T}`;for(;X;){const ne=X.ec;if(ne){for(let ae=0;ae<ne.length;ae++)if(ne[ae](B,q,Y)===!1)return}X=X.parent}const te=_.appContext.config.errorHandler;if(te){pauseTracking(),callWithErrorHandling(te,null,10,[B,q,Y]),resetTracking();return}}logError(B,T,W,E)}function logError(B,_,T,E=!0){console.error(B)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(B){const _=currentFlushPromise||resolvedPromise;return B?_.then(this?B.bind(this):B):_}function findInsertionIndex(B){let _=flushIndex+1,T=queue.length;for(;_<T;){const E=_+T>>>1,W=queue[E],X=getId(W);X<B||X===B&&W.pre?_=E+1:T=E}return _}function queueJob(B){(!queue.length||!queue.includes(B,isFlushing&&B.allowRecurse?flushIndex+1:flushIndex))&&(B.id==null?queue.push(B):queue.splice(findInsertionIndex(B.id),0,B),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(B){const _=queue.indexOf(B);_>flushIndex&&queue.splice(_,1)}function queuePostFlushCb(B){isArray$4(B)?pendingPostFlushCbs.push(...B):(!activePostFlushCbs||!activePostFlushCbs.includes(B,B.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(B),queueFlush()}function flushPreFlushCbs(B,_,T=isFlushing?flushIndex+1:0){for(;T<queue.length;T++){const E=queue[T];if(E&&E.pre){if(B&&E.id!==B.uid)continue;queue.splice(T,1),T--,E()}}}function flushPostFlushCbs(B){if(pendingPostFlushCbs.length){const _=[...new Set(pendingPostFlushCbs)].sort((T,E)=>getId(T)-getId(E));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(..._);return}for(activePostFlushCbs=_,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=B=>B.id==null?1/0:B.id,comparator=(B,_)=>{const T=getId(B)-getId(_);if(T===0){if(B.pre&&!_.pre)return-1;if(_.pre&&!B.pre)return 1}return T};function flushJobs(B){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const _=queue[flushIndex];_&&_.active!==!1&&callWithErrorHandling(_,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}let devtools$1,buffer=[];function setDevtoolsHook$1(B,_){var T,E;devtools$1=B,devtools$1?(devtools$1.enabled=!0,buffer.forEach(({event:W,args:X})=>devtools$1.emit(W,...X)),buffer=[]):typeof window<"u"&&window.HTMLElement&&!((E=(T=window.navigator)==null?void 0:T.userAgent)!=null&&E.includes("jsdom"))?((_.__VUE_DEVTOOLS_HOOK_REPLAY__=_.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(X=>{setDevtoolsHook$1(X,_)}),setTimeout(()=>{devtools$1||(_.__VUE_DEVTOOLS_HOOK_REPLAY__=null,buffer=[])},3e3)):buffer=[]}function emit(B,_,...T){if(B.isUnmounted)return;const E=B.vnode.props||EMPTY_OBJ;let W=T;const X=_.startsWith("update:"),q=X&&_.slice(7);if(q&&q in E){const ae=`${q==="modelValue"?"model":q}Modifiers`,{number:le,trim:ue}=E[ae]||EMPTY_OBJ;ue&&(W=T.map(ge=>isString$1(ge)?ge.trim():ge)),le&&(W=T.map(looseToNumber))}let Y,te=E[Y=toHandlerKey(_)]||E[Y=toHandlerKey(camelize(_))];!te&&X&&(te=E[Y=toHandlerKey(hyphenate(_))]),te&&callWithAsyncErrorHandling(te,B,6,W);const ne=E[Y+"Once"];if(ne){if(!B.emitted)B.emitted={};else if(B.emitted[Y])return;B.emitted[Y]=!0,callWithAsyncErrorHandling(ne,B,6,W)}}function normalizeEmitsOptions(B,_,T=!1){const E=_.emitsCache,W=E.get(B);if(W!==void 0)return W;const X=B.emits;let q={},Y=!1;if(!isFunction(B)){const te=ne=>{const ae=normalizeEmitsOptions(ne,_,!0);ae&&(Y=!0,extend$1(q,ae))};!T&&_.mixins.length&&_.mixins.forEach(te),B.extends&&te(B.extends),B.mixins&&B.mixins.forEach(te)}return!X&&!Y?(isObject$3(B)&&E.set(B,null),null):(isArray$4(X)?X.forEach(te=>q[te]=null):extend$1(q,X),isObject$3(B)&&E.set(B,q),q)}function isEmitListener(B,_){return!B||!isOn(_)?!1:(_=_.slice(2).replace(/Once$/,""),hasOwn$2(B,_[0].toLowerCase()+_.slice(1))||hasOwn$2(B,hyphenate(_))||hasOwn$2(B,_))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(B){const _=currentRenderingInstance;return currentRenderingInstance=B,currentScopeId=B&&B.type.__scopeId||null,_}function pushScopeId(B){currentScopeId=B}function popScopeId(){currentScopeId=null}const withScopeId=B=>withCtx;function withCtx(B,_=currentRenderingInstance,T){if(!_||B._n)return B;const E=(...W)=>{E._d&&setBlockTracking(-1);const X=setCurrentRenderingInstance(_);let q;try{q=B(...W)}finally{setCurrentRenderingInstance(X),E._d&&setBlockTracking(1)}return q};return E._n=!0,E._c=!0,E._d=!0,E}function markAttrsAccessed(){}function renderComponentRoot(B){const{type:_,vnode:T,proxy:E,withProxy:W,propsOptions:[X],slots:q,attrs:Y,emit:te,render:ne,renderCache:ae,props:le,data:ue,setupState:ge,ctx:ye,inheritAttrs:xe}=B,Te=setCurrentRenderingInstance(B);let Ae,Ie;try{if(T.shapeFlag&4){const $e=W||E,We=$e;Ae=normalizeVNode(ne.call(We,$e,ae,le,ge,ue,ye)),Ie=Y}else{const $e=_;Ae=normalizeVNode($e.length>1?$e(le,{attrs:Y,slots:q,emit:te}):$e(le,null)),Ie=_.props?Y:getFunctionalFallthrough(Y)}}catch($e){blockStack.length=0,handleError($e,B,1),Ae=createVNode(Comment)}let Ve=Ae;if(Ie&&xe!==!1){const $e=Object.keys(Ie),{shapeFlag:We}=Ve;$e.length&&We&7&&(X&&$e.some(isModelListener)&&(Ie=filterModelListeners(Ie,X)),Ve=cloneVNode(Ve,Ie,!1,!0))}return T.dirs&&(Ve=cloneVNode(Ve,null,!1,!0),Ve.dirs=Ve.dirs?Ve.dirs.concat(T.dirs):T.dirs),T.transition&&(Ve.transition=T.transition),Ae=Ve,setCurrentRenderingInstance(Te),Ae}function filterSingleRoot(B,_=!0){let T;for(let E=0;E<B.length;E++){const W=B[E];if(isVNode(W)){if(W.type!==Comment||W.children==="v-if"){if(T)return;T=W}}else return}return T}const getFunctionalFallthrough=B=>{let _;for(const T in B)(T==="class"||T==="style"||isOn(T))&&((_||(_={}))[T]=B[T]);return _},filterModelListeners=(B,_)=>{const T={};for(const E in B)(!isModelListener(E)||!(E.slice(9)in _))&&(T[E]=B[E]);return T};function shouldUpdateComponent(B,_,T){const{props:E,children:W,component:X}=B,{props:q,children:Y,patchFlag:te}=_,ne=X.emitsOptions;if(_.dirs||_.transition)return!0;if(T&&te>=0){if(te&1024)return!0;if(te&16)return E?hasPropsChanged(E,q,ne):!!q;if(te&8){const ae=_.dynamicProps;for(let le=0;le<ae.length;le++){const ue=ae[le];if(q[ue]!==E[ue]&&!isEmitListener(ne,ue))return!0}}}else return(W||Y)&&(!Y||!Y.$stable)?!0:E===q?!1:E?q?hasPropsChanged(E,q,ne):!0:!!q;return!1}function hasPropsChanged(B,_,T){const E=Object.keys(_);if(E.length!==Object.keys(B).length)return!0;for(let W=0;W<E.length;W++){const X=E[W];if(_[X]!==B[X]&&!isEmitListener(T,X))return!0}return!1}function updateHOCHostEl({vnode:B,parent:_},T){for(;_;){const E=_.subTree;if(E.suspense&&E.suspense.activeBranch===B&&(E.el=B.el),E===B)(B=_.vnode).el=T,_=_.parent;else break}}const COMPONENTS="components",DIRECTIVES="directives";function resolveComponent(B,_){return resolveAsset(COMPONENTS,B,!0,_)||B}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(B){return isString$1(B)?resolveAsset(COMPONENTS,B,!1)||B:B||NULL_DYNAMIC_COMPONENT}function resolveDirective(B){return resolveAsset(DIRECTIVES,B)}function resolveAsset(B,_,T=!0,E=!1){const W=currentRenderingInstance||currentInstance;if(W){const X=W.type;if(B===COMPONENTS){const Y=getComponentName(X,!1);if(Y&&(Y===_||Y===camelize(_)||Y===capitalize(camelize(_))))return X}const q=resolve(W[B]||X[B],_)||resolve(W.appContext[B],_);return!q&&E?X:q}}function resolve(B,_){return B&&(B[_]||B[camelize(_)]||B[capitalize(camelize(_))])}const isSuspense=B=>B.__isSuspense;let suspenseId=0;const SuspenseImpl={name:"Suspense",__isSuspense:!0,process(B,_,T,E,W,X,q,Y,te,ne){if(B==null)mountSuspense(_,T,E,W,X,q,Y,te,ne);else{if(X&&X.deps>0&&!B.suspense.isInFallback){_.suspense=B.suspense,_.suspense.vnode=_,_.el=B.el;return}patchSuspense(B,_,T,E,W,q,Y,te,ne)}},hydrate:hydrateSuspense,create:createSuspenseBoundary,normalize:normalizeSuspenseChildren},Suspense=SuspenseImpl;function triggerEvent(B,_){const T=B.props&&B.props[_];isFunction(T)&&T()}function mountSuspense(B,_,T,E,W,X,q,Y,te){const{p:ne,o:{createElement:ae}}=te,le=ae("div"),ue=B.suspense=createSuspenseBoundary(B,W,E,_,le,T,X,q,Y,te);ne(null,ue.pendingBranch=B.ssContent,le,null,E,ue,X,q),ue.deps>0?(triggerEvent(B,"onPending"),triggerEvent(B,"onFallback"),ne(null,B.ssFallback,_,T,E,null,X,q),setActiveBranch(ue,B.ssFallback)):ue.resolve(!1,!0)}function patchSuspense(B,_,T,E,W,X,q,Y,{p:te,um:ne,o:{createElement:ae}}){const le=_.suspense=B.suspense;le.vnode=_,_.el=B.el;const ue=_.ssContent,ge=_.ssFallback,{activeBranch:ye,pendingBranch:xe,isInFallback:Te,isHydrating:Ae}=le;if(xe)le.pendingBranch=ue,isSameVNodeType(ue,xe)?(te(xe,ue,le.hiddenContainer,null,W,le,X,q,Y),le.deps<=0?le.resolve():Te&&(Ae||(te(ye,ge,T,E,W,null,X,q,Y),setActiveBranch(le,ge)))):(le.pendingId=suspenseId++,Ae?(le.isHydrating=!1,le.activeBranch=xe):ne(xe,W,le),le.deps=0,le.effects.length=0,le.hiddenContainer=ae("div"),Te?(te(null,ue,le.hiddenContainer,null,W,le,X,q,Y),le.deps<=0?le.resolve():(te(ye,ge,T,E,W,null,X,q,Y),setActiveBranch(le,ge))):ye&&isSameVNodeType(ue,ye)?(te(ye,ue,T,E,W,le,X,q,Y),le.resolve(!0)):(te(null,ue,le.hiddenContainer,null,W,le,X,q,Y),le.deps<=0&&le.resolve()));else if(ye&&isSameVNodeType(ue,ye))te(ye,ue,T,E,W,le,X,q,Y),setActiveBranch(le,ue);else if(triggerEvent(_,"onPending"),le.pendingBranch=ue,ue.shapeFlag&512?le.pendingId=ue.component.suspenseId:le.pendingId=suspenseId++,te(null,ue,le.hiddenContainer,null,W,le,X,q,Y),le.deps<=0)le.resolve();else{const{timeout:Ie,pendingId:Ve}=le;Ie>0?setTimeout(()=>{le.pendingId===Ve&&le.fallback(ge)},Ie):Ie===0&&le.fallback(ge)}}function createSuspenseBoundary(B,_,T,E,W,X,q,Y,te,ne,ae=!1){const{p:le,m:ue,um:ge,n:ye,o:{parentNode:xe,remove:Te}}=ne;let Ae;const Ie=isVNodeSuspensible(B);Ie&&_&&_.pendingBranch&&(Ae=_.pendingId,_.deps++);const Ve=B.props?toNumber(B.props.timeout):void 0,$e=X,We={vnode:B,parent:_,parentComponent:T,namespace:q,container:E,hiddenContainer:W,deps:0,pendingId:suspenseId++,timeout:typeof Ve=="number"?Ve:-1,activeBranch:null,pendingBranch:null,isInFallback:!ae,isHydrating:ae,isUnmounted:!1,effects:[],resolve(Ue=!1,je=!1){const{vnode:ze,activeBranch:He,pendingBranch:Le,pendingId:qe,effects:Qe,parentComponent:Ke,container:Je}=We;let pt=!1;We.isHydrating?We.isHydrating=!1:Ue||(pt=He&&Le.transition&&Le.transition.mode==="out-in",pt&&(He.transition.afterLeave=()=>{qe===We.pendingId&&(ue(Le,Je,X===$e?ye(He):X,0),queuePostFlushCb(Qe))}),He&&(xe(He.el)!==We.hiddenContainer&&(X=ye(He)),ge(He,Ke,We,!0)),pt||ue(Le,Je,X,0)),setActiveBranch(We,Le),We.pendingBranch=null,We.isInFallback=!1;let ut=We.parent,lt=!1;for(;ut;){if(ut.pendingBranch){ut.effects.push(...Qe),lt=!0;break}ut=ut.parent}!lt&&!pt&&queuePostFlushCb(Qe),We.effects=[],Ie&&_&&_.pendingBranch&&Ae===_.pendingId&&(_.deps--,_.deps===0&&!je&&_.resolve()),triggerEvent(ze,"onResolve")},fallback(Ue){if(!We.pendingBranch)return;const{vnode:je,activeBranch:ze,parentComponent:He,container:Le,namespace:qe}=We;triggerEvent(je,"onFallback");const Qe=ye(ze),Ke=()=>{We.isInFallback&&(le(null,Ue,Le,Qe,He,null,qe,Y,te),setActiveBranch(We,Ue))},Je=Ue.transition&&Ue.transition.mode==="out-in";Je&&(ze.transition.afterLeave=Ke),We.isInFallback=!0,ge(ze,He,null,!0),Je||Ke()},move(Ue,je,ze){We.activeBranch&&ue(We.activeBranch,Ue,je,ze),We.container=Ue},next(){return We.activeBranch&&ye(We.activeBranch)},registerDep(Ue,je){const ze=!!We.pendingBranch;ze&&We.deps++;const He=Ue.vnode.el;Ue.asyncDep.catch(Le=>{handleError(Le,Ue,0)}).then(Le=>{if(Ue.isUnmounted||We.isUnmounted||We.pendingId!==Ue.suspenseId)return;Ue.asyncResolved=!0;const{vnode:qe}=Ue;handleSetupResult(Ue,Le,!1),He&&(qe.el=He);const Qe=!He&&Ue.subTree.el;je(Ue,qe,xe(He||Ue.subTree.el),He?null:ye(Ue.subTree),We,q,te),Qe&&Te(Qe),updateHOCHostEl(Ue,qe.el),ze&&--We.deps===0&&We.resolve()})},unmount(Ue,je){We.isUnmounted=!0,We.activeBranch&&ge(We.activeBranch,T,Ue,je),We.pendingBranch&&ge(We.pendingBranch,T,Ue,je)}};return We}function hydrateSuspense(B,_,T,E,W,X,q,Y,te){const ne=_.suspense=createSuspenseBoundary(_,E,T,B.parentNode,document.createElement("div"),null,W,X,q,Y,!0),ae=te(B,ne.pendingBranch=_.ssContent,T,ne,X,q);return ne.deps===0&&ne.resolve(!1,!0),ae}function normalizeSuspenseChildren(B){const{shapeFlag:_,children:T}=B,E=_&32;B.ssContent=normalizeSuspenseSlot(E?T.default:T),B.ssFallback=E?normalizeSuspenseSlot(T.fallback):createVNode(Comment)}function normalizeSuspenseSlot(B){let _;if(isFunction(B)){const T=isBlockTreeEnabled&&B._c;T&&(B._d=!1,openBlock()),B=B(),T&&(B._d=!0,_=currentBlock,closeBlock())}return isArray$4(B)&&(B=filterSingleRoot(B)),B=normalizeVNode(B),_&&!B.dynamicChildren&&(B.dynamicChildren=_.filter(T=>T!==B)),B}function queueEffectWithSuspense(B,_){_&&_.pendingBranch?isArray$4(B)?_.effects.push(...B):_.effects.push(B):queuePostFlushCb(B)}function setActiveBranch(B,_){B.activeBranch=_;const{vnode:T,parentComponent:E}=B;let W=_.el;for(;!W&&_.component;)_=_.component.subTree,W=_.el;T.el=W,E&&E.subTree===T&&(E.vnode.el=W,updateHOCHostEl(E,W))}function isVNodeSuspensible(B){const _=B.props&&B.props.suspensible;return _!=null&&_!==!1}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watchEffect(B,_){return doWatch(B,null,_)}function watchPostEffect(B,_){return doWatch(B,null,{flush:"post"})}function watchSyncEffect(B,_){return doWatch(B,null,{flush:"sync"})}const INITIAL_WATCHER_VALUE={};function watch(B,_,T){return doWatch(B,_,T)}function doWatch(B,_,{immediate:T,deep:E,flush:W,once:X,onTrack:q,onTrigger:Y}=EMPTY_OBJ){if(_&&X){const Ue=_;_=(...je)=>{Ue(...je),We()}}const te=currentInstance,ne=Ue=>E===!0?Ue:traverse(Ue,E===!1?1:void 0);let ae,le=!1,ue=!1;if(isRef(B)?(ae=()=>B.value,le=isShallow(B)):isReactive(B)?(ae=()=>ne(B),le=!0):isArray$4(B)?(ue=!0,le=B.some(Ue=>isReactive(Ue)||isShallow(Ue)),ae=()=>B.map(Ue=>{if(isRef(Ue))return Ue.value;if(isReactive(Ue))return ne(Ue);if(isFunction(Ue))return callWithErrorHandling(Ue,te,2)})):isFunction(B)?_?ae=()=>callWithErrorHandling(B,te,2):ae=()=>(ge&&ge(),callWithAsyncErrorHandling(B,te,3,[ye])):ae=NOOP,_&&E){const Ue=ae;ae=()=>traverse(Ue())}let ge,ye=Ue=>{ge=Ve.onStop=()=>{callWithErrorHandling(Ue,te,4),ge=Ve.onStop=void 0}},xe;if(isInSSRComponentSetup)if(ye=NOOP,_?T&&callWithAsyncErrorHandling(_,te,3,[ae(),ue?[]:void 0,ye]):ae(),W==="sync"){const Ue=useSSRContext();xe=Ue.__watcherHandles||(Ue.__watcherHandles=[])}else return NOOP;let Te=ue?new Array(B.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const Ae=()=>{if(!(!Ve.active||!Ve.dirty))if(_){const Ue=Ve.run();(E||le||(ue?Ue.some((je,ze)=>hasChanged(je,Te[ze])):hasChanged(Ue,Te)))&&(ge&&ge(),callWithAsyncErrorHandling(_,te,3,[Ue,Te===INITIAL_WATCHER_VALUE?void 0:ue&&Te[0]===INITIAL_WATCHER_VALUE?[]:Te,ye]),Te=Ue)}else Ve.run()};Ae.allowRecurse=!!_;let Ie;W==="sync"?Ie=Ae:W==="post"?Ie=()=>queuePostRenderEffect(Ae,te&&te.suspense):(Ae.pre=!0,te&&(Ae.id=te.uid),Ie=()=>queueJob(Ae));const Ve=new ReactiveEffect(ae,NOOP,Ie),$e=getCurrentScope(),We=()=>{Ve.stop(),$e&&remove$2($e.effects,Ve)};return _?T?Ae():Te=Ve.run():W==="post"?queuePostRenderEffect(Ve.run.bind(Ve),te&&te.suspense):Ve.run(),xe&&xe.push(We),We}function instanceWatch(B,_,T){const E=this.proxy,W=isString$1(B)?B.includes(".")?createPathGetter(E,B):()=>E[B]:B.bind(E,E);let X;isFunction(_)?X=_:(X=_.handler,T=_);const q=setCurrentInstance(this),Y=doWatch(W,X.bind(E),T);return q(),Y}function createPathGetter(B,_){const T=_.split(".");return()=>{let E=B;for(let W=0;W<T.length&&E;W++)E=E[T[W]];return E}}function traverse(B,_=1/0,T){if(_<=0||!isObject$3(B)||B.__v_skip||(T=T||new Set,T.has(B)))return B;if(T.add(B),_--,isRef(B))traverse(B.value,_,T);else if(isArray$4(B))for(let E=0;E<B.length;E++)traverse(B[E],_,T);else if(isSet$1(B)||isMap$1(B))B.forEach(E=>{traverse(E,_,T)});else if(isPlainObject(B))for(const E in B)traverse(B[E],_,T);return B}function withDirectives(B,_){if(currentRenderingInstance===null)return B;const T=getExposeProxy(currentRenderingInstance)||currentRenderingInstance.proxy,E=B.dirs||(B.dirs=[]);for(let W=0;W<_.length;W++){let[X,q,Y,te=EMPTY_OBJ]=_[W];X&&(isFunction(X)&&(X={mounted:X,updated:X}),X.deep&&traverse(q),E.push({dir:X,instance:T,value:q,oldValue:void 0,arg:Y,modifiers:te}))}return B}function invokeDirectiveHook(B,_,T,E){const W=B.dirs,X=_&&_.dirs;for(let q=0;q<W.length;q++){const Y=W[q];X&&(Y.oldValue=X[q].value);let te=Y.dir[E];te&&(pauseTracking(),callWithAsyncErrorHandling(te,T,8,[B.el,Y,B,_]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey$1=Symbol("_enterCb");function useTransitionState(){const B={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{B.isMounted=!0}),onBeforeUnmount(()=>{B.isUnmounting=!0}),B}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(B,{slots:_}){const T=getCurrentInstance(),E=useTransitionState();return()=>{const W=_.default&&getTransitionRawChildren(_.default(),!0);if(!W||!W.length)return;let X=W[0];if(W.length>1){for(const ue of W)if(ue.type!==Comment){X=ue;break}}const q=toRaw(B),{mode:Y}=q;if(E.isLeaving)return emptyPlaceholder(X);const te=getKeepAliveChild(X);if(!te)return emptyPlaceholder(X);const ne=resolveTransitionHooks(te,q,E,T);setTransitionHooks(te,ne);const ae=T.subTree,le=ae&&getKeepAliveChild(ae);if(le&&le.type!==Comment&&!isSameVNodeType(te,le)){const ue=resolveTransitionHooks(le,q,E,T);if(setTransitionHooks(le,ue),Y==="out-in"&&te.type!==Comment)return E.isLeaving=!0,ue.afterLeave=()=>{E.isLeaving=!1,T.update.active!==!1&&(T.effect.dirty=!0,T.update())},emptyPlaceholder(X);Y==="in-out"&&te.type!==Comment&&(ue.delayLeave=(ge,ye,xe)=>{const Te=getLeavingNodesForType(E,le);Te[String(le.key)]=le,ge[leaveCbKey]=()=>{ye(),ge[leaveCbKey]=void 0,delete ne.delayedLeave},ne.delayedLeave=xe})}return X}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(B,_){const{leavingVNodes:T}=B;let E=T.get(_.type);return E||(E=Object.create(null),T.set(_.type,E)),E}function resolveTransitionHooks(B,_,T,E){const{appear:W,mode:X,persisted:q=!1,onBeforeEnter:Y,onEnter:te,onAfterEnter:ne,onEnterCancelled:ae,onBeforeLeave:le,onLeave:ue,onAfterLeave:ge,onLeaveCancelled:ye,onBeforeAppear:xe,onAppear:Te,onAfterAppear:Ae,onAppearCancelled:Ie}=_,Ve=String(B.key),$e=getLeavingNodesForType(T,B),We=(ze,He)=>{ze&&callWithAsyncErrorHandling(ze,E,9,He)},Ue=(ze,He)=>{const Le=He[1];We(ze,He),isArray$4(ze)?ze.every(qe=>qe.length<=1)&&Le():ze.length<=1&&Le()},je={mode:X,persisted:q,beforeEnter(ze){let He=Y;if(!T.isMounted)if(W)He=xe||Y;else return;ze[leaveCbKey]&&ze[leaveCbKey](!0);const Le=$e[Ve];Le&&isSameVNodeType(B,Le)&&Le.el[leaveCbKey]&&Le.el[leaveCbKey](),We(He,[ze])},enter(ze){let He=te,Le=ne,qe=ae;if(!T.isMounted)if(W)He=Te||te,Le=Ae||ne,qe=Ie||ae;else return;let Qe=!1;const Ke=ze[enterCbKey$1]=Je=>{Qe||(Qe=!0,Je?We(qe,[ze]):We(Le,[ze]),je.delayedLeave&&je.delayedLeave(),ze[enterCbKey$1]=void 0)};He?Ue(He,[ze,Ke]):Ke()},leave(ze,He){const Le=String(B.key);if(ze[enterCbKey$1]&&ze[enterCbKey$1](!0),T.isUnmounting)return He();We(le,[ze]);let qe=!1;const Qe=ze[leaveCbKey]=Ke=>{qe||(qe=!0,He(),Ke?We(ye,[ze]):We(ge,[ze]),ze[leaveCbKey]=void 0,$e[Le]===B&&delete $e[Le])};$e[Le]=B,ue?Ue(ue,[ze,Qe]):Qe()},clone(ze){return resolveTransitionHooks(ze,_,T,E)}};return je}function emptyPlaceholder(B){if(isKeepAlive(B))return B=cloneVNode(B),B.children=null,B}function getKeepAliveChild(B){if(!isKeepAlive(B))return B;const{shapeFlag:_,children:T}=B;if(T){if(_&16)return T[0];if(_&32&&isFunction(T.default))return T.default()}}function setTransitionHooks(B,_){B.shapeFlag&6&&B.component?setTransitionHooks(B.component.subTree,_):B.shapeFlag&128?(B.ssContent.transition=_.clone(B.ssContent),B.ssFallback.transition=_.clone(B.ssFallback)):B.transition=_}function getTransitionRawChildren(B,_=!1,T){let E=[],W=0;for(let X=0;X<B.length;X++){let q=B[X];const Y=T==null?q.key:String(T)+String(q.key!=null?q.key:X);q.type===Fragment?(q.patchFlag&128&&W++,E=E.concat(getTransitionRawChildren(q.children,_,Y))):(_||q.type!==Comment)&&E.push(Y!=null?cloneVNode(q,{key:Y}):q)}if(W>1)for(let X=0;X<E.length;X++)E[X].patchFlag=-2;return E}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(B,_){return isFunction(B)?extend$1({name:B.name},_,{setup:B}):B}const isAsyncWrapper=B=>!!B.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function defineAsyncComponent(B){isFunction(B)&&(B={loader:B});const{loader:_,loadingComponent:T,errorComponent:E,delay:W=200,timeout:X,suspensible:q=!0,onError:Y}=B;let te=null,ne,ae=0;const le=()=>(ae++,te=null,ue()),ue=()=>{let ge;return te||(ge=te=_().catch(ye=>{if(ye=ye instanceof Error?ye:new Error(String(ye)),Y)return new Promise((xe,Te)=>{Y(ye,()=>xe(le()),()=>Te(ye),ae+1)});throw ye}).then(ye=>ge!==te&&te?te:(ye&&(ye.__esModule||ye[Symbol.toStringTag]==="Module")&&(ye=ye.default),ne=ye,ye)))};return defineComponent({name:"AsyncComponentWrapper",__asyncLoader:ue,get __asyncResolved(){return ne},setup(){const ge=currentInstance;if(ne)return()=>createInnerComp(ne,ge);const ye=Ie=>{te=null,handleError(Ie,ge,13,!E)};if(q&&ge.suspense||isInSSRComponentSetup)return ue().then(Ie=>()=>createInnerComp(Ie,ge)).catch(Ie=>(ye(Ie),()=>E?createVNode(E,{error:Ie}):null));const xe=ref$1(!1),Te=ref$1(),Ae=ref$1(!!W);return W&&setTimeout(()=>{Ae.value=!1},W),X!=null&&setTimeout(()=>{if(!xe.value&&!Te.value){const Ie=new Error(`Async component timed out after ${X}ms.`);ye(Ie),Te.value=Ie}},X),ue().then(()=>{xe.value=!0,ge.parent&&isKeepAlive(ge.parent.vnode)&&(ge.parent.effect.dirty=!0,queueJob(ge.parent.update))}).catch(Ie=>{ye(Ie),Te.value=Ie}),()=>{if(xe.value&&ne)return createInnerComp(ne,ge);if(Te.value&&E)return createVNode(E,{error:Te.value});if(T&&!Ae.value)return createVNode(T)}}})}function createInnerComp(B,_){const{ref:T,props:E,children:W,ce:X}=_.vnode,q=createVNode(B,E,W);return q.ref=T,q.ce=X,delete _.vnode.ce,q}const isKeepAlive=B=>B.type.__isKeepAlive,KeepAliveImpl={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(B,{slots:_}){const T=getCurrentInstance(),E=T.ctx;if(!E.renderer)return()=>{const Ie=_.default&&_.default();return Ie&&Ie.length===1?Ie[0]:Ie};const W=new Map,X=new Set;let q=null;const Y=T.suspense,{renderer:{p:te,m:ne,um:ae,o:{createElement:le}}}=E,ue=le("div");E.activate=(Ie,Ve,$e,We,Ue)=>{const je=Ie.component;ne(Ie,Ve,$e,0,Y),te(je.vnode,Ie,Ve,$e,je,Y,We,Ie.slotScopeIds,Ue),queuePostRenderEffect(()=>{je.isDeactivated=!1,je.a&&invokeArrayFns(je.a);const ze=Ie.props&&Ie.props.onVnodeMounted;ze&&invokeVNodeHook(ze,je.parent,Ie)},Y)},E.deactivate=Ie=>{const Ve=Ie.component;ne(Ie,ue,null,1,Y),queuePostRenderEffect(()=>{Ve.da&&invokeArrayFns(Ve.da);const $e=Ie.props&&Ie.props.onVnodeUnmounted;$e&&invokeVNodeHook($e,Ve.parent,Ie),Ve.isDeactivated=!0},Y)};function ge(Ie){resetShapeFlag(Ie),ae(Ie,T,Y,!0)}function ye(Ie){W.forEach((Ve,$e)=>{const We=getComponentName(Ve.type);We&&(!Ie||!Ie(We))&&xe($e)})}function xe(Ie){const Ve=W.get(Ie);!q||!isSameVNodeType(Ve,q)?ge(Ve):q&&resetShapeFlag(q),W.delete(Ie),X.delete(Ie)}watch(()=>[B.include,B.exclude],([Ie,Ve])=>{Ie&&ye($e=>matches(Ie,$e)),Ve&&ye($e=>!matches(Ve,$e))},{flush:"post",deep:!0});let Te=null;const Ae=()=>{Te!=null&&W.set(Te,getInnerChild(T.subTree))};return onMounted(Ae),onUpdated(Ae),onBeforeUnmount(()=>{W.forEach(Ie=>{const{subTree:Ve,suspense:$e}=T,We=getInnerChild(Ve);if(Ie.type===We.type&&Ie.key===We.key){resetShapeFlag(We);const Ue=We.component.da;Ue&&queuePostRenderEffect(Ue,$e);return}ge(Ie)})}),()=>{if(Te=null,!_.default)return null;const Ie=_.default(),Ve=Ie[0];if(Ie.length>1)return q=null,Ie;if(!isVNode(Ve)||!(Ve.shapeFlag&4)&&!(Ve.shapeFlag&128))return q=null,Ve;let $e=getInnerChild(Ve);const We=$e.type,Ue=getComponentName(isAsyncWrapper($e)?$e.type.__asyncResolved||{}:We),{include:je,exclude:ze,max:He}=B;if(je&&(!Ue||!matches(je,Ue))||ze&&Ue&&matches(ze,Ue))return q=$e,Ve;const Le=$e.key==null?We:$e.key,qe=W.get(Le);return $e.el&&($e=cloneVNode($e),Ve.shapeFlag&128&&(Ve.ssContent=$e)),Te=Le,qe?($e.el=qe.el,$e.component=qe.component,$e.transition&&setTransitionHooks($e,$e.transition),$e.shapeFlag|=512,X.delete(Le),X.add(Le)):(X.add(Le),He&&X.size>parseInt(He,10)&&xe(X.values().next().value)),$e.shapeFlag|=256,q=$e,isSuspense(Ve.type)?Ve:$e}}},KeepAlive=KeepAliveImpl;function matches(B,_){return isArray$4(B)?B.some(T=>matches(T,_)):isString$1(B)?B.split(",").includes(_):isRegExp$2(B)?B.test(_):!1}function onActivated(B,_){registerKeepAliveHook(B,"a",_)}function onDeactivated(B,_){registerKeepAliveHook(B,"da",_)}function registerKeepAliveHook(B,_,T=currentInstance){const E=B.__wdc||(B.__wdc=()=>{let W=T;for(;W;){if(W.isDeactivated)return;W=W.parent}return B()});if(injectHook(_,E,T),T){let W=T.parent;for(;W&&W.parent;)isKeepAlive(W.parent.vnode)&&injectToKeepAliveRoot(E,_,T,W),W=W.parent}}function injectToKeepAliveRoot(B,_,T,E){const W=injectHook(_,B,E,!0);onUnmounted(()=>{remove$2(E[_],W)},T)}function resetShapeFlag(B){B.shapeFlag&=-257,B.shapeFlag&=-513}function getInnerChild(B){return B.shapeFlag&128?B.ssContent:B}function injectHook(B,_,T=currentInstance,E=!1){if(T){const W=T[B]||(T[B]=[]),X=_.__weh||(_.__weh=(...q)=>{if(T.isUnmounted)return;pauseTracking();const Y=setCurrentInstance(T),te=callWithAsyncErrorHandling(_,T,B,q);return Y(),resetTracking(),te});return E?W.unshift(X):W.push(X),X}}const createHook=B=>(_,T=currentInstance)=>(!isInSSRComponentSetup||B==="sp")&&injectHook(B,(...E)=>_(...E),T),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(B,_=currentInstance){injectHook("ec",B,_)}function renderList(B,_,T,E){let W;const X=T&&T[E];if(isArray$4(B)||isString$1(B)){W=new Array(B.length);for(let q=0,Y=B.length;q<Y;q++)W[q]=_(B[q],q,void 0,X&&X[q])}else if(typeof B=="number"){W=new Array(B);for(let q=0;q<B;q++)W[q]=_(q+1,q,void 0,X&&X[q])}else if(isObject$3(B))if(B[Symbol.iterator])W=Array.from(B,(q,Y)=>_(q,Y,void 0,X&&X[Y]));else{const q=Object.keys(B);W=new Array(q.length);for(let Y=0,te=q.length;Y<te;Y++){const ne=q[Y];W[Y]=_(B[ne],ne,Y,X&&X[Y])}}else W=[];return T&&(T[E]=W),W}function createSlots(B,_){for(let T=0;T<_.length;T++){const E=_[T];if(isArray$4(E))for(let W=0;W<E.length;W++)B[E[W].name]=E[W].fn;else E&&(B[E.name]=E.key?(...W)=>{const X=E.fn(...W);return X&&(X.key=E.key),X}:E.fn)}return B}function renderSlot(B,_,T={},E,W){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return _!=="default"&&(T.name=_),createVNode("slot",T,E&&E());let X=B[_];X&&X._c&&(X._d=!1),openBlock();const q=X&&ensureValidVNode(X(T)),Y=createBlock(Fragment,{key:T.key||q&&q.key||`_${_}`},q||(E?E():[]),q&&B._===1?64:-2);return!W&&Y.scopeId&&(Y.slotScopeIds=[Y.scopeId+"-s"]),X&&X._c&&(X._d=!0),Y}function ensureValidVNode(B){return B.some(_=>isVNode(_)?!(_.type===Comment||_.type===Fragment&&!ensureValidVNode(_.children)):!0)?B:null}function toHandlers(B,_){const T={};for(const E in B)T[_&&/[A-Z]/.test(E)?`on:${E}`:toHandlerKey(E)]=B[E];return T}const getPublicInstance=B=>B?isStatefulComponent(B)?getExposeProxy(B)||B.proxy:getPublicInstance(B.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:B=>B,$el:B=>B.vnode.el,$data:B=>B.data,$props:B=>B.props,$attrs:B=>B.attrs,$slots:B=>B.slots,$refs:B=>B.refs,$parent:B=>getPublicInstance(B.parent),$root:B=>getPublicInstance(B.root),$emit:B=>B.emit,$options:B=>resolveMergedOptions(B),$forceUpdate:B=>B.f||(B.f=()=>{B.effect.dirty=!0,queueJob(B.update)}),$nextTick:B=>B.n||(B.n=nextTick.bind(B.proxy)),$watch:B=>instanceWatch.bind(B)}),hasSetupBinding=(B,_)=>B!==EMPTY_OBJ&&!B.__isScriptSetup&&hasOwn$2(B,_),PublicInstanceProxyHandlers={get({_:B},_){if(_==="__v_skip")return!0;const{ctx:T,setupState:E,data:W,props:X,accessCache:q,type:Y,appContext:te}=B;let ne;if(_[0]!=="$"){const ge=q[_];if(ge!==void 0)switch(ge){case 1:return E[_];case 2:return W[_];case 4:return T[_];case 3:return X[_]}else{if(hasSetupBinding(E,_))return q[_]=1,E[_];if(W!==EMPTY_OBJ&&hasOwn$2(W,_))return q[_]=2,W[_];if((ne=B.propsOptions[0])&&hasOwn$2(ne,_))return q[_]=3,X[_];if(T!==EMPTY_OBJ&&hasOwn$2(T,_))return q[_]=4,T[_];shouldCacheAccess&&(q[_]=0)}}const ae=publicPropertiesMap[_];let le,ue;if(ae)return _==="$attrs"&&track(B.attrs,"get",""),ae(B);if((le=Y.__cssModules)&&(le=le[_]))return le;if(T!==EMPTY_OBJ&&hasOwn$2(T,_))return q[_]=4,T[_];if(ue=te.config.globalProperties,hasOwn$2(ue,_))return ue[_]},set({_:B},_,T){const{data:E,setupState:W,ctx:X}=B;return hasSetupBinding(W,_)?(W[_]=T,!0):E!==EMPTY_OBJ&&hasOwn$2(E,_)?(E[_]=T,!0):hasOwn$2(B.props,_)||_[0]==="$"&&_.slice(1)in B?!1:(X[_]=T,!0)},has({_:{data:B,setupState:_,accessCache:T,ctx:E,appContext:W,propsOptions:X}},q){let Y;return!!T[q]||B!==EMPTY_OBJ&&hasOwn$2(B,q)||hasSetupBinding(_,q)||(Y=X[0])&&hasOwn$2(Y,q)||hasOwn$2(E,q)||hasOwn$2(publicPropertiesMap,q)||hasOwn$2(W.config.globalProperties,q)},defineProperty(B,_,T){return T.get!=null?B._.accessCache[_]=0:hasOwn$2(T,"value")&&this.set(B,_,T.value,null),Reflect.defineProperty(B,_,T)}},RuntimeCompiledPublicInstanceProxyHandlers=extend$1({},PublicInstanceProxyHandlers,{get(B,_){if(_!==Symbol.unscopables)return PublicInstanceProxyHandlers.get(B,_,B)},has(B,_){return _[0]!=="_"&&!isGloballyAllowed(_)}});function defineProps(){return null}function defineEmits(){return null}function defineExpose(B){}function defineOptions(B){}function defineSlots(){return null}function defineModel(){}function withDefaults(B,_){return null}function useSlots(){return getContext().slots}function useAttrs(){return getContext().attrs}function getContext(){const B=getCurrentInstance();return B.setupContext||(B.setupContext=createSetupContext(B))}function normalizePropsOrEmits(B){return isArray$4(B)?B.reduce((_,T)=>(_[T]=null,_),{}):B}function mergeDefaults(B,_){const T=normalizePropsOrEmits(B);for(const E in _){if(E.startsWith("__skip"))continue;let W=T[E];W?isArray$4(W)||isFunction(W)?W=T[E]={type:W,default:_[E]}:W.default=_[E]:W===null&&(W=T[E]={default:_[E]}),W&&_[`__skip_${E}`]&&(W.skipFactory=!0)}return T}function mergeModels(B,_){return!B||!_?B||_:isArray$4(B)&&isArray$4(_)?B.concat(_):extend$1({},normalizePropsOrEmits(B),normalizePropsOrEmits(_))}function createPropsRestProxy(B,_){const T={};for(const E in B)_.includes(E)||Object.defineProperty(T,E,{enumerable:!0,get:()=>B[E]});return T}function withAsyncContext(B){const _=getCurrentInstance();let T=B();return unsetCurrentInstance(),isPromise(T)&&(T=T.catch(E=>{throw setCurrentInstance(_),E})),[T,()=>setCurrentInstance(_)]}let shouldCacheAccess=!0;function applyOptions(B){const _=resolveMergedOptions(B),T=B.proxy,E=B.ctx;shouldCacheAccess=!1,_.beforeCreate&&callHook$1(_.beforeCreate,B,"bc");const{data:W,computed:X,methods:q,watch:Y,provide:te,inject:ne,created:ae,beforeMount:le,mounted:ue,beforeUpdate:ge,updated:ye,activated:xe,deactivated:Te,beforeDestroy:Ae,beforeUnmount:Ie,destroyed:Ve,unmounted:$e,render:We,renderTracked:Ue,renderTriggered:je,errorCaptured:ze,serverPrefetch:He,expose:Le,inheritAttrs:qe,components:Qe,directives:Ke,filters:Je}=_;if(ne&&resolveInjections(ne,E,null),q)for(const lt in q){const st=q[lt];isFunction(st)&&(E[lt]=st.bind(T))}if(W){const lt=W.call(T,T);isObject$3(lt)&&(B.data=reactive(lt))}if(shouldCacheAccess=!0,X)for(const lt in X){const st=X[lt],sr=isFunction(st)?st.bind(T,T):isFunction(st.get)?st.get.bind(T,T):NOOP,mt=!isFunction(st)&&isFunction(st.set)?st.set.bind(T):NOOP,Tr=computed({get:sr,set:mt});Object.defineProperty(E,lt,{enumerable:!0,configurable:!0,get:()=>Tr.value,set:di=>Tr.value=di})}if(Y)for(const lt in Y)createWatcher(Y[lt],E,T,lt);if(te){const lt=isFunction(te)?te.call(T):te;Reflect.ownKeys(lt).forEach(st=>{provide(st,lt[st])})}ae&&callHook$1(ae,B,"c");function ut(lt,st){isArray$4(st)?st.forEach(sr=>lt(sr.bind(T))):st&&lt(st.bind(T))}if(ut(onBeforeMount,le),ut(onMounted,ue),ut(onBeforeUpdate,ge),ut(onUpdated,ye),ut(onActivated,xe),ut(onDeactivated,Te),ut(onErrorCaptured,ze),ut(onRenderTracked,Ue),ut(onRenderTriggered,je),ut(onBeforeUnmount,Ie),ut(onUnmounted,$e),ut(onServerPrefetch,He),isArray$4(Le))if(Le.length){const lt=B.exposed||(B.exposed={});Le.forEach(st=>{Object.defineProperty(lt,st,{get:()=>T[st],set:sr=>T[st]=sr})})}else B.exposed||(B.exposed={});We&&B.render===NOOP&&(B.render=We),qe!=null&&(B.inheritAttrs=qe),Qe&&(B.components=Qe),Ke&&(B.directives=Ke)}function resolveInjections(B,_,T=NOOP){isArray$4(B)&&(B=normalizeInject(B));for(const E in B){const W=B[E];let X;isObject$3(W)?"default"in W?X=inject(W.from||E,W.default,!0):X=inject(W.from||E):X=inject(W),isRef(X)?Object.defineProperty(_,E,{enumerable:!0,configurable:!0,get:()=>X.value,set:q=>X.value=q}):_[E]=X}}function callHook$1(B,_,T){callWithAsyncErrorHandling(isArray$4(B)?B.map(E=>E.bind(_.proxy)):B.bind(_.proxy),_,T)}function createWatcher(B,_,T,E){const W=E.includes(".")?createPathGetter(T,E):()=>T[E];if(isString$1(B)){const X=_[B];isFunction(X)&&watch(W,X)}else if(isFunction(B))watch(W,B.bind(T));else if(isObject$3(B))if(isArray$4(B))B.forEach(X=>createWatcher(X,_,T,E));else{const X=isFunction(B.handler)?B.handler.bind(T):_[B.handler];isFunction(X)&&watch(W,X,B)}}function resolveMergedOptions(B){const _=B.type,{mixins:T,extends:E}=_,{mixins:W,optionsCache:X,config:{optionMergeStrategies:q}}=B.appContext,Y=X.get(_);let te;return Y?te=Y:!W.length&&!T&&!E?te=_:(te={},W.length&&W.forEach(ne=>mergeOptions(te,ne,q,!0)),mergeOptions(te,_,q)),isObject$3(_)&&X.set(_,te),te}function mergeOptions(B,_,T,E=!1){const{mixins:W,extends:X}=_;X&&mergeOptions(B,X,T,!0),W&&W.forEach(q=>mergeOptions(B,q,T,!0));for(const q in _)if(!(E&&q==="expose")){const Y=internalOptionMergeStrats[q]||T&&T[q];B[q]=Y?Y(B[q],_[q]):_[q]}return B}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(B,_){return _?B?function(){return extend$1(isFunction(B)?B.call(this,this):B,isFunction(_)?_.call(this,this):_)}:_:B}function mergeInject(B,_){return mergeObjectOptions(normalizeInject(B),normalizeInject(_))}function normalizeInject(B){if(isArray$4(B)){const _={};for(let T=0;T<B.length;T++)_[B[T]]=B[T];return _}return B}function mergeAsArray(B,_){return B?[...new Set([].concat(B,_))]:_}function mergeObjectOptions(B,_){return B?extend$1(Object.create(null),B,_):_}function mergeEmitsOrPropsOptions(B,_){return B?isArray$4(B)&&isArray$4(_)?[...new Set([...B,..._])]:extend$1(Object.create(null),normalizePropsOrEmits(B),normalizePropsOrEmits(_??{})):_}function mergeWatchOptions(B,_){if(!B)return _;if(!_)return B;const T=extend$1(Object.create(null),B);for(const E in _)T[E]=mergeAsArray(B[E],_[E]);return T}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(B,_){return function(E,W=null){isFunction(E)||(E=extend$1({},E)),W!=null&&!isObject$3(W)&&(W=null);const X=createAppContext(),q=new WeakSet;let Y=!1;const te=X.app={_uid:uid$1++,_component:E,_props:W,_container:null,_context:X,_instance:null,version,get config(){return X.config},set config(ne){},use(ne,...ae){return q.has(ne)||(ne&&isFunction(ne.install)?(q.add(ne),ne.install(te,...ae)):isFunction(ne)&&(q.add(ne),ne(te,...ae))),te},mixin(ne){return X.mixins.includes(ne)||X.mixins.push(ne),te},component(ne,ae){return ae?(X.components[ne]=ae,te):X.components[ne]},directive(ne,ae){return ae?(X.directives[ne]=ae,te):X.directives[ne]},mount(ne,ae,le){if(!Y){const ue=createVNode(E,W);return ue.appContext=X,le===!0?le="svg":le===!1&&(le=void 0),ae&&_?_(ue,ne):B(ue,ne,le),Y=!0,te._container=ne,ne.__vue_app__=te,getExposeProxy(ue.component)||ue.component.proxy}},unmount(){Y&&(B(null,te._container),delete te._container.__vue_app__)},provide(ne,ae){return X.provides[ne]=ae,te},runWithContext(ne){const ae=currentApp;currentApp=te;try{return ne()}finally{currentApp=ae}}};return te}}let currentApp=null;function provide(B,_){if(currentInstance){let T=currentInstance.provides;const E=currentInstance.parent&&currentInstance.parent.provides;E===T&&(T=currentInstance.provides=Object.create(E)),T[B]=_}}function inject(B,_,T=!1){const E=currentInstance||currentRenderingInstance;if(E||currentApp){const W=E?E.parent==null?E.vnode.appContext&&E.vnode.appContext.provides:E.parent.provides:currentApp._context.provides;if(W&&B in W)return W[B];if(arguments.length>1)return T&&isFunction(_)?_.call(E&&E.proxy):_}}function hasInjectionContext(){return!!(currentInstance||currentRenderingInstance||currentApp)}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=B=>Object.getPrototypeOf(B)===internalObjectProto;function initProps(B,_,T,E=!1){const W={},X=createInternalObject();B.propsDefaults=Object.create(null),setFullProps(B,_,W,X);for(const q in B.propsOptions[0])q in W||(W[q]=void 0);T?B.props=E?W:shallowReactive(W):B.type.props?B.props=W:B.props=X,B.attrs=X}function updateProps(B,_,T,E){const{props:W,attrs:X,vnode:{patchFlag:q}}=B,Y=toRaw(W),[te]=B.propsOptions;let ne=!1;if((E||q>0)&&!(q&16)){if(q&8){const ae=B.vnode.dynamicProps;for(let le=0;le<ae.length;le++){let ue=ae[le];if(isEmitListener(B.emitsOptions,ue))continue;const ge=_[ue];if(te)if(hasOwn$2(X,ue))ge!==X[ue]&&(X[ue]=ge,ne=!0);else{const ye=camelize(ue);W[ye]=resolvePropValue(te,Y,ye,ge,B,!1)}else ge!==X[ue]&&(X[ue]=ge,ne=!0)}}}else{setFullProps(B,_,W,X)&&(ne=!0);let ae;for(const le in Y)(!_||!hasOwn$2(_,le)&&((ae=hyphenate(le))===le||!hasOwn$2(_,ae)))&&(te?T&&(T[le]!==void 0||T[ae]!==void 0)&&(W[le]=resolvePropValue(te,Y,le,void 0,B,!0)):delete W[le]);if(X!==Y)for(const le in X)(!_||!hasOwn$2(_,le))&&(delete X[le],ne=!0)}ne&&trigger(B.attrs,"set","")}function setFullProps(B,_,T,E){const[W,X]=B.propsOptions;let q=!1,Y;if(_)for(let te in _){if(isReservedProp(te))continue;const ne=_[te];let ae;W&&hasOwn$2(W,ae=camelize(te))?!X||!X.includes(ae)?T[ae]=ne:(Y||(Y={}))[ae]=ne:isEmitListener(B.emitsOptions,te)||(!(te in E)||ne!==E[te])&&(E[te]=ne,q=!0)}if(X){const te=toRaw(T),ne=Y||EMPTY_OBJ;for(let ae=0;ae<X.length;ae++){const le=X[ae];T[le]=resolvePropValue(W,te,le,ne[le],B,!hasOwn$2(ne,le))}}return q}function resolvePropValue(B,_,T,E,W,X){const q=B[T];if(q!=null){const Y=hasOwn$2(q,"default");if(Y&&E===void 0){const te=q.default;if(q.type!==Function&&!q.skipFactory&&isFunction(te)){const{propsDefaults:ne}=W;if(T in ne)E=ne[T];else{const ae=setCurrentInstance(W);E=ne[T]=te.call(null,_),ae()}}else E=te}q[0]&&(X&&!Y?E=!1:q[1]&&(E===""||E===hyphenate(T))&&(E=!0))}return E}function normalizePropsOptions(B,_,T=!1){const E=_.propsCache,W=E.get(B);if(W)return W;const X=B.props,q={},Y=[];let te=!1;if(!isFunction(B)){const ae=le=>{te=!0;const[ue,ge]=normalizePropsOptions(le,_,!0);extend$1(q,ue),ge&&Y.push(...ge)};!T&&_.mixins.length&&_.mixins.forEach(ae),B.extends&&ae(B.extends),B.mixins&&B.mixins.forEach(ae)}if(!X&&!te)return isObject$3(B)&&E.set(B,EMPTY_ARR),EMPTY_ARR;if(isArray$4(X))for(let ae=0;ae<X.length;ae++){const le=camelize(X[ae]);validatePropName(le)&&(q[le]=EMPTY_OBJ)}else if(X)for(const ae in X){const le=camelize(ae);if(validatePropName(le)){const ue=X[ae],ge=q[le]=isArray$4(ue)||isFunction(ue)?{type:ue}:extend$1({},ue);if(ge){const ye=getTypeIndex(Boolean,ge.type),xe=getTypeIndex(String,ge.type);ge[0]=ye>-1,ge[1]=xe<0||ye<xe,(ye>-1||hasOwn$2(ge,"default"))&&Y.push(le)}}}const ne=[q,Y];return isObject$3(B)&&E.set(B,ne),ne}function validatePropName(B){return B[0]!=="$"&&!isReservedProp(B)}function getType(B){return B===null?"null":typeof B=="function"?B.name||"":typeof B=="object"&&B.constructor&&B.constructor.name||""}function isSameType(B,_){return getType(B)===getType(_)}function getTypeIndex(B,_){return isArray$4(_)?_.findIndex(T=>isSameType(T,B)):isFunction(_)&&isSameType(_,B)?0:-1}const isInternalKey=B=>B[0]==="_"||B==="$stable",normalizeSlotValue=B=>isArray$4(B)?B.map(normalizeVNode):[normalizeVNode(B)],normalizeSlot=(B,_,T)=>{if(_._n)return _;const E=withCtx((...W)=>normalizeSlotValue(_(...W)),T);return E._c=!1,E},normalizeObjectSlots=(B,_,T)=>{const E=B._ctx;for(const W in B){if(isInternalKey(W))continue;const X=B[W];if(isFunction(X))_[W]=normalizeSlot(W,X,E);else if(X!=null){const q=normalizeSlotValue(X);_[W]=()=>q}}},normalizeVNodeSlots=(B,_)=>{const T=normalizeSlotValue(_);B.slots.default=()=>T},initSlots=(B,_)=>{const T=B.slots=createInternalObject();if(B.vnode.shapeFlag&32){const E=_._;E?(extend$1(T,_),def(T,"_",E,!0)):normalizeObjectSlots(_,T)}else _&&normalizeVNodeSlots(B,_)},updateSlots=(B,_,T)=>{const{vnode:E,slots:W}=B;let X=!0,q=EMPTY_OBJ;if(E.shapeFlag&32){const Y=_._;Y?T&&Y===1?X=!1:(extend$1(W,_),!T&&Y===1&&delete W._):(X=!_.$stable,normalizeObjectSlots(_,W)),q=_}else _&&(normalizeVNodeSlots(B,_),q={default:1});if(X)for(const Y in W)!isInternalKey(Y)&&q[Y]==null&&delete W[Y]};function setRef(B,_,T,E,W=!1){if(isArray$4(B)){B.forEach((ue,ge)=>setRef(ue,_&&(isArray$4(_)?_[ge]:_),T,E,W));return}if(isAsyncWrapper(E)&&!W)return;const X=E.shapeFlag&4?getExposeProxy(E.component)||E.component.proxy:E.el,q=W?null:X,{i:Y,r:te}=B,ne=_&&_.r,ae=Y.refs===EMPTY_OBJ?Y.refs={}:Y.refs,le=Y.setupState;if(ne!=null&&ne!==te&&(isString$1(ne)?(ae[ne]=null,hasOwn$2(le,ne)&&(le[ne]=null)):isRef(ne)&&(ne.value=null)),isFunction(te))callWithErrorHandling(te,Y,12,[q,ae]);else{const ue=isString$1(te),ge=isRef(te);if(ue||ge){const ye=()=>{if(B.f){const xe=ue?hasOwn$2(le,te)?le[te]:ae[te]:te.value;W?isArray$4(xe)&&remove$2(xe,X):isArray$4(xe)?xe.includes(X)||xe.push(X):ue?(ae[te]=[X],hasOwn$2(le,te)&&(le[te]=ae[te])):(te.value=[X],B.k&&(ae[B.k]=te.value))}else ue?(ae[te]=q,hasOwn$2(le,te)&&(le[te]=q)):ge&&(te.value=q,B.k&&(ae[B.k]=q))};q?(ye.id=-1,queuePostRenderEffect(ye,T)):ye()}}}let hasMismatch=!1;const isSVGContainer=B=>B.namespaceURI.includes("svg")&&B.tagName!=="foreignObject",isMathMLContainer=B=>B.namespaceURI.includes("MathML"),getContainerType=B=>{if(isSVGContainer(B))return"svg";if(isMathMLContainer(B))return"mathml"},isComment=B=>B.nodeType===8;function createHydrationFunctions(B){const{mt:_,p:T,o:{patchProp:E,createText:W,nextSibling:X,parentNode:q,remove:Y,insert:te,createComment:ne}}=B,ae=(Ve,$e)=>{if(!$e.hasChildNodes()){T(null,Ve,$e),flushPostFlushCbs(),$e._vnode=Ve;return}hasMismatch=!1,le($e.firstChild,Ve,null,null,null),flushPostFlushCbs(),$e._vnode=Ve,hasMismatch&&console.error("Hydration completed but contains mismatches.")},le=(Ve,$e,We,Ue,je,ze=!1)=>{ze=ze||!!$e.dynamicChildren;const He=isComment(Ve)&&Ve.data==="[",Le=()=>xe(Ve,$e,We,Ue,je,He),{type:qe,ref:Qe,shapeFlag:Ke,patchFlag:Je}=$e;let pt=Ve.nodeType;$e.el=Ve,Je===-2&&(ze=!1,$e.dynamicChildren=null);let ut=null;switch(qe){case Text$2:pt!==3?$e.children===""?(te($e.el=W(""),q(Ve),Ve),ut=Ve):ut=Le():(Ve.data!==$e.children&&(hasMismatch=!0,Ve.data=$e.children),ut=X(Ve));break;case Comment:Ie(Ve)?(ut=X(Ve),Ae($e.el=Ve.content.firstChild,Ve,We)):pt!==8||He?ut=Le():ut=X(Ve);break;case Static:if(He&&(Ve=X(Ve),pt=Ve.nodeType),pt===1||pt===3){ut=Ve;const lt=!$e.children.length;for(let st=0;st<$e.staticCount;st++)lt&&($e.children+=ut.nodeType===1?ut.outerHTML:ut.data),st===$e.staticCount-1&&($e.anchor=ut),ut=X(ut);return He?X(ut):ut}else Le();break;case Fragment:He?ut=ye(Ve,$e,We,Ue,je,ze):ut=Le();break;default:if(Ke&1)(pt!==1||$e.type.toLowerCase()!==Ve.tagName.toLowerCase())&&!Ie(Ve)?ut=Le():ut=ue(Ve,$e,We,Ue,je,ze);else if(Ke&6){$e.slotScopeIds=je;const lt=q(Ve);if(He?ut=Te(Ve):isComment(Ve)&&Ve.data==="teleport start"?ut=Te(Ve,Ve.data,"teleport end"):ut=X(Ve),_($e,lt,null,We,Ue,getContainerType(lt),ze),isAsyncWrapper($e)){let st;He?(st=createVNode(Fragment),st.anchor=ut?ut.previousSibling:lt.lastChild):st=Ve.nodeType===3?createTextVNode(""):createVNode("div"),st.el=Ve,$e.component.subTree=st}}else Ke&64?pt!==8?ut=Le():ut=$e.type.hydrate(Ve,$e,We,Ue,je,ze,B,ge):Ke&128&&(ut=$e.type.hydrate(Ve,$e,We,Ue,getContainerType(q(Ve)),je,ze,B,le))}return Qe!=null&&setRef(Qe,null,Ue,$e),ut},ue=(Ve,$e,We,Ue,je,ze)=>{ze=ze||!!$e.dynamicChildren;const{type:He,props:Le,patchFlag:qe,shapeFlag:Qe,dirs:Ke,transition:Je}=$e,pt=He==="input"||He==="option";if(pt||qe!==-1){Ke&&invokeDirectiveHook($e,null,We,"created");let ut=!1;if(Ie(Ve)){ut=needTransition(Ue,Je)&&We&&We.vnode.props&&We.vnode.props.appear;const st=Ve.content.firstChild;ut&&Je.beforeEnter(st),Ae(st,Ve,We),$e.el=Ve=st}if(Qe&16&&!(Le&&(Le.innerHTML||Le.textContent))){let st=ge(Ve.firstChild,$e,Ve,We,Ue,je,ze);for(;st;){hasMismatch=!0;const sr=st;st=st.nextSibling,Y(sr)}}else Qe&8&&Ve.textContent!==$e.children&&(hasMismatch=!0,Ve.textContent=$e.children);if(Le)if(pt||!ze||qe&48)for(const st in Le)(pt&&(st.endsWith("value")||st==="indeterminate")||isOn(st)&&!isReservedProp(st)||st[0]===".")&&E(Ve,st,null,Le[st],void 0,void 0,We);else Le.onClick&&E(Ve,"onClick",null,Le.onClick,void 0,void 0,We);let lt;(lt=Le&&Le.onVnodeBeforeMount)&&invokeVNodeHook(lt,We,$e),Ke&&invokeDirectiveHook($e,null,We,"beforeMount"),((lt=Le&&Le.onVnodeMounted)||Ke||ut)&&queueEffectWithSuspense(()=>{lt&&invokeVNodeHook(lt,We,$e),ut&&Je.enter(Ve),Ke&&invokeDirectiveHook($e,null,We,"mounted")},Ue)}return Ve.nextSibling},ge=(Ve,$e,We,Ue,je,ze,He)=>{He=He||!!$e.dynamicChildren;const Le=$e.children,qe=Le.length;for(let Qe=0;Qe<qe;Qe++){const Ke=He?Le[Qe]:Le[Qe]=normalizeVNode(Le[Qe]);if(Ve)Ve=le(Ve,Ke,Ue,je,ze,He);else{if(Ke.type===Text$2&&!Ke.children)continue;hasMismatch=!0,T(null,Ke,We,null,Ue,je,getContainerType(We),ze)}}return Ve},ye=(Ve,$e,We,Ue,je,ze)=>{const{slotScopeIds:He}=$e;He&&(je=je?je.concat(He):He);const Le=q(Ve),qe=ge(X(Ve),$e,Le,We,Ue,je,ze);return qe&&isComment(qe)&&qe.data==="]"?X($e.anchor=qe):(hasMismatch=!0,te($e.anchor=ne("]"),Le,qe),qe)},xe=(Ve,$e,We,Ue,je,ze)=>{if(hasMismatch=!0,$e.el=null,ze){const qe=Te(Ve);for(;;){const Qe=X(Ve);if(Qe&&Qe!==qe)Y(Qe);else break}}const He=X(Ve),Le=q(Ve);return Y(Ve),T(null,$e,Le,He,We,Ue,getContainerType(Le),je),He},Te=(Ve,$e="[",We="]")=>{let Ue=0;for(;Ve;)if(Ve=X(Ve),Ve&&isComment(Ve)&&(Ve.data===$e&&Ue++,Ve.data===We)){if(Ue===0)return X(Ve);Ue--}return Ve},Ae=(Ve,$e,We)=>{const Ue=$e.parentNode;Ue&&Ue.replaceChild(Ve,$e);let je=We;for(;je;)je.vnode.el===$e&&(je.vnode.el=je.subTree.el=Ve),je=je.parent},Ie=Ve=>Ve.nodeType===1&&Ve.tagName.toLowerCase()==="template";return[ae,le]}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(B){return baseCreateRenderer(B)}function createHydrationRenderer(B){return baseCreateRenderer(B,createHydrationFunctions)}function baseCreateRenderer(B,_){const T=getGlobalThis();T.__VUE__=!0;const{insert:E,remove:W,patchProp:X,createElement:q,createText:Y,createComment:te,setText:ne,setElementText:ae,parentNode:le,nextSibling:ue,setScopeId:ge=NOOP,insertStaticContent:ye}=B,xe=(et,at,Rr,Br=null,Kr=null,oi=null,ct=void 0,nt=null,Ir=!!at.dynamicChildren)=>{if(et===at)return;et&&!isSameVNodeType(et,at)&&(Br=fi(et),di(et,Kr,oi,!0),et=null),at.patchFlag===-2&&(Ir=!1,at.dynamicChildren=null);const{type:Dr,ref:ti,shapeFlag:si}=at;switch(Dr){case Text$2:Te(et,at,Rr,Br);break;case Comment:Ae(et,at,Rr,Br);break;case Static:et==null&&Ie(at,Rr,Br,ct);break;case Fragment:Qe(et,at,Rr,Br,Kr,oi,ct,nt,Ir);break;default:si&1?We(et,at,Rr,Br,Kr,oi,ct,nt,Ir):si&6?Ke(et,at,Rr,Br,Kr,oi,ct,nt,Ir):(si&64||si&128)&&Dr.process(et,at,Rr,Br,Kr,oi,ct,nt,Ir,rt)}ti!=null&&Kr&&setRef(ti,et&&et.ref,oi,at||et,!at)},Te=(et,at,Rr,Br)=>{if(et==null)E(at.el=Y(at.children),Rr,Br);else{const Kr=at.el=et.el;at.children!==et.children&&ne(Kr,at.children)}},Ae=(et,at,Rr,Br)=>{et==null?E(at.el=te(at.children||""),Rr,Br):at.el=et.el},Ie=(et,at,Rr,Br)=>{[et.el,et.anchor]=ye(et.children,at,Rr,Br,et.el,et.anchor)},Ve=({el:et,anchor:at},Rr,Br)=>{let Kr;for(;et&&et!==at;)Kr=ue(et),E(et,Rr,Br),et=Kr;E(at,Rr,Br)},$e=({el:et,anchor:at})=>{let Rr;for(;et&&et!==at;)Rr=ue(et),W(et),et=Rr;W(at)},We=(et,at,Rr,Br,Kr,oi,ct,nt,Ir)=>{at.type==="svg"?ct="svg":at.type==="math"&&(ct="mathml"),et==null?Ue(at,Rr,Br,Kr,oi,ct,nt,Ir):He(et,at,Kr,oi,ct,nt,Ir)},Ue=(et,at,Rr,Br,Kr,oi,ct,nt)=>{let Ir,Dr;const{props:ti,shapeFlag:si,transition:Ai,dirs:Oi}=et;if(Ir=et.el=q(et.type,oi,ti&&ti.is,ti),si&8?ae(Ir,et.children):si&16&&ze(et.children,Ir,null,Br,Kr,resolveChildrenNamespace(et,oi),ct,nt),Oi&&invokeDirectiveHook(et,null,Br,"created"),je(Ir,et,et.scopeId,ct,Br),ti){for(const Wi in ti)Wi!=="value"&&!isReservedProp(Wi)&&X(Ir,Wi,null,ti[Wi],oi,et.children,Br,Kr,gi);"value"in ti&&X(Ir,"value",null,ti.value,oi),(Dr=ti.onVnodeBeforeMount)&&invokeVNodeHook(Dr,Br,et)}Oi&&invokeDirectiveHook(et,null,Br,"beforeMount");const Ci=needTransition(Kr,Ai);Ci&&Ai.beforeEnter(Ir),E(Ir,at,Rr),((Dr=ti&&ti.onVnodeMounted)||Ci||Oi)&&queuePostRenderEffect(()=>{Dr&&invokeVNodeHook(Dr,Br,et),Ci&&Ai.enter(Ir),Oi&&invokeDirectiveHook(et,null,Br,"mounted")},Kr)},je=(et,at,Rr,Br,Kr)=>{if(Rr&&ge(et,Rr),Br)for(let oi=0;oi<Br.length;oi++)ge(et,Br[oi]);if(Kr){let oi=Kr.subTree;if(at===oi){const ct=Kr.vnode;je(et,ct,ct.scopeId,ct.slotScopeIds,Kr.parent)}}},ze=(et,at,Rr,Br,Kr,oi,ct,nt,Ir=0)=>{for(let Dr=Ir;Dr<et.length;Dr++){const ti=et[Dr]=nt?cloneIfMounted(et[Dr]):normalizeVNode(et[Dr]);xe(null,ti,at,Rr,Br,Kr,oi,ct,nt)}},He=(et,at,Rr,Br,Kr,oi,ct)=>{const nt=at.el=et.el;let{patchFlag:Ir,dynamicChildren:Dr,dirs:ti}=at;Ir|=et.patchFlag&16;const si=et.props||EMPTY_OBJ,Ai=at.props||EMPTY_OBJ;let Oi;if(Rr&&toggleRecurse(Rr,!1),(Oi=Ai.onVnodeBeforeUpdate)&&invokeVNodeHook(Oi,Rr,at,et),ti&&invokeDirectiveHook(at,et,Rr,"beforeUpdate"),Rr&&toggleRecurse(Rr,!0),Dr?Le(et.dynamicChildren,Dr,nt,Rr,Br,resolveChildrenNamespace(at,Kr),oi):ct||st(et,at,nt,null,Rr,Br,resolveChildrenNamespace(at,Kr),oi,!1),Ir>0){if(Ir&16)qe(nt,at,si,Ai,Rr,Br,Kr);else if(Ir&2&&si.class!==Ai.class&&X(nt,"class",null,Ai.class,Kr),Ir&4&&X(nt,"style",si.style,Ai.style,Kr),Ir&8){const Ci=at.dynamicProps;for(let Wi=0;Wi<Ci.length;Wi++){const ki=Ci[Wi],Li=si[ki],mn=Ai[ki];(mn!==Li||ki==="value")&&X(nt,ki,Li,mn,Kr,et.children,Rr,Br,gi)}}Ir&1&&et.children!==at.children&&ae(nt,at.children)}else!ct&&Dr==null&&qe(nt,at,si,Ai,Rr,Br,Kr);((Oi=Ai.onVnodeUpdated)||ti)&&queuePostRenderEffect(()=>{Oi&&invokeVNodeHook(Oi,Rr,at,et),ti&&invokeDirectiveHook(at,et,Rr,"updated")},Br)},Le=(et,at,Rr,Br,Kr,oi,ct)=>{for(let nt=0;nt<at.length;nt++){const Ir=et[nt],Dr=at[nt],ti=Ir.el&&(Ir.type===Fragment||!isSameVNodeType(Ir,Dr)||Ir.shapeFlag&70)?le(Ir.el):Rr;xe(Ir,Dr,ti,null,Br,Kr,oi,ct,!0)}},qe=(et,at,Rr,Br,Kr,oi,ct)=>{if(Rr!==Br){if(Rr!==EMPTY_OBJ)for(const nt in Rr)!isReservedProp(nt)&&!(nt in Br)&&X(et,nt,Rr[nt],null,ct,at.children,Kr,oi,gi);for(const nt in Br){if(isReservedProp(nt))continue;const Ir=Br[nt],Dr=Rr[nt];Ir!==Dr&&nt!=="value"&&X(et,nt,Dr,Ir,ct,at.children,Kr,oi,gi)}"value"in Br&&X(et,"value",Rr.value,Br.value,ct)}},Qe=(et,at,Rr,Br,Kr,oi,ct,nt,Ir)=>{const Dr=at.el=et?et.el:Y(""),ti=at.anchor=et?et.anchor:Y("");let{patchFlag:si,dynamicChildren:Ai,slotScopeIds:Oi}=at;Oi&&(nt=nt?nt.concat(Oi):Oi),et==null?(E(Dr,Rr,Br),E(ti,Rr,Br),ze(at.children||[],Rr,ti,Kr,oi,ct,nt,Ir)):si>0&&si&64&&Ai&&et.dynamicChildren?(Le(et.dynamicChildren,Ai,Rr,Kr,oi,ct,nt),(at.key!=null||Kr&&at===Kr.subTree)&&traverseStaticChildren(et,at,!0)):st(et,at,Rr,ti,Kr,oi,ct,nt,Ir)},Ke=(et,at,Rr,Br,Kr,oi,ct,nt,Ir)=>{at.slotScopeIds=nt,et==null?at.shapeFlag&512?Kr.ctx.activate(at,Rr,Br,ct,Ir):Je(at,Rr,Br,Kr,oi,ct,Ir):pt(et,at,Ir)},Je=(et,at,Rr,Br,Kr,oi,ct)=>{const nt=et.component=createComponentInstance(et,Br,Kr);if(isKeepAlive(et)&&(nt.ctx.renderer=rt),setupComponent(nt),nt.asyncDep){if(Kr&&Kr.registerDep(nt,ut),!et.el){const Ir=nt.subTree=createVNode(Comment);Ae(null,Ir,at,Rr)}}else ut(nt,et,at,Rr,Kr,oi,ct)},pt=(et,at,Rr)=>{const Br=at.component=et.component;if(shouldUpdateComponent(et,at,Rr))if(Br.asyncDep&&!Br.asyncResolved){lt(Br,at,Rr);return}else Br.next=at,invalidateJob(Br.update),Br.effect.dirty=!0,Br.update();else at.el=et.el,Br.vnode=at},ut=(et,at,Rr,Br,Kr,oi,ct)=>{const nt=()=>{if(et.isMounted){let{next:ti,bu:si,u:Ai,parent:Oi,vnode:Ci}=et;{const cn=locateNonHydratedAsyncRoot(et);if(cn){ti&&(ti.el=Ci.el,lt(et,ti,ct)),cn.asyncDep.then(()=>{et.isUnmounted||nt()});return}}let Wi=ti,ki;toggleRecurse(et,!1),ti?(ti.el=Ci.el,lt(et,ti,ct)):ti=Ci,si&&invokeArrayFns(si),(ki=ti.props&&ti.props.onVnodeBeforeUpdate)&&invokeVNodeHook(ki,Oi,ti,Ci),toggleRecurse(et,!0);const Li=renderComponentRoot(et),mn=et.subTree;et.subTree=Li,xe(mn,Li,le(mn.el),fi(mn),et,Kr,oi),ti.el=Li.el,Wi===null&&updateHOCHostEl(et,Li.el),Ai&&queuePostRenderEffect(Ai,Kr),(ki=ti.props&&ti.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(ki,Oi,ti,Ci),Kr)}else{let ti;const{el:si,props:Ai}=at,{bm:Oi,m:Ci,parent:Wi}=et,ki=isAsyncWrapper(at);if(toggleRecurse(et,!1),Oi&&invokeArrayFns(Oi),!ki&&(ti=Ai&&Ai.onVnodeBeforeMount)&&invokeVNodeHook(ti,Wi,at),toggleRecurse(et,!0),si&&Or){const Li=()=>{et.subTree=renderComponentRoot(et),Or(si,et.subTree,et,Kr,null)};ki?at.type.__asyncLoader().then(()=>!et.isUnmounted&&Li()):Li()}else{const Li=et.subTree=renderComponentRoot(et);xe(null,Li,Rr,Br,et,Kr,oi),at.el=Li.el}if(Ci&&queuePostRenderEffect(Ci,Kr),!ki&&(ti=Ai&&Ai.onVnodeMounted)){const Li=at;queuePostRenderEffect(()=>invokeVNodeHook(ti,Wi,Li),Kr)}(at.shapeFlag&256||Wi&&isAsyncWrapper(Wi.vnode)&&Wi.vnode.shapeFlag&256)&&et.a&&queuePostRenderEffect(et.a,Kr),et.isMounted=!0,at=Rr=Br=null}},Ir=et.effect=new ReactiveEffect(nt,NOOP,()=>queueJob(Dr),et.scope),Dr=et.update=()=>{Ir.dirty&&Ir.run()};Dr.id=et.uid,toggleRecurse(et,!0),Dr()},lt=(et,at,Rr)=>{at.component=et;const Br=et.vnode.props;et.vnode=at,et.next=null,updateProps(et,at.props,Br,Rr),updateSlots(et,at.children,Rr),pauseTracking(),flushPreFlushCbs(et),resetTracking()},st=(et,at,Rr,Br,Kr,oi,ct,nt,Ir=!1)=>{const Dr=et&&et.children,ti=et?et.shapeFlag:0,si=at.children,{patchFlag:Ai,shapeFlag:Oi}=at;if(Ai>0){if(Ai&128){mt(Dr,si,Rr,Br,Kr,oi,ct,nt,Ir);return}else if(Ai&256){sr(Dr,si,Rr,Br,Kr,oi,ct,nt,Ir);return}}Oi&8?(ti&16&&gi(Dr,Kr,oi),si!==Dr&&ae(Rr,si)):ti&16?Oi&16?mt(Dr,si,Rr,Br,Kr,oi,ct,nt,Ir):gi(Dr,Kr,oi,!0):(ti&8&&ae(Rr,""),Oi&16&&ze(si,Rr,Br,Kr,oi,ct,nt,Ir))},sr=(et,at,Rr,Br,Kr,oi,ct,nt,Ir)=>{et=et||EMPTY_ARR,at=at||EMPTY_ARR;const Dr=et.length,ti=at.length,si=Math.min(Dr,ti);let Ai;for(Ai=0;Ai<si;Ai++){const Oi=at[Ai]=Ir?cloneIfMounted(at[Ai]):normalizeVNode(at[Ai]);xe(et[Ai],Oi,Rr,null,Kr,oi,ct,nt,Ir)}Dr>ti?gi(et,Kr,oi,!0,!1,si):ze(at,Rr,Br,Kr,oi,ct,nt,Ir,si)},mt=(et,at,Rr,Br,Kr,oi,ct,nt,Ir)=>{let Dr=0;const ti=at.length;let si=et.length-1,Ai=ti-1;for(;Dr<=si&&Dr<=Ai;){const Oi=et[Dr],Ci=at[Dr]=Ir?cloneIfMounted(at[Dr]):normalizeVNode(at[Dr]);if(isSameVNodeType(Oi,Ci))xe(Oi,Ci,Rr,null,Kr,oi,ct,nt,Ir);else break;Dr++}for(;Dr<=si&&Dr<=Ai;){const Oi=et[si],Ci=at[Ai]=Ir?cloneIfMounted(at[Ai]):normalizeVNode(at[Ai]);if(isSameVNodeType(Oi,Ci))xe(Oi,Ci,Rr,null,Kr,oi,ct,nt,Ir);else break;si--,Ai--}if(Dr>si){if(Dr<=Ai){const Oi=Ai+1,Ci=Oi<ti?at[Oi].el:Br;for(;Dr<=Ai;)xe(null,at[Dr]=Ir?cloneIfMounted(at[Dr]):normalizeVNode(at[Dr]),Rr,Ci,Kr,oi,ct,nt,Ir),Dr++}}else if(Dr>Ai)for(;Dr<=si;)di(et[Dr],Kr,oi,!0),Dr++;else{const Oi=Dr,Ci=Dr,Wi=new Map;for(Dr=Ci;Dr<=Ai;Dr++){const Hr=at[Dr]=Ir?cloneIfMounted(at[Dr]):normalizeVNode(at[Dr]);Hr.key!=null&&Wi.set(Hr.key,Dr)}let ki,Li=0;const mn=Ai-Ci+1;let cn=!1,qi=0;const wn=new Array(mn);for(Dr=0;Dr<mn;Dr++)wn[Dr]=0;for(Dr=Oi;Dr<=si;Dr++){const Hr=et[Dr];if(Li>=mn){di(Hr,Kr,oi,!0);continue}let vi;if(Hr.key!=null)vi=Wi.get(Hr.key);else for(ki=Ci;ki<=Ai;ki++)if(wn[ki-Ci]===0&&isSameVNodeType(Hr,at[ki])){vi=ki;break}vi===void 0?di(Hr,Kr,oi,!0):(wn[vi-Ci]=Dr+1,vi>=qi?qi=vi:cn=!0,xe(Hr,at[vi],Rr,null,Kr,oi,ct,nt,Ir),Li++)}const An=cn?getSequence(wn):EMPTY_ARR;for(ki=An.length-1,Dr=mn-1;Dr>=0;Dr--){const Hr=Ci+Dr,vi=at[Hr],Lr=Hr+1<ti?at[Hr+1].el:Br;wn[Dr]===0?xe(null,vi,Rr,Lr,Kr,oi,ct,nt,Ir):cn&&(ki<0||Dr!==An[ki]?Tr(vi,Rr,Lr,2):ki--)}}},Tr=(et,at,Rr,Br,Kr=null)=>{const{el:oi,type:ct,transition:nt,children:Ir,shapeFlag:Dr}=et;if(Dr&6){Tr(et.component.subTree,at,Rr,Br);return}if(Dr&128){et.suspense.move(at,Rr,Br);return}if(Dr&64){ct.move(et,at,Rr,rt);return}if(ct===Fragment){E(oi,at,Rr);for(let si=0;si<Ir.length;si++)Tr(Ir[si],at,Rr,Br);E(et.anchor,at,Rr);return}if(ct===Static){Ve(et,at,Rr);return}if(Br!==2&&Dr&1&&nt)if(Br===0)nt.beforeEnter(oi),E(oi,at,Rr),queuePostRenderEffect(()=>nt.enter(oi),Kr);else{const{leave:si,delayLeave:Ai,afterLeave:Oi}=nt,Ci=()=>E(oi,at,Rr),Wi=()=>{si(oi,()=>{Ci(),Oi&&Oi()})};Ai?Ai(oi,Ci,Wi):Wi()}else E(oi,at,Rr)},di=(et,at,Rr,Br=!1,Kr=!1)=>{const{type:oi,props:ct,ref:nt,children:Ir,dynamicChildren:Dr,shapeFlag:ti,patchFlag:si,dirs:Ai}=et;if(nt!=null&&setRef(nt,null,Rr,et,!0),ti&256){at.ctx.deactivate(et);return}const Oi=ti&1&&Ai,Ci=!isAsyncWrapper(et);let Wi;if(Ci&&(Wi=ct&&ct.onVnodeBeforeUnmount)&&invokeVNodeHook(Wi,at,et),ti&6)ci(et.component,Rr,Br);else{if(ti&128){et.suspense.unmount(Rr,Br);return}Oi&&invokeDirectiveHook(et,null,at,"beforeUnmount"),ti&64?et.type.remove(et,at,Rr,Kr,rt,Br):Dr&&(oi!==Fragment||si>0&&si&64)?gi(Dr,at,Rr,!1,!0):(oi===Fragment&&si&384||!Kr&&ti&16)&&gi(Ir,at,Rr),Br&&Mi(et)}(Ci&&(Wi=ct&&ct.onVnodeUnmounted)||Oi)&&queuePostRenderEffect(()=>{Wi&&invokeVNodeHook(Wi,at,et),Oi&&invokeDirectiveHook(et,null,at,"unmounted")},Rr)},Mi=et=>{const{type:at,el:Rr,anchor:Br,transition:Kr}=et;if(at===Fragment){Gr(Rr,Br);return}if(at===Static){$e(et);return}const oi=()=>{W(Rr),Kr&&!Kr.persisted&&Kr.afterLeave&&Kr.afterLeave()};if(et.shapeFlag&1&&Kr&&!Kr.persisted){const{leave:ct,delayLeave:nt}=Kr,Ir=()=>ct(Rr,oi);nt?nt(et.el,oi,Ir):Ir()}else oi()},Gr=(et,at)=>{let Rr;for(;et!==at;)Rr=ue(et),W(et),et=Rr;W(at)},ci=(et,at,Rr)=>{const{bum:Br,scope:Kr,update:oi,subTree:ct,um:nt}=et;Br&&invokeArrayFns(Br),Kr.stop(),oi&&(oi.active=!1,di(ct,et,at,Rr)),nt&&queuePostRenderEffect(nt,at),queuePostRenderEffect(()=>{et.isUnmounted=!0},at),at&&at.pendingBranch&&!at.isUnmounted&&et.asyncDep&&!et.asyncResolved&&et.suspenseId===at.pendingId&&(at.deps--,at.deps===0&&at.resolve())},gi=(et,at,Rr,Br=!1,Kr=!1,oi=0)=>{for(let ct=oi;ct<et.length;ct++)di(et[ct],at,Rr,Br,Kr)},fi=et=>et.shapeFlag&6?fi(et.component.subTree):et.shapeFlag&128?et.suspense.next():ue(et.anchor||et.el);let ri=!1;const ot=(et,at,Rr)=>{et==null?at._vnode&&di(at._vnode,null,null,!0):xe(at._vnode||null,et,at,null,null,null,Rr),ri||(ri=!0,flushPreFlushCbs(),flushPostFlushCbs(),ri=!1),at._vnode=et},rt={p:xe,um:di,m:Tr,r:Mi,mt:Je,mc:ze,pc:st,pbc:Le,n:fi,o:B};let gt,Or;return _&&([gt,Or]=_(rt)),{render:ot,hydrate:gt,createApp:createAppAPI(ot,gt)}}function resolveChildrenNamespace({type:B,props:_},T){return T==="svg"&&B==="foreignObject"||T==="mathml"&&B==="annotation-xml"&&_&&_.encoding&&_.encoding.includes("html")?void 0:T}function toggleRecurse({effect:B,update:_},T){B.allowRecurse=_.allowRecurse=T}function needTransition(B,_){return(!B||B&&!B.pendingBranch)&&_&&!_.persisted}function traverseStaticChildren(B,_,T=!1){const E=B.children,W=_.children;if(isArray$4(E)&&isArray$4(W))for(let X=0;X<E.length;X++){const q=E[X];let Y=W[X];Y.shapeFlag&1&&!Y.dynamicChildren&&((Y.patchFlag<=0||Y.patchFlag===32)&&(Y=W[X]=cloneIfMounted(W[X]),Y.el=q.el),T||traverseStaticChildren(q,Y)),Y.type===Text$2&&(Y.el=q.el)}}function getSequence(B){const _=B.slice(),T=[0];let E,W,X,q,Y;const te=B.length;for(E=0;E<te;E++){const ne=B[E];if(ne!==0){if(W=T[T.length-1],B[W]<ne){_[E]=W,T.push(E);continue}for(X=0,q=T.length-1;X<q;)Y=X+q>>1,B[T[Y]]<ne?X=Y+1:q=Y;ne<B[T[X]]&&(X>0&&(_[E]=T[X-1]),T[X]=E)}}for(X=T.length,q=T[X-1];X-- >0;)T[X]=q,q=_[q];return T}function locateNonHydratedAsyncRoot(B){const _=B.subTree.component;if(_)return _.asyncDep&&!_.asyncResolved?_:locateNonHydratedAsyncRoot(_)}const isTeleport=B=>B.__isTeleport,isTeleportDisabled=B=>B&&(B.disabled||B.disabled===""),isTargetSVG=B=>typeof SVGElement<"u"&&B instanceof SVGElement,isTargetMathML=B=>typeof MathMLElement=="function"&&B instanceof MathMLElement,resolveTarget=(B,_)=>{const T=B&&B.to;return isString$1(T)?_?_(T):null:T},TeleportImpl={name:"Teleport",__isTeleport:!0,process(B,_,T,E,W,X,q,Y,te,ne){const{mc:ae,pc:le,pbc:ue,o:{insert:ge,querySelector:ye,createText:xe,createComment:Te}}=ne,Ae=isTeleportDisabled(_.props);let{shapeFlag:Ie,children:Ve,dynamicChildren:$e}=_;if(B==null){const We=_.el=xe(""),Ue=_.anchor=xe("");ge(We,T,E),ge(Ue,T,E);const je=_.target=resolveTarget(_.props,ye),ze=_.targetAnchor=xe("");je&&(ge(ze,je),q==="svg"||isTargetSVG(je)?q="svg":(q==="mathml"||isTargetMathML(je))&&(q="mathml"));const He=(Le,qe)=>{Ie&16&&ae(Ve,Le,qe,W,X,q,Y,te)};Ae?He(T,Ue):je&&He(je,ze)}else{_.el=B.el;const We=_.anchor=B.anchor,Ue=_.target=B.target,je=_.targetAnchor=B.targetAnchor,ze=isTeleportDisabled(B.props),He=ze?T:Ue,Le=ze?We:je;if(q==="svg"||isTargetSVG(Ue)?q="svg":(q==="mathml"||isTargetMathML(Ue))&&(q="mathml"),$e?(ue(B.dynamicChildren,$e,He,W,X,q,Y),traverseStaticChildren(B,_,!0)):te||le(B,_,He,Le,W,X,q,Y,!1),Ae)ze?_.props&&B.props&&_.props.to!==B.props.to&&(_.props.to=B.props.to):moveTeleport(_,T,We,ne,1);else if((_.props&&_.props.to)!==(B.props&&B.props.to)){const qe=_.target=resolveTarget(_.props,ye);qe&&moveTeleport(_,qe,null,ne,0)}else ze&&moveTeleport(_,Ue,je,ne,1)}updateCssVars(_)},remove(B,_,T,E,{um:W,o:{remove:X}},q){const{shapeFlag:Y,children:te,anchor:ne,targetAnchor:ae,target:le,props:ue}=B;if(le&&X(ae),q&&X(ne),Y&16){const ge=q||!isTeleportDisabled(ue);for(let ye=0;ye<te.length;ye++){const xe=te[ye];W(xe,_,T,ge,!!xe.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(B,_,T,{o:{insert:E},m:W},X=2){X===0&&E(B.targetAnchor,_,T);const{el:q,anchor:Y,shapeFlag:te,children:ne,props:ae}=B,le=X===2;if(le&&E(q,_,T),(!le||isTeleportDisabled(ae))&&te&16)for(let ue=0;ue<ne.length;ue++)W(ne[ue],_,T,2);le&&E(Y,_,T)}function hydrateTeleport(B,_,T,E,W,X,{o:{nextSibling:q,parentNode:Y,querySelector:te}},ne){const ae=_.target=resolveTarget(_.props,te);if(ae){const le=ae._lpa||ae.firstChild;if(_.shapeFlag&16)if(isTeleportDisabled(_.props))_.anchor=ne(q(B),_,Y(B),T,E,W,X),_.targetAnchor=le;else{_.anchor=q(B);let ue=le;for(;ue;)if(ue=q(ue),ue&&ue.nodeType===8&&ue.data==="teleport anchor"){_.targetAnchor=ue,ae._lpa=_.targetAnchor&&q(_.targetAnchor);break}ne(le,_,ae,T,E,W,X)}updateCssVars(_)}return _.anchor&&q(_.anchor)}const Teleport=TeleportImpl;function updateCssVars(B){const _=B.ctx;if(_&&_.ut){let T=B.children[0].el;for(;T&&T!==B.targetAnchor;)T.nodeType===1&&T.setAttribute("data-v-owner",_.uid),T=T.nextSibling;_.ut()}}const Fragment=Symbol.for("v-fgt"),Text$2=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(B=!1){blockStack.push(currentBlock=B?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(B){isBlockTreeEnabled+=B}function setupBlock(B){return B.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(B),B}function createElementBlock(B,_,T,E,W,X){return setupBlock(createBaseVNode(B,_,T,E,W,X,!0))}function createBlock(B,_,T,E,W){return setupBlock(createVNode(B,_,T,E,W,!0))}function isVNode(B){return B?B.__v_isVNode===!0:!1}function isSameVNodeType(B,_){return B.type===_.type&&B.key===_.key}function transformVNodeArgs(B){}const normalizeKey=({key:B})=>B??null,normalizeRef=({ref:B,ref_key:_,ref_for:T})=>(typeof B=="number"&&(B=""+B),B!=null?isString$1(B)||isRef(B)||isFunction(B)?{i:currentRenderingInstance,r:B,k:_,f:!!T}:B:null);function createBaseVNode(B,_=null,T=null,E=0,W=null,X=B===Fragment?0:1,q=!1,Y=!1){const te={__v_isVNode:!0,__v_skip:!0,type:B,props:_,key:_&&normalizeKey(_),ref:_&&normalizeRef(_),scopeId:currentScopeId,slotScopeIds:null,children:T,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:X,patchFlag:E,dynamicProps:W,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return Y?(normalizeChildren(te,T),X&128&&B.normalize(te)):T&&(te.shapeFlag|=isString$1(T)?8:16),isBlockTreeEnabled>0&&!q&&currentBlock&&(te.patchFlag>0||X&6)&&te.patchFlag!==32&&currentBlock.push(te),te}const createVNode=_createVNode;function _createVNode(B,_=null,T=null,E=0,W=null,X=!1){if((!B||B===NULL_DYNAMIC_COMPONENT)&&(B=Comment),isVNode(B)){const Y=cloneVNode(B,_,!0);return T&&normalizeChildren(Y,T),isBlockTreeEnabled>0&&!X&&currentBlock&&(Y.shapeFlag&6?currentBlock[currentBlock.indexOf(B)]=Y:currentBlock.push(Y)),Y.patchFlag|=-2,Y}if(isClassComponent(B)&&(B=B.__vccOpts),_){_=guardReactiveProps(_);let{class:Y,style:te}=_;Y&&!isString$1(Y)&&(_.class=normalizeClass(Y)),isObject$3(te)&&(isProxy(te)&&!isArray$4(te)&&(te=extend$1({},te)),_.style=normalizeStyle(te))}const q=isString$1(B)?1:isSuspense(B)?128:isTeleport(B)?64:isObject$3(B)?4:isFunction(B)?2:0;return createBaseVNode(B,_,T,E,W,q,X,!0)}function guardReactiveProps(B){return B?isProxy(B)||isInternalObject(B)?extend$1({},B):B:null}function cloneVNode(B,_,T=!1,E=!1){const{props:W,ref:X,patchFlag:q,children:Y,transition:te}=B,ne=_?mergeProps(W||{},_):W,ae={__v_isVNode:!0,__v_skip:!0,type:B.type,props:ne,key:ne&&normalizeKey(ne),ref:_&&_.ref?T&&X?isArray$4(X)?X.concat(normalizeRef(_)):[X,normalizeRef(_)]:normalizeRef(_):X,scopeId:B.scopeId,slotScopeIds:B.slotScopeIds,children:Y,target:B.target,targetAnchor:B.targetAnchor,staticCount:B.staticCount,shapeFlag:B.shapeFlag,patchFlag:_&&B.type!==Fragment?q===-1?16:q|16:q,dynamicProps:B.dynamicProps,dynamicChildren:B.dynamicChildren,appContext:B.appContext,dirs:B.dirs,transition:te,component:B.component,suspense:B.suspense,ssContent:B.ssContent&&cloneVNode(B.ssContent),ssFallback:B.ssFallback&&cloneVNode(B.ssFallback),el:B.el,anchor:B.anchor,ctx:B.ctx,ce:B.ce};return te&&E&&(ae.transition=te.clone(ae)),ae}function createTextVNode(B=" ",_=0){return createVNode(Text$2,null,B,_)}function createStaticVNode(B,_){const T=createVNode(Static,null,B);return T.staticCount=_,T}function createCommentVNode(B="",_=!1){return _?(openBlock(),createBlock(Comment,null,B)):createVNode(Comment,null,B)}function normalizeVNode(B){return B==null||typeof B=="boolean"?createVNode(Comment):isArray$4(B)?createVNode(Fragment,null,B.slice()):typeof B=="object"?cloneIfMounted(B):createVNode(Text$2,null,String(B))}function cloneIfMounted(B){return B.el===null&&B.patchFlag!==-1||B.memo?B:cloneVNode(B)}function normalizeChildren(B,_){let T=0;const{shapeFlag:E}=B;if(_==null)_=null;else if(isArray$4(_))T=16;else if(typeof _=="object")if(E&65){const W=_.default;W&&(W._c&&(W._d=!1),normalizeChildren(B,W()),W._c&&(W._d=!0));return}else{T=32;const W=_._;!W&&!isInternalObject(_)?_._ctx=currentRenderingInstance:W===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?_._=1:(_._=2,B.patchFlag|=1024))}else isFunction(_)?(_={default:_,_ctx:currentRenderingInstance},T=32):(_=String(_),E&64?(T=16,_=[createTextVNode(_)]):T=8);B.children=_,B.shapeFlag|=T}function mergeProps(...B){const _={};for(let T=0;T<B.length;T++){const E=B[T];for(const W in E)if(W==="class")_.class!==E.class&&(_.class=normalizeClass([_.class,E.class]));else if(W==="style")_.style=normalizeStyle([_.style,E.style]);else if(isOn(W)){const X=_[W],q=E[W];q&&X!==q&&!(isArray$4(X)&&X.includes(q))&&(_[W]=X?[].concat(X,q):q)}else W!==""&&(_[W]=E[W])}return _}function invokeVNodeHook(B,_,T,E=null){callWithAsyncErrorHandling(B,_,7,[T,E])}const emptyAppContext=createAppContext();let uid$2=0;function createComponentInstance(B,_,T){const E=B.type,W=(_?_.appContext:B.appContext)||emptyAppContext,X={uid:uid$2++,vnode:B,type:E,parent:_,appContext:W,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:_?_.provides:Object.create(W.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(E,W),emitsOptions:normalizeEmitsOptions(E,W),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:E.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:T,suspenseId:T?T.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return X.ctx={_:X},X.root=_?_.root:X,X.emit=emit.bind(null,X),B.ce&&B.ce(X),X}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const B=getGlobalThis(),_=(T,E)=>{let W;return(W=B[T])||(W=B[T]=[]),W.push(E),X=>{W.length>1?W.forEach(q=>q(X)):W[0](X)}};internalSetCurrentInstance=_("__VUE_INSTANCE_SETTERS__",T=>currentInstance=T),setInSSRSetupState=_("__VUE_SSR_SETTERS__",T=>isInSSRComponentSetup=T)}const setCurrentInstance=B=>{const _=currentInstance;return internalSetCurrentInstance(B),B.scope.on(),()=>{B.scope.off(),internalSetCurrentInstance(_)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(B){return B.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(B,_=!1){_&&setInSSRSetupState(_);const{props:T,children:E}=B.vnode,W=isStatefulComponent(B);initProps(B,T,W,_),initSlots(B,E);const X=W?setupStatefulComponent(B,_):void 0;return _&&setInSSRSetupState(!1),X}function setupStatefulComponent(B,_){const T=B.type;B.accessCache=Object.create(null),B.proxy=new Proxy(B.ctx,PublicInstanceProxyHandlers);const{setup:E}=T;if(E){const W=B.setupContext=E.length>1?createSetupContext(B):null,X=setCurrentInstance(B);pauseTracking();const q=callWithErrorHandling(E,B,0,[B.props,W]);if(resetTracking(),X(),isPromise(q)){if(q.then(unsetCurrentInstance,unsetCurrentInstance),_)return q.then(Y=>{handleSetupResult(B,Y,_)}).catch(Y=>{handleError(Y,B,0)});B.asyncDep=q}else handleSetupResult(B,q,_)}else finishComponentSetup(B,_)}function handleSetupResult(B,_,T){isFunction(_)?B.type.__ssrInlineRender?B.ssrRender=_:B.render=_:isObject$3(_)&&(B.setupState=proxyRefs(_)),finishComponentSetup(B,T)}let compile$1,installWithProxy;function registerRuntimeCompiler(B){compile$1=B,installWithProxy=_=>{_.render._rc&&(_.withProxy=new Proxy(_.ctx,RuntimeCompiledPublicInstanceProxyHandlers))}}const isRuntimeOnly=()=>!compile$1;function finishComponentSetup(B,_,T){const E=B.type;if(!B.render){if(!_&&compile$1&&!E.render){const W=E.template||resolveMergedOptions(B).template;if(W){const{isCustomElement:X,compilerOptions:q}=B.appContext.config,{delimiters:Y,compilerOptions:te}=E,ne=extend$1(extend$1({isCustomElement:X,delimiters:Y},q),te);E.render=compile$1(W,ne)}}B.render=E.render||NOOP,installWithProxy&&installWithProxy(B)}{const W=setCurrentInstance(B);pauseTracking();try{applyOptions(B)}finally{resetTracking(),W()}}}const attrsProxyHandlers={get(B,_){return track(B,"get",""),B[_]}};function createSetupContext(B){const _=T=>{B.exposed=T||{}};return{attrs:new Proxy(B.attrs,attrsProxyHandlers),slots:B.slots,emit:B.emit,expose:_}}function getExposeProxy(B){if(B.exposed)return B.exposeProxy||(B.exposeProxy=new Proxy(proxyRefs(markRaw(B.exposed)),{get(_,T){if(T in _)return _[T];if(T in publicPropertiesMap)return publicPropertiesMap[T](B)},has(_,T){return T in _||T in publicPropertiesMap}}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=B=>B.replace(classifyRE,_=>_.toUpperCase()).replace(/[-_]/g,"");function getComponentName(B,_=!0){return isFunction(B)?B.displayName||B.name:B.name||_&&B.__name}function formatComponentName(B,_,T=!1){let E=getComponentName(_);if(!E&&_.__file){const W=_.__file.match(/([^/\\]+)\.\w+$/);W&&(E=W[1])}if(!E&&B&&B.parent){const W=X=>{for(const q in X)if(X[q]===_)return q};E=W(B.components||B.parent.type.components)||W(B.appContext.components)}return E?classify(E):T?"App":"Anonymous"}function isClassComponent(B){return isFunction(B)&&"__vccOpts"in B}const computed=(B,_)=>computed$1(B,_,isInSSRComponentSetup);function useModel(B,_,T=EMPTY_OBJ){const E=getCurrentInstance(),W=camelize(_),X=hyphenate(_),q=customRef((te,ne)=>{let ae;return watchSyncEffect(()=>{const le=B[_];hasChanged(ae,le)&&(ae=le,ne())}),{get(){return te(),T.get?T.get(ae):ae},set(le){const ue=E.vnode.props;!(ue&&(_ in ue||W in ue||X in ue)&&(`onUpdate:${_}`in ue||`onUpdate:${W}`in ue||`onUpdate:${X}`in ue))&&hasChanged(le,ae)&&(ae=le,ne()),E.emit(`update:${_}`,T.set?T.set(le):le)}}}),Y=_==="modelValue"?"modelModifiers":`${_}Modifiers`;return q[Symbol.iterator]=()=>{let te=0;return{next(){return te<2?{value:te++?B[Y]||{}:q,done:!1}:{done:!0}}}},q}function h$1(B,_,T){const E=arguments.length;return E===2?isObject$3(_)&&!isArray$4(_)?isVNode(_)?createVNode(B,null,[_]):createVNode(B,_):createVNode(B,null,_):(E>3?T=Array.prototype.slice.call(arguments,2):E===3&&isVNode(T)&&(T=[T]),createVNode(B,_,T))}function initCustomFormatter(){}function withMemo(B,_,T,E){const W=T[E];if(W&&isMemoSame(W,B))return W;const X=_();return X.memo=B.slice(),T[E]=X}function isMemoSame(B,_){const T=B.memo;if(T.length!=_.length)return!1;for(let E=0;E<T.length;E++)if(hasChanged(T[E],_[E]))return!1;return isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(B),!0}const version="3.4.27",warn=NOOP,ErrorTypeStrings=ErrorTypeStrings$1,devtools=devtools$1,setDevtoolsHook=setDevtoolsHook$1,_ssrUtils={createComponentInstance,setupComponent,renderComponentRoot,setCurrentRenderingInstance,isVNode,normalizeVNode},ssrUtils=_ssrUtils,resolveFilter=null,compatUtils=null,DeprecationTypes=null;/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc$1=typeof document<"u"?document:null,templateContainer=doc$1&&doc$1.createElement("template"),nodeOps={insert:(B,_,T)=>{_.insertBefore(B,T||null)},remove:B=>{const _=B.parentNode;_&&_.removeChild(B)},createElement:(B,_,T,E)=>{const W=_==="svg"?doc$1.createElementNS(svgNS,B):_==="mathml"?doc$1.createElementNS(mathmlNS,B):doc$1.createElement(B,T?{is:T}:void 0);return B==="select"&&E&&E.multiple!=null&&W.setAttribute("multiple",E.multiple),W},createText:B=>doc$1.createTextNode(B),createComment:B=>doc$1.createComment(B),setText:(B,_)=>{B.nodeValue=_},setElementText:(B,_)=>{B.textContent=_},parentNode:B=>B.parentNode,nextSibling:B=>B.nextSibling,querySelector:B=>doc$1.querySelector(B),setScopeId(B,_){B.setAttribute(_,"")},insertStaticContent(B,_,T,E,W,X){const q=T?T.previousSibling:_.lastChild;if(W&&(W===X||W.nextSibling))for(;_.insertBefore(W.cloneNode(!0),T),!(W===X||!(W=W.nextSibling)););else{templateContainer.innerHTML=E==="svg"?`<svg>${B}</svg>`:E==="mathml"?`<math>${B}</math>`:B;const Y=templateContainer.content;if(E==="svg"||E==="mathml"){const te=Y.firstChild;for(;te.firstChild;)Y.appendChild(te.firstChild);Y.removeChild(te)}_.insertBefore(Y,T)}return[q?q.nextSibling:_.firstChild,T?T.previousSibling:_.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition=(B,{slots:_})=>h$1(BaseTransition,resolveTransitionProps(B),_);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=Transition.props=extend$1({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),callHook=(B,_=[])=>{isArray$4(B)?B.forEach(T=>T(..._)):B&&B(..._)},hasExplicitCallback=B=>B?isArray$4(B)?B.some(_=>_.length>1):B.length>1:!1;function resolveTransitionProps(B){const _={};for(const Qe in B)Qe in DOMTransitionPropsValidators||(_[Qe]=B[Qe]);if(B.css===!1)return _;const{name:T="v",type:E,duration:W,enterFromClass:X=`${T}-enter-from`,enterActiveClass:q=`${T}-enter-active`,enterToClass:Y=`${T}-enter-to`,appearFromClass:te=X,appearActiveClass:ne=q,appearToClass:ae=Y,leaveFromClass:le=`${T}-leave-from`,leaveActiveClass:ue=`${T}-leave-active`,leaveToClass:ge=`${T}-leave-to`}=B,ye=normalizeDuration(W),xe=ye&&ye[0],Te=ye&&ye[1],{onBeforeEnter:Ae,onEnter:Ie,onEnterCancelled:Ve,onLeave:$e,onLeaveCancelled:We,onBeforeAppear:Ue=Ae,onAppear:je=Ie,onAppearCancelled:ze=Ve}=_,He=(Qe,Ke,Je)=>{removeTransitionClass(Qe,Ke?ae:Y),removeTransitionClass(Qe,Ke?ne:q),Je&&Je()},Le=(Qe,Ke)=>{Qe._isLeaving=!1,removeTransitionClass(Qe,le),removeTransitionClass(Qe,ge),removeTransitionClass(Qe,ue),Ke&&Ke()},qe=Qe=>(Ke,Je)=>{const pt=Qe?je:Ie,ut=()=>He(Ke,Qe,Je);callHook(pt,[Ke,ut]),nextFrame(()=>{removeTransitionClass(Ke,Qe?te:X),addTransitionClass(Ke,Qe?ae:Y),hasExplicitCallback(pt)||whenTransitionEnds(Ke,E,xe,ut)})};return extend$1(_,{onBeforeEnter(Qe){callHook(Ae,[Qe]),addTransitionClass(Qe,X),addTransitionClass(Qe,q)},onBeforeAppear(Qe){callHook(Ue,[Qe]),addTransitionClass(Qe,te),addTransitionClass(Qe,ne)},onEnter:qe(!1),onAppear:qe(!0),onLeave(Qe,Ke){Qe._isLeaving=!0;const Je=()=>Le(Qe,Ke);addTransitionClass(Qe,le),addTransitionClass(Qe,ue),forceReflow$1(),nextFrame(()=>{Qe._isLeaving&&(removeTransitionClass(Qe,le),addTransitionClass(Qe,ge),hasExplicitCallback($e)||whenTransitionEnds(Qe,E,Te,Je))}),callHook($e,[Qe,Je])},onEnterCancelled(Qe){He(Qe,!1),callHook(Ve,[Qe])},onAppearCancelled(Qe){He(Qe,!0),callHook(ze,[Qe])},onLeaveCancelled(Qe){Le(Qe),callHook(We,[Qe])}})}function normalizeDuration(B){if(B==null)return null;if(isObject$3(B))return[NumberOf(B.enter),NumberOf(B.leave)];{const _=NumberOf(B);return[_,_]}}function NumberOf(B){return toNumber(B)}function addTransitionClass(B,_){_.split(/\s+/).forEach(T=>T&&B.classList.add(T)),(B[vtcKey]||(B[vtcKey]=new Set)).add(_)}function removeTransitionClass(B,_){_.split(/\s+/).forEach(E=>E&&B.classList.remove(E));const T=B[vtcKey];T&&(T.delete(_),T.size||(B[vtcKey]=void 0))}function nextFrame(B){requestAnimationFrame(()=>{requestAnimationFrame(B)})}let endId=0;function whenTransitionEnds(B,_,T,E){const W=B._endId=++endId,X=()=>{W===B._endId&&E()};if(T)return setTimeout(X,T);const{type:q,timeout:Y,propCount:te}=getTransitionInfo(B,_);if(!q)return E();const ne=q+"end";let ae=0;const le=()=>{B.removeEventListener(ne,ue),X()},ue=ge=>{ge.target===B&&++ae>=te&&le()};setTimeout(()=>{ae<te&&le()},Y+1),B.addEventListener(ne,ue)}function getTransitionInfo(B,_){const T=window.getComputedStyle(B),E=ye=>(T[ye]||"").split(", "),W=E(`${TRANSITION}Delay`),X=E(`${TRANSITION}Duration`),q=getTimeout(W,X),Y=E(`${ANIMATION}Delay`),te=E(`${ANIMATION}Duration`),ne=getTimeout(Y,te);let ae=null,le=0,ue=0;_===TRANSITION?q>0&&(ae=TRANSITION,le=q,ue=X.length):_===ANIMATION?ne>0&&(ae=ANIMATION,le=ne,ue=te.length):(le=Math.max(q,ne),ae=le>0?q>ne?TRANSITION:ANIMATION:null,ue=ae?ae===TRANSITION?X.length:te.length:0);const ge=ae===TRANSITION&&/\b(transform|all)(,|$)/.test(E(`${TRANSITION}Property`).toString());return{type:ae,timeout:le,propCount:ue,hasTransform:ge}}function getTimeout(B,_){for(;B.length<_.length;)B=B.concat(B);return Math.max(..._.map((T,E)=>toMs(T)+toMs(B[E])))}function toMs(B){return B==="auto"?0:Number(B.slice(0,-1).replace(",","."))*1e3}function forceReflow$1(){return document.body.offsetHeight}function patchClass(B,_,T){const E=B[vtcKey];E&&(_=(_?[_,...E]:[...E]).join(" ")),_==null?B.removeAttribute("class"):T?B.setAttribute("class",_):B.className=_}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(B,{value:_},{transition:T}){B[vShowOriginalDisplay]=B.style.display==="none"?"":B.style.display,T&&_?T.beforeEnter(B):setDisplay(B,_)},mounted(B,{value:_},{transition:T}){T&&_&&T.enter(B)},updated(B,{value:_,oldValue:T},{transition:E}){!_!=!T&&(E?_?(E.beforeEnter(B),setDisplay(B,!0),E.enter(B)):E.leave(B,()=>{setDisplay(B,!1)}):setDisplay(B,_))},beforeUnmount(B,{value:_}){setDisplay(B,_)}};function setDisplay(B,_){B.style.display=_?B[vShowOriginalDisplay]:"none",B[vShowHidden]=!_}function initVShowForSSR(){vShow.getSSRProps=({value:B})=>{if(!B)return{style:{display:"none"}}}}const CSS_VAR_TEXT=Symbol("");function useCssVars(B){const _=getCurrentInstance();if(!_)return;const T=_.ut=(W=B(_.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${_.uid}"]`)).forEach(X=>setVarsOnNode(X,W))},E=()=>{const W=B(_.proxy);setVarsOnVNode(_.subTree,W),T(W)};onMounted(()=>{watchPostEffect(E);const W=new MutationObserver(E);W.observe(_.subTree.el.parentNode,{childList:!0}),onUnmounted(()=>W.disconnect())})}function setVarsOnVNode(B,_){if(B.shapeFlag&128){const T=B.suspense;B=T.activeBranch,T.pendingBranch&&!T.isHydrating&&T.effects.push(()=>{setVarsOnVNode(T.activeBranch,_)})}for(;B.component;)B=B.component.subTree;if(B.shapeFlag&1&&B.el)setVarsOnNode(B.el,_);else if(B.type===Fragment)B.children.forEach(T=>setVarsOnVNode(T,_));else if(B.type===Static){let{el:T,anchor:E}=B;for(;T&&(setVarsOnNode(T,_),T!==E);)T=T.nextSibling}}function setVarsOnNode(B,_){if(B.nodeType===1){const T=B.style;let E="";for(const W in _)T.setProperty(`--${W}`,_[W]),E+=`--${W}: ${_[W]};`;T[CSS_VAR_TEXT]=E}}const displayRE=/(^|;)\s*display\s*:/;function patchStyle(B,_,T){const E=B.style,W=isString$1(T);let X=!1;if(T&&!W){if(_)if(isString$1(_))for(const q of _.split(";")){const Y=q.slice(0,q.indexOf(":")).trim();T[Y]==null&&setStyle(E,Y,"")}else for(const q in _)T[q]==null&&setStyle(E,q,"");for(const q in T)q==="display"&&(X=!0),setStyle(E,q,T[q])}else if(W){if(_!==T){const q=E[CSS_VAR_TEXT];q&&(T+=";"+q),E.cssText=T,X=displayRE.test(T)}}else _&&B.removeAttribute("style");vShowOriginalDisplay in B&&(B[vShowOriginalDisplay]=X?E.display:"",B[vShowHidden]&&(E.display="none"))}const importantRE=/\s*!important$/;function setStyle(B,_,T){if(isArray$4(T))T.forEach(E=>setStyle(B,_,E));else if(T==null&&(T=""),_.startsWith("--"))B.setProperty(_,T);else{const E=autoPrefix(B,_);importantRE.test(T)?B.setProperty(hyphenate(E),T.replace(importantRE,""),"important"):B[E]=T}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(B,_){const T=prefixCache[_];if(T)return T;let E=camelize(_);if(E!=="filter"&&E in B)return prefixCache[_]=E;E=capitalize(E);for(let W=0;W<prefixes.length;W++){const X=prefixes[W]+E;if(X in B)return prefixCache[_]=X}return _}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(B,_,T,E,W){if(E&&_.startsWith("xlink:"))T==null?B.removeAttributeNS(xlinkNS,_.slice(6,_.length)):B.setAttributeNS(xlinkNS,_,T);else{const X=isSpecialBooleanAttr(_);T==null||X&&!includeBooleanAttr(T)?B.removeAttribute(_):B.setAttribute(_,X?"":T)}}function patchDOMProp(B,_,T,E,W,X,q){if(_==="innerHTML"||_==="textContent"){E&&q(E,W,X),B[_]=T??"";return}const Y=B.tagName;if(_==="value"&&Y!=="PROGRESS"&&!Y.includes("-")){const ne=Y==="OPTION"?B.getAttribute("value")||"":B.value,ae=T??"";(ne!==ae||!("_value"in B))&&(B.value=ae),T==null&&B.removeAttribute(_),B._value=T;return}let te=!1;if(T===""||T==null){const ne=typeof B[_];ne==="boolean"?T=includeBooleanAttr(T):T==null&&ne==="string"?(T="",te=!0):ne==="number"&&(T=0,te=!0)}try{B[_]=T}catch{}te&&B.removeAttribute(_)}function addEventListener(B,_,T,E){B.addEventListener(_,T,E)}function removeEventListener(B,_,T,E){B.removeEventListener(_,T,E)}const veiKey=Symbol("_vei");function patchEvent(B,_,T,E,W=null){const X=B[veiKey]||(B[veiKey]={}),q=X[_];if(E&&q)q.value=E;else{const[Y,te]=parseName(_);if(E){const ne=X[_]=createInvoker(E,W);addEventListener(B,Y,ne,te)}else q&&(removeEventListener(B,Y,q,te),X[_]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(B){let _;if(optionsModifierRE.test(B)){_={};let E;for(;E=B.match(optionsModifierRE);)B=B.slice(0,B.length-E[0].length),_[E[0].toLowerCase()]=!0}return[B[2]===":"?B.slice(3):hyphenate(B.slice(2)),_]}let cachedNow=0;const p$1=Promise.resolve(),getNow=()=>cachedNow||(p$1.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(B,_){const T=E=>{if(!E._vts)E._vts=Date.now();else if(E._vts<=T.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(E,T.value),_,5,[E])};return T.value=B,T.attached=getNow(),T}function patchStopImmediatePropagation(B,_){if(isArray$4(_)){const T=B.stopImmediatePropagation;return B.stopImmediatePropagation=()=>{T.call(B),B._stopped=!0},_.map(E=>W=>!W._stopped&&E&&E(W))}else return _}const isNativeOn=B=>B.charCodeAt(0)===111&&B.charCodeAt(1)===110&&B.charCodeAt(2)>96&&B.charCodeAt(2)<123,patchProp=(B,_,T,E,W,X,q,Y,te)=>{const ne=W==="svg";_==="class"?patchClass(B,E,ne):_==="style"?patchStyle(B,T,E):isOn(_)?isModelListener(_)||patchEvent(B,_,T,E,q):(_[0]==="."?(_=_.slice(1),!0):_[0]==="^"?(_=_.slice(1),!1):shouldSetAsProp(B,_,E,ne))?patchDOMProp(B,_,E,X,q,Y,te):(_==="true-value"?B._trueValue=E:_==="false-value"&&(B._falseValue=E),patchAttr(B,_,E,ne))};function shouldSetAsProp(B,_,T,E){if(E)return!!(_==="innerHTML"||_==="textContent"||_ in B&&isNativeOn(_)&&isFunction(T));if(_==="spellcheck"||_==="draggable"||_==="translate"||_==="form"||_==="list"&&B.tagName==="INPUT"||_==="type"&&B.tagName==="TEXTAREA")return!1;if(_==="width"||_==="height"){const W=B.tagName;if(W==="IMG"||W==="VIDEO"||W==="CANVAS"||W==="SOURCE")return!1}return isNativeOn(_)&&isString$1(T)?!1:_ in B}/*! #__NO_SIDE_EFFECTS__ */function defineCustomElement(B,_){const T=defineComponent(B);class E extends VueElement{constructor(X){super(T,X,_)}}return E.def=T,E}/*! #__NO_SIDE_EFFECTS__ */const defineSSRCustomElement=B=>defineCustomElement(B,hydrate),BaseClass=typeof HTMLElement<"u"?HTMLElement:class{};class VueElement extends BaseClass{constructor(_,T={},E){super(),this._def=_,this._props=T,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this._ob=null,this.shadowRoot&&E?E(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,this._ob&&(this._ob.disconnect(),this._ob=null),nextTick(()=>{this._connected||(render(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let E=0;E<this.attributes.length;E++)this._setAttr(this.attributes[E].name);this._ob=new MutationObserver(E=>{for(const W of E)this._setAttr(W.attributeName)}),this._ob.observe(this,{attributes:!0});const _=(E,W=!1)=>{const{props:X,styles:q}=E;let Y;if(X&&!isArray$4(X))for(const te in X){const ne=X[te];(ne===Number||ne&&ne.type===Number)&&(te in this._props&&(this._props[te]=toNumber(this._props[te])),(Y||(Y=Object.create(null)))[camelize(te)]=!0)}this._numberProps=Y,W&&this._resolveProps(E),this._applyStyles(q),this._update()},T=this._def.__asyncLoader;T?T().then(E=>_(E,!0)):_(this._def)}_resolveProps(_){const{props:T}=_,E=isArray$4(T)?T:Object.keys(T||{});for(const W of Object.keys(this))W[0]!=="_"&&E.includes(W)&&this._setProp(W,this[W],!0,!1);for(const W of E.map(camelize))Object.defineProperty(this,W,{get(){return this._getProp(W)},set(X){this._setProp(W,X)}})}_setAttr(_){let T=this.hasAttribute(_)?this.getAttribute(_):void 0;const E=camelize(_);this._numberProps&&this._numberProps[E]&&(T=toNumber(T)),this._setProp(E,T,!1)}_getProp(_){return this._props[_]}_setProp(_,T,E=!0,W=!0){T!==this._props[_]&&(this._props[_]=T,W&&this._instance&&this._update(),E&&(T===!0?this.setAttribute(hyphenate(_),""):typeof T=="string"||typeof T=="number"?this.setAttribute(hyphenate(_),T+""):T||this.removeAttribute(hyphenate(_))))}_update(){render(this._createVNode(),this.shadowRoot)}_createVNode(){const _=createVNode(this._def,extend$1({},this._props));return this._instance||(_.ce=T=>{this._instance=T,T.isCE=!0;const E=(X,q)=>{this.dispatchEvent(new CustomEvent(X,{detail:q}))};T.emit=(X,...q)=>{E(X,q),hyphenate(X)!==X&&E(hyphenate(X),q)};let W=this;for(;W=W&&(W.parentNode||W.host);)if(W instanceof VueElement){T.parent=W._instance,T.provides=W._instance.provides;break}}),_}_applyStyles(_){_&&_.forEach(T=>{const E=document.createElement("style");E.textContent=T,this.shadowRoot.appendChild(E)})}}function useCssModule(B="$style"){{const _=getCurrentInstance();if(!_)return EMPTY_OBJ;const T=_.type.__cssModules;if(!T)return EMPTY_OBJ;const E=T[B];return E||EMPTY_OBJ}}const positionMap=new WeakMap,newPositionMap=new WeakMap,moveCbKey=Symbol("_moveCb"),enterCbKey=Symbol("_enterCb"),TransitionGroupImpl={name:"TransitionGroup",props:extend$1({},TransitionPropsValidators,{tag:String,moveClass:String}),setup(B,{slots:_}){const T=getCurrentInstance(),E=useTransitionState();let W,X;return onUpdated(()=>{if(!W.length)return;const q=B.moveClass||`${B.name||"v"}-move`;if(!hasCSSTransform(W[0].el,T.vnode.el,q))return;W.forEach(callPendingCbs),W.forEach(recordPosition);const Y=W.filter(applyTranslation);forceReflow$1(),Y.forEach(te=>{const ne=te.el,ae=ne.style;addTransitionClass(ne,q),ae.transform=ae.webkitTransform=ae.transitionDuration="";const le=ne[moveCbKey]=ue=>{ue&&ue.target!==ne||(!ue||/transform$/.test(ue.propertyName))&&(ne.removeEventListener("transitionend",le),ne[moveCbKey]=null,removeTransitionClass(ne,q))};ne.addEventListener("transitionend",le)})}),()=>{const q=toRaw(B),Y=resolveTransitionProps(q);let te=q.tag||Fragment;if(W=[],X)for(let ne=0;ne<X.length;ne++){const ae=X[ne];ae.el&&ae.el instanceof Element&&(W.push(ae),setTransitionHooks(ae,resolveTransitionHooks(ae,Y,E,T)),positionMap.set(ae,ae.el.getBoundingClientRect()))}X=_.default?getTransitionRawChildren(_.default()):[];for(let ne=0;ne<X.length;ne++){const ae=X[ne];ae.key!=null&&setTransitionHooks(ae,resolveTransitionHooks(ae,Y,E,T))}return createVNode(te,null,X)}}},removeMode=B=>delete B.mode;TransitionGroupImpl.props;const TransitionGroup=TransitionGroupImpl;function callPendingCbs(B){const _=B.el;_[moveCbKey]&&_[moveCbKey](),_[enterCbKey]&&_[enterCbKey]()}function recordPosition(B){newPositionMap.set(B,B.el.getBoundingClientRect())}function applyTranslation(B){const _=positionMap.get(B),T=newPositionMap.get(B),E=_.left-T.left,W=_.top-T.top;if(E||W){const X=B.el.style;return X.transform=X.webkitTransform=`translate(${E}px,${W}px)`,X.transitionDuration="0s",B}}function hasCSSTransform(B,_,T){const E=B.cloneNode(),W=B[vtcKey];W&&W.forEach(Y=>{Y.split(/\s+/).forEach(te=>te&&E.classList.remove(te))}),T.split(/\s+/).forEach(Y=>Y&&E.classList.add(Y)),E.style.display="none";const X=_.nodeType===1?_:_.parentNode;X.appendChild(E);const{hasTransform:q}=getTransitionInfo(E);return X.removeChild(E),q}const getModelAssigner=B=>{const _=B.props["onUpdate:modelValue"]||!1;return isArray$4(_)?T=>invokeArrayFns(_,T):_};function onCompositionStart(B){B.target.composing=!0}function onCompositionEnd(B){const _=B.target;_.composing&&(_.composing=!1,_.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(B,{modifiers:{lazy:_,trim:T,number:E}},W){B[assignKey]=getModelAssigner(W);const X=E||W.props&&W.props.type==="number";addEventListener(B,_?"change":"input",q=>{if(q.target.composing)return;let Y=B.value;T&&(Y=Y.trim()),X&&(Y=looseToNumber(Y)),B[assignKey](Y)}),T&&addEventListener(B,"change",()=>{B.value=B.value.trim()}),_||(addEventListener(B,"compositionstart",onCompositionStart),addEventListener(B,"compositionend",onCompositionEnd),addEventListener(B,"change",onCompositionEnd))},mounted(B,{value:_}){B.value=_??""},beforeUpdate(B,{value:_,modifiers:{lazy:T,trim:E,number:W}},X){if(B[assignKey]=getModelAssigner(X),B.composing)return;const q=(W||B.type==="number")&&!/^0\d/.test(B.value)?looseToNumber(B.value):B.value,Y=_??"";q!==Y&&(document.activeElement===B&&B.type!=="range"&&(T||E&&B.value.trim()===Y)||(B.value=Y))}},vModelCheckbox={deep:!0,created(B,_,T){B[assignKey]=getModelAssigner(T),addEventListener(B,"change",()=>{const E=B._modelValue,W=getValue(B),X=B.checked,q=B[assignKey];if(isArray$4(E)){const Y=looseIndexOf(E,W),te=Y!==-1;if(X&&!te)q(E.concat(W));else if(!X&&te){const ne=[...E];ne.splice(Y,1),q(ne)}}else if(isSet$1(E)){const Y=new Set(E);X?Y.add(W):Y.delete(W),q(Y)}else q(getCheckboxValue(B,X))})},mounted:setChecked,beforeUpdate(B,_,T){B[assignKey]=getModelAssigner(T),setChecked(B,_,T)}};function setChecked(B,{value:_,oldValue:T},E){B._modelValue=_,isArray$4(_)?B.checked=looseIndexOf(_,E.props.value)>-1:isSet$1(_)?B.checked=_.has(E.props.value):_!==T&&(B.checked=looseEqual(_,getCheckboxValue(B,!0)))}const vModelRadio={created(B,{value:_},T){B.checked=looseEqual(_,T.props.value),B[assignKey]=getModelAssigner(T),addEventListener(B,"change",()=>{B[assignKey](getValue(B))})},beforeUpdate(B,{value:_,oldValue:T},E){B[assignKey]=getModelAssigner(E),_!==T&&(B.checked=looseEqual(_,E.props.value))}},vModelSelect={deep:!0,created(B,{value:_,modifiers:{number:T}},E){const W=isSet$1(_);addEventListener(B,"change",()=>{const X=Array.prototype.filter.call(B.options,q=>q.selected).map(q=>T?looseToNumber(getValue(q)):getValue(q));B[assignKey](B.multiple?W?new Set(X):X:X[0]),B._assigning=!0,nextTick(()=>{B._assigning=!1})}),B[assignKey]=getModelAssigner(E)},mounted(B,{value:_,modifiers:{number:T}}){setSelected(B,_)},beforeUpdate(B,_,T){B[assignKey]=getModelAssigner(T)},updated(B,{value:_,modifiers:{number:T}}){B._assigning||setSelected(B,_)}};function setSelected(B,_,T){const E=B.multiple,W=isArray$4(_);if(!(E&&!W&&!isSet$1(_))){for(let X=0,q=B.options.length;X<q;X++){const Y=B.options[X],te=getValue(Y);if(E)if(W){const ne=typeof te;ne==="string"||ne==="number"?Y.selected=_.some(ae=>String(ae)===String(te)):Y.selected=looseIndexOf(_,te)>-1}else Y.selected=_.has(te);else if(looseEqual(getValue(Y),_)){B.selectedIndex!==X&&(B.selectedIndex=X);return}}!E&&B.selectedIndex!==-1&&(B.selectedIndex=-1)}}function getValue(B){return"_value"in B?B._value:B.value}function getCheckboxValue(B,_){const T=_?"_trueValue":"_falseValue";return T in B?B[T]:_}const vModelDynamic={created(B,_,T){callModelHook(B,_,T,null,"created")},mounted(B,_,T){callModelHook(B,_,T,null,"mounted")},beforeUpdate(B,_,T,E){callModelHook(B,_,T,E,"beforeUpdate")},updated(B,_,T,E){callModelHook(B,_,T,E,"updated")}};function resolveDynamicModel(B,_){switch(B){case"SELECT":return vModelSelect;case"TEXTAREA":return vModelText;default:switch(_){case"checkbox":return vModelCheckbox;case"radio":return vModelRadio;default:return vModelText}}}function callModelHook(B,_,T,E,W){const q=resolveDynamicModel(B.tagName,T.props&&T.props.type)[W];q&&q(B,_,T,E)}function initVModelForSSR(){vModelText.getSSRProps=({value:B})=>({value:B}),vModelRadio.getSSRProps=({value:B},_)=>{if(_.props&&looseEqual(_.props.value,B))return{checked:!0}},vModelCheckbox.getSSRProps=({value:B},_)=>{if(isArray$4(B)){if(_.props&&looseIndexOf(B,_.props.value)>-1)return{checked:!0}}else if(isSet$1(B)){if(_.props&&B.has(_.props.value))return{checked:!0}}else if(B)return{checked:!0}},vModelDynamic.getSSRProps=(B,_)=>{if(typeof _.type!="string")return;const T=resolveDynamicModel(_.type.toUpperCase(),_.props&&_.props.type);if(T.getSSRProps)return T.getSSRProps(B,_)}}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:B=>B.stopPropagation(),prevent:B=>B.preventDefault(),self:B=>B.target!==B.currentTarget,ctrl:B=>!B.ctrlKey,shift:B=>!B.shiftKey,alt:B=>!B.altKey,meta:B=>!B.metaKey,left:B=>"button"in B&&B.button!==0,middle:B=>"button"in B&&B.button!==1,right:B=>"button"in B&&B.button!==2,exact:(B,_)=>systemModifiers.some(T=>B[`${T}Key`]&&!_.includes(T))},withModifiers=(B,_)=>{const T=B._withMods||(B._withMods={}),E=_.join(".");return T[E]||(T[E]=(W,...X)=>{for(let q=0;q<_.length;q++){const Y=modifierGuards[_[q]];if(Y&&Y(W,_))return}return B(W,...X)})},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(B,_)=>{const T=B._withKeys||(B._withKeys={}),E=_.join(".");return T[E]||(T[E]=W=>{if(!("key"in W))return;const X=hyphenate(W.key);if(_.some(q=>q===X||keyNames[q]===X))return B(W)})},rendererOptions=extend$1({patchProp},nodeOps);let renderer,enabledHydration=!1;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}function ensureHydrationRenderer(){return renderer=enabledHydration?renderer:createHydrationRenderer(rendererOptions),enabledHydration=!0,renderer}const render=(...B)=>{ensureRenderer().render(...B)},hydrate=(...B)=>{ensureHydrationRenderer().hydrate(...B)},createApp=(...B)=>{const _=ensureRenderer().createApp(...B),{mount:T}=_;return _.mount=E=>{const W=normalizeContainer(E);if(!W)return;const X=_._component;!isFunction(X)&&!X.render&&!X.template&&(X.template=W.innerHTML),W.innerHTML="";const q=T(W,!1,resolveRootNamespace(W));return W instanceof Element&&(W.removeAttribute("v-cloak"),W.setAttribute("data-v-app","")),q},_},createSSRApp=(...B)=>{const _=ensureHydrationRenderer().createApp(...B),{mount:T}=_;return _.mount=E=>{const W=normalizeContainer(E);if(W)return T(W,!0,resolveRootNamespace(W))},_};function resolveRootNamespace(B){if(B instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&B instanceof MathMLElement)return"mathml"}function normalizeContainer(B){return isString$1(B)?document.querySelector(B):B}let ssrDirectiveInitialized=!1;const initDirectivesForSSR=()=>{ssrDirectiveInitialized||(ssrDirectiveInitialized=!0,initVModelForSSR(),initVShowForSSR())};/**
* vue v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const compile=()=>{},vue_runtime_esmBundler=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition,BaseTransitionPropsValidators,Comment,DeprecationTypes,EffectScope,ErrorCodes,ErrorTypeStrings,Fragment,KeepAlive,ReactiveEffect,Static,Suspense,Teleport,Text:Text$2,TrackOpTypes,Transition,TransitionGroup,TriggerOpTypes,VueElement,assertNumber,callWithAsyncErrorHandling,callWithErrorHandling,camelize,capitalize,cloneVNode,compatUtils,compile,computed,createApp,createBlock,createCommentVNode,createElementBlock,createElementVNode:createBaseVNode,createHydrationRenderer,createPropsRestProxy,createRenderer,createSSRApp,createSlots,createStaticVNode,createTextVNode,createVNode,customRef,defineAsyncComponent,defineComponent,defineCustomElement,defineEmits,defineExpose,defineModel,defineOptions,defineProps,defineSSRCustomElement,defineSlots,devtools,effect,effectScope,getCurrentInstance,getCurrentScope,getTransitionRawChildren,guardReactiveProps,h:h$1,handleError,hasInjectionContext,hydrate,initCustomFormatter,initDirectivesForSSR,inject,isMemoSame,isProxy,isReactive,isReadonly,isRef,isRuntimeOnly,isShallow,isVNode,markRaw,mergeDefaults,mergeModels,mergeProps,nextTick,normalizeClass,normalizeProps,normalizeStyle,onActivated,onBeforeMount,onBeforeUnmount,onBeforeUpdate,onDeactivated,onErrorCaptured,onMounted,onRenderTracked,onRenderTriggered,onScopeDispose,onServerPrefetch,onUnmounted,onUpdated,openBlock,popScopeId,provide,proxyRefs,pushScopeId,queuePostFlushCb,reactive,readonly,ref:ref$1,registerRuntimeCompiler,render,renderList,renderSlot,resolveComponent,resolveDirective,resolveDynamicComponent,resolveFilter,resolveTransitionHooks,setBlockTracking,setDevtoolsHook,setTransitionHooks,shallowReactive,shallowReadonly,shallowRef,ssrContextKey,ssrUtils,stop,toDisplayString,toHandlerKey,toHandlers,toRaw,toRef,toRefs:toRefs$1,toValue:toValue$1,transformVNodeArgs,triggerRef,unref,useAttrs,useCssModule,useCssVars,useModel,useSSRContext,useSlots,useTransitionState,vModelCheckbox,vModelDynamic,vModelRadio,vModelSelect,vModelText,vShow,version,warn,watch,watchEffect,watchPostEffect,watchSyncEffect,withAsyncContext,withCtx,withDefaults,withDirectives,withKeys,withMemo,withModifiers,withScopeId},Symbol.toStringTag,{value:"Module"})),_export_sfc=(B,_)=>{const T=B.__vccOpts||B;for(const[E,W]of _)T[E]=W;return T};var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}function getAugmentedNamespace(B){if(B.__esModule)return B;var _=B.default;if(typeof _=="function"){var T=function E(){return this instanceof E?Reflect.construct(_,arguments,this.constructor):_.apply(this,arguments)};T.prototype=_.prototype}else T={};return Object.defineProperty(T,"__esModule",{value:!0}),Object.keys(B).forEach(function(E){var W=Object.getOwnPropertyDescriptor(B,E);Object.defineProperty(T,E,W.get?W:{enumerable:!0,get:function(){return B[E]}})}),T}var viewuiplus_min={exports:{}};const require$$0$1=getAugmentedNamespace(vue_runtime_esmBundler);(function(B,_){(function(T,E){E(_,require$$0$1)})(commonjsGlobal,function(T,E){const W=typeof window<"u",X=function(){return W&&document.addEventListener?function(K,se,me,Be=!1){K&&se&&me&&K.addEventListener(se,me,Be)}:function(K,se,me){K&&se&&me&&K.attachEvent("on"+se,me)}}(),q=function(){return W&&document.removeEventListener?function(K,se,me,Be=!1){K&&se&&K.removeEventListener(se,me,Be)}:function(K,se,me){K&&se&&K.detachEvent("on"+se,me)}}();var Y=(K,se)=>{const me=K.__vccOpts||K;for(const[Be,Re]of se)me[Be]=Re;return me};const te="ivu-affix";function ne(K,se){const me=se?"pageYOffset":"pageXOffset",Be=se?"scrollTop":"scrollLeft";let Re=K[me];return W&&typeof Re!="number"&&(Re=window.document.documentElement[Be]),Re}function ae(K){if(!W)return;const se=K.getBoundingClientRect(),me=ne(window,!0),Be=ne(window),Re=window.document.body,ve=Re.clientTop||0,Fe=Re.clientLeft||0;return{top:se.top+me-ve,left:se.left+Be-Fe}}const le={name:"Affix",emits:["on-change"],props:{offsetTop:{type:Number,default:0},offsetBottom:{type:Number},useCapture:{type:Boolean,default:!1}},data(){return{affix:!1,styles:{},slot:!1,slotStyle:{}}},computed:{offsetType(){let K="top";return this.offsetBottom>=0&&(K="bottom"),K},classes(){return[{[`${te}`]:this.affix}]}},mounted(){X(window,"scroll",this.handleScroll,this.useCapture),X(window,"resize",this.handleScroll,this.useCapture),E.nextTick(()=>{this.handleScroll()})},beforeUnmount(){q(window,"scroll",this.handleScroll,this.useCapture),q(window,"resize",this.handleScroll,this.useCapture)},methods:{handleScroll(){if(!W)return;const K=this.affix,se=ne(window,!0),me=ae(this.$el),Be=window.innerHeight,Re=this.$el.getElementsByTagName("div")[0].offsetHeight;me.top-this.offsetTop<se&&this.offsetType=="top"&&!K?(this.affix=!0,this.slotStyle={width:this.$refs.point.clientWidth+"px",height:this.$refs.point.clientHeight+"px"},this.slot=!0,this.styles={top:`${this.offsetTop}px`,left:`${me.left}px`,width:`${this.$el.offsetWidth}px`},this.$emit("on-change",!0)):me.top-this.offsetTop>se&&this.offsetType=="top"&&K&&(this.slot=!1,this.slotStyle={},this.affix=!1,this.styles=null,this.$emit("on-change",!1)),me.top+this.offsetBottom+Re>se+Be&&this.offsetType=="bottom"&&!K?(this.affix=!0,this.styles={bottom:`${this.offsetBottom}px`,left:`${me.left}px`,width:`${this.$el.offsetWidth}px`},this.$emit("on-change",!0)):me.top+this.offsetBottom+Re<se+Be&&this.offsetType=="bottom"&&K&&(this.affix=!1,this.styles=null,this.$emit("on-change",!1))}}};function ue(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",null,[E.createElementVNode("div",{ref:"point",class:E.normalizeClass(ve.classes),style:E.normalizeStyle(Re.styles)},[E.renderSlot(K.$slots,"default")],6),E.withDirectives(E.createElementVNode("div",{style:E.normalizeStyle(Re.slotStyle)},null,4),[[E.vShow,Re.slot]])])}var ge=Y(le,[["render",ue]]);const ye="ivu-icon",xe={name:"Icon",props:{type:{type:String,default:""},size:[Number,String],color:String,custom:{type:String,default:""}},computed:{classes(){return[`${ye}`,{[`${ye}-${this.type}`]:this.type!=="",[`${this.custom}`]:this.custom!==""}]},styles(){let K={};return this.size&&(K["font-size"]=`${this.size}px`),this.color&&(K.color=this.color),K}}};function Te(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("i",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.styles)},null,6)}var Ae=Y(xe,[["render",Te]]);function Ie(K,se){for(let me=0;me<se.length;me++)if(K===se[me])return!0;return!1}let Ve;function $e(K){if(W&&Ve===void 0){const se=document.createElement("div");se.style.width="100%",se.style.height="200px";const me=document.createElement("div"),Be=me.style;Be.position="absolute",Be.top=0,Be.left=0,Be.pointerEvents="none",Be.visibility="hidden",Be.width="200px",Be.height="150px",Be.overflow="hidden",me.appendChild(se),document.body.appendChild(me);const Re=se.offsetWidth;me.style.overflow="scroll";let ve=se.offsetWidth;Re===ve&&(ve=me.clientWidth),document.body.removeChild(me),Ve=Re-ve}return Ve}const We=W&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)||!1,Ue=/([\:\-\_]+(.))/g,je=/^moz([A-Z])/;function ze(K){return K.replace(Ue,function(se,me,Be,Re){return Re?Be.toUpperCase():Be}).replace(je,"Moz$1")}function He(K,se){if(W){if(!K||!se)return null;se=ze(se),se==="float"&&(se="cssFloat");try{const me=document.defaultView.getComputedStyle(K,"");return K.style[se]||me?me[se]:null}catch{return K.style[se]}}}function Le(K){return K.toString()[0].toUpperCase()+K.toString().slice(1)}function qe(K){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(K)]}function Qe(K){const se=qe(K);let me;if(se==="array")me=[];else if(se==="object")me={};else return K;if(se==="array")for(let Be=0;Be<K.length;Be++)me.push(Qe(K[Be]));else if(se==="object")for(let Be in K)me[Be]=Qe(K[Be]);return me}function Ke(K,se=0,me,Be=500,Re){if(!W)return;window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(tt){return window.setTimeout(tt,1e3/60)});const ve=Math.abs(se-me),Fe=Math.ceil(ve/Be*50);function Xe(tt,Ze,it){if(tt===Ze){Re&&Re();return}let nr=tt+it>Ze?Ze:tt+it;tt>Ze&&(nr=tt-it<Ze?Ze:tt-it),K===window?window.scrollTo(nr,nr):K.scrollTop=nr,window.requestAnimationFrame(()=>Xe(nr,Ze,it))}Xe(se,me,Fe)}function Je(K,se,me){typeof se=="string"?me=[se]:me=se;let Be=K.$parent,Re=Be.$options.name;for(;Be&&(!Re||me.indexOf(Re)<0);)Be=Be.$parent,Be&&(Re=Be.$options.name);return Be}function pt(K,se){let me=[];const Be=K.$parent;return Be?(Be.$options.name===se&&me.push(Be),me.concat(pt(Be,se))):[]}const ut=function(K){return(K||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")};function lt(K,se){if(!K||!se)return!1;if(se.indexOf(" ")!==-1)throw new Error("className should not contain space.");return K.classList?K.classList.contains(se):(" "+K.className+" ").indexOf(" "+se+" ")>-1}function st(K,se){if(!K)return;let me=K.className;const Be=(se||"").split(" ");for(let Re=0,ve=Be.length;Re<ve;Re++){const Fe=Be[Re];!Fe||(K.classList?K.classList.add(Fe):lt(K,Fe)||(me+=" "+Fe))}K.classList||(K.className=me)}function sr(K,se){if(!K||!se)return;const me=se.split(" ");let Be=" "+K.className+" ";for(let Re=0,ve=me.length;Re<ve;Re++){const Fe=me[Re];!Fe||(K.classList?K.classList.remove(Fe):lt(K,Fe)&&(Be=Be.replace(" "+Fe+" "," ")))}K.classList||(K.className=ut(Be))}const mt={xs:"480px",sm:"576px",md:"768px",lg:"992px",xl:"1200px",xxl:"1600px"};function Tr(){if(!W)return;const K=se=>({media:se,matches:!1,on(){},off(){}});window.matchMedia=window.matchMedia||K}const di=/#([^#]+)$/;async function Mi(K,se="unnamed"){if(!W)return Promise.reject();try{const me=await(await fetch(K)).blob();if(!me)return Promise.reject();const Be=URL.createObjectURL(me),Re=document.createElement("a");return Re.setAttribute("href",Be),Re.setAttribute("download",se),Re.click(),URL.revokeObjectURL(Be),Promise.resolve()}catch(me){return Promise.reject(me)}}const Gr="ivu-alert",ci={name:"Alert",components:{Icon:Ae},props:{type:{validator(K){return Ie(K,["success","info","warning","error"])},default:"info"},closable:{type:Boolean,default:!1},showIcon:{type:Boolean,default:!1},banner:{type:Boolean,default:!1},fade:{type:Boolean,default:!0}},data(){return{closed:!1,desc:!1}},computed:{wrapClasses(){return[`${Gr}`,`${Gr}-${this.type}`,{[`${Gr}-with-icon`]:this.showIcon,[`${Gr}-with-desc`]:this.desc,[`${Gr}-with-banner`]:this.banner}]},messageClasses(){return`${Gr}-message`},descClasses(){return`${Gr}-desc`},closeClasses(){return`${Gr}-close`},iconClasses(){return`${Gr}-icon`},iconType(){let K="";switch(this.type){case"success":K="ios-checkmark-circle";break;case"info":K="ios-information-circle";break;case"warning":K="ios-alert";break;case"error":K="ios-close-circle";break}return this.desc&&(K+="-outline"),K}},methods:{close(K){this.closed=!0,this.$emit("on-close",K)}},mounted(){this.desc=this.$slots.desc!==void 0}};function gi(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createBlock(E.Transition,{name:me.fade?"fade":""},{default:E.withCtx(()=>[Re.closed?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.wrapClasses)},[me.showIcon?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(ve.iconClasses)},[E.renderSlot(K.$slots,"icon",{},()=>[E.createVNode(Fe,{type:ve.iconType},null,8,["type"])])],2)):E.createCommentVNode("",!0),E.createElementVNode("span",{class:E.normalizeClass(ve.messageClasses)},[E.renderSlot(K.$slots,"default")],2),E.createElementVNode("span",{class:E.normalizeClass(ve.descClasses)},[E.renderSlot(K.$slots,"desc")],2),me.closable?(E.openBlock(),E.createElementBlock("a",{key:1,class:E.normalizeClass(ve.closeClasses),onClick:se[0]||(se[0]=(...Xe)=>ve.close&&ve.close(...Xe))},[E.renderSlot(K.$slots,"close",{},()=>[E.createVNode(Fe,{type:"ios-close"})])],2)):E.createCommentVNode("",!0)],2))]),_:3},8,["name"])}var fi=Y(ci,[["render",gi]]);const ri={name:"Anchor",provide(){return{AnchorInstance:this}},emits:["on-change","on-select"],props:{affix:{type:Boolean,default:!0},offsetTop:{type:Number,default:0},offsetBottom:Number,bounds:{type:Number,default:5},container:null,showInk:{type:Boolean,default:!1},scrollOffset:{type:Number,default:0}},data(){return{prefix:"ivu-anchor",isAffixed:!1,inkTop:0,animating:!1,currentLink:"",currentId:"",scrollContainer:null,scrollElement:null,wrapperTop:0,upperFirstTitle:!0,links:[]}},computed:{wrapperComponent(){return this.affix?"Affix":"div"},wrapperStyle(){return{maxHeight:this.offsetTop?`calc(100vh - ${this.offsetTop}px)`:"100vh"}},containerIsWindow(){return this.scrollContainer===window},titlesOffsetArr(){const K=this.links.map(me=>me.link.href).map(me=>me.split("#")[1]);let se=[];return W&&K.forEach(me=>{const Be=document.getElementById(me);Be&&se.push({link:`#${me}`,offset:Be.offsetTop-this.scrollElement.offsetTop})}),se}},methods:{handleAffixStateChange(K){this.isAffixed=this.affix&&K},handleScroll(K){if(this.upperFirstTitle=!!this.titlesOffsetArr[0]&&K.target.scrollTop<this.titlesOffsetArr[0].offset,this.animating)return;const se=W?document.documentElement.scrollTop||document.body.scrollTop||K.target.scrollTop:0;this.getCurrentScrollAtTitleId(se)},handleHashChange(){if(!W)return;const K=window.location.href,se=di.exec(K);!se||(this.currentLink=se[0],this.currentId=se[1])},handleScrollTo(){if(!W)return;const K=document.getElementById(this.currentId),se=document.querySelector(`a[data-href="${this.currentLink}"]`);let me=this.scrollOffset;if(se&&(me=parseFloat(se.getAttribute("data-scroll-offset"))),!K)return;const Be=K.offsetTop-this.wrapperTop-me;this.animating=!0,Ke(this.scrollContainer,this.scrollElement.scrollTop,Be,600,()=>{this.animating=!1}),this.handleSetInkTop()},handleSetInkTop(){if(!W)return;const K=document.querySelector(`a[data-href="${this.currentLink}"]`);if(!K)return;const se=K.offsetTop,me=se<0?this.offsetTop:se;this.inkTop=me},getCurrentScrollAtTitleId(K){let se=-1,me=this.titlesOffsetArr.length,Be={link:"#",offset:0};for(K+=this.bounds;++se<me;){let Re=this.titlesOffsetArr[se],ve=this.titlesOffsetArr[se+1];if(K>=Re.offset&&K<(ve&&ve.offset||1/0)){Be=this.titlesOffsetArr[se];break}}this.currentLink=Be.link,this.handleSetInkTop()},getContainer(){!W||(this.scrollContainer=this.container?typeof this.container=="string"?document.querySelector(this.container):this.container:window,this.scrollElement=this.container?this.scrollContainer:document.documentElement||document.body)},removeListener(){q(this.scrollContainer,"scroll",this.handleScroll),q(window,"hashchange",this.handleHashChange)},init(){this.handleHashChange(),E.nextTick(()=>{this.removeListener(),this.getContainer(),this.wrapperTop=this.containerIsWindow?0:this.scrollElement.offsetTop,this.handleScrollTo(),this.handleSetInkTop(),this.titlesOffsetArr[0]&&(this.upperFirstTitle=this.scrollElement.scrollTop<this.titlesOffsetArr[0].offset),X(this.scrollContainer,"scroll",this.handleScroll),X(window,"hashchange",this.handleHashChange)})},addLink(K,se){this.links.push({id:K,link:se})},removeLink(K){const se=this.links.findIndex(me=>me.id===K);this.links.splice(se,1)}},watch:{$route(){this.currentLink="",this.currentId="",this.handleHashChange(),E.nextTick(()=>{this.handleScrollTo()})},container(){this.init()},currentLink(K,se){this.$emit("on-change",K,se)}},mounted(){this.init()},beforeUnmount(){this.removeListener()}};function ot(K,se,me,Be,Re,ve){return E.openBlock(),E.createBlock(E.resolveDynamicComponent(ve.wrapperComponent),{"offset-top":me.offsetTop,"offset-bottom":me.offsetBottom,onOnChange:ve.handleAffixStateChange},{default:E.withCtx(()=>[E.createElementVNode("div",{class:E.normalizeClass(`${Re.prefix}-wrapper`),style:E.normalizeStyle(ve.wrapperStyle)},[E.createElementVNode("div",{class:E.normalizeClass(`${Re.prefix}`)},[E.createElementVNode("div",{class:E.normalizeClass(`${Re.prefix}-ink`)},[E.withDirectives(E.createElementVNode("span",{class:E.normalizeClass(`${Re.prefix}-ink-ball`),style:E.normalizeStyle({top:`${Re.inkTop}px`})},null,6),[[E.vShow,me.showInk]])],2),E.renderSlot(K.$slots,"default")],2)],6)]),_:3},40,["offset-top","offset-bottom","onOnChange"])}var rt=Y(ri,[["render",ot]]);function gt(K=32){const se="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",me=se.length;let Be="";for(let Re=0;Re<K;Re++)Be+=se.charAt(Math.floor(Math.random()*me));return Be}const Or={name:"AnchorLink",inject:["AnchorInstance"],props:{href:String,title:String,scrollOffset:{type:Number,default(){return E.inject("AnchorInstance").scrollOffset}}},data(){return{prefix:"ivu-anchor-link",id:gt(6)}},computed:{anchorLinkClasses(){return[this.prefix,this.AnchorInstance.currentLink===this.href?`${this.prefix}-active`:""]},linkTitleClasses(){return[`${this.prefix}-title`]}},methods:{goAnchor(){this.currentLink=this.href,this.AnchorInstance.handleHashChange(),this.AnchorInstance.handleScrollTo(),this.AnchorInstance.$emit("on-select",this.href),this.$router?this.$router.push(this.href,()=>{}):W&&(window.location.href=this.href)}},mounted(){this.AnchorInstance.addLink(this.id,this),E.nextTick(()=>{this.AnchorInstance.init()})},beforeUnmount(){this.AnchorInstance.removeLink(this.id)}},et=["href","data-scroll-offset","data-href","title"];function at(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.anchorLinkClasses)},[E.createElementVNode("a",{class:E.normalizeClass(ve.linkTitleClasses),href:me.href,"data-scroll-offset":me.scrollOffset,"data-href":me.href,onClick:se[0]||(se[0]=E.withModifiers((...Fe)=>ve.goAnchor&&ve.goAnchor(...Fe),["prevent"])),title:me.title},E.toDisplayString(me.title),11,et),E.renderSlot(K.$slots,"default")],2)}var Rr=Y(Or,[["render",at]]),Br={props:{to:{type:[Object,String]},replace:{type:Boolean,default:!1},target:{type:String,validator(K){return Ie(K,["_blank","_self","_parent","_top"])},default:"_self"},append:{type:Boolean,required:!1,default:!1}},computed:{linkUrl(){if(typeof this.to!="string")return null;if(this.to.includes("//"))return this.to;const K=this.$router;if(K){const se=this.$route,me=K.resolve(this.to,se,this.append);return me?me.href:this.to}return this.to}},methods:{handleOpenTo(){if(!W)return;const K=this.$router;let se=this.to;if(K){const me=this.$route,Be=K.resolve(this.to,me,this.append);se=Be?Be.href:this.to}typeof this.to!="string"&&window.open(se)},handleClick(K=!1){const se=this.$router;!W||(K?this.handleOpenTo():se?typeof this.to=="string"&&this.to.includes("//")?window.location.href=this.to:this.replace?this.$router.replace(this.to,()=>{}):this.$router.push(this.to,()=>{}):window.location.href=this.to)},handleCheckClick(K,se=!1){if(this.to){if(this.target==="_blank")return this.handleOpenTo(),!1;K.preventDefault(),this.handleClick(se)}}}};function Kr(K,se){let me=!1;return se.forEach(Be=>{K.includes(Be)&&(me=!0)}),me}const oi={name:"Auth",mixins:[Br],emits:["click"],props:{authority:{type:[String,Array,Function,Boolean],default:!0},access:{type:[String,Array]},prevent:{type:Boolean,default:!1},message:{type:String,default:""},customTip:{type:Boolean,default:!1},display:{type:String}},computed:{isPermission(){let K;if(typeof this.authority=="boolean")K=this.authority;else if(this.authority instanceof Function)K=this.authority();else{const se=typeof this.authority=="string"?[this.authority]:this.authority,me=typeof this.access=="string"?[this.access]:this.access;K=Kr(se,me)}return K},options(){let K={};return this.display&&(K.display=this.display),{class:{"ivu-auth":!0,"ivu-auth-permission":this.isPermission,"ivu-auth-no-math":!this.isPermission,"ivu-auth-redirect":!this.isPermission&&this.to,"ivu-auth-prevent":this.prevent},style:K}}},render(){return this.isPermission?E.h("div",this.options,this.$slots.default()):this.to?E.h("div",this.options):this.prevent?E.h("div",Object.assign({},this.options,{onClick:this.handlePreventClick}),[E.h("div",{class:"ivu-auth-prevent-no-match"},this.$slots.default())]):E.h("div",this.options,this.$slots.noMatch())},methods:{handlePreventClick(K){this.isPermission||(this.customTip||this.$Message.info({content:this.message,duration:3}),this.$emit("click",K))}},created(){!this.isPermission&&this.to&&this.handleClick(!1)}};var ct=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function nt(K){throw new Error('Could not dynamically require "'+K+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ir={exports:{}};/**!
* @fileOverview Kickass library to create and place poppers near their reference elements.
* @version 1.16.1
* @license
* Copyright (c) 2016 Federico Zivolo and contributors
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/(function(K,se){(function(me,Be){K.exports=Be()})(ct,function(){var me=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",Be=function(){for(var ht=["Edge","Trident","Firefox"],Ur=0;Ur<ht.length;Ur+=1)if(me&&navigator.userAgent.indexOf(ht[Ur])>=0)return 1;return 0}();function Re(ht){var Ur=!1;return function(){Ur||(Ur=!0,window.Promise.resolve().then(function(){Ur=!1,ht()}))}}function ve(ht){var Ur=!1;return function(){Ur||(Ur=!0,setTimeout(function(){Ur=!1,ht()},Be))}}var Fe=me&&window.Promise,Xe=Fe?Re:ve;function tt(ht){var Ur={};return ht&&Ur.toString.call(ht)==="[object Function]"}function Ze(ht,Ur){if(ht.nodeType!==1)return[];var ei=ht.ownerDocument.defaultView,ai=ei.getComputedStyle(ht,null);return Ur?ai[Ur]:ai}function it(ht){return ht.nodeName==="HTML"?ht:ht.parentNode||ht.host}function nr(ht){if(!ht)return document.body;switch(ht.nodeName){case"HTML":case"BODY":return ht.ownerDocument.body;case"#document":return ht.body}var Ur=Ze(ht),ei=Ur.overflow,ai=Ur.overflowX,Ii=Ur.overflowY;return/(auto|scroll|overlay)/.test(ei+Ii+ai)?ht:nr(it(ht))}function jr(ht){return ht&&ht.referenceNode?ht.referenceNode:ht}var zr=me&&!!(window.MSInputMethodContext&&document.documentMode),Fr=me&&/MSIE 10/.test(navigator.userAgent);function _t(ht){return ht===11?zr:ht===10?Fr:zr||Fr}function ni(ht){if(!ht)return document.documentElement;for(var Ur=_t(10)?document.body:null,ei=ht.offsetParent||null;ei===Ur&&ht.nextElementSibling;)ei=(ht=ht.nextElementSibling).offsetParent;var ai=ei&&ei.nodeName;return!ai||ai==="BODY"||ai==="HTML"?ht?ht.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(ei.nodeName)!==-1&&Ze(ei,"position")==="static"?ni(ei):ei}function on(ht){var Ur=ht.nodeName;return Ur==="BODY"?!1:Ur==="HTML"||ni(ht.firstElementChild)===ht}function Gi(ht){return ht.parentNode!==null?Gi(ht.parentNode):ht}function Qi(ht,Ur){if(!ht||!ht.nodeType||!Ur||!Ur.nodeType)return document.documentElement;var ei=ht.compareDocumentPosition(Ur)&Node.DOCUMENT_POSITION_FOLLOWING,ai=ei?ht:Ur,Ii=ei?Ur:ht,Ri=document.createRange();Ri.setStart(ai,0),Ri.setEnd(Ii,0);var Di=Ri.commonAncestorContainer;if(ht!==Di&&Ur!==Di||ai.contains(Ii))return on(Di)?Di:ni(Di);var $i=Gi(ht);return $i.host?Qi($i.host,Ur):Qi(ht,Gi(Ur).host)}function wi(ht){var Ur=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",ei=Ur==="top"?"scrollTop":"scrollLeft",ai=ht.nodeName;if(ai==="BODY"||ai==="HTML"){var Ii=ht.ownerDocument.documentElement,Ri=ht.ownerDocument.scrollingElement||Ii;return Ri[ei]}return ht[ei]}function li(ht,Ur){var ei=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ai=wi(Ur,"top"),Ii=wi(Ur,"left"),Ri=ei?-1:1;return ht.top+=ai*Ri,ht.bottom+=ai*Ri,ht.left+=Ii*Ri,ht.right+=Ii*Ri,ht}function Vi(ht,Ur){var ei=Ur==="x"?"Left":"Top",ai=ei==="Left"?"Right":"Bottom";return parseFloat(ht["border"+ei+"Width"])+parseFloat(ht["border"+ai+"Width"])}function Pi(ht,Ur,ei,ai){return Math.max(Ur["offset"+ht],Ur["scroll"+ht],ei["client"+ht],ei["offset"+ht],ei["scroll"+ht],_t(10)?parseInt(ei["offset"+ht])+parseInt(ai["margin"+(ht==="Height"?"Top":"Left")])+parseInt(ai["margin"+(ht==="Height"?"Bottom":"Right")]):0)}function pn(ht){var Ur=ht.body,ei=ht.documentElement,ai=_t(10)&&getComputedStyle(ei);return{height:Pi("Height",Ur,ei,ai),width:Pi("Width",Ur,ei,ai)}}var fn=function(ht,Ur){if(!(ht instanceof Ur))throw new TypeError("Cannot call a class as a function")},Zi=function(){function ht(Ur,ei){for(var ai=0;ai<ei.length;ai++){var Ii=ei[ai];Ii.enumerable=Ii.enumerable||!1,Ii.configurable=!0,"value"in Ii&&(Ii.writable=!0),Object.defineProperty(Ur,Ii.key,Ii)}}return function(Ur,ei,ai){return ei&&ht(Ur.prototype,ei),ai&&ht(Ur,ai),Ur}}(),Yi=function(ht,Ur,ei){return Ur in ht?Object.defineProperty(ht,Ur,{value:ei,enumerable:!0,configurable:!0,writable:!0}):ht[Ur]=ei,ht},tn=Object.assign||function(ht){for(var Ur=1;Ur<arguments.length;Ur++){var ei=arguments[Ur];for(var ai in ei)Object.prototype.hasOwnProperty.call(ei,ai)&&(ht[ai]=ei[ai])}return ht};function vn(ht){return tn({},ht,{right:ht.left+ht.width,bottom:ht.top+ht.height})}function Ji(ht){var Ur={};try{if(_t(10)){Ur=ht.getBoundingClientRect();var ei=wi(ht,"top"),ai=wi(ht,"left");Ur.top+=ei,Ur.left+=ai,Ur.bottom+=ei,Ur.right+=ai}else Ur=ht.getBoundingClientRect()}catch{}var Ii={left:Ur.left,top:Ur.top,width:Ur.right-Ur.left,height:Ur.bottom-Ur.top},Ri=ht.nodeName==="HTML"?pn(ht.ownerDocument):{},Di=Ri.width||ht.clientWidth||Ii.width,$i=Ri.height||ht.clientHeight||Ii.height,Hi=ht.offsetWidth-Di,gn=ht.offsetHeight-$i;if(Hi||gn){var xn=Ze(ht);Hi-=Vi(xn,"x"),gn-=Vi(xn,"y"),Ii.width-=Hi,Ii.height-=gn}return vn(Ii)}function ji(ht,Ur){var ei=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ai=_t(10),Ii=Ur.nodeName==="HTML",Ri=Ji(ht),Di=Ji(Ur),$i=nr(ht),Hi=Ze(Ur),gn=parseFloat(Hi.borderTopWidth),xn=parseFloat(Hi.borderLeftWidth);ei&&Ii&&(Di.top=Math.max(Di.top,0),Di.left=Math.max(Di.left,0));var hn=vn({top:Ri.top-Di.top-gn,left:Ri.left-Di.left-xn,width:Ri.width,height:Ri.height});if(hn.marginTop=0,hn.marginLeft=0,!ai&&Ii){var Sn=parseFloat(Hi.marginTop),Un=parseFloat(Hi.marginLeft);hn.top-=gn-Sn,hn.bottom-=gn-Sn,hn.left-=xn-Un,hn.right-=xn-Un,hn.marginTop=Sn,hn.marginLeft=Un}return(ai&&!ei?Ur.contains($i):Ur===$i&&$i.nodeName!=="BODY")&&(hn=li(hn,Ur)),hn}function Fi(ht){var Ur=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,ei=ht.ownerDocument.documentElement,ai=ji(ht,ei),Ii=Math.max(ei.clientWidth,window.innerWidth||0),Ri=Math.max(ei.clientHeight,window.innerHeight||0),Di=Ur?0:wi(ei),$i=Ur?0:wi(ei,"left"),Hi={top:Di-ai.top+ai.marginTop,left:$i-ai.left+ai.marginLeft,width:Ii,height:Ri};return vn(Hi)}function rn(ht){var Ur=ht.nodeName;if(Ur==="BODY"||Ur==="HTML")return!1;if(Ze(ht,"position")==="fixed")return!0;var ei=it(ht);return ei?rn(ei):!1}function Xi(ht){if(!ht||!ht.parentElement||_t())return document.documentElement;for(var Ur=ht.parentElement;Ur&&Ze(Ur,"transform")==="none";)Ur=Ur.parentElement;return Ur||document.documentElement}function Cn(ht,Ur,ei,ai){var Ii=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,Ri={top:0,left:0},Di=Ii?Xi(ht):Qi(ht,jr(Ur));if(ai==="viewport")Ri=Fi(Di,Ii);else{var $i=void 0;ai==="scrollParent"?($i=nr(it(Ur)),$i.nodeName==="BODY"&&($i=ht.ownerDocument.documentElement)):ai==="window"?$i=ht.ownerDocument.documentElement:$i=ai;var Hi=ji($i,Di,Ii);if($i.nodeName==="HTML"&&!rn(Di)){var gn=pn(ht.ownerDocument),xn=gn.height,hn=gn.width;Ri.top+=Hi.top-Hi.marginTop,Ri.bottom=xn+Hi.top,Ri.left+=Hi.left-Hi.marginLeft,Ri.right=hn+Hi.left}else Ri=Hi}ei=ei||0;var Sn=typeof ei=="number";return Ri.left+=Sn?ei:ei.left||0,Ri.top+=Sn?ei:ei.top||0,Ri.right-=Sn?ei:ei.right||0,Ri.bottom-=Sn?ei:ei.bottom||0,Ri}function En(ht){var Ur=ht.width,ei=ht.height;return Ur*ei}function Hn(ht,Ur,ei,ai,Ii){var Ri=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(ht.indexOf("auto")===-1)return ht;var Di=Cn(ei,ai,Ri,Ii),$i={top:{width:Di.width,height:Ur.top-Di.top},right:{width:Di.right-Ur.right,height:Di.height},bottom:{width:Di.width,height:Di.bottom-Ur.bottom},left:{width:Ur.left-Di.left,height:Di.height}},Hi=Object.keys($i).map(function(Sn){return tn({key:Sn},$i[Sn],{area:En($i[Sn])})}).sort(function(Sn,Un){return Un.area-Sn.area}),gn=Hi.filter(function(Sn){var Un=Sn.width,zn=Sn.height;return Un>=ei.clientWidth&&zn>=ei.clientHeight}),xn=gn.length>0?gn[0].key:Hi[0].key,hn=ht.split("-")[1];return xn+(hn?"-"+hn:"")}function Yn(ht,Ur,ei){var ai=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,Ii=ai?Xi(Ur):Qi(Ur,jr(ei));return ji(ei,Ii,ai)}function rs(ht){var Ur=ht.ownerDocument.defaultView,ei=Ur.getComputedStyle(ht),ai=parseFloat(ei.marginTop||0)+parseFloat(ei.marginBottom||0),Ii=parseFloat(ei.marginLeft||0)+parseFloat(ei.marginRight||0),Ri={width:ht.offsetWidth+Ii,height:ht.offsetHeight+ai};return Ri}function os(ht){var Ur={left:"right",right:"left",bottom:"top",top:"bottom"};return ht.replace(/left|right|bottom|top/g,function(ei){return Ur[ei]})}function vs(ht,Ur,ei){ei=ei.split("-")[0];var ai=rs(ht),Ii={width:ai.width,height:ai.height},Ri=["right","left"].indexOf(ei)!==-1,Di=Ri?"top":"left",$i=Ri?"left":"top",Hi=Ri?"height":"width",gn=Ri?"width":"height";return Ii[Di]=Ur[Di]+Ur[Hi]/2-ai[Hi]/2,ei===$i?Ii[$i]=Ur[$i]-ai[gn]:Ii[$i]=Ur[os($i)],Ii}function Ns(ht,Ur){return Array.prototype.find?ht.find(Ur):ht.filter(Ur)[0]}function lo(ht,Ur,ei){if(Array.prototype.findIndex)return ht.findIndex(function(Ii){return Ii[Ur]===ei});var ai=Ns(ht,function(Ii){return Ii[Ur]===ei});return ht.indexOf(ai)}function co(ht,Ur,ei){var ai=ei===void 0?ht:ht.slice(0,lo(ht,"name",ei));return ai.forEach(function(Ii){Ii.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var Ri=Ii.function||Ii.fn;Ii.enabled&&tt(Ri)&&(Ur.offsets.popper=vn(Ur.offsets.popper),Ur.offsets.reference=vn(Ur.offsets.reference),Ur=Ri(Ur,Ii))}),Ur}function Ki(){if(!this.state.isDestroyed){var ht={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};ht.offsets.reference=Yn(this.state,this.popper,this.reference,this.options.positionFixed),ht.placement=Hn(this.options.placement,ht.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),ht.originalPlacement=ht.placement,ht.positionFixed=this.options.positionFixed,ht.offsets.popper=vs(this.popper,ht.offsets.reference,ht.placement),ht.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",ht=co(this.modifiers,ht),this.state.isCreated?this.options.onUpdate(ht):(this.state.isCreated=!0,this.options.onCreate(ht))}}function On(ht,Ur){return ht.some(function(ei){var ai=ei.name,Ii=ei.enabled;return Ii&&ai===Ur})}function Fn(ht){for(var Ur=[!1,"ms","Webkit","Moz","O"],ei=ht.charAt(0).toUpperCase()+ht.slice(1),ai=0;ai<Ur.length;ai++){var Ii=Ur[ai],Ri=Ii?""+Ii+ei:ht;if(typeof document.body.style[Ri]<"u")return Ri}return null}function _s(){return this.state.isDestroyed=!0,On(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[Fn("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function Is(ht){var Ur=ht.ownerDocument;return Ur?Ur.defaultView:window}function Io(ht,Ur,ei,ai){var Ii=ht.nodeName==="BODY",Ri=Ii?ht.ownerDocument.defaultView:ht;Ri.addEventListener(Ur,ei,{passive:!0}),Ii||Io(nr(Ri.parentNode),Ur,ei,ai),ai.push(Ri)}function ea(ht,Ur,ei,ai){ei.updateBound=ai,Is(ht).addEventListener("resize",ei.updateBound,{passive:!0});var Ii=nr(ht);return Io(Ii,"scroll",ei.updateBound,ei.scrollParents),ei.scrollElement=Ii,ei.eventsEnabled=!0,ei}function Bs(){this.state.eventsEnabled||(this.state=ea(this.reference,this.options,this.state,this.scheduleUpdate))}function qn(ht,Ur){return Is(ht).removeEventListener("resize",Ur.updateBound),Ur.scrollParents.forEach(function(ei){ei.removeEventListener("scroll",Ur.updateBound)}),Ur.updateBound=null,Ur.scrollParents=[],Ur.scrollElement=null,Ur.eventsEnabled=!1,Ur}function $s(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=qn(this.reference,this.state))}function uo(ht){return ht!==""&&!isNaN(parseFloat(ht))&&isFinite(ht)}function Ys(ht,Ur){Object.keys(Ur).forEach(function(ei){var ai="";["width","height","top","right","bottom","left"].indexOf(ei)!==-1&&uo(Ur[ei])&&(ai="px"),ht.style[ei]=Ur[ei]+ai})}function ho(ht,Ur){Object.keys(Ur).forEach(function(ei){var ai=Ur[ei];ai!==!1?ht.setAttribute(ei,Ur[ei]):ht.removeAttribute(ei)})}function Ha(ht){return Ys(ht.instance.popper,ht.styles),ho(ht.instance.popper,ht.attributes),ht.arrowElement&&Object.keys(ht.arrowStyles).length&&Ys(ht.arrowElement,ht.arrowStyles),ht}function lu(ht,Ur,ei,ai,Ii){var Ri=Yn(Ii,Ur,ht,ei.positionFixed),Di=Hn(ei.placement,Ri,Ur,ht,ei.modifiers.flip.boundariesElement,ei.modifiers.flip.padding);return Ur.setAttribute("x-placement",Di),Ys(Ur,{position:ei.positionFixed?"fixed":"absolute"}),ei}function Xa(ht,Ur){var ei=ht.offsets,ai=ei.popper,Ii=ei.reference,Ri=Math.round,Di=Math.floor,$i=function(Oo){return Oo},Hi=Ri(Ii.width),gn=Ri(ai.width),xn=["left","right"].indexOf(ht.placement)!==-1,hn=ht.placement.indexOf("-")!==-1,Sn=Hi%2===gn%2,Un=Hi%2===1&&gn%2===1,zn=Ur?xn||hn||Sn?Ri:Di:$i,ds=Ur?Ri:$i;return{left:zn(Un&&!hn&&Ur?ai.left-1:ai.left),top:ds(ai.top),bottom:ds(ai.bottom),right:zn(ai.right)}}var cu=me&&/Firefox/i.test(navigator.userAgent);function uu(ht,Ur){var ei=Ur.x,ai=Ur.y,Ii=ht.offsets.popper,Ri=Ns(ht.instance.modifiers,function(ga){return ga.name==="applyStyle"}).gpuAcceleration;Ri!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var Di=Ri!==void 0?Ri:Ur.gpuAcceleration,$i=ni(ht.instance.popper),Hi=Ji($i),gn={position:Ii.position},xn=Xa(ht,window.devicePixelRatio<2||!cu),hn=ei==="bottom"?"top":"bottom",Sn=ai==="right"?"left":"right",Un=Fn("transform"),zn=void 0,ds=void 0;if(hn==="bottom"?$i.nodeName==="HTML"?ds=-$i.clientHeight+xn.bottom:ds=-Hi.height+xn.bottom:ds=xn.top,Sn==="right"?$i.nodeName==="HTML"?zn=-$i.clientWidth+xn.right:zn=-Hi.width+xn.right:zn=xn.left,Di&&Un)gn[Un]="translate3d("+zn+"px, "+ds+"px, 0)",gn[hn]=0,gn[Sn]=0,gn.willChange="transform";else{var Oo=hn==="bottom"?-1:1,qa=Sn==="right"?-1:1;gn[hn]=ds*Oo,gn[Sn]=zn*qa,gn.willChange=hn+", "+Sn}var ro={"x-placement":ht.placement};return ht.attributes=tn({},ro,ht.attributes),ht.styles=tn({},gn,ht.styles),ht.arrowStyles=tn({},ht.offsets.arrow,ht.arrowStyles),ht}function Fl(ht,Ur,ei){var ai=Ns(ht,function($i){var Hi=$i.name;return Hi===Ur}),Ii=!!ai&&ht.some(function($i){return $i.name===ei&&$i.enabled&&$i.order<ai.order});if(!Ii){var Ri="`"+Ur+"`",Di="`"+ei+"`";console.warn(Di+" modifier is required by "+Ri+" modifier in order to work, be sure to include it before "+Ri+"!")}return Ii}function cs(ht,Ur){var ei;if(!Fl(ht.instance.modifiers,"arrow","keepTogether"))return ht;var ai=Ur.element;if(typeof ai=="string"){if(ai=ht.instance.popper.querySelector(ai),!ai)return ht}else if(!ht.instance.popper.contains(ai))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),ht;var Ii=ht.placement.split("-")[0],Ri=ht.offsets,Di=Ri.popper,$i=Ri.reference,Hi=["left","right"].indexOf(Ii)!==-1,gn=Hi?"height":"width",xn=Hi?"Top":"Left",hn=xn.toLowerCase(),Sn=Hi?"left":"top",Un=Hi?"bottom":"right",zn=rs(ai)[gn];$i[Un]-zn<Di[hn]&&(ht.offsets.popper[hn]-=Di[hn]-($i[Un]-zn)),$i[hn]+zn>Di[Un]&&(ht.offsets.popper[hn]+=$i[hn]+zn-Di[Un]),ht.offsets.popper=vn(ht.offsets.popper);var ds=$i[hn]+$i[gn]/2-zn/2,Oo=Ze(ht.instance.popper),qa=parseFloat(Oo["margin"+xn]),ro=parseFloat(Oo["border"+xn+"Width"]),ga=ds-ht.offsets.popper[hn]-qa-ro;return ga=Math.max(Math.min(Di[gn]-zn,ga),0),ht.arrowElement=ai,ht.offsets.arrow=(ei={},Yi(ei,hn,Math.round(ga)),Yi(ei,Sn,""),ei),ht}function po(ht){return ht==="end"?"start":ht==="start"?"end":ht}var Bo=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],fo=Bo.slice(3);function hu(ht){var Ur=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,ei=fo.indexOf(ht),ai=fo.slice(ei+1).concat(fo.slice(0,ei));return Ur?ai.reverse():ai}var ta={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function jh(ht,Ur){if(On(ht.instance.modifiers,"inner")||ht.flipped&&ht.placement===ht.originalPlacement)return ht;var ei=Cn(ht.instance.popper,ht.instance.reference,Ur.padding,Ur.boundariesElement,ht.positionFixed),ai=ht.placement.split("-")[0],Ii=os(ai),Ri=ht.placement.split("-")[1]||"",Di=[];switch(Ur.behavior){case ta.FLIP:Di=[ai,Ii];break;case ta.CLOCKWISE:Di=hu(ai);break;case ta.COUNTERCLOCKWISE:Di=hu(ai,!0);break;default:Di=Ur.behavior}return Di.forEach(function($i,Hi){if(ai!==$i||Di.length===Hi+1)return ht;ai=ht.placement.split("-")[0],Ii=os(ai);var gn=ht.offsets.popper,xn=ht.offsets.reference,hn=Math.floor,Sn=ai==="left"&&hn(gn.right)>hn(xn.left)||ai==="right"&&hn(gn.left)<hn(xn.right)||ai==="top"&&hn(gn.bottom)>hn(xn.top)||ai==="bottom"&&hn(gn.top)<hn(xn.bottom),Un=hn(gn.left)<hn(ei.left),zn=hn(gn.right)>hn(ei.right),ds=hn(gn.top)<hn(ei.top),Oo=hn(gn.bottom)>hn(ei.bottom),qa=ai==="left"&&Un||ai==="right"&&zn||ai==="top"&&ds||ai==="bottom"&&Oo,ro=["top","bottom"].indexOf(ai)!==-1,ga=!!Ur.flipVariations&&(ro&&Ri==="start"&&Un||ro&&Ri==="end"&&zn||!ro&&Ri==="start"&&ds||!ro&&Ri==="end"&&Oo),rM=!!Ur.flipVariationsByContent&&(ro&&Ri==="start"&&zn||ro&&Ri==="end"&&Un||!ro&&Ri==="start"&&Oo||!ro&&Ri==="end"&&ds),ag=ga||rM;(Sn||qa||ag)&&(ht.flipped=!0,(Sn||qa)&&(ai=Di[Hi+1]),ag&&(Ri=po(Ri)),ht.placement=ai+(Ri?"-"+Ri:""),ht.offsets.popper=tn({},ht.offsets.popper,vs(ht.instance.popper,ht.offsets.reference,ht.placement)),ht=co(ht.instance.modifiers,ht,"flip"))}),ht}function Ul(ht){var Ur=ht.offsets,ei=Ur.popper,ai=Ur.reference,Ii=ht.placement.split("-")[0],Ri=Math.floor,Di=["top","bottom"].indexOf(Ii)!==-1,$i=Di?"right":"bottom",Hi=Di?"left":"top",gn=Di?"width":"height";return ei[$i]<Ri(ai[Hi])&&(ht.offsets.popper[Hi]=Ri(ai[Hi])-ei[gn]),ei[Hi]>Ri(ai[$i])&&(ht.offsets.popper[Hi]=Ri(ai[$i])),ht}function Hh(ht,Ur,ei,ai){var Ii=ht.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),Ri=+Ii[1],Di=Ii[2];if(!Ri)return ht;if(Di.indexOf("%")===0){var $i=void 0;switch(Di){case"%p":$i=ei;break;case"%":case"%r":default:$i=ai}var Hi=vn($i);return Hi[Ur]/100*Ri}else if(Di==="vh"||Di==="vw"){var gn=void 0;return Di==="vh"?gn=Math.max(document.documentElement.clientHeight,window.innerHeight||0):gn=Math.max(document.documentElement.clientWidth,window.innerWidth||0),gn/100*Ri}else return Ri}function qA(ht,Ur,ei,ai){var Ii=[0,0],Ri=["right","left"].indexOf(ai)!==-1,Di=ht.split(/(\+|\-)/).map(function(xn){return xn.trim()}),$i=Di.indexOf(Ns(Di,function(xn){return xn.search(/,|\s/)!==-1}));Di[$i]&&Di[$i].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var Hi=/\s*,\s*|\s+/,gn=$i!==-1?[Di.slice(0,$i).concat([Di[$i].split(Hi)[0]]),[Di[$i].split(Hi)[1]].concat(Di.slice($i+1))]:[Di];return gn=gn.map(function(xn,hn){var Sn=(hn===1?!Ri:Ri)?"height":"width",Un=!1;return xn.reduce(function(zn,ds){return zn[zn.length-1]===""&&["+","-"].indexOf(ds)!==-1?(zn[zn.length-1]=ds,Un=!0,zn):Un?(zn[zn.length-1]+=ds,Un=!1,zn):zn.concat(ds)},[]).map(function(zn){return Hh(zn,Sn,Ur,ei)})}),gn.forEach(function(xn,hn){xn.forEach(function(Sn,Un){uo(Sn)&&(Ii[hn]+=Sn*(xn[Un-1]==="-"?-1:1))})}),Ii}function QA(ht,Ur){var ei=Ur.offset,ai=ht.placement,Ii=ht.offsets,Ri=Ii.popper,Di=Ii.reference,$i=ai.split("-")[0],Hi=void 0;return uo(+ei)?Hi=[+ei,0]:Hi=qA(ei,Ri,Di,$i),$i==="left"?(Ri.top+=Hi[0],Ri.left-=Hi[1]):$i==="right"?(Ri.top+=Hi[0],Ri.left+=Hi[1]):$i==="top"?(Ri.left+=Hi[0],Ri.top-=Hi[1]):$i==="bottom"&&(Ri.left+=Hi[0],Ri.top+=Hi[1]),ht.popper=Ri,ht}function YA(ht,Ur){var ei=Ur.boundariesElement||ni(ht.instance.popper);ht.instance.reference===ei&&(ei=ni(ei));var ai=Fn("transform"),Ii=ht.instance.popper.style,Ri=Ii.top,Di=Ii.left,$i=Ii[ai];Ii.top="",Ii.left="",Ii[ai]="";var Hi=Cn(ht.instance.popper,ht.instance.reference,Ur.padding,ei,ht.positionFixed);Ii.top=Ri,Ii.left=Di,Ii[ai]=$i,Ur.boundaries=Hi;var gn=Ur.priority,xn=ht.offsets.popper,hn={primary:function(Sn){var Un=xn[Sn];return xn[Sn]<Hi[Sn]&&!Ur.escapeWithReference&&(Un=Math.max(xn[Sn],Hi[Sn])),Yi({},Sn,Un)},secondary:function(Sn){var Un=Sn==="right"?"left":"top",zn=xn[Un];return xn[Sn]>Hi[Sn]&&!Ur.escapeWithReference&&(zn=Math.min(xn[Un],Hi[Sn]-(Sn==="right"?xn.width:xn.height))),Yi({},Un,zn)}};return gn.forEach(function(Sn){var Un=["left","top"].indexOf(Sn)!==-1?"primary":"secondary";xn=tn({},xn,hn[Un](Sn))}),ht.offsets.popper=xn,ht}function KA(ht){var Ur=ht.placement,ei=Ur.split("-")[0],ai=Ur.split("-")[1];if(ai){var Ii=ht.offsets,Ri=Ii.reference,Di=Ii.popper,$i=["bottom","top"].indexOf(ei)!==-1,Hi=$i?"left":"top",gn=$i?"width":"height",xn={start:Yi({},Hi,Ri[Hi]),end:Yi({},Hi,Ri[Hi]+Ri[gn]-Di[gn])};ht.offsets.popper=tn({},Di,xn[ai])}return ht}function ZA(ht){if(!Fl(ht.instance.modifiers,"hide","preventOverflow"))return ht;var Ur=ht.offsets.reference,ei=Ns(ht.instance.modifiers,function(ai){return ai.name==="preventOverflow"}).boundaries;if(Ur.bottom<ei.top||Ur.left>ei.right||Ur.top>ei.bottom||Ur.right<ei.left){if(ht.hide===!0)return ht;ht.hide=!0,ht.attributes["x-out-of-boundaries"]=""}else{if(ht.hide===!1)return ht;ht.hide=!1,ht.attributes["x-out-of-boundaries"]=!1}return ht}function JA(ht){var Ur=ht.placement,ei=Ur.split("-")[0],ai=ht.offsets,Ii=ai.popper,Ri=ai.reference,Di=["left","right"].indexOf(ei)!==-1,$i=["top","left"].indexOf(ei)===-1;return Ii[Di?"left":"top"]=Ri[ei]-($i?Ii[Di?"width":"height"]:0),ht.placement=os(Ur),ht.offsets.popper=vn(Ii),ht}var eM={shift:{order:100,enabled:!0,fn:KA},offset:{order:200,enabled:!0,fn:QA,offset:0},preventOverflow:{order:300,enabled:!0,fn:YA,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:Ul},arrow:{order:500,enabled:!0,fn:cs,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:jh,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:JA},hide:{order:800,enabled:!0,fn:ZA},computeStyle:{order:850,enabled:!0,fn:uu,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:Ha,onLoad:lu,gpuAcceleration:void 0}},tM={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:eM},du=function(){function ht(Ur,ei){var ai=this,Ii=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};fn(this,ht),this.scheduleUpdate=function(){return requestAnimationFrame(ai.update)},this.update=Xe(this.update.bind(this)),this.options=tn({},ht.Defaults,Ii),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=Ur&&Ur.jquery?Ur[0]:Ur,this.popper=ei&&ei.jquery?ei[0]:ei,this.options.modifiers={},Object.keys(tn({},ht.Defaults.modifiers,Ii.modifiers)).forEach(function(Di){ai.options.modifiers[Di]=tn({},ht.Defaults.modifiers[Di]||{},Ii.modifiers?Ii.modifiers[Di]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(Di){return tn({name:Di},ai.options.modifiers[Di])}).sort(function(Di,$i){return Di.order-$i.order}),this.modifiers.forEach(function(Di){Di.enabled&&tt(Di.onLoad)&&Di.onLoad(ai.reference,ai.popper,ai.options,Di,ai.state)}),this.update();var Ri=this.options.eventsEnabled;Ri&&this.enableEventListeners(),this.state.eventsEnabled=Ri}return Zi(ht,[{key:"update",value:function(){return Ki.call(this)}},{key:"destroy",value:function(){return _s.call(this)}},{key:"enableEventListeners",value:function(){return Bs.call(this)}},{key:"disableEventListeners",value:function(){return $s.call(this)}}]),ht}();return du.Utils=(typeof window<"u"?window:ct).PopperUtils,du.placements=Bo,du.Defaults=tM,du})})(Ir);var Dr=Ir.exports;let ti=0,si=0;function Ai(){ti++}function Oi(){si++}const Ci={name:"Drop",emits:["mouseenter","mouseleave","click"],props:{placement:{type:String,default:"bottom-start"},className:{type:String},transfer:{type:Boolean},eventsEnabled:{type:Boolean,default:!1},visible:{type:Boolean},classes:{type:Object,default:()=>{}},styles:{type:Object,default:()=>{}},transitionName:{type:String,default:"transition-drop"},boundariesElement:{default:"window"}},data(){return{popper:null,width:"",popperStatus:!1,tIndex:this.handleGetIndex()}},computed:{mergedStyle(){let K={};return this.width&&(K.minWidth=`${this.width}px`),this.transfer&&(K["z-index"]=1060+this.tIndex),Object.assign({},this.styles,K)},mergedClass(){return Object.assign({},this.classes,{[this.className]:this.className})}},methods:{update(){E.nextTick(()=>{this.popper?(this.popper.update(),this.popperStatus=!0):this.popper=new Dr(this.$parent.$refs.reference,this.$refs.drop,{eventsEnabled:this.eventsEnabled,placement:this.placement,modifiers:{computeStyle:{gpuAcceleration:!1},preventOverflow:{boundariesElement:this.boundariesElement}},onCreate:()=>{this.resetTransformOrigin(),E.nextTick(this.popper.update())},onUpdate:()=>{this.resetTransformOrigin()}}),this.$parent.$options.name==="iSelect"&&(this.width=parseInt(He(this.$parent.$el,"width"))),this.tIndex=this.handleGetIndex()})},destroy(){this.popper&&setTimeout(()=>{this.popper&&!this.popperStatus&&(this.popper.popper.style.display="none",this.popper.destroy(),this.popper=null),this.popperStatus=!1},300)},resetTransformOrigin(){if(!this.popper)return;let K=this.popper.popper.getAttribute("x-placement"),se=K.split("-")[0],me=K.split("-")[1];K==="left"||K==="right"||(this.popper.popper.style.transformOrigin=se==="bottom"||se!=="top"&&me==="start"?"center top":"center bottom")},handleGetIndex(){return Ai(),ti},handleMouseenter(K){this.$emit("mouseenter",K)},handleMouseleave(K){this.$emit("mouseleave",K)},handleOnUpdatePopper(){this.update()},handleOnDestroyPopper(){this.destroy()},handleClick(K){this.$emit("click",K)}},beforeUnmount(){this.popper&&(this.popper.destroy(),this.popper=null)}};function Wi(K,se,me,Be,Re,ve){return E.openBlock(),E.createBlock(E.Teleport,{to:"body",disabled:!me.transfer},[E.createVNode(E.Transition,{name:me.transitionName},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("div",E.mergeProps({class:["ivu-select-dropdown",ve.mergedClass],ref:"drop",style:ve.mergedStyle},K.$attrs,{onMouseenter:se[0]||(se[0]=(...Fe)=>ve.handleMouseenter&&ve.handleMouseenter(...Fe)),onMouseleave:se[1]||(se[1]=(...Fe)=>ve.handleMouseleave&&ve.handleMouseleave(...Fe)),onClick:se[2]||(se[2]=E.withModifiers((...Fe)=>ve.handleClick&&ve.handleClick(...Fe),["stop"]))}),[E.renderSlot(K.$slots,"default")],16),[[E.vShow,me.visible]])]),_:3},8,["name"])],8,["disabled"])}var ki=Y(Ci,[["render",Wi]]);function Li(K){W&&typeof window.viewuiplus<"u"&&("langs"in viewuiplus||(viewuiplus.langs={}),viewuiplus.langs[K.i.locale]=K)}const mn={i:{locale:"zh-CN",select:{placeholder:"",noMatch:"",loading:""},table:{noDataText:"",noFilteredDataText:"",confirmFilter:"",resetFilter:"",clearFilter:"",sumText:""},datepicker:{selectDate:"",selectTime:"",startTime:"",endTime:"",clear:"",ok:"",datePanelLabel:"[yyyy] [m]",month:"",month1:"1 ",month2:"2 ",month3:"3 ",month4:"4 ",month5:"5 ",month6:"6 ",month7:"7 ",month8:"8 ",month9:"9 ",month10:"10 ",month11:"11 ",month12:"12 ",year:"",weekStartDay:"0",weeks:{sun:"",mon:"",tue:"",wed:"",thu:"",fri:"",sat:""},months:{m1:"1",m2:"2",m3:"3",m4:"4",m5:"5",m6:"6",m7:"7",m8:"8",m9:"9",m10:"10",m11:"11",m12:"12"}},transfer:{titles:{source:"",target:""},filterPlaceholder:"",notFoundText:""},modal:{okText:"",cancelText:""},poptip:{okText:"",cancelText:""},page:{prev:"",next:"",total:"",item:"",items:"",prev5:" 5 ",next5:" 5 ",page:"/",goto:"",p:""},rate:{star:"",stars:""},time:{before:"",after:"",just:"",seconds:"",minutes:"",hours:"",days:""},tree:{emptyText:""},image:{zoomIn:"",zoomOut:"",rotateLeft:"",rotateRight:"",fail:"",preview:""}}};Li(mn);var cn=function(K){return qi(K)&&!wn(K)};function qi(K){return!!K&&typeof K=="object"}function wn(K){var se=Object.prototype.toString.call(K);return se==="[object RegExp]"||se==="[object Date]"||vi(K)}var An=typeof Symbol=="function"&&Symbol.for,Hr=An?Symbol.for("react.element"):60103;function vi(K){return K.$$typeof===Hr}function Lr(K){return Array.isArray(K)?[]:{}}function _i(K,se){return se.clone!==!1&&se.isMergeableObject(K)?Ui(Lr(K),K,se):K}function xi(K,se,me){return K.concat(se).map(function(Be){return _i(Be,me)})}function Ni(K,se,me){var Be={};return me.isMergeableObject(K)&&Object.keys(K).forEach(function(Re){Be[Re]=_i(K[Re],me)}),Object.keys(se).forEach(function(Re){!me.isMergeableObject(se[Re])||!K[Re]?Be[Re]=_i(se[Re],me):Be[Re]=Ui(K[Re],se[Re],me)}),Be}function Ui(K,se,me){me=me||{},me.arrayMerge=me.arrayMerge||xi,me.isMergeableObject=me.isMergeableObject||cn;var Be=Array.isArray(se),Re=Array.isArray(K),ve=Be===Re;return ve?Be?me.arrayMerge(K,se,me):Ni(K,se,me):_i(se,me)}Ui.all=function(K,se){if(!Array.isArray(K))throw new Error("first argument should be an array");return K.reduce(function(me,Be){return Ui(me,Be,se)},{})};var Vn=Ui;const Dn=/(%|)\{([0-9a-zA-Z_]+)\}/g;function Wn(){function K(me,Be){return Object.prototype.hasOwnProperty.call(me,Be)}function se(me,...Be){return Be.length===1&&typeof Be[0]=="object"&&(Be=Be[0]),(!Be||!Be.hasOwnProperty)&&(Be={}),me===void 0?"":me.replace(Dn,(Re,ve,Fe,Xe)=>{let tt;return me[Xe-1]==="{"&&me[Xe+Re.length]==="}"?Fe:(tt=K(Be,Fe)?Be[Fe]:null,tt??"")})}return se}const es=Wn();let Bn=mn;const ps={zh:mn};let ns=null,Ja={},us=null,Xl=function(){if(Reflect.has(this,"$t"))return this.$t(...arguments);if(us&&us.global)return us.global.t(...arguments);if(us&&us.locale){if(!Ja[us.locale]||ns!=us.locale){Ja[us.locale]=!0;let K=us.getLocaleMessage(us.locale)||{},se={};Vn(se,ps[us.locale],K),Bn=se,us.setLocaleMessage(us.locale,se),ns=us.locale}return us.hlang(...arguments)}};const ra=function(K,se){let me=Xl.apply(this,arguments);if(me!=null)return me;const Be=K.split(".");let Re=Bn;for(let ve=0,Fe=Be.length;ve<Fe;ve++){const Xe=Be[ve];if(me=Re[Xe],ve===Fe-1)return es(me,se);if(!me)return"";Re=me}return""};var Do={use:function(K){Bn=K||Bn},t:ra,i18n:function(K){us=K}},Xn={methods:{t(...K){return ra.apply(this,K)}}},io={data(){return{globalConfig:{}}},created(){const K=E.getCurrentInstance();this.globalConfig=K.appContext.config.globalProperties.$VIEWUI}};const No="ivu-select",Su={name:"iSelectHead",mixins:[Xn,io],components:{Icon:Ae},emits:["on-input-focus","on-input-blur","on-keydown","on-enter","on-clear","on-query-change"],inject:["SelectInstance"],props:{disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},remote:{type:Boolean,default:!1},initialLabel:{type:[String,Number,Array]},values:{type:Array,default:()=>[]},clearable:{type:[Function,Boolean],default:!1},inputElementId:{type:String},placeholder:{type:String},queryProp:{type:String,default:""},prefix:{type:String},maxTagCount:{type:Number},maxTagPlaceholder:{type:Function},allowCreate:{type:Boolean},showCreateItem:{type:Boolean}},data(){return{prefixCls:No,query:"",inputLength:20,remoteInitialLabel:this.initialLabel,preventRemoteCall:!1}},computed:{singleDisplayClasses(){const{filterable:K,multiple:se,showPlaceholder:me}=this;return[{[No+"-head-with-prefix"]:this.showPrefix,[No+"-placeholder"]:me&&!K,[No+"-selected-value"]:!me&&!se&&!K}]},singleDisplayValue(){return this.multiple&&this.values.length>0||this.filterable?"":`${this.selectedSingle}`||this.localePlaceholder},showPlaceholder(){let K=!1;if(this.multiple)!this.values.length>0&&(K=!0);else{const se=this.values[0];(typeof se>"u"||String(se).trim()==="")&&(K=!this.remoteInitialLabel)}return K},resetSelect(){return!this.showPlaceholder&&this.clearable},inputStyle(){let K={};return this.multiple&&(this.showPlaceholder?K.width="100%":K.width=`${this.inputLength}px`),K},localePlaceholder(){return this.placeholder===void 0?this.t("i.select.placeholder"):this.placeholder},selectedSingle(){const K=this.values[0];return K?K.label:this.remoteInitialLabel||""},selectedMultiple(){return(this.multiple?this.values:[]).filter((K,se)=>this.maxTagCount===void 0||se<this.maxTagCount)},headCls(){return{[`${No}-head-flex`]:this.filterable&&this.showPrefix}},arrowType(){const K=this.globalConfig;let se="ios-arrow-down";return K&&(K.select.customArrow?se="":K.select.arrow&&(se=K.select.arrow)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.select.customArrow&&(se=K.select.customArrow),se},showPrefix(){const K=this.$slots.prefix&&this.$slots.prefix();let se=!1;return K&&(se=K[0].children.length>0),se||this.prefix},arrowSize(){const K=this.globalConfig;let se="";return K&&K.select.arrowSize&&(se=K.select.arrowSize),se}},methods:{onInputFocus(){this.$emit("on-input-focus")},onInputBlur(){this.showCreateItem||(this.values.length||(this.query=""),this.$emit("on-input-blur"))},removeTag(K){if(this.disabled)return!1;this.SelectInstance.handleOnSelectSelected(K)},resetInputState(){this.inputLength=this.$refs.input.value.length*12+20,this.$emit("on-keydown")},handleInputDelete(K){const se=K.target.value;this.multiple&&this.selectedMultiple.length&&this.query===""&&se===""&&this.removeTag(this.selectedMultiple[this.selectedMultiple.length-1])},handleInputEnter(K){this.$emit("on-enter"),this.showCreateItem&&K.stopPropagation()},onHeaderClick(K){this.filterable&&K.target===this.$el&&this.$refs.input.focus()},onClear(){this.$emit("on-clear")}},watch:{values([K]){if(this.filterable){if(this.preventRemoteCall=!0,this.multiple){this.query="",this.preventRemoteCall=!1;return}typeof K>"u"||K===""||K===null?this.query="":this.query=K.label,E.nextTick(()=>this.preventRemoteCall=!1)}},query(K){if(this.preventRemoteCall){this.preventRemoteCall=!1;return}this.$emit("on-query-change",K)},queryProp(K){K!==this.query&&(this.query=K)}}},wu={key:1,class:"ivu-tag ivu-tag-checked"},Ou={class:"ivu-tag-text ivu-select-max-tag"},wt=["id","disabled","placeholder"];function ii(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{onClick:se[6]||(se[6]=(...Xe)=>ve.onHeaderClick&&ve.onHeaderClick(...Xe)),class:E.normalizeClass(ve.headCls)},[ve.showPrefix?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass([Re.prefixCls+"-prefix"])},[E.renderSlot(K.$slots,"prefix",{},()=>[me.prefix?(E.openBlock(),E.createBlock(Fe,{key:0,type:me.prefix},null,8,["type"])):E.createCommentVNode("",!0)])],2)):E.createCommentVNode("",!0),(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.selectedMultiple,(Xe,tt)=>(E.openBlock(),E.createElementBlock("div",{class:"ivu-tag ivu-tag-checked",key:tt},[E.createElementVNode("span",{class:E.normalizeClass(["ivu-tag-text",{"ivu-select-multiple-tag-hidden":Xe.disabled}])},E.toDisplayString(Xe.tag!==void 0?Xe.tag:Xe.label),3),Xe.disabled?E.createCommentVNode("",!0):(E.openBlock(),E.createBlock(Fe,{key:0,type:"ios-close",onClick:E.withModifiers(Ze=>ve.removeTag(Xe),["stop"])},null,8,["onClick"]))]))),128)),me.maxTagCount!==void 0&&me.values.length>me.maxTagCount?(E.openBlock(),E.createElementBlock("div",wu,[E.createElementVNode("span",Ou,[me.maxTagPlaceholder?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(me.maxTagPlaceholder(me.values.length-me.maxTagCount)),1)],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createTextVNode("+ "+E.toDisplayString(me.values.length-me.maxTagCount)+"...",1)],64))])])):E.createCommentVNode("",!0),E.withDirectives(E.createElementVNode("span",{class:E.normalizeClass(ve.singleDisplayClasses)},E.toDisplayString(ve.singleDisplayValue),3),[[E.vShow,ve.singleDisplayValue]]),me.filterable?E.withDirectives((E.openBlock(),E.createElementBlock("input",{key:2,id:me.inputElementId,type:"text","onUpdate:modelValue":se[0]||(se[0]=Xe=>Re.query=Xe),disabled:me.disabled,class:E.normalizeClass([Re.prefixCls+"-input"]),placeholder:ve.showPlaceholder?ve.localePlaceholder:"",style:E.normalizeStyle(ve.inputStyle),autocomplete:"off",spellcheck:"false",onKeydown:[se[1]||(se[1]=(...Xe)=>ve.resetInputState&&ve.resetInputState(...Xe)),se[2]||(se[2]=E.withKeys((...Xe)=>ve.handleInputDelete&&ve.handleInputDelete(...Xe),["delete"])),se[3]||(se[3]=E.withKeys((...Xe)=>ve.handleInputEnter&&ve.handleInputEnter(...Xe),["enter"]))],onFocus:se[4]||(se[4]=(...Xe)=>ve.onInputFocus&&ve.onInputFocus(...Xe)),onBlur:se[5]||(se[5]=(...Xe)=>ve.onInputBlur&&ve.onInputBlur(...Xe)),ref:"input"},null,46,wt)),[[E.vModelText,Re.query]]):E.createCommentVNode("",!0),ve.resetSelect?(E.openBlock(),E.createBlock(Fe,{key:3,type:"ios-close-circle",class:E.normalizeClass([Re.prefixCls+"-arrow"]),onClick:E.withModifiers(ve.onClear,["stop"])},null,8,["class","onClick"])):E.createCommentVNode("",!0),!ve.resetSelect&&!me.remote?(E.openBlock(),E.createBlock(Fe,{key:4,type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize,class:E.normalizeClass([Re.prefixCls+"-arrow"])},null,8,["type","custom","size","class"])):E.createCommentVNode("",!0)],2)}var yi=Y(Su,[["render",ii]]);const hi="click",ui=Object.create(null),zi=Object.create(null),nn=[ui,zi],un=function(K,se,me){const{target:Be}=me,Re=function(Fe){const{el:Xe}=Fe;if(Xe!==Be&&!Xe.contains(Be)){const{binding:tt}=Fe;tt.modifiers.stop&&me.stopPropagation(),tt.modifiers.prevent&&me.preventDefault(),tt.value.call(K,me)}},ve=function(Fe){return se[Fe].forEach(Re)};Object.keys(se).forEach(ve)},bn=function(K){un(this,ui,K)},Tn=function(K){un(this,zi,K)},Pn=function(K){return K?bn:Tn},Rn=Object.defineProperties({},{$_captureInstances:{value:ui},$_nonCaptureInstances:{value:zi},$_onCaptureEvent:{value:bn},$_onNonCaptureEvent:{value:Tn},beforeMount:{value:function(K,se){if(typeof se.value!="function")throw new TypeError("Binding value must be a function.");let me;const Be=se.modifiers;Be.click?me="click":Be.mousedown?me="mousedown":Be.touchstart?me="touchstart":me=hi;const Re=se.arg,ve={...se,modifiers:{capture:!1,prevent:!1,stop:!1,...se.modifiers}},Fe=Re?ui:zi;Array.isArray(Fe[me])||(Fe[me]=[]),Fe[me].push({el:K,binding:ve})===1&&typeof document=="object"&&document&&document.addEventListener(me,Pn(Re),Re)}},unmounted:{value:function(K){const se=function(Be){return Be.el!==K},me=function(Be){const Re=Object.keys(Be);if(Re.length){const ve=Be===ui,Fe=function(Xe){const tt=Be[Xe].filter(se);tt.length?Be[Xe]=tt:(typeof document=="object"&&document&&document.removeEventListener(Xe,Pn(ve),ve),delete Be[Xe])};Re.forEach(Fe)}};nn.forEach(me)}},version:{enumerable:!0,value:"3.7.1"}});var In={inject:{FormInstance:{default:""},FormItemInstance:{default:null}},computed:{itemDisabled(){let K=this.disabled;return!K&&this.FormInstance&&(K=this.FormInstance.disabled),K?!0:null}},methods:{handleFormItemChange(K,se){this.FormItemInstance&&(K==="blur"?this.FormItemInstance.formBlur(se):K==="change"&&this.FormItemInstance.formChange(se))}}};const Qn="ivu-select",Cs=(K,se,me)=>{const Be=JSON.stringify(K),Re=JSON.stringify(se),ve=JSON.stringify(me.map(Fe=>Fe.value));return Be!==Re||Be!==ve||ve!==Re},Zs=300,jn={name:"iSelect",mixins:[Xn,In],components:{Drop:ki,SelectHead:yi,Icon:Ae},directives:{clickOutside:Rn},emits:["on-set-default-options","on-clear","on-clickoutside","on-select","on-create","on-change","on-query-change","on-open-change","update:modelValue"],provide(){return{SelectInstance:this}},props:{modelValue:{type:[String,Number,Array],default:""},label:{type:[String,Number,Array],default:""},defaultLabel:{type:[String,Number,Array],default:""},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},filterable:{type:Boolean,default:!1},filterMethod:{type:Function},remoteMethod:{type:Function},loading:{type:Boolean,default:!1},loadingText:{type:String},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},labelInValue:{type:Boolean,default:!1},notFoundText:{type:String},placement:{validator(K){return Ie(K,["top","bottom","top-start","bottom-start","top-end","bottom-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},autoComplete:{type:Boolean,default:!1},name:{type:String},elementId:{type:String},transferClassName:{type:String},prefix:{type:String},maxTagCount:{type:Number},maxTagPlaceholder:{type:Function},allowCreate:{type:Boolean,default:!1},capture:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return K.$VIEWUI?K.$VIEWUI.capture:!0}},filterByLabel:{type:Boolean,default:!1},eventsEnabled:{type:Boolean,default:!1},hideNotFound:{type:Boolean,default:!1}},mounted(){if(!this.remote&&this.slotOptions.length>0&&(this.values=this.getInitialValue().map(K=>typeof K!="number"&&!K?null:this.getOptionData(K)).filter(Boolean)),this.checkUpdateStatus(),this.remote&&this.modelValue&&this.defaultLabel){if(!this.multiple)this.query=this.defaultLabel,this.modelValue&&this.defaultLabel&&this.values.push({label:this.defaultLabel,value:this.modelValue});else if(this.multiple&&this.defaultLabel instanceof Array&&this.modelValue.length===this.defaultLabel.length){const K=this.modelValue.map((se,me)=>({value:se,label:this.defaultLabel[me]}));setTimeout(()=>{this.values=K})}}},data(){return{prefixCls:Qn,values:[],dropDownWidth:0,visible:!1,focusIndex:-1,isFocused:!1,query:"",initialLabel:this.label,hasMouseHoverHead:!1,slotOptions:[],caretPosition:-1,lastRemoteQuery:"",unchangedQuery:!0,hasExpectedValue:!1,isTyping:!1,preventRemoteCall:!1,filterQueryChange:!1,slotOptionsMap:new Map,isLocking:!1}},computed:{classes(){return[`${Qn}`,{[`${Qn}-visible`]:this.visible,[`${Qn}-disabled`]:this.itemDisabled,[`${Qn}-multiple`]:this.multiple,[`${Qn}-single`]:!this.multiple,[`${Qn}-${this.size}`]:!!this.size}]},dropdownCls(){return{[Qn+"-dropdown-transfer"]:this.transfer,[Qn+"-multiple"]:this.multiple&&this.transfer,"ivu-auto-complete":this.autoComplete,[this.transferClassName]:this.transferClassName}},selectionCls(){return{[`${Qn}-selection`]:!this.autoComplete,[`${Qn}-selection-focused`]:this.isFocused}},localeNotFoundText(){return typeof this.notFoundText>"u"?this.t("i.select.noMatch"):this.notFoundText},localeLoadingText(){return typeof this.loadingText>"u"?this.t("i.select.loading"):this.loadingText},showCreateItem(){let K=!1;const{allowCreate:se,query:me,slotOptions:Be}=this;return se&&me!==""&&(K=!0,(Be||[]).find(Re=>Re.proxy&&Re.proxy.showLabel===me)&&(K=!1)),K},transitionName(){return this.placement==="bottom"?"slide-up":"slide-down"},dropVisible(){let K=!0;const se=this.slotOptions.length===0;return!this.loading&&this.remote&&this.query===""&&se&&(K=!1),this.autoComplete&&se&&(K=!1),this.visible&&K},showNotFoundLabel(){const{loading:K,remote:se,slotOptions:me,hideNotFound:Be}=this,Re=me||[],ve=Re.find(Fe=>Fe.proxy.isShow);return(Re.length===0||!ve)&&(!se||se&&!K)&&!Be},publicValue(){return this.multiple?this.values.map(K=>K.value):(this.values[0]||{}).value},canBeCleared(){const K=this.hasMouseHoverHead,se=!this.multiple&&!this.itemDisabled&&this.clearable;return K&&se&&this.reset},selectTabindex(){return this.itemDisabled||this.filterable?-1:0},remote(){return typeof this.remoteMethod=="function"}},methods:{setQuery(K){if(K){this.onQueryChange(K);return}K===null&&(this.onQueryChange(""),this.values=[],this.lastRemoteQuery="")},clearSingleSelect(){this.multiple||this.$emit("update:modelValue",""),this.$emit("on-clear"),this.hideMenu(),this.clearable&&this.reset()},getOptionData(K){const se=this.slotOptions.find(({props:Re})=>Re.value===K);if(!se)return null;const{optionLabel:me,disabled:Be}=se.proxy||{};return{value:K,label:me,disabled:Be}},getInitialValue(){const{multiple:K,remote:se,modelValue:me}=this;let Be=Array.isArray(me)?me:[me];if(!K&&(typeof Be[0]>"u"||String(Be[0]).trim()===""&&!Number.isFinite(Be[0]))&&(Be=[]),se&&!K&&me){const Re=this.getOptionData(me);this.query=Re?Re.label:String(me)}return Be.filter(Re=>!!Re||Re===0)},validateOption({children:K,elm:se,propsData:me}){const Be=me.value,Re=me.label||"",ve=se&&se.textContent||(K||[]).reduce((tt,Ze)=>{const it=Ze.elm?Ze.elm.textContent:Ze.text;return`${tt} ${it}`},"")||"",Fe=this.filterByLabel?[Re].toString():[Be,Re,ve].toString(),Xe=this.query.toLowerCase().trim();return Fe.toLowerCase().includes(Xe)},toggleMenu(K,se){if(this.itemDisabled)return!1;this.visible=typeof se<"u"?se:!this.visible,this.visible&&(this.dropDownWidth=this.$el.getBoundingClientRect().width,this.$refs.dropdown.handleOnUpdatePopper())},hideMenu(){this.toggleMenu(null,!1),this.isTyping=!1,setTimeout(()=>this.unchangedQuery=!0,Zs)},onClickOutside(K){if(this.visible){if(K.type==="mousedown"){K.preventDefault();return}if(this.transfer){const se=this.$refs.dropdown.$refs.drop;if(se===K.target||se.contains(K.target))return}if(this.filterable){const se=this.$el.querySelector('input[type="text"]');this.caretPosition=se.selectionStart,E.nextTick(()=>{const me=this.caretPosition===-1?se.value.length:this.caretPosition;se.setSelectionRange(me,me)})}this.autoComplete||K.stopPropagation(),K.preventDefault(),this.hideMenu(),this.isFocused=!0,this.$emit("on-clickoutside",K)}else this.caretPosition=-1,this.isFocused=!1},reset(){this.query="",this.focusIndex=-1,this.unchangedQuery=!0,this.values=[],this.filterQueryChange=!1},handleKeydown(K){const se=K.key||K.code,me=K.keyCode||K.which;if(!(se==="Backspace"||me===8))if(this.visible){if(K.preventDefault(),se==="Tab"&&K.stopPropagation(),se==="Escape"&&(K.stopPropagation(),this.hideMenu()),se==="ArrowUp"&&this.navigateOptions(-1),se==="ArrowDown"&&this.navigateOptions(1),se==="Enter"){if(this.focusIndex===-1)return this.hideMenu();const Be=this.slotOptions[this.focusIndex];if(Be){const Re=this.getOptionData(Be.props.value);this.onOptionClick(Re)}else this.hideMenu()}}else["ArrowUp","ArrowDown"].includes(K.key)&&this.toggleMenu(null,!0)},navigateOptions(K){const se=this.slotOptions,me=se.length-1;if(me<0)return;let Be=this.focusIndex+K;Be<0&&(Be=me),Be>me&&(Be=0);let Re,ve=null;if(K>0){Re=-1;for(let Fe=0;Fe<se.length;Fe++){const{proxy:Xe}=se[Fe];if(!Xe.disabled&&(Re=Fe),Xe.isShow&&ve===null)ve=Fe;else if(!Xe.isShow){Re=Fe;continue}if(Re>=Be)break}}else{Re=se.length;for(let Fe=me;Fe>=0;Fe--){const{proxy:Xe}=se[Fe];if(!Xe.disabled&&(Re=Fe),Xe.isShow&&ve===null)ve=Fe;else if(!Xe.isShow){Re=Fe;continue}if(Re<=Be)break}}Be=se[Re].proxy.isShow?Re:ve,this.focusIndex=Be},onOptionClick(K){if(this.multiple?(this.remote?this.lastRemoteQuery=this.lastRemoteQuery||this.query:this.lastRemoteQuery="",this.values.find(({value:se})=>se===K.value)?this.values=this.values.filter(({value:se})=>se!==K.value):this.values=this.values.concat(K),this.isFocused=!0):(this.query=String(K.label).trim(),this.values=[K],this.lastRemoteQuery="",this.hideMenu()),this.focusIndex=this.slotOptions.findIndex(se=>se?se.props.value===K.value:!1),this.filterable){const se=this.$el.querySelector('input[type="text"]');this.autoComplete||E.nextTick(()=>se.focus())}this.$emit("on-select",K),this.$refs.dropdown.handleOnUpdatePopper(),setTimeout(()=>{this.filterQueryChange=!1},Zs)},onQueryChange(K){if(this.isTyping=!0,K.length>0&&K!==this.query)if(W&&this.autoComplete){let se=document.hasFocus&&document.hasFocus()&&document.activeElement===this.$el.querySelector("input");this.visible=se}else this.visible=!0;this.query=K,this.unchangedQuery=this.visible,this.filterQueryChange=!0},toggleHeaderFocus({type:K}){this.itemDisabled||(this.isFocused=K==="focus")},checkUpdateStatus(){this.getInitialValue().length>0&&this.slotOptions.length===0&&(this.hasExpectedValue=!0)},handleCreateItem(){if(this.allowCreate&&this.query!==""&&this.showCreateItem){const K=this.query;this.$emit("on-create",K),this.query="";const se={value:K,label:K,tag:void 0};this.$refs.dropdown.handleOnUpdatePopper(),setTimeout(()=>{this.onOptionClick(se)})}},handleOnSelectSelected(K){this.onOptionClick(K)},focus(){this.filterable&&(this.$refs.selectHead.$refs.input.focus(),this.toggleMenu())},lazyUpdateValue(K){const{getInitialValue:se,isLocking:me,defaultLabel:Be,remote:Re,modelValue:ve,values:Fe}=this,Xe=!!(Be&&Be.length);(ve&&ve.length||Fe.length||Xe)&&Re&&K||me||(this.isLocking=!0,E.nextTick(()=>{this.values=se().map(this.getOptionData).filter(Boolean),this.isLocking=!1}))}},watch:{modelValue(K){const{publicValue:se,values:me}=this;this.checkUpdateStatus(),K===""?(this.values=[],this.query=""):Cs(K,se,me)&&(this.lazyUpdateValue(),this.multiple||this.handleFormItemChange("change",this.publicValue))},values(K,se){const me=JSON.stringify(K),Be=JSON.stringify(se);let Re=this.publicValue;if(me!==Be&&Re!==this.modelValue){let ve=this.publicValue;this.labelInValue&&(this.multiple?ve=this.values:ve=this.values[0]),(Array.isArray(Re)&&!Re.length&&this.modelValue===null||Re===void 0&&this.modelValue===null)&&(Re=null),this.$emit("update:modelValue",Re),this.$emit("on-change",ve),this.handleFormItemChange("change",ve)}},query(K){this.focusIndex=-1,this.$emit("on-query-change",K);const{remoteMethod:se,lastRemoteQuery:me}=this,Be=se&&K!==""&&(K!==me||!me)&&!this.preventRemoteCall;if(this.preventRemoteCall=!1,Be){const Re=this.remoteMethod(K);this.initialLabel="",Re&&Re.then&&Re.then(ve=>{ve&&(this.options=ve)})}this.visible&&this.$refs.dropdown.handleOnUpdatePopper(),K!==""&&this.remote&&(this.lastRemoteQuery=K)},isFocused(K){(this.filterable?this.$el.querySelector('input[type="text"]'):this.$el)[this.isFocused?"focus":"blur"]();const[se]=this.values;if(se&&this.filterable&&!this.multiple&&!K){const me=String(se.label||se.value).trim();me&&this.query!==me&&(this.preventRemoteCall=!0,this.query=me)}},focusIndex(K){if(!(K<0||this.autoComplete)&&this.slotOptions[K]){const se=this.slotOptions[K].proxy.$el,me=this.$refs.dropdown.$refs.drop;let Be=se.getBoundingClientRect().bottom-me.getBoundingClientRect().bottom,Re=se.getBoundingClientRect().top-me.getBoundingClientRect().top;Be>0&&(me.scrollTop+=Be),Re<0&&(me.scrollTop+=Re)}},dropVisible(K){K?this.$refs.dropdown.handleOnUpdatePopper():this.$refs.dropdown.handleOnDestroyPopper()},visible(K){this.$emit("on-open-change",K)}}},Mn=["tabindex"],ia=["name","value"];function Kn(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("select-head"),Xe=E.resolveComponent("Icon"),tt=E.resolveComponent("Drop"),Ze=E.resolveDirective("click-outside");return E.withDirectives((E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("div",{ref:"reference",class:E.normalizeClass(ve.selectionCls),tabindex:ve.selectTabindex,onBlur:se[2]||(se[2]=(...it)=>ve.toggleHeaderFocus&&ve.toggleHeaderFocus(...it)),onFocus:se[3]||(se[3]=(...it)=>ve.toggleHeaderFocus&&ve.toggleHeaderFocus(...it)),onClick:se[4]||(se[4]=(...it)=>ve.toggleMenu&&ve.toggleMenu(...it)),onKeydown:[se[5]||(se[5]=E.withKeys((...it)=>ve.handleKeydown&&ve.handleKeydown(...it),["esc"])),se[6]||(se[6]=E.withKeys((...it)=>ve.handleKeydown&&ve.handleKeydown(...it),["enter"])),se[7]||(se[7]=E.withKeys(E.withModifiers((...it)=>ve.handleKeydown&&ve.handleKeydown(...it),["prevent"]),["up"])),se[8]||(se[8]=E.withKeys(E.withModifiers((...it)=>ve.handleKeydown&&ve.handleKeydown(...it),["prevent"]),["down"])),se[9]||(se[9]=E.withKeys((...it)=>ve.handleKeydown&&ve.handleKeydown(...it),["tab"])),se[10]||(se[10]=E.withKeys((...it)=>ve.handleKeydown&&ve.handleKeydown(...it),["delete"]))],onMouseenter:se[11]||(se[11]=it=>Re.hasMouseHoverHead=!0),onMouseleave:se[12]||(se[12]=it=>Re.hasMouseHoverHead=!1)},[E.renderSlot(K.$slots,"input",{},()=>[E.createElementVNode("input",{type:"hidden",name:me.name,value:ve.publicValue},null,8,ia),E.createVNode(Fe,{ref:"selectHead",filterable:me.filterable,multiple:me.multiple,values:Re.values,clearable:ve.canBeCleared,prefix:me.prefix,disabled:K.itemDisabled,remote:ve.remote,"input-element-id":me.elementId,"initial-label":Re.initialLabel,placeholder:me.placeholder,"query-prop":Re.query,"max-tag-count":me.maxTagCount,"max-tag-placeholder":me.maxTagPlaceholder,"allow-create":me.allowCreate,"show-create-item":ve.showCreateItem,onOnQueryChange:ve.onQueryChange,onOnInputFocus:se[0]||(se[0]=it=>Re.isFocused=!0),onOnInputBlur:se[1]||(se[1]=it=>Re.isFocused=!1),onOnClear:ve.clearSingleSelect,onOnEnter:ve.handleCreateItem},{prefix:E.withCtx(()=>[E.renderSlot(K.$slots,"prefix")]),_:3},8,["filterable","multiple","values","clearable","prefix","disabled","remote","input-element-id","initial-label","placeholder","query-prop","max-tag-count","max-tag-placeholder","allow-create","show-create-item","onOnQueryChange","onOnClear","onOnEnter"])])],42,Mn),E.createVNode(tt,{ref:"dropdown",classes:ve.dropdownCls,visible:ve.dropVisible,placement:me.placement,eventsEnabled:me.eventsEnabled,transfer:me.transfer,"transition-name":"transition-drop"},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls+"-not-found"])},[E.createElementVNode("li",null,E.toDisplayString(ve.localeNotFoundText),1)],2),[[E.vShow,ve.showNotFoundLabel&&!me.allowCreate]]),!ve.remote||ve.remote&&!me.loading?(E.openBlock(),E.createElementBlock("ul",{key:0,class:E.normalizeClass(Re.prefixCls+"-dropdown-list")},[ve.showCreateItem?(E.openBlock(),E.createElementBlock("li",{key:0,class:E.normalizeClass(Re.prefixCls+"-item"),onClick:se[13]||(se[13]=(...it)=>ve.handleCreateItem&&ve.handleCreateItem(...it))},[E.createTextVNode(E.toDisplayString(Re.query)+" ",1),E.createVNode(Xe,{type:"md-return-left",class:E.normalizeClass(Re.prefixCls+"-item-enter")},null,8,["class"])],2)):E.createCommentVNode("",!0),E.renderSlot(K.$slots,"default")],2)):(E.openBlock(),E.createElementBlock("ul",{key:1,class:E.normalizeClass(Re.prefixCls+"-dropdown-list")},[ve.showCreateItem?(E.openBlock(),E.createElementBlock("li",{key:0,class:E.normalizeClass(Re.prefixCls+"-item"),onClick:se[14]||(se[14]=(...it)=>ve.handleCreateItem&&ve.handleCreateItem(...it))},[E.createTextVNode(E.toDisplayString(Re.query)+" ",1),E.createVNode(Xe,{type:"md-return-left",class:E.normalizeClass(Re.prefixCls+"-item-enter")},null,8,["class"])],2)):E.createCommentVNode("",!0)],2)),E.withDirectives(E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls+"-loading"])},E.toDisplayString(ve.localeLoadingText),3),[[E.vShow,me.loading]])]),_:3},8,["classes","visible","placement","eventsEnabled","transfer"])],2)),[[Ze,ve.onClickOutside,me.capture],[Ze,ve.onClickOutside,me.capture,{mousedown:!0}],[Ze,ve.onClickOutside,me.capture,{touchstart:!0}]])}var Es=Y(jn,[["render",Kn]]);const na="ivu-select-item",sa={name:"iOption",componentName:"select-item",mixins:[In],emits:["on-select-selected"],inject:{SelectInstance:{default:null},OptionGroupInstance:{default:null}},props:{value:{type:[String,Number],required:!0},label:{type:[String,Number]},disabled:{type:Boolean,default:!1},tag:{type:[String,Number]}},data(){return{searchLabel:"",autoComplete:!1,id:gt(6),instance:null}},computed:{classes(){return[`${na}`,{[`${na}-disabled`]:this.itemDisabled,[`${na}-selected`]:this.selected&&!this.autoComplete,[`${na}-focus`]:this.isFocused}]},showLabel(){return this.label?this.label:this.value},optionLabel(){return this.label||this.$el&&this.$el.textContent},isFocused(){const K=this.SelectInstance;let se=K.slotOptions||[];const me=K.focusIndex,Be=K.$slots.default;if(this.autoComplete&&Be){se=[];let ve=Be();for(;ve.length>0;){const Fe=ve.shift();Fe.type&&typeof Fe.type=="object"&&Fe.type.name==="iOption"?se.push(Fe):Array.isArray(Fe.children)&&(ve=ve.concat(Fe.children))}}const Re=se[me];return Re&&Re.props&&Re.props.value===this.value},isShow(){const K=this.SelectInstance,se=K.filterable,me=K.query.toLowerCase().trim(),Be=K.filterByLabel,Re=K.slotOptionsMap,{props:ve}=Re.get(this.value)||{props:{}},Fe=this.label||this.$el&&this.$el.textContent;let Xe=(Fe||ve.value||"").toLowerCase();Be&&(Xe=(Fe||"").toLowerCase());const tt=Xe.includes(me);return!se||se&&(tt||!K.filterQueryChange)||qe(K.remoteMethod)==="function"},selected(){return(this.SelectInstance.values||[]).find(K=>K.value===this.value)}},methods:{select(){if(this.itemDisabled)return!1;this.SelectInstance.handleOnSelectSelected({value:this.value,label:this.optionLabel,tag:this.tag})},addOption(){const K=this.SelectInstance,se=this.OptionGroupInstance,{id:me,value:Be,instance:Re}=this;if(se&&se.optionList.push({...Re,id:me,tag:"option"}),K){K.slotOptions.push({...Re,id:me,tag:"option"}),K.slotOptionsMap.set(Be,Re);const{modelValue:ve}=K;(ve&&ve.length||qe(ve)==="number")&&K.lazyUpdateValue(!0)}},removeOption(){const K=this.OptionGroupInstance,se=this.SelectInstance,{id:me,value:Be}=this;if(K){const Re=K.optionList.findIndex(ve=>ve.id===me);Re!==-1&&K.optionList.splice(Re,1)}if(se){const Re=this.SelectInstance,ve=Re.slotOptions.findIndex(Fe=>Fe.id===me);ve!==-1&&Re.slotOptions.splice(ve,1),Re.slotOptionsMap.has(Be)&&Re.slotOptionsMap.delete(Be)}}},created(){this.instance=E.getCurrentInstance()},mounted(){this.addOption();const K=Je(this,"iSelect");K&&(this.autoComplete=K.autoComplete)},beforeUnmount(){E.nextTick(()=>{this.removeOption(),this.instance=null})}};function el(K,se,me,Be,Re,ve){return E.withDirectives((E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.classes),onClick:se[0]||(se[0]=E.withModifiers((...Fe)=>ve.select&&ve.select(...Fe),["stop"])),onMousedown:se[1]||(se[1]=E.withModifiers(()=>{},["prevent"]))},[E.renderSlot(K.$slots,"default",{},()=>[E.createTextVNode(E.toDisplayString(ve.showLabel),1)])],34)),[[E.vShow,ve.isShow]])}var ss=Y(sa,[["render",el]]);const yo=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important
`,tl=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];let xs={},Vs;function Cu(K,se=!1){if(!W)return;const me=K.getAttribute("id")||K.getAttribute("data-reactid")||K.getAttribute("name");if(se&&xs[me])return xs[me];const Be=window.getComputedStyle(K),Re=Be.getPropertyValue("box-sizing")||Be.getPropertyValue("-moz-box-sizing")||Be.getPropertyValue("-webkit-box-sizing"),ve=parseFloat(Be.getPropertyValue("padding-bottom"))+parseFloat(Be.getPropertyValue("padding-top")),Fe=parseFloat(Be.getPropertyValue("border-bottom-width"))+parseFloat(Be.getPropertyValue("border-top-width")),Xe={sizingStyle:tl.map(tt=>`${tt}:${Be.getPropertyValue(tt)}`).join(";"),paddingSize:ve,borderSize:Fe,boxSizing:Re};return se&&me&&(xs[me]=Xe),Xe}function ql(K,se=null,me=null,Be=!1){W&&!Vs&&(Vs=document.createElement("textarea"),document.body.appendChild(Vs)),K.getAttribute("wrap")?Vs.setAttribute("wrap",K.getAttribute("wrap")):Vs.removeAttribute("wrap");let{paddingSize:Re,borderSize:ve,boxSizing:Fe,sizingStyle:Xe}=Cu(K,Be);Vs.setAttribute("style",`${Xe};${yo}`),Vs.value=K.value||K.placeholder||"";let tt=Number.MIN_SAFE_INTEGER,Ze=Number.MAX_SAFE_INTEGER,it=Vs.scrollHeight,nr;if(Fe==="border-box"?it=it+ve:Fe==="content-box"&&(it=it-Re),se!==null||me!==null){Vs.value=" ";let jr=Vs.scrollHeight-Re;se!==null&&(tt=jr*se,Fe==="border-box"&&(tt=tt+Re+ve),it=Math.max(tt,it)),me!==null&&(Ze=jr*me,Fe==="border-box"&&(Ze=Ze+Re+ve),nr=it>Ze?"":"hidden",it=Math.min(Ze,it))}return me||(nr="hidden"),{height:`${it}px`,minHeight:`${tt}px`,maxHeight:`${Ze}px`,overflowY:nr}}const ls="ivu-input",gg={name:"Input",mixins:[In],emits:["on-enter","on-search","on-keydown","on-keypress","on-keyup","on-click","on-focus","on-blur","on-change","on-input-change","on-clear","update:modelValue"],props:{type:{validator(K){return Ie(K,["text","textarea","password","url","email","date","number","tel"])},default:"text"},modelValue:{type:[String,Number],default:""},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},placeholder:{type:String,default:""},maxlength:{type:[String,Number]},disabled:{type:Boolean,default:!1},icon:String,autosize:{type:[Boolean,Object],default:!1},rows:{type:Number,default:2},readonly:{type:Boolean,default:!1},name:{type:String},number:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!1},autocomplete:{type:String,default:"off"},clearable:{type:Boolean,default:!1},elementId:{type:String},wrap:{validator(K){return Ie(K,["hard","soft"])},default:"soft"},prefix:{type:String,default:""},suffix:{type:String,default:""},search:{type:Boolean,default:!1},enterButton:{type:[Boolean,String],default:!1},showWordLimit:{type:Boolean,default:!1},password:{type:Boolean,default:!1},border:{type:Boolean,default:!0}},data(){return{currentValue:this.modelValue,prefixCls:ls,slotReady:!1,textareaStyles:{},isOnComposition:!1,showPassword:!1,clearableIconOffset:0}},computed:{currentType(){let K=this.type;return K==="password"&&this.password&&this.showPassword&&(K="text"),K},prepend(){let K=!1;return this.type!=="textarea"&&(K=this.$slots.prepend!==void 0),K},append(){let K=!1;return this.type!=="textarea"&&(K=this.$slots.append!==void 0),K},showPrefix(){let K=!1;return this.type!=="textarea"&&(K=this.prefix!==""||this.$slots.prefix!==void 0),K},showSuffix(){let K=!1;return this.type!=="textarea"&&(K=this.suffix!==""||this.$slots.suffix!==void 0),K},wrapClasses(){return[`${ls}-wrapper`,{[`${ls}-wrapper-${this.size}`]:!!this.size,[`${ls}-type-${this.type}`]:this.type,[`${ls}-group`]:this.prepend||this.append||this.search&&this.enterButton,[`${ls}-group-${this.size}`]:(this.prepend||this.append||this.search&&this.enterButton)&&!!this.size,[`${ls}-group-with-prepend`]:this.prepend,[`${ls}-group-with-append`]:this.append||this.search&&this.enterButton,[`${ls}-hide-icon`]:this.append,[`${ls}-with-search`]:this.search&&this.enterButton,[`${ls}-wrapper-disabled`]:this.itemDisabled}]},inputClasses(){return[`${ls}`,{[`${ls}-${this.size}`]:!!this.size,[`${ls}-disabled`]:this.itemDisabled,[`${ls}-no-border`]:!this.border,[`${ls}-with-prefix`]:this.showPrefix,[`${ls}-with-suffix`]:this.showSuffix||this.search&&this.enterButton===!1}]},textareaClasses(){return[`${ls}`,{[`${ls}-disabled`]:this.itemDisabled,[`${ls}-no-border`]:!this.border}]},upperLimit(){return this.maxlength},textLength(){return typeof this.modelValue=="number"?String(this.modelValue).length:(this.modelValue||"").length},clearableStyles(){const K={};let se=this.clearableIconOffset;return se&&(K.transform=`translateX(-${se}px)`),K}},methods:{handleEnter(K){this.$emit("on-enter",K),this.search&&this.$emit("on-search",this.currentValue)},handleKeydown(K){this.$emit("on-keydown",K)},handleKeypress(K){this.$emit("on-keypress",K)},handleKeyup(K){this.$emit("on-keyup",K)},handleIconClick(K){this.$emit("on-click",K)},handleFocus(K){this.$emit("on-focus",K)},handleBlur(K){this.$emit("on-blur",K),Je(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("blur",this.currentValue)},handleComposition(K){K.type==="compositionstart"&&(this.isOnComposition=!0),K.type==="compositionend"&&(this.isOnComposition=!1,this.handleInput(K))},handleInput(K){if(this.isOnComposition)return;let se=K.target.value;this.number&&se!==""&&(se=Number.isNaN(Number(se))?se:Number(se)),this.$emit("update:modelValue",se),this.setCurrentValue(se),this.$emit("on-change",K)},handleChange(K){this.$emit("on-input-change",K)},setCurrentValue(K){K!==this.currentValue&&(E.nextTick(()=>{this.resizeTextarea()}),this.currentValue=K,Je(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("change",K))},resizeTextarea(){const K=this.autosize;if(!K||this.type!=="textarea")return!1;const se=K.minRows,me=K.maxRows;this.textareaStyles=ql(this.$refs.textarea,se,me)},focus(K){const se=this.type==="textarea"?this.$refs.textarea:this.$refs.input;se.focus(K);const{cursor:me}=K||{};if(me){const Be=se.value.length;switch(me){case"start":se.setSelectionRange(0,0);break;case"end":se.setSelectionRange(Be,Be);break;default:se.setSelectionRange(0,Be)}}},blur(){this.type==="textarea"?this.$refs.textarea.blur():this.$refs.input.blur()},handleClear(){const K={target:{value:""}};this.$emit("update:modelValue",""),this.setCurrentValue(""),this.$emit("on-change",K),this.$emit("on-clear")},handleSearch(){if(this.itemDisabled)return!1;this.$refs.input.focus(),this.$emit("on-search",this.currentValue)},handleToggleShowPassword(){if(this.itemDisabled)return!1;this.showPassword=!this.showPassword,this.focus();const K=this.currentValue.length;setTimeout(()=>{this.$refs.input.setSelectionRange(K,K)},0)},handleCalcIconOffset(){const K=this.$el.querySelectorAll(".ivu-input-group-append")[0];K?this.clearableIconOffset=K.offsetWidth:this.clearableIconOffset=0}},watch:{modelValue(K){this.setCurrentValue(K)},type(){E.nextTick(this.handleCalcIconOffset)}},mounted(){this.slotReady=!0,this.resizeTextarea(),this.handleCalcIconOffset()},updated(){E.nextTick(this.handleCalcIconOffset)}},yg={key:4,class:"ivu-input-suffix"},_g={key:5,class:"ivu-input-word-count"},vg={key:0,class:"ivu-icon ivu-icon-ios-eye-outline"},bg={key:1,class:"ivu-icon ivu-icon-ios-eye-off-outline"},Sg=["id","autocomplete","spellcheck","type","placeholder","disabled","maxlength","readonly","name","value","number","autofocus"],wg={key:0,class:"ivu-icon ivu-icon-ios-search"},Og={key:9,class:"ivu-input-prefix"},Cg=["id","wrap","autocomplete","spellcheck","placeholder","disabled","rows","maxlength","readonly","name","value","autofocus"],Tg={key:0,class:"ivu-input-word-count"};function Eg(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[me.type!=="textarea"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[ve.prepend?E.withDirectives((E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-group-prepend"])},[E.renderSlot(K.$slots,"prepend")],2)),[[E.vShow,Re.slotReady]]):E.createCommentVNode("",!0),me.clearable&&Re.currentValue&&!K.itemDisabled?(E.openBlock(),E.createElementBlock("i",{key:1,class:E.normalizeClass(["ivu-icon",["ivu-icon-ios-close-circle",Re.prefixCls+"-icon",Re.prefixCls+"-icon-clear",Re.prefixCls+"-icon-normal"]]),onClick:se[0]||(se[0]=(...Fe)=>ve.handleClear&&ve.handleClear(...Fe)),style:E.normalizeStyle(ve.clearableStyles)},null,6)):me.icon?(E.openBlock(),E.createElementBlock("i",{key:2,class:E.normalizeClass(["ivu-icon",["ivu-icon-"+me.icon,Re.prefixCls+"-icon",Re.prefixCls+"-icon-normal"]]),onClick:se[1]||(se[1]=(...Fe)=>ve.handleIconClick&&ve.handleIconClick(...Fe))},null,2)):me.search&&me.enterButton===!1?(E.openBlock(),E.createElementBlock("i",{key:3,class:E.normalizeClass(["ivu-icon ivu-icon-ios-search",[Re.prefixCls+"-icon",Re.prefixCls+"-icon-normal",Re.prefixCls+"-search-icon"]]),onClick:se[2]||(se[2]=(...Fe)=>ve.handleSearch&&ve.handleSearch(...Fe))},null,2)):ve.showSuffix?(E.openBlock(),E.createElementBlock("span",yg,[E.renderSlot(K.$slots,"suffix",{},()=>[me.suffix?(E.openBlock(),E.createElementBlock("i",{key:0,class:E.normalizeClass(["ivu-icon",["ivu-icon-"+me.suffix]])},null,2)):E.createCommentVNode("",!0)])])):me.showWordLimit?(E.openBlock(),E.createElementBlock("span",_g,E.toDisplayString(ve.textLength)+"/"+E.toDisplayString(ve.upperLimit),1)):me.password?(E.openBlock(),E.createElementBlock("span",{key:6,class:"ivu-input-suffix",onClick:se[3]||(se[3]=(...Fe)=>ve.handleToggleShowPassword&&ve.handleToggleShowPassword(...Fe))},[Re.showPassword?(E.openBlock(),E.createElementBlock("i",vg)):(E.openBlock(),E.createElementBlock("i",bg))])):E.createCommentVNode("",!0),E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[me.icon?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("i",{key:0,class:E.normalizeClass(["ivu-icon ivu-icon-ios-loading ivu-load-loop",[Re.prefixCls+"-icon",Re.prefixCls+"-icon-validate"]])},null,2))]),_:1}),E.createElementVNode("input",{id:me.elementId,autocomplete:me.autocomplete,spellcheck:me.spellcheck,ref:"input",type:ve.currentType,class:E.normalizeClass(ve.inputClasses),placeholder:me.placeholder,disabled:K.itemDisabled,maxlength:me.maxlength,readonly:me.readonly,name:me.name,value:Re.currentValue,number:me.number,autofocus:me.autofocus,onKeyup:[se[4]||(se[4]=E.withKeys((...Fe)=>ve.handleEnter&&ve.handleEnter(...Fe),["enter"])),se[5]||(se[5]=(...Fe)=>ve.handleKeyup&&ve.handleKeyup(...Fe))],onKeypress:se[6]||(se[6]=(...Fe)=>ve.handleKeypress&&ve.handleKeypress(...Fe)),onKeydown:se[7]||(se[7]=(...Fe)=>ve.handleKeydown&&ve.handleKeydown(...Fe)),onFocus:se[8]||(se[8]=(...Fe)=>ve.handleFocus&&ve.handleFocus(...Fe)),onBlur:se[9]||(se[9]=(...Fe)=>ve.handleBlur&&ve.handleBlur(...Fe)),onCompositionstart:se[10]||(se[10]=(...Fe)=>ve.handleComposition&&ve.handleComposition(...Fe)),onCompositionupdate:se[11]||(se[11]=(...Fe)=>ve.handleComposition&&ve.handleComposition(...Fe)),onCompositionend:se[12]||(se[12]=(...Fe)=>ve.handleComposition&&ve.handleComposition(...Fe)),onInput:se[13]||(se[13]=(...Fe)=>ve.handleInput&&ve.handleInput(...Fe)),onChange:se[14]||(se[14]=(...Fe)=>ve.handleChange&&ve.handleChange(...Fe))},null,42,Sg),ve.append?E.withDirectives((E.openBlock(),E.createElementBlock("div",{key:7,class:E.normalizeClass([Re.prefixCls+"-group-append"])},[E.renderSlot(K.$slots,"append")],2)),[[E.vShow,Re.slotReady]]):me.search&&me.enterButton?(E.openBlock(),E.createElementBlock("div",{key:8,class:E.normalizeClass([Re.prefixCls+"-group-append",Re.prefixCls+"-search"]),onClick:se[15]||(se[15]=(...Fe)=>ve.handleSearch&&ve.handleSearch(...Fe))},[me.enterButton===!0?(E.openBlock(),E.createElementBlock("i",wg)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createTextVNode(E.toDisplayString(me.enterButton),1)],64))],2)):ve.showPrefix?(E.openBlock(),E.createElementBlock("span",Og,[E.renderSlot(K.$slots,"prefix",{},()=>[me.prefix?(E.openBlock(),E.createElementBlock("i",{key:0,class:E.normalizeClass(["ivu-icon",["ivu-icon-"+me.prefix]])},null,2)):E.createCommentVNode("",!0)])])):E.createCommentVNode("",!0)],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createElementVNode("textarea",{id:me.elementId,wrap:me.wrap,autocomplete:me.autocomplete,spellcheck:me.spellcheck,ref:"textarea",class:E.normalizeClass(ve.textareaClasses),style:E.normalizeStyle(Re.textareaStyles),placeholder:me.placeholder,disabled:K.itemDisabled,rows:me.rows,maxlength:me.maxlength,readonly:me.readonly,name:me.name,value:Re.currentValue,autofocus:me.autofocus,onKeyup:[se[16]||(se[16]=E.withKeys((...Fe)=>ve.handleEnter&&ve.handleEnter(...Fe),["enter"])),se[17]||(se[17]=(...Fe)=>ve.handleKeyup&&ve.handleKeyup(...Fe))],onKeypress:se[18]||(se[18]=(...Fe)=>ve.handleKeypress&&ve.handleKeypress(...Fe)),onKeydown:se[19]||(se[19]=(...Fe)=>ve.handleKeydown&&ve.handleKeydown(...Fe)),onFocus:se[20]||(se[20]=(...Fe)=>ve.handleFocus&&ve.handleFocus(...Fe)),onBlur:se[21]||(se[21]=(...Fe)=>ve.handleBlur&&ve.handleBlur(...Fe)),onCompositionstart:se[22]||(se[22]=(...Fe)=>ve.handleComposition&&ve.handleComposition(...Fe)),onCompositionupdate:se[23]||(se[23]=(...Fe)=>ve.handleComposition&&ve.handleComposition(...Fe)),onCompositionend:se[24]||(se[24]=(...Fe)=>ve.handleComposition&&ve.handleComposition(...Fe)),onInput:se[25]||(se[25]=(...Fe)=>ve.handleInput&&ve.handleInput(...Fe))},`
            `,46,Cg),me.showWordLimit?(E.openBlock(),E.createElementBlock("span",Tg,E.toDisplayString(ve.textLength)+"/"+E.toDisplayString(ve.upperLimit),1)):E.createCommentVNode("",!0)],64))],2)}var Js=Y(gg,[["render",Eg]]);const Ag={name:"AutoComplete",mixins:[In],components:{iSelect:Es,iOption:ss,iInput:Js},emits:["update:modelValue","on-change","on-search","on-select","on-focus","on-blur","on-clear"],props:{modelValue:{type:[String,Number],default:""},label:{type:[String,Number],default:""},data:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},icon:{type:String},filterMethod:{type:[Function,Boolean],default:!1},placement:{validator(K){return Ie(K,["top","bottom","top-start","bottom-start","top-end","bottom-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},transferClassName:{type:String},capture:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return K.$VIEWUI?K.$VIEWUI.capture:!0}},eventsEnabled:{type:Boolean,default:!1}},data(){return{currentValue:this.modelValue,disableEmitChange:!1}},computed:{inputIcon(){let K="";return this.clearable&&this.currentValue&&!this.disabled?K="ios-close-circle":this.icon&&(K=this.icon),K},filteredData(){return this.filterMethod?this.data.filter(K=>this.filterMethod(this.currentValue,K)):this.data}},watch:{modelValue(K){this.currentValue!==K&&(this.disableEmitChange=!0),this.currentValue=K},currentValue(K){if(this.$refs.select.setQuery(K),this.$emit("update:modelValue",K),this.disableEmitChange){this.disableEmitChange=!1;return}this.$emit("on-change",K),this.handleFormItemChange("change",K)}},methods:{remoteMethod(K){this.$emit("on-search",K)},handleSelect(K){const se=K.value;se!=null&&(this.currentValue=se,this.$refs.input.blur(),this.$emit("on-select",se))},handleFocus(K){this.$emit("on-focus",K)},handleBlur(K){this.$emit("on-blur",K)},handleClear(){!this.clearable||(this.currentValue="",this.$refs.select.reset(),this.$emit("on-clear"))},handleClickOutside(){E.nextTick(()=>{this.$refs.input.blur()})}}};function Mg(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("i-input"),Xe=E.resolveComponent("i-option"),tt=E.resolveComponent("i-select");return E.openBlock(),E.createBlock(tt,{ref:"select",class:"ivu-auto-complete",label:me.label,disabled:K.itemDisabled,clearable:me.clearable,placeholder:me.placeholder,size:me.size,placement:me.placement,"model-value":Re.currentValue,"transfer-class-name":me.transferClassName,filterable:"",remote:"","auto-complete":"","remote-method":ve.remoteMethod,onOnSelect:ve.handleSelect,onOnClickoutside:ve.handleClickOutside,transfer:me.transfer,capture:me.capture,eventsEnabled:me.eventsEnabled},{input:E.withCtx(()=>[E.renderSlot(K.$slots,"input",{},()=>[E.createVNode(Fe,{"element-id":me.elementId,ref:"input",modelValue:Re.currentValue,"onUpdate:modelValue":se[0]||(se[0]=Ze=>Re.currentValue=Ze),name:me.name,placeholder:me.placeholder,disabled:K.itemDisabled,size:me.size,icon:ve.inputIcon,onOnClick:ve.handleClear,onOnFocus:ve.handleFocus,onOnBlur:ve.handleBlur},null,8,["element-id","modelValue","name","placeholder","disabled","size","icon","onOnClick","onOnFocus","onOnBlur"])])]),default:E.withCtx(()=>[E.renderSlot(K.$slots,"default",{},()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.filteredData,Ze=>(E.openBlock(),E.createBlock(Xe,{value:Ze,key:Ze},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(Ze),1)]),_:2},1032,["value"]))),128))])]),_:3},8,["label","disabled","clearable","placeholder","size","placement","model-value","transfer-class-name","remote-method","onOnSelect","onOnClickoutside","transfer","capture","eventsEnabled"])}var ed=Y(Ag,[["render",Mg]]);const va="ivu-avatar",td=["small","large","default"],Pg={name:"Avatar",components:{Icon:Ae},emits:["on-error"],props:{shape:{validator(K){return Ie(K,["circle","square"])},default:"circle"},size:{type:[String,Number],default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},src:{type:String},icon:{type:String},customIcon:{type:String,default:""}},data(){return{prefixCls:va,scale:1,childrenWidth:0,isSlotShow:!1,slotTemp:null}},computed:{classes(){return[`${va}`,`${va}-${this.shape}`,{[`${va}-image`]:!!this.src,[`${va}-icon`]:!!this.icon||!!this.customIcon,[`${va}-${this.size}`]:Ie(this.size,td)}]},styles(){let K={};return this.size&&!Ie(this.size,td)&&(K.width=`${this.size}px`,K.height=`${this.size}px`,K.lineHeight=`${this.size}px`,K.fontSize=`${this.size/2}px`),K},childrenStyle(){let K={};return this.isSlotShow&&(K={msTransform:`scale(${this.scale})`,WebkitTransform:`scale(${this.scale})`,transform:`scale(${this.scale})`,position:"absolute",display:"inline-block",left:`calc(50% - ${Math.round(this.childrenWidth/2)}px)`}),K}},watch:{size(K,se){K!==se&&this.setScale()}},methods:{setScale(){if(this.isSlotShow=!this.src&&!this.icon,this.$refs.children){this.childrenWidth=this.$refs.children.offsetWidth;const K=this.$el.getBoundingClientRect().width;K-8<this.childrenWidth?this.scale=(K-8)/this.childrenWidth:this.scale=1}},handleError(K){this.$emit("on-error",K)}},beforeCreate(){this.slotTemp=this.$slots.default?this.$slots.default():null},mounted(){this.setScale()},updated(){const K=this.$slots.default?this.$slots.default():null;K&&K!==this.slotTemp&&this.setScale()}},Rg=["src"];function kg(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("span",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.styles)},[me.src?(E.openBlock(),E.createElementBlock("img",{key:0,src:me.src,onError:se[0]||(se[0]=(...Xe)=>ve.handleError&&ve.handleError(...Xe))},null,40,Rg)):me.icon||me.customIcon?(E.openBlock(),E.createBlock(Fe,{key:1,type:me.icon,custom:me.customIcon},null,8,["type","custom"])):(E.openBlock(),E.createElementBlock("span",{key:2,ref:"children",class:E.normalizeClass([Re.prefixCls+"-string"]),style:E.normalizeStyle(ve.childrenStyle)},[E.renderSlot(K.$slots,"default")],6))],6)}var rl=Y(Pg,[["render",kg]]),rd={emits:["on-popper-show","on-popper-hide","created","update:modelValue"],props:{eventsEnabled:{type:Boolean,default:!1},placement:{type:String,default:"bottom"},boundariesPadding:{type:Number,default:5},reference:Object,popper:Object,offset:{default:0},modelValue:{type:Boolean,default:!1},transition:String,options:{type:Object,default(){return{modifiers:{computeStyle:{gpuAcceleration:!1},preventOverflow:{boundariesElement:"window"}}}}}},data(){return{visible:this.modelValue}},watch:{modelValue:{immediate:!0,handler(K){this.visible=K,this.$emit("update:modelValue",K)}},visible(K){K?(this.handleIndexIncrease&&this.handleIndexIncrease(),this.updatePopper(),this.$emit("on-popper-show")):this.$emit("on-popper-hide"),this.$emit("update:modelValue",K)}},methods:{createPopper(){if(!/^(top|bottom|left|right)(-start|-end)?$/g.test(this.placement))return;const K=this.options,se=this.popper||this.$refs.popper,me=this.reference||this.$refs.reference;!se||!me||(this.popperJS&&this.popperJS.hasOwnProperty("destroy")&&this.popperJS.destroy(),K.eventsEnabled=this.eventsEnabled,K.placement=this.placement,K.modifiers.offset||(K.modifiers.offset={}),K.modifiers.offset.offset=this.offset,K.onCreate=()=>{E.nextTick(this.updatePopper),this.$emit("created",this)},this.popperJS=new Dr(me,se,K))},updatePopper(){this.popperJS?this.popperJS.update():this.createPopper()},doDestroy(){this.visible||(this.popperJS.destroy(),this.popperJS=null)}},updated(){E.nextTick(()=>this.updatePopper())},beforeUnmount(){this.popperJS&&this.popperJS.destroy()}};const ba="ivu-tooltip",Ig={name:"Tooltip",mixins:[rd],props:{placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},content:{type:[String,Number],default:""},delay:{type:Number,default:100},disabled:{type:Boolean,default:!1},controlled:{type:Boolean,default:!1},always:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},theme:{validator(K){return Ie(K,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number]},transferClassName:{type:String}},data(){return{prefixCls:ba,tIndex:this.handleGetIndex()}},computed:{innerStyles(){const K={};return this.maxWidth&&(K["max-width"]=`${this.maxWidth}px`),K},innerClasses(){return[`${ba}-inner`,{[`${ba}-inner-with-width`]:!!this.maxWidth}]},dropStyles(){let K={};return this.transfer&&(K["z-index"]=1060+this.tIndex),K},dropdownCls(){return[`${ba}-popper`,`${ba}-${this.theme}`,{[ba+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}]}},watch:{content(){this.updatePopper()}},methods:{handleShowPopper(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.visible=!0},this.delay),this.tIndex=this.handleGetIndex()},handleClosePopper(){this.timeout&&(clearTimeout(this.timeout),this.controlled||(this.timeout=setTimeout(()=>{this.visible=!1},100)))},handleGetIndex(){return Ai(),ti}},mounted(){this.always&&this.updatePopper()}};function Bg(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls]),onMouseenter:se[2]||(se[2]=(...Fe)=>ve.handleShowPopper&&ve.handleShowPopper(...Fe)),onMouseleave:se[3]||(se[3]=(...Fe)=>ve.handleClosePopper&&ve.handleClosePopper(...Fe))},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-rel"]),ref:"reference"},[E.renderSlot(K.$slots,"default")],2),(E.openBlock(),E.createBlock(E.Teleport,{to:"body",disabled:!me.transfer},[E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("div",{ref:"popper",class:E.normalizeClass(ve.dropdownCls),style:E.normalizeStyle(ve.dropStyles),onMouseenter:se[0]||(se[0]=(...Fe)=>ve.handleShowPopper&&ve.handleShowPopper(...Fe)),onMouseleave:se[1]||(se[1]=(...Fe)=>ve.handleClosePopper&&ve.handleClosePopper(...Fe))},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-arrow"])},null,2),E.createElementVNode("div",{class:E.normalizeClass(ve.innerClasses),style:E.normalizeStyle(ve.innerStyles)},[E.renderSlot(K.$slots,"content",{},()=>[E.createTextVNode(E.toDisplayString(me.content),1)])],6)],2)],38),[[E.vShow,!me.disabled&&(K.visible||me.always)]])]),_:3})],8,["disabled"]))],34)}var To=Y(Ig,[["render",Bg]]);const Vg={name:"AvatarList",components:{Avatar:rl,Tooltip:To},props:{list:{type:Array,default(){return[]}},shape:{validator(K){return Ie(K,["circle","square"])},default:"circle"},size:{validator(K){return Ie(K,["small","large","default"])},default:"default"},excessStyle:{type:Object,default(){return{}}},max:{type:Number},tooltip:{type:Boolean,default:!0},placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}}},computed:{currentList(){const K=this.list.length,se=this.max;return K<=se?[...this.list]:[...this.list].slice(0,se)}}},Dg={key:0,class:"ivu-avatar-list-item ivu-avatar-list-item-excess"},Ng={key:1,class:"ivu-avatar-list-item ivu-avatar-list-item-excess"};function $g(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Avatar"),Xe=E.resolveComponent("Tooltip");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-avatar-list","ivu-avatar-list-"+me.size])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.currentList,(tt,Ze)=>(E.openBlock(),E.createElementBlock("div",{class:"ivu-avatar-list-item",key:Ze},[me.tooltip&&tt.tip?(E.openBlock(),E.createBlock(Xe,{key:0,content:tt.tip,placement:me.placement,transfer:me.transfer},{default:E.withCtx(()=>[E.createVNode(Fe,{src:tt.src,size:me.size,shape:me.shape},null,8,["src","size","shape"])]),_:2},1032,["content","placement","transfer"])):(E.openBlock(),E.createBlock(Fe,{key:1,src:tt.src,size:me.size,shape:me.shape},null,8,["src","size","shape"]))]))),128)),K.$slots.extra?(E.openBlock(),E.createElementBlock("div",Dg,[E.createVNode(Fe,{size:me.size,shape:me.shape,style:E.normalizeStyle(me.excessStyle)},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"extra")]),_:3},8,["size","shape","style"])])):me.list.length>me.max?(E.openBlock(),E.createElementBlock("div",Ng,[E.createVNode(Fe,{size:me.size,shape:me.shape,style:E.normalizeStyle(me.excessStyle)},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"excess",{},()=>[E.createTextVNode("+"+E.toDisplayString(me.list.length-me.max),1)])]),_:3},8,["size","shape","style"])])):E.createCommentVNode("",!0)],2)}var nd=Y(Vg,[["render",$g]]);const Tu="ivu-back-top",Lg={name:"BackTop",emits:["on-click"],props:{height:{type:Number,default:400},bottom:{type:Number,default:30},right:{type:Number,default:30},duration:{type:Number,default:1e3}},data(){return{backTop:!1}},mounted(){X(window,"scroll",this.handleScroll),X(window,"resize",this.handleScroll)},beforeUnmount(){q(window,"scroll",this.handleScroll),q(window,"resize",this.handleScroll)},computed:{classes(){return[`${Tu}`,{[`${Tu}-show`]:this.backTop}]},styles(){return{bottom:`${this.bottom}px`,right:`${this.right}px`}},innerClasses(){return`${Tu}-inner`}},methods:{handleScroll(){!W||(this.backTop=window.pageYOffset>=this.height)},back(){if(!W)return;const K=document.documentElement.scrollTop||document.body.scrollTop;Ke(window,K,0,this.duration),this.$emit("on-click")}}},Fg=[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-up"},null,-1)];function Ug(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.styles),onClick:se[0]||(se[0]=(...Fe)=>ve.back&&ve.back(...Fe))},[E.renderSlot(K.$slots,"default",{},()=>[E.createElementVNode("div",{class:E.normalizeClass(ve.innerClasses)},Fg,2)])],6)}var sd=Y(Lg,[["render",Ug]]);const od=["blue","green","red","yellow","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],_o="ivu-badge",zg={name:"Badge",props:{count:Number,dot:{type:Boolean,default:!1},overflowCount:{type:[Number,String],default:99},className:String,showZero:{type:Boolean,default:!1},text:{type:String,default:""},status:{validator(K){return Ie(K,["success","processing","default","error","warning"])}},type:{validator(K){return Ie(K,["success","primary","normal","error","warning","info"])}},offset:{type:Array},color:{type:String}},computed:{classes(){return`${_o}`},dotClasses(){return`${_o}-dot`},countClasses(){return[`${_o}-count`,{[`${this.className}`]:!!this.className,[`${_o}-count-alone`]:this.alone,[`${_o}-count-${this.type}`]:!!this.type}]},customCountClasses(){return[`${_o}-count`,`${_o}-count-custom`,{[`${this.className}`]:!!this.className}]},statusClasses(){return[`${_o}-status-dot`,{[`${_o}-status-${this.status}`]:!!this.status,[`${_o}-status-${this.color}`]:!!this.color&&Ie(this.color,od)}]},statusStyles(){return Ie(this.color,od)?{}:{backgroundColor:this.color}},styles(){const K={};return this.offset&&this.offset.length===2&&(K["margin-top"]=`${this.offset[0]}px`,K["margin-right"]=`${this.offset[1]}px`),K},finalCount(){return this.text!==""?this.text:parseInt(this.count)>=parseInt(this.overflowCount)?`${this.overflowCount}+`:this.count},badge(){let K=!1;return this.count&&(K=parseInt(this.count)!==0),this.dot&&(K=!0,this.count!==null&&parseInt(this.count)===0&&(K=!1)),this.text!==""&&(K=!0),K||this.showZero},hasCount(){return!!(this.count||this.text!==""||this.showZero&&parseInt(this.count)===0)},alone(){return this.$slots.default===void 0}}},Wg={class:"ivu-badge-status-text"};function Gg(K,se,me,Be,Re,ve){return me.dot?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(ve.classes),ref:"badge"},[E.renderSlot(K.$slots,"default"),E.withDirectives(E.createElementVNode("sup",{class:E.normalizeClass(ve.dotClasses),style:E.normalizeStyle(ve.styles)},null,6),[[E.vShow,ve.badge]])],2)):me.status||me.color?(E.openBlock(),E.createElementBlock("span",{key:1,class:E.normalizeClass([ve.classes,"ivu-badge-status"]),ref:"badge"},[E.createElementVNode("span",{class:E.normalizeClass(ve.statusClasses),style:E.normalizeStyle(ve.statusStyles)},null,6),E.createElementVNode("span",Wg,[E.renderSlot(K.$slots,"text",{},()=>[E.createTextVNode(E.toDisplayString(me.text),1)])])],2)):(E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass(ve.classes),ref:"badge"},[E.renderSlot(K.$slots,"default"),K.$slots.count?(E.openBlock(),E.createElementBlock("sup",{key:0,style:E.normalizeStyle(ve.styles),class:E.normalizeClass(ve.customCountClasses)},[E.renderSlot(K.$slots,"count")],6)):ve.hasCount?E.withDirectives((E.openBlock(),E.createElementBlock("sup",{key:1,style:E.normalizeStyle(ve.styles),class:E.normalizeClass(ve.countClasses)},[E.renderSlot(K.$slots,"text",{},()=>[E.createTextVNode(E.toDisplayString(ve.finalCount),1)])],6)),[[E.vShow,ve.badge]]):E.createCommentVNode("",!0)],2))}var Ql=Y(zg,[["render",Gg]]);const jg={name:"Breadcrumb",provide(){return{BreadcrumbInstance:this}},props:{separator:{type:String,default:"/"}}},Hg={class:"ivu-breadcrumb"};function Xg(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",Hg,[E.renderSlot(K.$slots,"default")])}var Eu=Y(jg,[["render",Xg]]);const ad="ivu-breadcrumb-item",qg={name:"BreadcrumbItem",mixins:[Br],inject:["BreadcrumbInstance"],props:{},data(){return{showSeparator:!1}},computed:{linkClasses(){return`${ad}-link`},separatorClasses(){return`${ad}-separator`},separator(){return this.BreadcrumbInstance.separator}},mounted(){this.showSeparator=this.$slots.separator!==void 0}},Qg=["href","target"],Yg=["innerHTML"];function Kg(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("span",null,[K.to?(E.openBlock(),E.createElementBlock("a",{key:0,href:K.linkUrl,target:K.target,class:E.normalizeClass(ve.linkClasses),onClick:[se[0]||(se[0]=E.withModifiers(Fe=>K.handleCheckClick(Fe,!1),["exact"])),se[1]||(se[1]=E.withModifiers(Fe=>K.handleCheckClick(Fe,!0),["ctrl"])),se[2]||(se[2]=E.withModifiers(Fe=>K.handleCheckClick(Fe,!0),["meta"]))]},[E.renderSlot(K.$slots,"default")],10,Qg)):(E.openBlock(),E.createElementBlock("span",{key:1,class:E.normalizeClass(ve.linkClasses)},[E.renderSlot(K.$slots,"default")],2)),Re.showSeparator?(E.openBlock(),E.createElementBlock("span",{key:3,class:E.normalizeClass(ve.separatorClasses)},[E.renderSlot(K.$slots,"separator")],2)):(E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass(ve.separatorClasses),innerHTML:ve.separator},null,10,Yg))])}var Au=Y(qg,[["render",Kg]]);const $o="ivu-btn",As={name:"Button",mixins:[Br,In],components:{Icon:Ae},emits:["click"],props:{type:{validator(K){return Ie(K,["default","primary","dashed","text","info","success","warning","error"])},default:"default"},shape:{validator(K){return Ie(K,["circle","circle-outline"])}},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},loading:Boolean,disabled:Boolean,htmlType:{default:"button",validator(K){return Ie(K,["button","submit","reset"])}},icon:{type:String,default:""},customIcon:{type:String,default:""},long:{type:Boolean,default:!1},ghost:{type:Boolean,default:!1}},computed:{showSlot(){return!!this.$slots.default},classes(){return[`${$o}`,`${$o}-${this.type}`,{[`${$o}-long`]:this.long,[`${$o}-${this.shape}`]:!!this.shape,[`${$o}-${this.size}`]:this.size!=="default",[`${$o}-loading`]:this.loading!=null&&this.loading,[`${$o}-icon-only`]:!this.showSlot&&(!!this.icon||!!this.customIcon||this.loading),[`${$o}-ghost`]:this.ghost}]},isHrefPattern(){const{to:K}=this;return!!K},tagName(){const{isHrefPattern:K}=this;return K?"a":"button"},tagProps(){const{isHrefPattern:K}=this;if(K){const{linkUrl:se,target:me}=this;return{href:se,target:me}}else{const{htmlType:se}=this;return{type:se}}}},methods:{handleClickLink(K){this.$emit("click",K);const se=K.ctrlKey||K.metaKey;this.handleCheckClick(K,se)}},render(){let K;this.tagName==="button"?K="button":this.tagName==="a"&&(K="a");let se=[];return this.loading&&se.push(E.h(Ae,{class:"ivu-load-loop",type:"ios-loading"})),(this.icon||this.customIcon)&&!this.loading&&se.push(E.h(Ae,{type:this.icon,custom:this.customIcon})),this.$slots.default&&se.push(E.h("span",{ref:"slot"},this.$slots.default())),E.h(K,{class:this.classes,disabled:this.itemDisabled,onClick:this.handleClickLink,...this.tagProps},se)}},Yl="ivu-btn-group",Zg={name:"ButtonGroup",props:{size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},shape:{validator(K){return Ie(K,["circle","circle-outline"])}},vertical:{type:Boolean,default:!1}},computed:{classes(){return[`${Yl}`,{[`${Yl}-${this.size}`]:!!this.size,[`${Yl}-${this.shape}`]:!!this.shape,[`${Yl}-vertical`]:this.vertical}]}}};function Jg(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.renderSlot(K.$slots,"default")],2)}var Mu=Y(Zg,[["render",Jg]]);const nl="ivu-radio-group";let ey=0;const ty=Date.now(),ry={name:"RadioGroup",mixins:[In],emits:["update:modelValue","on-change"],provide(){return{RadioGroupInstance:this}},props:{modelValue:{type:[String,Number],default:""},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},type:{validator(K){return Ie(K,["button"])}},vertical:{type:Boolean,default:!1},name:{type:String,default:()=>`ivuRadioGroup_${ty}_${ey++}`},buttonStyle:{validator(K){return Ie(K,["default","solid"])},default:"default"}},data(){return{currentValue:this.modelValue,children:[]}},computed:{classes(){return[`${nl}`,{[`${nl}-${this.size}`]:!!this.size,[`ivu-radio-${this.size}`]:!!this.size,[`${nl}-${this.type}`]:!!this.type,[`${nl}-button-${this.buttonStyle}`]:this.type==="button"&&this.buttonStyle!=="default",[`${nl}-vertical`]:this.vertical}]}},methods:{change(K){this.currentValue=K.value,this.$emit("update:modelValue",K.value),this.$emit("on-change",K.value),this.handleFormItemChange("change",K.value)}},watch:{modelValue(){this.currentValue!==this.modelValue&&(this.currentValue=this.modelValue)}}},iy=["name"];function ny(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),name:me.name},[E.renderSlot(K.$slots,"default")],10,iy)}var Kl=Y(ry,[["render",ny]]);const Ls="ivu-radio",sy={name:"Radio",mixins:[In],emits:["update:modelValue","on-change"],inject:{RadioGroupInstance:{default:null}},props:{modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},label:{type:[String,Number]},disabled:{type:Boolean,default:!1},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},name:{type:String},border:{type:Boolean,default:!1}},data(){return{groupName:this.name,parent:this.RadioGroupInstance,focusWrapper:!1,focusInner:!1}},computed:{wrapClasses(){return[`${Ls}-wrapper`,{[`${Ls}-group-item`]:this.group,[`${Ls}-wrapper-checked`]:this.currentValue,[`${Ls}-wrapper-disabled`]:this.itemDisabled,[`${Ls}-${this.size}`]:!!this.size,[`${Ls}-focus`]:this.focusWrapper,[`${Ls}-border`]:this.border}]},radioClasses(){return[`${Ls}`,{[`${Ls}-checked`]:this.currentValue,[`${Ls}-disabled`]:this.itemDisabled}]},innerClasses(){return[`${Ls}-inner`,{[`${Ls}-focus`]:this.focusInner}]},inputClasses(){return`${Ls}-input`},currentValue(){return this.RadioGroupInstance?this.RadioGroupInstance.currentValue===this.label:this.modelValue===this.trueValue},group(){return!!this.RadioGroupInstance}},mounted(){this.parent&&(this.name&&this.name!==this.parent.name?console.warn&&console.warn("[View UI] Name does not match Radio Group name."):this.groupName=this.parent.name)},methods:{change(K){if(this.itemDisabled)return!1;const se=K.target.checked?this.trueValue:this.falseValue;this.$emit("update:modelValue",se),this.group?this.label!==void 0&&this.parent.change({value:this.label,checked:this.modelValue}):(this.$emit("on-change",se),this.handleFormItemChange("change",se))},onBlur(){this.focusWrapper=!1,this.focusInner=!1},onFocus(){this.group&&this.parent.type==="button"?this.focusWrapper=!0:this.focusInner=!0}},watch:{modelValue(K){if(!(K===this.trueValue||K===this.falseValue))throw"Value should be trueValue or falseValue."}}},oy=["disabled","checked","name"];function ay(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("label",{class:E.normalizeClass(ve.wrapClasses)},[E.createElementVNode("span",{class:E.normalizeClass(ve.radioClasses)},[E.createElementVNode("span",{class:E.normalizeClass(ve.innerClasses)},null,2),E.createElementVNode("input",{type:"radio",class:E.normalizeClass(ve.inputClasses),disabled:K.itemDisabled,checked:ve.currentValue,name:Re.groupName,onChange:se[0]||(se[0]=(...Fe)=>ve.change&&ve.change(...Fe)),onFocus:se[1]||(se[1]=(...Fe)=>ve.onFocus&&ve.onFocus(...Fe)),onBlur:se[2]||(se[2]=(...Fe)=>ve.onBlur&&ve.onBlur(...Fe))},null,42,oy)],2),E.renderSlot(K.$slots,"default",{},()=>[E.createTextVNode(E.toDisplayString(me.label),1)])],2)}var Zl=Y(sy,[["render",ay]]),ld={exports:{}};(function(K,se){(function(me,Be){K.exports=Be()})(ct,function(){var me=1e3,Be=6e4,Re=36e5,ve="millisecond",Fe="second",Xe="minute",tt="hour",Ze="day",it="week",nr="month",jr="quarter",zr="year",Fr="date",_t="Invalid Date",ni=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,on=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Gi={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Ji){var ji=["th","st","nd","rd"],Fi=Ji%100;return"["+Ji+(ji[(Fi-20)%10]||ji[Fi]||ji[0])+"]"}},Qi=function(Ji,ji,Fi){var rn=String(Ji);return!rn||rn.length>=ji?Ji:""+Array(ji+1-rn.length).join(Fi)+Ji},wi={s:Qi,z:function(Ji){var ji=-Ji.utcOffset(),Fi=Math.abs(ji),rn=Math.floor(Fi/60),Xi=Fi%60;return(ji<=0?"+":"-")+Qi(rn,2,"0")+":"+Qi(Xi,2,"0")},m:function Ji(ji,Fi){if(ji.date()<Fi.date())return-Ji(Fi,ji);var rn=12*(Fi.year()-ji.year())+(Fi.month()-ji.month()),Xi=ji.clone().add(rn,nr),Cn=Fi-Xi<0,En=ji.clone().add(rn+(Cn?-1:1),nr);return+(-(rn+(Fi-Xi)/(Cn?Xi-En:En-Xi))||0)},a:function(Ji){return Ji<0?Math.ceil(Ji)||0:Math.floor(Ji)},p:function(Ji){return{M:nr,y:zr,w:it,d:Ze,D:Fr,h:tt,m:Xe,s:Fe,ms:ve,Q:jr}[Ji]||String(Ji||"").toLowerCase().replace(/s$/,"")},u:function(Ji){return Ji===void 0}},li="en",Vi={};Vi[li]=Gi;var Pi="$isDayjsObject",pn=function(Ji){return Ji instanceof tn||!(!Ji||!Ji[Pi])},fn=function Ji(ji,Fi,rn){var Xi;if(!ji)return li;if(typeof ji=="string"){var Cn=ji.toLowerCase();Vi[Cn]&&(Xi=Cn),Fi&&(Vi[Cn]=Fi,Xi=Cn);var En=ji.split("-");if(!Xi&&En.length>1)return Ji(En[0])}else{var Hn=ji.name;Vi[Hn]=ji,Xi=Hn}return!rn&&Xi&&(li=Xi),Xi||!rn&&li},Zi=function(Ji,ji){if(pn(Ji))return Ji.clone();var Fi=typeof ji=="object"?ji:{};return Fi.date=Ji,Fi.args=arguments,new tn(Fi)},Yi=wi;Yi.l=fn,Yi.i=pn,Yi.w=function(Ji,ji){return Zi(Ji,{locale:ji.$L,utc:ji.$u,x:ji.$x,$offset:ji.$offset})};var tn=function(){function Ji(Fi){this.$L=fn(Fi.locale,null,!0),this.parse(Fi),this.$x=this.$x||Fi.x||{},this[Pi]=!0}var ji=Ji.prototype;return ji.parse=function(Fi){this.$d=function(rn){var Xi=rn.date,Cn=rn.utc;if(Xi===null)return new Date(NaN);if(Yi.u(Xi))return new Date;if(Xi instanceof Date)return new Date(Xi);if(typeof Xi=="string"&&!/Z$/i.test(Xi)){var En=Xi.match(ni);if(En){var Hn=En[2]-1||0,Yn=(En[7]||"0").substring(0,3);return Cn?new Date(Date.UTC(En[1],Hn,En[3]||1,En[4]||0,En[5]||0,En[6]||0,Yn)):new Date(En[1],Hn,En[3]||1,En[4]||0,En[5]||0,En[6]||0,Yn)}}return new Date(Xi)}(Fi),this.init()},ji.init=function(){var Fi=this.$d;this.$y=Fi.getFullYear(),this.$M=Fi.getMonth(),this.$D=Fi.getDate(),this.$W=Fi.getDay(),this.$H=Fi.getHours(),this.$m=Fi.getMinutes(),this.$s=Fi.getSeconds(),this.$ms=Fi.getMilliseconds()},ji.$utils=function(){return Yi},ji.isValid=function(){return this.$d.toString()!==_t},ji.isSame=function(Fi,rn){var Xi=Zi(Fi);return this.startOf(rn)<=Xi&&Xi<=this.endOf(rn)},ji.isAfter=function(Fi,rn){return Zi(Fi)<this.startOf(rn)},ji.isBefore=function(Fi,rn){return this.endOf(rn)<Zi(Fi)},ji.$g=function(Fi,rn,Xi){return Yi.u(Fi)?this[rn]:this.set(Xi,Fi)},ji.unix=function(){return Math.floor(this.valueOf()/1e3)},ji.valueOf=function(){return this.$d.getTime()},ji.startOf=function(Fi,rn){var Xi=this,Cn=!!Yi.u(rn)||rn,En=Yi.p(Fi),Hn=function(Ki,On){var Fn=Yi.w(Xi.$u?Date.UTC(Xi.$y,On,Ki):new Date(Xi.$y,On,Ki),Xi);return Cn?Fn:Fn.endOf(Ze)},Yn=function(Ki,On){return Yi.w(Xi.toDate()[Ki].apply(Xi.toDate("s"),(Cn?[0,0,0,0]:[23,59,59,999]).slice(On)),Xi)},rs=this.$W,os=this.$M,vs=this.$D,Ns="set"+(this.$u?"UTC":"");switch(En){case zr:return Cn?Hn(1,0):Hn(31,11);case nr:return Cn?Hn(1,os):Hn(0,os+1);case it:var lo=this.$locale().weekStart||0,co=(rs<lo?rs+7:rs)-lo;return Hn(Cn?vs-co:vs+(6-co),os);case Ze:case Fr:return Yn(Ns+"Hours",0);case tt:return Yn(Ns+"Minutes",1);case Xe:return Yn(Ns+"Seconds",2);case Fe:return Yn(Ns+"Milliseconds",3);default:return this.clone()}},ji.endOf=function(Fi){return this.startOf(Fi,!1)},ji.$set=function(Fi,rn){var Xi,Cn=Yi.p(Fi),En="set"+(this.$u?"UTC":""),Hn=(Xi={},Xi[Ze]=En+"Date",Xi[Fr]=En+"Date",Xi[nr]=En+"Month",Xi[zr]=En+"FullYear",Xi[tt]=En+"Hours",Xi[Xe]=En+"Minutes",Xi[Fe]=En+"Seconds",Xi[ve]=En+"Milliseconds",Xi)[Cn],Yn=Cn===Ze?this.$D+(rn-this.$W):rn;if(Cn===nr||Cn===zr){var rs=this.clone().set(Fr,1);rs.$d[Hn](Yn),rs.init(),this.$d=rs.set(Fr,Math.min(this.$D,rs.daysInMonth())).$d}else Hn&&this.$d[Hn](Yn);return this.init(),this},ji.set=function(Fi,rn){return this.clone().$set(Fi,rn)},ji.get=function(Fi){return this[Yi.p(Fi)]()},ji.add=function(Fi,rn){var Xi,Cn=this;Fi=Number(Fi);var En=Yi.p(rn),Hn=function(os){var vs=Zi(Cn);return Yi.w(vs.date(vs.date()+Math.round(os*Fi)),Cn)};if(En===nr)return this.set(nr,this.$M+Fi);if(En===zr)return this.set(zr,this.$y+Fi);if(En===Ze)return Hn(1);if(En===it)return Hn(7);var Yn=(Xi={},Xi[Xe]=Be,Xi[tt]=Re,Xi[Fe]=me,Xi)[En]||1,rs=this.$d.getTime()+Fi*Yn;return Yi.w(rs,this)},ji.subtract=function(Fi,rn){return this.add(-1*Fi,rn)},ji.format=function(Fi){var rn=this,Xi=this.$locale();if(!this.isValid())return Xi.invalidDate||_t;var Cn=Fi||"YYYY-MM-DDTHH:mm:ssZ",En=Yi.z(this),Hn=this.$H,Yn=this.$m,rs=this.$M,os=Xi.weekdays,vs=Xi.months,Ns=Xi.meridiem,lo=function(On,Fn,_s,Is){return On&&(On[Fn]||On(rn,Cn))||_s[Fn].slice(0,Is)},co=function(On){return Yi.s(Hn%12||12,On,"0")},Ki=Ns||function(On,Fn,_s){var Is=On<12?"AM":"PM";return _s?Is.toLowerCase():Is};return Cn.replace(on,function(On,Fn){return Fn||function(_s){switch(_s){case"YY":return String(rn.$y).slice(-2);case"YYYY":return Yi.s(rn.$y,4,"0");case"M":return rs+1;case"MM":return Yi.s(rs+1,2,"0");case"MMM":return lo(Xi.monthsShort,rs,vs,3);case"MMMM":return lo(vs,rs);case"D":return rn.$D;case"DD":return Yi.s(rn.$D,2,"0");case"d":return String(rn.$W);case"dd":return lo(Xi.weekdaysMin,rn.$W,os,2);case"ddd":return lo(Xi.weekdaysShort,rn.$W,os,3);case"dddd":return os[rn.$W];case"H":return String(Hn);case"HH":return Yi.s(Hn,2,"0");case"h":return co(1);case"hh":return co(2);case"a":return Ki(Hn,Yn,!0);case"A":return Ki(Hn,Yn,!1);case"m":return String(Yn);case"mm":return Yi.s(Yn,2,"0");case"s":return String(rn.$s);case"ss":return Yi.s(rn.$s,2,"0");case"SSS":return Yi.s(rn.$ms,3,"0");case"Z":return En}return null}(On)||En.replace(":","")})},ji.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},ji.diff=function(Fi,rn,Xi){var Cn,En=this,Hn=Yi.p(rn),Yn=Zi(Fi),rs=(Yn.utcOffset()-this.utcOffset())*Be,os=this-Yn,vs=function(){return Yi.m(En,Yn)};switch(Hn){case zr:Cn=vs()/12;break;case nr:Cn=vs();break;case jr:Cn=vs()/3;break;case it:Cn=(os-rs)/6048e5;break;case Ze:Cn=(os-rs)/864e5;break;case tt:Cn=os/Re;break;case Xe:Cn=os/Be;break;case Fe:Cn=os/me;break;default:Cn=os}return Xi?Cn:Yi.a(Cn)},ji.daysInMonth=function(){return this.endOf(nr).$D},ji.$locale=function(){return Vi[this.$L]},ji.locale=function(Fi,rn){if(!Fi)return this.$L;var Xi=this.clone(),Cn=fn(Fi,rn,!0);return Cn&&(Xi.$L=Cn),Xi},ji.clone=function(){return Yi.w(this.$d,this)},ji.toDate=function(){return new Date(this.valueOf())},ji.toJSON=function(){return this.isValid()?this.toISOString():null},ji.toISOString=function(){return this.$d.toISOString()},ji.toString=function(){return this.$d.toUTCString()},Ji}(),vn=tn.prototype;return Zi.prototype=vn,[["$ms",ve],["$s",Fe],["$m",Xe],["$H",tt],["$W",Ze],["$M",nr],["$y",zr],["$D",Fr]].forEach(function(Ji){vn[Ji[1]]=function(ji){return this.$g(ji,Ji[0],Ji[1])}}),Zi.extend=function(Ji,ji){return Ji.$i||(Ji(ji,tn,Zi),Ji.$i=!0),Zi},Zi.locale=fn,Zi.isDayjs=pn,Zi.unix=function(Ji){return Zi(1e3*Ji)},Zi.en=Vi[li],Zi.Ls=Vi,Zi.p={},Zi})})(ld);var Fs=ld.exports,cd=1/0,ud=9007199254740991,ly=17976931348623157e292,hd=NaN,cy="[object Function]",hy="[object GeneratorFunction]",dy="[object Symbol]",fy=/^\s+|\s+$/g,my=/^[-+]0x[0-9a-f]+$/i,gy=/^0b[01]+$/i,yy=/^0o[0-7]+$/i,by=/^(?:0|[1-9]\d*)$/,xy=parseInt,Sy=Object.prototype,dd=Sy.toString,wy=Math.ceil,Oy=Math.max;function Cy(K,se,me){var Be=-1,Re=K.length;se<0&&(se=-se>Re?0:Re+se),me=me>Re?Re:me,me<0&&(me+=Re),Re=se>me?0:me-se>>>0,se>>>=0;for(var ve=Array(Re);++Be<Re;)ve[Be]=K[Be+se];return ve}function Ty(K,se){return se=se??ud,!!se&&(typeof K=="number"||by.test(K))&&K>-1&&K%1==0&&K<se}function Ey(K,se,me){if(!Jl(me))return!1;var Be=typeof se;return(Be=="number"?Py(me)&&Ty(se,me.length):Be=="string"&&se in me)?My(me[se],K):!1}function Ay(K,se,me){(me?Ey(K,se,me):se===void 0)?se=1:se=Oy(Dy(se),0);var Be=K?K.length:0;if(!Be||se<1)return[];for(var Re=0,ve=0,Fe=Array(wy(Be/se));Re<Be;)Fe[ve++]=Cy(K,Re,Re+=se);return Fe}function My(K,se){return K===se||K!==K&&se!==se}function Py(K){return K!=null&&ky(K.length)&&!Ry(K)}function Ry(K){var se=Jl(K)?dd.call(K):"";return se==cy||se==hy}function ky(K){return typeof K=="number"&&K>-1&&K%1==0&&K<=ud}function Jl(K){var se=typeof K;return!!K&&(se=="object"||se=="function")}function Iy(K){return!!K&&typeof K=="object"}function By(K){return typeof K=="symbol"||Iy(K)&&dd.call(K)==dy}function Vy(K){if(!K)return K===0?K:0;if(K=Ny(K),K===cd||K===-cd){var se=K<0?-1:1;return se*ly}return K===K?K:0}function Dy(K){var se=Vy(K),me=se%1;return se===se?me?se-me:se:0}function Ny(K){if(typeof K=="number")return K;if(By(K))return hd;if(Jl(K)){var se=typeof K.valueOf=="function"?K.valueOf():K;K=Jl(se)?se+"":se}if(typeof K!="string")return K===0?K:+K;K=K.replace(fy,"");var me=gy.test(K);return me||yy.test(K)?xy(K.slice(2),me?2:8):my.test(K)?hd:+K}var pd=Ay,fd={emits:["on-cell-click","on-cell-contextmenu"],methods:{handleCellClick(K){this.CalendarInstance.$emit("on-cell-click",K)},handleCellContextmenu(K){this.CalendarInstance.$emit("on-cell-contextmenu",K)}}};const $y={name:"CalendarMonth",mixins:[fd],inject:["CalendarInstance"],props:{date:Object},data(){return{firstDayOfWeek:this.CalendarInstance.firstDayOfWeek,weekDays:this.CalendarInstance.locale.weekDays}},computed:{finalWeekDays(){return this.weekDays.slice(this.firstDayOfWeek).concat(this.weekDays.slice(0,this.firstDayOfWeek))},days(){let K=[];const se=Fs(this.date.format("YYYY-MM-01")),me=se.day(),Be=this.firstDayOfWeek,Re=Be<=me?me-Be:7-(Be-me);for(let tt=0;tt<Re;tt++){const Ze=se.subtract(Re-tt,"day"),it={text:Ze.format("YYYY-MM-DD"),date:Ze.format("D"),type:"prev"};K.push(it)}const ve=se.daysInMonth();for(let tt=0;tt<ve;tt++){const Ze=se.add(tt,"day"),it={text:Ze.format("YYYY-MM-DD"),date:Ze.format("D"),type:"current"};K.push(it)}const Fe=42-K.length,Xe=se.add(1,"month");for(let tt=0;tt<Fe;tt++){const Ze=Xe.add(tt,"day"),it={text:Ze.format("YYYY-MM-DD"),date:Ze.format("D"),type:"next"};K.push(it)}return K},chunkDays(){return pd(this.days,7)},dayStyles(){let K={};return this.CalendarInstance.cellHeight!==100&&(K.height=`${this.CalendarInstance.cellHeight}px`),K},currentDate(){return this.date.format("YYYY-MM-DD")}},methods:{handleClickDate(K){this.CalendarInstance.handleChangeDate(Fs(K))}}},Ly={class:"ivu-calendar-table",cellspacing:"0",cellpadding:"0"},Fy=["onClick","onContextmenu"],Uy=["onClick"],zy={class:"ivu-calendar-table-day-title"},Wy={class:"ivu-calendar-table-day-slot"};function Gy(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("table",Ly,[E.createElementVNode("thead",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.finalWeekDays,Fe=>(E.openBlock(),E.createElementBlock("th",{key:Fe},E.toDisplayString(Fe),1))),128))]),E.createElementVNode("tbody",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.chunkDays,(Fe,Xe)=>(E.openBlock(),E.createElementBlock("tr",{key:Xe},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Fe,tt=>(E.openBlock(),E.createElementBlock("td",{key:tt.text,onClick:Ze=>K.handleCellClick(tt),onContextmenu:E.withModifiers(Ze=>K.handleCellContextmenu(tt),["prevent"])},[E.createElementVNode("div",{class:E.normalizeClass(["ivu-calendar-table-day",{"ivu-calendar-table-day-other":tt.type!=="current","ivu-calendar-table-day-current":tt.text===ve.currentDate}]),style:E.normalizeStyle(ve.dayStyles),onClick:Ze=>ve.handleClickDate(tt.text)},[E.createElementVNode("div",zy,E.toDisplayString(tt.date),1),E.createElementVNode("div",Wy,[E.renderSlot(K.$slots,"month",{date:new Date(tt.date),data:{type:tt.type+"-month",day:tt.text,selected:tt.text===ve.currentDate}})])],14,Uy)],40,Fy))),128))]))),128))])])}var jy=Y($y,[["render",Gy]]);const Hy={name:"CalendarYear",mixins:[fd],inject:["CalendarInstance"],props:{date:Object},data(){return{}},computed:{months(){let K=[];const se=Fs(this.date.format("YYYY-01-01"));for(let me=0;me<12;me++){const Be=se.add(me,"month");K.push({text:Be.format("YYYY-MM"),month:this.CalendarInstance.locale.months[me],type:"current"})}return K},chunkMonths(){return pd(this.months,3)},dayStyles(){let K={};return this.CalendarInstance.cellHeight!==100&&(K.height=`${this.CalendarInstance.cellHeight}px`),K},currentMonth(){return this.date.format("YYYY-MM")}},methods:{handleClickDate(K){this.CalendarInstance.handleChangeDate(Fs(K))}}},Xy={class:"ivu-calendar-table ivu-calendar-table-year",cellspacing:"0",cellpadding:"0"},qy=["onClick","onContextmenu"],Qy=["onClick"],Yy={class:"ivu-calendar-table-day-title"},Ky={class:"ivu-calendar-table-day-slot"};function Zy(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("table",Xy,[E.createElementVNode("tbody",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.chunkMonths,(Fe,Xe)=>(E.openBlock(),E.createElementBlock("tr",{key:Xe},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Fe,tt=>(E.openBlock(),E.createElementBlock("td",{key:tt.text,onClick:Ze=>K.handleCellClick(tt),onContextmenu:E.withModifiers(Ze=>K.handleCellContextmenu(tt),["prevent"])},[E.createElementVNode("div",{class:E.normalizeClass(["ivu-calendar-table-day",{"ivu-calendar-table-day-current":tt.text===ve.currentMonth}]),style:E.normalizeStyle(ve.dayStyles),onClick:Ze=>ve.handleClickDate(tt.text)},[E.createElementVNode("div",Yy,E.toDisplayString(tt.month),1),E.createElementVNode("div",Ky,[E.renderSlot(K.$slots,"year",{month:new Date(tt.month),data:{type:tt.type+"-year",month:tt.text,selected:tt.text===ve.currentMonth}})])],14,Qy)],40,qy))),128))]))),128))])])}var Jy=Y(Hy,[["render",Zy]]);const e_={name:"Calendar",components:{CalendarMonth:jy,CalendarYear:Jy,ButtonGroup:Mu,Button:As,RadioGroup:Kl,Radio:Zl,Icon:Ae},emits:["on-type-change","on-prev","on-next","on-today","on-change","update:modelValue","on-cell-click","on-cell-contextmenu"],provide(){return{CalendarInstance:this}},props:{modelValue:{type:[Date,String,Number]},type:{validator(K){return Ie(K,["month","year"])},default:"month"},cellHeight:{type:Number,default:100},showHeader:{type:Boolean,default:!0},headerType:{validator(K){return Ie(K,["simple","full"])},default:"simple"},firstDayOfWeek:{validator(K){return Ie(K,[1,2,3,4,5,6,7])},default:1},hideType:{type:Boolean,default:!1},locale:{type:Object,default(){return{today:"",type:{month:"",year:""},weekDays:["","","","","","",""],months:["1","2","3","4","5","6","7","8","9","10","11","12"]}}}},data(){const K=this.modelValue?this.modelValue:new Date;return{currentValue:Fs(K),mode:this.type}},watch:{modelValue(K){const se=K||new Date;this.currentValue=Fs(se)},type(K){this.mode=K}},computed:{headerTitle(){if(this.mode==="month")return this.currentValue.format("YYYY  M ");if(this.mode==="year")return this.currentValue.format("YYYY ")}},methods:{handleChangeType(K){this.$emit("on-type-change",K)},handlePrev(){const K=this.currentValue.format("YYYY-MM-01");let se;this.mode==="month"?se=Fs(K).subtract(1,"month"):this.mode==="year"&&(se=Fs(K).subtract(1,"year")),this.handleChangeDate(se),this.$emit("on-prev")},handleNext(){const K=this.currentValue.format("YYYY-MM-01");let se;this.mode==="month"?se=Fs(K).add(1,"month"):this.mode==="year"&&(se=Fs(K).add(1,"year")),this.handleChangeDate(se),this.$emit("on-next")},handleToday(){const K=Fs(new Date),se=K.format("YYYY-MM-DD"),me=this.currentValue.format("YYYY-MM-DD");se!==me&&this.handleChangeDate(K),this.$emit("on-today")},handleChangeDate(K){this.currentValue=K;const se=new Date(K.format("YYYY-MM-DD"));this.$emit("update:modelValue",se),this.$emit("on-change",se)}}},t_={class:"ivu-calendar"},r_={key:0,class:"ivu-calendar-header"},i_={class:"ivu-calendar-header-title"},n_={class:"ivu-calendar-header-action"},s_={class:"ivu-calendar-body"};function o_(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Button"),tt=E.resolveComponent("ButtonGroup"),Ze=E.resolveComponent("Radio"),it=E.resolveComponent("RadioGroup"),nr=E.resolveComponent("CalendarMonth"),jr=E.resolveComponent("CalendarYear");return E.openBlock(),E.createElementBlock("div",t_,[me.showHeader?(E.openBlock(),E.createElementBlock("div",r_,[E.renderSlot(K.$slots,"header",{},()=>[E.createElementVNode("div",i_,[E.renderSlot(K.$slots,"headerTitle",{},()=>[E.createTextVNode(E.toDisplayString(ve.headerTitle),1)])]),E.createElementVNode("div",n_,[me.headerType==="simple"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createVNode(tt,null,{default:E.withCtx(()=>[E.createVNode(Xe,{onClick:ve.handlePrev},{default:E.withCtx(()=>[E.createVNode(Fe,{type:"ios-arrow-back"})]),_:1},8,["onClick"]),E.createVNode(Xe,{onClick:ve.handleToday},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(me.locale.today),1)]),_:1},8,["onClick"]),E.createVNode(Xe,{onClick:ve.handleNext},{default:E.withCtx(()=>[E.createVNode(Fe,{type:"ios-arrow-forward"})]),_:1},8,["onClick"])]),_:1}),me.hideType?E.createCommentVNode("",!0):(E.openBlock(),E.createBlock(it,{key:0,modelValue:Re.mode,"onUpdate:modelValue":se[0]||(se[0]=zr=>Re.mode=zr),type:"button",class:"ivu-ml",onOnChange:ve.handleChangeType},{default:E.withCtx(()=>[E.createVNode(Ze,{label:"month"},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(me.locale.type.month),1)]),_:1}),E.createVNode(Ze,{label:"year"},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(me.locale.type.year),1)]),_:1})]),_:1},8,["modelValue","onOnChange"]))],64)):me.headerType==="full"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[],64)):E.createCommentVNode("",!0)])])])):E.createCommentVNode("",!0),E.createElementVNode("div",s_,[Re.mode==="month"?(E.openBlock(),E.createBlock(nr,{key:0,date:Re.currentValue},{month:E.withCtx(({date:zr,data:Fr})=>[E.renderSlot(K.$slots,"month",{date:zr,data:Fr})]),_:3},8,["date"])):Re.mode==="year"?(E.openBlock(),E.createBlock(jr,{key:1,date:Re.currentValue},{year:E.withCtx(({month:zr,data:Fr})=>[E.renderSlot(K.$slots,"year",{month:zr,data:Fr})]),_:3},8,["date"])):E.createCommentVNode("",!0)])])}var md=Y(e_,[["render",o_]]);const Eo="ivu-col";function a_(K){return typeof K=="number"?`${K} ${K} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(K)?`0 0 ${K}`:K}const l_={name:"iCol",inject:["RowInstance"],props:{span:[Number,String],order:[Number,String],offset:[Number,String],push:[Number,String],pull:[Number,String],className:String,xs:[Number,Object],sm:[Number,Object],md:[Number,Object],lg:[Number,Object],xl:[Number,Object],xxl:[Number,Object],flex:{type:[Number,String],default:""}},computed:{gutter(){return this.RowInstance.gutter},classes(){let K=[`${Eo}`,{[`${Eo}-span-${this.span}`]:this.span,[`${Eo}-order-${this.order}`]:this.order,[`${Eo}-offset-${this.offset}`]:this.offset,[`${Eo}-push-${this.push}`]:this.push,[`${Eo}-pull-${this.pull}`]:this.pull,[`${this.className}`]:!!this.className}];return["xs","sm","md","lg","xl","xxl"].forEach(se=>{if(typeof this[se]=="number")K.push(`${Eo}-span-${se}-${this[se]}`);else if(typeof this[se]=="object"){let me=this[se];Object.keys(me).forEach(Be=>{K.push(Be!=="span"?`${Eo}-${se}-${Be}-${me[Be]}`:`${Eo}-span-${se}-${me[Be]}`)})}}),K},styles(){let K={};return this.gutter!==0&&(K={paddingLeft:this.gutter/2+"px",paddingRight:this.gutter/2+"px"}),this.flex&&(K.flex=a_(this.flex)),K}}};function c_(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.styles)},[E.renderSlot(K.$slots,"default")],6)}var vo=Y(l_,[["render",c_]]);const oa="ivu-row",u_={name:"Row",provide(){return{RowInstance:this}},props:{type:{validator(K){return Ie(K,["flex"])}},align:{validator(K){return Ie(K,["top","middle","bottom"])}},justify:{validator(K){return Ie(K,["start","end","center","space-around","space-between"])}},gutter:{type:Number,default:0},className:String,wrap:{type:Boolean,default:!0}},computed:{classes(){return[`${oa}`,{[`${oa}-${this.type}`]:!!this.type,[`${oa}-${this.type}-${this.align}`]:!!this.align&&this.type,[`${oa}-${this.type}-${this.justify}`]:!!this.justify&&this.type,[`${oa}-${this.align}`]:!!this.align,[`${oa}-${this.justify}`]:!!this.justify,[`${this.className}`]:!!this.className,[`${oa}-no-wrap`]:!this.wrap}]},styles(){let K={};return this.gutter!==0&&(K={marginLeft:this.gutter/-2+"px",marginRight:this.gutter/-2+"px"}),K}}};function h_(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.styles)},[E.renderSlot(K.$slots,"default")],6)}var Lo=Y(u_,[["render",h_]]);function aa(){return aa=Object.assign||function(K){for(var se=1;se<arguments.length;se++){var me=arguments[se];for(var Be in me)Object.prototype.hasOwnProperty.call(me,Be)&&(K[Be]=me[Be])}return K},aa.apply(this,arguments)}function d_(K,se){K.prototype=Object.create(se.prototype),K.prototype.constructor=K,sl(K,se)}function Pu(K){return Pu=Object.setPrototypeOf?Object.getPrototypeOf:function(se){return se.__proto__||Object.getPrototypeOf(se)},Pu(K)}function sl(K,se){return sl=Object.setPrototypeOf||function(me,Be){return me.__proto__=Be,me},sl(K,se)}function p_(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ec(K,se,me){return p_()?ec=Reflect.construct:ec=function(Be,Re,ve){var Fe=[null];Fe.push.apply(Fe,Re);var Xe=Function.bind.apply(Be,Fe),tt=new Xe;return ve&&sl(tt,ve.prototype),tt},ec.apply(null,arguments)}function f_(K){return Function.toString.call(K).indexOf("[native code]")!==-1}function Ru(K){var se=typeof Map=="function"?new Map:void 0;return Ru=function(me){if(me===null||!f_(me))return me;if(typeof me!="function")throw new TypeError("Super expression must either be null or a function");if(typeof se<"u"){if(se.has(me))return se.get(me);se.set(me,Be)}function Be(){return ec(me,arguments,Pu(this).constructor)}return Be.prototype=Object.create(me.prototype,{constructor:{value:Be,enumerable:!1,writable:!0,configurable:!0}}),sl(Be,me)},Ru(K)}var m_=/%[sdj%]/g,g_=function(){};function ku(K){if(!K||!K.length)return null;var se={};return K.forEach(function(me){var Be=me.field;se[Be]=se[Be]||[],se[Be].push(me)}),se}function Us(){for(var K=arguments.length,se=new Array(K),me=0;me<K;me++)se[me]=arguments[me];var Be=1,Re=se[0],ve=se.length;if(typeof Re=="function")return Re.apply(null,se.slice(1));if(typeof Re=="string"){var Fe=String(Re).replace(m_,function(Xe){if(Xe==="%%")return"%";if(Be>=ve)return Xe;switch(Xe){case"%s":return String(se[Be++]);case"%d":return Number(se[Be++]);case"%j":try{return JSON.stringify(se[Be++])}catch{return"[Circular]"}break;default:return Xe}});return Fe}return Re}function y_(K){return K==="string"||K==="url"||K==="hex"||K==="email"||K==="date"||K==="pattern"}function hs(K,se){return!!(K==null||se==="array"&&Array.isArray(K)&&!K.length||y_(se)&&typeof K=="string"&&!K)}function __(K,se,me){var Be=[],Re=0,ve=K.length;function Fe(Xe){Be.push.apply(Be,Xe),Re++,Re===ve&&me(Be)}K.forEach(function(Xe){se(Xe,Fe)})}function gd(K,se,me){var Be=0,Re=K.length;function ve(Fe){if(Fe&&Fe.length){me(Fe);return}var Xe=Be;Be=Be+1,Xe<Re?se(K[Xe],ve):me([])}ve([])}function v_(K){var se=[];return Object.keys(K).forEach(function(me){se.push.apply(se,K[me])}),se}var _d=function(K){d_(se,K);function se(me,Be){var Re;return Re=K.call(this,"Async Validation Error")||this,Re.errors=me,Re.fields=Be,Re}return se}(Ru(Error));function b_(K,se,me,Be){if(se.first){var Re=new Promise(function(nr,jr){var zr=function(_t){return Be(_t),_t.length?jr(new _d(_t,ku(_t))):nr()},Fr=v_(K);gd(Fr,me,zr)});return Re.catch(function(nr){return nr}),Re}var ve=se.firstFields||[];ve===!0&&(ve=Object.keys(K));var Fe=Object.keys(K),Xe=Fe.length,tt=0,Ze=[],it=new Promise(function(nr,jr){var zr=function(Fr){if(Ze.push.apply(Ze,Fr),tt++,tt===Xe)return Be(Ze),Ze.length?jr(new _d(Ze,ku(Ze))):nr()};Fe.length||(Be(Ze),nr()),Fe.forEach(function(Fr){var _t=K[Fr];ve.indexOf(Fr)!==-1?gd(_t,me,zr):__(_t,me,zr)})});return it.catch(function(nr){return nr}),it}function vd(K){return function(se){return se&&se.message?(se.field=se.field||K.fullField,se):{message:typeof se=="function"?se():se,field:se.field||K.fullField}}}function bd(K,se){if(se){for(var me in se)if(se.hasOwnProperty(me)){var Be=se[me];typeof Be=="object"&&typeof K[me]=="object"?K[me]=aa({},K[me],Be):K[me]=Be}}return K}function xd(K,se,me,Be,Re,ve){K.required&&(!me.hasOwnProperty(K.field)||hs(se,ve||K.type))&&Be.push(Us(Re.messages.required,K.fullField))}function x_(K,se,me,Be,Re){(/^\s+$/.test(se)||se==="")&&Be.push(Us(Re.messages.whitespace,K.fullField))}var Iu={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},ll={integer:function(K){return ll.number(K)&&parseInt(K,10)===K},float:function(K){return ll.number(K)&&!ll.integer(K)},array:function(K){return Array.isArray(K)},regexp:function(K){if(K instanceof RegExp)return!0;try{return!!new RegExp(K)}catch{return!1}},date:function(K){return typeof K.getTime=="function"&&typeof K.getMonth=="function"&&typeof K.getYear=="function"&&!isNaN(K.getTime())},number:function(K){return isNaN(K)?!1:typeof K=="number"},object:function(K){return typeof K=="object"&&!ll.array(K)},method:function(K){return typeof K=="function"},email:function(K){return typeof K=="string"&&!!K.match(Iu.email)&&K.length<255},url:function(K){return typeof K=="string"&&!!K.match(Iu.url)},hex:function(K){return typeof K=="string"&&!!K.match(Iu.hex)}};function S_(K,se,me,Be,Re){if(K.required&&se===void 0){xd(K,se,me,Be,Re);return}var ve=["integer","float","array","regexp","object","method","email","number","date","url","hex"],Fe=K.type;ve.indexOf(Fe)>-1?ll[Fe](se)||Be.push(Us(Re.messages.types[Fe],K.fullField,K.type)):Fe&&typeof se!==K.type&&Be.push(Us(Re.messages.types[Fe],K.fullField,K.type))}function w_(K,se,me,Be,Re){var ve=typeof K.len=="number",Fe=typeof K.min=="number",Xe=typeof K.max=="number",tt=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Ze=se,it=null,nr=typeof se=="number",jr=typeof se=="string",zr=Array.isArray(se);if(nr?it="number":jr?it="string":zr&&(it="array"),!it)return!1;zr&&(Ze=se.length),jr&&(Ze=se.replace(tt,"_").length),ve?Ze!==K.len&&Be.push(Us(Re.messages[it].len,K.fullField,K.len)):Fe&&!Xe&&Ze<K.min?Be.push(Us(Re.messages[it].min,K.fullField,K.min)):Xe&&!Fe&&Ze>K.max?Be.push(Us(Re.messages[it].max,K.fullField,K.max)):Fe&&Xe&&(Ze<K.min||Ze>K.max)&&Be.push(Us(Re.messages[it].range,K.fullField,K.min,K.max))}var xa="enum";function O_(K,se,me,Be,Re){K[xa]=Array.isArray(K[xa])?K[xa]:[],K[xa].indexOf(se)===-1&&Be.push(Us(Re.messages[xa],K.fullField,K[xa].join(", ")))}function C_(K,se,me,Be,Re){if(K.pattern){if(K.pattern instanceof RegExp)K.pattern.lastIndex=0,K.pattern.test(se)||Be.push(Us(Re.messages.pattern.mismatch,K.fullField,se,K.pattern));else if(typeof K.pattern=="string"){var ve=new RegExp(K.pattern);ve.test(se)||Be.push(Us(Re.messages.pattern.mismatch,K.fullField,se,K.pattern))}}}var Ln={required:xd,whitespace:x_,type:S_,range:w_,enum:O_,pattern:C_};function T_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se,"string")&&!K.required)return me();Ln.required(K,se,Be,ve,Re,"string"),hs(se,"string")||(Ln.type(K,se,Be,ve,Re),Ln.range(K,se,Be,ve,Re),Ln.pattern(K,se,Be,ve,Re),K.whitespace===!0&&Ln.whitespace(K,se,Be,ve,Re))}me(ve)}function E_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),se!==void 0&&Ln.type(K,se,Be,ve,Re)}me(ve)}function A_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(se===""&&(se=void 0),hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),se!==void 0&&(Ln.type(K,se,Be,ve,Re),Ln.range(K,se,Be,ve,Re))}me(ve)}function M_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),se!==void 0&&Ln.type(K,se,Be,ve,Re)}me(ve)}function P_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),hs(se)||Ln.type(K,se,Be,ve,Re)}me(ve)}function R_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),se!==void 0&&(Ln.type(K,se,Be,ve,Re),Ln.range(K,se,Be,ve,Re))}me(ve)}function k_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),se!==void 0&&(Ln.type(K,se,Be,ve,Re),Ln.range(K,se,Be,ve,Re))}me(ve)}function I_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(se==null&&!K.required)return me();Ln.required(K,se,Be,ve,Re,"array"),se!=null&&(Ln.type(K,se,Be,ve,Re),Ln.range(K,se,Be,ve,Re))}me(ve)}function B_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),se!==void 0&&Ln.type(K,se,Be,ve,Re)}me(ve)}var V_="enum";function D_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re),se!==void 0&&Ln[V_](K,se,Be,ve,Re)}me(ve)}function N_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se,"string")&&!K.required)return me();Ln.required(K,se,Be,ve,Re),hs(se,"string")||Ln.pattern(K,se,Be,ve,Re)}me(ve)}function $_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se,"date")&&!K.required)return me();if(Ln.required(K,se,Be,ve,Re),!hs(se,"date")){var Xe;se instanceof Date?Xe=se:Xe=new Date(se),Ln.type(K,Xe,Be,ve,Re),Xe&&Ln.range(K,Xe.getTime(),Be,ve,Re)}}me(ve)}function L_(K,se,me,Be,Re){var ve=[],Fe=Array.isArray(se)?"array":typeof se;Ln.required(K,se,Be,ve,Re,Fe),me(ve)}function Bu(K,se,me,Be,Re){var ve=K.type,Fe=[],Xe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Xe){if(hs(se,ve)&&!K.required)return me();Ln.required(K,se,Be,Fe,Re,ve),hs(se,ve)||Ln.type(K,se,Be,Fe,Re)}me(Fe)}function F_(K,se,me,Be,Re){var ve=[],Fe=K.required||!K.required&&Be.hasOwnProperty(K.field);if(Fe){if(hs(se)&&!K.required)return me();Ln.required(K,se,Be,ve,Re)}me(ve)}var cl={string:T_,method:E_,number:A_,boolean:M_,regexp:P_,integer:R_,float:k_,array:I_,object:B_,enum:D_,pattern:N_,date:$_,url:Bu,hex:Bu,email:Bu,required:L_,any:F_};function Vu(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var K=JSON.parse(JSON.stringify(this));return K.clone=this.clone,K}}}var Du=Vu();function Fo(K){this.rules=null,this._messages=Du,this.define(K)}Fo.prototype={messages:function(K){return K&&(this._messages=bd(Vu(),K)),this._messages},define:function(K){if(!K)throw new Error("Cannot configure a schema with no rules");if(typeof K!="object"||Array.isArray(K))throw new Error("Rules must be an object");this.rules={};var se,me;for(se in K)K.hasOwnProperty(se)&&(me=K[se],this.rules[se]=Array.isArray(me)?me:[me])},validate:function(K,se,me){var Be=this;se===void 0&&(se={}),me===void 0&&(me=function(){});var Re=K,ve=se,Fe=me;if(typeof ve=="function"&&(Fe=ve,ve={}),!this.rules||Object.keys(this.rules).length===0)return Fe&&Fe(),Promise.resolve();function Xe(Fr){var _t,ni=[],on={};function Gi(Qi){if(Array.isArray(Qi)){var wi;ni=(wi=ni).concat.apply(wi,Qi)}else ni.push(Qi)}for(_t=0;_t<Fr.length;_t++)Gi(Fr[_t]);ni.length?on=ku(ni):(ni=null,on=null),Fe(ni,on)}if(ve.messages){var tt=this.messages();tt===Du&&(tt=Vu()),bd(tt,ve.messages),ve.messages=tt}else ve.messages=this.messages();var Ze,it,nr={},jr=ve.keys||Object.keys(this.rules);jr.forEach(function(Fr){Ze=Be.rules[Fr],it=Re[Fr],Ze.forEach(function(_t){var ni=_t;typeof ni.transform=="function"&&(Re===K&&(Re=aa({},Re)),it=Re[Fr]=ni.transform(it)),typeof ni=="function"?ni={validator:ni}:ni=aa({},ni),ni.validator=Be.getValidationMethod(ni),ni.field=Fr,ni.fullField=ni.fullField||Fr,ni.type=Be.getType(ni),ni.validator&&(nr[Fr]=nr[Fr]||[],nr[Fr].push({rule:ni,value:it,source:Re,field:Fr}))})});var zr={};return b_(nr,ve,function(Fr,_t){var ni=Fr.rule,on=(ni.type==="object"||ni.type==="array")&&(typeof ni.fields=="object"||typeof ni.defaultField=="object");on=on&&(ni.required||!ni.required&&Fr.value),ni.field=Fr.field;function Gi(li,Vi){return aa({},Vi,{fullField:ni.fullField+"."+li})}function Qi(li){li===void 0&&(li=[]);var Vi=li;if(Array.isArray(Vi)||(Vi=[Vi]),!ve.suppressWarning&&Vi.length&&Fo.warning("async-validator:",Vi),Vi.length&&ni.message!==void 0&&(Vi=[].concat(ni.message)),Vi=Vi.map(vd(ni)),ve.first&&Vi.length)return zr[ni.field]=1,_t(Vi);if(!on)_t(Vi);else{if(ni.required&&!Fr.value)return ni.message!==void 0?Vi=[].concat(ni.message).map(vd(ni)):ve.error&&(Vi=[ve.error(ni,Us(ve.messages.required,ni.field))]),_t(Vi);var Pi={};if(ni.defaultField)for(var pn in Fr.value)Fr.value.hasOwnProperty(pn)&&(Pi[pn]=ni.defaultField);Pi=aa({},Pi,Fr.rule.fields);for(var fn in Pi)if(Pi.hasOwnProperty(fn)){var Zi=Array.isArray(Pi[fn])?Pi[fn]:[Pi[fn]];Pi[fn]=Zi.map(Gi.bind(null,fn))}var Yi=new Fo(Pi);Yi.messages(ve.messages),Fr.rule.options&&(Fr.rule.options.messages=ve.messages,Fr.rule.options.error=ve.error),Yi.validate(Fr.value,Fr.rule.options||ve,function(tn){var vn=[];Vi&&Vi.length&&vn.push.apply(vn,Vi),tn&&tn.length&&vn.push.apply(vn,tn),_t(vn.length?vn:null)})}}var wi;ni.asyncValidator?wi=ni.asyncValidator(ni,Fr.value,Qi,Fr.source,ve):ni.validator&&(wi=ni.validator(ni,Fr.value,Qi,Fr.source,ve),wi===!0?Qi():wi===!1?Qi(ni.message||ni.field+" fails"):wi instanceof Array?Qi(wi):wi instanceof Error&&Qi(wi.message)),wi&&wi.then&&wi.then(function(){return Qi()},function(li){return Qi(li)})},function(Fr){Xe(Fr)})},getType:function(K){if(K.type===void 0&&K.pattern instanceof RegExp&&(K.type="pattern"),typeof K.validator!="function"&&K.type&&!cl.hasOwnProperty(K.type))throw new Error(Us("Unknown rule type %s",K.type));return K.type||"string"},getValidationMethod:function(K){if(typeof K.validator=="function")return K.validator;var se=Object.keys(K),me=se.indexOf("message");return me!==-1&&se.splice(me,1),se.length===1&&se[0]==="required"?cl.required:cl[this.getType(K)]||!1}},Fo.register=function(K,se){if(typeof se!="function")throw new Error("Cannot register a validator by type, validator is not a function");cl[K]=se},Fo.warning=g_,Fo.messages=Du,Fo.validators=cl;const ul="ivu-form-item";function Sd(K,se){let me=K;se=se.replace(/\[(\w+)\]/g,".$1"),se=se.replace(/^\./,"");let Be=se.split("."),Re=0;for(let ve=Be.length;Re<ve-1;++Re){let Fe=Be[Re];if(Fe in me)me=me[Fe];else throw new Error("[View UI warn]: please transfer a valid prop path to form item!")}return{o:me,k:Be[Re],v:me[Be[Re]]}}const U_={name:"FormItem",inject:["FormInstance"],provide(){return{FormItemInstance:this}},props:{label:{type:String,default:""},labelWidth:{type:Number},prop:{type:String},required:{type:Boolean,default:!1},rules:{type:[Object,Array]},error:{type:String},validateStatus:{type:Boolean},showMessage:{type:Boolean,default:!0},labelFor:{type:String}},data(){return{prefixCls:ul,isRequired:!1,validateState:"",validateMessage:"",validateDisabled:!1,validator:{}}},watch:{error:{handler(K){this.validateMessage=K,this.validateState=K?"error":""},immediate:!0},validateStatus(K){this.validateState=K},rules(){this.setRules()},required(K,se){this.isRequired=K,se&&!K&&this.resetField()}},computed:{classes(){return[`${ul}`,{[`${ul}-required`]:this.required||this.isRequired,[`${ul}-error`]:this.validateState==="error",[`${ul}-validating`]:this.validateState==="validating"}]},fieldValue(){const K=this.FormInstance.model;if(!K||!this.prop)return;let se=this.prop;return se.indexOf(":")!==-1&&(se=se.replace(/:/,".")),Sd(K,se).v},labelStyles(){let K={};const se=this.labelWidth===0||this.labelWidth?this.labelWidth:this.FormInstance.labelWidth;return(se||se===0)&&(K.width=`${se}px`),K},contentStyles(){let K={};const se=this.labelWidth===0||this.labelWidth?this.labelWidth:this.FormInstance.labelWidth;return(se||se===0)&&(K.marginLeft=`${se}px`),K}},methods:{setRules(){let K=this.getRules();K.length&&this.required||(K.length?K.every(se=>{this.isRequired=se.required}):this.required&&(this.isRequired=this.required))},getRules(){let K=this.FormInstance.rules;const se=this.rules;return K=K?K[this.prop]:[],[].concat(se||K||[])},getFilteredRule(K){return this.getRules().filter(se=>!se.trigger||se.trigger.indexOf(K)!==-1)},validate(K,se=function(){}){let me=this.getFilteredRule(K);if(!me||me.length===0)if(this.required)me=[{required:!0}];else return se(),!0;this.validateState="validating";let Be={};Be[this.prop]=me;const Re=new Fo(Be);let ve={};ve[this.prop]=this.fieldValue,Re.validate(ve,{firstFields:!0},Fe=>{this.validateState=Fe?"error":"success",this.validateMessage=Fe?Fe[0].message:"",se(this.validateMessage),this.FormInstance&&this.FormInstance.$emit("on-validate",this.prop,!Fe,this.validateMessage||null)}),this.validateDisabled=!1},resetField(){this.validateState="",this.validateMessage="";let K=this.FormInstance.model,se=this.fieldValue,me=this.prop;me.indexOf(":")!==-1&&(me=me.replace(/:/,"."));let Be=Sd(K,me);Array.isArray(se)&&this.initialValue!==null?(this.validateDisabled=!0,Be.o[Be.k]=[].concat(this.initialValue)):(this.validateDisabled=!0,Be.o[Be.k]=this.initialValue)},onFieldBlur(){this.validate("blur")},onFieldChange(){if(this.validateDisabled){this.validateDisabled=!1;return}this.validate("change")},formBlur(){this.onFieldBlur()},formChange(){this.onFieldChange()}},mounted(){this.prop&&(this.FormInstance.addField(this),Object.defineProperty(this,"initialValue",{value:this.fieldValue}),this.setRules())},beforeUnmount(){this.FormInstance.removeField(this)}},z_=["for"];function W_(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[me.label||K.$slots.label?(E.openBlock(),E.createElementBlock("label",{key:0,class:E.normalizeClass([Re.prefixCls+"-label"]),for:me.labelFor,style:E.normalizeStyle(ve.labelStyles)},[E.renderSlot(K.$slots,"label",{},()=>[E.createTextVNode(E.toDisplayString(me.label)+E.toDisplayString(ve.FormInstance.colon),1)])],14,z_)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content"]),style:E.normalizeStyle(ve.contentStyles)},[E.renderSlot(K.$slots,"default"),E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[Re.validateState==="error"&&me.showMessage&&ve.FormInstance.showMessage?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-error-tip"])},E.toDisplayString(Re.validateMessage),3)):E.createCommentVNode("",!0)]),_:1})],6)],2)}var tc=Y(U_,[["render",W_]]),Nu={UserName:"",Password:"",Email:"",Mobile:"",Captcha:""},hl={inject:["LoginInstance"],emits:["on-change"],props:{rules:{type:[Object,Array],default(){const K=E.getCurrentInstance().type.name;return[{required:!0,message:Nu[K],trigger:"change"}]}},value:{type:String},name:{type:String,required:!0},enterToSubmit:{type:Boolean,default:!1}},data(){return{prop:""}},methods:{handleChange(K){this.LoginInstance.formValidate[this.prop]=K,this.$emit("on-change",K)},handleEnter(){this.enterToSubmit&&this.LoginInstance.handleSubmit()},handleSetValue(){const K=this.$props;K.value&&(this.LoginInstance.formValidate[this.prop]=K.value)},handleGetProps(){let K=this.$props.name;const se={prefix:this.prefix,placeholder:this.placeholder,type:this.type,size:"large",modelValue:this.LoginInstance.formValidate[this.prop]};return K&&(se.name=K),Object.assign(se,this.$attrs)}},render(){const K=this.handleGetProps(),se=E.h(Js,{...K,"onUpdate:modelValue":this.handleChange,"onOn-enter":this.handleEnter}),me=E.h(tc,{prop:this.prop,rules:this.rules},()=>[se]);return E.h("div",{class:this.className},[me])},created(){const K=this.name,se=Object.assign({},this.LoginInstance.formValidate);se[K]="",this.LoginInstance.formValidate=se,this.prop=K,this.handleSetValue()}};const wd={name:"Captcha",mixins:[hl],emits:["on-get-captcha"],props:{field:{type:[String,Array]},countDown:{type:Number,default:60},text:{type:String},unitText:{type:String,default:""},beforeClick:Function},data(){return{className:"ivu-login-captcha",prefix:"ios-keypad-outline",placeholder:"",type:"text",buttonDisabled:!1,limitCountDown:0}},methods:{handleClickCaptcha(){if(this.field){const K=typeof this.field=="string"?[this.field]:this.field;this.LoginInstance.handleValidate(K,se=>{se&&this.handleBeforeGetCaptcha()})}else this.handleBeforeGetCaptcha()},handleBeforeGetCaptcha(){if(!this.beforeClick)return this.handleGetCaptcha();const K=this.beforeClick();K&&K.then?K.then(()=>{this.handleGetCaptcha()}):this.handleGetCaptcha()},handleGetCaptcha(){this.countDown>0&&(this.buttonDisabled=!0,this.limitCountDown=this.countDown,this.handleCountDown()),this.$emit("on-get-captcha",this.LoginInstance.formValidate[this.prop],JSON.parse(JSON.stringify(this.LoginInstance.formValidate)))},handleCountDown(){this.timer=setTimeout(()=>{this.limitCountDown--,this.limitCountDown===0?(this.buttonDisabled=!1,clearTimeout(this.timer)):this.handleCountDown()},1e3)}},render(){const K=this.$attrs,se=this.handleGetProps(),me={size:"large",type:"default",long:!0,disabled:this.buttonDisabled};"size"in K&&(me.size=K.size),"button-type"in K&&(me.type=K["button-type"]);let Be;this.$slots.text?Be=this.$slots.text:this.limitCountDown!==0?Be=()=>`${this.limitCountDown} ${this.unitText}`:this.text?Be=()=>this.text:Be=()=>"";const Re=E.h(As,{...me,onClick:this.handleClickCaptcha},Be),ve=E.h(Js,{...se,"onUpdate:modelValue":this.handleChange,"onOn-enter":this.handleEnter}),Fe=E.h(vo,{span:16},()=>[ve]),Xe=E.h(vo,{span:8},()=>[Re]),tt=E.h(Lo,{gutter:8},()=>[Fe,Xe]),Ze=E.h(tc,{prop:this.prop,rules:this.rules},()=>[tt]);return E.h("div",{class:this.className},[Ze])},beforeUnmount(){this.timer&&clearTimeout(this.timer)}},la="ivu-card",Od=16,G_={name:"Card",mixins:[Br],components:{Icon:Ae},props:{bordered:{type:Boolean,default:!0},disHover:{type:Boolean,default:!1},shadow:{type:Boolean,default:!1},padding:{type:Number,default:Od},title:{type:String},icon:{type:String}},data(){return{showHead:!0,showExtra:!0}},computed:{classes(){return[`${la}`,{[`${la}-bordered`]:this.bordered&&!this.shadow,[`${la}-dis-hover`]:this.disHover||this.shadow,[`${la}-shadow`]:this.shadow}]},headClasses(){return`${la}-head`},extraClasses(){return`${la}-extra`},bodyClasses(){return`${la}-body`},bodyStyles(){return this.padding!==Od?{padding:`${this.padding}px`}:""},isHrefPattern(){const{to:K}=this;return!!K},tagName(){const{isHrefPattern:K}=this;return K?"a":"div"},tagProps(){const{isHrefPattern:K}=this;if(K){const{linkUrl:se,target:me}=this;return{href:se,target:me}}else return{}}},methods:{handleClickLink(K){if(!this.isHrefPattern)return;const se=K.ctrlKey||K.metaKey;this.handleCheckClick(K,se)}},mounted(){this.showHead=this.title||this.$slots.title!==void 0,this.showExtra=this.$slots.extra!==void 0}},j_={key:0};function H_(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createBlock(E.resolveDynamicComponent(ve.tagName),E.mergeProps({class:ve.classes},ve.tagProps,{onClick:ve.handleClickLink}),{default:E.withCtx(()=>[Re.showHead?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.headClasses)},[E.renderSlot(K.$slots,"title",{},()=>[me.title?(E.openBlock(),E.createElementBlock("p",j_,[me.icon?(E.openBlock(),E.createBlock(Fe,{key:0,type:me.icon},null,8,["type"])):E.createCommentVNode("",!0),E.createElementVNode("span",null,E.toDisplayString(me.title),1)])):E.createCommentVNode("",!0)])],2)):E.createCommentVNode("",!0),Re.showExtra?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass(ve.extraClasses)},[E.renderSlot(K.$slots,"extra")],2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass(ve.bodyClasses),style:E.normalizeStyle(ve.bodyStyles)},[E.renderSlot(K.$slots,"default")],6)]),_:3},16,["class","onClick"])}var Cd=Y(G_,[["render",H_]]);const Sa="ivu-carousel",X_={name:"Carousel",provide(){return{CarouselInstance:this}},components:{Icon:Ae},emits:["on-change","on-click","update:modelValue"],props:{arrow:{type:String,default:"hover",validator(K){return Ie(K,["hover","always","never"])}},autoplay:{type:Boolean,default:!1},autoplaySpeed:{type:Number,default:2e3},loop:{type:Boolean,default:!1},easing:{type:String,default:"ease"},dots:{type:String,default:"inside",validator(K){return Ie(K,["inside","outside","none"])}},radiusDot:{type:Boolean,default:!1},trigger:{type:String,default:"click",validator(K){return Ie(K,["click","hover"])}},modelValue:{type:Number,default:0},height:{type:[String,Number],default:"auto",validator(K){return K==="auto"||Object.prototype.toString.call(K)==="[object Number]"}}},data(){return{prefixCls:Sa,listWidth:0,trackWidth:0,trackOffset:0,trackCopyOffset:0,showCopyTrack:!1,slides:[],slideInstances:[],timer:null,ready:!1,currentIndex:this.modelValue,trackIndex:this.modelValue,copyTrackIndex:this.modelValue,hideTrackPos:-1,carouselItemList:[]}},computed:{classes(){return[`${Sa}`]},trackStyles(){const K=this.trackIndex===-1?"hidden":"visible";return{width:`${this.trackWidth}px`,transform:`translate3d(${-this.trackOffset}px, 0px, 0px)`,transition:`transform 500ms ${this.easing}`,visibility:K}},copyTrackStyles(){return{width:`${this.trackWidth}px`,transform:`translate3d(${-this.trackCopyOffset}px, 0px, 0px)`,transition:`transform 500ms ${this.easing}`,position:"absolute"}},arrowClasses(){return[`${Sa}-arrow`,`${Sa}-arrow-${this.arrow}`]},dotsClasses(){return[`${Sa}-dots`,`${Sa}-dots-${this.dots}`]}},methods:{findChild(K){this.carouselItemList.length&&this.carouselItemList.forEach(se=>{K(se.carouselItem)})},initCopyTrackDom(){E.nextTick(()=>{this.$refs.copyTrack.innerHTML=this.$refs.originTrack.innerHTML})},updateSlides(K){let se=[],me=1;this.findChild(Be=>{se.push({$el:Be.$el}),Be.index=me++,K&&this.slideInstances.push(Be)}),this.slides=se,this.updatePos()},updatePos(){this.findChild(K=>{K.width=this.listWidth,K.height=typeof this.height=="number"?`${this.height}px`:this.height}),this.trackWidth=(this.slides.length||0)*this.listWidth},slotChange(){E.nextTick(()=>{this.slides=[],this.slideInstances=[],this.updateSlides(!0,!0),this.updatePos(),this.updateOffset()})},handleResize(){this.listWidth=parseInt(He(this.$el,"width")),this.updatePos(),this.updateOffset()},updateTrackPos(K){this.showCopyTrack?this.trackIndex=K:this.copyTrackIndex=K},updateTrackIndex(K){this.showCopyTrack?this.copyTrackIndex=K:this.trackIndex=K,this.currentIndex=K},add(K){let se=this.slides.length;this.loop&&(K>0?this.hideTrackPos=-1:this.hideTrackPos=se,this.updateTrackPos(this.hideTrackPos));const me=this.showCopyTrack?this.copyTrackIndex:this.trackIndex;let Be=me+K;for(;Be<0;)Be+=se;(K>0&&Be===se||K<0&&Be===se-1)&&this.loop?(this.showCopyTrack=!this.showCopyTrack,this.trackIndex+=K,this.copyTrackIndex+=K):(this.loop||(Be=Be%this.slides.length),this.updateTrackIndex(Be)),this.currentIndex=Be===this.slides.length?0:Be,this.$emit("on-change",me,this.currentIndex),this.$emit("update:modelValue",this.currentIndex)},arrowEvent(K){this.setAutoplay(),this.add(K)},dotsEvent(K,se){let me=this.showCopyTrack?this.copyTrackIndex:this.trackIndex;const Be=this.currentIndex;K===this.trigger&&me!==se&&(this.updateTrackIndex(se),this.$emit("on-change",Be,this.currentIndex),this.$emit("update:modelValue",se),this.setAutoplay())},setAutoplay(){!W||(window.clearInterval(this.timer),this.autoplay&&(this.timer=window.setInterval(()=>{this.add(1)},this.autoplaySpeed)))},updateOffset(){E.nextTick(()=>{let K=this.copyTrackIndex>0?-1:1;this.trackOffset=this.trackIndex*this.listWidth,this.trackCopyOffset=this.copyTrackIndex*this.listWidth+K})},handleClick(K){this.$emit("on-click",this[K])}},watch:{autoplay(){this.setAutoplay()},autoplaySpeed(){this.setAutoplay()},trackIndex(){this.updateOffset()},copyTrackIndex(){this.updateOffset()},height(){this.updatePos()},modelValue(K){this.updateTrackIndex(K),this.setAutoplay()}},mounted(){this.updateSlides(!0),this.handleResize(),this.setAutoplay(),X(window,"resize",this.handleResize)},beforeUnmount(){q(window,"resize",this.handleResize)}},q_=["onClick","onMouseover"];function Q_(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("button",{type:"button",class:E.normalizeClass([ve.arrowClasses,"left"]),onClick:se[0]||(se[0]=Xe=>ve.arrowEvent(-1))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-list"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-track",Re.showCopyTrack?"":"higher"]),style:E.normalizeStyle(ve.trackStyles),ref:"originTrack",onClick:se[1]||(se[1]=Xe=>ve.handleClick("currentIndex"))},[E.renderSlot(K.$slots,"default")],6),me.loop?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-track",Re.showCopyTrack?"higher":""]),style:E.normalizeStyle(ve.copyTrackStyles),ref:"copyTrack",onClick:se[2]||(se[2]=Xe=>ve.handleClick("copyTrackIndex"))},null,6)):E.createCommentVNode("",!0)],2),E.createElementVNode("button",{type:"button",class:E.normalizeClass([ve.arrowClasses,"right"]),onClick:se[3]||(se[3]=Xe=>ve.arrowEvent(1))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2),E.createElementVNode("ul",{class:E.normalizeClass(ve.dotsClasses)},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.slides.length,Xe=>(E.openBlock(),E.createElementBlock("li",{key:Xe,class:E.normalizeClass([Xe-1===Re.currentIndex?Re.prefixCls+"-active":""]),onClick:tt=>ve.dotsEvent("click",Xe-1),onMouseover:tt=>ve.dotsEvent("hover",Xe-1)},[E.createElementVNode("button",{type:"button",class:E.normalizeClass([me.radiusDot?"radius":""])},null,2)],42,q_))),128))],2)],2)}var Td=Y(X_,[["render",Q_]]);const Y_="ivu-carousel-item",K_={componentName:"carousel-item",name:"CarouselItem",inject:["CarouselInstance"],data(){return{prefixCls:Y_,width:0,height:"auto",left:0,id:gt(6)}},computed:{styles(){return{width:`${this.width}px`,height:`${this.height}`,left:`${this.left}px`}}},watch:{width(K){K&&this.CarouselInstance.loop&&E.nextTick(()=>{this.CarouselInstance.initCopyTrackDom()})},height(K){K&&this.CarouselInstance.loop&&E.nextTick(()=>{this.CarouselInstance.initCopyTrackDom()})}},methods:{addInstance(){const K=this.CarouselInstance;K.carouselItemList||(K.carouselItemList=[]),K.carouselItemList.push({id:this.id,carouselItem:this})},removeInstance(){const K=this.CarouselInstance;if(!K.carouselItemList)return;const se=K.carouselItemList.findIndex(me=>me.id===this.id);K.carouselItemList.splice(se,1)}},mounted(){this.addInstance(),this.CarouselInstance.slotChange()},beforeUnmount(){this.removeInstance(),this.CarouselInstance.slotChange()}};function Z_(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(Re.prefixCls),style:E.normalizeStyle(ve.styles)},[E.renderSlot(K.$slots,"default")],6)}var Ed=Y(K_,[["render",Z_]]);const J_={name:"Casitem",components:{Icon:Ae},mixins:[io],props:{data:Object,prefixCls:String,tmpItem:Object},computed:{classes(){return[`${this.prefixCls}-menu-item`,{[`${this.prefixCls}-menu-item-active`]:this.tmpItem.value===this.data.value,[`${this.prefixCls}-menu-item-disabled`]:this.data.disabled}]},showArrow(){return this.data.children&&this.data.children.length||"loading"in this.data&&!this.data.loading},showLoading(){return"loading"in this.data&&this.data.loading},arrowType(){const K=this.globalConfig;let se="ios-arrow-forward";return K&&(K.cascader.customItemArrow?se="":K.cascader.itemArrow&&(se=K.cascader.itemArrow)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.cascader.customItemArrow&&(se=K.cascader.customItemArrow),se},arrowSize(){const K=this.globalConfig;let se="";return K&&K.cascader.itemArrowSize&&(se=K.cascader.itemArrowSize),se}}},e0={key:1,class:"ivu-icon ivu-icon-ios-loading ivu-load-loop ivu-cascader-menu-item-loading"};function t0(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.classes)},[E.createTextVNode(E.toDisplayString(me.data.label)+" ",1),ve.showArrow?(E.openBlock(),E.createBlock(Fe,{key:0,type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize},null,8,["type","custom","size"])):E.createCommentVNode("",!0),ve.showLoading?(E.openBlock(),E.createElementBlock("i",e0)):E.createCommentVNode("",!0)],2)}var r0=Y(J_,[["render",t0]]);let i0=1;const n0={name:"Caspanel",components:{Casitem:r0},inject:["CascaderInstance"],provide(){return{CaspanelInstance:this}},props:{data:{type:Array,default(){return[]}},disabled:Boolean,changeOnSelect:Boolean,trigger:String,prefixCls:String},data(){return{tmpItem:{},result:[],sublist:[],id:gt(6),childCaspanelList:[]}},watch:{data(){this.sublist=[]}},methods:{handleClickItem(K){this.trigger!=="click"&&K.children&&K.children.length||this.handleTriggerItem(K,!1,!0)},handleHoverItem(K){this.trigger!=="hover"||!K.children||!K.children.length||this.handleTriggerItem(K,!1,!0)},handleTriggerItem(K,se=!1,me=!1){if(K.disabled)return;const Be=Je(this,"Cascader");if(K.loading!==void 0&&!K.children.length&&Be&&Be.loadData){Be.loadData(K,()=>{me&&(Be.isLoadedChildren=!0),K.children.length&&this.handleTriggerItem(K)});return}const Re=this.getBaseItem(K);(this.changeOnSelect||Re.label!==this.tmpItem.label||Re.value!==this.tmpItem.value||Re.label===this.tmpItem.label&&Re.value===this.tmpItem.value)&&(this.tmpItem=Re,this.emitUpdate([Re])),K.children&&K.children.length?(this.sublist=K.children,this.CascaderInstance.handleOnResultChange({lastValue:!1,changeOnSelect:this.changeOnSelect,fromInit:se}),this.changeOnSelect&&this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnClear(!0)):(this.sublist=[],this.CascaderInstance.handleOnResultChange({lastValue:!0,changeOnSelect:this.changeOnSelect,fromInit:se})),Be&&Be.$refs.drop.update()},updateResult(K){this.result=[this.tmpItem].concat(K),this.emitUpdate(this.result)},getBaseItem(K){let se=Object.assign({},K);return se.children&&delete se.children,se},emitUpdate(K){this.$parent.$options.name==="Caspanel"?this.$parent.updateResult(K):this.CascaderInstance.updateResult(K)},getKey(){return i0++},handleOnFindSelected(K){let se=[...K.value];for(let me=0;me<se.length;me++)for(let Be=0;Be<this.data.length;Be++)if(se[me]===this.data[Be].value)return this.handleTriggerItem(this.data[Be],!0),se.splice(0,1),E.nextTick(()=>{this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnFindSelected({value:se})}),!1},handleOnClear(K=!1){this.sublist=[],this.tmpItem={},K&&this.childCaspanelList.length&&this.childCaspanelList[0].caspanel.handleOnClear(!0)},addCaspanel(){const K=this.CascaderInstance;K.caspanelList||(K.caspanelList=[]),K.caspanelList.push({id:this.id,caspanel:this});const se=Je(this,"Caspanel");se&&(se.childCaspanelList||(se.childCaspanelList=[]),se.childCaspanelList.push({id:this.id,caspanel:this}))},removeCaspanel(){const K=this.CascaderInstance;if(K.caspanelList&&K.caspanelList.length){const me=K.caspanelList.findIndex(Be=>Be.id===this.id);K.caspanelList.splice(me,1)}const se=Je(this,"Caspanel");if(se&&se.childCaspanelList&&se.childCaspanelList.length){const me=se.childCaspanelList.findIndex(Be=>Be.id===this.id);se.childCaspanelList.splice(me,1)}}},mounted(){this.addCaspanel()},beforeUnmount(){this.removeCaspanel()}};function s0(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Casitem"),Xe=E.resolveComponent("Caspanel",!0);return E.openBlock(),E.createElementBlock("span",null,[me.data&&me.data.length?(E.openBlock(),E.createElementBlock("ul",{key:0,class:E.normalizeClass([me.prefixCls+"-menu"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.data,(tt,Ze)=>(E.openBlock(),E.createBlock(Fe,{key:Ze,"prefix-cls":me.prefixCls,data:tt,"tmp-item":Re.tmpItem,onClick:E.withModifiers(it=>ve.handleClickItem(tt),["stop"]),onMouseenter:E.withModifiers(it=>ve.handleHoverItem(tt),["stop"])},null,8,["prefix-cls","data","tmp-item","onClick","onMouseenter"]))),128))],2)):E.createCommentVNode("",!0),Re.sublist&&Re.sublist.length?(E.openBlock(),E.createBlock(Xe,{key:1,"prefix-cls":me.prefixCls,data:Re.sublist,disabled:me.disabled,trigger:me.trigger,"change-on-select":me.changeOnSelect},null,8,["prefix-cls","data","disabled","trigger","change-on-select"])):E.createCommentVNode("",!0)])}var o0=Y(n0,[["render",s0]]),$u={beforeMount(K,se,me){function Be(Re){if(K.contains(Re.target))return!1;se.value(Re)}K.__vueClickOutside__=Be,W&&document.addEventListener("click",Be)},unmounted(K,se){W&&document.removeEventListener("click",K.__vueClickOutside__),delete K.__vueClickOutside__}};const Uo="ivu-cascader",a0="ivu-select",l0={name:"Cascader",mixins:[Xn,In,io],components:{iInput:Js,Drop:ki,Icon:Ae,Caspanel:o0},directives:{clickOutside:$u},emits:["on-change","on-visible-change","update:modelValue"],provide(){return{CascaderInstance:this}},props:{data:{type:Array,default(){return[]}},modelValue:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},placeholder:{type:String},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},trigger:{validator(K){return Ie(K,["click","hover"])},default:"click"},changeOnSelect:{type:Boolean,default:!1},renderFormat:{type:Function,default(K){return K.join(" / ")}},loadData:{type:Function},filterable:{type:Boolean,default:!1},notFoundText:{type:String},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},capture:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return K.$VIEWUI?K.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){return{prefixCls:Uo,selectPrefixCls:a0,visible:!1,selected:[],tmpSelected:[],updatingValue:!1,currentValue:this.modelValue||[],query:"",validDataStr:"",isLoadedChildren:!1,isValueNull:!1,caspanelList:[]}},computed:{classes(){return[`${Uo}`,{[`${Uo}-show-clear`]:this.showCloseIcon,[`${Uo}-size-${this.size}`]:!!this.size,[`${Uo}-visible`]:this.visible,[`${Uo}-disabled`]:this.itemDisabled,[`${Uo}-not-found`]:this.filterable&&this.query!==""&&!this.querySelections.length}]},showCloseIcon(){return this.currentValue&&this.currentValue.length&&this.clearable&&!this.itemDisabled},displayRender(){let K=[];for(let se=0;se<this.selected.length;se++)K.push(this.selected[se].label);return this.renderFormat(K,this.selected)},displayInputRender(){return this.filterable?"":this.displayRender},localePlaceholder(){return this.placeholder===void 0?this.t("i.select.placeholder"):this.placeholder},inputPlaceholder(){return this.filterable&&this.currentValue.length?null:this.localePlaceholder},localeNotFoundText(){return this.notFoundText===void 0?this.t("i.select.noMatch"):this.notFoundText},querySelections(){let K=[];function se(me,Be,Re){const ve=Qe(me);for(let Fe=0;Fe<ve.length;Fe++){let Xe=ve[Fe];Xe.__label=Be?Be+" / "+Xe.label:Xe.label,Xe.__value=Re?Re+","+Xe.value:Xe.value,Xe.children&&Xe.children.length?(se(Xe.children,Xe.__label,Xe.__value),delete Xe.__label,delete Xe.__value):K.push({label:Xe.__label,value:Xe.__value,display:Xe.__label,item:Xe,disabled:!!Xe.disabled})}}return se(this.data),K=K.filter(me=>me.label?me.label.indexOf(this.query)>-1:!1).map(me=>(me.display=me.display.replace(new RegExp(this.query,"g"),`<span>${this.query}</span>`),me)),K},arrowType(){const K=this.globalConfig;let se="ios-arrow-down";return K&&(K.cascader.customArrow?se="":K.cascader.arrow&&(se=K.cascader.arrow)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.cascader.customArrow&&(se=K.cascader.customArrow),se},arrowSize(){const K=this.globalConfig;let se="";return K&&K.cascader.arrowSize&&(se=K.cascader.arrowSize),se},dropdownCls(){return{[Uo+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}}},methods:{clearSelect(){if(this.itemDisabled)return!1;const K=JSON.stringify(this.currentValue);this.currentValue=this.selected=this.tmpSelected=[],this.handleClose(),this.emitValue(this.currentValue,K),this.caspanelList.forEach(se=>{se.caspanel.handleOnClear()})},handleClose(){this.visible=!1},toggleOpen(){if(this.itemDisabled)return!1;this.visible?this.filterable||this.handleClose():this.onFocus()},onFocus(){this.visible=!0,this.currentValue.length||this.caspanelList.forEach(K=>{K.caspanel.handleOnClear()})},updateResult(K){this.tmpSelected=K},updateSelected(K=!1,se=!1){(!this.changeOnSelect||K||se)&&this.caspanelList.forEach(me=>{me.caspanel.handleOnFindSelected({value:this.currentValue})})},emitValue(K,se){JSON.stringify(K)!==se&&(this.$emit("on-change",this.currentValue,JSON.parse(JSON.stringify(this.selected))),E.nextTick(()=>{this.handleFormItemChange("change",{value:this.currentValue,selected:JSON.parse(JSON.stringify(this.selected))})}))},handleInput(K){this.query=K.target.value},handleSelectItem(K){const se=this.querySelections[K];if(se.item.disabled)return!1;this.query="",this.$refs.input.currentValue="";const me=JSON.stringify(this.currentValue);this.currentValue=se.value.split(","),setTimeout(()=>{this.emitValue(this.currentValue,me),this.handleClose()},0)},handleFocus(){this.$refs.input.focus()},getValidData(K){const se=Qe(K);function me(Be){const Re=Object.assign({},Be);return"loading"in Re&&delete Re.loading,"__value"in Re&&delete Re.__value,"__label"in Re&&delete Re.__label,"children"in Re&&Re.children.length&&(Re.children=Re.children.map(ve=>me(ve))),Re}return se.map(Be=>me(Be))},handleOnResultChange(K){const se=K.lastValue,me=K.changeOnSelect,Be=K.fromInit;if(se||me){const Re=JSON.stringify(this.currentValue);this.selected=this.tmpSelected;let ve=[];this.selected.forEach(Fe=>{ve.push(Fe.value)}),Be||(this.updatingValue=!0,this.currentValue=ve,this.emitValue(this.currentValue,Re))}se&&!Be&&this.handleClose()}},created(){this.validDataStr=JSON.stringify(this.getValidData(this.data))},mounted(){this.updateSelected(!0)},watch:{visible(K){K?(this.currentValue.length&&this.updateSelected(),this.transfer&&this.$refs.drop.update(),this.$refs.drop.handleOnUpdatePopper()):(this.filterable&&(this.query="",this.$refs.input.currentValue=""),this.transfer&&this.$refs.drop.destroy(),this.$refs.drop.handleOnDestroyPopper()),this.$emit("on-visible-change",K)},modelValue(K){K===null&&(this.isValueNull=!0),this.currentValue=K||[],(K===null||!K.length)&&(this.selected=[])},currentValue(){if(this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",this.currentValue),this.updatingValue){this.updatingValue=!1;return}this.updateSelected(!0)},data:{deep:!0,handler(){const K=JSON.stringify(this.getValidData(this.data));K!==this.validDataStr&&(this.validDataStr=K,this.isLoadedChildren||E.nextTick(()=>this.updateSelected(!1,this.changeOnSelect)),this.isLoadedChildren=!1)}}}},c0=["name","value"],u0=["onClick","innerHTML"];function h0(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("i-input"),Xe=E.resolveComponent("Icon"),tt=E.resolveComponent("Caspanel"),Ze=E.resolveComponent("Drop"),it=E.resolveDirective("click-outside");return E.withDirectives((E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-rel"]),onClick:se[1]||(se[1]=(...nr)=>ve.toggleOpen&&ve.toggleOpen(...nr)),ref:"reference"},[E.createElementVNode("input",{type:"hidden",name:me.name,value:Re.currentValue},null,8,c0),E.renderSlot(K.$slots,"default",{},()=>[E.createVNode(Fe,{"element-id":me.elementId,ref:"input",readonly:!me.filterable,disabled:K.itemDisabled,modelValue:ve.displayInputRender,onOnChange:ve.handleInput,size:me.size,placeholder:ve.inputPlaceholder},null,8,["element-id","readonly","disabled","modelValue","onOnChange","size","placeholder"]),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-label"]),onClick:se[0]||(se[0]=(...nr)=>ve.handleFocus&&ve.handleFocus(...nr))},E.toDisplayString(ve.displayRender),3),[[E.vShow,me.filterable&&Re.query===""]]),E.withDirectives(E.createVNode(Xe,{type:"ios-close-circle",class:E.normalizeClass([Re.prefixCls+"-arrow"]),onClick:E.withModifiers(ve.clearSelect,["stop"])},null,8,["class","onClick"]),[[E.vShow,ve.showCloseIcon]]),E.createVNode(Xe,{type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize,class:E.normalizeClass([Re.prefixCls+"-arrow"])},null,8,["type","custom","size","class"])])],2),E.createVNode(Ze,{ref:"drop",visible:Re.visible,classes:ve.dropdownCls,eventsEnabled:me.eventsEnabled,"transition-name":"transition-drop",transfer:me.transfer},{default:E.withCtx(()=>[E.createElementVNode("div",null,[E.withDirectives(E.createVNode(tt,{ref:"caspanel","prefix-cls":Re.prefixCls,data:me.data,disabled:K.itemDisabled,"change-on-select":me.changeOnSelect,trigger:me.trigger},null,8,["prefix-cls","data","disabled","change-on-select","trigger"]),[[E.vShow,!me.filterable||me.filterable&&Re.query===""]]),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-dropdown"])},[E.createElementVNode("ul",{class:E.normalizeClass([Re.selectPrefixCls+"-dropdown-list"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.querySelections,(nr,jr)=>(E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass([Re.selectPrefixCls+"-item",{[Re.selectPrefixCls+"-item-disabled"]:nr.disabled}]),key:jr,onClick:zr=>ve.handleSelectItem(jr),innerHTML:nr.display},null,10,u0))),128))],2)],2),[[E.vShow,me.filterable&&Re.query!==""&&ve.querySelections.length]]),E.withDirectives(E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls+"-not-found-tip"])},[E.createElementVNode("li",null,E.toDisplayString(ve.localeNotFoundText),1)],2),[[E.vShow,me.filterable&&Re.query!==""&&!ve.querySelections.length||!me.data.length]])])]),_:1},8,["visible","classes","eventsEnabled","transfer"])],2)),[[it,ve.handleClose]])}var Ad=Y(l0,[["render",h0]]);const d0={name:"CellItem",props:{title:{type:String,default:""},label:{type:String,default:""},extra:{type:String,default:""}}},p0={class:"ivu-cell-item"},f0={class:"ivu-cell-icon"},m0={class:"ivu-cell-main"},g0={class:"ivu-cell-title"},y0={class:"ivu-cell-label"},_0={class:"ivu-cell-footer"},v0={class:"ivu-cell-extra"};function b0(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",p0,[E.createElementVNode("div",f0,[E.renderSlot(K.$slots,"icon")]),E.createElementVNode("div",m0,[E.createElementVNode("div",g0,[E.renderSlot(K.$slots,"default",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])]),E.createElementVNode("div",y0,[E.renderSlot(K.$slots,"label",{},()=>[E.createTextVNode(E.toDisplayString(me.label),1)])])]),E.createElementVNode("div",_0,[E.createElementVNode("span",v0,[E.renderSlot(K.$slots,"extra",{},()=>[E.createTextVNode(E.toDisplayString(me.extra),1)])])])])}var x0=Y(d0,[["render",b0]]);const dl="ivu-cell",S0={name:"Cell",inject:["CellGroupInstance"],mixins:[Br,io],components:{CellItem:x0,Icon:Ae},props:{name:{type:[String,Number]},title:{type:String,default:""},label:{type:String,default:""},extra:{type:String,default:""},disabled:{type:Boolean,default:!1},selected:{type:Boolean,default:!1}},data(){return{prefixCls:dl}},computed:{classes(){return[`${dl}`,{[`${dl}-disabled`]:this.disabled,[`${dl}-selected`]:this.selected,[`${dl}-with-link`]:this.to}]},arrowType(){const K=this.globalConfig;let se="ios-arrow-forward";return K&&(K.cell.customArrow?se="":K.cell.arrow&&(se=K.cell.arrow)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.cell.customArrow&&(se=K.cell.customArrow),se},arrowSize(){const K=this.globalConfig;let se="";return K&&K.cell.arrowSize&&(se=K.cell.arrowSize),se}},methods:{handleClickItem(K,se){this.CellGroupInstance.handleClick(this.name),this.handleCheckClick(K,se)}}},w0=["href","target"],O0={key:2,class:"ivu-cell-arrow"};function C0(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("CellItem"),Xe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[K.to?(E.openBlock(),E.createElementBlock("a",{key:0,href:K.linkUrl,target:K.target,class:"ivu-cell-link",onClick:[se[0]||(se[0]=E.withModifiers(tt=>ve.handleClickItem(tt,!1),["exact"])),se[1]||(se[1]=E.withModifiers(tt=>ve.handleClickItem(tt,!0),["ctrl"])),se[2]||(se[2]=E.withModifiers(tt=>ve.handleClickItem(tt,!0),["meta"]))]},[E.createVNode(Fe,{title:me.title,label:me.label,extra:me.extra},{icon:E.withCtx(()=>[E.renderSlot(K.$slots,"icon")]),default:E.withCtx(()=>[E.renderSlot(K.$slots,"default")]),extra:E.withCtx(()=>[E.renderSlot(K.$slots,"extra")]),label:E.withCtx(()=>[E.renderSlot(K.$slots,"label")]),_:3},8,["title","label","extra"])],8,w0)):(E.openBlock(),E.createElementBlock("div",{key:1,class:"ivu-cell-link",onClick:se[3]||(se[3]=(...tt)=>ve.handleClickItem&&ve.handleClickItem(...tt))},[E.createVNode(Fe,{title:me.title,label:me.label,extra:me.extra},{icon:E.withCtx(()=>[E.renderSlot(K.$slots,"icon")]),default:E.withCtx(()=>[E.renderSlot(K.$slots,"default")]),extra:E.withCtx(()=>[E.renderSlot(K.$slots,"extra")]),label:E.withCtx(()=>[E.renderSlot(K.$slots,"label")]),_:3},8,["title","label","extra"])])),K.to?(E.openBlock(),E.createElementBlock("div",O0,[E.renderSlot(K.$slots,"arrow",{},()=>[E.createVNode(Xe,{type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize},null,8,["type","custom","size"])])])):E.createCommentVNode("",!0)],2)}var Md=Y(S0,[["render",C0]]);const T0={name:"CellGroup",emits:["on-click"],provide(){return{CellGroupInstance:this}},methods:{handleClick(K){this.$emit("on-click",K)}}},E0={class:"ivu-cell-group"};function A0(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",E0,[E.renderSlot(K.$slots,"default")])}var Pd=Y(T0,[["render",A0]]);const Ws="ivu-checkbox",M0={name:"Checkbox",mixins:[In],emits:["update:modelValue","on-change"],inject:{CheckboxGroupInstance:{default:null}},props:{disabled:{type:Boolean,default:!1},modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},label:{type:[String,Number,Boolean]},indeterminate:{type:Boolean,default:!1},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},name:{type:String},border:{type:Boolean,default:!1}},data(){return{showSlot:!0,focusInner:!1,model:[]}},computed:{wrapClasses(){return[`${Ws}-wrapper`,{[`${Ws}-group-item`]:this.group,[`${Ws}-wrapper-checked`]:this.currentValue,[`${Ws}-wrapper-disabled`]:this.itemDisabled,[`${Ws}-${this.size}`]:!!this.size,[`${Ws}-border`]:this.border}]},checkboxClasses(){return[`${Ws}`,{[`${Ws}-checked`]:this.currentValue,[`${Ws}-disabled`]:this.itemDisabled,[`${Ws}-indeterminate`]:this.indeterminate}]},innerClasses(){return[`${Ws}-inner`,{[`${Ws}-focus`]:this.focusInner}]},inputClasses(){return`${Ws}-input`},currentValue(){return this.CheckboxGroupInstance?this.CheckboxGroupInstance.modelValue.indexOf(this.label)>=0:this.modelValue===this.trueValue},group(){return!!this.CheckboxGroupInstance}},mounted(){this.CheckboxGroupInstance||(this.showSlot=this.$slots.default!==void 0)},methods:{change(K){if(this.itemDisabled)return!1;const se=K.target.checked?this.trueValue:this.falseValue;this.$emit("update:modelValue",se),this.group?this.CheckboxGroupInstance.change(this.model):(this.$emit("on-change",se),this.handleFormItemChange("change",se))},onBlur(){this.focusInner=!1},onFocus(){this.focusInner=!0}},watch:{modelValue(K){if(!(K===this.trueValue||K===this.falseValue))throw"Value should be trueValue or falseValue."},"CheckboxGroupInstance.modelValue":{handler(K){this.model=K||[]},immediate:!0}}},P0=["disabled","value","name"],R0=["disabled","checked","name"],k0={key:0,class:"ivu-checkbox-label-text"};function I0(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("label",{class:E.normalizeClass(ve.wrapClasses)},[E.createElementVNode("span",{class:E.normalizeClass(ve.checkboxClasses)},[E.createElementVNode("span",{class:E.normalizeClass(ve.innerClasses)},null,2),ve.group?E.withDirectives((E.openBlock(),E.createElementBlock("input",{key:0,type:"checkbox",class:E.normalizeClass(ve.inputClasses),disabled:K.itemDisabled,value:me.label,"onUpdate:modelValue":se[0]||(se[0]=Fe=>Re.model=Fe),name:me.name,onChange:se[1]||(se[1]=(...Fe)=>ve.change&&ve.change(...Fe)),onFocus:se[2]||(se[2]=(...Fe)=>ve.onFocus&&ve.onFocus(...Fe)),onBlur:se[3]||(se[3]=(...Fe)=>ve.onBlur&&ve.onBlur(...Fe))},null,42,P0)),[[E.vModelCheckbox,Re.model]]):(E.openBlock(),E.createElementBlock("input",{key:1,type:"checkbox",class:E.normalizeClass(ve.inputClasses),disabled:K.itemDisabled,checked:ve.currentValue,name:me.name,onChange:se[4]||(se[4]=(...Fe)=>ve.change&&ve.change(...Fe)),onFocus:se[5]||(se[5]=(...Fe)=>ve.onFocus&&ve.onFocus(...Fe)),onBlur:se[6]||(se[6]=(...Fe)=>ve.onBlur&&ve.onBlur(...Fe))},null,42,R0))],2),Re.showSlot?(E.openBlock(),E.createElementBlock("span",k0,[E.renderSlot(K.$slots,"default",{},()=>[E.createTextVNode(E.toDisplayString(me.label),1)])])):E.createCommentVNode("",!0)],2)}var wa=Y(M0,[["render",I0]]);const B0="ivu-checkbox-group",V0={name:"CheckboxGroup",mixins:[In],emits:["update:modelValue","on-change"],provide(){return{CheckboxGroupInstance:this}},props:{modelValue:{type:Array,default(){return[]}},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}}},data(){return{currentValue:this.modelValue||[],children:[]}},computed:{classes(){return[`${B0}`,{[`ivu-checkbox-${this.size}`]:!!this.size}]}},methods:{change(K){this.currentValue=K,this.$emit("update:modelValue",K),this.$emit("on-change",K),this.handleFormItemChange("change",K)}}};function D0(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.renderSlot(K.$slots,"default")],2)}var Lu=Y(V0,[["render",D0]]);const Rd="ivu-chart-circle",N0={name:"iCircle",props:{percent:{type:Number,default:0},size:{type:Number,default:120},strokeWidth:{type:Number,default:6},strokeColor:{type:[String,Array],default:"#2d8cf0"},strokeLinecap:{validator(K){return Ie(K,["square","round"])},default:"round"},trailWidth:{type:Number,default:5},trailColor:{type:String,default:"#eaeef2"},dashboard:{type:Boolean,default:!1}},data(){return{id:`ivu-chart-circle-${gt(3)}`}},computed:{circleSize(){return{width:`${this.size}px`,height:`${this.size}px`}},computedStrokeWidth(){return this.percent===0&&this.dashboard?0:this.strokeWidth},radius(){return 50-this.strokeWidth/2},pathString(){return this.dashboard?`M 50,50 m 0,${this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,-${2*this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,${2*this.radius}`:`M 50,50 m 0,-${this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,${2*this.radius}
                    a ${this.radius},${this.radius} 0 1 1 0,-${2*this.radius}`},len(){return Math.PI*2*this.radius},trailStyle(){let K={};return this.dashboard&&(K={"stroke-dasharray":`${this.len-75}px ${this.len}px`,"stroke-dashoffset":`-${75/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s"}),K},pathStyle(){let K={};return this.dashboard?K={"stroke-dasharray":`${this.percent/100*(this.len-75)}px ${this.len}px`,"stroke-dashoffset":`-${75/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .6s ease 0s, stroke .6s, stroke-width .06s ease .6s"}:K={"stroke-dasharray":`${this.len}px ${this.len}px`,"stroke-dashoffset":`${(100-this.percent)/100*this.len}px`,transition:"stroke-dashoffset 0.6s ease 0s, stroke 0.6s ease"},K},wrapClasses(){return`${Rd}`},innerClasses(){return`${Rd}-inner`},strokeValue(){let K=this.strokeColor;return typeof this.strokeColor!="string"&&(K=`url(#${this.id})`),K},showDefs(){return typeof this.strokeColor!="string"}}},$0={viewBox:"0 0 100 100"},L0={key:0},F0=["id"],U0=["stop-color"],z0=["stop-color"],W0=["d","stroke","stroke-width","stroke-linecap"],G0=["d","stroke-linecap","stroke","stroke-width"];function j0(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{style:E.normalizeStyle(ve.circleSize),class:E.normalizeClass(ve.wrapClasses)},[(E.openBlock(),E.createElementBlock("svg",$0,[ve.showDefs?(E.openBlock(),E.createElementBlock("defs",L0,[E.createElementVNode("linearGradient",{id:Re.id,x1:"100%",y1:"0%",x2:"0%",y2:"0%"},[E.createElementVNode("stop",{offset:"0%","stop-color":me.strokeColor[0]},null,8,U0),E.createElementVNode("stop",{offset:"100%","stop-color":me.strokeColor[1]},null,8,z0)],8,F0)])):E.createCommentVNode("",!0),E.createElementVNode("path",{d:ve.pathString,stroke:me.trailColor,"stroke-width":me.trailWidth,"fill-opacity":0,style:E.normalizeStyle(ve.trailStyle),"stroke-linecap":me.strokeLinecap},null,12,W0),E.createElementVNode("path",{d:ve.pathString,"stroke-linecap":me.strokeLinecap,stroke:ve.strokeValue,"stroke-width":ve.computedStrokeWidth,"fill-opacity":"0",style:E.normalizeStyle(ve.pathStyle)},null,12,G0)])),E.createElementVNode("div",{class:E.normalizeClass(ve.innerClasses)},[E.renderSlot(K.$slots,"default")],2)],6)}var rc=Y(N0,[["render",j0]]);const ic="ivu-dropdown",H0={name:"Dropdown",directives:{clickOutside:$u},components:{Drop:ki},emits:["on-visible-change","on-clickoutside","on-click","on-hover-click","on-haschild-click"],props:{trigger:{validator(K){return Ie(K,["click","hover","custom","contextMenu"])},default:"hover"},placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},visible:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},transferClassName:{type:String},stopPropagation:{type:Boolean,default:!1},capture:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return K.$VIEWUI?K.$VIEWUI.capture:!0}},eventsEnabled:{type:Boolean,default:!1},boundariesElement:{default:"window"}},computed:{transition(){return["bottom-start","bottom","bottom-end"].indexOf(this.placement)>-1?"slide-up":"fade"},dropdownCls(){return{[ic+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}},relClasses(){return[`${ic}-rel`,{[`${ic}-rel-user-select-none`]:this.trigger==="contextMenu"}]}},data(){return{prefixCls:ic,currentVisible:this.visible,timeout:null}},watch:{visible(K){this.currentVisible=K},currentVisible(K){K?this.$refs.drop.update():this.$refs.drop.destroy(),this.$emit("on-visible-change",K)}},methods:{handleClick(){if(this.trigger==="custom"||this.trigger!=="click")return!1;this.hasParent()||(this.currentVisible=!this.currentVisible)},handleRightClick(){if(this.trigger==="custom"||this.trigger!=="contextMenu")return!1;this.currentVisible=!this.currentVisible},handleMouseenter(){if(this.trigger==="custom"||this.trigger!=="hover")return!1;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.currentVisible=!0},250)},handleMouseleave(){if(this.trigger==="custom"||this.trigger!=="hover")return!1;this.timeout&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.currentVisible=!1},150))},onClickoutside(K){this.handleClose(),this.handleRightClose(),this.currentVisible&&this.$emit("on-clickoutside",K)},handleClose(){if(this.trigger==="custom"||this.trigger!=="click")return!1;this.currentVisible=!1},handleRightClose(){if(this.trigger==="custom"||this.trigger!=="contextMenu")return!1;this.currentVisible=!1},hasParent(){return Je(this,"Dropdown")||!1},handleHaschildClick(){E.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!0});const K=this.hasParent();K&&K.handleHaschildClick()},handleItemClick(K){if(this.stopPropagation)return;const se=this.hasParent();se?se.handleItemClick(K):this.$emit("on-click",K)},handleHoverClick(){const K=this.hasParent();K?(E.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!1}),K.handleHoverClick()):E.nextTick(()=>{if(this.trigger==="custom")return!1;this.currentVisible=!1})}}};function X0(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Drop"),Xe=E.resolveDirective("click-outside");return E.withDirectives((E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls]),onMouseenter:se[2]||(se[2]=(...tt)=>ve.handleMouseenter&&ve.handleMouseenter(...tt)),onMouseleave:se[3]||(se[3]=(...tt)=>ve.handleMouseleave&&ve.handleMouseleave(...tt))},[E.createElementVNode("div",{class:E.normalizeClass(ve.relClasses),ref:"reference",onClick:se[0]||(se[0]=(...tt)=>ve.handleClick&&ve.handleClick(...tt)),onContextmenu:se[1]||(se[1]=E.withModifiers((...tt)=>ve.handleRightClick&&ve.handleRightClick(...tt),["prevent"]))},[E.renderSlot(K.$slots,"default")],34),E.createVNode(Fe,{ref:"drop",visible:Re.currentVisible,classes:ve.dropdownCls,placement:me.placement,eventsEnabled:me.eventsEnabled,boundariesElement:me.boundariesElement,transfer:me.transfer,"transition-name":"transition-drop",onMouseenter:ve.handleMouseenter,onMouseleave:ve.handleMouseleave},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"list")]),_:3},8,["visible","classes","placement","eventsEnabled","boundariesElement","transfer","onMouseenter","onMouseleave"])],34)),[[Xe,ve.onClickoutside]])}var ca=Y(H0,[["render",X0]]);const q0={name:"DropdownMenu"},Q0={class:"ivu-dropdown-menu"};function Y0(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("ul",Q0,[E.renderSlot(K.$slots,"default")])}var ua=Y(q0,[["render",Y0]]);const eo="ivu-tag",Ao=["default","primary","success","warning","error","blue","green","red","yellow","pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],K0=["pink","magenta","volcano","orange","gold","lime","cyan","geekblue","purple"],Z0={name:"Tag",components:{Icon:Ae},emits:["on-change","on-close"],props:{closable:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},checked:{type:Boolean,default:!0},color:{type:String,default:"default"},type:{validator(K){return Ie(K,["border","dot"])}},name:{type:[String,Number]},size:{validator(K){return Ie(K,["default","medium","large"])},default:"default"}},data(){return{isChecked:this.checked}},computed:{classes(){return[`${eo}`,`${eo}-size-${this.size}`,{[`${eo}-${this.color}`]:!!this.color&&Ie(this.color,Ao),[`${eo}-${this.type}`]:!!this.type,[`${eo}-closable`]:this.closable,[`${eo}-checked`]:this.isChecked,[`${eo}-checkable`]:this.checkable}]},wraperStyles(){return Ie(this.color,Ao)?{}:{background:this.isChecked?this.defaultTypeColor:"transparent",borderWidth:"1px",borderStyle:"solid",borderColor:this.type!=="dot"&&this.type!=="border"&&this.isChecked?this.borderColor:this.lineColor,color:this.lineColor}},textClasses(){return[`${eo}-text`,this.type==="border"&&Ie(this.color,Ao)?`${eo}-color-${this.color}`:"",this.type!=="dot"&&this.type!=="border"&&this.color!=="default"&&this.isChecked&&K0.indexOf(this.color)<0?`${eo}-color-white`:""]},dotClasses(){return`${eo}-dot-inner`},iconClass(){return this.type==="dot"?"":this.type==="border"?Ie(this.color,Ao)?`${eo}-color-${this.color}`:"":this.color!==void 0?this.color==="default"?"":"rgb(255, 255, 255)":""},showDot(){return!!this.type&&this.type==="dot"},lineColor(){return this.type==="dot"?"":this.type==="border"?this.color!==void 0?Ie(this.color,Ao)?"":this.color:"":this.color!==void 0?this.color==="default"?"":"rgb(255, 255, 255)":""},borderColor(){return this.color!==void 0?this.color==="default"?"":this.color:""},dotColor(){return this.color!==void 0?Ie(this.color,Ao)?"":this.color:""},textColorStyle(){return Ie(this.color,Ao)?{}:this.type!=="dot"&&this.type!=="border"?this.isChecked?{color:this.lineColor}:{}:{color:this.lineColor}},bgColorStyle(){return Ie(this.color,Ao)?{}:{background:this.dotColor}},defaultTypeColor(){return this.type!=="dot"&&this.type!=="border"&&this.color!==void 0?Ie(this.color,Ao)?"":this.color:""}},methods:{close(K){this.name===void 0?this.$emit("on-close",K):this.$emit("on-close",K,this.name)},check(){if(!this.checkable)return;const K=!this.isChecked;this.isChecked=K,this.name===void 0?this.$emit("on-change",K):this.$emit("on-change",K,this.name)}},watch:{checked(K){this.isChecked=K}}};function J0(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),onClick:se[0]||(se[0]=E.withModifiers((...Xe)=>ve.check&&ve.check(...Xe),["stop"])),style:E.normalizeStyle(ve.wraperStyles)},[ve.showDot?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(ve.dotClasses),style:E.normalizeStyle(ve.bgColorStyle)},null,6)):E.createCommentVNode("",!0),E.createElementVNode("span",{class:E.normalizeClass(ve.textClasses),style:E.normalizeStyle(ve.textColorStyle)},[E.renderSlot(K.$slots,"default")],6),me.closable?(E.openBlock(),E.createBlock(Fe,{key:1,class:E.normalizeClass(ve.iconClass),color:ve.lineColor,type:"ios-close",onClick:E.withModifiers(ve.close,["stop"])},null,8,["class","color","onClick"])):E.createCommentVNode("",!0)],6)}var Ta=Y(Z0,[["render",J0]]),kd={11e4:{l:"Z1",n:"",c:"110000",p:"86"},12e4:{l:"Z1",n:"",c:"120000",p:"86"},13e4:{l:"H",n:"",c:"130000",p:"86"},14e4:{l:"S",n:"",c:"140000",p:"86"},15e4:{l:"N",n:"",c:"150000",p:"86"},21e4:{l:"L",n:"",c:"210000",p:"86"},22e4:{l:"J",n:"",c:"220000",p:"86"},23e4:{l:"H",n:"",c:"230000",p:"86"},31e4:{l:"Z1",n:"",c:"310000",p:"86"},32e4:{l:"J",n:"",c:"320000",p:"86"},33e4:{l:"Z",n:"",c:"330000",p:"86"},34e4:{l:"A",n:"",c:"340000",p:"86"},35e4:{l:"F",n:"",c:"350000",p:"86"},36e4:{l:"J",n:"",c:"360000",p:"86"},37e4:{l:"S",n:"",c:"370000",p:"86"},41e4:{l:"H",n:"",c:"410000",p:"86"},42e4:{l:"H",n:"",c:"420000",p:"86"},43e4:{l:"H",n:"",c:"430000",p:"86"},44e4:{l:"G",n:"",c:"440000",p:"86"},45e4:{l:"G",n:"",c:"450000",p:"86"},46e4:{l:"H",n:"",c:"460000",p:"86"},5e5:{l:"Z1",n:"",c:"500000",p:"86"},51e4:{l:"S",n:"",c:"510000",p:"86"},52e4:{l:"G",n:"",c:"520000",p:"86"},53e4:{l:"Y",n:"",c:"530000",p:"86"},54e4:{l:"X",n:"",c:"540000",p:"86"},61e4:{l:"S",n:"",c:"610000",p:"86"},62e4:{l:"G",n:"",c:"620000",p:"86"},63e4:{l:"Q",n:"",c:"630000",p:"86"},64e4:{l:"N",n:"",c:"640000",p:"86"},65e4:{l:"X",n:"",c:"650000",p:"86"},71e4:{l:"T",n:"",c:"710000",p:"86"},81e4:{l:"Z2",n:"",c:"810000",p:"86"},82e4:{l:"Z2",n:"",c:"820000",p:"86"}},Ea={11e4:{l:"B",n:"",c:"110000",p:"86"},12e4:{l:"T",n:"",c:"120000",p:"86"},130100:{l:"S",n:"",c:"130100",p:"130000"},130200:{l:"T",n:"",c:"130200",p:"130000"},130300:{l:"Q",n:"",c:"130300",p:"130000"},130400:{l:"H",n:"",c:"130400",p:"130000"},130500:{l:"X",n:"",c:"130500",p:"130000"},130600:{l:"B",n:"",c:"130600",p:"130000"},130700:{l:"Z",n:"",c:"130700",p:"130000"},130800:{l:"C",n:"",c:"130800",p:"130000"},130900:{l:"C",n:"",c:"130900",p:"130000"},131e3:{l:"L",n:"",c:"131000",p:"130000"},131100:{l:"H",n:"",c:"131100",p:"130000"},139001:{l:"D",n:"",c:"139001",p:"130000"},139002:{l:"X",n:"",c:"139002",p:"130000"},140100:{l:"T",n:"",c:"140100",p:"140000"},140200:{l:"D",n:"",c:"140200",p:"140000"},140300:{l:"Y",n:"",c:"140300",p:"140000"},140400:{l:"C",n:"",c:"140400",p:"140000"},140500:{l:"J",n:"",c:"140500",p:"140000"},140600:{l:"S",n:"",c:"140600",p:"140000"},140700:{l:"J",n:"",c:"140700",p:"140000"},140800:{l:"Y",n:"",c:"140800",p:"140000"},140900:{l:"X",n:"",c:"140900",p:"140000"},141e3:{l:"L",n:"",c:"141000",p:"140000"},141100:{l:"L",n:"",c:"141100",p:"140000"},150100:{l:"H",n:"",c:"150100",p:"150000"},150200:{l:"B",n:"",c:"150200",p:"150000"},150300:{l:"W",n:"",c:"150300",p:"150000"},150400:{l:"C",n:"",c:"150400",p:"150000"},150500:{l:"T",n:"",c:"150500",p:"150000"},150600:{l:"E",n:"",c:"150600",p:"150000"},150700:{l:"H",n:"",c:"150700",p:"150000"},150800:{l:"B",n:"",c:"150800",p:"150000"},150900:{l:"W",n:"",c:"150900",p:"150000"},152200:{l:"X",n:"",c:"152200",p:"150000"},152500:{l:"X",n:"",c:"152500",p:"150000"},152900:{l:"A",n:"",c:"152900",p:"150000"},210100:{l:"S",n:"",c:"210100",p:"210000"},210200:{l:"D",n:"",c:"210200",p:"210000"},210300:{l:"A",n:"",c:"210300",p:"210000"},210400:{l:"F",n:"",c:"210400",p:"210000"},210500:{l:"B",n:"",c:"210500",p:"210000"},210600:{l:"D",n:"",c:"210600",p:"210000"},210700:{l:"J",n:"",c:"210700",p:"210000"},210800:{l:"Y",n:"",c:"210800",p:"210000"},210900:{l:"F",n:"",c:"210900",p:"210000"},211e3:{l:"L",n:"",c:"211000",p:"210000"},211100:{l:"P",n:"",c:"211100",p:"210000"},211200:{l:"T",n:"",c:"211200",p:"210000"},211300:{l:"C",n:"",c:"211300",p:"210000"},211400:{l:"H",n:"",c:"211400",p:"210000"},220100:{l:"C",n:"",c:"220100",p:"220000"},220200:{l:"J",n:"",c:"220200",p:"220000"},220300:{l:"S",n:"",c:"220300",p:"220000"},220400:{l:"L",n:"",c:"220400",p:"220000"},220500:{l:"T",n:"",c:"220500",p:"220000"},220600:{l:"B",n:"",c:"220600",p:"220000"},220700:{l:"S",n:"",c:"220700",p:"220000"},220800:{l:"B",n:"",c:"220800",p:"220000"},222400:{l:"Y",n:"",c:"222400",p:"220000"},230100:{l:"H",n:"",c:"230100",p:"230000"},230200:{l:"Q",n:"",c:"230200",p:"230000"},230300:{l:"J",n:"",c:"230300",p:"230000"},230400:{l:"H",n:"",c:"230400",p:"230000"},230500:{l:"S",n:"",c:"230500",p:"230000"},230600:{l:"D",n:"",c:"230600",p:"230000"},230700:{l:"Y",n:"",c:"230700",p:"230000"},230800:{l:"J",n:"",c:"230800",p:"230000"},230900:{l:"Q",n:"",c:"230900",p:"230000"},231e3:{l:"M",n:"",c:"231000",p:"230000"},231100:{l:"H",n:"",c:"231100",p:"230000"},231200:{l:"S",n:"",c:"231200",p:"230000"},232700:{l:"D",n:"",c:"232700",p:"230000"},31e4:{l:"S",n:"",c:"310000",p:"86"},320100:{l:"N",n:"",c:"320100",p:"320000"},320200:{l:"W",n:"",c:"320200",p:"320000"},320300:{l:"X",n:"",c:"320300",p:"320000"},320400:{l:"C",n:"",c:"320400",p:"320000"},320500:{l:"S",n:"",c:"320500",p:"320000"},320600:{l:"N",n:"",c:"320600",p:"320000"},320700:{l:"L",n:"",c:"320700",p:"320000"},320800:{l:"H",n:"",c:"320800",p:"320000"},320900:{l:"Y",n:"",c:"320900",p:"320000"},321e3:{l:"Y",n:"",c:"321000",p:"320000"},321100:{l:"Z",n:"",c:"321100",p:"320000"},321200:{l:"T",n:"",c:"321200",p:"320000"},321300:{l:"X",n:"",c:"321300",p:"320000"},330100:{l:"H",n:"",c:"330100",p:"330000"},330200:{l:"N",n:"",c:"330200",p:"330000"},330300:{l:"W",n:"",c:"330300",p:"330000"},330400:{l:"J",n:"",c:"330400",p:"330000"},330500:{l:"H",n:"",c:"330500",p:"330000"},330600:{l:"S",n:"",c:"330600",p:"330000"},330700:{l:"J",n:"",c:"330700",p:"330000"},330800:{l:"Q",n:"",c:"330800",p:"330000"},330900:{l:"Z",n:"",c:"330900",p:"330000"},331e3:{l:"T",n:"",c:"331000",p:"330000"},331100:{l:"L",n:"",c:"331100",p:"330000"},340100:{l:"H",n:"",c:"340100",p:"340000"},340200:{l:"W",n:"",c:"340200",p:"340000"},340300:{l:"B",n:"",c:"340300",p:"340000"},340400:{l:"H",n:"",c:"340400",p:"340000"},340500:{l:"M",n:"",c:"340500",p:"340000"},340600:{l:"H",n:"",c:"340600",p:"340000"},340700:{l:"T",n:"",c:"340700",p:"340000"},340800:{l:"A",n:"",c:"340800",p:"340000"},341e3:{l:"H",n:"",c:"341000",p:"340000"},341100:{l:"C",n:"",c:"341100",p:"340000"},341200:{l:"F",n:"",c:"341200",p:"340000"},341300:{l:"X",n:"",c:"341300",p:"340000"},341500:{l:"L",n:"",c:"341500",p:"340000"},341600:{l:"B",n:"",c:"341600",p:"340000"},341700:{l:"C",n:"",c:"341700",p:"340000"},341800:{l:"X",n:"",c:"341800",p:"340000"},350100:{l:"F",n:"",c:"350100",p:"350000"},350200:{l:"S",n:"",c:"350200",p:"350000"},350300:{l:"P",n:"",c:"350300",p:"350000"},350400:{l:"S",n:"",c:"350400",p:"350000"},350500:{l:"Q",n:"",c:"350500",p:"350000"},350600:{l:"Z",n:"",c:"350600",p:"350000"},350700:{l:"N",n:"",c:"350700",p:"350000"},350800:{l:"L",n:"",c:"350800",p:"350000"},350900:{l:"N",n:"",c:"350900",p:"350000"},360100:{l:"N",n:"",c:"360100",p:"360000"},360200:{l:"J",n:"",c:"360200",p:"360000"},360300:{l:"P",n:"",c:"360300",p:"360000"},360400:{l:"J",n:"",c:"360400",p:"360000"},360500:{l:"X",n:"",c:"360500",p:"360000"},360600:{l:"Y",n:"",c:"360600",p:"360000"},360700:{l:"G",n:"",c:"360700",p:"360000"},360800:{l:"J",n:"",c:"360800",p:"360000"},360900:{l:"Y",n:"",c:"360900",p:"360000"},361e3:{l:"F",n:"",c:"361000",p:"360000"},361100:{l:"S",n:"",c:"361100",p:"360000"},370100:{l:"J",n:"",c:"370100",p:"370000"},370200:{l:"Q",n:"",c:"370200",p:"370000"},370300:{l:"Z",n:"",c:"370300",p:"370000"},370400:{l:"Z",n:"",c:"370400",p:"370000"},370500:{l:"D",n:"",c:"370500",p:"370000"},370600:{l:"Y",n:"",c:"370600",p:"370000"},370700:{l:"W",n:"",c:"370700",p:"370000"},370800:{l:"J",n:"",c:"370800",p:"370000"},370900:{l:"T",n:"",c:"370900",p:"370000"},371e3:{l:"W",n:"",c:"371000",p:"370000"},371100:{l:"R",n:"",c:"371100",p:"370000"},371200:{l:"L",n:"",c:"371200",p:"370000"},371300:{l:"L",n:"",c:"371300",p:"370000"},371400:{l:"D",n:"",c:"371400",p:"370000"},371500:{l:"L",n:"",c:"371500",p:"370000"},371600:{l:"B",n:"",c:"371600",p:"370000"},371700:{l:"H",n:"",c:"371700",p:"370000"},410100:{l:"Z",n:"",c:"410100",p:"410000"},410200:{l:"K",n:"",c:"410200",p:"410000"},410300:{l:"L",n:"",c:"410300",p:"410000"},410400:{l:"P",n:"",c:"410400",p:"410000"},410500:{l:"A",n:"",c:"410500",p:"410000"},410600:{l:"H",n:"",c:"410600",p:"410000"},410700:{l:"X",n:"",c:"410700",p:"410000"},410800:{l:"J",n:"",c:"410800",p:"410000"},410900:{l:"P",n:"",c:"410900",p:"410000"},411e3:{l:"X",n:"",c:"411000",p:"410000"},411100:{l:"L",n:"",c:"411100",p:"410000"},411200:{l:"S",n:"",c:"411200",p:"410000"},411300:{l:"N",n:"",c:"411300",p:"410000"},411400:{l:"S",n:"",c:"411400",p:"410000"},411500:{l:"X",n:"",c:"411500",p:"410000"},411600:{l:"Z",n:"",c:"411600",p:"410000"},411700:{l:"Z",n:"",c:"411700",p:"410000"},419001:{l:"J",n:"",c:"419001",p:"410000"},420100:{l:"W",n:"",c:"420100",p:"420000"},420200:{l:"H",n:"",c:"420200",p:"420000"},420300:{l:"S",n:"",c:"420300",p:"420000"},420500:{l:"Y",n:"",c:"420500",p:"420000"},420600:{l:"X",n:"",c:"420600",p:"420000"},420700:{l:"E",n:"",c:"420700",p:"420000"},420800:{l:"J",n:"",c:"420800",p:"420000"},420900:{l:"X",n:"",c:"420900",p:"420000"},421e3:{l:"J",n:"",c:"421000",p:"420000"},421100:{l:"H",n:"",c:"421100",p:"420000"},421200:{l:"X",n:"",c:"421200",p:"420000"},421300:{l:"S",n:"",c:"421300",p:"420000"},422800:{l:"E",n:"",c:"422800",p:"420000"},429004:{l:"X",n:"",c:"429004",p:"420000"},429005:{l:"Q",n:"",c:"429005",p:"420000"},429006:{l:"T",n:"",c:"429006",p:"420000"},429021:{l:"S",n:"",c:"429021",p:"420000"},430100:{l:"C",n:"",c:"430100",p:"430000"},430200:{l:"Z",n:"",c:"430200",p:"430000"},430300:{l:"X",n:"",c:"430300",p:"430000"},430400:{l:"H",n:"",c:"430400",p:"430000"},430500:{l:"S",n:"",c:"430500",p:"430000"},430600:{l:"Y",n:"",c:"430600",p:"430000"},430700:{l:"C",n:"",c:"430700",p:"430000"},430800:{l:"Z",n:"",c:"430800",p:"430000"},430900:{l:"Y",n:"",c:"430900",p:"430000"},431e3:{l:"C",n:"",c:"431000",p:"430000"},431100:{l:"Y",n:"",c:"431100",p:"430000"},431200:{l:"H",n:"",c:"431200",p:"430000"},431300:{l:"L",n:"",c:"431300",p:"430000"},433100:{l:"X",n:"",c:"433100",p:"430000"},440100:{l:"G",n:"",c:"440100",p:"440000"},440200:{l:"S",n:"",c:"440200",p:"440000"},440300:{l:"S",n:"",c:"440300",p:"440000"},440400:{l:"Z",n:"",c:"440400",p:"440000"},440500:{l:"S",n:"",c:"440500",p:"440000"},440600:{l:"F",n:"",c:"440600",p:"440000"},440700:{l:"J",n:"",c:"440700",p:"440000"},440800:{l:"Z",n:"",c:"440800",p:"440000"},440900:{l:"M",n:"",c:"440900",p:"440000"},441200:{l:"Z",n:"",c:"441200",p:"440000"},441300:{l:"H",n:"",c:"441300",p:"440000"},441400:{l:"M",n:"",c:"441400",p:"440000"},441500:{l:"S",n:"",c:"441500",p:"440000"},441600:{l:"H",n:"",c:"441600",p:"440000"},441700:{l:"Y",n:"",c:"441700",p:"440000"},441800:{l:"Q",n:"",c:"441800",p:"440000"},441900:{l:"D",n:"",c:"441900",p:"440000"},442e3:{l:"Z",n:"",c:"442000",p:"440000"},445100:{l:"C",n:"",c:"445100",p:"440000"},445200:{l:"J",n:"",c:"445200",p:"440000"},445300:{l:"Y",n:"",c:"445300",p:"440000"},450100:{l:"N",n:"",c:"450100",p:"450000"},450200:{l:"L",n:"",c:"450200",p:"450000"},450300:{l:"G",n:"",c:"450300",p:"450000"},450400:{l:"W",n:"",c:"450400",p:"450000"},450500:{l:"B",n:"",c:"450500",p:"450000"},450600:{l:"F",n:"",c:"450600",p:"450000"},450700:{l:"Q",n:"",c:"450700",p:"450000"},450800:{l:"G",n:"",c:"450800",p:"450000"},450900:{l:"Y",n:"",c:"450900",p:"450000"},451e3:{l:"B",n:"",c:"451000",p:"450000"},451100:{l:"H",n:"",c:"451100",p:"450000"},451200:{l:"H",n:"",c:"451200",p:"450000"},451300:{l:"L",n:"",c:"451300",p:"450000"},451400:{l:"C",n:"",c:"451400",p:"450000"},460100:{l:"H",n:"",c:"460100",p:"460000"},460200:{l:"S",n:"",c:"460200",p:"460000"},460300:{l:"S",n:"",c:"460300",p:"460000"},460400:{l:"D",n:"",c:"460400",p:"460000"},469001:{l:"W",n:"",c:"469001",p:"460000"},469002:{l:"Q",n:"",c:"469002",p:"460000"},469005:{l:"W",n:"",c:"469005",p:"460000"},469006:{l:"W",n:"",c:"469006",p:"460000"},469007:{l:"D",n:"",c:"469007",p:"460000"},469021:{l:"D",n:"",c:"469021",p:"460000"},469022:{l:"T",n:"",c:"469022",p:"460000"},469023:{l:"C",n:"",c:"469023",p:"460000"},469024:{l:"L",n:"",c:"469024",p:"460000"},469025:{l:"B",n:"",c:"469025",p:"460000"},469026:{l:"C",n:"",c:"469026",p:"460000"},469027:{l:"L",n:"",c:"469027",p:"460000"},469028:{l:"L",n:"",c:"469028",p:"460000"},469029:{l:"B",n:"",c:"469029",p:"460000"},469030:{l:"Q",n:"",c:"469030",p:"460000"},5e5:{l:"C",n:"",c:"500000",p:"86"},510100:{l:"C",n:"",c:"510100",p:"510000"},510300:{l:"Z",n:"",c:"510300",p:"510000"},510400:{l:"P",n:"",c:"510400",p:"510000"},510500:{l:"L",n:"",c:"510500",p:"510000"},510600:{l:"D",n:"",c:"510600",p:"510000"},510700:{l:"M",n:"",c:"510700",p:"510000"},510800:{l:"G",n:"",c:"510800",p:"510000"},510900:{l:"S",n:"",c:"510900",p:"510000"},511e3:{l:"N",n:"",c:"511000",p:"510000"},511100:{l:"L",n:"",c:"511100",p:"510000"},511300:{l:"N",n:"",c:"511300",p:"510000"},511400:{l:"M",n:"",c:"511400",p:"510000"},511500:{l:"Y",n:"",c:"511500",p:"510000"},511600:{l:"G",n:"",c:"511600",p:"510000"},511700:{l:"D",n:"",c:"511700",p:"510000"},511800:{l:"Y",n:"",c:"511800",p:"510000"},511900:{l:"B",n:"",c:"511900",p:"510000"},512e3:{l:"Z",n:"",c:"512000",p:"510000"},513200:{l:"A",n:"",c:"513200",p:"510000"},513300:{l:"G",n:"",c:"513300",p:"510000"},513400:{l:"L",n:"",c:"513400",p:"510000"},520100:{l:"G",n:"",c:"520100",p:"520000"},520200:{l:"L",n:"",c:"520200",p:"520000"},520300:{l:"Z",n:"",c:"520300",p:"520000"},520400:{l:"A",n:"",c:"520400",p:"520000"},520500:{l:"B",n:"",c:"520500",p:"520000"},520600:{l:"T",n:"",c:"520600",p:"520000"},522300:{l:"Q",n:"",c:"522300",p:"520000"},522600:{l:"Q",n:"",c:"522600",p:"520000"},522700:{l:"Q",n:"",c:"522700",p:"520000"},530100:{l:"K",n:"",c:"530100",p:"530000"},530300:{l:"Q",n:"",c:"530300",p:"530000"},530400:{l:"Y",n:"",c:"530400",p:"530000"},530500:{l:"B",n:"",c:"530500",p:"530000"},530600:{l:"Z",n:"",c:"530600",p:"530000"},530700:{l:"L",n:"",c:"530700",p:"530000"},530800:{l:"P",n:"",c:"530800",p:"530000"},530900:{l:"L",n:"",c:"530900",p:"530000"},532300:{l:"C",n:"",c:"532300",p:"530000"},532500:{l:"H",n:"",c:"532500",p:"530000"},532600:{l:"W",n:"",c:"532600",p:"530000"},532800:{l:"X",n:"",c:"532800",p:"530000"},532900:{l:"D",n:"",c:"532900",p:"530000"},533100:{l:"D",n:"",c:"533100",p:"530000"},533300:{l:"N",n:"",c:"533300",p:"530000"},533400:{l:"D",n:"",c:"533400",p:"530000"},540100:{l:"L",n:"",c:"540100",p:"540000"},540200:{l:"R",n:"",c:"540200",p:"540000"},540300:{l:"C",n:"",c:"540300",p:"540000"},540400:{l:"L",n:"",c:"540400",p:"540000"},540500:{l:"S",n:"",c:"540500",p:"540000"},542400:{l:"N",n:"",c:"542400",p:"540000"},542500:{l:"A",n:"",c:"542500",p:"540000"},610100:{l:"X",n:"",c:"610100",p:"610000"},610200:{l:"T",n:"",c:"610200",p:"610000"},610300:{l:"B",n:"",c:"610300",p:"610000"},610400:{l:"X",n:"",c:"610400",p:"610000"},610500:{l:"W",n:"",c:"610500",p:"610000"},610600:{l:"Y",n:"",c:"610600",p:"610000"},610700:{l:"H",n:"",c:"610700",p:"610000"},610800:{l:"Y",n:"",c:"610800",p:"610000"},610900:{l:"A",n:"",c:"610900",p:"610000"},611e3:{l:"S",n:"",c:"611000",p:"610000"},620100:{l:"L",n:"",c:"620100",p:"620000"},620200:{l:"J",n:"",c:"620200",p:"620000"},620300:{l:"J",n:"",c:"620300",p:"620000"},620400:{l:"B",n:"",c:"620400",p:"620000"},620500:{l:"T",n:"",c:"620500",p:"620000"},620600:{l:"W",n:"",c:"620600",p:"620000"},620700:{l:"Z",n:"",c:"620700",p:"620000"},620800:{l:"P",n:"",c:"620800",p:"620000"},620900:{l:"J",n:"",c:"620900",p:"620000"},621e3:{l:"Q",n:"",c:"621000",p:"620000"},621100:{l:"D",n:"",c:"621100",p:"620000"},621200:{l:"L",n:"",c:"621200",p:"620000"},622900:{l:"L",n:"",c:"622900",p:"620000"},623e3:{l:"G",n:"",c:"623000",p:"620000"},630100:{l:"X",n:"",c:"630100",p:"630000"},630200:{l:"H",n:"",c:"630200",p:"630000"},632200:{l:"H",n:"",c:"632200",p:"630000"},632300:{l:"H",n:"",c:"632300",p:"630000"},632500:{l:"H",n:"",c:"632500",p:"630000"},632600:{l:"G",n:"",c:"632600",p:"630000"},632700:{l:"Y",n:"",c:"632700",p:"630000"},632800:{l:"H",n:"",c:"632800",p:"630000"},640100:{l:"Y",n:"",c:"640100",p:"640000"},640200:{l:"S",n:"",c:"640200",p:"640000"},640300:{l:"W",n:"",c:"640300",p:"640000"},640400:{l:"G",n:"",c:"640400",p:"640000"},640500:{l:"Z",n:"",c:"640500",p:"640000"},650100:{l:"W",n:"",c:"650100",p:"650000"},650200:{l:"K",n:"",c:"650200",p:"650000"},650400:{l:"T",n:"",c:"650400",p:"650000"},650500:{l:"H",n:"",c:"650500",p:"650000"},652300:{l:"C",n:"",c:"652300",p:"650000"},652700:{l:"B",n:"",c:"652700",p:"650000"},652800:{l:"B",n:"",c:"652800",p:"650000"},652900:{l:"A",n:"",c:"652900",p:"650000"},653e3:{l:"K",n:"",c:"653000",p:"650000"},653100:{l:"K",n:"",c:"653100",p:"650000"},653200:{l:"H",n:"",c:"653200",p:"650000"},654e3:{l:"Y",n:"",c:"654000",p:"650000"},654200:{l:"T",n:"",c:"654200",p:"650000"},654300:{l:"A",n:"",c:"654300",p:"650000"},659001:{l:"S",n:"",c:"659001",p:"650000"},659002:{l:"A",n:"",c:"659002",p:"650000"},659003:{l:"T",n:"",c:"659003",p:"650000"},659004:{l:"W",n:"",c:"659004",p:"650000"},659006:{l:"T",n:"",c:"659006",p:"650000"},710101:{l:"J",n:"",c:"710101",p:"710000"},710102:{l:"L",n:"",c:"710102",p:"710000"},710103:{l:"M",n:"",c:"710103",p:"710000"},710104:{l:"N",n:"",c:"710104",p:"710000"},710105:{l:"P",n:"",c:"710105",p:"710000"},710106:{l:"P",n:"",c:"710106",p:"710000"},710107:{l:"T",n:"",c:"710107",p:"710000"},710108:{l:"T",n:"",c:"710108",p:"710000"},710109:{l:"T",n:"",c:"710109",p:"710000"},710110:{l:"T",n:"",c:"710110",p:"710000"},710111:{l:"T",n:"",c:"710111",p:"710000"},710112:{l:"Y",n:"",c:"710112",p:"710000"},710113:{l:"X",n:"",c:"710113",p:"710000"},710114:{l:"Z",n:"",c:"710114",p:"710000"},710115:{l:"J",n:"",c:"710115",p:"710000"},710116:{l:"X",n:"",c:"710116",p:"710000"},710117:{l:"H",n:"",c:"710117",p:"710000"},710118:{l:"Y",n:"",c:"710118",p:"710000"},710119:{l:"G",n:"",c:"710119",p:"710000"},710120:{l:"J",n:"",c:"710120",p:"710000"},81e4:{l:"X",n:"",c:"810000",p:"86"},82e4:{l:"A",n:"",c:"820000",p:"86"}};function ml(K){return K.replace("","").replace("","").replace("","")}function ev(){const K=Qe(Ea),se=[];for(let me in K){const Be=K[me];Be.n=ml(Be.n),se.push(Be)}return se}function Id(K,se){if(!se)return"";const me=K.find(Be=>Be.n===se);return me?me.c:(console.error("[View UI warn]: City name error."),"")}function tv(K,se){return K.find(me=>me.c===se).n}const rv={name:"City",mixins:[In],components:{Dropdown:ca,DropdownMenu:ua,Select:Es,Option:ss,Tag:Ta,Icon:Ae,RadioGroup:Kl,Radio:Zl},emits:["on-change","update:modelValue"],props:{modelValue:{type:String},useName:{type:Boolean,default:!1},cities:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showSuffix:{type:Boolean,default:!1},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},placeholder:{type:String,default:""},searchPlaceholder:{type:String,default:""},transferClassName:{type:String}},data(){const K=ev();return{currentValue:this.useName?Id(K,this.modelValue):this.modelValue,visible:!1,provinceList:[],cityListByProvince:[],cityListByLetter:{},allCities:K,listType:"province",queryCity:""}},watch:{modelValue(K){const se=this.useName?Id(this.allCities,K):K;this.currentValue=se}},computed:{showCloseIcon(){return this.currentValue&&this.clearable&&!this.itemDisabled},classes(){return[{"ivu-city-show-clear":this.showCloseIcon,[`ivu-city-size-${this.size}`]:!!this.size,"ivu-city-visible":this.visible,"ivu-city-disabled":this.itemDisabled}]},transferClasses(){let K="ivu-city-transfer";return this.transferClassName&&(K+=` ${this.transferClassName}`),K},relCities(){const K=[];return this.cities.length&&this.cities.forEach(se=>{const me=Ea[se];me.n=ml(me.n),K.push(me)}),K},codeToName(){if(!this.currentValue)return this.placeholder;const K=Ea[this.currentValue].n;return this.showSuffix?K:ml(K)}},methods:{handleSelect(K){K&&(this.handleChangeValue(K),E.nextTick(()=>{this.queryCity=""}))},handleChangeValue(K){this.currentValue=K,this.visible=!1;const se=this.useName?tv(this.allCities,K):K;this.$emit("update:modelValue",se),this.$emit("on-change",Ea[K]),this.handleFormItemChange("change",K)},handleClickLetter(K){let se=K;se===""?se="Z1":se===""&&(se="Z2");const me=`.ivu-city-${se}`,Be=this.$refs.list,Re=Be.querySelectorAll(me)[0].offsetTop,ve=Be.offsetTop;Be.scrollTop=Re-ve},clearSelect(){if(this.itemDisabled)return!1},handleToggleOpen(){if(this.itemDisabled)return!1;this.visible=!this.visible},handleVisibleChange(K){this.visible=K},handleClickOutside(K){this.$refs.city.contains(K.target)||(this.visible=!1)},handleGetProvinceByLetter(){const K={A:{n:"A",p:[],c:[]},F:{n:"F",p:[],c:[]},G:{n:"G",p:[],c:[]},H:{n:"H",p:[],c:[]},J:{n:"J",p:[],c:[]},L:{n:"L",p:[],c:[]},N:{n:"N",p:[],c:[]},Q:{n:"Q",p:[],c:[]},S:{n:"S",p:[],c:[]},T:{n:"T",p:[],c:[]},X:{n:"X",p:[],c:[]},Y:{n:"Y",p:[],c:[]},Z:{n:"Z",p:[],c:[]},Z1:{n:"",p:[],c:[]},Z2:{n:"",p:[],c:[]}};for(let se in kd){const me=kd[se];K[me.l].p.push(me)}this.provinceList=K},handleGetCityByProvince(){const K=Qe(this.provinceList),se=[],me=Qe(Ea),Be=[{p:{n:"",p:"86",l:"Z1"},c:[]},{p:{n:"",p:"86",l:"Z2"},c:[]}];for(let Re in K){const ve=K[Re];for(let Fe=0;Fe<ve.p.length;Fe++){const Xe=ve.p[Fe],tt=Xe.c,Ze={p:Xe,c:[]};for(let it in me){const nr=me[it];nr.n=ml(nr.n),tt===nr.p&&Ze.c.push(nr)}Re==="Z1"?Be[0].c.push(me[tt]):Re==="Z2"?Be[1].c.push(me[tt]):se.push(Ze)}}this.cityListByProvince=se.concat(Be)},handleGetCityByLetter(){const K=Qe(Ea),se={A:[],B:[],C:[],D:[],E:[],F:[],G:[],H:[],J:[],K:[],L:[],M:[],N:[],P:[],Q:[],R:[],S:[],T:[],W:[],X:[],Y:[],Z:[]};for(let me in K){const Be=K[me];Be.n=ml(Be.n),se[Be.l].push(Be)}this.cityListByLetter=se}},created(){this.handleGetProvinceByLetter(),this.handleGetCityByProvince(),this.handleGetCityByLetter()}},iv=["name","value"],nv={class:"ivu-city-drop"},sv={key:0,class:"ivu-city-drop-cities"},ov=["onClick"],av={class:"ivu-city-drop-menu"},lv={class:"ivu-city-drop-type"},cv={class:"ivu-city-drop-search"},uv={key:1,class:"ivu-city-drop-list"},hv={class:"ivu-city-drop-list-letter"},pv={class:"ivu-city-drop-list-main",ref:"list"},fv=["onClick"],mv={key:2,class:"ivu-city-drop-list"},gv={class:"ivu-city-drop-list-letter"},yv={class:"ivu-city-drop-list-main ivu-city-drop-list-main-city",ref:"list"},_v=["onClick"];function vv(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Radio"),tt=E.resolveComponent("RadioGroup"),Ze=E.resolveComponent("Option"),it=E.resolveComponent("Select"),nr=E.resolveComponent("Tag"),jr=E.resolveComponent("DropdownMenu"),zr=E.resolveComponent("Dropdown");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-city",ve.classes]),ref:"city"},[E.createVNode(zr,{trigger:"custom",visible:Re.visible,transfer:me.transfer,placement:"bottom-start","transfer-class-name":ve.transferClasses,onOnVisibleChange:ve.handleVisibleChange,onOnClickoutside:ve.handleClickOutside},{list:E.withCtx(()=>[E.createVNode(jr,{onClick:se[3]||(se[3]=E.withModifiers(()=>{},["stop"]))},{default:E.withCtx(()=>[E.createElementVNode("div",nv,[me.cities.length?(E.openBlock(),E.createElementBlock("div",sv,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.relCities,Fr=>(E.openBlock(),E.createElementBlock("span",{key:Fr.n,onClick:_t=>ve.handleChangeValue(Fr.c)},E.toDisplayString(Fr.n),9,ov))),128))])):E.createCommentVNode("",!0),E.createElementVNode("div",av,[E.createElementVNode("div",lv,[E.createVNode(tt,{modelValue:Re.listType,"onUpdate:modelValue":se[1]||(se[1]=Fr=>Re.listType=Fr),type:"button",size:"small"},{default:E.withCtx(()=>[E.createVNode(Xe,{label:"province"},{default:E.withCtx(()=>[E.createTextVNode("")]),_:1}),E.createVNode(Xe,{label:"city"},{default:E.withCtx(()=>[E.createTextVNode("")]),_:1})]),_:1},8,["modelValue"])]),E.createElementVNode("div",cv,[E.createVNode(it,{modelValue:Re.queryCity,"onUpdate:modelValue":se[2]||(se[2]=Fr=>Re.queryCity=Fr),filterable:"",size:"small",transfer:"",placeholder:me.searchPlaceholder,onOnChange:ve.handleSelect},{default:E.withCtx(()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.allCities,Fr=>(E.openBlock(),E.createBlock(Ze,{value:Fr.c,key:Fr.c},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(Fr.n),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","placeholder","onOnChange"])])]),Re.listType==="province"?(E.openBlock(),E.createElementBlock("div",uv,[E.createElementVNode("div",hv,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.provinceList,Fr=>(E.openBlock(),E.createBlock(nr,{onClick:_t=>ve.handleClickLetter(Fr.n),type:"border",fade:!1,key:Fr.n},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(Fr.n),1)]),_:2},1032,["onClick"]))),128))]),E.createElementVNode("div",pv,[E.createElementVNode("dl",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.cityListByProvince,Fr=>(E.openBlock(),E.createElementBlock(E.Fragment,{key:Fr.p.n},[E.createElementVNode("dt",{class:E.normalizeClass("ivu-city-"+Fr.p.l)},E.toDisplayString(Fr.p.n)+"",3),E.createElementVNode("dd",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Fr.c,_t=>(E.openBlock(),E.createElementBlock("li",{key:_t.n,onClick:ni=>ve.handleChangeValue(_t.c)},E.toDisplayString(_t.n),9,fv))),128))])],64))),128))])],512)])):E.createCommentVNode("",!0),Re.listType==="city"?(E.openBlock(),E.createElementBlock("div",mv,[E.createElementVNode("div",gv,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.cityListByLetter,(Fr,_t)=>(E.openBlock(),E.createBlock(nr,{onClick:ni=>ve.handleClickLetter(_t),type:"border",fade:!1,key:_t},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(_t),1)]),_:2},1032,["onClick"]))),128))]),E.createElementVNode("div",yv,[E.createElementVNode("dl",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.cityListByLetter,(Fr,_t)=>(E.openBlock(),E.createElementBlock(E.Fragment,{key:_t},[E.createElementVNode("dt",{class:E.normalizeClass("ivu-city-"+_t)},E.toDisplayString(_t)+"",3),E.createElementVNode("dd",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Fr,ni=>(E.openBlock(),E.createElementBlock("li",{key:ni.n,onClick:on=>ve.handleChangeValue(ni.c)},E.toDisplayString(ni.n),9,_v))),128))])],64))),128))])],512)])):E.createCommentVNode("",!0)])]),_:1})]),default:E.withCtx(()=>[E.createElementVNode("div",{class:"ivu-city-rel",onClick:se[0]||(se[0]=E.withModifiers((...Fr)=>ve.handleToggleOpen&&ve.handleToggleOpen(...Fr),["prevent","stop"]))},[E.createElementVNode("input",{type:"hidden",name:me.name,value:Re.currentValue},null,8,iv),E.renderSlot(K.$slots,"default",{},()=>[E.createElementVNode("span",null,E.toDisplayString(ve.codeToName),1),E.withDirectives(E.createVNode(Fe,{type:"ios-close-circle",class:"ivu-city-arrow",onClick:E.withModifiers(ve.clearSelect,["stop"])},null,8,["onClick"]),[[E.vShow,ve.showCloseIcon]]),E.createVNode(Fe,{type:"ios-arrow-down",class:"ivu-city-arrow"})])])]),_:3},8,["visible","transfer","transfer-class-name","onOnVisibleChange","onOnClickoutside"])],2)}var Bd=Y(rv,[["render",vv]]);const Vd="ivu-collapse",bv={name:"Collapse",emits:["on-change","update:modelValue"],provide(){return{CollapseInstance:this}},props:{accordion:{type:Boolean,default:!1},modelValue:{type:[Array,String]},simple:{type:Boolean,default:!1}},data(){return{currentValue:this.modelValue,panelCount:0}},computed:{classes(){return[`${Vd}`,{[`${Vd}-simple`]:this.simple}]}},methods:{getActiveKey(){let K=this.currentValue||[];const se=this.accordion;Array.isArray(K)||(K=[K]),se&&K.length>1&&(K=[K[0]]);for(let me=0;me<K.length;me++)K[me]=K[me].toString();return K},toggle(K){const se=K.name.toString();let me=[];if(this.accordion)K.isActive||me.push(se);else{let Be=this.getActiveKey();const Re=Be.indexOf(se);K.isActive?Re>-1&&Be.splice(Re,1):Re<0&&Be.push(se),me=Be}this.currentValue=me,this.$emit("update:modelValue",me),this.$emit("on-change",me)}},watch:{modelValue(K){this.currentValue=K}}};function xv(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.renderSlot(K.$slots,"default")],2)}var Dd=Y(bv,[["render",xv]]);function nc(K){return nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(se){return typeof se}:function(se){return se&&typeof Symbol=="function"&&se.constructor===Symbol&&se!==Symbol.prototype?"symbol":typeof se},nc(K)}var Sv=/^\s+/,wv=/\s+$/;function sn(K,se){if(K=K||"",se=se||{},K instanceof sn)return K;if(!(this instanceof sn))return new sn(K,se);var me=Ov(K);this._originalInput=K,this._r=me.r,this._g=me.g,this._b=me.b,this._a=me.a,this._roundA=Math.round(100*this._a)/100,this._format=se.format||me.format,this._gradientType=se.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=me.ok}sn.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var K=this.toRgb();return(K.r*299+K.g*587+K.b*114)/1e3},getLuminance:function(){var K=this.toRgb(),se,me,Be,Re,ve,Fe;return se=K.r/255,me=K.g/255,Be=K.b/255,se<=.03928?Re=se/12.92:Re=Math.pow((se+.055)/1.055,2.4),me<=.03928?ve=me/12.92:ve=Math.pow((me+.055)/1.055,2.4),Be<=.03928?Fe=Be/12.92:Fe=Math.pow((Be+.055)/1.055,2.4),.2126*Re+.7152*ve+.0722*Fe},setAlpha:function(K){return this._a=zd(K),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var K=$d(this._r,this._g,this._b);return{h:K.h*360,s:K.s,v:K.v,a:this._a}},toHsvString:function(){var K=$d(this._r,this._g,this._b),se=Math.round(K.h*360),me=Math.round(K.s*100),Be=Math.round(K.v*100);return this._a==1?"hsv("+se+", "+me+"%, "+Be+"%)":"hsva("+se+", "+me+"%, "+Be+"%, "+this._roundA+")"},toHsl:function(){var K=Nd(this._r,this._g,this._b);return{h:K.h*360,s:K.s,l:K.l,a:this._a}},toHslString:function(){var K=Nd(this._r,this._g,this._b),se=Math.round(K.h*360),me=Math.round(K.s*100),Be=Math.round(K.l*100);return this._a==1?"hsl("+se+", "+me+"%, "+Be+"%)":"hsla("+se+", "+me+"%, "+Be+"%, "+this._roundA+")"},toHex:function(K){return Ld(this._r,this._g,this._b,K)},toHexString:function(K){return"#"+this.toHex(K)},toHex8:function(K){return Av(this._r,this._g,this._b,this._a,K)},toHex8String:function(K){return"#"+this.toHex8(K)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(ts(this._r,255)*100)+"%",g:Math.round(ts(this._g,255)*100)+"%",b:Math.round(ts(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(ts(this._r,255)*100)+"%, "+Math.round(ts(this._g,255)*100)+"%, "+Math.round(ts(this._b,255)*100)+"%)":"rgba("+Math.round(ts(this._r,255)*100)+"%, "+Math.round(ts(this._g,255)*100)+"%, "+Math.round(ts(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:Fv[Ld(this._r,this._g,this._b,!0)]||!1},toFilter:function(K){var se="#"+Fd(this._r,this._g,this._b,this._a),me=se,Be=this._gradientType?"GradientType = 1, ":"";if(K){var Re=sn(K);me="#"+Fd(Re._r,Re._g,Re._b,Re._a)}return"progid:DXImageTransform.Microsoft.gradient("+Be+"startColorstr="+se+",endColorstr="+me+")"},toString:function(K){var se=!!K;K=K||this._format;var me=!1,Be=this._a<1&&this._a>=0,Re=!se&&Be&&(K==="hex"||K==="hex6"||K==="hex3"||K==="hex4"||K==="hex8"||K==="name");return Re?K==="name"&&this._a===0?this.toName():this.toRgbString():(K==="rgb"&&(me=this.toRgbString()),K==="prgb"&&(me=this.toPercentageRgbString()),(K==="hex"||K==="hex6")&&(me=this.toHexString()),K==="hex3"&&(me=this.toHexString(!0)),K==="hex4"&&(me=this.toHex8String(!0)),K==="hex8"&&(me=this.toHex8String()),K==="name"&&(me=this.toName()),K==="hsl"&&(me=this.toHslString()),K==="hsv"&&(me=this.toHsvString()),me||this.toHexString())},clone:function(){return sn(this.toString())},_applyModification:function(K,se){var me=K.apply(null,[this].concat([].slice.call(se)));return this._r=me._r,this._g=me._g,this._b=me._b,this.setAlpha(me._a),this},lighten:function(){return this._applyModification(kv,arguments)},brighten:function(){return this._applyModification(Iv,arguments)},darken:function(){return this._applyModification(Bv,arguments)},desaturate:function(){return this._applyModification(Mv,arguments)},saturate:function(){return this._applyModification(Pv,arguments)},greyscale:function(){return this._applyModification(Rv,arguments)},spin:function(){return this._applyModification(Vv,arguments)},_applyCombination:function(K,se){return K.apply(null,[this].concat([].slice.call(se)))},analogous:function(){return this._applyCombination($v,arguments)},complement:function(){return this._applyCombination(Dv,arguments)},monochromatic:function(){return this._applyCombination(Lv,arguments)},splitcomplement:function(){return this._applyCombination(Nv,arguments)},triad:function(){return this._applyCombination(Ud,[3])},tetrad:function(){return this._applyCombination(Ud,[4])}},sn.fromRatio=function(K,se){if(nc(K)=="object"){var me={};for(var Be in K)K.hasOwnProperty(Be)&&(Be==="a"?me[Be]=K[Be]:me[Be]=gl(K[Be]));K=me}return sn(K,se)};function Ov(K){var se={r:0,g:0,b:0},me=1,Be=null,Re=null,ve=null,Fe=!1,Xe=!1;return typeof K=="string"&&(K=Gv(K)),nc(K)=="object"&&(Mo(K.r)&&Mo(K.g)&&Mo(K.b)?(se=Cv(K.r,K.g,K.b),Fe=!0,Xe=String(K.r).substr(-1)==="%"?"prgb":"rgb"):Mo(K.h)&&Mo(K.s)&&Mo(K.v)?(Be=gl(K.s),Re=gl(K.v),se=Ev(K.h,Be,Re),Fe=!0,Xe="hsv"):Mo(K.h)&&Mo(K.s)&&Mo(K.l)&&(Be=gl(K.s),ve=gl(K.l),se=Tv(K.h,Be,ve),Fe=!0,Xe="hsl"),K.hasOwnProperty("a")&&(me=K.a)),me=zd(me),{ok:Fe,format:K.format||Xe,r:Math.min(255,Math.max(se.r,0)),g:Math.min(255,Math.max(se.g,0)),b:Math.min(255,Math.max(se.b,0)),a:me}}function Cv(K,se,me){return{r:ts(K,255)*255,g:ts(se,255)*255,b:ts(me,255)*255}}function Nd(K,se,me){K=ts(K,255),se=ts(se,255),me=ts(me,255);var Be=Math.max(K,se,me),Re=Math.min(K,se,me),ve,Fe,Xe=(Be+Re)/2;if(Be==Re)ve=Fe=0;else{var tt=Be-Re;switch(Fe=Xe>.5?tt/(2-Be-Re):tt/(Be+Re),Be){case K:ve=(se-me)/tt+(se<me?6:0);break;case se:ve=(me-K)/tt+2;break;case me:ve=(K-se)/tt+4;break}ve/=6}return{h:ve,s:Fe,l:Xe}}function Tv(K,se,me){var Be,Re,ve;K=ts(K,360),se=ts(se,100),me=ts(me,100);function Fe(Ze,it,nr){return nr<0&&(nr+=1),nr>1&&(nr-=1),nr<1/6?Ze+(it-Ze)*6*nr:nr<1/2?it:nr<2/3?Ze+(it-Ze)*(2/3-nr)*6:Ze}if(se===0)Be=Re=ve=me;else{var Xe=me<.5?me*(1+se):me+se-me*se,tt=2*me-Xe;Be=Fe(tt,Xe,K+1/3),Re=Fe(tt,Xe,K),ve=Fe(tt,Xe,K-1/3)}return{r:Be*255,g:Re*255,b:ve*255}}function $d(K,se,me){K=ts(K,255),se=ts(se,255),me=ts(me,255);var Be=Math.max(K,se,me),Re=Math.min(K,se,me),ve,Fe,Xe=Be,tt=Be-Re;if(Fe=Be===0?0:tt/Be,Be==Re)ve=0;else{switch(Be){case K:ve=(se-me)/tt+(se<me?6:0);break;case se:ve=(me-K)/tt+2;break;case me:ve=(K-se)/tt+4;break}ve/=6}return{h:ve,s:Fe,v:Xe}}function Ev(K,se,me){K=ts(K,360)*6,se=ts(se,100),me=ts(me,100);var Be=Math.floor(K),Re=K-Be,ve=me*(1-se),Fe=me*(1-Re*se),Xe=me*(1-(1-Re)*se),tt=Be%6,Ze=[me,Fe,ve,ve,Xe,me][tt],it=[Xe,me,me,Fe,ve,ve][tt],nr=[ve,ve,Xe,me,me,Fe][tt];return{r:Ze*255,g:it*255,b:nr*255}}function Ld(K,se,me,Be){var Re=[no(Math.round(K).toString(16)),no(Math.round(se).toString(16)),no(Math.round(me).toString(16))];return Be&&Re[0].charAt(0)==Re[0].charAt(1)&&Re[1].charAt(0)==Re[1].charAt(1)&&Re[2].charAt(0)==Re[2].charAt(1)?Re[0].charAt(0)+Re[1].charAt(0)+Re[2].charAt(0):Re.join("")}function Av(K,se,me,Be,Re){var ve=[no(Math.round(K).toString(16)),no(Math.round(se).toString(16)),no(Math.round(me).toString(16)),no(Wd(Be))];return Re&&ve[0].charAt(0)==ve[0].charAt(1)&&ve[1].charAt(0)==ve[1].charAt(1)&&ve[2].charAt(0)==ve[2].charAt(1)&&ve[3].charAt(0)==ve[3].charAt(1)?ve[0].charAt(0)+ve[1].charAt(0)+ve[2].charAt(0)+ve[3].charAt(0):ve.join("")}function Fd(K,se,me,Be){var Re=[no(Wd(Be)),no(Math.round(K).toString(16)),no(Math.round(se).toString(16)),no(Math.round(me).toString(16))];return Re.join("")}sn.equals=function(K,se){return!K||!se?!1:sn(K).toRgbString()==sn(se).toRgbString()},sn.random=function(){return sn.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function Mv(K,se){se=se===0?0:se||10;var me=sn(K).toHsl();return me.s-=se/100,me.s=sc(me.s),sn(me)}function Pv(K,se){se=se===0?0:se||10;var me=sn(K).toHsl();return me.s+=se/100,me.s=sc(me.s),sn(me)}function Rv(K){return sn(K).desaturate(100)}function kv(K,se){se=se===0?0:se||10;var me=sn(K).toHsl();return me.l+=se/100,me.l=sc(me.l),sn(me)}function Iv(K,se){se=se===0?0:se||10;var me=sn(K).toRgb();return me.r=Math.max(0,Math.min(255,me.r-Math.round(255*-(se/100)))),me.g=Math.max(0,Math.min(255,me.g-Math.round(255*-(se/100)))),me.b=Math.max(0,Math.min(255,me.b-Math.round(255*-(se/100)))),sn(me)}function Bv(K,se){se=se===0?0:se||10;var me=sn(K).toHsl();return me.l-=se/100,me.l=sc(me.l),sn(me)}function Vv(K,se){var me=sn(K).toHsl(),Be=(me.h+se)%360;return me.h=Be<0?360+Be:Be,sn(me)}function Dv(K){var se=sn(K).toHsl();return se.h=(se.h+180)%360,sn(se)}function Ud(K,se){if(isNaN(se)||se<=0)throw new Error("Argument to polyad must be a positive number");for(var me=sn(K).toHsl(),Be=[sn(K)],Re=360/se,ve=1;ve<se;ve++)Be.push(sn({h:(me.h+ve*Re)%360,s:me.s,l:me.l}));return Be}function Nv(K){var se=sn(K).toHsl(),me=se.h;return[sn(K),sn({h:(me+72)%360,s:se.s,l:se.l}),sn({h:(me+216)%360,s:se.s,l:se.l})]}function $v(K,se,me){se=se||6,me=me||30;var Be=sn(K).toHsl(),Re=360/me,ve=[sn(K)];for(Be.h=(Be.h-(Re*se>>1)+720)%360;--se;)Be.h=(Be.h+Re)%360,ve.push(sn(Be));return ve}function Lv(K,se){se=se||6;for(var me=sn(K).toHsv(),Be=me.h,Re=me.s,ve=me.v,Fe=[],Xe=1/se;se--;)Fe.push(sn({h:Be,s:Re,v:ve})),ve=(ve+Xe)%1;return Fe}sn.mix=function(K,se,me){me=me===0?0:me||50;var Be=sn(K).toRgb(),Re=sn(se).toRgb(),ve=me/100,Fe={r:(Re.r-Be.r)*ve+Be.r,g:(Re.g-Be.g)*ve+Be.g,b:(Re.b-Be.b)*ve+Be.b,a:(Re.a-Be.a)*ve+Be.a};return sn(Fe)},sn.readability=function(K,se){var me=sn(K),Be=sn(se);return(Math.max(me.getLuminance(),Be.getLuminance())+.05)/(Math.min(me.getLuminance(),Be.getLuminance())+.05)},sn.isReadable=function(K,se,me){var Be=sn.readability(K,se),Re,ve;switch(ve=!1,Re=jv(me),Re.level+Re.size){case"AAsmall":case"AAAlarge":ve=Be>=4.5;break;case"AAlarge":ve=Be>=3;break;case"AAAsmall":ve=Be>=7;break}return ve},sn.mostReadable=function(K,se,me){var Be=null,Re=0,ve,Fe,Xe,tt;me=me||{},Fe=me.includeFallbackColors,Xe=me.level,tt=me.size;for(var Ze=0;Ze<se.length;Ze++)ve=sn.readability(K,se[Ze]),ve>Re&&(Re=ve,Be=sn(se[Ze]));return sn.isReadable(K,Be,{level:Xe,size:tt})||!Fe?Be:(me.includeFallbackColors=!1,sn.mostReadable(K,["#fff","#000"],me))};var Fu=sn.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Fv=sn.hexNames=Uv(Fu);function Uv(K){var se={};for(var me in K)K.hasOwnProperty(me)&&(se[K[me]]=me);return se}function zd(K){return K=parseFloat(K),(isNaN(K)||K<0||K>1)&&(K=1),K}function ts(K,se){zv(K)&&(K="100%");var me=Wv(K);return K=Math.min(se,Math.max(0,parseFloat(K))),me&&(K=parseInt(K*se,10)/100),Math.abs(K-se)<1e-6?1:K%se/parseFloat(se)}function sc(K){return Math.min(1,Math.max(0,K))}function js(K){return parseInt(K,16)}function zv(K){return typeof K=="string"&&K.indexOf(".")!=-1&&parseFloat(K)===1}function Wv(K){return typeof K=="string"&&K.indexOf("%")!=-1}function no(K){return K.length==1?"0"+K:""+K}function gl(K){return K<=1&&(K=K*100+"%"),K}function Wd(K){return Math.round(parseFloat(K)*255).toString(16)}function Gd(K){return js(K)/255}var so=function(){var K="[-\\+]?\\d+%?",se="[-\\+]?\\d*\\.\\d+%?",me="(?:"+se+")|(?:"+K+")",Be="[\\s|\\(]+("+me+")[,|\\s]+("+me+")[,|\\s]+("+me+")\\s*\\)?",Re="[\\s|\\(]+("+me+")[,|\\s]+("+me+")[,|\\s]+("+me+")[,|\\s]+("+me+")\\s*\\)?";return{CSS_UNIT:new RegExp(me),rgb:new RegExp("rgb"+Be),rgba:new RegExp("rgba"+Re),hsl:new RegExp("hsl"+Be),hsla:new RegExp("hsla"+Re),hsv:new RegExp("hsv"+Be),hsva:new RegExp("hsva"+Re),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Mo(K){return!!so.CSS_UNIT.exec(K)}function Gv(K){K=K.replace(Sv,"").replace(wv,"").toLowerCase();var se=!1;if(Fu[K])K=Fu[K],se=!0;else if(K=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var me;return(me=so.rgb.exec(K))?{r:me[1],g:me[2],b:me[3]}:(me=so.rgba.exec(K))?{r:me[1],g:me[2],b:me[3],a:me[4]}:(me=so.hsl.exec(K))?{h:me[1],s:me[2],l:me[3]}:(me=so.hsla.exec(K))?{h:me[1],s:me[2],l:me[3],a:me[4]}:(me=so.hsv.exec(K))?{h:me[1],s:me[2],v:me[3]}:(me=so.hsva.exec(K))?{h:me[1],s:me[2],v:me[3],a:me[4]}:(me=so.hex8.exec(K))?{r:js(me[1]),g:js(me[2]),b:js(me[3]),a:Gd(me[4]),format:se?"name":"hex8"}:(me=so.hex6.exec(K))?{r:js(me[1]),g:js(me[2]),b:js(me[3]),format:se?"name":"hex"}:(me=so.hex4.exec(K))?{r:js(me[1]+""+me[1]),g:js(me[2]+""+me[2]),b:js(me[3]+""+me[3]),a:Gd(me[4]+""+me[4]),format:se?"name":"hex8"}:(me=so.hex3.exec(K))?{r:js(me[1]+""+me[1]),g:js(me[2]+""+me[2]),b:js(me[3]+""+me[3]),format:se?"name":"hex"}:!1}function jv(K){var se,me;return K=K||{level:"AA",size:"small"},se=(K.level||"AA").toUpperCase(),me=(K.size||"small").toLowerCase(),se!=="AA"&&se!=="AAA"&&(se="AA"),me!=="small"&&me!=="large"&&(me="small"),{level:se,size:me}}var jd={inject:["ColorPickerInstance"],methods:{handleEscape(K){this.ColorPickerInstance.handleOnEscapeKeydown(K)}}},yl={data(){return{prefixCls:"ivu-color-picker",inputPrefixCls:"ivu-input",iconPrefixCls:"ivu-icon",transferPrefixCls:"ivu-transfer"}}};function Uu(K,se){const me=sn(K),{_a:Be}=me;return Be==null&&me.setAlpha(se||1),me}function Hv(K,se){const me=se&&se.a;if(se){if(se.hsl)return Uu(se.hsl,me);if(se.hex&&se.hex.length>0)return Uu(se.hex,me)}return Uu(se,me)}function _l(K,se){const me=K===""?"#2d8cf0":K,Be=Hv(K,me),Re=Be.toHsl(),ve=Be.toHsv();return Re.s===0&&(Re.h=me.h||me.hsl&&me.hsl.h||se||0,ve.h=Re.h),ve.v<.0164&&(ve.h=me.h||me.hsv&&me.hsv.h||0,ve.s=me.s||me.hsv&&me.hsv.s||0),Re.l<.01&&(Re.h=me.h||me.hsl&&me.hsl.h||0,Re.s=me.s||me.hsl&&me.hsl.s||0),{hsl:Re,hex:Be.toHexString().toUpperCase(),rgba:Be.toRgb(),hsv:ve,oldHue:me.h||se||Re.h,source:me.source,a:me.a||Be.getAlpha()}}function oo(K,se,me){return K<se?se:K>me?me:K}function Hd(K,se,me){return Ie(K,se)?me:0}function Xd(K,se){return K.touches?K.touches[0][se]:0}function vl(K){const{r:se,g:me,b:Be,a:Re}=K;return`rgba(${[se,me,Be,Re].join(",")})`}const Xv={name:"RecommendedColors",mixins:[jd,yl],emits:["picker-color","change"],props:{list:{type:Array,default:void 0}},data(){const K=Math.ceil(this.list.length/12),se=1;return{left:-se,right:se,up:-se,down:se,powerKey:"shiftKey",grid:{x:1,y:1},rows:K,columns:12}},computed:{hideClass(){return`${this.prefixCls}-hide`},linearIndex(){return this.getLinearIndex(this.grid)},currentCircle(){return this.$refs[`color-circle-${this.linearIndex}`][0]}},methods:{getLinearIndex(K){return this.columns*(K.y-1)+K.x-1},getMaxLimit(K){return K==="x"?this.columns:this.rows},handleArrow(K,se,me){K.preventDefault(),K.stopPropagation(),this.blurColor();const Be={...this.grid};K[this.powerKey]?me<0?Be[se]=1:Be[se]=this.getMaxLimit(se):Be[se]+=me;const Re=this.getLinearIndex(Be);Re>=0&&Re<this.list.length&&(this.grid[se]=oo(Be[se],1,this.getMaxLimit(se))),this.focusColor()},blurColor(){this.currentCircle.classList.add(this.hideClass)},focusColor(){this.currentCircle.classList.remove(this.hideClass)},handleEnter(K){this.handleClick(K,this.currentCircle)},handleClick(K,se){K.preventDefault(),K.stopPropagation(),this.$refs.reference.focus();const me=se||K.target,Be=me.dataset.colorId||me.parentElement.dataset.colorId;if(Be){this.blurColor();const Re=Number(Be)+1;this.grid.x=Re%this.columns||this.columns,this.grid.y=Math.ceil(Re/this.columns),this.focusColor(),this.$emit("picker-color",this.list[Be]),this.$emit("change",{hex:this.list[Be],source:"hex"})}},lineBreak(K,se){if(!se)return!1;const me=se+1;return me<K.length&&me%this.columns===0}}},qv=["data-color-id"],Qv={key:0};function Yv(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{ref:"reference",tabindex:"0",onClick:se[0]||(se[0]=(...Fe)=>ve.handleClick&&ve.handleClick(...Fe)),onKeydown:[se[1]||(se[1]=E.withKeys((...Fe)=>K.handleEscape&&K.handleEscape(...Fe),["esc"])),se[2]||(se[2]=E.withKeys((...Fe)=>ve.handleEnter&&ve.handleEnter(...Fe),["enter"])),se[3]||(se[3]=E.withKeys(Fe=>ve.handleArrow(Fe,"x",Re.left),["left"])),se[4]||(se[4]=E.withKeys(Fe=>ve.handleArrow(Fe,"x",Re.right),["right"])),se[5]||(se[5]=E.withKeys(Fe=>ve.handleArrow(Fe,"y",Re.up),["up"])),se[6]||(se[6]=E.withKeys(Fe=>ve.handleArrow(Fe,"y",Re.down),["down"]))],onBlur:se[7]||(se[7]=(...Fe)=>ve.blurColor&&ve.blurColor(...Fe)),onFocus:se[8]||(se[8]=(...Fe)=>ve.focusColor&&ve.focusColor(...Fe))},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.list,(Fe,Xe)=>(E.openBlock(),E.createElementBlock(E.Fragment,{key:Fe+":"+Xe},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-picker-colors-wrapper"])},[E.createElementVNode("div",{"data-color-id":Xe},[E.createElementVNode("div",{style:E.normalizeStyle({background:Fe}),class:E.normalizeClass([K.prefixCls+"-picker-colors-wrapper-color"])},null,6),E.createElementVNode("div",{ref_for:!0,ref:"color-circle-"+Xe,class:E.normalizeClass([K.prefixCls+"-picker-colors-wrapper-circle",ve.hideClass])},null,2)],8,qv)],2),ve.lineBreak(me.list,Xe)?(E.openBlock(),E.createElementBlock("br",Qv)):E.createCommentVNode("",!0)],64))),128))],544)}var Kv=Y(Xv,[["render",Yv]]),bl={mixins:[jd],props:{focused:{type:Boolean,default:!1},value:{type:Object,default:void 0}},created(){this.focused&&setTimeout(()=>this.$el.focus(),1)},beforeUnmount(){this.unbindEventListeners()},methods:{handleLeft(K){this.handleSlide(K,this.left,"left")},handleRight(K){this.handleSlide(K,this.right,"right")},handleUp(K){this.handleSlide(K,this.up,"up")},handleDown(K){this.handleSlide(K,this.down,"down")},handleMouseDown(K){this.ColorPickerInstance.handleOnDragging(!0),this.handleChange(K,!0),X(window,"mousemove",this.handleChange),X(window,"mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){q(window,"mousemove",this.handleChange),q(window,"mouseup",this.handleMouseUp),setTimeout(()=>this.ColorPickerInstance.handleOnDragging(!1),1)},getLeft(K){if(!W)return;const{container:se}=this.$refs,me=se.getBoundingClientRect().left+window.pageXOffset;return(K.pageX||Xd(K,"PageX"))-me},getTop(K){if(!W)return;const{container:se}=this.$refs,me=se.getBoundingClientRect().top+window.pageYOffset;return(K.pageY||Xd(K,"PageY"))-me}}};const Zv={name:"Saturation",mixins:[bl,yl],emits:["change"],data(){return{left:-.01,right:.01,up:.01,down:-.01,multiplier:10,powerKey:"shiftKey"}},computed:{bgColorStyle(){return{background:`hsl(${this.value.hsv.h}, 100%, 50%)`}},pointerStyle(){return{top:`${-(this.value.hsv.v*100)+1+100}%`,left:`${this.value.hsv.s*100}%`}}},methods:{change(K,se,me,Be){this.$emit("change",{h:K,s:se,v:me,a:Be,source:"hsva"})},handleSlide(K,se,me){K.preventDefault(),K.stopPropagation();const Be=K[this.powerKey]?se*this.multiplier:se,{h:Re,s:ve,v:Fe,a:Xe}=this.value.hsv,tt=oo(ve+Hd(me,["left","right"],Be),0,1),Ze=oo(Fe+Hd(me,["up","down"],Be),0,1);this.change(Re,tt,Ze,Xe)},handleChange(K){K.preventDefault(),K.stopPropagation();const{clientWidth:se,clientHeight:me}=this.$refs.container,Be=oo(this.getLeft(K),0,se),Re=oo(this.getTop(K),0,me),ve=Be/se,Fe=oo(1-Re/me,0,1);this.change(this.value.hsv.h,ve,Fe,this.value.hsv.a)},handleMouseDown(K){bl.methods.handleMouseDown.call(this,K),X(window,"mouseup",this.handleChange)},unbindEventListeners(K){bl.methods.unbindEventListeners.call(this,K),q(window,"mouseup",this.handleChange)}}};function Jv(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([K.prefixCls+"-saturation-wrapper"]),tabindex:"0",onKeydown:[se[1]||(se[1]=E.withKeys((...Fe)=>K.handleEscape&&K.handleEscape(...Fe),["esc"])),se[3]||(se[3]=E.withKeys((...Fe)=>K.handleLeft&&K.handleLeft(...Fe),["left"])),se[4]||(se[4]=E.withKeys((...Fe)=>K.handleRight&&K.handleRight(...Fe),["right"])),se[5]||(se[5]=E.withKeys((...Fe)=>K.handleUp&&K.handleUp(...Fe),["up"])),se[6]||(se[6]=E.withKeys((...Fe)=>K.handleDown&&K.handleDown(...Fe),["down"]))],onClick:se[2]||(se[2]=Fe=>K.$el.focus())},[E.createElementVNode("div",{ref:"container",style:E.normalizeStyle(ve.bgColorStyle),class:E.normalizeClass([K.prefixCls+"-saturation"]),onMousedown:se[0]||(se[0]=(...Fe)=>ve.handleMouseDown&&ve.handleMouseDown(...Fe))},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-saturation--white"])},null,2),E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-saturation--black"])},null,2),E.createElementVNode("div",{style:E.normalizeStyle(ve.pointerStyle),class:E.normalizeClass([K.prefixCls+"-saturation-pointer"])},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-saturation-circle"])},null,2)],6)],38)],34)}var eb=Y(Zv,[["render",Jv]]);const tb={name:"Hue",mixins:[bl,yl],emits:["change"],data(){const K=.06944444444444445,se=20*K;return{left:-K,right:K,up:se,down:-se,powerKey:"shiftKey",percent:oo(this.value.hsl.h*100/360,0,100)}},watch:{value(){this.percent=oo(this.value.hsl.h*100/360,0,100)}},methods:{change(K){this.percent=oo(K,0,100);const{h:se,s:me,l:Be,a:Re}=this.value.hsl,ve=oo(K/100*360,0,360);se!==ve&&this.$emit("change",{h:ve,s:me,l:Be,a:Re,source:"hsl"})},handleSlide(K,se){if(K.preventDefault(),K.stopPropagation(),K[this.powerKey]){this.change(se<0?0:100);return}this.change(this.percent+se)},handleChange(K){K.preventDefault(),K.stopPropagation();const se=this.getLeft(K);if(se<0){this.change(0);return}const{clientWidth:me}=this.$refs.container;if(se>me){this.change(100);return}this.change(se*100/me)}}};function rb(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([K.prefixCls+"-hue"]),tabindex:"0",onClick:se[3]||(se[3]=Fe=>K.$el.focus()),onKeydown:[se[4]||(se[4]=E.withKeys((...Fe)=>K.handleEscape&&K.handleEscape(...Fe),["esc"])),se[5]||(se[5]=E.withKeys((...Fe)=>K.handleLeft&&K.handleLeft(...Fe),["left"])),se[6]||(se[6]=E.withKeys((...Fe)=>K.handleRight&&K.handleRight(...Fe),["right"])),se[7]||(se[7]=E.withKeys((...Fe)=>K.handleUp&&K.handleUp(...Fe),["up"])),se[8]||(se[8]=E.withKeys((...Fe)=>K.handleDown&&K.handleDown(...Fe),["down"]))]},[E.createElementVNode("div",{ref:"container",class:E.normalizeClass([K.prefixCls+"-hue-container"]),onMousedown:se[0]||(se[0]=(...Fe)=>K.handleMouseDown&&K.handleMouseDown(...Fe)),onTouchmove:se[1]||(se[1]=(...Fe)=>ve.handleChange&&ve.handleChange(...Fe)),onTouchstart:se[2]||(se[2]=(...Fe)=>ve.handleChange&&ve.handleChange(...Fe))},[E.createElementVNode("div",{style:E.normalizeStyle({top:0,left:`${Re.percent}%`}),class:E.normalizeClass([K.prefixCls+"-hue-pointer"])},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-hue-picker"])},null,2)],6)],34)],34)}var ib=Y(tb,[["render",rb]]);const nb={name:"Alpha",mixins:[bl,yl],emits:["change"],data(){return{left:-1,right:1,up:10,down:-10,powerKey:"shiftKey"}},computed:{gradientStyle(){const{r:K,g:se,b:me}=this.value.rgba,Be=vl({r:K,g:se,b:me,a:0}),Re=vl({r:K,g:se,b:me,a:1});return{background:`linear-gradient(to right, ${Be} 0%, ${Re} 100%)`}}},methods:{change(K){const{h:se,s:me,l:Be}=this.value.hsl,{a:Re}=this.value;Re!==K&&this.$emit("change",{h:se,s:me,l:Be,a:K,source:"rgba"})},handleSlide(K,se){K.preventDefault(),K.stopPropagation(),this.change(oo(K[this.powerKey]?se:Math.round(this.value.hsl.a*100+se)/100,0,1))},handleChange(K){K.preventDefault(),K.stopPropagation();const se=this.getLeft(K);if(se<0){this.change(0);return}const{clientWidth:me}=this.$refs.container;if(se>me){this.change(1);return}this.change(Math.round(se*100/me)/100)}}};function sb(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([K.prefixCls+"-alpha"]),tabindex:"0",onClick:se[3]||(se[3]=Fe=>K.$el.focus()),onKeydown:[se[4]||(se[4]=E.withKeys((...Fe)=>K.handleEscape&&K.handleEscape(...Fe),["esc"])),se[5]||(se[5]=E.withKeys((...Fe)=>K.handleLeft&&K.handleLeft(...Fe),["left"])),se[6]||(se[6]=E.withKeys((...Fe)=>K.handleRight&&K.handleRight(...Fe),["right"])),se[7]||(se[7]=E.withKeys((...Fe)=>K.handleUp&&K.handleUp(...Fe),["up"])),se[8]||(se[8]=E.withKeys((...Fe)=>K.handleDown&&K.handleDown(...Fe),["down"]))]},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-alpha-checkboard-wrap"])},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-alpha-checkerboard"])},null,2)],2),E.createElementVNode("div",{style:E.normalizeStyle(ve.gradientStyle),class:E.normalizeClass([K.prefixCls+"-alpha-gradient"])},null,6),E.createElementVNode("div",{ref:"container",class:E.normalizeClass([K.prefixCls+"-alpha-container"]),onMousedown:se[0]||(se[0]=(...Fe)=>K.handleMouseDown&&K.handleMouseDown(...Fe)),onTouchmove:se[1]||(se[1]=(...Fe)=>ve.handleChange&&ve.handleChange(...Fe)),onTouchstart:se[2]||(se[2]=(...Fe)=>ve.handleChange&&ve.handleChange(...Fe))},[E.createElementVNode("div",{style:E.normalizeStyle({top:0,left:`${K.value.a*100}%`}),class:E.normalizeClass([K.prefixCls+"-alpha-pointer"])},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-alpha-picker"])},null,2)],6)],34)],34)}var ob=Y(nb,[["render",sb]]);const ab={name:"ColorPicker",components:{Drop:ki,RecommendColors:Kv,Saturation:eb,Hue:ib,Alpha:ob,iInput:Js,iButton:As,Icon:Ae},directives:{clickOutside:Rn},mixins:[Xn,yl,In,io],emits:["on-active-change","on-open-change","on-change","on-pick-success","on-pick-clear","update:modelValue"],provide(){return{ColorPickerInstance:this}},props:{modelValue:{type:String,default:void 0},hue:{type:Boolean,default:!0},alpha:{type:Boolean,default:!1},recommend:{type:Boolean,default:!1},format:{type:String,validator(K){return Ie(K,["hsl","hsv","hex","rgb"])},default:void 0},colors:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},hideDropDown:{type:Boolean,default:!1},placement:{type:String,validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},name:{type:String,default:void 0},editable:{type:Boolean,default:!0},capture:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return K.$VIEWUI?K.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){return{val:_l(this.modelValue||""),currentValue:this.modelValue||"",dragging:!1,visible:!1,recommendedColor:["#2d8cf0","#19be6b","#ff9900","#ed4014","#00b5ff","#19c919","#f9e31c","#ea1a1a","#9b1dea","#00c2b1","#ac7a33","#1d35ea","#8bc34a","#f16b62","#ea4ca3","#0d94aa","#febd79","#5d4037","#00bcd4","#f06292","#cddc39","#607d8b","#000000","#ffffff"]}},computed:{arrowClasses(){return[`${this.inputPrefixCls}-icon`,`${this.inputPrefixCls}-icon-normal`]},transition(){return Ie(this.placement,["bottom-start","bottom","bottom-end"])?"slide-up":"fade"},saturationColors:{get(){return this.val},set(K){this.val=K,this.$emit("on-active-change",this.formatColor)}},classes(){return[`${this.prefixCls}`,{[`${this.prefixCls}-transfer`]:this.transfer}]},wrapClasses(){return[`${this.prefixCls}-rel`,`${this.prefixCls}-${this.size}`,`${this.inputPrefixCls}-wrapper`,`${this.inputPrefixCls}-wrapper-${this.size}`,{[`${this.prefixCls}-disabled`]:this.itemDisabled}]},inputClasses(){return[`${this.prefixCls}-input`,`${this.inputPrefixCls}`,`${this.inputPrefixCls}-${this.size}`,{[`${this.prefixCls}-focused`]:this.visible,[`${this.prefixCls}-disabled`]:this.itemDisabled}]},dropClasses(){return{[`${this.transferPrefixCls}-no-max-height`]:!0,[`${this.prefixCls}-transfer`]:this.transfer,[`${this.prefixCls}-hide-drop`]:this.hideDropDown,[this.transferClassName]:this.transferClassName}},displayedColorStyle(){return{backgroundColor:vl(this.visible?this.saturationColors.rgba:sn(this.modelValue).toRgb())}},formatColor(){const{format:K,saturationColors:se}=this;if(K){if(K==="hsl")return sn(se.hsl).toHslString();if(K==="hsv")return sn(se.hsv).toHsvString();if(K==="hex")return se.hex;if(K==="rgb")return vl(se.rgba)}else if(this.alpha)return vl(se.rgba);return se.hex},confirmColorClasses(){return[`${this.prefixCls}-confirm-color`,{[`${this.prefixCls}-confirm-color-editable`]:this.editable}]},arrowType(){const K=this.globalConfig;let se="ios-arrow-down";return K&&(K.colorPicker.customArrow?se="":K.colorPicker.arrow&&(se=K.colorPicker.arrow)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.colorPicker.customArrow&&(se=K.colorPicker.customArrow),se},arrowSize(){const K=this.globalConfig;let se="";return K&&K.colorPicker.arrowSize&&(se=K.colorPicker.arrowSize),se}},watch:{modelValue(K){this.val=_l(K||"")},visible(K){this.val=_l(this.modelValue||""),this.$refs.drop[K?"update":"destroy"](),this.$emit("on-open-change",!!K)}},methods:{setDragging(K){this.dragging=K},handleClose(K){if(this.visible){if(this.dragging||K.type==="mousedown"){this.$refs.editColorInput&&K.target!==this.$refs.editColorInput.$el.querySelector("input")&&K.preventDefault();return}if(this.transfer){const se=this.$refs.drop.$refs.drop;if(se===K.target||se.contains(K.target))return}this.closer(K);return}this.visible=!1},toggleVisible(){this.itemDisabled||(this.visible=!this.visible,this.$refs.input.focus())},childChange(K){this.colorChange(K)},colorChange(K,se){this.oldHue=this.saturationColors.hsl.h,this.saturationColors=_l(K,se||this.oldHue)},closer(K){K&&(K.preventDefault(),K.stopPropagation()),this.visible=!1,this.$refs.input.focus()},handleButtons(K,se){this.currentValue=se,this.$emit("update:modelValue",se),this.$emit("on-change",se),this.handleFormItemChange("change",se),this.closer(K)},handleSuccess(K){this.handleButtons(K,this.formatColor),this.$emit("on-pick-success")},handleClear(K){this.handleButtons(K,""),this.$emit("on-pick-clear")},handleSelectColor(K){this.val=_l(K),this.$emit("on-active-change",this.formatColor)},handleEditColor(K){const se=K.target.value;this.handleSelectColor(se)},handleFirstTab(K){K.shiftKey&&(K.preventDefault(),K.stopPropagation(),this.$refs.ok.$el.focus())},handleLastTab(K){K.shiftKey||(K.preventDefault(),K.stopPropagation(),this.$refs.saturation.$el.focus())},onTab(K){this.visible&&K.preventDefault()},onEscape(K){this.visible&&this.closer(K)},onArrow(K){this.visible||(K.preventDefault(),K.stopPropagation(),this.visible=!0)},handleOnEscapeKeydown(K){this.closer(K)},handleOnDragging(K){this.setDragging(K)}}},lb=["name","value"],cb=["tabindex"];function ub(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Saturation"),tt=E.resolveComponent("Hue"),Ze=E.resolveComponent("Alpha"),it=E.resolveComponent("recommend-colors"),nr=E.resolveComponent("i-input"),jr=E.resolveComponent("i-button"),zr=E.resolveComponent("Drop"),Fr=E.resolveDirective("click-outside");return E.withDirectives((E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("div",{ref:"reference",class:E.normalizeClass(ve.wrapClasses),onClick:se[4]||(se[4]=(..._t)=>ve.toggleVisible&&ve.toggleVisible(..._t))},[E.createElementVNode("input",{name:me.name,value:Re.currentValue,type:"hidden"},null,8,lb),E.createVNode(Fe,{type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize,class:E.normalizeClass(ve.arrowClasses)},null,8,["type","custom","size","class"]),E.createElementVNode("div",{ref:"input",tabindex:K.itemDisabled?void 0:0,class:E.normalizeClass(ve.inputClasses),onKeydown:[se[0]||(se[0]=E.withKeys((..._t)=>ve.onTab&&ve.onTab(..._t),["tab"])),se[1]||(se[1]=E.withKeys((..._t)=>ve.onEscape&&ve.onEscape(..._t),["esc"])),se[2]||(se[2]=E.withKeys((..._t)=>ve.onArrow&&ve.onArrow(..._t),["up"])),se[3]||(se[3]=E.withKeys((..._t)=>ve.onArrow&&ve.onArrow(..._t),["down"]))]},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-color"])},[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-color-empty"])},[E.createElementVNode("i",{class:E.normalizeClass([K.iconPrefixCls,K.iconPrefixCls+"-ios-close"])},null,2)],2),[[E.vShow,me.modelValue===""&&!Re.visible]]),E.withDirectives(E.createElementVNode("div",{style:E.normalizeStyle(ve.displayedColorStyle)},null,4),[[E.vShow,me.modelValue||Re.visible]])],2)],42,cb)],2),E.createVNode(zr,{ref:"drop",visible:Re.visible,placement:me.placement,transfer:me.transfer,classes:ve.dropClasses,eventsEnabled:me.eventsEnabled,"transition-name":"transition-drop"},{default:E.withCtx(()=>[E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[Re.visible?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([K.prefixCls+"-picker"])},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-picker-wrapper"])},[E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-picker-panel"])},[E.createVNode(Xe,{ref:"saturation",value:ve.saturationColors,focused:Re.visible,onChange:ve.childChange,onKeydown:E.withKeys(ve.handleFirstTab,["tab"])},null,8,["value","focused","onChange","onKeydown"])],2),me.hue?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([K.prefixCls+"-picker-hue-slider"])},[E.createVNode(tt,{value:ve.saturationColors,onChange:ve.childChange},null,8,["value","onChange"])],2)):E.createCommentVNode("",!0),me.alpha?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass([K.prefixCls+"-picker-alpha-slider"])},[E.createVNode(Ze,{value:ve.saturationColors,onChange:ve.childChange},null,8,["value","onChange"])],2)):E.createCommentVNode("",!0),me.colors.length?(E.openBlock(),E.createBlock(it,{key:2,list:me.colors,class:E.normalizeClass([K.prefixCls+"-picker-colors"]),onPickerColor:ve.handleSelectColor},null,8,["list","class","onPickerColor"])):E.createCommentVNode("",!0),!me.colors.length&&me.recommend?(E.openBlock(),E.createBlock(it,{key:3,list:Re.recommendedColor,class:E.normalizeClass([K.prefixCls+"-picker-colors"]),onPickerColor:ve.handleSelectColor},null,8,["list","class","onPickerColor"])):E.createCommentVNode("",!0)],2),E.createElementVNode("div",{class:E.normalizeClass([K.prefixCls+"-confirm"])},[E.createElementVNode("span",{class:E.normalizeClass(ve.confirmColorClasses)},[me.editable?(E.openBlock(),E.createBlock(nr,{key:0,ref:"editColorInput",modelValue:ve.formatColor,size:"small",onOnEnter:ve.handleEditColor,onOnBlur:ve.handleEditColor},null,8,["modelValue","onOnEnter","onOnBlur"])):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createTextVNode(E.toDisplayString(ve.formatColor),1)],64))],2),E.createVNode(jr,{class:E.normalizeClass([K.prefixCls+"-confirm-btn-cancel"]),ref:"clear",tabindex:0,size:"small",onClick:ve.handleClear,onKeydown:[E.withKeys(ve.handleClear,["enter"]),E.withKeys(ve.closer,["esc"])]},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(K.t("i.datepicker.clear")),1)]),_:1},8,["class","onClick","onKeydown"]),E.createVNode(jr,{ref:"ok",tabindex:0,size:"small",type:"primary",onClick:ve.handleSuccess,onKeydown:[E.withKeys(ve.handleLastTab,["tab"]),E.withKeys(ve.handleSuccess,["enter"]),E.withKeys(ve.closer,["esc"])]},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(K.t("i.datepicker.ok")),1)]),_:1},8,["onClick","onKeydown"])],2)],2)):E.createCommentVNode("",!0)]),_:1})]),_:1},8,["visible","placement","transfer","classes","eventsEnabled"])],2)),[[Fr,ve.handleClose,me.capture]])}var qd=Y(ab,[["render",ub]]);const hb="ivu-layout",db={name:"Content",computed:{wrapClasses(){return`${hb}-content`}}};function pb(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[E.renderSlot(K.$slots,"default")],2)}var zu=Y(db,[["render",pb]]);function fb(K){var se;if(K.nodeName==="SELECT")K.focus(),se=K.value;else if(K.nodeName==="INPUT"||K.nodeName==="TEXTAREA"){var me=K.hasAttribute("readonly");me||K.setAttribute("readonly",""),K.select(),K.setSelectionRange(0,K.value.length),me||K.removeAttribute("readonly"),se=K.value}else{K.hasAttribute("contenteditable")&&K.focus();var Be=window.getSelection(),Re=document.createRange();Re.selectNodeContents(K),Be.removeAllRanges(),Be.addRange(Re),se=Be.toString()}return se}var mb=fb,Qd={name:"RenderCell",props:{render:Function},render(){return this.render(E.h)}};const gb={components:{RenderCell:Qd},props:{prefixCls:{type:String,default:""},duration:{type:Number,default:1.5},type:{type:String},content:{type:String,default:""},withIcon:Boolean,render:{type:Function},hasTitle:Boolean,styles:{type:Object,default:function(){return{right:"50%"}}},closable:{type:Boolean,default:!1},className:{type:String},name:{type:String,required:!0},onClose:{type:Function},transitionName:{type:String},background:{type:Boolean,default:!1},msgType:{type:String}},data(){return{withDesc:!1}},computed:{baseClass(){return`${this.prefixCls}-notice`},renderFunc(){return this.render||function(){}},classes(){return[this.baseClass,{[`${this.className}`]:!!this.className,[`${this.baseClass}-closable`]:this.closable,[`${this.baseClass}-with-desc`]:this.withDesc,[`${this.baseClass}-with-background`]:this.background}]},contentClasses(){return[`${this.baseClass}-content`,this.render!==void 0?`${this.baseClass}-content-with-render`:""]},messageContentClasses(){return[`${this.baseClass}-content`,{[`${this.baseClass}-content-${this.msgType}`]:this.msgType,[`${this.baseClass}-content-background`]:this.background}]},contentWithIcon(){return[this.withIcon?`${this.prefixCls}-content-with-icon`:"",!this.hasTitle&&this.withIcon?`${this.prefixCls}-content-with-render-notitle`:""]},messageClasses(){return[`${this.baseClass}-content`,this.render!==void 0?`${this.baseClass}-content-with-render`:""]}},methods:{clearCloseTimer(){this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null)},close(){this.clearCloseTimer(),this.onClose(),this.$parent.$parent.close(this.name)},handleEnter(K){this.type==="message"&&(K.style.height=K.scrollHeight+"px")},handleLeave(K){this.type==="message"&&W&&document.getElementsByClassName("ivu-message-notice").length!==1&&(K.style.height=0,K.style.paddingTop=0,K.style.paddingBottom=0)}},mounted(){if(this.handleEnter(this.$el),this.clearCloseTimer(),this.duration!==0&&(this.closeTimer=setTimeout(()=>{this.close()},this.duration*1e3)),this.prefixCls==="ivu-notice"){let K=this.$refs.content.querySelectorAll(`.${this.prefixCls}-desc`)[0];this.withDesc=this.render?!0:K?K.innerHTML!=="":!1}},beforeUnmount(){this.handleLeave(this.$el),this.clearCloseTimer()}},yb=["innerHTML"],_b=[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-close"},null,-1)],vb=["innerHTML"],bb=[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-close"},null,-1)];function xb(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("render-cell");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(me.styles)},[me.type==="notice"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createElementVNode("div",{class:E.normalizeClass(ve.contentClasses),ref:"content",innerHTML:me.content},null,10,yb),E.createElementVNode("div",{class:E.normalizeClass(ve.contentWithIcon)},[E.createVNode(Fe,{render:ve.renderFunc},null,8,["render"])],2),me.closable?(E.openBlock(),E.createElementBlock("a",{key:0,class:E.normalizeClass([ve.baseClass+"-close"]),onClick:se[0]||(se[0]=(...Xe)=>ve.close&&ve.close(...Xe))},_b,2)):E.createCommentVNode("",!0)],64)):E.createCommentVNode("",!0),me.type==="message"?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass(ve.messageContentClasses),ref:"content"},[E.createElementVNode("div",{class:E.normalizeClass([ve.baseClass+"-content-text"]),innerHTML:me.content},null,10,vb),E.createElementVNode("div",{class:E.normalizeClass([ve.baseClass+"-content-text"])},[E.createVNode(Fe,{render:ve.renderFunc},null,8,["render"])],2),me.closable?(E.openBlock(),E.createElementBlock("a",{key:0,class:E.normalizeClass([ve.baseClass+"-close"]),onClick:se[1]||(se[1]=(...Xe)=>ve.close&&ve.close(...Xe))},bb,2)):E.createCommentVNode("",!0)],2)):E.createCommentVNode("",!0)],6)}var Sb=Y(gb,[["render",xb]]);const wb="ivu-notification";let Ob=0;const Cb=Date.now();function Tb(){return"ivuNotification_"+Cb+"_"+Ob++}const Eb={components:{Notice:Sb},props:{prefixCls:{type:String,default:wb},styles:{type:Object,default:function(){return{top:"65px",left:"50%"}}},content:{type:String},className:{type:String},transitionName:{type:String}},data(){return{notices:[],tIndex:this.handleGetIndex()}},computed:{classes(){return[`${this.prefixCls}`,{[`${this.className}`]:!!this.className}]},wrapStyles(){let K=Object.assign({},this.styles);return K["z-index"]=1010+this.tIndex,K}},methods:{add(K){const se=K.name||Tb();let me=Object.assign({styles:{right:"50%"},content:"",duration:1.5,closable:!1,name:se},K);this.notices.push(me),this.tIndex=this.handleGetIndex()},close(K){const se=this.notices;for(let me=0;me<se.length;me++)if(se[me].name===K){this.notices.splice(me,1);break}},closeAll(){this.notices=[]},handleGetIndex(){return Ai(),ti}}};function Ab(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Notice");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.wrapStyles)},[E.createVNode(E.TransitionGroup,{name:me.transitionName,appear:""},{default:E.withCtx(()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.notices,Xe=>(E.openBlock(),E.createBlock(Fe,{key:Xe.name,"prefix-cls":me.prefixCls,styles:Xe.styles,type:Xe.type,content:Xe.content,duration:Xe.duration,render:Xe.render,"has-title":Xe.hasTitle,withIcon:Xe.withIcon,closable:Xe.closable,name:Xe.name,"transition-name":Xe.transitionName,background:Xe.background,"msg-type":Xe.msgType,"on-close":Xe.onClose},null,8,["prefix-cls","styles","type","content","duration","render","has-title","withIcon","closable","name","transition-name","background","msg-type","on-close"]))),128))]),_:1},8,["name"])],6)}var oc=Y(Eb,[["render",Ab]]);oc.newInstance=K=>{if(!W)return;const se=K||{};let me=null;const Be=E.createApp({render(){return E.h(oc,Object.assign({ref:"notification"},se))},created(){me=E.getCurrentInstance()}}),Re=document.createElement("div");document.body.appendChild(Re),Be.mount(Re);const ve=me.refs.notification;return{notice(Fe){ve.add(Fe)},remove(Fe){ve.close(Fe)},component:ve,destroy(Fe){ve.closeAll(),W&&setTimeout(function(){document.body.removeChild(document.getElementsByClassName(Fe)[0])},500)}}};const Wu="ivu-message",Yd="ivu-icon",Kd="ivu_message_key_",Aa={top:24,duration:1.5,background:!1};let ac,Zd=1;const Mb={info:"ios-information-circle",success:"ios-checkmark-circle",warning:"ios-alert",error:"ios-close-circle",loading:"ios-loading"},Jd="move-up";function ep(){return ac=ac||oc.newInstance({prefixCls:Wu,styles:{top:`${Aa.top}px`},transitionName:Jd}),ac}function Pb(K="",se=Aa.duration,me,Be=function(){},Re=!1,ve=function(){},Fe=Aa.background){const Xe=Mb[me],tt=me==="loading"?" ivu-load-loop":"";let Ze=ep();return Ze.notice({name:`${Kd}${Zd}`,duration:se,styles:{},transitionName:Jd,content:`
            <div class="${Wu}-custom-content ${Wu}-${me}">
                <i class="${Yd} ${Yd}-${Xe} ${tt}"></i>
                <span>${K}</span>
            </div>
        `,render:ve,onClose:Be,closable:Re,type:"message",msgType:me,background:Fe}),function(){let it=Zd++;return function(){Ze.remove(`${Kd}${it}`)}}()}var xl={name:"Message",info(K){return this.message("info",K)},success(K){return this.message("success",K)},warning(K){return this.message("warning",K)},error(K){return this.message("error",K)},loading(K){return this.message("loading",K)},message(K,se){return typeof se=="string"&&(se={content:se}),Pb(se.content,se.duration,K,se.onClose,se.closable,se.render,se.background)},config(K){(K.top||K.top===0)&&(Aa.top=K.top),(K.duration||K.duration===0)&&(Aa.duration=K.duration),K.background&&(Aa.background=K.background)},destroy(){let K=ep();ac=null,K.destroy("ivu-message")}};const Rb="",kb="";function lc({text:K="",successTip:se=Rb,errorTip:me=kb,success:Be,error:Re,showTip:ve=!0}){if(!W)return;const Fe=document.documentElement.getAttribute("dir")==="rtl",Xe=document.createElement("textarea");Xe.style.fontSize="12pt",Xe.style.border="0",Xe.style.padding="0",Xe.style.margin="0",Xe.style.position="absolute",Xe.style[Fe?"right":"left"]="-9999px";let tt=window.pageYOffset||document.documentElement.scrollTop;Xe.style.top=`${tt}px`,Xe.setAttribute("readonly",""),Xe.value=K,document.body.appendChild(Xe),mb(Xe);let Ze;try{Ze=document.execCommand("copy"),ve&&xl.success({content:se}),document.body.removeChild(Xe),Be&&Be.call()}catch{Ze=!1,ve&&xl.error({content:me}),document.body.removeChild(Xe),Re&&Re.call()}}function Gu(K){return K*1<10?`0${K}`:K}const Ib={name:"CountDown",emits:["on-end"],props:{format:{type:Function},target:{type:[Date,Number]},interval:{type:Number,default:1e3}},data(){return{lastTime:""}},methods:{initTime(){let K=0,se=0;try{Object.prototype.toString.call(this.target)==="[object Date]"?se=this.target.getTime():se=new Date(this.target).getTime()}catch(me){throw new Error("invalid target prop",me)}return K=se-new Date().getTime(),K<0?0:K},tick(){let{lastTime:K}=this;this.timer=setTimeout(()=>{K<this.interval?(clearTimeout(this.timer),this.lastTime=0,this.$emit("on-end")):(K-=this.interval,this.lastTime=K,this.tick())},this.interval)},defaultFormat(K){const se=Math.floor(K/36e5),me=Math.floor((K-se*36e5)/6e4),Be=Math.floor((K-se*36e5-me*6e4)/1e3);return`${Gu(se)}:${Gu(me)}:${Gu(Be)}`}},computed:{result(){const{format:K=this.defaultFormat}=this;return K(this.lastTime)}},watch:{target(){this.timer&&clearTimeout(this.timer),this.lastTime=this.initTime(),this.tick()}},created(){this.lastTime=this.initTime()},mounted(){this.tick()},beforeUnmount(){this.timer&&clearTimeout(this.timer)}};function Bb(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("span",null,E.toDisplayString(ve.result),1)}var tp=Y(Ib,[["render",Bb]]),ju={exports:{}};(function(K,se){(function(me,Be){K.exports=Be(nt,se,K)})(ct,function(me,Be,Re){var ve=function(Fe,Xe,tt,Ze,it,nr){function jr(wi){var li,Vi,Pi,pn,fn,Zi,Yi=wi<0;if(wi=Math.abs(wi).toFixed(_t.decimals),wi+="",li=wi.split("."),Vi=li[0],Pi=li.length>1?_t.options.decimal+li[1]:"",_t.options.useGrouping){for(pn="",fn=0,Zi=Vi.length;fn<Zi;++fn)fn!==0&&fn%3===0&&(pn=_t.options.separator+pn),pn=Vi[Zi-fn-1]+pn;Vi=pn}return _t.options.numerals.length&&(Vi=Vi.replace(/[0-9]/g,function(tn){return _t.options.numerals[+tn]}),Pi=Pi.replace(/[0-9]/g,function(tn){return _t.options.numerals[+tn]})),(Yi?"-":"")+_t.options.prefix+Vi+Pi+_t.options.suffix}function zr(wi,li,Vi,Pi){return Vi*(-Math.pow(2,-10*wi/Pi)+1)*1024/1023+li}function Fr(wi){return typeof wi=="number"&&!isNaN(wi)}var _t=this;if(_t.version=function(){return"1.9.3"},_t.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:zr,formattingFn:jr,prefix:"",suffix:"",numerals:[]},nr&&typeof nr=="object")for(var ni in _t.options)nr.hasOwnProperty(ni)&&nr[ni]!==null&&(_t.options[ni]=nr[ni]);_t.options.separator===""?_t.options.useGrouping=!1:_t.options.separator=""+_t.options.separator;for(var on=0,Gi=["webkit","moz","ms","o"],Qi=0;Qi<Gi.length&&!window.requestAnimationFrame;++Qi)window.requestAnimationFrame=window[Gi[Qi]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Gi[Qi]+"CancelAnimationFrame"]||window[Gi[Qi]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(wi,li){var Vi=new Date().getTime(),Pi=Math.max(0,16-(Vi-on)),pn=window.setTimeout(function(){wi(Vi+Pi)},Pi);return on=Vi+Pi,pn}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(wi){clearTimeout(wi)}),_t.initialize=function(){return!!_t.initialized||(_t.error="",_t.d=typeof Fe=="string"?document.getElementById(Fe):Fe,_t.d?(_t.startVal=Number(Xe),_t.endVal=Number(tt),Fr(_t.startVal)&&Fr(_t.endVal)?(_t.decimals=Math.max(0,Ze||0),_t.dec=Math.pow(10,_t.decimals),_t.duration=1e3*Number(it)||2e3,_t.countDown=_t.startVal>_t.endVal,_t.frameVal=_t.startVal,_t.initialized=!0,!0):(_t.error="[CountUp] startVal ("+Xe+") or endVal ("+tt+") is not a number",!1)):(_t.error="[CountUp] target is null or undefined",!1))},_t.printValue=function(wi){var li=_t.options.formattingFn(wi);_t.d.tagName==="INPUT"?this.d.value=li:_t.d.tagName==="text"||_t.d.tagName==="tspan"?this.d.textContent=li:this.d.innerHTML=li},_t.count=function(wi){_t.startTime||(_t.startTime=wi),_t.timestamp=wi;var li=wi-_t.startTime;_t.remaining=_t.duration-li,_t.options.useEasing?_t.countDown?_t.frameVal=_t.startVal-_t.options.easingFn(li,0,_t.startVal-_t.endVal,_t.duration):_t.frameVal=_t.options.easingFn(li,_t.startVal,_t.endVal-_t.startVal,_t.duration):_t.countDown?_t.frameVal=_t.startVal-(_t.startVal-_t.endVal)*(li/_t.duration):_t.frameVal=_t.startVal+(_t.endVal-_t.startVal)*(li/_t.duration),_t.countDown?_t.frameVal=_t.frameVal<_t.endVal?_t.endVal:_t.frameVal:_t.frameVal=_t.frameVal>_t.endVal?_t.endVal:_t.frameVal,_t.frameVal=Math.round(_t.frameVal*_t.dec)/_t.dec,_t.printValue(_t.frameVal),li<_t.duration?_t.rAF=requestAnimationFrame(_t.count):_t.callback&&_t.callback()},_t.start=function(wi){_t.initialize()&&(_t.callback=wi,_t.rAF=requestAnimationFrame(_t.count))},_t.pauseResume=function(){_t.paused?(_t.paused=!1,delete _t.startTime,_t.duration=_t.remaining,_t.startVal=_t.frameVal,requestAnimationFrame(_t.count)):(_t.paused=!0,cancelAnimationFrame(_t.rAF))},_t.reset=function(){_t.paused=!1,delete _t.startTime,_t.initialized=!1,_t.initialize()&&(cancelAnimationFrame(_t.rAF),_t.printValue(_t.startVal))},_t.update=function(wi){if(_t.initialize()){if(wi=Number(wi),!Fr(wi))return void(_t.error="[CountUp] update() - new endVal is not a number: "+wi);_t.error="",wi!==_t.frameVal&&(cancelAnimationFrame(_t.rAF),_t.paused=!1,delete _t.startTime,_t.startVal=_t.frameVal,_t.endVal=wi,_t.countDown=_t.startVal>_t.endVal,_t.rAF=requestAnimationFrame(_t.count))}},_t.initialize()&&_t.printValue(_t.startVal)};return ve})})(ju,ju.exports);var Vb=ju.exports;const Db={name:"CountUp",props:{start:{type:Number,required:!1,default:0},end:{type:Number,required:!0},decimals:{type:Number,required:!1,default:0},duration:{type:Number,required:!1,default:2},options:{type:Object,required:!1,default(){return{}}},callback:{type:Function,required:!1,default:()=>{}}},data(){return{CountUp:null}},watch:{end(K){this.CountUp&&this.CountUp.update&&this.CountUp.update(K)}},mounted(){this.init()},methods:{init(){this.CountUp||(this.CountUp=new Vb(this.$el,this.start,this.end,this.decimals,this.duration,this.options),this.CountUp.start(()=>{this.callback(this.CountUp)}))},destroy(){this.CountUp=null}},beforeUnmounted(){this.destroy()},start(K){this.CountUp&&this.CountUp.start&&this.CountUp.start(()=>{K&&K(this.CountUp)})},pauseResume(){this.CountUp&&this.CountUp.pauseResume&&this.CountUp.pauseResume()},reset(){this.CountUp&&this.CountUp.reset&&this.CountUp.reset()},update(K){this.CountUp&&this.CountUp.update&&this.CountUp.update(K)}},Nb={class:"ivu-count-up"};function $b(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("span",Nb)}var rp=Y(Db,[["render",$b]]),ao={},ip=/d{1,4}|M{1,4}|yy(?:yy)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,ha=/\d\d?/,Lb=/\d{3}/,Fb=/\d{4}/,cc=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,np=function(){};function sp(K,se){for(var me=[],Be=0,Re=K.length;Be<Re;Be++)me.push(K[Be].substr(0,se));return me}function op(K){return function(se,me,Be){var Re=Be[K].indexOf(me.charAt(0).toUpperCase()+me.substr(1).toLowerCase());~Re&&(se.month=Re)}}function bo(K,se){for(K=String(K),se=se||2;K.length<se;)K="0"+K;return K}var ap=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],lp=["January","February","March","April","May","June","July","August","September","October","November","December"],Ub=sp(lp,3),zb=sp(ap,3);ao.i18n={dayNamesShort:zb,dayNames:ap,monthNamesShort:Ub,monthNames:lp,amPm:["am","pm"],DoFn:function(K){return K+["th","st","nd","rd"][K%10>3?0:(K-K%10!==10)*K%10]}};var cp={D:function(K){return K.getDay()},DD:function(K){return bo(K.getDay())},Do:function(K,se){return se.DoFn(K.getDate())},d:function(K){return K.getDate()},dd:function(K){return bo(K.getDate())},ddd:function(K,se){return se.dayNamesShort[K.getDay()]},dddd:function(K,se){return se.dayNames[K.getDay()]},M:function(K){return K.getMonth()+1},MM:function(K){return bo(K.getMonth()+1)},MMM:function(K,se){return se.monthNamesShort[K.getMonth()]},MMMM:function(K,se){return se.monthNames[K.getMonth()]},yy:function(K){return String(K.getFullYear()).substr(2)},yyyy:function(K){return K.getFullYear()},h:function(K){return K.getHours()%12||12},hh:function(K){return bo(K.getHours()%12||12)},H:function(K){return K.getHours()},HH:function(K){return bo(K.getHours())},m:function(K){return K.getMinutes()},mm:function(K){return bo(K.getMinutes())},s:function(K){return K.getSeconds()},ss:function(K){return bo(K.getSeconds())},S:function(K){return Math.round(K.getMilliseconds()/100)},SS:function(K){return bo(Math.round(K.getMilliseconds()/10),2)},SSS:function(K){return bo(K.getMilliseconds(),3)},a:function(K,se){return K.getHours()<12?se.amPm[0]:se.amPm[1]},A:function(K,se){return K.getHours()<12?se.amPm[0].toUpperCase():se.amPm[1].toUpperCase()},ZZ:function(K){var se=K.getTimezoneOffset();return(se>0?"-":"+")+bo(Math.floor(Math.abs(se)/60)*100+Math.abs(se)%60,4)}},as={d:[ha,function(K,se){K.day=se}],M:[ha,function(K,se){K.month=se-1}],yy:[ha,function(K,se){var me=new Date,Be=+(""+me.getFullYear()).substr(0,2);K.year=""+(se>68?Be-1:Be)+se}],h:[ha,function(K,se){K.hour=se}],m:[ha,function(K,se){K.minute=se}],s:[ha,function(K,se){K.second=se}],yyyy:[Fb,function(K,se){K.year=se}],S:[/\d/,function(K,se){K.millisecond=se*100}],SS:[/\d{2}/,function(K,se){K.millisecond=se*10}],SSS:[Lb,function(K,se){K.millisecond=se}],D:[ha,np],ddd:[cc,np],MMM:[cc,op("monthNamesShort")],MMMM:[cc,op("monthNames")],a:[cc,function(K,se,me){var Be=se.toLowerCase();Be===me.amPm[0]?K.isPm=!1:Be===me.amPm[1]&&(K.isPm=!0)}],ZZ:[/[\+\-]\d\d:?\d\d/,function(K,se){var me=(se+"").match(/([\+\-]|\d\d)/gi),Be;me&&(Be=+(me[1]*60)+parseInt(me[2],10),K.timezoneOffset=me[0]==="+"?Be:-Be)}]};as.DD=as.DD,as.dddd=as.ddd,as.Do=as.dd=as.d,as.mm=as.m,as.hh=as.H=as.HH=as.h,as.MM=as.M,as.ss=as.s,as.A=as.a,ao.masks={default:"ddd MMM dd yyyy HH:mm:ss",shortDate:"M/D/yy",mediumDate:"MMM d, yyyy",longDate:"MMMM d, yyyy",fullDate:"dddd, MMMM d, yyyy",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},ao.format=function(K,se,me){var Be=me||ao.i18n;if(typeof K=="number"&&(K=new Date(K)),Object.prototype.toString.call(K)!=="[object Date]"||isNaN(K.getTime()))throw new Error("Invalid Date in fecha.format");return se=ao.masks[se]||se||ao.masks.default,se.replace(ip,function(Re){return Re in cp?cp[Re](K,Be):Re.slice(1,Re.length-1)})},ao.parse=function(K,se,me){var Be=me||ao.i18n;if(typeof se!="string")throw new Error("Invalid format in fecha.parse");if(se=ao.masks[se]||se,K.length>1e3)return!1;var Re=!0,ve={};if(se.replace(ip,function(tt){if(as[tt]){var Ze=as[tt],it=K.search(Ze[0]);~it?K.replace(Ze[0],function(nr){return Ze[1](ve,nr,Be),K=K.substr(it+nr.length),nr}):Re=!1}return as[tt]?"":tt.slice(1,tt.length-1)}),!Re)return!1;var Fe=new Date;ve.isPm===!0&&ve.hour!=null&&+ve.hour!=12?ve.hour=+ve.hour+12:ve.isPm===!1&&+ve.hour==12&&(ve.hour=0);var Xe;return ve.timezoneOffset!=null?(ve.minute=+(ve.minute||0)-+ve.timezoneOffset,Xe=new Date(Date.UTC(ve.year||Fe.getFullYear(),ve.month||0,ve.day||1,ve.hour||0,ve.minute||0,ve.second||0,ve.millisecond||0))):Xe=new Date(ve.year||Fe.getFullYear(),ve.month||0,ve.day||1,ve.hour||0,ve.minute||0,ve.second||0,ve.millisecond||0),Xe};const Hu=function(K){let se=new Date(K);return isNaN(se.getTime())&&typeof K=="string"&&(se=K.split("-").map(Number),se[1]+=1,se=new Date(...se)),isNaN(se.getTime())?null:se},Ms=function(K){const se=new Date(K);return se.setHours(0,0,0,0),se.getTime()},Wb=(K,se,me)=>{if(!se||!me)return!1;const[Be,Re]=[se,me].sort();return K>=Be&&K<=Re},Sl=function(K,se){return K=Hu(K),K?ao.format(K,se||"yyyy-MM-dd"):""},uc=function(K,se){return ao.parse(K,se||"yyyy-MM-dd")},up=function(K,se){return new Date(K,se+1,0).getDate()},hp=function(K,se){const me=new Date(K),Be=me.getMonth()+se,Re=up(me.getFullYear(),Be);return Re<me.getDate()&&me.setDate(Re),me.setMonth(Be),me},xo=function(){const K=new Date;return K.setHours(0),K.setMinutes(0),K.setSeconds(0),K},Xu=function(){const K={yyyy:me=>me.getFullYear(),m:me=>me.getMonth()+1,mm:me=>("0"+(me.getMonth()+1)).slice(-2),mmm:(me,Be)=>me.toLocaleDateString(Be,{month:"long"}).slice(0,3),Mmm:(me,Be)=>{const Re=me.toLocaleDateString(Be,{month:"long"});return(Re[0].toUpperCase()+Re.slice(1).toLowerCase()).slice(0,3)},mmmm:(me,Be)=>me.toLocaleDateString(Be,{month:"long"}),Mmmm:(me,Be)=>{const Re=me.toLocaleDateString(Be,{month:"long"});return Re[0].toUpperCase()+Re.slice(1).toLowerCase()}},se=new RegExp(["yyyy","Mmmm","mmmm","Mmm","mmm","mm","m"].join("|"),"g");return function(me,Be,Re){const ve=/(\[[^\]]+\])([^\[\]]+)(\[[^\]]+\])/,Fe=Be.match(ve).slice(1),Xe=Fe[1],tt=[Fe[0],Fe[2]].map(Ze=>({label:Ze.replace(/\[[^\]]+\]/,it=>it.slice(1,-1).replace(se,nr=>K[nr](Re,me))),type:Ze.indexOf("yy")!=-1?"year":"month"}));return{separator:Xe,labels:tt}}}(),dp={date:"yyyy-MM-dd",month:"yyyy-MM",year:"yyyy",datetime:"yyyy-MM-dd HH:mm:ss",time:"HH:mm:ss",timerange:"HH:mm:ss",daterange:"yyyy-MM-dd",datetimerange:"yyyy-MM-dd HH:mm:ss"},wl=function(K,se){return Sl(K,se)},Ol=function(K,se){return uc(K,se)},qu=function(K,se,me){if(Array.isArray(K)&&K.length===2){const Be=K[0],Re=K[1];if(Be&&Re)return Sl(Be,se)+me+Sl(Re,se)}else if(!Array.isArray(K)&&K instanceof Date)return Sl(K,se);return""},Qu=function(K,se,me){const Be=Array.isArray(K)?K:K.split(me);if(Be.length===2){const Re=Be[0],ve=Be[1];return[Re instanceof Date?Re:uc(Re,se),ve instanceof Date?ve:uc(ve,se)]}return[]},Ma={default:{formatter(K){return K?""+K:""},parser(K){return K===void 0||K===""?null:K}},date:{formatter:wl,parser:Ol},datetime:{formatter:wl,parser:Ol},daterange:{formatter:qu,parser:Qu},datetimerange:{formatter:qu,parser:Qu},timerange:{formatter:qu,parser:Qu},time:{formatter:wl,parser:Ol},month:{formatter:wl,parser:Ol},year:{formatter:wl,parser:Ol},multiple:{formatter:(K,se)=>K.filter(Boolean).map(me=>Sl(me,se)).join(","),parser:(K,se)=>(typeof K=="string"?K.split(","):K).map(me=>me instanceof Date?me:(typeof me=="string"?me=me.trim():typeof me!="number"&&!me&&(me=""),uc(me,se)))},number:{formatter(K){return K?""+K:""},parser(K){let se=Number(K);return isNaN(K)?null:se}}},hc="ivu-date-picker",Gb="ivu-picker",jb=K=>K.reduce((se,me)=>se&&!me||typeof me=="string"&&me.trim()==="",!0),Hb={40:"up",39:"right",38:"down",37:"left"},Ba=(K,se,me)=>{if(K==="left")return se*-1;if(K==="right")return se*1;if(K==="up")return me*1;if(K==="down")return me*-1},Xb=K=>{const se="ivu-date-picker-btn-pulse";K.classList.add(se),setTimeout(()=>K.classList.remove(se),200)},Yu=K=>K?[K.getHours(),K.getMinutes(),K.getSeconds()]:[0,0,0],qb={mixins:[In,io],components:{iInput:Js,Drop:ki,Icon:Ae},directives:{clickOutside:Rn},emits:["on-clickoutside","on-clear","on-change","on-ok","on-open-change","update:modelValue"],provide(){return{PickerInstance:this}},props:{format:{type:String},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},confirm:{type:Boolean,default:!1},open:{type:Boolean,default:null},multiple:{type:Boolean,default:!1},timePickerOptions:{type:Object,default:()=>({})},splitPanels:{type:Boolean,default:!1},showWeekNumbers:{type:Boolean,default:!1},startDate:{type:Date},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},placeholder:{type:String,default:""},placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom-start"},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},name:{type:String},elementId:{type:String},steps:{type:Array,default:()=>[]},modelValue:{type:[Date,String,Array]},options:{type:Object,default:()=>({})},separator:{type:String,default:" - "},capture:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return K.$VIEWUI?K.$VIEWUI.capture:!0}},transferClassName:{type:String},eventsEnabled:{type:Boolean,default:!1}},data(){const K=this.type.includes("range"),se=K?[null,null]:[null],me=jb((K?this.modelValue:[this.modelValue])||[])?se:this.parseDate(this.modelValue),Be=me.map(Yu);return{prefixCls:hc,showClose:!1,visible:!1,internalValue:me,disableClickOutSide:!1,disableCloseUnderTransfer:!1,selectionMode:this.onSelectionModeChange(this.type),forceInputRerender:1,isFocused:!1,focusedDate:me[0]||this.startDate||new Date,focusedTime:{column:0,picker:0,time:Be,active:!1},internalFocus:!1,isValueNull:!1,timeSpinnerList:[],panelTableList:[]}},computed:{wrapperClasses(){return[hc,{[hc+"-focused"]:this.isFocused}]},publicVModelValue(){if(this.multiple)return this.internalValue.slice();{const K=this.type.includes("range");let se=this.internalValue.map(me=>me instanceof Date?new Date(me):me||"");return this.type.match(/^time/)&&(se=se.map(this.formatDate)),K||this.multiple?se:se[0]}},publicStringValue(){const{formatDate:K,publicVModelValue:se,type:me}=this;return me.match(/^time/)?se:this.multiple?K(se):Array.isArray(se)?se.map(K):K(se)},opened(){return this.open===null?this.visible:this.open},transition(){return this.placement.match(/^bottom/)?"slide-up":"slide-down"},visualValue(){return this.formatDate(this.internalValue)},isConfirm(){return this.confirm||this.type==="datetime"||this.type==="datetimerange"||this.multiple},arrowType(){const K=this.globalConfig;let se="";if(this.type==="time"||this.type==="timerange")se="ios-time-outline",K&&(K.timePicker.customIcon?se="":K.timePicker.icon&&(se=K.timePicker.icon));else{const me=this.globalConfig;se="ios-calendar-outline",me&&(me.datePicker.customIcon?se="":me.datePicker.icon&&(se=me.datePicker.icon))}return this.showClose&&(se="ios-close-circle"),se},customArrowType(){const K=this.globalConfig;let se="";return this.showClose||(this.type==="time"||this.type==="timerange"?K&&K.timePicker.customIcon&&(se=K.timePicker.customIcon):K&&K.datePicker.customIcon&&(se=K.datePicker.customIcon)),se},arrowSize(){const K=this.globalConfig;let se="";return this.showClose||(this.type==="time"||this.type==="timerange"?K&&K.timePicker.iconSize&&(se=K.timePicker.iconSize):K&&K.datePicker.iconSize&&(se=K.datePicker.iconSize)),se},dropdownCls(){return{[hc+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}}},methods:{onSelectionModeChange(K){return K.match(/^date/)&&(K="date"),this.selectionMode=Ie(K,["year","month","date","time"])&&K,this.selectionMode},handleTransferClick(){this.transfer&&(this.disableCloseUnderTransfer=!0)},handleClose(K){if(this.disableCloseUnderTransfer)return this.disableCloseUnderTransfer=!1,!1;if(K&&K.type==="mousedown"&&this.visible){K.preventDefault(),K.stopPropagation();return}if(this.visible){const se=this.$refs.pickerPanel&&this.$refs.pickerPanel.$el;if(K&&se&&se.contains(K.target))return;this.visible=!1,K&&K.preventDefault(),K&&K.stopPropagation(),this.$emit("on-clickoutside",K);return}this.isFocused=!1,this.disableClickOutSide=!1},handleFocus(K){this.readonly||(this.isFocused=!0,!(K&&K.type==="focus")&&(this.itemDisabled||(this.visible=!0)))},handleBlur(K){if(this.internalFocus){this.internalFocus=!1;return}if(this.visible){K.preventDefault();return}this.isFocused=!1,this.onSelectionModeChange(this.type),this.internalValue=this.internalValue.slice(),this.reset(),this.$refs.pickerPanel.onToggleVisibility(!1)},handleKeydown(K){const se=K.keyCode;if(se===9)if(this.visible)if(K.stopPropagation(),K.preventDefault(),this.isConfirm){const Be=`.${Gb}-confirm > *`,Re=this.$refs.drop.$el.querySelectorAll(Be);this.internalFocus=!0,[...Re][K.shiftKey?"pop":"shift"]().focus()}else this.handleClose();else this.focused=!1;const me=[37,38,39,40];if(!this.visible&&me.includes(se)){this.visible=!0;return}if(se===27&&this.visible&&(K.stopPropagation(),this.handleClose()),se===13){const Be=this.timeSpinnerList.map(Re=>Re.timeSpinner);if(Be.length>0){const Re=Be[0].showSeconds?3:2,ve=Math.floor(this.focusedTime.column/Re),Fe=this.focusedTime.time[ve];Be[ve].chooseValue(Fe);return}if(this.type.match(/range/))this.$refs.pickerPanel.handleRangePick(this.focusedDate,"date");else{const Re=this.panelTableList.map(Fe=>Fe.panelTable),ve=Fe=>{const Xe=["year","month","date"].indexOf(this.type)+1;return[Fe.getFullYear(),Fe.getMonth(),Fe.getDate()].slice(0,Xe).join("-")};Re.find(({cells:Fe})=>Fe.find(({date:Xe,disabled:tt})=>ve(Xe)===ve(this.focusedDate)&&!tt))&&this.onPick(this.focusedDate,!1,"date")}}!me.includes(se)||(this.focusedTime.active&&K.preventDefault(),this.navigateDatePanel(Hb[se],K.shiftKey))},reset(){this.$refs.pickerPanel.reset&&this.$refs.pickerPanel.reset()},navigateTimePanel(K){this.focusedTime.active=!0;const se=K.match(/left|right/),me=K.match(/up|down/),Be=this.timeSpinnerList.map(Ze=>Ze.timeSpinner),Re=(Be[0].showSeconds?3:2)*Be.length,ve=(Ze=>(Ze+(se?K==="left"?-1:1:0)+Re)%Re)(this.focusedTime.column),Fe=Re/Be.length,Xe=Math.floor(ve/Fe),tt=ve%Fe;if(se){const Ze=this.internalValue.map(Yu);this.focusedTime={...this.focusedTime,column:ve,time:Ze},Be.forEach((it,nr)=>{nr===Xe?it.updateFocusedTime(tt,Ze[Xe]):it.updateFocusedTime(-1,it.focusedTime)})}if(me){const Ze=K==="up"?1:-1,it=["hours","minutes","seconds"],nr=Be[Xe][`${it[tt]}List`],jr=(nr.findIndex(({text:_t})=>this.focusedTime.time[Xe][tt]===_t)+Ze+nr.length)%nr.length,zr=nr[jr].text,Fr=this.focusedTime.time.map((_t,ni)=>(ni!==Xe||(_t[tt]=zr),_t));this.focusedTime={...this.focusedTime,time:Fr},Be.forEach((_t,ni)=>{ni===Xe?_t.updateFocusedTime(tt,Fr[ni]):_t.updateFocusedTime(-1,_t.focusedTime)})}},navigateDatePanel(K,se){const me=this.timeSpinnerList.map(ve=>ve.timeSpinner);if(me.length>0){this.navigateTimePanel(K,se,me);return}if(se){this.type==="year"?this.focusedDate=new Date(this.focusedDate.getFullYear()+Ba(K,0,10),this.focusedDate.getMonth(),this.focusedDate.getDate()):this.focusedDate=new Date(this.focusedDate.getFullYear()+Ba(K,0,1),this.focusedDate.getMonth()+Ba(K,1,0),this.focusedDate.getDate());const ve=K.match(/left|down/)?"prev":"next",Fe=K.match(/up|down/)?"-double":"",Xe=this.$refs.drop.$el.querySelector(`.ivu-date-picker-${ve}-btn-arrow${Fe}`);Xe&&Xb(Xe);return}const Be=this.focusedDate||this.internalValue&&this.internalValue[0]||new Date,Re=new Date(Be);if(this.type.match(/^date/)){const ve=up(Be.getFullYear(),Be.getMonth()),Fe=Be.getDate(),Xe=Re.getDate()+Ba(K,1,7);Xe<1?K.match(/left|right/)?(Re.setMonth(Re.getMonth()+1),Re.setDate(Xe)):Re.setDate(Fe+Math.floor((ve-Fe)/7)*7):Xe>ve?K.match(/left|right/)?(Re.setMonth(Re.getMonth()-1),Re.setDate(Xe)):Re.setDate(Fe%7):Re.setDate(Xe)}this.type.match(/^month/)&&Re.setMonth(Re.getMonth()+Ba(K,1,3)),this.type.match(/^year/)&&Re.setFullYear(Re.getFullYear()+Ba(K,1,3)),this.focusedDate=Re},handleInputChange(K){const se=this.type.includes("range")||this.multiple,me=this.visualValue,Be=K.target.value,Re=this.parseDate(Be),ve=this.options&&typeof this.options.disabledDate=="function"&&this.options.disabledDate,Fe=se?Re:Re[0],Xe=ve&&ve(Fe),tt=Re.reduce((Ze,it)=>Ze&&it instanceof Date,!0);Be!==me&&!Xe&&tt?(this.emitChange(this.type),this.internalValue=Re):this.forceInputRerender++},handleInputMouseenter(){this.readonly||this.itemDisabled||this.visualValue&&this.clearable&&(this.showClose=!0)},handleInputMouseleave(){this.showClose=!1},handleIconClick(K){this.showClose?(K&&K.stopPropagation(),this.handleClear()):this.itemDisabled||this.handleFocus()},handleClear(){this.visible=!1,this.internalValue=this.internalValue.map(()=>null),this.$emit("on-clear"),this.handleFormItemChange("change",""),this.emitChange(this.type),this.reset(),setTimeout(()=>this.onSelectionModeChange(this.type),500)},emitChange(K){E.nextTick(()=>{this.$emit("on-change",this.publicStringValue,K),this.handleFormItemChange("change",this.publicStringValue)})},parseDate(K){const se=this.type.includes("range"),me=this.type,Be=(Ma[me]||Ma.default).parser,Re=this.format||dp[me],ve=Ma.multiple.parser;if(K&&me==="time"&&!(K instanceof Date))K=Be(K,Re,this.separator);else if(this.multiple&&K)K=ve(K,Re,this.separator);else if(se)if(!K)K=[null,null];else if(typeof K=="string")K=Be(K,Re,this.separator);else if(me==="timerange")K=Be(K,Re,this.separator).map(Fe=>Fe||"");else{const[Fe,Xe]=K;Fe instanceof Date&&Xe instanceof Date?K=K.map(tt=>new Date(tt)):typeof Fe=="string"&&typeof Xe=="string"?K=Be(K.join(this.separator),Re,this.separator):(!Fe||!Xe)&&(K=[null,null])}else typeof K=="string"&&me.indexOf("time")!==0&&(K=Be(K,Re)||null);return se||this.multiple?K||[]:[K]},formatDate(K){const se=dp[this.type];if(this.multiple){const me=Ma.multiple.formatter;return me(K,this.format||se,this.separator)}else{const{formatter:me}=Ma[this.type]||Ma.default;return me(K,this.format||se,this.separator)}},onPick(K,se=!1,me){if(this.multiple){const Be=K.getTime(),Re=this.internalValue.findIndex(Fe=>Fe&&Fe.getTime()===Be),ve=[...this.internalValue,K].filter(Boolean).map(Fe=>Fe.getTime()).filter((Fe,Xe,tt)=>tt.indexOf(Fe)===Xe&&Xe!==Re);this.internalValue=ve.map(Fe=>new Date(Fe))}else K=this.parseDate(K),this.internalValue=Array.isArray(K)?K:[K];this.internalValue[0]&&(this.focusedDate=this.internalValue[0]),this.focusedTime={...this.focusedTime,time:this.internalValue.map(Yu)},this.isConfirm||this.onSelectionModeChange(this.type),this.isConfirm||(this.visible=!!se),this.emitChange(me)},onPickSuccess(){this.visible=!1,this.$emit("on-ok"),this.focus(),this.reset()},focus(){this.$refs.input&&this.$refs.input.focus()},updatePopper(){this.$refs.drop.update()},handleOnFocusInput(){this.focus()},handleOnUpdatePopper(){this.updatePopper()}},watch:{visible(K){K===!1&&this.$refs.drop.destroy(),K&&this.$refs.drop.update(),this.$emit("on-open-change",K)},modelValue(K){K===null&&(this.isValueNull=!0),this.internalValue=this.parseDate(K)},open(K){this.visible=K===!0},type(K){this.onSelectionModeChange(K)},publicVModelValue(K,se){const me=JSON.stringify(K),Be=JSON.stringify(se);(me!==Be||typeof K!=typeof se)&&(this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",K))}},mounted(){this.open!==null&&(this.visible=this.open)}};function Qb(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("i-input"),tt=E.resolveComponent("Drop"),Ze=E.resolveDirective("click-outside");return E.withDirectives((E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapperClasses)},[E.createElementVNode("div",{ref:"reference",class:E.normalizeClass([Re.prefixCls+"-rel"])},[E.renderSlot(K.$slots,"default",{},()=>[(E.openBlock(),E.createBlock(Xe,{key:Re.forceInputRerender,"element-id":me.elementId,class:E.normalizeClass([Re.prefixCls+"-editor"]),readonly:!me.editable||me.readonly,disabled:K.itemDisabled,size:me.size,placeholder:me.placeholder,"model-value":ve.visualValue,name:me.name,ref:"input",onOnInputChange:ve.handleInputChange,onOnFocus:ve.handleFocus,onOnBlur:ve.handleBlur,onClick:ve.handleFocus,onKeydown:ve.handleKeydown,onMouseenter:ve.handleInputMouseenter,onMouseleave:ve.handleInputMouseleave},{suffix:E.withCtx(()=>[E.createVNode(Fe,{onClick:ve.handleIconClick,type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize},null,8,["onClick","type","custom","size"])]),_:1},8,["element-id","class","readonly","disabled","size","placeholder","model-value","name","onOnInputChange","onOnFocus","onOnBlur","onClick","onKeydown","onMouseenter","onMouseleave"]))])],2),E.createVNode(tt,{ref:"drop",visible:ve.opened,classes:ve.dropdownCls,placement:me.placement,eventsEnabled:me.eventsEnabled,transfer:me.transfer,"transition-name":"transition-drop",onClick:ve.handleTransferClick},{default:E.withCtx(()=>[E.createElementVNode("div",null,[(E.openBlock(),E.createBlock(E.resolveDynamicComponent(K.panel),E.mergeProps({ref:"pickerPanel",visible:Re.visible,showTime:K.type==="datetime"||K.type==="datetimerange",confirm:ve.isConfirm,selectionMode:Re.selectionMode,steps:me.steps,format:me.format,"model-value":Re.internalValue,"start-date":me.startDate,"split-panels":me.splitPanels,"show-week-numbers":me.showWeekNumbers,"picker-type":K.type,multiple:me.multiple,"focused-date":Re.focusedDate,"time-picker-options":me.timePickerOptions},K.ownPickerProps,{onOnPick:ve.onPick,onOnPickClear:ve.handleClear,onOnPickSuccess:ve.onPickSuccess,onOnPickClick:se[0]||(se[0]=it=>Re.disableClickOutSide=!0),onOnSelectionModeChange:ve.onSelectionModeChange}),null,16,["visible","showTime","confirm","selectionMode","steps","format","model-value","start-date","split-panels","show-week-numbers","picker-type","multiple","focused-date","time-picker-options","onOnPick","onOnPickClear","onOnPickSuccess","onOnSelectionModeChange"]))])]),_:1},8,["visible","classes","placement","eventsEnabled","transfer","onClick"])],2)),[[Ze,ve.handleClose,me.capture,{mousedown:!0}],[Ze,ve.handleClose,me.capture,{touchstart:!0}],[Ze,ve.handleClose,me.capture]])}var pp=Y(qb,[["render",Qb]]),fp=1e3*60*60*24;function mp(K,se){return new Date(K,se+1,0).getDate()}function gp(K,se,me){return se===0&&me>50?K-1:se===11&&me<10?K+1:K}function yp(K,se,me,Be){se>11&&(se=0,K++);var Re=new Date(K,se,me);Be&&Re.setDate(Re.getDate()+4-(Re.getDay()||7));var ve=Be?Re.getFullYear():K,Fe=new Date(ve,0,1),Xe=1+Math.round((Re-Fe)/fp);Be||(Xe+=Fe.getDay());var tt=Math.ceil(Xe/7);if(!Be){var Ze=new Date(K,se,me),it=new Date(K+1,0,1),nr=it.getDay();Ze.getTime()>=it.getTime()-fp*nr&&(tt=1)}return tt}function Yb(K,se,me){for(var Be=this.lang||"en",Re=this.onlyDays,ve=typeof this.weekStart>"u"?1:this.weekStart,Fe=ve===1,Xe=[],tt=new Date(K,se,1),Ze=tt.getDay()||(Fe?7:0),it=ve-Ze,nr=yp(K,se,1,Fe),jr=mp(K,se),zr=mp(K,se-1),Fr,_t,ni,on=gp(K,se,nr),Gi={month:se,year:K,daysInMonth:jr},Qi=0;Qi<7;Qi++){ni=it;for(var wi=0;wi<8;wi++){Qi>0&&wi>0&&it++,it>jr||it<1?(_t=it>jr?it-jr:zr+it,Fr=it>jr?se+1:se-1):(_t=it,Fr=se);var li=function(){return wi===0?"weekLabel":Qi===0?"dayLabel":it<1?"prevMonth":it>jr?"nextMonth":"monthDay"}(),Vi=ni!==it&&Qi>0,Pi={desc:Vi?_t:nr,week:nr,type:li,format:Fe?"ISO 8601":"US",date:Vi?new Date(Date.UTC(K,Fr,_t)):!1,year:on,index:Xe.length};me&&(typeof me=="function"?Pi=me.call(Gi,Pi,Be):me.forEach(function(pn){Pi=pn.call(Gi,Pi,Be)})),Re&&Vi?Xe.push(Pi):Re||Xe.push(Pi)}Qi>0&&(nr=yp(K,Fr,_t+1,Fe)),on=gp(K,se,nr)}return Gi.cells=Xe,Gi}var Kb=function(K){return Yb.bind(K)},Zb={weekPlaceholder:"",columnNames:{en:{0:"w",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday",7:"sunday"},sv:{0:"v",1:"mndag",2:"tisdag",3:"onsdag",4:"torsdag",5:"fredag",6:"lrdag",7:"sndag"},pt:{0:"s",1:"segunda",2:"tera",3:"quarta",4:"quinta",5:"sexta",6:"sbado",7:"domingo"}},monthNames:{en:["January","February","March","April","May","June","July","August","September","October","November","December"],sv:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],pt:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"]},classes:{dayLabel:"day-of-week",weekLabel:"week-number",prevMonth:"inactive",nextMonth:"inactive",monthDay:"day-in-month"}},So=Zb;function Jb(K){return K==null?!1:K.constructor===Array||K.constructor===Object}function _p(K,se){for(var me in K)se[me]?Jb(K[me])&&_p(K[me],se[me]):se[me]=K[me]}function vp(K,se){var me=[So.classes[K.type]];return K.class?K.class=(typeof K.class=="string"?[K.class]:K.class).concat(me):K.class=me,K.type.indexOf("Label")>0&&(K.index==0&&So.weekPlaceholder?K.desc=So.weekPlaceholder:K.index<8?K.desc=So.columnNames[se][K.index]:K.index%8==0&&(K.desc=K.week)),K.date&&(K.monthName=So.monthNames[se][K.date.getMonth()]),this.monthName||(this.monthName=So.monthNames[se][this.month]),this.labels||(this.labels={monthNames:So.monthNames[se],columnNames:So.columnNames[se],classes:So.classes}),K}vp.setLabels=function(K){_p(K,So)};var ex=vp,tx={Generator:Kb,addLabels:ex},Ku={name:"PanelTable",emits:["on-pick","on-pick-click","on-change-range"],inject:["PickerInstance"],props:{tableDate:{type:Date,required:!0},disabledDate:{type:Function},selectionMode:{type:String,required:!0},modelValue:{type:Array,required:!0},rangeState:{type:Object,default:()=>({from:null,to:null,selecting:!1})},focusedDate:{type:Date,required:!0}},data(){return{id:gt(6)}},computed:{dates(){const{selectionMode:K,modelValue:se,rangeState:me}=this;return K==="range"&&me.selecting?[me.from]:se}},methods:{handleClick(K,se){if(se.stopPropagation(),K.disabled||K.type==="weekLabel")return;const me=new Date(Ms(K.date));this.$emit("on-pick",me),this.$emit("on-pick-click")},handleMouseMove(K){if(!this.rangeState.selecting||K.disabled)return;const se=K.date;this.$emit("on-change-range",se)},addPanelTable(){const K=this.PickerInstance;K.panelTableList||(K.panelTableList=[]),K.panelTableList.push({id:this.id,panelTable:this})},removePanelTable(){const K=this.PickerInstance;if(K.panelTableList&&K.panelTableList.length){const se=K.panelTableList.findIndex(me=>me.id===this.id);K.panelTableList.splice(se,1)}}},mounted(){this.addPanelTable()},beforeUnmount(){this.removePanelTable()}},Jn="ivu-date-picker-cells";const rx={mixins:[Xn,Ku],props:{showWeekNumbers:{type:Boolean,default:!1}},computed:{classes(){return[`${Jn}`,{[`${Jn}-show-week-numbers`]:this.showWeekNumbers}]},calendar(){const K=Number(this.t("i.datepicker.weekStartDay"));return new tx.Generator({onlyDays:!this.showWeekNumbers,weekStart:K})},headerDays(){const K=Number(this.t("i.datepicker.weekStartDay")),se=["sun","mon","tue","wed","thu","fri","sat"].map(Be=>this.t("i.datepicker.weeks."+Be)),me=se.splice(K,7-K).concat(se.splice(0,K));return this.showWeekNumbers?[""].concat(me):me},cells(){const K=this.tableDate.getFullYear(),se=this.tableDate.getMonth(),me=Ms(new Date),Be=this.dates.filter(Boolean).map(Ms),[Re,ve]=this.dates.map(Ms),Fe=this.rangeState.from&&Ms(this.rangeState.from),Xe=this.rangeState.to&&Ms(this.rangeState.to),tt=this.selectionMode==="range",Ze=typeof this.disabledDate=="function"&&this.disabledDate;return this.calendar(K,se,it=>{it.date instanceof Date&&it.date.setTime(it.date.getTime()+it.date.getTimezoneOffset()*6e4+480*60*1e3);const nr=it.date&&Ms(it.date),jr=it.date&&se===it.date.getMonth();return{...it,type:nr===me?"today":it.type,selected:jr&&Be.includes(nr),disabled:it.date&&Ze&&Ze(new Date(nr)),range:jr&&tt&&Wb(nr,Fe,Xe),start:jr&&tt&&nr===Re,end:jr&&tt&&nr===ve}}).cells.slice(this.showWeekNumbers?8:0)}},methods:{getCellCls(K){return[`${Jn}-cell`,{[`${Jn}-cell-selected`]:K.selected||K.start||K.end,[`${Jn}-cell-disabled`]:K.disabled,[`${Jn}-cell-today`]:K.type==="today",[`${Jn}-cell-prev-month`]:K.type==="prevMonth",[`${Jn}-cell-next-month`]:K.type==="nextMonth",[`${Jn}-cell-week-label`]:K.type==="weekLabel",[`${Jn}-cell-range`]:K.range&&!K.start&&!K.end,[`${Jn}-focused`]:Ms(K.date)===Ms(this.focusedDate)}]}}},ix={class:"ivu-date-picker-cells-header"},nx=["onClick","onMouseenter"];function sx(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("div",ix,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.headerDays,Fe=>(E.openBlock(),E.createElementBlock("span",{key:Fe},E.toDisplayString(Fe),1))),128))]),(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.cells,(Fe,Xe)=>(E.openBlock(),E.createElementBlock("span",{key:String(Fe.date)+Xe,class:E.normalizeClass(ve.getCellCls(Fe)),onClick:tt=>K.handleClick(Fe,tt),onMouseenter:tt=>K.handleMouseMove(Fe)},[E.createElementVNode("em",null,E.toDisplayString(Fe.desc),1)],42,nx))),128))],2)}var bp=Y(rx,[["render",sx]]);const ox={mixins:[Ku],props:{},computed:{classes(){return[`${Jn}`,`${Jn}-year`]},startYear(){return Math.floor(this.tableDate.getFullYear()/10)*10},cells(){let K=[];const se={text:"",selected:!1,disabled:!1},me=this.dates.filter(Boolean).map(Re=>Ms(new Date(Re.getFullYear(),0,1))),Be=Ms(new Date(this.focusedDate.getFullYear(),0,1));for(let Re=0;Re<10;Re++){const ve=Qe(se);ve.date=new Date(this.startYear+Re,0,1),ve.disabled=typeof this.disabledDate=="function"&&this.disabledDate(ve.date)&&this.selectionMode==="year";const Fe=Ms(ve.date);ve.selected=me.includes(Fe),ve.focused=Fe===Be,K.push(ve)}return K}},methods:{getCellCls(K){return[`${Jn}-cell`,{[`${Jn}-cell-selected`]:K.selected,[`${Jn}-cell-disabled`]:K.disabled,[`${Jn}-cell-focused`]:K.focused,[`${Jn}-cell-range`]:K.range&&!K.start&&!K.end}]}}},ax=["onClick","onMouseenter"];function lx(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.cells,Fe=>(E.openBlock(),E.createElementBlock("span",{class:E.normalizeClass(ve.getCellCls(Fe)),key:Fe.date,onClick:Xe=>K.handleClick(Fe,Xe),onMouseenter:Xe=>K.handleMouseMove(Fe)},[E.createElementVNode("em",null,E.toDisplayString(Fe.date.getFullYear()),1)],42,ax))),128))],2)}var xp=Y(ox,[["render",lx]]);const cx={mixins:[Xn,Ku],props:{},computed:{classes(){return[`${Jn}`,`${Jn}-month`]},cells(){let K=[];const se={text:"",selected:!1,disabled:!1},me=this.tableDate.getFullYear(),Be=this.dates.filter(Boolean).map(ve=>Ms(new Date(ve.getFullYear(),ve.getMonth(),1))),Re=Ms(new Date(this.focusedDate.getFullYear(),this.focusedDate.getMonth(),1));for(let ve=0;ve<12;ve++){const Fe=Qe(se);Fe.date=new Date(me,ve,1),Fe.text=this.tCell(ve+1);const Xe=Ms(Fe.date);Fe.disabled=typeof this.disabledDate=="function"&&this.disabledDate(Fe.date)&&this.selectionMode==="month",Fe.selected=Be.includes(Xe),Fe.focused=Xe===Re,K.push(Fe)}return K}},methods:{getCellCls(K){return[`${Jn}-cell`,{[`${Jn}-cell-selected`]:K.selected,[`${Jn}-cell-disabled`]:K.disabled,[`${Jn}-cell-focused`]:K.focused,[`${Jn}-cell-range`]:K.range&&!K.start&&!K.end}]},tCell(K){return this.t(`i.datepicker.months.m${K}`)}}},hx=["onClick","onMouseenter"];function dx(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.cells,Fe=>(E.openBlock(),E.createElementBlock("span",{class:E.normalizeClass(ve.getCellCls(Fe)),key:Fe.text,onClick:Xe=>K.handleClick(Fe,Xe),onMouseenter:Xe=>K.handleMouseMove(Fe)},[E.createElementVNode("em",null,E.toDisplayString(Fe.text),1)],42,hx))),128))],2)}var Sp=Y(cx,[["render",dx]]),dc={props:{disabledHours:{type:Array,default(){return[]}},disabledMinutes:{type:Array,default(){return[]}},disabledSeconds:{type:Array,default(){return[]}},hideDisabledOptions:{type:Boolean,default:!1}}};const da="ivu-time-picker-cells",Zu=["hours","minutes","seconds"],fx={name:"TimeSpinner",mixins:[dc],emits:["on-change","on-pick-click"],inject:["PickerInstance"],props:{hours:{type:[Number,String],default:NaN},minutes:{type:[Number,String],default:NaN},seconds:{type:[Number,String],default:NaN},showSeconds:{type:Boolean,default:!0},steps:{type:Array,default:()=>[]}},data(){return{spinerSteps:[1,1,1].map((K,se)=>Math.abs(this.steps[se])||K),prefixCls:da,compiled:!1,focusedColumn:-1,focusedTime:[0,0,0],id:gt(6)}},computed:{classes(){return[`${da}`,{[`${da}-with-seconds`]:this.showSeconds}]},hoursList(){let K=[];const se=this.spinerSteps[0],me=this.focusedColumn===0&&this.focusedTime[0],Be={text:0,selected:!1,disabled:!1,hide:!1};for(let Re=0;Re<24;Re+=se){const ve=Qe(Be);ve.text=Re,ve.focused=Re===me,this.disabledHours.length&&this.disabledHours.indexOf(Re)>-1&&(ve.disabled=!0,this.hideDisabledOptions&&(ve.hide=!0)),this.hours===Re&&(ve.selected=!0),K.push(ve)}return K},minutesList(){let K=[];const se=this.spinerSteps[1],me=this.focusedColumn===1&&this.focusedTime[1],Be={text:0,selected:!1,disabled:!1,hide:!1};for(let Re=0;Re<60;Re+=se){const ve=Qe(Be);ve.text=Re,ve.focused=Re===me,this.disabledMinutes.length&&this.disabledMinutes.indexOf(Re)>-1&&(ve.disabled=!0,this.hideDisabledOptions&&(ve.hide=!0)),this.minutes===Re&&(ve.selected=!0),K.push(ve)}return K},secondsList(){let K=[];const se=this.spinerSteps[2],me=this.focusedColumn===2&&this.focusedTime[2],Be={text:0,selected:!1,disabled:!1,hide:!1};for(let Re=0;Re<60;Re+=se){const ve=Qe(Be);ve.text=Re,ve.focused=Re===me,this.disabledSeconds.length&&this.disabledSeconds.indexOf(Re)>-1&&(ve.disabled=!0,this.hideDisabledOptions&&(ve.hide=!0)),this.seconds===Re&&(ve.selected=!0),K.push(ve)}return K}},methods:{getCellCls(K){return[`${da}-cell`,{[`${da}-cell-selected`]:K.selected,[`${da}-cell-focused`]:K.focused,[`${da}-cell-disabled`]:K.disabled}]},chooseValue(K){const se=Zu.reduce((me,Be,Re)=>{const ve=K[Re];return this[Be]===ve?me:{...me,[Be]:ve}},{});Object.keys(se).length>0&&this.emitChange(se)},handleClick(K,se){if(se.disabled)return;const me={[K]:se.text};this.emitChange(me)},emitChange(K){this.$emit("on-change",K),this.$emit("on-pick-click")},scroll(K,se){const me=this.$refs[K].scrollTop,Be=24*this.getScrollIndex(K,se);Ke(this.$refs[K],me,Be,500)},getScrollIndex(K,se){const me=Le(K),Be=this[`disabled${me}`];if(Be.length&&this.hideDisabledOptions){let Re=0;Be.forEach(ve=>ve<=se?Re++:""),se-=Re}return se},updateScroll(){E.nextTick(()=>{Zu.forEach(K=>{this.$refs[K].scrollTop=24*this[`${K}List`].findIndex(se=>se.text==this[K])})})},formatTime(K){return K<10?"0"+K:K},updateFocusedTime(K,se){this.focusedColumn=K,this.focusedTime=se.slice()},addTimeSpinner(){const K=this.PickerInstance;K.timeSpinnerList||(K.timeSpinnerList=[]),K.timeSpinnerList.push({id:this.id,timeSpinner:this})},removeTimeSpinner(){const K=this.PickerInstance;if(K.timeSpinnerList&&K.timeSpinnerList.length){const se=K.timeSpinnerList.findIndex(me=>me.id===this.id);K.timeSpinnerList.splice(se,1)}}},watch:{hours(K){!this.compiled||this.scroll("hours",this.hoursList.findIndex(se=>se.text==K))},minutes(K){!this.compiled||this.scroll("minutes",this.minutesList.findIndex(se=>se.text==K))},seconds(K){!this.compiled||this.scroll("seconds",this.secondsList.findIndex(se=>se.text==K))},focusedTime(K,se){Zu.forEach((me,Be)=>{if(K[Be]===se[Be]||typeof K[Be]>"u")return;const Re=this[`${me}List`].findIndex(ve=>ve.text===K[Be]);this.scroll(me,Re)})}},mounted(){this.addTimeSpinner(),E.nextTick(()=>this.compiled=!0)},beforeUnmount(){this.removeTimeSpinner()}},mx=["onClick"],gx=["onClick"],yx=["onClick"];function bx(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-list"]),ref:"hours"},[E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls+"-ul"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.hoursList,Fe=>E.withDirectives((E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.getCellCls(Fe)),key:Fe.text,onClick:Xe=>ve.handleClick("hours",Fe)},E.toDisplayString(ve.formatTime(Fe.text)),11,mx)),[[E.vShow,!Fe.hide]])),128))],2)],2),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-list"]),ref:"minutes"},[E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls+"-ul"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.minutesList,Fe=>E.withDirectives((E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.getCellCls(Fe)),key:Fe.text,onClick:Xe=>ve.handleClick("minutes",Fe)},E.toDisplayString(ve.formatTime(Fe.text)),11,gx)),[[E.vShow,!Fe.hide]])),128))],2)],2),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-list"]),ref:"seconds"},[E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls+"-ul"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.secondsList,Fe=>E.withDirectives((E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.getCellCls(Fe)),key:Fe.text,onClick:Xe=>ve.handleClick("seconds",Fe)},E.toDisplayString(ve.formatTime(Fe.text)),11,yx)),[[E.vShow,!Fe.hide]])),128))],2)],2),[[E.vShow,me.showSeconds]])],2)}var wp=Y(fx,[["render",bx]]);const Op="ivu-picker",xx={mixins:[Xn],components:{iButton:As},emits:["on-pick-clear","on-pick-success","on-pick-toggle-time"],inject:["PickerInstance"],props:{showTime:{type:Boolean,default:!1},isTime:{type:Boolean,default:!1},timeDisabled:{type:Boolean,default:!1}},data(){return{prefixCls:Op}},computed:{timeClasses(){return`${Op}-confirm-time`},labels(){const K=["time","clear","ok"],se=[this.isTime?"selectDate":"selectTime","clear","ok"];return K.reduce((me,Be,Re)=>(me[Be]=this.t("i.datepicker."+se[Re]),me),{})}},methods:{handleClear(){this.$emit("on-pick-clear")},handleSuccess(){this.$emit("on-pick-success")},handleToggleTime(){this.timeDisabled||(this.$emit("on-pick-toggle-time"),this.PickerInstance.handleOnFocusInput(),this.PickerInstance.handleOnUpdatePopper())},handleTab(K){const se=[...this.$el.children][K.shiftKey?"shift":"pop"]();W&&document.activeElement===se&&(K.preventDefault(),K.stopPropagation(),this.PickerInstance.handleOnFocusInput())}}};function Sx(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("i-button");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls+"-confirm"]),onKeydownCapture:se[0]||(se[0]=E.withKeys((...Xe)=>ve.handleTab&&ve.handleTab(...Xe),["tab"]))},[me.showTime?(E.openBlock(),E.createBlock(Fe,{key:0,class:E.normalizeClass(ve.timeClasses),size:"small",type:"text",disabled:me.timeDisabled,onClick:ve.handleToggleTime},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ve.labels.time),1)]),_:1},8,["class","disabled","onClick"])):E.createCommentVNode("",!0),E.createVNode(Fe,{size:"small",class:"ivu-picker-confirm-btn-cancel",onClick:ve.handleClear,onKeydown:E.withKeys(ve.handleClear,["enter"])},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ve.labels.clear),1)]),_:1},8,["onClick","onKeydown"]),E.createVNode(Fe,{size:"small",type:"primary",onClick:ve.handleSuccess,onKeydown:E.withKeys(ve.handleSuccess,["enter"])},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ve.labels.ok),1)]),_:1},8,["onClick","onKeydown"])],34)}var pc=Y(xx,[["render",Sx]]);const Ox="ivu-picker-panel",Cp="ivu-date-picker";var fc={emits:["on-pick-clear","on-pick-success","on-pick-click","on-pick"],props:{confirm:{type:Boolean,default:!1}},methods:{iconBtnCls(K,se=""){return[`${Ox}-icon-btn`,`${Cp}-${K}-btn`,`${Cp}-${K}-btn-arrow${se}`]},handleShortcutClick(K){K.value&&this.$emit("on-pick",K.value()),K.onClick&&K.onClick(this)},handlePickClear(){this.resetView(),this.$emit("on-pick-clear")},handlePickSuccess(){this.resetView(),this.$emit("on-pick-success")},handlePickClick(){this.$emit("on-pick-click")},resetView(){setTimeout(()=>this.currentView=this.selectionMode,500)},handleClear(){this.dates=this.dates.map(()=>null),this.rangeState={},this.$emit("on-pick",this.dates),this.handleConfirm()},handleConfirm(K,se){this.$emit("on-pick",this.dates,K,se||this.type)},onToggleVisibility(K){const{timeSpinner:se,timeSpinnerEnd:me}=this.$refs;K&&se&&se.updateScroll(),K&&me&&me.updateScroll()}}};const Cx="ivu-picker-panel",Tx="ivu-time-picker",Ex=K=>K[0].toUpperCase()+K.slice(1),Ax=(K,se,me,Be)=>{const Re=new Date(K.getTime());return Re.setHours(se),Re.setMinutes(me),Re.setSeconds(Be),Re},Mx=(K,se,me)=>me.indexOf(K)===se,Tp=()=>!1,Px={name:"TimePickerPanel",mixins:[fc,Xn,dc],components:{TimeSpinner:wp,Confirm:pc},emits:["on-pick"],props:{disabledDate:{type:Function,default:Tp},steps:{type:Array,default:()=>[]},format:{type:String,default:"HH:mm:ss"},modelValue:{type:Array,required:!0}},data(){return{prefixCls:Cx,timePrefixCls:Tx,date:this.modelValue[0]||xo(),showDate:!1}},computed:{showSeconds(){return!!(this.format||"").match(/ss/)},visibleDate(){const K=this.date,se=K.getMonth()+1,me=this.t("i.datepicker.year"),Be=this.t(`i.datepicker.month${se}`);return`${K.getFullYear()}${me} ${Be}`},timeSlots(){return this.modelValue[0]?["getHours","getMinutes","getSeconds"].map(K=>this.date[K]()):[]},disabledHMS(){const K=["disabledHours","disabledMinutes","disabledSeconds"];if(this.disabledDate===Tp||!this.modelValue[0])return K.reduce((se,me)=>(se[me]=this[me],se),{});{const se=[24,60,60],me=["Hours","Minutes","Seconds"].map(Be=>this[`disabled${Be}`]).map((Be,Re)=>{const ve=se[Re],Fe=Be;for(let Xe=0;Xe<ve;Xe+=this.steps[Re]||1){const tt=this.timeSlots.map((it,nr)=>nr===Re?Xe:it),Ze=Ax(this.date,...tt);this.disabledDate(Ze,!0)&&Fe.push(Xe)}return Fe.filter(Mx)});return K.reduce((Be,Re,ve)=>(Be[Re]=me[ve],Be),{})}}},watch:{modelValue(K){let se=K[0]||xo();se=new Date(se),this.date=se}},methods:{handleChange(K,se=!0){const me=new Date(this.date);Object.keys(K).forEach(Be=>me[`set${Ex(Be)}`](K[Be])),se&&this.$emit("on-pick",me,"time")}},mounted(){this.$parent&&this.$parent.$options.name==="DatePicker"&&(this.showDate=!0)}};function Rx(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("time-spinner"),Xe=E.resolveComponent("Confirm");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls+"-body-wrapper"]),onMousedown:se[0]||(se[0]=E.withModifiers(()=>{},["prevent"]))},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"])},[Re.showDate?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.timePrefixCls+"-header"])},E.toDisplayString(ve.visibleDate),3)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content"])},[E.createVNode(Fe,{ref:"timeSpinner","show-seconds":ve.showSeconds,steps:me.steps,hours:ve.timeSlots[0],minutes:ve.timeSlots[1],seconds:ve.timeSlots[2],"disabled-hours":ve.disabledHMS.disabledHours,"disabled-minutes":ve.disabledHMS.disabledMinutes,"disabled-seconds":ve.disabledHMS.disabledSeconds,"hide-disabled-options":K.hideDisabledOptions,onOnChange:ve.handleChange,onOnPickClick:K.handlePickClick},null,8,["show-seconds","steps","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),K.confirm?(E.openBlock(),E.createBlock(Xe,{key:1,onOnPickClear:K.handlePickClear,onOnPickSuccess:K.handlePickSuccess},null,8,["onOnPickClear","onOnPickSuccess"])):E.createCommentVNode("",!0)],2)],34)}var Ep=Y(Px,[["render",Rx]]);const kx={props:{datePanelLabel:Object,currentView:String,datePrefixCls:String}};function Ix(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("span",null,[me.datePanelLabel?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass([me.datePrefixCls+"-header-label"]),onClick:se[0]||(se[0]=(...Fe)=>me.datePanelLabel.labels[0].handler&&me.datePanelLabel.labels[0].handler(...Fe))},E.toDisplayString(me.datePanelLabel.labels[0].label),3)),[[E.vShow,me.datePanelLabel.labels[0].type==="year"||me.currentView==="date"]]):E.createCommentVNode("",!0),me.datePanelLabel&&me.currentView==="date"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createTextVNode(E.toDisplayString(me.datePanelLabel.separator),1)],64)):E.createCommentVNode("",!0),me.datePanelLabel?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass([me.datePrefixCls+"-header-label"]),onClick:se[1]||(se[1]=(...Fe)=>me.datePanelLabel.labels[1].handler&&me.datePanelLabel.labels[1].handler(...Fe))},E.toDisplayString(me.datePanelLabel.labels[1].label),3)),[[E.vShow,me.datePanelLabel.labels[1].type==="year"||me.currentView==="date"]]):E.createCommentVNode("",!0)])}var Ap=Y(kx,[["render",Ix]]),Mp={props:{showTime:{type:Boolean,default:!1},format:{type:String,default:"yyyy-MM-dd"},selectionMode:{type:String,validator(K){return Ie(K,["year","month","date","time"])},default:"date"},shortcuts:{type:Array,default:()=>[]},disabledDate:{type:Function,default:()=>!1},modelValue:{type:Array,default:()=>[xo(),xo()]},timePickerOptions:{default:()=>({}),type:Object},showWeekNumbers:{type:Boolean,default:!1},startDate:{type:Date},pickerType:{type:String,require:!0},focusedDate:{type:Date,required:!0}},computed:{isTime(){return this.currentView==="time"}},methods:{handleToggleTime(){this.currentView=this.currentView==="time"?"date":"time"}}};const Ju="ivu-picker-panel",Bx="ivu-date-picker",Vx={name:"DatePickerPanel",mixins:[fc,Xn,Mp],components:{Icon:Ae,DateTable:bp,YearTable:xp,MonthTable:Sp,TimePicker:Ep,Confirm:pc,datePanelLabel:Ap},emits:["on-selection-mode-change","on-pick"],props:{multiple:{type:Boolean,default:!1}},data(){const{selectionMode:K,modelValue:se}=this,me=se.slice().sort();return{prefixCls:Ju,datePrefixCls:Bx,currentView:K||"date",pickerTable:this.getTableType(K),dates:me,panelDate:this.startDate||me[0]||new Date}},computed:{classes(){return[`${Ju}-body-wrapper`,{[`${Ju}-with-sidebar`]:this.shortcuts.length}]},panelPickerHandlers(){return this.pickerTable===`${this.currentView}-table`?this.handlePick:this.handlePreSelection},datePanelLabel(){const K=this.t("i.locale"),se=this.t("i.datepicker.datePanelLabel"),me=this.panelDate,{labels:Be,separator:Re}=Xu(K,se,me),ve=Fe=>()=>this.pickerTable=this.getTableType(Fe);return{separator:Re,labels:Be.map(Fe=>(Fe.handler=ve(Fe.type),Fe))}},timeDisabled(){return!this.dates[0]}},watch:{modelValue(K){this.dates=K;const se=this.multiple?this.dates[this.dates.length-1]:this.startDate||this.dates[0];this.panelDate=se||new Date},currentView(K){this.$emit("on-selection-mode-change",K),this.currentView==="time"&&E.nextTick(()=>{this.$refs.timePicker.$refs.timeSpinner.updateScroll()})},selectionMode(K){this.currentView=K,this.pickerTable=this.getTableType(K)},focusedDate(K){const se=K.getFullYear()!==this.panelDate.getFullYear(),me=se||K.getMonth()!==this.panelDate.getMonth();(se||me)&&(this.multiple||(this.panelDate=K))}},methods:{reset(){this.currentView=this.selectionMode,this.pickerTable=this.getTableType(this.currentView)},changeYear(K){this.selectionMode==="year"||this.pickerTable==="year-table"?this.panelDate=new Date(this.panelDate.getFullYear()+K*10,0,1):this.panelDate=hp(this.panelDate,K*12)},getTableType(K){return K.match(/^time/)?"time-picker":`${K}-table`},changeMonth(K){this.panelDate=hp(this.panelDate,K)},handlePreSelection(K){this.panelDate=K,this.pickerTable==="year-table"?this.pickerTable="month-table":this.pickerTable=this.getTableType(this.currentView)},handlePick(K,se){const{selectionMode:me,panelDate:Be}=this;me==="year"?K=new Date(K.getFullYear(),0,1):me==="month"?K=new Date(Be.getFullYear(),K.getMonth(),1):K=new Date(K),this.dates=[K],this.$emit("on-pick",K,!1,se||me)}}},Dx=["onClick"];function Nx(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("date-panel-label"),tt=E.resolveComponent("time-picker"),Ze=E.resolveComponent("Confirm");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),onMousedown:se[4]||(se[4]=E.withModifiers(()=>{},["prevent"]))},[K.shortcuts.length?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-sidebar"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(K.shortcuts,it=>(E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls+"-shortcut"]),key:it.text,onClick:nr=>K.handleShortcutClick(it)},E.toDisplayString(it.text),11,Dx))),128))],2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"])},[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.datePrefixCls+"-header"])},[E.createElementVNode("span",{class:E.normalizeClass(K.iconBtnCls("prev","-double")),onClick:se[0]||(se[0]=it=>ve.changeYear(-1))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2),Re.pickerTable==="date-table"?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(K.iconBtnCls("prev")),onClick:se[1]||(se[1]=it=>ve.changeMonth(-1))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2)),[[E.vShow,Re.currentView==="date"]]):E.createCommentVNode("",!0),E.createVNode(Xe,{"date-panel-label":ve.datePanelLabel,"current-view":Re.pickerTable.split("-").shift(),"date-prefix-cls":Re.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),E.createElementVNode("span",{class:E.normalizeClass(K.iconBtnCls("next","-double")),onClick:se[2]||(se[2]=it=>ve.changeYear(1))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2),Re.pickerTable==="date-table"?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:1,class:E.normalizeClass(K.iconBtnCls("next")),onClick:se[3]||(se[3]=it=>ve.changeMonth(1))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2)),[[E.vShow,Re.currentView==="date"]]):E.createCommentVNode("",!0)],2),[[E.vShow,Re.currentView!=="time"]]),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content"])},[Re.currentView!=="time"?(E.openBlock(),E.createBlock(E.resolveDynamicComponent(Re.pickerTable),{key:0,ref:"pickerTable","table-date":Re.panelDate,"show-week-numbers":K.showWeekNumbers,"model-value":Re.dates,"selection-mode":K.selectionMode,"disabled-date":K.disabledDate,"focused-date":K.focusedDate,onOnPick:ve.panelPickerHandlers,onOnPickClick:K.handlePickClick},null,40,["table-date","show-week-numbers","model-value","selection-mode","disabled-date","focused-date","onOnPick","onOnPickClick"])):E.createCommentVNode("",!0)],2),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content"])},[Re.currentView==="time"?(E.openBlock(),E.createBlock(tt,E.mergeProps({key:0,ref:"timePicker","model-value":Re.dates,format:K.format,"time-disabled":ve.timeDisabled,"disabled-date":K.disabledDate,"focused-date":K.focusedDate},K.timePickerOptions,{onOnPick:ve.handlePick,onOnPickClick:K.handlePickClick,onOnPickClear:K.handlePickClear,onOnPickSuccess:K.handlePickSuccess,onOnPickToggleTime:K.handleToggleTime}),null,16,["model-value","format","time-disabled","disabled-date","focused-date","onOnPick","onOnPickClick","onOnPickClear","onOnPickSuccess","onOnPickToggleTime"])):E.createCommentVNode("",!0)],2),[[E.vShow,K.isTime]]),K.confirm?(E.openBlock(),E.createBlock(Ze,{key:0,"show-time":K.showTime,"is-time":K.isTime,onOnPickToggleTime:K.handleToggleTime,onOnPickClear:K.handlePickClear,onOnPickSuccess:K.handlePickSuccess},null,8,["show-time","is-time","onOnPickToggleTime","onOnPickClear","onOnPickSuccess"])):E.createCommentVNode("",!0)],2)],34)}var $x=Y(Vx,[["render",Nx]]);const Pp="ivu-picker-panel",eh="ivu-time-picker",Rp=K=>K[0].toUpperCase()+K.slice(1),Lx={name:"RangeTimePickerPanel",mixins:[fc,Xn,dc],components:{TimeSpinner:wp,Confirm:pc},emits:["on-pick"],props:{steps:{type:Array,default:()=>[]},format:{type:String,default:"HH:mm:ss"},modelValue:{type:Array,required:!0}},data(){const[K,se]=this.modelValue.slice();return{prefixCls:Pp,timePrefixCls:eh,showDate:!1,dateStart:K||xo(),dateEnd:se||xo()}},computed:{classes(){return[`${Pp}-body-wrapper`,`${eh}-with-range`,{[`${eh}-with-seconds`]:this.showSeconds}]},showSeconds(){return!!(this.format||"").match(/ss/)},leftDatePanelLabel(){return this.panelLabelConfig(this.date)},rightDatePanelLabel(){return this.panelLabelConfig(this.dateEnd)}},watch:{modelValue(K){const[se,me]=K.slice();this.dateStart=se||xo(),this.dateEnd=me||xo()}},methods:{panelLabelConfig(K){const se=this.t("i.locale"),me=this.t("i.datepicker.datePanelLabel"),{labels:Be,separator:Re}=Xu(se,me,K||xo());return[Be[0].label,Re,Be[1].label].join("")},handleChange(K,se,me=!0){const Be=new Date(this.dateStart);let Re=new Date(this.dateEnd);Object.keys(K).forEach(ve=>{Be[`set${Rp(ve)}`](K[ve])}),Object.keys(se).forEach(ve=>{Re[`set${Rp(ve)}`](se[ve])}),Re<Be&&(Re=Be),me&&this.$emit("on-pick",[Be,Re],"time")},handleStartChange(K){this.handleChange(K,{})},handleEndChange(K){this.handleChange({},K)},updateScroll(){this.$refs.timeSpinner.updateScroll(),this.$refs.timeSpinnerEnd.updateScroll()}},mounted(){this.$parent&&this.$parent.$options.name==="DatePicker"&&(this.showDate=!0)}};function Fx(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("time-spinner"),Xe=E.resolveComponent("Confirm");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),onMousedown:se[0]||(se[0]=E.withModifiers(()=>{},["prevent"]))},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content",Re.prefixCls+"-content-left"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.timePrefixCls+"-header"])},[Re.showDate?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(ve.leftDatePanelLabel),1)],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createTextVNode(E.toDisplayString(K.t("i.datepicker.startTime")),1)],64))],2),E.createVNode(Fe,{ref:"timeSpinner",steps:me.steps,"show-seconds":ve.showSeconds,hours:me.modelValue[0]&&Re.dateStart.getHours(),minutes:me.modelValue[0]&&Re.dateStart.getMinutes(),seconds:me.modelValue[0]&&Re.dateStart.getSeconds(),"disabled-hours":K.disabledHours,"disabled-minutes":K.disabledMinutes,"disabled-seconds":K.disabledSeconds,"hide-disabled-options":K.hideDisabledOptions,onOnChange:ve.handleStartChange,onOnPickClick:K.handlePickClick},null,8,["steps","show-seconds","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content",Re.prefixCls+"-content-right"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.timePrefixCls+"-header"])},[Re.showDate?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(ve.rightDatePanelLabel),1)],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createTextVNode(E.toDisplayString(K.t("i.datepicker.endTime")),1)],64))],2),E.createVNode(Fe,{ref:"timeSpinnerEnd",steps:me.steps,"show-seconds":ve.showSeconds,hours:me.modelValue[1]&&Re.dateEnd.getHours(),minutes:me.modelValue[1]&&Re.dateEnd.getMinutes(),seconds:me.modelValue[1]&&Re.dateEnd.getSeconds(),"disabled-hours":K.disabledHours,"disabled-minutes":K.disabledMinutes,"disabled-seconds":K.disabledSeconds,"hide-disabled-options":K.hideDisabledOptions,onOnChange:ve.handleEndChange,onOnPickClick:K.handlePickClick},null,8,["steps","show-seconds","hours","minutes","seconds","disabled-hours","disabled-minutes","disabled-seconds","hide-disabled-options","onOnChange","onOnPickClick"])],2),K.confirm?(E.openBlock(),E.createBlock(Xe,{key:0,onOnPickClear:K.handlePickClear,onOnPickSuccess:K.handlePickSuccess},null,8,["onOnPickClear","onOnPickSuccess"])):E.createCommentVNode("",!0)],2)],34)}var kp=Y(Lx,[["render",Fx]]);const Va="ivu-picker-panel",th="ivu-date-picker",Ip=(K,se)=>!K||!se?0:K.getTime()-se.getTime(),Ux={name:"RangeDatePickerPanel",mixins:[fc,Xn,Mp],components:{Icon:Ae,DateTable:bp,YearTable:xp,MonthTable:Sp,TimePicker:kp,Confirm:pc,datePanelLabel:Ap},props:{splitPanels:{type:Boolean,default:!1}},data(){const[K,se]=this.modelValue.map(Be=>Be||xo()),me=this.startDate?this.startDate:K;return{prefixCls:Va,datePrefixCls:th,dates:this.modelValue,rangeState:{from:this.modelValue[0],to:this.modelValue[1],selecting:K&&!se},currentView:this.selectionMode||"range",leftPickerTable:`${this.selectionMode}-table`,rightPickerTable:`${this.selectionMode}-table`,leftPanelDate:me,rightPanelDate:new Date(me.getFullYear(),me.getMonth()+1,1)}},computed:{classes(){return[`${Va}-body-wrapper`,`${th}-with-range`,{[`${Va}-with-sidebar`]:this.shortcuts.length,[`${th}-with-week-numbers`]:this.showWeekNumbers}]},panelBodyClasses(){return[Va+"-body",{[Va+"-body-time"]:this.showTime,[Va+"-body-date"]:!this.showTime}]},leftDatePanelLabel(){return this.panelLabelConfig("left")},rightDatePanelLabel(){return this.panelLabelConfig("right")},leftDatePanelView(){return this.leftPickerTable.split("-").shift()},rightDatePanelView(){return this.rightPickerTable.split("-").shift()},timeDisabled(){return!(this.dates[0]&&this.dates[1])},preSelecting(){const K=`${this.currentView}-table`;return{left:this.leftPickerTable!==K,right:this.rightPickerTable!==K}},panelPickerHandlers(){return{left:this.preSelecting.left?this.handlePreSelection.bind(this,"left"):this.handleRangePick,right:this.preSelecting.right?this.handlePreSelection.bind(this,"right"):this.handleRangePick}}},watch:{modelValue(K){const se=K[0]?Hu(K[0]):null,me=K[1]?Hu(K[1]):null;this.dates=[se,me].sort(Ip),this.rangeState={from:this.dates[0],to:this.dates[1],selecting:!1},this.setPanelDates(this.startDate||this.dates[0]||new Date)},currentView(K){const se=this.leftPanelDate.getMonth(),me=this.rightPanelDate.getMonth(),Be=this.leftPanelDate.getFullYear()===this.rightPanelDate.getFullYear();K==="date"&&Be&&se===me&&this.changePanelDate("right","Month",1),K==="month"&&Be&&this.changePanelDate("right","FullYear",1),K==="year"&&Be&&this.changePanelDate("right","FullYear",10)},selectionMode(K){this.currentView=K||"range"},focusedDate(K){this.setPanelDates(K||new Date)}},methods:{reset(){this.currentView=this.selectionMode,this.leftPickerTable=`${this.currentView}-table`,this.rightPickerTable=`${this.currentView}-table`},setPanelDates(K){this.leftPanelDate=K;const se=new Date(K.getFullYear(),K.getMonth()+1,1),me=this.dates[1]?this.dates[1].getTime():this.dates[1];this.rightPanelDate=this.splitPanels?new Date(Math.max(me,se.getTime())):se},panelLabelConfig(K){const se=this.t("i.locale"),me=this.t("i.datepicker.datePanelLabel"),Be=Xe=>{const tt=Xe=="month"?this.showMonthPicker:this.showYearPicker;return()=>tt(K)},Re=this[`${K}PanelDate`],{labels:ve,separator:Fe}=Xu(se,me,Re);return{separator:Fe,labels:ve.map(Xe=>(Xe.handler=Be(Xe.type),Xe))}},prevYear(K){const se=this.currentView==="year"?-10:-1;this.changePanelDate(K,"FullYear",se)},nextYear(K){const se=this.currentView==="year"?10:1;this.changePanelDate(K,"FullYear",se)},prevMonth(K){this.changePanelDate(K,"Month",-1)},nextMonth(K){this.changePanelDate(K,"Month",1)},changePanelDate(K,se,me,Be=!0){const Re=new Date(this[`${K}PanelDate`]);if(se==="FullYear"?Re[`set${se}`](Re[`get${se}`]()+me):Re[`set${se}`](Re[`get${se}`]()+me,1),this[`${K}PanelDate`]=Re,!!Be)if(this.splitPanels){const ve=K==="left"?"right":"left";K==="left"&&this.leftPanelDate>=this.rightPanelDate&&this.changePanelDate(ve,se,1),K==="right"&&this.rightPanelDate<=this.leftPanelDate&&this.changePanelDate(ve,se,-1)}else{const ve=K==="left"?"right":"left",Fe=this[`${ve}PanelDate`],Xe=new Date(Fe);if(se==="Month"){const tt=new Date(Xe.getFullYear(),Xe.getMonth()+me+1,0).getDate();Xe.setDate(Math.min(tt,Xe.getDate()))}Xe[`set${se}`](Xe[`get${se}`]()+me),this[`${ve}PanelDate`]=Xe}},showYearPicker(K){this[`${K}PickerTable`]="year-table"},showMonthPicker(K){this[`${K}PickerTable`]="month-table"},handlePreSelection(K,se){if(this[`${K}PanelDate`]=se,this[`${K}PickerTable`]==="year-table"?this[`${K}PickerTable`]="month-table":this[`${K}PickerTable`]=`${this.currentView}-table`,!this.splitPanels){const me=K==="left"?"right":"left";this[`${me}PanelDate`]=se;const Be=me==="left"?-1:1;this.changePanelDate(me,"Month",Be,!1)}},handleRangePick(K,se){if(this.rangeState.selecting||this.currentView==="time"){if(this.currentView==="time")this.dates=K;else{const[me,Be]=[this.rangeState.from,K].sort(Ip);this.dates=[me,Be],this.rangeState={from:me,to:Be,selecting:!1}}this.handleConfirm(!1,se||"date")}else this.rangeState={from:K,to:null,selecting:!0}},handleChangeRange(K){this.rangeState.to=K}}},zx=["onClick"];function Wx(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("date-panel-label"),tt=E.resolveComponent("time-picker"),Ze=E.resolveComponent("Confirm");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),onMousedown:se[8]||(se[8]=E.withModifiers(()=>{},["prevent"]))},[K.shortcuts.length?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-sidebar"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(K.shortcuts,it=>(E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls+"-shortcut"]),key:it.text,onClick:nr=>K.handleShortcutClick(it)},E.toDisplayString(it.text),11,zx))),128))],2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass(ve.panelBodyClasses)},[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content",Re.prefixCls+"-content-left"])},[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.datePrefixCls+"-header"])},[E.createElementVNode("span",{class:E.normalizeClass(K.iconBtnCls("prev","-double")),onClick:se[0]||(se[0]=it=>ve.prevYear("left"))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2),Re.leftPickerTable==="date-table"?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(K.iconBtnCls("prev")),onClick:se[1]||(se[1]=it=>ve.prevMonth("left"))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2)),[[E.vShow,Re.currentView==="date"]]):E.createCommentVNode("",!0),E.createVNode(Xe,{"date-panel-label":ve.leftDatePanelLabel,"current-view":ve.leftDatePanelView,"date-prefix-cls":Re.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),me.splitPanels||Re.leftPickerTable!=="date-table"?(E.openBlock(),E.createElementBlock("span",{key:1,class:E.normalizeClass(K.iconBtnCls("next","-double")),onClick:se[2]||(se[2]=it=>ve.nextYear("left"))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2)):E.createCommentVNode("",!0),me.splitPanels&&Re.leftPickerTable==="date-table"?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass(K.iconBtnCls("next")),onClick:se[3]||(se[3]=it=>ve.nextMonth("left"))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2)),[[E.vShow,Re.currentView==="date"]]):E.createCommentVNode("",!0)],2),[[E.vShow,Re.currentView!=="time"]]),Re.currentView!=="time"?(E.openBlock(),E.createBlock(E.resolveDynamicComponent(Re.leftPickerTable),{key:0,ref:"leftYearTable","table-date":Re.leftPanelDate,"selection-mode":"range","disabled-date":K.disabledDate,"range-state":Re.rangeState,"show-week-numbers":K.showWeekNumbers,"model-value":ve.preSelecting.left?[Re.dates[0]]:Re.dates,"focused-date":K.focusedDate,onOnChangeRange:ve.handleChangeRange,onOnPick:ve.panelPickerHandlers.left,onOnPickClick:K.handlePickClick},null,40,["table-date","disabled-date","range-state","show-week-numbers","model-value","focused-date","onOnChangeRange","onOnPick","onOnPickClick"])):E.createCommentVNode("",!0)],2),[[E.vShow,!K.isTime]]),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content",Re.prefixCls+"-content-right"])},[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.datePrefixCls+"-header"])},[me.splitPanels||Re.rightPickerTable!=="date-table"?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(K.iconBtnCls("prev","-double")),onClick:se[4]||(se[4]=it=>ve.prevYear("right"))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2)):E.createCommentVNode("",!0),me.splitPanels&&Re.rightPickerTable==="date-table"?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:1,class:E.normalizeClass(K.iconBtnCls("prev")),onClick:se[5]||(se[5]=it=>ve.prevMonth("right"))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2)),[[E.vShow,Re.currentView==="date"]]):E.createCommentVNode("",!0),E.createVNode(Xe,{"date-panel-label":ve.rightDatePanelLabel,"current-view":ve.rightDatePanelView,"date-prefix-cls":Re.datePrefixCls},null,8,["date-panel-label","current-view","date-prefix-cls"]),E.createElementVNode("span",{class:E.normalizeClass(K.iconBtnCls("next","-double")),onClick:se[6]||(se[6]=it=>ve.nextYear("right"))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2),Re.rightPickerTable==="date-table"?E.withDirectives((E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass(K.iconBtnCls("next")),onClick:se[7]||(se[7]=it=>ve.nextMonth("right"))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2)),[[E.vShow,Re.currentView==="date"]]):E.createCommentVNode("",!0)],2),[[E.vShow,Re.currentView!=="time"]]),Re.currentView!=="time"?(E.openBlock(),E.createBlock(E.resolveDynamicComponent(Re.rightPickerTable),{key:0,ref:"rightYearTable","table-date":Re.rightPanelDate,"selection-mode":"range","range-state":Re.rangeState,"disabled-date":K.disabledDate,"show-week-numbers":K.showWeekNumbers,"model-value":ve.preSelecting.right?[Re.dates[Re.dates.length-1]]:Re.dates,"focused-date":K.focusedDate,onOnChangeRange:ve.handleChangeRange,onOnPick:ve.panelPickerHandlers.right,onOnPickClick:K.handlePickClick},null,40,["table-date","range-state","disabled-date","show-week-numbers","model-value","focused-date","onOnChangeRange","onOnPick","onOnPickClick"])):E.createCommentVNode("",!0)],2),[[E.vShow,!K.isTime]]),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content"])},[Re.currentView==="time"?(E.openBlock(),E.createBlock(tt,E.mergeProps({key:0,ref:"timePicker","model-value":Re.dates,format:K.format,"time-disabled":ve.timeDisabled},K.timePickerOptions,{onOnPick:ve.handleRangePick,onOnPickClick:K.handlePickClick,onOnPickClear:K.handlePickClear,onOnPickSuccess:K.handlePickSuccess,onOnPickToggleTime:K.handleToggleTime}),null,16,["model-value","format","time-disabled","onOnPick","onOnPickClick","onOnPickClear","onOnPickSuccess","onOnPickToggleTime"])):E.createCommentVNode("",!0)],2),[[E.vShow,K.isTime]]),K.confirm?(E.openBlock(),E.createBlock(Ze,{key:0,"show-time":K.showTime,"is-time":K.isTime,"time-disabled":ve.timeDisabled,onOnPickToggleTime:K.handleToggleTime,onOnPickClear:K.handlePickClear,onOnPickSuccess:K.handlePickSuccess},null,8,["show-time","is-time","time-disabled","onOnPickToggleTime","onOnPickClear","onOnPickSuccess"])):E.createCommentVNode("",!0)],2)],34)}var Gx=Y(Ux,[["render",Wx]]),Bp={name:"CalendarPicker",mixins:[pp],props:{type:{validator(K){return Ie(K,["year","month","date","daterange","datetime","datetimerange"])},default:"date"}},components:{DatePickerPanel:$x,RangeDatePickerPanel:Gx},computed:{panel(){return this.type==="daterange"||this.type==="datetimerange"?"RangeDatePickerPanel":"DatePickerPanel"},ownPickerProps(){return this.options}}},jx={1:{xs:24},2:{xs:24,sm:12},3:{xs:24,sm:12,md:8},4:{xs:24,sm:12,md:6}};const Vp={name:"Description",inject:["DescriptionListInstance"],props:{term:{type:String}},computed:{styles(){let K={};return this.DescriptionListInstance.gutter!==0&&(K={paddingLeft:this.DescriptionListInstance.gutter/2+"px",paddingRight:this.DescriptionListInstance.gutter/2+"px"}),K}},render(){let K;(this.term||this.$slots.term)&&(this.$slots.term?K=E.h("div",{class:"ivu-description-term"},this.$slots.term()):K=E.h("div",{class:"ivu-description-term"},this.term));const se=E.h("div",{class:"ivu-description-detail"},this.$slots.default()),me=K?[K,se]:[se];return E.h(vo,{...jx[this.DescriptionListInstance.col],style:this.styles},()=>me)}},Hx={name:"DescriptionList",components:{Row:Lo},provide(){return{DescriptionListInstance:this}},props:{layout:{validator(K){return Ie(K,["horizontal","vertical"])},default:"horizontal"},title:{type:String},gutter:{type:Number,default:32},col:{validator(K){return Ie(K,[1,2,3,4])},default:3}}},Xx={key:0,class:"ivu-description-list-title"};function qx(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Row");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-description-list",{"ivu-description-list-vertical":me.layout==="vertical"}])},[me.title||K.$slots.title?(E.openBlock(),E.createElementBlock("div",Xx,[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])])):E.createCommentVNode("",!0),E.createVNode(Fe,{gutter:me.gutter},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"default")]),_:3},8,["gutter"])],2)}var Dp=Y(Hx,[["render",qx]]);const zo="ivu-divider",Qx={name:"Divider",props:{type:{type:String,default:"horizontal",validator(K){return Ie(K,["horizontal","vertical"])}},orientation:{type:String,default:"center",validator(K){return Ie(K,["left","right","center"])}},dashed:{type:Boolean,default:!1},size:{validator(K){return Ie(K,["small","default"])},default:"default"},plain:{type:Boolean,default:!1}},computed:{hasSlot(){return!!this.$slots.default},classes(){return[`${zo}`,`${zo}-${this.type}`,`${zo}-${this.size}`,{[`${zo}-with-text`]:this.hasSlot&&this.orientation==="center",[`${zo}-with-text-${this.orientation}`]:this.hasSlot,[`${zo}-dashed`]:!!this.dashed,[`${zo}-plain`]:this.plain}]},slotClasses(){return[`${zo}-inner-text`]}}};function Yx(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[ve.hasSlot?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(ve.slotClasses)},[E.renderSlot(K.$slots,"default")],2)):E.createCommentVNode("",!0)],2)}var mc=Y(Qx,[["render",Yx]]),rh={props:{lockScroll:{type:Boolean,default:!0}},methods:{checkScrollBar(){if(!W)return;let K=window.innerWidth;if(!K){const se=document.documentElement.getBoundingClientRect();K=se.right-Math.abs(se.left)}this.bodyIsOverflowing=document.body.clientWidth<K,this.bodyIsOverflowing&&(this.scrollBarWidth=$e())},checkMaskInVisible(){let K=W?document.getElementsByClassName("ivu-modal-mask")||[]:[];return Array.from(K).every(se=>se.style.display==="none"||se.classList.contains("fade-leave-to"))},setScrollBar(){W&&this.bodyIsOverflowing&&this.scrollBarWidth!==void 0&&(document.body.style.paddingRight=`${this.scrollBarWidth}px`)},resetScrollBar(){W&&(document.body.style.paddingRight="")},addScrollEffect(){!this.lockScroll||(this.checkScrollBar(),this.setScrollBar(),W&&(document.body.style.overflow="hidden"))},removeScrollEffect(){!this.lockScroll||W&&this.checkMaskInVisible()&&(document.body.style.overflow="",this.resetScrollBar())}}};const ks="ivu-drawer",Kx={name:"Drawer",mixins:[rh],components:{Icon:Ae},emits:["on-close","on-resize-width","on-visible-change","update:modelValue","on-drag"],provide(){return{DrawerInstance:this}},props:{modelValue:{type:Boolean,default:!1},title:{type:String},width:{type:[Number,String],default:256},height:{type:[Number,String],default:256},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},mask:{type:Boolean,default:!0},maskStyle:{type:Object},styles:{type:Object},scrollable:{type:Boolean,default:!1},placement:{validator(K){return Ie(K,["left","right","top","bottom"])},default:"right"},zIndex:{type:Number,default:1e3},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!0:K.$VIEWUI.transfer}},className:{type:String},inner:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},beforeClose:Function},data(){return{prefixCls:ks,visible:this.modelValue,wrapShow:!1,showHead:!0,canMove:!1,dragWidth:this.width,dragHeight:this.height,wrapperWidth:this.width,wrapperHeight:this.height,wrapperLeft:0,minWidth:256,minHeight:256,id:gt(6),tableList:[],sliderList:[]}},computed:{wrapClasses(){return[`${ks}-wrap`,{[`${ks}-hidden`]:!this.wrapShow,[`${this.className}`]:!!this.className,[`${ks}-no-mask`]:!this.mask,[`${ks}-wrap-inner`]:this.inner,[`${ks}-wrap-dragging`]:this.canMove}]},wrapStyles(){return{zIndex:this.zIndex}},mainStyles(){let K={};if(this.placement==="left"||this.placement==="right"){const se=parseInt(this.dragWidth),me={width:se<=100?`${se}%`:`${se}px`};Object.assign(K,me)}else{const se=parseInt(this.dragHeight),me={height:se<=100?`${se}%`:`${se}px`};Object.assign(K,me)}return K},contentClasses(){return[`${ks}-content`,{[`${ks}-content-no-mask`]:!this.mask}]},classes(){return[`${ks}`,`${ks}-${this.placement}`,{[`${ks}-no-header`]:!this.showHead,[`${ks}-inner`]:this.inner}]},maskClasses(){return[`${ks}-mask`,{[`${ks}-mask-inner`]:this.inner}]},transitionName(){return this.placement==="left"||this.placement==="right"?`move-${this.placement}`:this.placement==="top"?"move-up":"move-down"}},methods:{close(){if(!this.beforeClose)return this.handleClose();const K=this.beforeClose();K&&K.then?K.then(()=>{this.handleClose()}):this.handleClose()},handleClose(){this.visible=!1,this.$emit("update:modelValue",!1),this.$emit("on-close")},handleMask(){this.maskClosable&&this.mask&&this.close()},handleWrapClick(K){const se=K.target.getAttribute("class");se&&se.indexOf(`${ks}-wrap`)>-1&&this.handleMask()},handleMousemove(K){if(!this.canMove||!this.draggable)return;this.handleSetWrapperWidth();const se=K.pageX-this.wrapperLeft;let me=this.placement==="right"?this.wrapperWidth-se:se;me=Math.max(me,parseFloat(this.minWidth)),K.atMin=me===parseFloat(this.minWidth),me<=100&&(me=me/this.wrapperWidth*100),this.dragWidth=me,this.$emit("on-resize-width",parseInt(this.dragWidth)),this.$emit("on-drag","dragging",parseInt(this.dragWidth))},handleSetWrapperWidth(){const{width:K,left:se}=this.$refs.drawer.getBoundingClientRect();this.wrapperWidth=K,this.wrapperLeft=se},handleMouseup(){!this.draggable||(this.canMove=!1,this.$emit("on-drag","end"))},handleTriggerMousedown(){this.canMove=!0,window.getSelection().removeAllRanges(),this.$emit("on-drag","start")},addDrawer(){const K=this.$root;K.drawerList||(K.drawerList=[]),K.drawerList.push({id:this.id,drawer:this})},removeDrawer(){const K=this.$root;if(!K.drawerList)return;const se=K.drawerList.findIndex(me=>me.id===this.id);K.drawerList.splice(se,1)}},mounted(){this.visible&&(this.wrapShow=!0);let K=!0;this.$slots.header===void 0&&!this.title&&(K=!1),this.showHead=K,this.addDrawer(),X(document,"mousemove",this.handleMousemove),X(document,"mouseup",this.handleMouseup),this.handleSetWrapperWidth()},beforeUnmount(){this.removeDrawer(),q(document,"mousemove",this.handleMousemove),q(document,"mouseup",this.handleMouseup),this.removeScrollEffect()},watch:{modelValue(K){this.visible=K},visible(K){K===!1?this.timer=setTimeout(()=>{this.wrapShow=!1,this.$root.drawerList.map(se=>se.drawer).filter(se=>se.id!==this.id).some(se=>se.visible&&!se.scrollable)||this.removeScrollEffect()},300):(this.timer&&clearTimeout(this.timer),this.wrapShow=!0,this.scrollable||this.addScrollEffect()),this.tableList.forEach(se=>{se.table.handleOnVisibleChange(K)}),this.sliderList.forEach(se=>{se.slider.handleOnVisibleChange(K)}),this.$emit("on-visible-change",K)},scrollable(K){K?this.removeScrollEffect():this.addScrollEffect()},title(K){this.$slots.header===void 0&&(this.showHead=!!K)},width(K){this.dragWidth=K},height(K){this.dragHeight=K}}},Zx={ref:"drawer"},Jx=E.createElementVNode("div",{class:"ivu-drawer-drag-move-trigger"},[E.createElementVNode("div",{class:"ivu-drawer-drag-move-trigger-point"},[E.createElementVNode("i"),E.createElementVNode("i"),E.createElementVNode("i"),E.createElementVNode("i"),E.createElementVNode("i")])],-1);function eS(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createBlock(E.Teleport,{to:"body",disabled:!me.transfer},[E.createElementVNode("div",Zx,[E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[me.mask?E.withDirectives((E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.maskClasses),style:E.normalizeStyle(me.maskStyle),onClick:se[0]||(se[0]=(...Xe)=>ve.handleMask&&ve.handleMask(...Xe))},null,6)),[[E.vShow,Re.visible]]):E.createCommentVNode("",!0)]),_:1}),E.createElementVNode("div",{class:E.normalizeClass(ve.wrapClasses),style:E.normalizeStyle(ve.wrapStyles),onClick:se[3]||(se[3]=(...Xe)=>ve.handleWrapClick&&ve.handleWrapClick(...Xe))},[E.createVNode(E.Transition,{name:ve.transitionName},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.mainStyles)},[E.createElementVNode("div",{class:E.normalizeClass(ve.contentClasses),ref:"content"},[me.closable?(E.openBlock(),E.createElementBlock("a",{key:0,class:"ivu-drawer-close",onClick:se[1]||(se[1]=(...Xe)=>ve.close&&ve.close(...Xe))},[E.renderSlot(K.$slots,"close",{},()=>[E.createVNode(Fe,{type:"ios-close"})])])):E.createCommentVNode("",!0),Re.showHead?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass([Re.prefixCls+"-header"])},[E.renderSlot(K.$slots,"header",{},()=>[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-header-inner"])},E.toDisplayString(me.title),3)])],2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"]),style:E.normalizeStyle(me.styles)},[E.renderSlot(K.$slots,"default")],6)],2),me.draggable&&(me.placement==="left"||me.placement==="right")?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(["ivu-drawer-drag","ivu-drawer-drag-"+me.placement]),onMousedown:se[2]||(se[2]=(...Xe)=>ve.handleTriggerMousedown&&ve.handleTriggerMousedown(...Xe))},[E.renderSlot(K.$slots,"trigger",{},()=>[Jx])],34)):E.createCommentVNode("",!0)],6),[[E.vShow,Re.visible]])]),_:3},8,["name"])],6)],512)],8,["disabled"])}var $p=Y(Kx,[["render",eS]]);const gc="ivu-dropdown-item",tS={name:"DropdownItem",props:{name:{type:[String,Number]},disabled:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},divided:{type:Boolean,default:!1}},computed:{classes(){return[`${gc}`,{[`${gc}-disabled`]:this.disabled,[`${gc}-selected`]:this.selected,[`${gc}-divided`]:this.divided}]}},methods:{handleClick(){if(this.disabled)return;const K=Je(this,"Dropdown");this.$parent&&this.$parent.$options.name==="Dropdown"?this.$parent.handleHaschildClick():K&&K.$options.name==="Dropdown"&&K.handleHoverClick(),K.handleItemClick(this.name)}}};function rS(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.classes),onClick:se[0]||(se[0]=(...Fe)=>ve.handleClick&&ve.handleClick(...Fe))},[E.renderSlot(K.$slots,"default")],2)}var Lp=Y(tS,[["render",rS]]);const iS=(K="")=>K.split("").reduce((se,me)=>{const Be=me.charCodeAt(0);return Be>=0&&Be<=128?se+1:se+2},0),nS=(K="",se)=>{let me=0;return K.split("").reduce((Be,Re)=>{const ve=Re.charCodeAt(0);return ve>=0&&ve<=128?me+=1:me+=2,me<=se?Be+Re:Be},"")},sS={name:"Ellipsis",components:{Tooltip:To},emits:["on-show","on-hide"],props:{text:{type:String},height:{type:Number},lines:{type:Number},length:{type:Number},fullWidthRecognition:{type:Boolean,default:!1},autoResize:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},tooltip:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},theme:{validator(K){return Ie(K,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number],default:250},placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"}},data(){return{oversize:!1,computedReady:!1,computedText:""}},watch:{disabled(){this.init()},text(){this.init()},height(){this.init()}},mounted(){this.init()},methods:{init(){this.disabled||(this.computeText(),this.limitShow())},computeText(){this.oversize=!1,this.computedReady=!1,E.nextTick(()=>{let K=this.$refs.text,se=this.$el,me=this.$refs.more,Be=1e3,Re=this.text,ve=this.height;if(!ve&&this.lines&&(ve=parseInt(He(se,"lineHeight"),10)*this.lines),K){if(this.length)(this.fullWidthRecognition?iS(Re):Re.length)>this.length&&(this.oversize=!0,me.style.display="inline-block",Re=this.fullWidthRecognition?nS(Re,this.length):Re.slice(0,this.length));else if(se.offsetHeight>ve)for(this.oversize=!0,me.style.display="inline-block";se.offsetHeight>ve&&Be>0;)se.offsetHeight>ve*3?K.innerText=Re=Re.substring(0,Math.floor(Re.length/2)):K.innerText=Re=Re.substring(0,Re.length-1),Be--}this.computedText=Re})},limitShow(){this.computedReady=!0,E.nextTick(()=>{let K=this.$refs.text,se=this.$el;K&&(K.innerText=this.computedText,se.offsetHeight>this.height?this.$emit("on-hide"):this.$emit("on-show"))})}}},oS={class:"ivu-ellipsis"},aS={class:"ivu-ellipsis-more",ref:"more"},lS={class:"ivu-ellipsis-more",ref:"more"},cS={key:1,class:"ivu-ellipsis-hidden"},uS={class:"ivu-ellipsis-more",ref:"more"};function hS(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Tooltip");return E.openBlock(),E.createElementBlock("div",oS,[E.renderSlot(K.$slots,"prefix",{class:"ivu-ellipsis-prefix"}),Re.computedReady?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[me.tooltip?(E.openBlock(),E.createBlock(Fe,{key:0,content:me.text,theme:me.theme,"max-width":me.maxWidth,placement:me.placement,transfer:me.transfer},{default:E.withCtx(()=>[E.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},E.toDisplayString(me.text),513),E.withDirectives(E.createElementVNode("span",aS,[E.renderSlot(K.$slots,"more",{},()=>[E.createTextVNode("...")])],512),[[E.vShow,Re.oversize]]),E.renderSlot(K.$slots,"suffix",{class:"ivu-ellipsis-suffix"})]),_:3},8,["content","theme","max-width","placement","transfer"])):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},E.toDisplayString(me.text),513),E.withDirectives(E.createElementVNode("span",lS,[E.renderSlot(K.$slots,"more",{},()=>[E.createTextVNode("...")])],512),[[E.vShow,Re.oversize]]),E.renderSlot(K.$slots,"suffix",{class:"ivu-ellipsis-suffix"})],64))],64)):(E.openBlock(),E.createElementBlock("div",cS,[E.createElementVNode("span",{class:"ivu-ellipsis-text",ref:"text"},E.toDisplayString(me.text),513),E.withDirectives(E.createElementVNode("span",uS,[E.renderSlot(K.$slots,"more",{},()=>[E.createTextVNode("...")])],512),[[E.vShow,Re.oversize]]),E.renderSlot(K.$slots,"suffix",{class:"ivu-ellipsis-suffix"})]))])}var Fp=Y(sS,[["render",hS]]);const Wp={name:"Email",mixins:[hl],data(){return{className:"ivu-login-mail",prefix:"ios-mail-outline",placeholder:"",type:"email"}},props:{rules:{type:[Object,Array],default(){return[{required:!0,message:Nu.Email,trigger:"change"},{type:"email",message:"",trigger:"change"}]}}}};var yc={403:{img:"https://file.iviewui.com/iview-pro/icon-403.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-403-color.svg",title:"403",desc:""},404:{img:"https://file.iviewui.com/iview-pro/icon-404.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-404-color.svg",title:"404",desc:""},500:{img:"https://file.iviewui.com/iview-pro/icon-500.svg",imgColor:"https://file.iviewui.com/iview-pro/icon-500-color.svg",title:"500",desc:""}};const dS={name:"Exception",components:{Button:As},props:{type:{validator(K){return Ie(K,["403","404","500",403,404,500])},default:"404"},title:{type:String},desc:{type:String},img:{type:String},imgColor:{type:Boolean,default:!1},backText:{type:String,default:""},redirect:{type:String,default:"/"}},computed:{imgPath(){return this.img?this.img:this.imgColor?yc[this.type].imgColor:yc[this.type].img},titleText(){return this.title?this.title:yc[this.type].title},descText(){return this.desc?this.desc:yc[this.type].desc}}},pS={class:"ivu-exception"},fS={class:"ivu-exception-img"},mS={class:"ivu-exception-content"},gS={class:"ivu-exception-content-desc"},yS={class:"ivu-exception-content-actions"};function _S(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Button");return E.openBlock(),E.createElementBlock("div",pS,[E.createElementVNode("div",fS,[E.createElementVNode("div",{class:"ivu-exception-img-element",style:E.normalizeStyle({"background-image":"url("+ve.imgPath+")"})},null,4)]),E.createElementVNode("div",mS,[E.createElementVNode("h1",null,[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(ve.titleText),1)])]),E.createElementVNode("div",gS,[E.renderSlot(K.$slots,"desc",{},()=>[E.createTextVNode(E.toDisplayString(ve.descText),1)])]),E.createElementVNode("div",yS,[E.renderSlot(K.$slots,"actions",{},()=>[E.createVNode(Fe,{to:me.redirect,type:"primary",size:"large"},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(me.backText),1)]),_:1},8,["to"])])])])])}var Gp=Y(dS,[["render",_S]]);const vS="ivu-layout",bS={name:"Footer",computed:{wrapClasses(){return`${vS}-footer`}}};function xS(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[E.renderSlot(K.$slots,"default")],2)}var ih=Y(bS,[["render",xS]]);const SS={name:"FooterToolbar",props:{extra:{type:String}}},wS={class:"ivu-footer-toolbar"},OS={key:0,class:"ivu-footer-toolbar-left"},CS={class:"ivu-footer-toolbar-right"};function TS(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",wS,[me.extra||K.$slots.extra?(E.openBlock(),E.createElementBlock("div",OS,[E.renderSlot(K.$slots,"extra",{},()=>[E.createTextVNode(E.toDisplayString(me.extra),1)])])):E.createCommentVNode("",!0),E.createElementVNode("div",CS,[E.renderSlot(K.$slots,"default")])])}var jp=Y(SS,[["render",TS]]);const _c="ivu-form",ES={name:"iForm",emits:["on-validate"],provide(){return{FormInstance:this}},props:{model:{type:Object},rules:{type:Object},labelWidth:{type:Number},labelPosition:{validator(K){return Ie(K,["left","right","top"])},default:"right"},inline:{type:Boolean,default:!1},showMessage:{type:Boolean,default:!0},autocomplete:{validator(K){return Ie(K,["on","off"])},default:"off"},hideRequiredMark:{type:Boolean,default:!1},labelColon:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1}},data(){return{fields:[]}},computed:{classes(){return[`${_c}`,`${_c}-label-${this.labelPosition}`,{[`${_c}-inline`]:this.inline,[`${_c}-hide-required-mark`]:this.hideRequiredMark}]},colon(){let K="";return this.labelColon&&(K=typeof this.labelColon=="boolean"?":":this.labelColon),K}},methods:{resetFields(){this.fields.forEach(K=>{K.resetField()})},validate(K){return new Promise(se=>{let me=!0,Be=0;this.fields.length===0&&(se(me),typeof K=="function"&&K(me)),this.fields.forEach(Re=>{Re.validate("",ve=>{ve&&(me=!1),++Be===this.fields.length&&(se(me),typeof K=="function"&&K(me))})})})},validateField(K,se){const me=this.fields.filter(Be=>Be.prop===K)[0];if(!me)throw new Error("[View UI warn]: must call validateField with valid prop string!");me.validate("",se)},addField(K){K&&this.fields.push(K)},removeField(K){K.prop&&this.fields.splice(this.fields.indexOf(K),1)}},watch:{rules(){this.validate()}}},AS=["autocomplete"];function MS(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("form",{class:E.normalizeClass(ve.classes),autocomplete:me.autocomplete},[E.renderSlot(K.$slots,"default")],10,AS)}var vc=Y(ES,[["render",MS]]);const PS={name:"GlobalFooter",components:{Icon:Ae},props:{links:{type:Array,default(){return[]}},copyright:{type:String}}},RS={class:"ivu-global-footer"},kS={key:0,class:"ivu-global-footer-links"},IS=["href","target","title"],BS={key:1,class:"ivu-global-footer-copyright"};function VS(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("footer",RS,[me.links.length||K.$slots.links?(E.openBlock(),E.createElementBlock("div",kS,[E.renderSlot(K.$slots,"links",{},()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.links,Xe=>(E.openBlock(),E.createElementBlock("a",{href:Xe.href,target:Xe.blankTarget?"_blank":"_self",key:Xe.key,title:Xe.title},[Xe.icon?(E.openBlock(),E.createBlock(Fe,{key:0,type:Xe.icon},null,8,["type"])):Xe.customIcon?(E.openBlock(),E.createBlock(Fe,{key:1,custom:Xe.customIcon},null,8,["custom"])):E.createCommentVNode("",!0),E.createTextVNode(" "+E.toDisplayString(Xe.title),1)],8,IS))),128))])])):E.createCommentVNode("",!0),me.copyright||K.$slots.copyright?(E.openBlock(),E.createElementBlock("div",BS,[E.renderSlot(K.$slots,"copyright",{},()=>[E.createTextVNode(E.toDisplayString(me.copyright),1)])])):E.createCommentVNode("",!0)])}var Xp=Y(PS,[["render",VS]]),nh={exports:{}},DS=nh.exports={};DS.forEach=function(K,se){for(var me=0;me<K.length;me++){var Be=se(K[me]);if(Be)return Be}};var NS=function(K){var se=K.stateHandler.getState;function me(Fe){var Xe=se(Fe);return Xe&&!!Xe.isDetectable}function Be(Fe){se(Fe).isDetectable=!0}function Re(Fe){return!!se(Fe).busy}function ve(Fe,Xe){se(Fe).busy=!!Xe}return{isDetectable:me,markAsDetectable:Be,isBusy:Re,markBusy:ve}},$S=function(K){var se={};function me(Fe){var Xe=K.get(Fe);return Xe===void 0?[]:se[Xe]||[]}function Be(Fe,Xe){var tt=K.get(Fe);se[tt]||(se[tt]=[]),se[tt].push(Xe)}function Re(Fe,Xe){for(var tt=me(Fe),Ze=0,it=tt.length;Ze<it;++Ze)if(tt[Ze]===Xe){tt.splice(Ze,1);break}}function ve(Fe){var Xe=me(Fe);!Xe||(Xe.length=0)}return{get:me,add:Be,removeListener:Re,removeAllListeners:ve}},LS=function(){var K=1;function se(){return K++}return{generate:se}},FS=function(K){var se=K.idGenerator,me=K.stateHandler.getState;function Be(ve){var Fe=me(ve);return Fe&&Fe.id!==void 0?Fe.id:null}function Re(ve){var Fe=me(ve);if(!Fe)throw new Error("setId required the element to have a resize detection state.");var Xe=se.generate();return Fe.id=Xe,Xe}return{get:Be,set:Re}},US=function(K){function se(){}var me={log:se,warn:se,error:se};if(!K&&window.console){var Be=function(Re,ve){Re[ve]=function(){var Fe=console[ve];if(Fe.apply)Fe.apply(console,arguments);else for(var Xe=0;Xe<arguments.length;Xe++)Fe(arguments[Xe])}};Be(me,"log"),Be(me,"warn"),Be(me,"error")}return me},sh={exports:{}},qp=sh.exports={};qp.isIE=function(K){function se(){var Be=navigator.userAgent.toLowerCase();return Be.indexOf("msie")!==-1||Be.indexOf("trident")!==-1||Be.indexOf(" edge/")!==-1}if(!se())return!1;if(!K)return!0;var me=function(){var Be,Re=3,ve=document.createElement("div"),Fe=ve.getElementsByTagName("i");do ve.innerHTML="<!--[if gt IE "+ ++Re+"]><i></i><![endif]-->";while(Fe[0]);return Re>4?Re:Be}();return K===me},qp.isLegacyOpera=function(){return!!window.opera};var Qp={exports:{}},zS=Qp.exports={};zS.getOption=WS;function WS(K,se,me){var Be=K[se];return Be==null&&me!==void 0?me:Be}var Yp=Qp.exports,GS=function(K){K=K||{};var se=K.reporter,me=Yp.getOption(K,"async",!0),Be=Yp.getOption(K,"auto",!0);Be&&!me&&(se&&se.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),me=!0);var Re=Kp(),ve,Fe=!1;function Xe(zr,Fr){!Fe&&Be&&me&&Re.size()===0&&it(),Re.add(zr,Fr)}function tt(){for(Fe=!0;Re.size();){var zr=Re;Re=Kp(),zr.process()}Fe=!1}function Ze(zr){Fe||(zr===void 0&&(zr=me),ve&&(nr(ve),ve=null),zr?it():tt())}function it(){ve=jr(tt)}function nr(zr){var Fr=clearTimeout;return Fr(zr)}function jr(zr){var Fr=function(_t){return setTimeout(_t,0)};return Fr(zr)}return{add:Xe,force:Ze}};function Kp(){var K={},se=0,me=0,Be=0;function Re(Xe,tt){tt||(tt=Xe,Xe=0),Xe>me?me=Xe:Xe<Be&&(Be=Xe),K[Xe]||(K[Xe]=[]),K[Xe].push(tt),se++}function ve(){for(var Xe=Be;Xe<=me;Xe++)for(var tt=K[Xe],Ze=0;Ze<tt.length;Ze++){var it=tt[Ze];it()}}function Fe(){return se}return{add:Re,process:ve,size:Fe}}var oh="_erd";function jS(K){return K[oh]={},Zp(K)}function Zp(K){return K[oh]}function HS(K){delete K[oh]}var XS={initState:jS,getState:Zp,cleanState:HS},Cl=sh.exports,qS=function(K){K=K||{};var se=K.reporter,me=K.batchProcessor,Be=K.stateHandler.getState;if(!se)throw new Error("Missing required dependency: reporter.");function Re(Ze,it){function nr(){it(Ze)}if(Cl.isIE(8))Be(Ze).object={proxy:nr},Ze.attachEvent("onresize",nr);else{var jr=Xe(Ze);if(!jr)throw new Error("Element is not detectable by this strategy.");jr.contentDocument.defaultView.addEventListener("resize",nr)}}function ve(Ze){var it=K.important?" !important; ":"; ";return(Ze.join(it)+it).trim()}function Fe(Ze,it,nr){nr||(nr=it,it=Ze,Ze=null),Ze=Ze||{},Ze.debug;function jr(zr,Fr){var _t=ve(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),ni=!1,on=window.getComputedStyle(zr),Gi=zr.offsetWidth,Qi=zr.offsetHeight;Be(zr).startSize={width:Gi,height:Qi};function wi(){function li(){if(on.position==="static"){zr.style.setProperty("position","relative",Ze.important?"important":"");var pn=function(fn,Zi,Yi,tn){function vn(ji){return ji.replace(/[^-\d\.]/g,"")}var Ji=Yi[tn];Ji!=="auto"&&vn(Ji)!=="0"&&(fn.warn("An element that is positioned static has style."+tn+"="+Ji+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+tn+" will be set to 0. Element: ",Zi),Zi.style.setProperty(tn,"0",Ze.important?"important":""))};pn(se,zr,on,"top"),pn(se,zr,on,"right"),pn(se,zr,on,"bottom"),pn(se,zr,on,"left")}}function Vi(){ni||li();function pn(Zi,Yi){if(!Zi.contentDocument){var tn=Be(Zi);tn.checkForObjectDocumentTimeoutId&&window.clearTimeout(tn.checkForObjectDocumentTimeoutId),tn.checkForObjectDocumentTimeoutId=setTimeout(function(){tn.checkForObjectDocumentTimeoutId=0,pn(Zi,Yi)},100);return}Yi(Zi.contentDocument)}var fn=this;pn(fn,function(Zi){Fr(zr)})}on.position!==""&&(li(),ni=!0);var Pi=document.createElement("object");Pi.style.cssText=_t,Pi.tabIndex=-1,Pi.type="text/html",Pi.setAttribute("aria-hidden","true"),Pi.onload=Vi,Cl.isIE()||(Pi.data="about:blank"),Be(zr)&&(zr.appendChild(Pi),Be(zr).object=Pi,Cl.isIE()&&(Pi.data="about:blank"))}me?me.add(wi):wi()}Cl.isIE(8)?nr(it):jr(it,nr)}function Xe(Ze){return Be(Ze).object}function tt(Ze){if(Be(Ze)){var it=Xe(Ze);!it||(Cl.isIE(8)?Ze.detachEvent("onresize",it.proxy):Ze.removeChild(it),Be(Ze).checkForObjectDocumentTimeoutId&&window.clearTimeout(Be(Ze).checkForObjectDocumentTimeoutId),delete Be(Ze).object)}}return{makeDetectable:Fe,addListener:Re,uninstall:tt}},QS=nh.exports.forEach,YS=function(K){K=K||{};var se=K.reporter,me=K.batchProcessor,Be=K.stateHandler.getState;K.stateHandler.hasState;var Re=K.idHandler;if(!me)throw new Error("Missing required dependency: batchProcessor");if(!se)throw new Error("Missing required dependency: reporter.");var ve=it(),Fe="erd_scroll_detection_scrollbar_style",Xe="erd_scroll_detection_container";function tt(wi){nr(wi,Fe,Xe)}tt(window.document);function Ze(wi){var li=K.important?" !important; ":"; ";return(wi.join(li)+li).trim()}function it(){var wi=500,li=500,Vi=document.createElement("div");Vi.style.cssText=Ze(["position: absolute","width: "+wi*2+"px","height: "+li*2+"px","visibility: hidden","margin: 0","padding: 0"]);var Pi=document.createElement("div");Pi.style.cssText=Ze(["position: absolute","width: "+wi+"px","height: "+li+"px","overflow: scroll","visibility: none","top: "+-wi*3+"px","left: "+-li*3+"px","visibility: hidden","margin: 0","padding: 0"]),Pi.appendChild(Vi),document.body.insertBefore(Pi,document.body.firstChild);var pn=wi-Pi.clientWidth,fn=li-Pi.clientHeight;return document.body.removeChild(Pi),{width:pn,height:fn}}function nr(wi,li,Vi){function Pi(Yi,tn){tn=tn||function(Ji){wi.head.appendChild(Ji)};var vn=wi.createElement("style");return vn.innerHTML=Yi,vn.id=li,tn(vn),vn}if(!wi.getElementById(li)){var pn=Vi+"_animation",fn=Vi+"_animation_active",Zi=`/* Created by the element-resize-detector library. */
`;Zi+="."+Vi+" > div::-webkit-scrollbar { "+Ze(["display: none"])+` }

`,Zi+="."+fn+" { "+Ze(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+pn,"animation-name: "+pn])+` }
`,Zi+="@-webkit-keyframes "+pn+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,Zi+="@keyframes "+pn+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",Pi(Zi)}}function jr(wi){wi.className+=" "+Xe+"_animation_active"}function zr(wi,li,Vi){if(wi.addEventListener)wi.addEventListener(li,Vi);else if(wi.attachEvent)wi.attachEvent("on"+li,Vi);else return se.error("[scroll] Don't know how to add event listeners.")}function Fr(wi,li,Vi){if(wi.removeEventListener)wi.removeEventListener(li,Vi);else if(wi.detachEvent)wi.detachEvent("on"+li,Vi);else return se.error("[scroll] Don't know how to remove event listeners.")}function _t(wi){return Be(wi).container.childNodes[0].childNodes[0].childNodes[0]}function ni(wi){return Be(wi).container.childNodes[0].childNodes[0].childNodes[1]}function on(wi,li){var Vi=Be(wi).listeners;if(!Vi.push)throw new Error("Cannot add listener to an element that is not detectable.");Be(wi).listeners.push(li)}function Gi(wi,li,Vi){Vi||(Vi=li,li=wi,wi=null),wi=wi||{};function Pi(){if(wi.debug){var Ki=Array.prototype.slice.call(arguments);if(Ki.unshift(Re.get(li),"Scroll: "),se.log.apply)se.log.apply(null,Ki);else for(var On=0;On<Ki.length;On++)se.log(Ki[On])}}function pn(Ki){function On(Fn){var _s=Fn.getRootNode&&Fn.getRootNode().contains(Fn);return Fn===Fn.ownerDocument.body||Fn.ownerDocument.body.contains(Fn)||_s}return!On(Ki)||window.getComputedStyle(Ki)===null}function fn(Ki){var On=Be(Ki).container.childNodes[0],Fn=window.getComputedStyle(On);return!Fn.width||Fn.width.indexOf("px")===-1}function Zi(){var Ki=window.getComputedStyle(li),On={};return On.position=Ki.position,On.width=li.offsetWidth,On.height=li.offsetHeight,On.top=Ki.top,On.right=Ki.right,On.bottom=Ki.bottom,On.left=Ki.left,On.widthCSS=Ki.width,On.heightCSS=Ki.height,On}function Yi(){var Ki=Zi();Be(li).startSize={width:Ki.width,height:Ki.height},Pi("Element start size",Be(li).startSize)}function tn(){Be(li).listeners=[]}function vn(){if(Pi("storeStyle invoked."),!Be(li)){Pi("Aborting because element has been uninstalled");return}var Ki=Zi();Be(li).style=Ki}function Ji(Ki,On,Fn){Be(Ki).lastWidth=On,Be(Ki).lastHeight=Fn}function ji(Ki){return _t(Ki).childNodes[0]}function Fi(){return 2*ve.width+1}function rn(){return 2*ve.height+1}function Xi(Ki){return Ki+10+Fi()}function Cn(Ki){return Ki+10+rn()}function En(Ki){return Ki*2+Fi()}function Hn(Ki){return Ki*2+rn()}function Yn(Ki,On,Fn){var _s=_t(Ki),Is=ni(Ki),Io=Xi(On),ea=Cn(Fn),Bs=En(On),qn=Hn(Fn);_s.scrollLeft=Io,_s.scrollTop=ea,Is.scrollLeft=Bs,Is.scrollTop=qn}function rs(){var Ki=Be(li).container;if(!Ki){Ki=document.createElement("div"),Ki.className=Xe,Ki.style.cssText=Ze(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),Be(li).container=Ki,jr(Ki),li.appendChild(Ki);var On=function(){Be(li).onRendered&&Be(li).onRendered()};zr(Ki,"animationstart",On),Be(li).onAnimationStart=On}return Ki}function os(){function Ki(){var cs=Be(li).style;if(cs.position==="static"){li.style.setProperty("position","relative",wi.important?"important":"");var po=function(Bo,fo,hu,ta){function jh(Hh){return Hh.replace(/[^-\d\.]/g,"")}var Ul=hu[ta];Ul!=="auto"&&jh(Ul)!=="0"&&(Bo.warn("An element that is positioned static has style."+ta+"="+Ul+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+ta+" will be set to 0. Element: ",fo),fo.style[ta]=0)};po(se,li,cs,"top"),po(se,li,cs,"right"),po(se,li,cs,"bottom"),po(se,li,cs,"left")}}function On(cs,po,Bo,fo){return cs=cs?cs+"px":"0",po=po?po+"px":"0",Bo=Bo?Bo+"px":"0",fo=fo?fo+"px":"0",["left: "+cs,"top: "+po,"right: "+fo,"bottom: "+Bo]}if(Pi("Injecting elements"),!Be(li)){Pi("Aborting because element has been uninstalled");return}Ki();var Fn=Be(li).container;Fn||(Fn=rs());var _s=ve.width,Is=ve.height,Io=Ze(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),ea=Ze(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(On(-(1+_s),-(1+Is),-Is,-_s))),Bs=Ze(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),qn=Ze(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),$s=Ze(["position: absolute","left: 0","top: 0"]),uo=Ze(["position: absolute","width: 200%","height: 200%"]),Ys=document.createElement("div"),ho=document.createElement("div"),Ha=document.createElement("div"),lu=document.createElement("div"),Xa=document.createElement("div"),cu=document.createElement("div");Ys.dir="ltr",Ys.style.cssText=Io,Ys.className=Xe,ho.className=Xe,ho.style.cssText=ea,Ha.style.cssText=Bs,lu.style.cssText=$s,Xa.style.cssText=qn,cu.style.cssText=uo,Ha.appendChild(lu),Xa.appendChild(cu),ho.appendChild(Ha),ho.appendChild(Xa),Ys.appendChild(ho),Fn.appendChild(Ys);function uu(){var cs=Be(li);cs&&cs.onExpand?cs.onExpand():Pi("Aborting expand scroll handler: element has been uninstalled")}function Fl(){var cs=Be(li);cs&&cs.onShrink?cs.onShrink():Pi("Aborting shrink scroll handler: element has been uninstalled")}zr(Ha,"scroll",uu),zr(Xa,"scroll",Fl),Be(li).onExpandScroll=uu,Be(li).onShrinkScroll=Fl}function vs(){function Ki(Bs,qn,$s){var uo=ji(Bs),Ys=Xi(qn),ho=Cn($s);uo.style.setProperty("width",Ys+"px",wi.important?"important":""),uo.style.setProperty("height",ho+"px",wi.important?"important":"")}function On(Bs){var qn=li.offsetWidth,$s=li.offsetHeight,uo=qn!==Be(li).lastWidth||$s!==Be(li).lastHeight;Pi("Storing current size",qn,$s),Ji(li,qn,$s),me.add(0,function(){if(uo){if(!Be(li)){Pi("Aborting because element has been uninstalled");return}if(!Fn()){Pi("Aborting because element container has not been initialized");return}if(wi.debug){var Ys=li.offsetWidth,ho=li.offsetHeight;(Ys!==qn||ho!==$s)&&se.warn(Re.get(li),"Scroll: Size changed before updating detector elements.")}Ki(li,qn,$s)}}),me.add(1,function(){if(!Be(li)){Pi("Aborting because element has been uninstalled");return}if(!Fn()){Pi("Aborting because element container has not been initialized");return}Yn(li,qn,$s)}),uo&&Bs&&me.add(2,function(){if(!Be(li)){Pi("Aborting because element has been uninstalled");return}if(!Fn()){Pi("Aborting because element container has not been initialized");return}Bs()})}function Fn(){return!!Be(li).container}function _s(){function Bs(){return Be(li).lastNotifiedWidth===void 0}Pi("notifyListenersIfNeeded invoked");var qn=Be(li);if(Bs()&&qn.lastWidth===qn.startSize.width&&qn.lastHeight===qn.startSize.height)return Pi("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(qn.lastWidth===qn.lastNotifiedWidth&&qn.lastHeight===qn.lastNotifiedHeight)return Pi("Not notifying: Size already notified");Pi("Current size not notified, notifying..."),qn.lastNotifiedWidth=qn.lastWidth,qn.lastNotifiedHeight=qn.lastHeight,QS(Be(li).listeners,function($s){$s(li)})}function Is(){if(Pi("startanimation triggered."),fn(li)){Pi("Ignoring since element is still unrendered...");return}Pi("Element rendered.");var Bs=_t(li),qn=ni(li);(Bs.scrollLeft===0||Bs.scrollTop===0||qn.scrollLeft===0||qn.scrollTop===0)&&(Pi("Scrollbars out of sync. Updating detector elements..."),On(_s))}function Io(){if(Pi("Scroll detected."),fn(li)){Pi("Scroll event fired while unrendered. Ignoring...");return}On(_s)}if(Pi("registerListenersAndPositionElements invoked."),!Be(li)){Pi("Aborting because element has been uninstalled");return}Be(li).onRendered=Is,Be(li).onExpand=Io,Be(li).onShrink=Io;var ea=Be(li).style;Ki(li,ea.width,ea.height)}function Ns(){if(Pi("finalizeDomMutation invoked."),!Be(li)){Pi("Aborting because element has been uninstalled");return}var Ki=Be(li).style;Ji(li,Ki.width,Ki.height),Yn(li,Ki.width,Ki.height)}function lo(){Vi(li)}function co(){Pi("Installing..."),tn(),Yi(),me.add(0,vn),me.add(1,os),me.add(2,vs),me.add(3,Ns),me.add(4,lo)}Pi("Making detectable..."),pn(li)?(Pi("Element is detached"),rs(),Pi("Waiting until element is attached..."),Be(li).onRendered=function(){Pi("Element is now attached"),co()}):co()}function Qi(wi){var li=Be(wi);!li||(li.onExpandScroll&&Fr(_t(wi),"scroll",li.onExpandScroll),li.onShrinkScroll&&Fr(ni(wi),"scroll",li.onShrinkScroll),li.onAnimationStart&&Fr(li.container,"animationstart",li.onAnimationStart),li.container&&wi.removeChild(li.container))}return{makeDetectable:Gi,addListener:on,uninstall:Qi,initDocument:tt}},Tl=nh.exports.forEach,KS=NS,ZS=$S,JS=LS,t1=FS,r1=US,Jp=sh.exports,i1=GS,Wo=XS,n1=qS,s1=YS;function ef(K){return Array.isArray(K)||K.length!==void 0}function tf(K){if(Array.isArray(K))return K;var se=[];return Tl(K,function(me){se.push(me)}),se}function nf(K){return K&&K.nodeType===1}var Na=function(K){K=K||{};var se;if(K.idHandler)se={get:function(Gi){return K.idHandler.get(Gi,!0)},set:K.idHandler.set};else{var me=JS(),Be=t1({idGenerator:me,stateHandler:Wo});se=Be}var Re=K.reporter;if(!Re){var ve=Re===!1;Re=r1(ve)}var Fe=Go(K,"batchProcessor",i1({reporter:Re})),Xe={};Xe.callOnAdd=!!Go(K,"callOnAdd",!0),Xe.debug=!!Go(K,"debug",!1);var tt=ZS(se),Ze=KS({stateHandler:Wo}),it,nr=Go(K,"strategy","object"),jr=Go(K,"important",!1),zr={reporter:Re,batchProcessor:Fe,stateHandler:Wo,idHandler:se,important:jr};if(nr==="scroll"&&(Jp.isLegacyOpera()?(Re.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),nr="object"):Jp.isIE(9)&&(Re.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),nr="object")),nr==="scroll")it=s1(zr);else if(nr==="object")it=n1(zr);else throw new Error("Invalid strategy name: "+nr);var Fr={};function _t(Gi,Qi,wi){function li(Yi){var tn=tt.get(Yi);Tl(tn,function(vn){vn(Yi)})}function Vi(Yi,tn,vn){tt.add(tn,vn),Yi&&vn(tn)}if(wi||(wi=Qi,Qi=Gi,Gi={}),!Qi)throw new Error("At least one element required.");if(!wi)throw new Error("Listener required.");if(nf(Qi))Qi=[Qi];else if(ef(Qi))Qi=tf(Qi);else return Re.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var Pi=0,pn=Go(Gi,"callOnAdd",Xe.callOnAdd),fn=Go(Gi,"onReady",function(){}),Zi=Go(Gi,"debug",Xe.debug);Tl(Qi,function(Yi){Wo.getState(Yi)||(Wo.initState(Yi),se.set(Yi));var tn=se.get(Yi);if(Zi&&Re.log("Attaching listener to element",tn,Yi),!Ze.isDetectable(Yi)){if(Zi&&Re.log(tn,"Not detectable."),Ze.isBusy(Yi)){Zi&&Re.log(tn,"System busy making it detectable"),Vi(pn,Yi,wi),Fr[tn]=Fr[tn]||[],Fr[tn].push(function(){Pi++,Pi===Qi.length&&fn()});return}return Zi&&Re.log(tn,"Making detectable..."),Ze.markBusy(Yi,!0),it.makeDetectable({debug:Zi,important:jr},Yi,function(vn){if(Zi&&Re.log(tn,"onElementDetectable"),Wo.getState(vn)){Ze.markAsDetectable(vn),Ze.markBusy(vn,!1),it.addListener(vn,li),Vi(pn,vn,wi);var Ji=Wo.getState(vn);if(Ji&&Ji.startSize){var ji=vn.offsetWidth,Fi=vn.offsetHeight;(Ji.startSize.width!==ji||Ji.startSize.height!==Fi)&&li(vn)}Fr[tn]&&Tl(Fr[tn],function(rn){rn()})}else Zi&&Re.log(tn,"Element uninstalled before being detectable.");delete Fr[tn],Pi++,Pi===Qi.length&&fn()})}Zi&&Re.log(tn,"Already detecable, adding listener."),Vi(pn,Yi,wi),Pi++}),Pi===Qi.length&&fn()}function ni(Gi){if(!Gi)return Re.error("At least one element is required.");if(nf(Gi))Gi=[Gi];else if(ef(Gi))Gi=tf(Gi);else return Re.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");Tl(Gi,function(Qi){tt.removeAllListeners(Qi),it.uninstall(Qi),Wo.cleanState(Qi)})}function on(Gi){it.initDocument&&it.initDocument(Gi)}return{listenTo:_t,removeListener:tt.removeListener,removeAllListeners:tt.removeAllListeners,uninstall:ni,initDocument:on}};function Go(K,se,me){var Be=K[se];return Be==null&&me!==void 0?me:Be}var sf="Expected a function",of=NaN,o1="[object Symbol]",a1=/^\s+|\s+$/g,l1=/^[-+]0x[0-9a-f]+$/i,c1=/^0b[01]+$/i,u1=/^0o[0-7]+$/i,h1=parseInt,d1=typeof ct=="object"&&ct&&ct.Object===Object&&ct,p1=typeof self=="object"&&self&&self.Object===Object&&self,f1=d1||p1||Function("return this")(),m1=Object.prototype,g1=m1.toString,y1=Math.max,_1=Math.min,ah=function(){return f1.Date.now()};function b1(K,se,me){var Be,Re,ve,Fe,Xe,tt,Ze=0,it=!1,nr=!1,jr=!0;if(typeof K!="function")throw new TypeError(sf);se=af(se)||0,$c(me)&&(it=!!me.leading,nr="maxWait"in me,ve=nr?y1(af(me.maxWait)||0,se):ve,jr="trailing"in me?!!me.trailing:jr);function zr(Vi){var Pi=Be,pn=Re;return Be=Re=void 0,Ze=Vi,Fe=K.apply(pn,Pi),Fe}function Fr(Vi){return Ze=Vi,Xe=setTimeout(on,se),it?zr(Vi):Fe}function _t(Vi){var Pi=Vi-tt,pn=Vi-Ze,fn=se-Pi;return nr?_1(fn,ve-pn):fn}function ni(Vi){var Pi=Vi-tt,pn=Vi-Ze;return tt===void 0||Pi>=se||Pi<0||nr&&pn>=ve}function on(){var Vi=ah();if(ni(Vi))return Gi(Vi);Xe=setTimeout(on,_t(Vi))}function Gi(Vi){return Xe=void 0,jr&&Be?zr(Vi):(Be=Re=void 0,Fe)}function Qi(){Xe!==void 0&&clearTimeout(Xe),Ze=0,Be=tt=Re=Xe=void 0}function wi(){return Xe===void 0?Fe:Gi(ah())}function li(){var Vi=ah(),Pi=ni(Vi);if(Be=arguments,Re=this,tt=Vi,Pi){if(Xe===void 0)return Fr(tt);if(nr)return Xe=setTimeout(on,se),zr(tt)}return Xe===void 0&&(Xe=setTimeout(on,se)),Fe}return li.cancel=Qi,li.flush=wi,li}function x1(K,se,me){var Be=!0,Re=!0;if(typeof K!="function")throw new TypeError(sf);return $c(me)&&(Be="leading"in me?!!me.leading:Be,Re="trailing"in me?!!me.trailing:Re),b1(K,se,{leading:Be,maxWait:se,trailing:Re})}function $c(K){var se=typeof K;return!!K&&(se=="object"||se=="function")}function S1(K){return!!K&&typeof K=="object"}function w1(K){return typeof K=="symbol"||S1(K)&&g1.call(K)==o1}function af(K){if(typeof K=="number")return K;if(w1(K))return of;if($c(K)){var se=typeof K.valueOf=="function"?K.valueOf():K;K=$c(se)?se+"":se}if(typeof K!="string")return K===0?K:+K;K=K.replace(a1,"");var me=c1.test(K);return me||u1.test(K)?h1(K.slice(2),me?2:8):l1.test(K)?of:+K}var Wc=x1;const O1={name:"Grid",provide(){return{GridInstance:this}},props:{col:{type:Number,default:3},square:{type:Boolean,default:!1},padding:{type:String,default:"24px"},center:{type:Boolean,default:!1},border:{type:Boolean,default:!0},hover:{type:Boolean,default:!1}},data(){return{resizeCount:0,handleResize:()=>{}}},computed:{classes(){return{"ivu-grid-center":this.center,"ivu-grid-border":this.border,"ivu-grid-hover":this.hover}}},methods:{onResize(){this.resizeCount++}},mounted(){this.handleResize=Wc(this.onResize,150,{leading:!1}),this.observer=Na(),this.observer.listenTo(this.$refs.grid,this.handleResize)},beforeUnmount(){this.observer.removeListener(this.$refs.grid,this.handleResize)}};function C1(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-grid",ve.classes]),ref:"grid"},[E.renderSlot(K.$slots,"default")],2)}var lf=Y(O1,[["render",C1]]);const T1={name:"GridItem",inject:["GridInstance"],data(){return{height:0}},computed:{col(){return this.GridInstance.col},square(){return this.GridInstance.square},styles(){const K={width:`${100/this.col}%`};return this.height&&this.square&&(K.height=`${this.height}px`),K},mainStyles(){return{padding:this.GridInstance.padding}}},watch:{col(){E.nextTick(()=>{this.handleChangeHeight()})},square(){this.handleChangeHeight()},"GridInstance.resizeCount"(){this.handleChangeHeight()}},methods:{handleChangeHeight(){if(this.square){const K=this.$refs.col;this.height=parseFloat(He(K,"width"))}}},mounted(){this.handleChangeHeight()}};function E1(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:"ivu-grid-item",style:E.normalizeStyle(ve.styles),ref:"col"},[E.createElementVNode("div",{class:"ivu-grid-item-main",style:E.normalizeStyle(ve.mainStyles)},[E.renderSlot(K.$slots,"default")],4)],4)}var cf=Y(T1,[["render",E1]]);const A1="ivu-layout",M1={name:"Header",computed:{wrapClasses(){return`${A1}-header`}}};function R1(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[E.renderSlot(K.$slots,"default")],2)}var lh=Y(M1,[["render",R1]]);const dn={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent(K){const{keyCode:se}=K;if(K.altKey&&!K.ctrlKey||K.metaKey||se>=dn.F1&&se<=dn.F12)return!1;switch(se){case dn.ALT:case dn.CAPS_LOCK:case dn.CONTEXT_MENU:case dn.CTRL:case dn.DOWN:case dn.END:case dn.ESC:case dn.HOME:case dn.INSERT:case dn.LEFT:case dn.MAC_FF_META:case dn.META:case dn.NUMLOCK:case dn.NUM_CENTER:case dn.PAGE_DOWN:case dn.PAGE_UP:case dn.PAUSE:case dn.PRINT_SCREEN:case dn.RIGHT:case dn.SHIFT:case dn.UP:case dn.WIN_KEY:case dn.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey(K){if(K>=dn.ZERO&&K<=dn.NINE||K>=dn.NUM_ZERO&&K<=dn.NUM_MULTIPLY||K>=dn.A&&K<=dn.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&K===0)return!0;switch(K){case dn.SPACE:case dn.QUESTION_MARK:case dn.NUM_PLUS:case dn.NUM_MINUS:case dn.NUM_PERIOD:case dn.NUM_DIVISION:case dn.SEMICOLON:case dn.DASH:case dn.EQUALS:case dn.COMMA:case dn.PERIOD:case dn.SLASH:case dn.APOSTROPHE:case dn.SINGLE_QUOTE:case dn.OPEN_SQUARE_BRACKET:case dn.BACKSLASH:case dn.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},jo="ivu-spin",k1={name:"Spin",mixins:[rh],props:{size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},fix:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},show:{type:Boolean,default:!0}},data(){return{showText:!1,visible:!1}},computed:{classes(){return[`${jo}`,{[`${jo}-${this.size}`]:!!this.size,[`${jo}-fix`]:this.fix,[`${jo}-show-text`]:this.showText,[`${jo}-fullscreen`]:this.fullscreen}]},mainClasses(){return`${jo}-main`},dotClasses(){return`${jo}-dot`},textClasses(){return`${jo}-text`},fullscreenVisible(){return this.fullscreen?this.visible:!0}},watch:{visible(K){K?this.addScrollEffect():this.removeScrollEffect()}},mounted(){this.showText=!!this.$slots.default&&this.$slots.default().some(K=>K.children&&K.children.length)}};function I1(K,se,me,Be,Re,ve){return E.openBlock(),E.createBlock(E.Transition,{name:"fade"},{default:E.withCtx(()=>[ve.fullscreenVisible&&me.show?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.classes)},[E.createElementVNode("div",{class:E.normalizeClass(ve.mainClasses)},[E.createElementVNode("span",{class:E.normalizeClass(ve.dotClasses)},null,2),E.createElementVNode("div",{class:E.normalizeClass(ve.textClasses)},[E.renderSlot(K.$slots,"default")],2)],2)],2)):E.createCommentVNode("",!0)]),_:3})}var Xs=Y(k1,[["render",I1]]);const B1={name:"ImagePreview",mixins:[Xn],components:{Icon:Ae,Spin:Xs,Row:Lo,Col:vo},inheritAttrs:!1,emits:["update:modelValue","on-close","on-switch"],props:{modelValue:{type:Boolean,default:!1},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array,default(){return[]}},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},toolbar:{type:Array,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||!K.$VIEWUI.image||K.$VIEWUI.image.toolbar===""?["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]:K.$VIEWUI.image.toolbar}}},data(){return{currentIndex:0,scale:1,degree:0,translate:{x:0,y:0},startX:0,startY:0,transition:!0,original:!1,prevOverflow:"",status:"loading",zIndex:1e3,maskIndex:this.getMaskIndex(),downloading:!1}},computed:{imgClasses(){return["ivu-image-preview-image",{"ivu-image-preview-grabbing":!this.transition,"ivu-image-preview-hidden":this.status==="failed","ivu-image-preview-transition":this.transition,"ivu-image-preview-limit":!this.original}]},imageStyle(){let K=this.translate.x/this.scale,se=this.translate.y/this.scale;const me=this.degree%360;return[90,-270].includes(me)&&([K,se]=[se,-K]),[180,-180].includes(me)&&([K,se]=[-K,-se]),[270,-90].includes(me)&&([K,se]=[-se,K]),{transform:`
                        scale(${this.scale})
                        rotate(${this.degree}deg)
                        translate(${K}px, ${se}px)
                    `}},maskStyle(){return{zIndex:this.maskIndex+this.zIndex}},leftClasses(){return["ivu-image-preview-arrow-left",{"ivu-image-preview-arrow-disabled":this.hasLeftSwitchEnd}]},rightClasses(){return["ivu-image-preview-arrow-right",{"ivu-image-preview-arrow-disabled":this.hasRightSwitchEnd}]},hasRightSwitchEnd(){const{currentIndex:K,infinite:se,previewList:me}=this,Be=me.length;return se?!1:K>=Be-1},hasLeftSwitchEnd(){const{currentIndex:K,infinite:se}=this;return se?!1:K===0},currentSrc(){return this.previewList[this.currentIndex]},failLang(){return this.t("i.image.fail")}},methods:{resetStyle(){this.scale=1,this.degree=0,this.translate.x=0,this.translate.y=0},handleClose(){this.$emit("update:modelValue",!1),this.$emit("on-close")},handleClickMask(){!this.maskClosable||this.handleClose()},handleSwitch(K){K?this.currentIndex+1===this.previewList.length?this.infinite&&(this.resetStyle(),this.currentIndex=0):(this.resetStyle(),this.currentIndex+=1):this.currentIndex===0?this.infinite&&(this.resetStyle(),this.currentIndex=this.previewList.length-1):(this.resetStyle(),this.currentIndex-=1),this.$emit("on-switch",{currentIndex:this.currentIndex})},handleOperation(K){K==="zoomIn"&&this.scale<6&&(this.scale+=.25),K==="zoomOut"&&this.scale>.25&&(this.scale-=.25),K==="rotateLeft"&&(this.degree-=90),K==="rotateRight"&&(this.degree+=90),K==="original"&&(this.original=!this.original,this.transition=!1,this.resetStyle(),setTimeout(()=>{this.transition=!0},0)),K==="download"&&(this.downloading=!0,Mi(this.previewList[this.currentIndex]).then(()=>{this.downloading=!1}).catch(()=>{this.downloading=!1}))},handleKeydown(K){if(!this.modelValue)return;const{keyCode:se}=K;se===dn.LEFT&&this.handleSwitch(!1),se===dn.RIGHT&&this.handleSwitch(!0),se===dn.UP&&this.handleOperation("zoomIn"),se===dn.DOWN&&this.handleOperation("zoomOut"),se===dn.SPACE&&(K.preventDefault(),this.original=!this.original)},handleKeyup(K){if(!this.modelValue)return;const{keyCode:se}=K;se===dn.ESC&&this.handleClose()},handleWheel(K){if(!this.modelValue)return;const{deltaY:se}=K;this.handleOperation(se<0?"zoomIn":"zoomOut")},handleMousedown(K){const{pageX:se,pageY:me,which:Be}=K;Be===1&&(this.startX=se,this.startY=me,this.transition=!1,X(document,"mousemove",this.handleMousemove),X(document,"mouseup",this.handleMouseup))},handleMousemove:Wc(function(K){K.stopPropagation();const{pageX:se,pageY:me}=K;this.translate.x+=se-this.startX,this.translate.y+=me-this.startY,this.startX=se,this.startY=me}),handleMouseup(){this.transition=!0,q(document,"mousemove",this.handleMousemove),q(document,"mouseup",this.handleMouseup)},getBodyOverflow(){return W?document.body.style.overflow:""},setBodyOverflow(K){!W||(document.body.style.overflow=K)},handleImageLoad(){this.status="loaded"},handleImageError(){this.status="failed"},getMaskIndex(){return Ai(),ti}},watch:{modelValue(K){K?(this.currentIndex=this.initialIndex,this.resetStyle(),this.original=!1,this.prevOverflow=this.getBodyOverflow(),this.setBodyOverflow("hidden"),this.maskIndex=this.getMaskIndex()):this.setBodyOverflow(this.prevOverflow)},currentIndex(){this.status="loading"}},mounted(){X(document,"keydown",this.handleKeydown),X(document,"keyup",this.handleKeyup),X(document,"wheel",this.handleWheel)},beforeUnmount(){q(document,"keydown",this.handleKeydown),q(document,"keyup",this.handleKeyup),q(document,"wheel",this.handleWheel)}},V1={key:1,class:"ivu-image-preview-fail"},D1=["src"],N1=[E.createElementVNode("path",{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z","p-id":"7198",fill:"#ffffff"},null,-1),E.createElementVNode("path",{d:"M921 867L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z","p-id":"7199",fill:"#ffffff"},null,-1)],$1=[E.createElementVNode("path",{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z","p-id":"7413",fill:"#ffffff"},null,-1),E.createElementVNode("path",{d:"M921 867L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z","p-id":"7414",fill:"#ffffff"},null,-1)],L1=[E.createElementVNode("path",{d:"M358.058667 128H156.970667A28.970667 28.970667 0 0 0 128 157.013333v202.837334c0 7.978667 6.528 14.506667 14.506667 14.506666h43.434666a14.506667 14.506667 0 0 0 14.506667-14.506666V200.448h157.610667a14.506667 14.506667 0 0 0 14.506666-14.506667V142.506667a14.506667 14.506667 0 0 0-14.506666-14.506667zM881.493333 649.642667h-43.434666a14.506667 14.506667 0 0 0-14.506667 14.506666v159.402667h-157.610667a14.506667 14.506667 0 0 0-14.506666 14.506667v43.434666c0 7.978667 6.570667 14.506667 14.506666 14.506667h201.088c16 0 28.970667-12.928 28.970667-29.013333v-202.837334a14.506667 14.506667 0 0 0-14.506667-14.506666zM358.058667 823.552H200.448v-159.402667a14.506667 14.506667 0 0 0-14.506667-14.506666H142.506667a14.506667 14.506667 0 0 0-14.506667 14.506666v202.88c0 16 12.970667 28.970667 29.013333 28.970667h201.045334a14.506667 14.506667 0 0 0 14.506666-14.506667v-43.434666a14.506667 14.506667 0 0 0-14.506666-14.506667zM866.986667 128h-201.088a14.506667 14.506667 0 0 0-14.506667 14.506667v43.434666c0 7.978667 6.570667 14.506667 14.506667 14.506667h157.610666v159.402667c0 7.978667 6.528 14.506667 14.506667 14.506666h43.434667a14.506667 14.506667 0 0 0 14.506666-14.506666V156.970667A28.928 28.928 0 0 0 866.986667 128z","p-id":"26673",fill:"#ffffff"},null,-1)],F1=[E.createElementVNode("path",{d:"M864 128H160c-19.2 0-32 12.8-32 32v704c0 19.2 12.8 32 32 32h704c19.2 0 32-12.8 32-32V160c0-19.2-12.8-32-32-32z m-32 704H192V192h640v640z","p-id":"1977",fill:"#ffffff"},null,-1),E.createElementVNode("path",{d:"M320 384v288c0 19.2 12.8 32 32 32s32-12.8 32-32V352c0-19.2-12.8-32-32-32h-32c-19.2 0-32 12.8-32 32s12.8 32 32 32zM640 384v288c0 19.2 12.8 32 32 32s32-12.8 32-32V352c0-19.2-12.8-32-32-32h-32c-19.2 0-32 12.8-32 32s12.8 32 32 32z","p-id":"1978",fill:"#ffffff"},null,-1),E.createElementVNode("path",{d:"M512 384m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z","p-id":"1979",fill:"#ffffff"},null,-1),E.createElementVNode("path",{d:"M512 640m-32 0a32 32 0 1 0 64 0 32 32 0 1 0-64 0Z","p-id":"1980",fill:"#ffffff"},null,-1)],U1=[E.createElementVNode("path",{d:"M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32z m-44 402H188V494h440v326z m191.3-491.5c-78.8-100.7-196-153.6-314.6-154.2l-0.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7 0.4 12.6-6.1v-63.9c12.9 0.1 25.9 0.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8 11 40.7 14 82.7 8.9 124.8-0.7 5.4-1.4 10.8-2.4 16.1h74.9c14.8-103.6-11.3-213-81-302.3z","p-id":"13309",fill:"#ffffff"},null,-1)],z1=[E.createElementVNode("path",{d:"M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-0.4-12.6 6.1l-0.2 64c-118.6 0.5-235.8 53.4-314.6 154.2-69.6 89.2-95.7 198.6-81.1 302.4h74.9c-0.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8zM880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32z m-44 402H396V494h440v326z","p-id":"13522",fill:"#ffffff"},null,-1)],W1=[E.createElementVNode("path",{d:"M505.7 621c3.2 4.1 9.4 4.1 12.6 0l112-141.7c4.1-5.2 0.4-12.9-6.3-12.9h-72.1V120c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v346.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z","p-id":"8826",fill:"#ffffff"},null,-1),E.createElementVNode("path",{d:"M903 516h-64c-4.4 0-8 3.6-8 8v300c0 4.4-3.6 8-8 8H199c-4.4 0-8-3.6-8-8V524c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v372c0 8.8 7.2 16 16 16h768c8.8 0 16-7.2 16-16V524c0-4.4-3.6-8-8-8z","p-id":"8827",fill:"#ffffff"},null,-1)],G1={class:"ivu-image-preview-operations-item ivu-image-preview-operations-wait ivu-anim-loop",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7816",width:"200",height:"200"},j1=[E.createElementVNode("path",{d:"M512 64c247.2 0 448 200.8 448 448h-64c0-212-172-384-384-384V64z m0 832c-212 0-384-172-384-384H64c0 247.2 200.8 448 448 448v-64z","p-id":"7817",fill:"#ffffff"},null,-1)];function H1(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Spin"),Xe=E.resolveComponent("Col"),tt=E.resolveComponent("Row"),Ze=E.resolveComponent("Icon");return E.openBlock(),E.createBlock(E.Teleport,{to:"body",disabled:!me.transfer},[E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[me.modelValue?(E.openBlock(),E.createElementBlock("div",{key:0,class:"ivu-image-preview-mask",style:E.normalizeStyle(ve.maskStyle)},null,4)):E.createCommentVNode("",!0)]),_:1}),E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[me.modelValue?(E.openBlock(),E.createElementBlock("div",{key:0,class:"ivu-image-preview-wrap",style:E.normalizeStyle(ve.maskStyle)},[E.createElementVNode("div",E.mergeProps({class:"ivu-image-preview"},K.$attrs,{onClick:se[14]||(se[14]=E.withModifiers((...it)=>ve.handleClickMask&&ve.handleClickMask(...it),["stop"]))}),[Re.status==="loading"?(E.openBlock(),E.createBlock(Fe,{key:0,size:"large",class:"ivu-image-preview-loading"})):Re.status==="failed"?(E.openBlock(),E.createElementBlock("div",V1,[E.createElementVNode("span",null,E.toDisplayString(ve.failLang),1)])):E.createCommentVNode("",!0),(E.openBlock(),E.createElementBlock("img",{class:E.normalizeClass(ve.imgClasses),style:E.normalizeStyle(ve.imageStyle),src:ve.currentSrc,key:Re.currentIndex.toString(),onClick:se[0]||(se[0]=E.withModifiers(()=>{},["stop"])),onMousedown:se[1]||(se[1]=E.withModifiers((...it)=>ve.handleMousedown&&ve.handleMousedown(...it),["stop","prevent"])),onLoad:se[2]||(se[2]=(...it)=>ve.handleImageLoad&&ve.handleImageLoad(...it)),onError:se[3]||(se[3]=(...it)=>ve.handleImageError&&ve.handleImageError(...it))},null,46,D1)),me.toolbar&&me.toolbar.length>0?(E.openBlock(),E.createBlock(tt,{key:2,"class-name":"ivu-image-preview-operations",wrap:!1,onClick:se[11]||(se[11]=E.withModifiers(()=>{},["stop"]))},{default:E.withCtx(()=>[me.toolbar.indexOf("zoomIn")>-1?(E.openBlock(),E.createBlock(Xe,{key:0,flex:"1",order:me.toolbar.indexOf("zoomIn")+1},{default:E.withCtx(()=>[(E.openBlock(),E.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:se[4]||(se[4]=E.withModifiers(it=>ve.handleOperation("zoomIn"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7197",width:"200",height:"200"},N1))]),_:1},8,["order"])):E.createCommentVNode("",!0),me.toolbar.indexOf("zoomOut")>-1?(E.openBlock(),E.createBlock(Xe,{key:1,flex:"1",order:me.toolbar.indexOf("zoomOut")+1},{default:E.withCtx(()=>[(E.openBlock(),E.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:se[5]||(se[5]=E.withModifiers(it=>ve.handleOperation("zoomOut"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7412",width:"200",height:"200"},$1))]),_:1},8,["order"])):E.createCommentVNode("",!0),me.toolbar.indexOf("original")>-1?(E.openBlock(),E.createBlock(Xe,{key:2,flex:"1",order:me.toolbar.indexOf("original")+1},{default:E.withCtx(()=>[E.withDirectives((E.openBlock(),E.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:se[6]||(se[6]=E.withModifiers(it=>ve.handleOperation("original"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"26672",width:"200",height:"200"},L1,512)),[[E.vShow,!this.original]]),E.withDirectives((E.openBlock(),E.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:se[7]||(se[7]=E.withModifiers(it=>ve.handleOperation("original"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1976",width:"200",height:"200"},F1,512)),[[E.vShow,this.original]])]),_:1},8,["order"])):E.createCommentVNode("",!0),me.toolbar.indexOf("rotateLeft")>-1?(E.openBlock(),E.createBlock(Xe,{key:3,flex:"1",order:me.toolbar.indexOf("rotateLeft")+1},{default:E.withCtx(()=>[(E.openBlock(),E.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:se[8]||(se[8]=E.withModifiers(it=>ve.handleOperation("rotateLeft"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13308",width:"200",height:"200"},U1))]),_:1},8,["order"])):E.createCommentVNode("",!0),me.toolbar.indexOf("rotateRight")>-1?(E.openBlock(),E.createBlock(Xe,{key:4,flex:"1",order:me.toolbar.indexOf("rotateRight")+1},{default:E.withCtx(()=>[(E.openBlock(),E.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:se[9]||(se[9]=E.withModifiers(it=>ve.handleOperation("rotateRight"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"13521",width:"200",height:"200"},z1))]),_:1},8,["order"])):E.createCommentVNode("",!0),me.toolbar.indexOf("download")>-1?(E.openBlock(),E.createBlock(Xe,{key:5,flex:"1",order:me.toolbar.indexOf("download")+1},{default:E.withCtx(()=>[E.withDirectives((E.openBlock(),E.createElementBlock("svg",{class:"ivu-image-preview-operations-item",onClick:se[10]||(se[10]=E.withModifiers(it=>ve.handleOperation("download"),["stop"])),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8825",width:"200",height:"200"},W1,512)),[[E.vShow,!Re.downloading]]),E.withDirectives((E.openBlock(),E.createElementBlock("svg",G1,j1,512)),[[E.vShow,Re.downloading]])]),_:1},8,["order"])):E.createCommentVNode("",!0)]),_:1})):E.createCommentVNode("",!0),me.previewList.length>1?(E.openBlock(),E.createBlock(Ze,{key:3,class:E.normalizeClass(ve.leftClasses),type:"ios-arrow-back",onClick:se[12]||(se[12]=E.withModifiers(it=>ve.handleSwitch(!1),["stop"]))},null,8,["class"])):E.createCommentVNode("",!0),me.previewList.length>1?(E.openBlock(),E.createBlock(Ze,{key:4,class:E.normalizeClass(ve.rightClasses),type:"ios-arrow-forward",onClick:se[13]||(se[13]=E.withModifiers(it=>ve.handleSwitch(!0),["stop"]))},null,8,["class"])):E.createCommentVNode("",!0),E.createVNode(Ze,{class:"ivu-image-preview-arrow-close",type:"md-close",onClick:E.withModifiers(ve.handleClose,["stop"])},null,8,["onClick"])],16)],4)):E.createCommentVNode("",!0)]),_:1})],8,["disabled"])}var Ho=Y(B1,[["render",H1]]);const X1=K=>typeof HTMLElement=="object"&&K instanceof HTMLElement,q1={name:"Image",mixins:[Xn],components:{ImagePreview:Ho},emits:["on-load","on-error","on-switch","on-close","on-click"],props:{src:{type:String,default:""},alt:{type:String,default:""},preview:{type:Boolean,default:!1},referrerPolicy:{type:String,default:""},width:{type:[String,Number],default:""},height:{type:[String,Number],default:""},fit:{type:String,default:""},lazy:{type:Boolean,default:!1},scrollContainer:{type:[String],default:""},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array},infinite:{type:Boolean,default:!0},initialIndex:{type:Number,default:0},previewTip:{type:Boolean,default:!0},toolbar:{type:Array,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||!K.$VIEWUI.image||K.$VIEWUI.image.toolbar===""?["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]:K.$VIEWUI.image.toolbar}}},data(){return{loadingImage:!1,loading:!1,imageError:!1,scrollElement:null,observer:null,imagePreviewModal:!1}},watch:{src(){this.loadImage()}},computed:{innerClasses(){return["ivu-image-inner",{"ivu-image-cursor":this.preview}]},imgClasses(){return["ivu-image-img",{"ivu-image-img-hidden":this.loading||this.imageError}]},fitStyle(){const K=["fill","contain","cover","none","scale-down"],{fit:se}=this;return K.includes(se)?`object-fit:${se};`:""},imageStyles(){return{width:typeof this.width=="number"?`${this.width}px`:this.width,height:typeof this.height=="number"?`${this.height}px`:this.height}},loadingLang(){return this.t("i.select.loading")},failLang(){return this.t("i.image.fail")},previewLang(){return this.t("i.image.preview")},loadingType(){return this.lazy?"lazy":"eager"}},mounted(){W&&this.handleImageEvent()},methods:{handleLazy(){const K=this.$refs.image;(this.observer=new IntersectionObserver(this.handlerObserveImage,{root:this.scrollElement,rootMargin:"0px",threshold:0})).observe(K)},handlerObserveImage(K){for(let se of K)se.isIntersecting&&(this.offObserver(),this.loadImage())},addLazyImageListener(){const{scrollContainer:K}=this;this.scrollElement=null,X1(K)?this.scrollElement=K:K&&typeof K=="string"&&(this.scrollElement=document.querySelector(K)),this.handleLazy()},handleImageLoad(){this.loading=!1,this.imageError=!1,this.$emit("on-load")},handleImageError(){this.loading=!1,this.imageError=!0,this.loadingImage=!1,this.$emit("on-error")},loadImage(){this.loading=!0,this.imageError=!1,this.loadingImage=!0},handleImageEvent(){const{lazy:K}=this;K?this.addLazyImageListener():this.loadImage()},offObserver(){const{observer:K}=this;K&&K.disconnect()},handlePreview(){const{preview:K,initialIndex:se}=this;K&&(this.imagePreviewModal=!0,this.$emit("on-click",{initialIndex:se}))},handleClose(){this.$emit("on-close")},handleSwitch(K){this.$emit("on-switch",K)}},beforeUnmount(){this.offObserver()}},Q1={key:0,class:"ivu-image-placeholder"},Y1={key:1,class:"ivu-image-error"},K1=["alt","src","loading","referrerPolicy"],Z1={class:"ivu-image-mark"};function J1(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("ImagePreview");return E.openBlock(),E.createElementBlock("div",{class:"ivu-image",ref:"image",style:E.normalizeStyle(ve.imageStyles)},[Re.loading?(E.openBlock(),E.createElementBlock("div",Q1,[E.renderSlot(K.$slots,"placeholder",{},()=>[E.createElementVNode("span",null,E.toDisplayString(ve.loadingLang),1)])])):Re.imageError?(E.openBlock(),E.createElementBlock("div",Y1,[E.renderSlot(K.$slots,"error",{},()=>[E.createElementVNode("span",null,E.toDisplayString(ve.failLang),1)])])):E.createCommentVNode("",!0),Re.loadingImage?(E.openBlock(),E.createElementBlock("div",{key:2,class:E.normalizeClass(ve.innerClasses),onClick:se[2]||(se[2]=(...Xe)=>ve.handlePreview&&ve.handlePreview(...Xe))},[E.createElementVNode("img",{class:E.normalizeClass(ve.imgClasses),style:E.normalizeStyle([ve.fitStyle]),alt:me.alt,src:me.src,loading:ve.loadingType,referrerPolicy:me.referrerPolicy,onLoad:se[0]||(se[0]=(...Xe)=>ve.handleImageLoad&&ve.handleImageLoad(...Xe)),onError:se[1]||(se[1]=(...Xe)=>ve.handleImageError&&ve.handleImageError(...Xe))},null,46,K1),me.preview&&me.previewTip?E.renderSlot(K.$slots,"preview",{key:0},()=>[E.createElementVNode("div",Z1,[E.createElementVNode("span",null,E.toDisplayString(ve.previewLang),1)])]):E.createCommentVNode("",!0)],2)):E.createCommentVNode("",!0),me.preview?(E.openBlock(),E.createBlock(Fe,{key:3,modelValue:Re.imagePreviewModal,"onUpdate:modelValue":se[3]||(se[3]=Xe=>Re.imagePreviewModal=Xe),"preview-list":me.previewList,"initial-index":me.initialIndex,infinite:me.infinite,"mask-closable":me.maskClosable,transfer:me.transfer,toolbar:me.toolbar,onOnClose:ve.handleClose,onOnSwitch:ve.handleSwitch},null,8,["modelValue","preview-list","initial-index","infinite","mask-closable","transfer","toolbar","onOnClose","onOnSwitch"])):E.createCommentVNode("",!0)],4)}var uf=Y(q1,[["render",J1]]);Ho.newInstance=K=>{if(!W)return;const se=K||{};let me=null;const Be=E.createApp({data(){return Object.assign({},se,{visible:!1,previewList:[],initialIndex:0,toolbar:["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"],infinite:!0,maskClosable:!0,transfer:!0})},render(){return E.h(Ho,Object.assign({},se,{ref:"imagePreview",modelValue:this.visible,previewList:this.previewList,initialIndex:this.initialIndex,toolbar:this.toolbar,infinite:this.infinite,maskClosable:this.maskClosable,transfer:this.transfer,"onOn-close":this.close}))},methods:{close(){this.visible=!1,setTimeout(()=>{this.destroy(),this.onRemove()},300)},destroy(){Be.unmount(),document.body.removeChild(Re)},onRemove(){}},created(){me=E.getCurrentInstance()}}),Re=document.createElement("div");document.body.appendChild(Re),Be.mount(Re);const ve=me.refs.imagePreview;return{show(Fe){Object.keys(Fe).forEach(Xe=>{ve.$parent[Xe]=Fe[Xe]}),ve.$parent.visible=!0},component:ve}};let Gc;function ew(){return Gc=Gc||Ho.newInstance(),Gc}Ho.show=function(K={}){const se=ew();K.onRemove=function(){Gc=null},se.show(K)};const Ss="ivu-input-number",Xc="ivu-icon";function qc(K,se){let me,Be,Re;try{me=K.toString().split(".")[1].length}catch{me=0}try{Be=se.toString().split(".")[1].length}catch{Be=0}return Re=Math.pow(10,Math.max(me,Be)),(Math.round(K*Re)+Math.round(se*Re))/Re}const tw={name:"InputNumber",mixins:[In],emits:["on-change","on-focus","on-blur","update:modelValue"],props:{max:{type:Number,default:1/0},min:{type:Number,default:-1/0},step:{type:Number,default:1},activeChange:{type:Boolean,default:!0},modelValue:{type:Number,default:1},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},name:{type:String},precision:{type:Number},elementId:{type:String},formatter:{type:Function},parser:{type:Function},placeholder:{type:String,default:""},controlsOutside:{type:Boolean,default:!1}},data(){return{focused:!1,upDisabled:!1,downDisabled:!1,currentValue:this.modelValue}},computed:{wrapClasses(){return[`${Ss}`,{[`${Ss}-${this.size}`]:!!this.size,[`${Ss}-disabled`]:this.itemDisabled,[`${Ss}-focused`]:this.focused,[`${Ss}-controls-outside`]:this.controlsOutside}]},handlerClasses(){return`${Ss}-handler-wrap`},upClasses(){return[`${Ss}-handler`,`${Ss}-handler-up`,{[`${Ss}-handler-up-disabled`]:this.upDisabled}]},innerUpClasses(){return`${Ss}-handler-up-inner ${Xc} ${Xc}-ios-arrow-up`},downClasses(){return[`${Ss}-handler`,`${Ss}-handler-down`,{[`${Ss}-handler-down-disabled`]:this.downDisabled}]},innerDownClasses(){return`${Ss}-handler-down-inner ${Xc} ${Xc}-ios-arrow-down`},inputWrapClasses(){return`${Ss}-input-wrap`},inputClasses(){return`${Ss}-input`},precisionValue(){return this.currentValue?this.precision?this.currentValue.toFixed(this.precision):this.currentValue:this.currentValue},formatterValue(){return this.formatter&&this.precisionValue!==null?this.formatter(this.precisionValue):this.precisionValue}},methods:{preventDefault(K){K.preventDefault()},up(K){const se=Number(K.target.value);if(this.upDisabled&&isNaN(se))return!1;this.changeStep("up",K)},down(K){const se=Number(K.target.value);if(this.downDisabled&&isNaN(se))return!1;this.changeStep("down",K)},changeStep(K,se){if(this.itemDisabled||this.readonly)return!1;const me=Number(se.target.value);let Be=Number(this.currentValue);const Re=Number(this.step);if(isNaN(Be))return!1;if(!isNaN(me)){if(K==="up")if(qc(me,Re)<=this.max)Be=me;else return!1;else if(K==="down")if(qc(me,-Re)>=this.min)Be=me;else return!1}K==="up"?Be=qc(Be,Re):K==="down"&&(Be=qc(Be,-Re)),this.setValue(Be)},setValue(K){K&&!isNaN(this.precision)&&(K=Number(Number(K).toFixed(this.precision)));const{min:se,max:me}=this;K!==null&&(K>me?K=me:K<se&&(K=se)),E.nextTick(()=>{this.currentValue=K,this.$emit("update:modelValue",K),this.$emit("on-change",K),this.handleFormItemChange("change",K)})},focus(K){this.focused=!0,this.$emit("on-focus",K)},blur(){this.focused=!1,this.$emit("on-blur"),Je(this,["DatePicker","TimePicker","Cascader","Search"])||this.handleFormItemChange("blur",this.currentValue)},keyDown(K){K.keyCode===38?(K.preventDefault(),this.up(K)):K.keyCode===40&&(K.preventDefault(),this.down(K))},change(K){if(K.type==="change"&&this.activeChange||K.type==="input"&&!this.activeChange)return;let se=K.target.value.trim();if(this.parser&&(se=this.parser(se)),se.length===0){this.setValue(null);return}K.type==="input"&&se.match(/^\-?\.?$|\.$/)||(se=Number(se),isNaN(se)?K.target.value=this.currentValue:(this.currentValue=se,this.setValue(se)))},changeVal(K){if(K=Number(K),isNaN(K))this.upDisabled=!0,this.downDisabled=!0;else{const se=this.step;this.upDisabled=K+se>this.max,this.downDisabled=K-se<this.min}}},mounted(){this.changeVal(this.currentValue)},watch:{modelValue(K){this.currentValue=K},currentValue(K){this.changeVal(K)},min(){this.changeVal(this.currentValue)},max(){this.changeVal(this.currentValue)}}},rw=[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-remove"},null,-1)],iw=[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-add"},null,-1)],nw=["id","disabled","autofocus","readonly","name","value","placeholder"];function sw(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[me.controlsOutside?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.handlerClasses)},[E.createElementVNode("a",{onClick:se[1]||(se[1]=(...Fe)=>ve.up&&ve.up(...Fe)),class:E.normalizeClass(ve.upClasses)},[E.createElementVNode("span",{class:E.normalizeClass(ve.innerUpClasses),onClick:se[0]||(se[0]=(...Fe)=>ve.preventDefault&&ve.preventDefault(...Fe))},null,2)],2),E.createElementVNode("a",{onClick:se[3]||(se[3]=(...Fe)=>ve.down&&ve.down(...Fe)),class:E.normalizeClass(ve.downClasses)},[E.createElementVNode("span",{class:E.normalizeClass(ve.innerDownClasses),onClick:se[2]||(se[2]=(...Fe)=>ve.preventDefault&&ve.preventDefault(...Fe))},null,2)],2)],2)),me.controlsOutside?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass(["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-down",{"ivu-input-number-controls-outside-btn-disabled":Re.downDisabled}]),onClick:se[4]||(se[4]=(...Fe)=>ve.down&&ve.down(...Fe))},rw,2)):E.createCommentVNode("",!0),me.controlsOutside?(E.openBlock(),E.createElementBlock("div",{key:2,class:E.normalizeClass(["ivu-input-number-controls-outside-btn ivu-input-number-controls-outside-up",{"ivu-input-number-controls-outside-btn-disabled":Re.upDisabled}]),onClick:se[5]||(se[5]=(...Fe)=>ve.up&&ve.up(...Fe))},iw,2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass(ve.inputWrapClasses)},[E.createElementVNode("input",{id:me.elementId,class:E.normalizeClass(ve.inputClasses),disabled:K.itemDisabled,autocomplete:"off",spellcheck:"false",autofocus:me.autofocus,onFocus:se[6]||(se[6]=(...Fe)=>ve.focus&&ve.focus(...Fe)),onBlur:se[7]||(se[7]=(...Fe)=>ve.blur&&ve.blur(...Fe)),onKeydown:se[8]||(se[8]=E.withModifiers((...Fe)=>ve.keyDown&&ve.keyDown(...Fe),["stop"])),onInput:se[9]||(se[9]=(...Fe)=>ve.change&&ve.change(...Fe)),onMouseup:se[10]||(se[10]=(...Fe)=>ve.preventDefault&&ve.preventDefault(...Fe)),onChange:se[11]||(se[11]=(...Fe)=>ve.change&&ve.change(...Fe)),readonly:me.readonly||!me.editable,name:me.name,value:ve.formatterValue,placeholder:me.placeholder},null,42,nw)],2)],2)}var ch=Y(tw,[["render",sw]]);const hf="ivu-layout",ow={name:"Layout",data(){return{hasSider:!1}},computed:{wrapClasses(){return[`${hf}`,{[`${hf}-has-sider`]:this.hasSider}]}},methods:{findSider(){return this.$slots.default().some(K=>K.type.name==="Sider")}},mounted(){this.hasSider=this.findSider()}};function aw(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[E.renderSlot(K.$slots,"default")],2)}var df=Y(ow,[["render",aw]]);const pf={tooltips:["",""],showTip:!1,successTip:"",errorTip:""},ff={tooltip:"",editing:!1,maxlength:"",autosize:!0,triggerType:"icon"},mf={rows:1,tooltip:!1,suffix:!1,expandable:!1,symbol:""};var El={emits:["update:modelValue"],mixins:[Br],props:{type:{validator(K){return Ie(K,["secondary","success","warning","danger",""])},default:""},copyable:{type:Boolean,default:!1},copyText:{type:String,default:""},copyConfig:{type:Object,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.typography.copyConfig===""?pf:K.$VIEWUI.typography.copyConfig}},editable:{type:Boolean,default:!1},editConfig:{type:Object,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.typography.editConfig===""?ff:K.$VIEWUI.typography.editConfig}},ellipsis:{type:Boolean,default:!1},ellipsisConfig:{type:Object,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.typography.ellipsisConfig===""?mf:K.$VIEWUI.typography.ellipsisConfig}},disabled:{type:Boolean,default:!1},code:{type:Boolean,default:!1},delete:{type:Boolean,default:!1},keyboard:{type:Boolean,default:!1},mark:{type:Boolean,default:!1},strong:{type:Boolean,default:!1},underline:{type:Boolean,default:!1},italic:{type:Boolean,default:!1},modelValue:{type:String,default:""},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},theme:{validator(K){return Ie(K,["dark","light"])},default:"dark"},maxWidth:{type:[String,Number],default:250},placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"}},computed:{isHrefPattern(){const{to:K}=this;return!!K},linkProps(){if(this.isHrefPattern){const{linkUrl:K,target:se}=this;return{href:K,target:se}}else return{}},mergedCopyConfig(){return Object.assign({},pf,this.copyConfig)},mergedEditConfig(){return Object.assign({},ff,this.editConfig)},mergedEllipsisConfig(){return Object.assign({},mf,this.ellipsisConfig)}},methods:{commonSlots(){const K={};return this.$slots.default&&(K.default=()=>this.$slots.default()),this.$slots.copyIcon&&(K.copyIcon=se=>this.$slots.copyIcon(se)),this.$slots.editIcon&&(K.editIcon=se=>this.$slots.editIcon(se)),this.$slots.enterIcon&&(K.enterIcon=se=>this.$slots.enterIcon(se)),K},commonEvents(){return{"onUpdate:modelValue":this.handleOnUpdateModelValue}},handleOnUpdateModelValue(K){this.$emit("update:modelValue",K)}}};const Yc={name:"TypographyBase",mixins:[El],emits:["on-copy-success","on-copy-error","on-edit-start","on-edit-end","on-edit-change","on-edit-cancel"],props:{component:{type:String,default:"div"},level:{type:Number,default:0}},data(){return{currentContent:this.modelValue,copied:!1,copyTimeout:null,editing:!1,editContent:"",lastKeyCode:"",isEditESC:!1,ellipsisText:"",ellipsisContent:"",isEllipsis:!1,ellipsisExpanded:!1,observer:null}},created(){this.editing=this.mergedEditConfig.editing||!1,this.editing&&(this.editContent=this.currentContent?this.currentContent:this.handleGetContent())},watch:{modelValue(K){this.currentContent=K},editing(K){K||E.nextTick(()=>{this.handleRemoveObserver(),this.handleCreateObserver()})},isEllipsis(){E.nextTick(()=>{this.handleRemoveObserver(),this.handleCreateObserver()})},ellipsis:{handler(K){K?E.nextTick(()=>{this.handleUpdateEllipsisStatus(),this.handleCreateObserver()}):this.handleRemoveObserver()},immediate:!0}},computed:{classes(){return["ivu-typography",{[`ivu-typography-${this.type}`]:this.type,"ivu-typography-disabled":this.disabled,"ivu-typography-ellipsis-line-clamp":this.ellipsis&&!this.ellipsisExpanded,"ivu-typography-ellipsis-single-line":this.ellipsis&&!this.ellipsisExpanded&&this.mergedEllipsisConfig.rows===1}]}},methods:{wrapperDecorations(){let K=this.currentContent?this.currentContent:this.$slots.default?this.$slots.default():"";function se(me,Be){!me||(K=E.h(Be,K))}return se(this.strong,"strong"),se(this.underline,"u"),se(this.delete,"del"),se(this.code,"code"),se(this.mark,"mark"),se(this.keyboard,"kbd"),se(this.italic,"i"),K},handleClickContent(K){if(!this.isHrefPattern&&this.component!=="a"){const se=this.mergedEditConfig.triggerType;this.editable&&(se==="text"||se==="both")&&this.handleEdit()}else{const se=K.ctrlKey||K.metaKey;this.handleCheckClick(K,se)}},handleGetContent(){const K=document.createElement("div");document.body.appendChild(K);let se=null,me=null,Be="";const Re=this.wrapperDecorations();return se=E.createApp({render(){return E.h("div",{ref:"text",style:{display:"none"}},Re)},created(){me=E.getCurrentInstance()}}),se.mount(K),Be=me.refs.text.innerText,se.unmount(),document.body.removeChild(K),Be},handleCopy(){let K="";this.copyText?K=this.copyText:this.currentContent?K=this.currentContent:this.$slots.default&&(K=this.handleGetContent()),lc({text:this.copyText?this.copyText:K,showTip:this.mergedCopyConfig.showTip,successTip:this.mergedCopyConfig.successTip,errorTip:this.mergedCopyConfig.errorTip,success:()=>{this.$emit("on-copy-success"),this.copied=!0,this.copyTimeout&&clearTimeout(this.copyTimeout),this.copyTimeout=setTimeout(()=>{this.copied=!1},3e3)},error:()=>{this.$emit("on-copy-error")}})},handleEdit(){this.editContent=this.currentContent?this.currentContent:this.handleGetContent(),E.nextTick(()=>{this.editing=!0,this.$emit("on-edit-start"),E.nextTick(()=>{this.$refs.edit.focus({cursor:"end"})})})},handleEditBlur(){if(this.isEditESC){this.isEditESC=!1;return}this.handleEditSave(),this.$emit("on-edit-end",this.editContent)},handleEditChange(K){const se=K.target.value;this.editContent=se,this.$emit("on-edit-change",se)},handleEditSave(){this.$emit("update:modelValue",this.editContent),this.editing=!1},handleEditKeydown(K){const{keyCode:se}=K;se===dn.ENTER&&K.preventDefault(),this.lastKeyCode=se},handleEditKeyup(K){const{keyCode:se,ctrlKey:me,altKey:Be,metaKey:Re,shiftKey:ve}=K;this.lastKeyCode===se&&!me&&!Be&&!Re&&!ve&&(se===dn.ENTER?(this.handleEditSave(),this.$emit("on-edit-end",this.editContent)):se===dn.ESC&&(this.isEditESC=!0,this.$emit("on-edit-cancel"),this.editing=!1))},handleUpdateEllipsisStatus(){if(this.ellipsis&&!this.ellipsisExpanded){const K=this.$refs.typography;this.isEllipsis=K.scrollHeight>K.clientHeight}else this.isEllipsis=!1},handleCreateObserver(){this.ellipsis&&!this.ellipsisExpanded&&(this.observer=Na(),this.observer.listenTo(this.$refs.typography,this.handleUpdateEllipsisStatus))},handleRemoveObserver(){this.observer&&(this.observer.removeListener(this.$refs.typography,this.handleUpdateEllipsisStatus),this.observer=null)}},render(){let K=[];const se=this.wrapperDecorations();if(K.push(se),this.editable){const me=this.mergedEditConfig.triggerType;if(me==="icon"||me==="both"){const Be=this.$slots.editIcon?this.$slots.editIcon():E.h(Ae,{type:"md-create"}),Re=E.h("div",{class:"ivu-typography-edit",onClick:this.handleEdit},Be);if(this.mergedEditConfig.tooltip){const ve=E.h(To,{content:this.mergedEditConfig.tooltip,placement:"top"},()=>Re);K.push(ve)}else K.push(Re)}}if(this.copyable){const me=this.$slots.copyIcon?this.$slots.copyIcon({copied:this.copied}):E.h(Ae,{type:this.copied?"md-checkmark":"md-copy"}),Be=E.h("div",{class:["ivu-typography-copy",{"ivu-typography-copy-success":this.copied}],onClick:this.handleCopy},me);if(this.mergedCopyConfig.tooltips instanceof Array&&this.mergedCopyConfig.tooltips.length===2){const Re=E.h(To,{content:this.copied?this.mergedCopyConfig.tooltips[1]:this.mergedCopyConfig.tooltips[0],placement:"top"},()=>Be);K.push(Re)}else K.push(Be)}if(this.editing){const me=E.h(Js,{ref:"edit",modelValue:this.editContent,type:"textarea",autosize:this.mergedEditConfig.autosize,maxlength:this.mergedEditConfig.maxlength,"onOn-blur":this.handleEditBlur,"onOn-keydown":this.handleEditKeydown,"onOn-keyup":this.handleEditKeyup,"onOn-change":this.handleEditChange}),Be=this.$slots.enterIcon?this.$slots.enterIcon():E.h(Ae,{type:"md-return-left"}),Re=E.h("span",{class:"ivu-typography-edit-content-confirm"},Be);return E.h("div",{class:["ivu-typography","ivu-typography-edit-content",{[`ivu-typography-h${this.level}`]:this.level,"ivu-typography-div":!this.level}]},[me,Re])}else{const me={};this.ellipsis&&!this.ellipsisExpanded&&(me["-webkit-line-clamp"]=this.mergedEllipsisConfig.rows);const Re=E.h(this.component,{ref:"typography",class:this.classes,...this.linkProps,style:me,onClick:this.handleClickContent},[K,null]);return this.ellipsis&&!this.ellipsisExpanded&&this.isEllipsis&&this.mergedEllipsisConfig.tooltip?E.h(To,{content:this.mergedEllipsisConfig.tooltip===!0?this.handleGetContent():this.mergedEllipsisConfig.tooltip,placement:this.placement,transfer:this.transfer,theme:this.theme,maxWidth:this.maxWidth},()=>Re):Re}},beforeUnmount(){this.handleRemoveObserver()}},gf={name:"Link",mixins:[El],render(){return E.h(Yc,{...this.$props,component:"a",...this.commonEvents()},this.commonSlots())}};function yf(){return Ai(),ti}let _f=yf();Xs.newInstance=K=>{if(!W)return;const se=K||{};let me=null;const Be=E.createApp({data(){return Object.assign({},se,{})},render(){let Fe="";return this.render?Fe=E.h(Xs,{fix:!0,fullscreen:!0,ref:"spin"},[this.render(E.h)]):Fe=E.h(Xs,{size:"large",fix:!0,fullscreen:!0,ref:"spin"}),E.h("div",{class:"ivu-spin-fullscreen ivu-spin-fullscreen-wrapper",style:{"z-index":2010+_f}},[Fe])},created(){me=E.getCurrentInstance()}}),Re=document.createElement("div");document.body.appendChild(Re),Be.mount(Re);const ve=me.refs.spin;return{show(){E.nextTick(()=>{me.refs.spin.visible=!0,_f=yf()})},remove(Fe){ve.visible=!1,setTimeout(function(){Be.unmount(),document.body.removeChild(Re),Fe()},500)},component:ve}};let Al;function vf(K=void 0){return Al=Al||Xs.newInstance({render:K}),Al}function lw(K){const se="render"in K?K.render:void 0;vf(se).show(K)}Xs.show=function(K={}){return lw(K)},Xs.hide=function(){if(!Al)return!1;vf().remove(()=>{Al=null})};const Ml="ivu-list",cw={name:"List",provide(){return{ListInstance:this}},components:{Spin:Xs},props:{border:{type:Boolean,default:!1},itemLayout:{validator(K){return Ie(K,["horizontal","vertical"])},default:"horizontal"},header:{type:String,default:""},footer:{type:String,default:""},loading:{type:Boolean,default:!1},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},split:{type:Boolean,default:!0}},data(){return{}},computed:{classes(){return[`${Ml}`,`${Ml}-${this.size}`,`${Ml}-${this.itemLayout}`,{[`${Ml}-bordered`]:this.border,[`${Ml}-split`]:this.split}]}},methods:{}},uw={key:0,class:"ivu-list-header"},hw={class:"ivu-list-container"},dw={class:"ivu-list-items"},pw={key:2,class:"ivu-list-footer"};function fw(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Spin");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[me.header||K.$slots.header?(E.openBlock(),E.createElementBlock("div",uw,[E.renderSlot(K.$slots,"header",{},()=>[E.createTextVNode(E.toDisplayString(me.header),1)])])):E.createCommentVNode("",!0),E.createElementVNode("div",hw,[E.createElementVNode("ul",dw,[E.renderSlot(K.$slots,"default")])]),me.loading?(E.openBlock(),E.createBlock(Fe,{key:1,fix:"",size:"large"},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"spin")]),_:3})):E.createCommentVNode("",!0),me.footer||K.$slots.footer?(E.openBlock(),E.createElementBlock("div",pw,[E.renderSlot(K.$slots,"footer",{},()=>[E.createTextVNode(E.toDisplayString(me.footer),1)])])):E.createCommentVNode("",!0)],2)}var bf=Y(cw,[["render",fw]]);const mw={name:"ListItem",inject:["ListInstance"],props:{},computed:{itemLayout(){return this.ListInstance.itemLayout},isItemContainsTextNode(){let K;return this.$slots.default().forEach(se=>{typeof se=="string"&&(K=!0)}),K},isFlexMode(){const K=this.$slots.extra;return this.itemLayout==="vertical"?!!K:!this.isItemContainsTextNode},classes(){return[{"ivu-list-item-no-flex":!this.isFlexMode}]}}},gw={class:"ivu-list-item-main"},yw={key:0,class:"ivu-list-item-action"},_w={class:"ivu-list-item-extra"},vw={key:0,class:"ivu-list-item-action"},bw={class:"ivu-list-item-extra"};function xw(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(["ivu-list-item",ve.classes])},[ve.itemLayout==="vertical"&&K.$slots.extra?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createElementVNode("div",gw,[E.renderSlot(K.$slots,"default"),K.$slots.action?(E.openBlock(),E.createElementBlock("ul",yw,[E.renderSlot(K.$slots,"action")])):E.createCommentVNode("",!0)]),E.createElementVNode("div",_w,[E.renderSlot(K.$slots,"extra")])],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.renderSlot(K.$slots,"default"),K.$slots.action?(E.openBlock(),E.createElementBlock("ul",vw,[E.renderSlot(K.$slots,"action")])):E.createCommentVNode("",!0),E.createElementVNode("div",bw,[E.renderSlot(K.$slots,"extra")])],64))],2)}var Sf=Y(mw,[["render",xw]]);const Sw={name:"ListItemMeta",components:{Avatar:rl},props:{avatar:{type:String,default:""},title:{type:String,default:""},description:{type:String,default:""}}},ww={class:"ivu-list-item-meta"},Ow={key:0,class:"ivu-list-item-meta-avatar"},Cw={class:"ivu-list-item-meta-content"},Tw={key:0,class:"ivu-list-item-meta-title"},Ew={key:1,class:"ivu-list-item-meta-description"};function Aw(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Avatar");return E.openBlock(),E.createElementBlock("div",ww,[me.avatar||K.$slots.avatar?(E.openBlock(),E.createElementBlock("div",Ow,[E.renderSlot(K.$slots,"avatar",{},()=>[E.createVNode(Fe,{src:me.avatar},null,8,["src"])])])):E.createCommentVNode("",!0),E.createElementVNode("div",Cw,[me.title||K.$slots.title?(E.openBlock(),E.createElementBlock("div",Tw,[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])])):E.createCommentVNode("",!0),me.description||K.$slots.description?(E.openBlock(),E.createElementBlock("div",Ew,[E.renderSlot(K.$slots,"description",{},()=>[E.createTextVNode(E.toDisplayString(me.description),1)])])):E.createCommentVNode("",!0)])])}var wf=Y(Sw,[["render",Aw]]);const Kc="ivu-loading-bar",Mw={name:"LoadingBar",props:{color:{type:String,default:"primary"},failedColor:{type:String,default:"error"},height:{type:Number,default:2}},data(){return{percent:0,status:"success",show:!1}},computed:{classes(){return`${Kc}`},innerClasses(){return[`${Kc}-inner`,{[`${Kc}-inner-color-primary`]:this.color==="primary"&&this.status==="success",[`${Kc}-inner-failed-color-error`]:this.failedColor==="error"&&this.status==="error"}]},outerStyles(){return{height:`${this.height}px`}},styles(){let K={width:`${this.percent}%`,height:`${this.height}px`};return this.color!=="primary"&&this.status==="success"&&(K.backgroundColor=this.color),this.failedColor!=="error"&&this.status==="error"&&(K.backgroundColor=this.failedColor),K}}};function Pw(K,se,me,Be,Re,ve){return E.openBlock(),E.createBlock(E.Transition,{name:"fade"},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.outerStyles)},[E.createElementVNode("div",{class:E.normalizeClass(ve.innerClasses),style:E.normalizeStyle(ve.styles)},null,6)],6),[[E.vShow,Re.show]])]),_:1})}var uh=Y(Mw,[["render",Pw]]);uh.newInstance=K=>{if(!W)return;const se=K||{};let me=null;const Be=E.createApp({data(){return se},render(){return E.h(uh,Object.assign({ref:"loadingBar"},se))},created(){me=E.getCurrentInstance()}}),Re=document.createElement("div");document.body.appendChild(Re),Be.mount(Re);const ve=me.refs.loadingBar;return{update(Fe){"percent"in Fe&&(ve.percent=Fe.percent),Fe.status&&(ve.status=Fe.status),"show"in Fe&&(ve.show=Fe.show)},component:ve,destroy(){Be.unmount(),document.body.removeChild(Re)}}};let Zc,Of="primary",Cf=800,Tf="error",Ef=2,Pl;function Af(){return Zc=Zc||uh.newInstance({color:Of,failedColor:Tf,height:Ef}),Zc}function pa(K){Af().update(K)}function Pf(){setTimeout(()=>{pa({show:!1}),setTimeout(()=>{pa({percent:0})},200)},Cf)}function Rl(){Pl&&(clearInterval(Pl),Pl=null)}var hh={start(){if(Pl)return;let K=0;pa({percent:K,status:"success",show:!0}),Pl=setInterval(()=>{K+=Math.floor(Math.random()*3+1),K>95&&Rl(),pa({percent:K,status:"success",show:!0})},200)},update(K){Rl(),pa({percent:K,status:"success",show:!0})},finish(){Rl(),pa({percent:100,status:"success",show:!0}),Pf()},error(){Rl(),pa({percent:100,status:"error",show:!0}),Pf()},config(K){K.color&&(Of=K.color),K.duration&&(Cf=K.duration),K.failedColor&&(Tf=K.failedColor),K.height&&(Ef=K.height)},destroy(){Rl();let K=Af();Zc=null,K.destroy()}};const Rw={name:"Login",components:{Form:vc},emits:["on-submit"],provide(){return{LoginInstance:this}},props:{},data(){return{formValidate:{}}},methods:{handleSubmit(){this.$refs.form.validate(K=>{this.$emit("on-submit",K,JSON.parse(JSON.stringify(this.formValidate)))})},handleValidate(K,se){let me=!0;K.forEach(Be=>{this.$refs.form.validateField(Be,Re=>{Re&&(me=!1)})}),se(me)}}},kw={class:"ivu-login"};function Iw(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Form");return E.openBlock(),E.createElementBlock("div",kw,[E.createVNode(Fe,{ref:"form",model:Re.formValidate,onSubmit:se[0]||(se[0]=E.withModifiers(()=>{},["prevent"]))},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"default")]),_:3},8,["model"])])}var Rf=Y(Rw,[["render",Iw]]);const dh="ivu-menu",Bw={name:"Menu",emits:["on-select","on-open-change"],provide(){return{MenuInstance:this}},props:{mode:{validator(K){return Ie(K,["horizontal","vertical"])},default:"vertical"},theme:{validator(K){return Ie(K,["light","dark","primary"])},default:"light"},activeName:{type:[String,Number]},openNames:{type:Array,default(){return[]}},accordion:{type:Boolean,default:!1},width:{type:String,default:"240px"}},data(){return{currentActiveName:this.activeName,openedNames:[],submenuList:[],menuItemList:[],ready:!1}},computed:{classes(){let K=this.theme;return this.mode==="vertical"&&this.theme==="primary"&&(K="light"),[`${dh}`,`${dh}-${K}`,{[`${dh}-${this.mode}`]:this.mode}]},styles(){let K={};return this.mode==="vertical"&&(K.width=this.width),K}},methods:{updateActiveName(){this.currentActiveName===void 0&&(this.currentActiveName=-1),this.submenuList.map(K=>K.submenu).forEach(K=>{K.handleUpdateActiveName(!1)}),this.menuItemList.map(K=>K.menuitem).forEach(K=>{K.handleUpdateActiveName(this.currentActiveName)})},updateOpenKeys(K){const se=[...this.openedNames].indexOf(K),me=this.submenuList.map(Re=>Re.submenu);if(this.accordion&&me.forEach(Re=>{Re.opened=!1}),se>=0){let Re=null;me.forEach(ve=>{ve.name===K&&(Re=ve,ve.opened=!1)}),pt(Re,"Submenu").forEach(ve=>{ve.opened=!0}),Re.childSubmenuList.map(ve=>ve.submenu).forEach(ve=>{ve.opened=!1})}else if(this.accordion){let Re=null;me.forEach(ve=>{ve.name===K&&(Re=ve,ve.opened=!0)}),pt(Re,"Submenu").forEach(ve=>{ve.opened=!0})}else this.submenuList.map(Re=>Re.submenu).forEach(Re=>{Re.name===K&&(Re.opened=!0)});let Be=me.filter(Re=>Re.opened).map(Re=>Re.name);this.openedNames=[...Be],this.$emit("on-open-change",Be)},updateOpened(){const K=(this.submenuList||[]).map(se=>se.submenu);K.length&&K.forEach(se=>{this.openedNames.indexOf(se.name)>-1?se.opened=!0:se.opened=!1})},handleEmitSelectEvent(K){this.$emit("on-select",K)},handleMenuItemSelect(K){this.currentActiveName=K,this.$emit("on-select",K)}},mounted(){this.openedNames=[...this.openNames],this.updateOpened(),E.nextTick(()=>{this.updateActiveName(),this.ready=!0})},watch:{openNames(K){this.openedNames=K},activeName(K){this.currentActiveName=K},currentActiveName(){this.updateActiveName()}}};function Vw(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("ul",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.styles)},[E.renderSlot(K.$slots,"default")],6)}var ph=Y(Bw,[["render",Vw]]),fh={inject:{MenuInstance:{default:null},SubmenuInstance:{default:null}},data(){return{menu:this.MenuInstance}},computed:{hasParentSubmenu(){return!!this.SubmenuInstance},parentSubmenuNum(){return pt(this,"Submenu").length},mode(){return this.MenuInstance.mode}}};const Dw="ivu-menu",Nw={name:"MenuGroup",mixins:[fh],props:{title:{type:String,default:""}},data(){return{prefixCls:Dw}},computed:{groupStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*28+"px"}:{}}}};function $w(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass([Re.prefixCls+"-item-group"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-item-group-title"]),style:E.normalizeStyle(ve.groupStyle)},E.toDisplayString(me.title),7),E.createElementVNode("ul",null,[E.renderSlot(K.$slots,"default")])],2)}var kf=Y(Nw,[["render",$w]]);const Jc="ivu-menu",Lw={name:"MenuItem",mixins:[fh,Br],props:{name:{type:[String,Number],required:!0},disabled:{type:Boolean,default:!1}},data(){return{active:!1,id:gt(6)}},computed:{classes(){return[`${Jc}-item`,{[`${Jc}-item-active`]:this.active,[`${Jc}-item-selected`]:this.active,[`${Jc}-item-disabled`]:this.disabled}]},itemStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*24+"px"}:{}}},methods:{handleClickItem(K,se=!1){if(!this.disabled)if(se||this.target==="_blank"){this.handleCheckClick(K,se);let me=Je(this,"Menu");me&&me.handleEmitSelectEvent(this.name)}else Je(this,"Submenu")?this.SubmenuInstance.handleMenuItemSelect(this.name):this.MenuInstance.handleMenuItemSelect(this.name),this.handleCheckClick(K,se)},handleUpdateActiveName(K){this.name===K?(this.active=!0,this.SubmenuInstance&&this.SubmenuInstance.handleUpdateActiveName(K)):this.active=!1},addMenuItem(){const K=this.MenuInstance;K.menuItemList||(K.menuItemList=[]),K.menuItemList.push({id:this.id,menuitem:this})},removeMenuItem(){const K=this.MenuInstance;if(K.menuItemList&&K.menuItemList.length){const se=K.menuItemList.findIndex(me=>me.id===this.id);K.menuItemList.splice(se,1)}}},mounted(){this.addMenuItem()},beforeUnmount(){this.removeMenuItem()}},Fw=["href","target"];function Uw(K,se,me,Be,Re,ve){return K.to?(E.openBlock(),E.createElementBlock("a",{key:0,href:K.linkUrl,target:K.target,class:E.normalizeClass(ve.classes),onClick:[se[0]||(se[0]=E.withModifiers(Fe=>ve.handleClickItem(Fe,!1),["exact"])),se[1]||(se[1]=E.withModifiers(Fe=>ve.handleClickItem(Fe,!0),["ctrl"])),se[2]||(se[2]=E.withModifiers(Fe=>ve.handleClickItem(Fe,!0),["meta"]))],style:E.normalizeStyle(ve.itemStyle)},[E.renderSlot(K.$slots,"default")],14,Fw)):(E.openBlock(),E.createElementBlock("li",{key:1,class:E.normalizeClass(ve.classes),onClick:se[3]||(se[3]=E.withModifiers((...Fe)=>ve.handleClickItem&&ve.handleClickItem(...Fe),["stop"])),style:E.normalizeStyle(ve.itemStyle)},[E.renderSlot(K.$slots,"default")],6))}var If=Y(Lw,[["render",Uw]]);const Bf={name:"Mobile",mixins:[hl],data(){return{className:"ivu-login-mobile",prefix:"ios-phone-portrait",placeholder:"",type:"text"}},props:{rules:{type:[Object,Array],default(){return[{required:!0,message:Nu.Mobile,trigger:"change"},{pattern:/^1\d{10}$/,message:"",trigger:"change"}]}}}},Ds="ivu-modal",Vf={x:null,y:null,dragX:null,dragY:null,dragging:!1,rect:null},zw={inheritAttrs:!1,name:"Modal",mixins:[Xn,rh],components:{Icon:Ae,iButton:As},emits:["on-cancel","on-ok","on-hidden","on-visible-change","update:modelValue"],provide(){return{ModalInstance:this}},props:{modelValue:{type:Boolean,default:!1},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.modal.maskClosable===""?!0:K.$VIEWUI.modal.maskClosable}},title:{type:String},width:{type:[Number,String],default:520},okText:{type:String},cancelText:{type:String},loading:{type:Boolean,default:!1},styles:{type:Object,default(){return{}}},className:{type:String},footerHide:{type:Boolean,default:!1},scrollable:{type:Boolean,default:!1},transitionNames:{type:Array,default(){return["ease","fade"]}},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!0:K.$VIEWUI.transfer}},fullscreen:{type:Boolean,default:!1},mask:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},sticky:{type:Boolean,default:!1},stickyDistance:{type:Number,default:10},resetDragPosition:{type:Boolean,default:!1},zIndex:{type:Number,default:1e3},beforeClose:Function,render:Function},data(){return{prefixCls:Ds,wrapShow:!1,showHead:!0,buttonLoading:!1,visible:this.modelValue,dragData:Qe(Vf),modalIndex:this.handleGetModalIndex(),isMouseTriggerIn:!1,id:gt(6),tableList:[],sliderList:[]}},computed:{wrapClasses(){return[`${Ds}-wrap`,{[`${Ds}-hidden`]:!this.wrapShow,[`${this.className}`]:!!this.className,[`${Ds}-no-mask`]:!this.showMask}]},wrapStyles(){return{zIndex:this.modalIndex+this.zIndex}},maskClasses(){return`${Ds}-mask`},classes(){return[`${Ds}`,{[`${Ds}-fullscreen`]:this.fullscreen,[`${Ds}-fullscreen-no-header`]:this.fullscreen&&!this.showHead,[`${Ds}-fullscreen-no-footer`]:this.fullscreen&&this.footerHide}]},contentClasses(){return[`${Ds}-content`,{[`${Ds}-content-no-mask`]:!this.showMask,[`${Ds}-content-drag`]:this.draggable&&!this.fullscreen,[`${Ds}-content-dragging`]:this.draggable&&this.dragData.dragging}]},mainStyles(){let K={};const se=parseInt(this.width),me=this.dragData.x!==null?{top:0}:{width:se<=100?`${se}%`:`${se}px`},Be=this.styles?this.styles:{};return Object.assign(K,me,Be),K},contentStyles(){let K={};if(this.draggable&&!this.fullscreen){const se=this.styles.top?parseFloat(this.styles.top):0,me=this.styles.left?parseFloat(this.styles.left):0;this.dragData.x!==null&&(K.left=`${this.dragData.x-me}px`),this.dragData.y!==null&&(K.top=`${this.dragData.y}px`),this.dragData.y!==null&&(K.top=`${this.dragData.y-se}px`);const Be=parseInt(this.width),Re={width:Be<=100?`${Be}%`:`${Be}px`};Object.assign(K,Re)}return K},localeOkText(){return this.okText===void 0?this.t("i.modal.okText"):this.okText},localeCancelText(){return this.cancelText===void 0?this.t("i.modal.cancelText"):this.cancelText},showMask(){return this.mask}},methods:{close(){if(!this.beforeClose)return this.handleClose();const K=this.beforeClose();K&&K.then?K.then(()=>{this.handleClose()}):this.handleClose()},handleClose(){this.visible=!1,this.$emit("update:modelValue",!1),this.$emit("on-cancel")},handleMask(){this.maskClosable&&this.showMask&&this.close()},handleWrapClick(K){if(this.isMouseTriggerIn){this.isMouseTriggerIn=!1;return}const se=K.target.getAttribute("class");se&&se.indexOf(`${Ds}-wrap`)>-1&&this.handleMask()},handleMousedown(){this.isMouseTriggerIn=!0},cancel(){this.close()},ok(){this.loading?this.buttonLoading=!0:(this.visible=!1,this.$emit("update:modelValue",!1)),this.$emit("on-ok")},EscClose(K){if(this.visible&&this.closable&&K.keyCode===27){const se=this.$root.modalList.map(me=>me.modal).filter(me=>me.$data.visible&&me.$props.closable).sort((me,Be)=>me.$data.modalIndex<Be.$data.modalIndex?1:-1)[0];setTimeout(()=>{se.close()},0)}},animationFinish(){this.$emit("on-hidden")},handleMoveStart(K){if(!this.draggable||this.fullscreen)return!1;const se=this.$refs.content.getBoundingClientRect();this.dragData.rect=se,this.dragData.x=se.x||se.left,this.dragData.y=se.y||se.top;const me={x:K.clientX,y:K.clientY};this.dragData.dragX=me.x,this.dragData.dragY=me.y,this.dragData.dragging=!0,X(window,"mousemove",this.handleMoveMove),X(window,"mouseup",this.handleMoveEnd)},handleMoveMove(K){if(!this.dragData.dragging||this.fullscreen)return!1;const se={x:K.clientX,y:K.clientY},me={x:se.x-this.dragData.dragX,y:se.y-this.dragData.dragY};if(W&&this.sticky){const Be=document.documentElement.clientWidth,Re=document.documentElement.clientHeight;this.dragData.x+me.x<=this.stickyDistance&&me.x<0?this.dragData.x=0:this.dragData.x+this.dragData.rect.width-Be>-this.stickyDistance&&me.x>0?this.dragData.x=Be-this.dragData.rect.width:this.dragData.x+=me.x,this.dragData.y+me.y<=this.stickyDistance&&me.y<0?this.dragData.y=0:this.dragData.y+this.dragData.rect.height-Re>-this.stickyDistance&&me.y>0?this.dragData.y=Re-this.dragData.rect.height:this.dragData.y+=me.y}else this.dragData.x+=me.x,this.dragData.y+=me.y;this.dragData.dragX=se.x,this.dragData.dragY=se.y},handleMoveEnd(){this.dragData.dragging=!1,q(window,"mousemove",this.handleMoveMove),q(window,"mouseup",this.handleMoveEnd)},handleGetModalIndex(){return Ai(),ti},handleClickModal(){if(this.draggable){if(si!==this.lastVisibleIndex){this.lastVisibleIndex=si;return}this.modalIndex=this.handleGetModalIndex()}},addModal(){const K=this.$root;K.modalList||(K.modalList=[]),K.modalList.push({id:this.id,modal:this})},removeModal(){const K=this.$root;if(!K.modalList)return;const se=K.modalList.findIndex(me=>me.id===this.id);K.modalList.splice(se,1)}},watch:{modelValue(K){this.visible=K},visible(K){K===!1?(this.buttonLoading=!1,this.timer=setTimeout(()=>{this.wrapShow=!1,this.removeScrollEffect()},300)):(this.lastVisible!==K&&(this.modalIndex=this.handleGetModalIndex(),Oi()),this.timer&&clearTimeout(this.timer),this.wrapShow=!0,this.scrollable||this.addScrollEffect()),this.tableList.forEach(se=>{se.table.handleOnVisibleChange(K)}),this.sliderList.forEach(se=>{se.slider.handleOnVisibleChange(K)}),this.$emit("on-visible-change",K),this.lastVisible=K,this.lastVisibleIndex=si,K&&this.resetDragPosition&&(this.dragData=Qe(Vf))},loading(K){K||(this.buttonLoading=!1)},scrollable(K){K?this.removeScrollEffect():this.addScrollEffect()},title(K){this.$slots.header===void 0&&(this.showHead=!!K)}},mounted(){this.visible&&(this.wrapShow=!0);let K=!0;this.$slots.header===void 0&&!this.title&&(K=!1),this.showHead=K,this.addModal(),W&&document.addEventListener("keydown",this.EscClose)},beforeUnmount(){this.removeModal(),W&&document.removeEventListener("keydown",this.EscClose),this.removeScrollEffect()}};function Ww(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("i-button");return E.openBlock(),E.createBlock(E.Teleport,{to:"body",disabled:!me.transfer},[E.createVNode(E.Transition,{name:me.transitionNames[1]},{default:E.withCtx(()=>[ve.showMask?E.withDirectives((E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.maskClasses),style:E.normalizeStyle(ve.wrapStyles),onClick:se[0]||(se[0]=(...tt)=>ve.handleMask&&ve.handleMask(...tt))},null,6)),[[E.vShow,Re.visible]]):E.createCommentVNode("",!0)]),_:1},8,["name"]),E.createElementVNode("div",{class:E.normalizeClass(ve.wrapClasses),style:E.normalizeStyle(ve.wrapStyles),onClick:se[5]||(se[5]=(...tt)=>ve.handleWrapClick&&ve.handleWrapClick(...tt))},[E.createVNode(E.Transition,{name:me.transitionNames[0],onAfterLeave:ve.animationFinish},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("div",E.mergeProps(K.$attrs,{class:ve.classes,style:ve.mainStyles,onMousedown:se[4]||(se[4]=(...tt)=>ve.handleMousedown&&ve.handleMousedown(...tt))}),[E.createElementVNode("div",{class:E.normalizeClass(ve.contentClasses),ref:"content",style:E.normalizeStyle(ve.contentStyles),onClick:se[3]||(se[3]=(...tt)=>ve.handleClickModal&&ve.handleClickModal(...tt))},[me.closable?(E.openBlock(),E.createElementBlock("a",{key:0,class:E.normalizeClass([Re.prefixCls+"-close"]),onClick:se[1]||(se[1]=(...tt)=>ve.close&&ve.close(...tt))},[E.renderSlot(K.$slots,"close",{},()=>[E.createVNode(Fe,{type:"ios-close"})])],2)):E.createCommentVNode("",!0),Re.showHead?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass([Re.prefixCls+"-header"]),onMousedown:se[2]||(se[2]=(...tt)=>ve.handleMoveStart&&ve.handleMoveStart(...tt))},[E.renderSlot(K.$slots,"header",{},()=>[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-header-inner"])},E.toDisplayString(me.title),3)])],34)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"])},[E.renderSlot(K.$slots,"default")],2),me.footerHide?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("div",{key:2,class:E.normalizeClass([Re.prefixCls+"-footer"])},[E.renderSlot(K.$slots,"footer",{},()=>[E.createVNode(Xe,{type:"text",onClick:ve.cancel},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ve.localeCancelText),1)]),_:1},8,["onClick"]),E.createVNode(Xe,{type:"primary",loading:Re.buttonLoading,onClick:ve.ok},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ve.localeOkText),1)]),_:1},8,["loading","onClick"])])],2))],6)],16),[[E.vShow,Re.visible]])]),_:3},8,["name","onAfterLeave"])],6)],8,["disabled"])}var to=Y(zw,[["render",Ww]]);const Po="ivu-modal-confirm";to.newInstance=K=>{if(!W)return;const se=K||{},me=document.createElement("div");document.body.appendChild(me);let Be=null;const Re=E.createApp({mixins:[Xn],data(){return Object.assign({},se,{visible:!1,width:416,title:"",body:"",iconType:"",iconName:"",okText:void 0,cancelText:void 0,showCancel:!1,loading:!1,buttonLoading:!1,scrollable:!1,closable:!1,closing:!1})},render(){let Fe=[];this.showCancel&&Fe.push(E.h(As,{type:"text",onClick:this.cancel},()=>this.localeCancelText)),Fe.push(E.h(As,{type:"primary",loading:this.buttonLoading,onClick:this.ok},()=>this.localeOkText));let Xe;this.render?Xe=E.h("div",{class:`${Po}-body ${Po}-body-render`},[this.render(E.h)]):Xe=E.h("div",{class:`${Po}-body`},[E.h("div",{innerHTML:this.body})]);let tt;return this.title&&(tt=E.h("div",{class:`${Po}-head`},[E.h("div",{class:this.iconTypeCls},[E.h("i",{class:this.iconNameCls})]),E.h("div",{class:`${Po}-head-title`,innerHTML:this.title})])),E.h(to,Object.assign({},se,{width:this.width,scrollable:this.scrollable,closable:this.closable,ref:"modal"},{modelValue:this.visible,"onUpdate:modelValue":Ze=>this.visible=Ze,"onOn-cancel":this.cancel}),()=>E.h("div",{class:Po},[tt,Xe,E.h("div",{class:`${Po}-footer`},Fe)]))},computed:{iconTypeCls(){return[`${Po}-head-icon`,`${Po}-head-icon-${this.iconType}`]},iconNameCls(){return["ivu-icon",`ivu-icon-${this.iconName}`]},localeOkText(){return this.okText?this.okText:this.t("i.modal.okText")},localeCancelText(){return this.cancelText?this.cancelText:this.t("i.modal.cancelText")}},methods:{cancel(){this.closing||(this.$refs.modal.visible=!1,this.buttonLoading=!1,this.onCancel(),this.remove())},ok(){this.closing||(this.loading?this.buttonLoading=!0:(this.$refs.modal.visible=!1,this.remove()),this.onOk())},remove(){this.closing=!0,setTimeout(()=>{this.closing=!1,this.destroy()},300)},destroy(){Re.unmount(),document.body.removeChild(me),this.onRemove()},onOk(){},onCancel(){},onRemove(){}},created(){Be=E.getCurrentInstance()}});Re.mount(me);const ve=Be.refs.modal;return{show(Fe){switch(ve.$parent.showCancel=Fe.showCancel,ve.$parent.iconType=Fe.icon,Fe.icon){case"info":ve.$parent.iconName="ios-information-circle";break;case"success":ve.$parent.iconName="ios-checkmark-circle";break;case"warning":ve.$parent.iconName="ios-alert";break;case"error":ve.$parent.iconName="ios-close-circle";break;case"confirm":ve.$parent.iconName="ios-help-circle";break}"width"in Fe&&(ve.$parent.width=Fe.width),"closable"in Fe&&(ve.$parent.closable=Fe.closable),"title"in Fe&&(ve.$parent.title=Fe.title),"content"in Fe&&(ve.$parent.body=Fe.content),"okText"in Fe&&(ve.$parent.okText=Fe.okText),"cancelText"in Fe&&(ve.$parent.cancelText=Fe.cancelText),"onCancel"in Fe&&(ve.$parent.onCancel=Fe.onCancel),"onOk"in Fe&&(ve.$parent.onOk=Fe.onOk),"loading"in Fe&&(ve.$parent.loading=Fe.loading),"scrollable"in Fe&&(ve.$parent.scrollable=Fe.scrollable),ve.$parent.onRemove=Fe.onRemove,ve.visible=!0},remove(){ve.visible=!1,ve.$parent.buttonLoading=!1,ve.$parent.remove()},component:ve}};let kl;function Df(K=void 0,se=!0){return kl=kl||to.newInstance({closable:!1,maskClosable:!1,footerHide:!0,render:K,lockScroll:se}),kl}function Il(K){const se="render"in K?K.render:void 0,me="lockScroll"in K?K.lockScroll:!0;let Be=Df(se,me);K.onRemove=function(){kl=null},Be.show(K)}to.info=function(K={}){return K.icon="info",K.showCancel=!1,Il(K)},to.success=function(K={}){return K.icon="success",K.showCancel=!1,Il(K)},to.warning=function(K={}){return K.icon="warning",K.showCancel=!1,Il(K)},to.error=function(K={}){return K.icon="error",K.showCancel=!1,Il(K)},to.confirm=function(K={}){return K.icon="confirm",K.showCancel=!0,Il(K)},to.remove=function(){if(!kl)return!1;Df().remove()};const qs="ivu-notice",Nf="ivu-icon",Gw="ivu_notice_key_";let $f=24,Lf=4.5,Ua,Ff=1;const jw={info:"ios-information-circle",success:"ios-checkmark-circle",warning:"ios-alert",error:"ios-close-circle"},Uf="move-notice";function zf(){return Ua=Ua||oc.newInstance({prefixCls:qs,styles:{top:`${$f}px`,right:0},transitionName:Uf}),Ua}function Bl(K,se){const me=se.title||"",Be=se.desc||"",Re=se.name||`${Gw}${Ff}`,ve=se.onClose||function(){},Fe=se.render,Xe=se.duration===0?0:se.duration||Lf;Ff++;let tt=zf(),Ze,it;const nr=se.render&&!me?"":Be||se.render?` ${qs}-with-desc`:"";if(K==="normal")it=!1,Ze=`
            <div class="${qs}-custom-content ${qs}-with-normal ${nr}">
                <div class="${qs}-title">${me}</div>
                <div class="${qs}-desc">${Be}</div>
            </div>
        `;else{const jr=jw[K],zr=nr===""?"":"-outline";it=!0,Ze=`
            <div class="${qs}-custom-content ${qs}-with-icon ${qs}-with-${K} ${nr}">
                <span class="${qs}-icon ${qs}-icon-${K}">
                    <i class="${Nf} ${Nf}-${jr}${zr}"></i>
                </span>
                <div class="${qs}-title">${me}</div>
                <div class="${qs}-desc">${Be}</div>
            </div>
        `}tt.notice({name:Re.toString(),duration:Xe,styles:{},transitionName:Uf,content:Ze,withIcon:it,render:Fe,hasTitle:!!me,onClose:ve,closable:!0,type:"notice"})}var mh={open(K){return Bl("normal",K)},info(K){return Bl("info",K)},success(K){return Bl("success",K)},warning(K){return Bl("warning",K)},error(K){return Bl("error",K)},config(K){K.top&&($f=K.top),(K.duration||K.duration===0)&&(Lf=K.duration)},close(K){if(K)K=K.toString(),Ua&&Ua.remove(K);else return!1},destroy(){let K=zf();Ua=null,K.destroy("ivu-notice")}};const fs="ivu-tabs",gh=300,Wf=(K,se,me,Be)=>{const Re=(K.findIndex(Fe=>Fe.name===se)+me+K.length)%K.length,ve=K[Re];return ve.disabled?Wf(K,ve.name,me):ve},Gf=(K,se)=>{try{K.focus()}catch{}if(W&&document.activeElement==K&&K!==se)return!0;const me=K.children;for(let Be of me)if(Gf(Be,se))return!0;return!1},Hw={name:"Tabs",mixins:[io],emits:["on-click","on-dblclick","on-contextmenu","on-tab-remove","on-drag-drop","update:modelValue"],components:{Icon:Ae,Render:Qd,Dropdown:ca,DropdownMenu:ua},provide(){return{TabsInstance:this}},props:{modelValue:{type:[String,Number]},type:{validator(K){return Ie(K,["line","card"])},default:"line"},size:{validator(K){return Ie(K,["small","default"])},default:"default"},animated:{type:Boolean,default:!0},captureFocus:{type:Boolean,default:!1},closable:{type:Boolean,default:!1},beforeRemove:Function,name:{type:String},draggable:{type:Boolean,default:!1},autoCloseContextmenu:{type:Boolean,default:!0}},data(){return{prefixCls:fs,navList:[],barWidth:0,barOffset:0,activeKey:this.modelValue,focusedKey:this.modelValue,showSlot:!1,navStyle:{transform:""},scrollable:!1,transitioning:!1,contextMenuVisible:!1,contextMenuStyles:{top:0,left:0},paneList:[],tableList:[]}},computed:{classes(){return[`${fs}`,{[`${fs}-card`]:this.type==="card",[`${fs}-mini`]:this.size==="small"&&this.type==="line",[`${fs}-no-animation`]:!this.animated}]},contentClasses(){return[`${fs}-content`,{[`${fs}-content-animated`]:this.animated}]},barClasses(){return[`${fs}-ink-bar`,{[`${fs}-ink-bar-animated`]:this.animated}]},contentStyle(){const K=this.getTabIndex(this.activeKey),se=K===0?"0%":`-${K}00%`;let me={};return K>-1&&(me={transform:`translateX(${se}) translateZ(0px)`}),me},barStyle(){let K={visibility:"hidden",width:`${this.barWidth}px`};return this.type==="line"&&(K.visibility="visible"),this.animated?K.transform=`translate3d(${this.barOffset}px, 0px, 0px)`:K.left=`${this.barOffset}px`,K},arrowType(){const K=this.globalConfig;let se="ios-close";return K&&(K.tabs.customCloseIcon?se="":K.tabs.closeIcon&&(se=K.tabs.closeIcon)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.tabs.customCloseIcon&&(se=K.tabs.customCloseIcon),se},arrowSize(){const K=this.globalConfig;let se="";return K&&K.tabs.closeIconSize&&(se=K.tabs.closeIconSize),se}},methods:{getTabs(){const K=this.paneList.map(me=>me.pane),se=[];return K.forEach(me=>{me.tab&&this.name?me.tab===this.name&&se.push(me):se.push(me)}),se.sort((me,Be)=>{if(me.index&&Be.index)return me.index>Be.index?1:-1}),se},updateNav(){this.navList=[],this.getTabs().forEach((K,se)=>{this.navList.push({labelType:typeof K.label,label:K.label,icon:K.icon||"",name:K.currentName||se,disabled:K.disabled,closable:K.closable,contextMenu:K.contextMenu}),K.currentName||(K.currentName=se),se===0&&(this.activeKey||(this.activeKey=K.currentName||se))}),this.updateStatus(),this.updateBar()},updateBar(){E.nextTick(()=>{const K=this.getTabIndex(this.activeKey);if(!this.$refs.nav)return;const se=this.$refs.nav.querySelectorAll(`.${fs}-tab`),me=se[K];if(this.barWidth=me?parseFloat(me.offsetWidth):0,K>0){let Be=0;const Re=this.size==="small"?0:16;for(let ve=0;ve<K;ve++)Be+=parseFloat(se[ve].offsetWidth)+Re;this.barOffset=Be}else this.barOffset=0;this.updateNavScroll()})},updateStatus(){this.getTabs().forEach(K=>K.show=K.currentName===this.activeKey||this.animated)},tabCls(K){return[`${fs}-tab`,{[`${fs}-tab-disabled`]:K.disabled,[`${fs}-tab-active`]:K.name===this.activeKey,[`${fs}-tab-focused`]:K.name===this.focusedKey}]},handleChange(K){if(this.transitioning)return;this.transitioning=!0,setTimeout(()=>this.transitioning=!1,gh);const se=this.navList[K];!se||se.disabled||(this.activeKey=se.name,this.$emit("update:modelValue",se.name),this.$emit("on-click",se.name))},handleDblclick(K){const se=this.navList[K];!se||se.disabled||this.$emit("on-dblclick",se.name)},handleContextmenu(K,se){this.contextMenuVisible&&this.handleClickContextMenuOutside(),E.nextTick(()=>{const me=this.navList[K];if(!me||me.disabled||!me.contextMenu)return;se.preventDefault();const Be=this.$refs.tabsWrap.getBoundingClientRect(),Re={left:`${se.clientX-Be.left}px`,top:`${se.clientY-Be.top}px`};this.contextMenuStyles=Re,this.contextMenuVisible=!0,this.$emit("on-contextmenu",me,se,Re)})},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handlePreventSelect(K,se){const me=this.navList[K];!me||me.disabled||!me.contextMenu||se.preventDefault()},handleTabKeyNavigation(K){if(K.keyCode!==37&&K.keyCode!==39)return;const se=K.keyCode===39?1:-1,me=Wf(this.navList,this.focusedKey,se);this.focusedKey=me.name},handleTabKeyboardSelect(K=!1){if(K)return;const se=this.focusedKey||0,me=this.getTabIndex(se);this.handleChange(me)},handleRemove(K){if(!this.beforeRemove)return this.handleRemoveTab(K);const se=this.beforeRemove(K);se&&se.then?se.then(()=>{this.handleRemoveTab(K)}):this.handleRemoveTab(K)},handleRemoveTab(K){const se=this.getTabs(),me=se[K];if(me.currentName===this.activeKey){const Be=this.getTabs();let Re=-1;if(Be.length){const ve=se.filter((Xe,tt)=>!Xe.disabled&&tt<K),Fe=se.filter((Xe,tt)=>!Xe.disabled&&tt>K);Fe.length?Re=Fe[0].currentName:ve.length?Re=ve[ve.length-1].currentName:Re=Be[0].currentName}this.activeKey=Re,this.$emit("update:modelValue",Re)}this.$emit("on-tab-remove",me.currentName),this.updateNav()},showClose(K){return this.type==="card"?K.closable!==null?K.closable:this.closable:!1},scrollPrev(){const K=this.$refs.navScroll.offsetWidth,se=this.getCurrentScrollOffset();if(!se)return;let me=se>K?se-K:0;this.setOffset(me)},scrollNext(){const K=this.$refs.nav.offsetWidth,se=this.$refs.navScroll.offsetWidth,me=this.getCurrentScrollOffset();if(K-me<=se)return;let Be=K-me>se*2?me+se:K-se;this.setOffset(Be)},getCurrentScrollOffset(){const{navStyle:K}=this;return K.transform?Number(K.transform.match(/translateX\(-(\d+(\.\d+)*)px\)/)[1]):0},getTabIndex(K){return this.navList.findIndex(se=>se.name===K)},setOffset(K){this.navStyle.transform=`translateX(-${K}px)`},scrollToActiveTab(){if(!this.scrollable)return;const K=this.$refs.nav,se=this.$el.querySelector(`.${fs}-tab-active`);if(!se)return;const me=this.$refs.navScroll,Be=se.getBoundingClientRect(),Re=me.getBoundingClientRect(),ve=K.getBoundingClientRect(),Fe=this.getCurrentScrollOffset();let Xe=Fe;ve.right<Re.right&&(Xe=K.offsetWidth-Re.width),Be.left<Re.left?Xe=Fe-(Re.left-Be.left):Be.right>Re.right&&(Xe=Fe+Be.right-Re.right),Fe!==Xe&&this.setOffset(Math.max(Xe,0))},updateNavScroll(){const K=this.$refs.nav.offsetWidth,se=this.$refs.navScroll.offsetWidth,me=this.getCurrentScrollOffset();se<K?(this.scrollable=!0,K-me<se&&this.setOffset(K-se)):(this.scrollable=!1,me>0&&this.setOffset(0))},handleScroll(K){K.preventDefault(),K.stopPropagation();const se=K.type;let me=0;(se==="DOMMouseScroll"||se==="mousewheel")&&(me=K.wheelDelta?K.wheelDelta:-(K.detail||0)*40),me>0?this.scrollPrev():this.scrollNext()},handleResize(){this.updateNavScroll()},isInsideHiddenElement(){if(!W)return;let K=this.$el.parentNode;for(;K&&K!==document.body;){if(K.style&&K.style.display==="none")return K;K=K.parentNode}return!1},updateVisibility(K){[...this.$refs.panes.querySelectorAll(`.${fs}-tabpane`)].forEach((se,me)=>{K===me?([...se.children].filter(Be=>Be.classList.contains(`${fs}-tabpane`)).forEach(Be=>Be.style.visibility="visible"),this.captureFocus&&setTimeout(()=>Gf(se,se),gh)):setTimeout(()=>{[...se.children].filter(Be=>Be.classList.contains(`${fs}-tabpane`)).forEach(Be=>Be.style.visibility="hidden")},gh)})},handleDrag(K,se){const me=this.navList[K];me&&se.dataTransfer.setData("tab-name",me.name)},handleDrop(K,se){const me=this.navList[K];if(me){const Be=se.dataTransfer.getData("tab-name");se.preventDefault();let Re=this.navList.map(Xe=>Xe.name);const ve=parseInt(Re.findIndex(Xe=>Xe===Be)),Fe=parseInt(Re.findIndex(Xe=>Xe===me.name));Re.splice(Fe,1,...Re.splice(ve,1,Re[Fe])),this.$emit("on-drag-drop",Be,me.name,ve,Fe,Re)}},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},watch:{modelValue(K){this.activeKey=K,this.focusedKey=K},activeKey(K){this.focusedKey=K,this.updateBar(),this.updateStatus(),this.tableList.forEach(me=>{me.table.handleOnVisibleChange(!0)}),E.nextTick(()=>{this.scrollToActiveTab()});const se=Math.max(this.getTabIndex(this.focusedKey),0);this.updateVisibility(se)}},mounted(){this.showSlot=this.$slots.extra!==void 0,this.observer=Na(),this.observer.listenTo(this.$refs.navWrap,this.handleResize);const K=this.isInsideHiddenElement();K&&(this.mutationObserver=new We(()=>{K.style.display!=="none"&&(this.updateBar(),this.mutationObserver.disconnect())}),this.mutationObserver.observe(K,{attributes:!0,childList:!0,characterData:!0,attributeFilter:["style"]})),this.handleTabKeyboardSelect(!0),this.updateVisibility(this.getTabIndex(this.activeKey))},beforeUnmount(){this.observer.removeListener(this.$refs.navWrap,this.handleResize),this.mutationObserver&&this.mutationObserver.disconnect()}},Xw=["onClick","onDblclick","onContextmenu","onSelectstart","draggable","onDragstart","onDrop"];function qw(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Render"),tt=E.resolveComponent("DropdownMenu"),Ze=E.resolveComponent("Dropdown");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),ref:"tabsWrap"},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-bar"])},[Re.showSlot?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-nav-right"])},[E.renderSlot(K.$slots,"extra")],2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-nav-container"]),tabindex:"0",ref:"navContainer",onKeydown:[se[5]||(se[5]=(...it)=>ve.handleTabKeyNavigation&&ve.handleTabKeyNavigation(...it)),se[6]||(se[6]=E.withKeys(E.withModifiers(it=>ve.handleTabKeyboardSelect(!1),["prevent"]),["space"]))]},[E.createElementVNode("div",{ref:"navWrap",class:E.normalizeClass([Re.prefixCls+"-nav-wrap",Re.scrollable?Re.prefixCls+"-nav-scrollable":""])},[E.createElementVNode("span",{class:E.normalizeClass([Re.prefixCls+"-nav-prev",Re.scrollable?"":Re.prefixCls+"-nav-scroll-disabled"]),onClick:se[0]||(se[0]=(...it)=>ve.scrollPrev&&ve.scrollPrev(...it))},[E.createVNode(Fe,{type:"ios-arrow-back"})],2),E.createElementVNode("span",{class:E.normalizeClass([Re.prefixCls+"-nav-next",Re.scrollable?"":Re.prefixCls+"-nav-scroll-disabled"]),onClick:se[1]||(se[1]=(...it)=>ve.scrollNext&&ve.scrollNext(...it))},[E.createVNode(Fe,{type:"ios-arrow-forward"})],2),E.createElementVNode("div",{ref:"navScroll",class:E.normalizeClass([Re.prefixCls+"-nav-scroll"]),"on:DOMMouseScroll":se[3]||(se[3]=(...it)=>ve.handleScroll&&ve.handleScroll(...it)),onMousewheel:se[4]||(se[4]=(...it)=>ve.handleScroll&&ve.handleScroll(...it))},[E.createElementVNode("div",{ref:"nav",class:E.normalizeClass([Re.prefixCls+"-nav"]),style:E.normalizeStyle(Re.navStyle)},[E.createElementVNode("div",{class:E.normalizeClass(ve.barClasses),style:E.normalizeStyle(ve.barStyle)},null,6),(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.navList,(it,nr)=>(E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.tabCls(it)),key:nr,onClick:jr=>ve.handleChange(nr),onDblclick:jr=>ve.handleDblclick(nr),onContextmenu:E.withModifiers(jr=>ve.handleContextmenu(nr,jr),["stop"]),onSelectstart:E.withModifiers(jr=>ve.handlePreventSelect(nr,jr),["stop"]),draggable:me.draggable,onDragstart:jr=>ve.handleDrag(nr,jr),onDrop:jr=>ve.handleDrop(nr,jr),onDragover:se[2]||(se[2]=E.withModifiers(()=>{},["prevent"]))},[it.icon!==""?(E.openBlock(),E.createBlock(Fe,{key:0,type:it.icon},null,8,["type"])):E.createCommentVNode("",!0),it.labelType==="function"?(E.openBlock(),E.createBlock(Xe,{key:1,render:it.label},null,8,["render"])):(E.openBlock(),E.createElementBlock(E.Fragment,{key:2},[E.createTextVNode(E.toDisplayString(it.label),1)],64)),ve.showClose(it)?(E.openBlock(),E.createBlock(Fe,{key:3,class:E.normalizeClass([Re.prefixCls+"-close"]),type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize,onClick:E.withModifiers(jr=>ve.handleRemove(nr),["stop"])},null,8,["class","type","custom","size","onClick"])):E.createCommentVNode("",!0)],42,Xw))),128))],6)],34)],2)],34)],2),E.createElementVNode("div",{class:E.normalizeClass(ve.contentClasses),style:E.normalizeStyle(ve.contentStyle),ref:"panes"},[E.renderSlot(K.$slots,"default")],6),E.createElementVNode("div",{class:"ivu-tabs-context-menu",style:E.normalizeStyle(Re.contextMenuStyles)},[E.createVNode(Ze,{trigger:"custom",visible:Re.contextMenuVisible,transfer:"",onOnClick:ve.handleClickDropdownItem,onOnClickoutside:ve.handleClickContextMenuOutside},{list:E.withCtx(()=>[E.createVNode(tt,null,{default:E.withCtx(()=>[E.renderSlot(K.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)],2)}var eu=Y(Hw,[["render",qw]]);const Qw={name:"Notification",components:{Dropdown:ca,DropdownMenu:ua,Badge:Ql,Tabs:eu},emits:["on-visible-change","on-item-click","on-clear","on-load-more","on-tab-change"],provide(){return{NotificationInstance:this}},props:{count:{type:Number},autoCount:{type:Boolean,default:!1},countType:{validator(K){return Ie(K,["text","badge"])},default:"text"},icon:{type:String,default:"md-notifications-outline"},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"bottom"},badgeProps:{type:Object,default(){return{}}},clearClose:{type:Boolean,default:!1},locale:{type:Object,default(){return{loadedAll:"",loading:"...",loadMore:"",clear:""}}},tab:{type:String},wide:{type:Boolean,default:!1},transferClassName:{type:String}},data(){return{visible:!1,countAll:0,tabList:[]}},computed:{finalCount(){return this.autoCount?this.countAll:this.count},transferClasses(){let K="ivu-notifications-transfer";return this.transferClassName&&(K+=` ${this.transferClassName}`),K}},watch:{visible(K){this.$emit("on-visible-change",K)}},methods:{handleVisibleChange(K){this.visible=K},handleClickOutside(K){this.$refs.notice.contains(K.target)||(this.visible=!1)},handleToggleOpen(){this.visible=!this.visible},handleGetCountAll(){if(this.autoCount){const K=this.tabList.map(me=>me.tab);let se=0;K.forEach(me=>{me.count&&(se+=me.count)}),this.countAll=se}},handleItemClick(K,se){this.$emit("on-item-click",K,se)},handleClear(K){this.$emit("on-clear",K),this.clearClose&&this.handleClose()},handleLoadMore(K){this.$emit("on-load-more",K)},handleClose(){this.visible=!1},handleTabChange(K){const se=this.tabList.map(Be=>Be.tab);let me={};se.forEach(Be=>{Be.$refs.tab.currentName===K&&(me=Be.handleGetTabBaseInfo())}),this.$emit("on-tab-change",me)}}},Yw={class:"ivu-notifications",ref:"notice"},Kw={class:"ivu-notifications-tabs"},Zw={key:0,class:"ivu-notifications-extra"};function Jw(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Badge"),tt=E.resolveComponent("Tabs"),Ze=E.resolveComponent("DropdownMenu"),it=E.resolveComponent("Dropdown");return E.openBlock(),E.createElementBlock("div",Yw,[E.createVNode(it,{trigger:"custom",visible:Re.visible,transfer:me.transfer,placement:me.placement,"transfer-class-name":ve.transferClasses,onOnVisibleChange:ve.handleVisibleChange,onOnClickoutside:ve.handleClickOutside},{list:E.withCtx(()=>[K.$slots.default?(E.openBlock(),E.createBlock(Ze,{key:0,onClick:se[1]||(se[1]=E.withModifiers(()=>{},["stop"]))},{default:E.withCtx(()=>[E.createElementVNode("div",{class:E.normalizeClass(["ivu-notifications-list",{"ivu-notifications-list-wide":me.wide}])},[E.createElementVNode("div",Kw,[E.createVNode(tt,{animated:!1,"model-value":me.tab,onOnClick:ve.handleTabChange},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"default")]),_:3},8,["model-value","onOnClick"])])],2),K.$slots.extra?(E.openBlock(),E.createElementBlock("div",Zw,[E.renderSlot(K.$slots,"extra")])):E.createCommentVNode("",!0)]),_:3})):E.createCommentVNode("",!0)]),default:E.withCtx(()=>[E.createElementVNode("div",{class:"ivu-notifications-rel",onClick:se[0]||(se[0]=E.withModifiers((...nr)=>ve.handleToggleOpen&&ve.handleToggleOpen(...nr),["prevent","stop"]))},[E.createVNode(Xe,E.mergeProps({count:ve.finalCount},me.badgeProps),{default:E.withCtx(()=>[E.renderSlot(K.$slots,"icon",{},()=>[E.createVNode(Fe,{type:me.icon,size:"24"},null,8,["type"])])]),_:3},16,["count"])])]),_:3},8,["visible","transfer","placement","transfer-class-name","onOnVisibleChange","onOnClickoutside"])],512)}var jf=Y(Qw,[["render",Jw]]);const eO=(K,se)=>K<=se,Vl=K=>K<10?"0"+K:K,Hf=(K,se)=>{const me=new Date(K),Be=me.getFullYear(),Re=Vl(me.getMonth()+1),ve=Vl(me.getDate()),Fe=Vl(me.getHours()),Xe=Vl(me.getMinutes()),tt=Vl(me.getSeconds());let Ze="";return se==="year"?Ze=Be+"-"+Re+"-"+ve+" "+Fe+":"+Xe+":"+tt:Ze=Re+"-"+ve+" "+Fe+":"+Xe,Ze},tO=(K,se)=>{const me=new Date().getTime(),Be=eO(K,me);let Re=me-K;Be||(Re=-Re);let ve="",Fe=Be?se("i.time.before")||"":se("i.time.after")||"";return Re<1e3?ve=se("i.time.just")||"":Re<6e4?ve=parseInt(Re/1e3)+(se("i.time.seconds")||"")+Fe:Re>=6e4&&Re<36e5?ve=Math.floor(Re/6e4)+(se("i.time.minutes")||"")+Fe:Re>=36e5&&Re<864e5?ve=Math.floor(Re/36e5)+(se("i.time.hours")||"")+Fe:Re>=864e5&&Re<262386e4?ve=Math.floor(Re/864e5)+(se("i.time.days")||"")+Fe:Re>=262386e4&&Re<=3156786e4&&Be?ve=Hf(K):ve=Hf(K,"year"),ve};function rO(K,se){return tO(K,se)}const Xf="ivu-time",iO={name:"Time",mixins:[Xn],props:{time:{type:[Number,Date,String],required:!0},type:{type:String,validator(K){return Ie(K,["relative","date","datetime"])},default:"relative"},hash:{type:String,default:""},interval:{type:Number,default:60}},data(){return{date:""}},computed:{classes(){return[`${Xf}`,{[`${Xf}-with-hash`]:this.hash}]}},watch:{time(){this.setTime()}},methods:{handleClick(){W&&this.hash!==""&&(window.location.hash=this.hash)},setTime(){const K=typeof this.time;let se;if(K==="number"){const me=this.time.toString().length>10?this.time:this.time*1e3;se=new Date(me).getTime()}else K==="object"?se=this.time.getTime():K==="string"&&(se=Fs(this.time).valueOf());if(this.type==="relative")this.date=rO(se,this.t);else{const me=new Date(this.time),Be=me.getFullYear(),Re=me.getMonth()+1<10?"0"+(me.getMonth()+1):me.getMonth()+1,ve=me.getDate()<10?"0"+me.getDate():me.getDate(),Fe=me.getHours()<10?"0"+me.getHours():me.getHours(),Xe=me.getMinutes()<10?"0"+me.getMinutes():me.getMinutes(),tt=me.getSeconds()<10?"0"+me.getSeconds():me.getSeconds();this.type==="datetime"?this.date=`${Be}-${Re}-${ve} ${Fe}:${Xe}:${tt}`:this.type==="date"&&(this.date=`${Be}-${Re}-${ve}`)}}},mounted(){this.setTime(),this.interval!==0&&(this.timer=setInterval(()=>{this.setTime()},1e3*this.interval))},beforeUnmount(){this.timer&&clearInterval(this.timer)}};function nO(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("span",{class:E.normalizeClass(ve.classes),onClick:se[0]||(se[0]=(...Fe)=>ve.handleClick&&ve.handleClick(...Fe))},E.toDisplayString(Re.date),3)}var ru=Y(iO,[["render",nO]]);const sO={name:"NotificationItem",inject:["NotificationTabInstance","NotificationInstance"],components:{Row:Lo,Col:vo,Avatar:rl,Tag:Ta,Time:ru},emits:["on-item-click"],props:{rowProps:{type:Object,default(){return{type:"flex",justify:"center",align:"middle"}}},read:{type:[Boolean,Number],default:!1},icon:{type:String},customIcon:{type:String},iconColor:{type:String},iconSize:{validator(K){return Ie(K,["small","default","large"])},default:"default"},avatar:{type:String},avatarShape:{validator(K){return Ie(K,["circle","square"])},default:"circle"},title:{type:String},content:{type:String},time:{type:[Number,Date,String]},timeProps:{type:Object,default(){return{}}},tag:{type:String},tagProps:{type:Object,default(){return{}}},clickClose:{type:Boolean,default:!1}},data(){return{id:gt(6)}},computed:{classes(){return{"ivu-notifications-item-unread":this.read===!1||this.read===0}},contentSpan(){return this.icon||this.customIcon||this.avatar||this.$slots.avatar?20:24},iconStyle(){let K={};return this.iconColor&&(K={"background-color":this.iconColor}),K}},methods:{handleClick(){this.$emit("on-item-click",this.$attrs),this.NotificationTabInstance.handleItemClick(this.$attrs),this.clickClose&&this.NotificationInstance.handleClose()},addItem(){this.NotificationTabInstance.itemList.push({id:this.id,item:this})},removeItem(){const K=this.NotificationTabInstance,se=K.itemList.findIndex(me=>me.id===this.id);K.itemList.splice(se,1)}},mounted(){this.addItem(),this.NotificationTabInstance.handleGetItems()},unmounted(){this.NotificationTabInstance.handleGetItems()},beforeUnmount(){this.removeItem()}},oO={class:"ivu-notifications-item-title"},aO={key:0},lO={key:0,class:"ivu-notifications-item-tag"},cO={key:0,class:"ivu-notifications-item-desc"},uO={key:1,class:"ivu-notifications-item-time"};function hO(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Avatar"),Xe=E.resolveComponent("Col"),tt=E.resolveComponent("Tag"),Ze=E.resolveComponent("Time"),it=E.resolveComponent("Row");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-notifications-item",ve.classes]),onClick:se[0]||(se[0]=(...nr)=>ve.handleClick&&ve.handleClick(...nr))},[E.renderSlot(K.$slots,"default",{},()=>[E.createVNode(it,E.normalizeProps(E.guardReactiveProps(me.rowProps)),{default:E.withCtx(()=>[me.icon||me.customIcon||me.avatar||K.$slots.avatar?(E.openBlock(),E.createBlock(Xe,{key:0,span:"4",class:"ivu-notifications-item-icon"},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"avatar",{},()=>[me.icon?(E.openBlock(),E.createBlock(Fe,{key:0,icon:me.icon,shape:me.avatarShape,size:me.iconSize,style:E.normalizeStyle(ve.iconStyle)},null,8,["icon","shape","size","style"])):me.customIcon?(E.openBlock(),E.createBlock(Fe,{key:1,"custom-icon":me.customIcon,shape:me.avatarShape,size:me.iconSize,style:E.normalizeStyle(ve.iconStyle)},null,8,["custom-icon","shape","size","style"])):me.avatar?(E.openBlock(),E.createBlock(Fe,{key:2,src:me.avatar,shape:me.avatarShape,size:me.iconSize,style:E.normalizeStyle(ve.iconStyle)},null,8,["src","shape","size","style"])):E.createCommentVNode("",!0)])]),_:3})):E.createCommentVNode("",!0),E.createVNode(Xe,{span:ve.contentSpan,class:"ivu-notifications-item-content"},{default:E.withCtx(()=>[E.createElementVNode("div",oO,[me.title||K.$slots.title?(E.openBlock(),E.createElementBlock("h4",aO,[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)]),me.tag?(E.openBlock(),E.createElementBlock("div",lO,[E.createVNode(tt,E.normalizeProps(E.guardReactiveProps(me.tagProps)),{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(me.tag),1)]),_:1},16)])):E.createCommentVNode("",!0)])):E.createCommentVNode("",!0)]),me.content||K.$slots.content?(E.openBlock(),E.createElementBlock("div",cO,[E.renderSlot(K.$slots,"content",{},()=>[E.createTextVNode(E.toDisplayString(me.content),1)])])):E.createCommentVNode("",!0),me.time||K.$slots.time?(E.openBlock(),E.createElementBlock("div",uO,[E.renderSlot(K.$slots,"time",{},()=>[E.createVNode(Ze,E.mergeProps({time:me.time},me.timeProps),null,16,["time"])])])):E.createCommentVNode("",!0)]),_:3},8,["span"])]),_:3},16)])],2)}var qf=Y(sO,[["render",hO]]);const dO="ivu-tabs-tabpane",pO={name:"TabPane",inject:["TabsInstance"],props:{name:{type:String},label:{type:[String,Function],default:""},icon:{type:String},disabled:{type:Boolean,default:!1},closable:{type:Boolean,default:null},tab:{type:String},index:{type:Number},contextMenu:{type:Boolean,default:!1}},data(){return{prefixCls:dO,show:!0,currentName:this.name,id:gt(6)}},computed:{contentStyle(){return{visibility:this.TabsInstance.activeKey!==this.currentName?"hidden":"visible"}}},methods:{updateNav(){this.TabsInstance.updateNav()},addPane(){const K=this.TabsInstance;K.paneList||(K.paneList=[]),K.paneList.push({id:this.id,pane:this})},removePane(){const K=this.TabsInstance;if(K.paneList&&K.paneList.length){const se=K.paneList.findIndex(me=>me.id===this.id);K.paneList.splice(se,1)}}},watch:{name(K){this.currentName=K,this.updateNav()},label(K){typeof K!="function"&&this.updateNav()},icon(){this.updateNav()},disabled(){this.updateNav()}},mounted(){this.addPane(),this.updateNav()},beforeUnmount(){this.removePane(),this.updateNav()}};function fO(K,se,me,Be,Re,ve){return E.withDirectives((E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(Re.prefixCls),style:E.normalizeStyle(ve.contentStyle)},[E.renderSlot(K.$slots,"default")],6)),[[E.vShow,Re.show]])}var iu=Y(pO,[["render",fO]]);const mO={name:"NotificationTab",inject:["NotificationInstance"],components:{TabPane:iu,Icon:Ae},provide(){return{NotificationTabInstance:this}},props:{count:{type:Number},title:{type:String,required:!0},name:{type:String},emptyText:{type:String,default:""},emptyImage:{type:String,default:"https://file.iviewui.com/iview-pro/icon-no-message.svg"},loadedAll:{type:Boolean,default:!0},showLoadedAll:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},scrollToLoad:{type:Boolean,default:!0},showClear:{type:Boolean,default:!0},showClearIcon:{type:Boolean,default:!0}},data(){return{customLabel:K=>K("div",[K("span",this.title),K(Ql,{count:this.count})]),itemCount:0,itemList:[],id:gt(6)}},computed:{currentTitle(){const K=this.NotificationInstance.countType;if(K==="text"){const se=this.count?`(${this.count})`:"";return`${this.title} ${se}`}else if(K==="badge")return this.customLabel}},watch:{count:{handler(){this.NotificationInstance.handleGetCountAll()},immediate:!0}},methods:{handleGetTabBaseInfo(){return{name:this.name,title:this.title}},handleGetItems(){const K=this.itemList.map(se=>se.item);this.itemCount=K.length},handleItemClick(K){this.NotificationInstance.handleItemClick(this.handleGetTabBaseInfo(),K)},handleClear(){this.NotificationInstance.handleClear(this.handleGetTabBaseInfo())},handleLoadMore(){this.NotificationInstance.handleLoadMore(this.handleGetTabBaseInfo())},handleScroll(){if(!this.scrollToLoad)return;const K=this.$refs.scroll,se=K.scrollHeight-K.clientHeight-K.scrollTop;!this.loading&&se===0&&this.handleLoadMore()},addTab(){this.NotificationInstance.tabList.push({id:this.id,tab:this})},removeTab(){const K=this.NotificationInstance,se=K.tabList.findIndex(me=>me.id===this.id);K.tabList.splice(se,1)}},mounted(){this.addTab()},beforeUnmount(){this.removeTab()}},gO={class:"ivu-notifications-container-list"},yO={key:0,class:"ivu-notifications-tab-empty"},_O=["src"],vO={class:"ivu-notifications-tab-empty-text"},bO={class:"ivu-notifications-tab-loading"},xO={key:0,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-show"},SO={key:2,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-all"};function wO(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("TabPane");return E.openBlock(),E.createBlock(Xe,{label:ve.currentTitle,name:me.name,ref:"tab",class:"ivu-notifications-tab"},{default:E.withCtx(()=>[E.createElementVNode("div",{class:"ivu-notifications-container",onScroll:se[1]||(se[1]=(...tt)=>ve.handleScroll&&ve.handleScroll(...tt)),ref:"scroll"},[E.renderSlot(K.$slots,"top"),E.createElementVNode("div",gO,[E.renderSlot(K.$slots,"default")]),!me.loading&&Re.itemCount===0?(E.openBlock(),E.createElementBlock("div",yO,[E.renderSlot(K.$slots,"empty",{},()=>[me.emptyImage?(E.openBlock(),E.createElementBlock("img",{key:0,class:"ivu-notifications-tab-empty-img",src:me.emptyImage},null,8,_O)):E.createCommentVNode("",!0),E.createElementVNode("div",vO,E.toDisplayString(me.emptyText),1)])])):E.createCommentVNode("",!0),E.createElementVNode("div",bO,[me.loading?(E.openBlock(),E.createElementBlock("div",xO,[E.renderSlot(K.$slots,"loading",{},()=>[E.createVNode(Fe,{type:"ios-loading",class:"ivu-load-loop"}),E.createTextVNode(" "+E.toDisplayString(ve.NotificationInstance.locale.loading),1)])])):me.loadedAll?me.showLoadedAll&&me.loadedAll?(E.openBlock(),E.createElementBlock("div",SO,[E.renderSlot(K.$slots,"loaded-all",{},()=>[E.createTextVNode(E.toDisplayString(ve.NotificationInstance.locale.loadedAll),1)])])):E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("div",{key:1,class:"ivu-notifications-tab-loading-item ivu-notifications-tab-loading-more",onClick:se[0]||(se[0]=(...tt)=>ve.handleLoadMore&&ve.handleLoadMore(...tt))},[E.renderSlot(K.$slots,"load-more",{},()=>[E.createTextVNode(E.toDisplayString(ve.NotificationInstance.locale.loadMore),1)])]))])],544),me.showClear&&Re.itemCount!==0?(E.openBlock(),E.createElementBlock("div",{key:0,class:"ivu-notifications-tab-clear",onClick:se[2]||(se[2]=(...tt)=>ve.handleClear&&ve.handleClear(...tt))},[E.renderSlot(K.$slots,"clear",{},()=>[me.showClearIcon?(E.openBlock(),E.createBlock(Fe,{key:0,type:"md-done-all"})):E.createCommentVNode("",!0),E.createElementVNode("span",null,E.toDisplayString(ve.NotificationInstance.locale.clear)+E.toDisplayString(me.title),1)])])):E.createCommentVNode("",!0)]),_:3},8,["label","name"])}var Qf=Y(mO,[["render",wO]]);const OO={name:"Trend",components:{Icon:Ae},props:{flag:{validator(K){return Ie(K,["up","down"])}},colorful:{type:Boolean,default:!0},reverseColor:{type:Boolean,default:!1},textColor:{type:Boolean,default:!1},showTitle:{type:[Boolean,String],default:!1}},computed:{classes(){return[{"ivu-trend-up":this.flag==="up","ivu-trend-down":this.flag==="down","ivu-trend-reverse-color":this.reverseColor,"ivu-trend-colorful":this.colorful,"ivu-trend-text-color":this.textColor}]},flagType(){return this.flag==="up"?"md-arrow-dropup":this.flag==="down"?"md-arrow-dropdown":""}}},CO={class:"ivu-trend-text"};function TO(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-trend",ve.classes])},[E.createElementVNode("span",CO,[E.renderSlot(K.$slots,"default")]),E.createVNode(Fe,{type:ve.flagType,class:"ivu-trend-flag"},null,8,["type"])],2)}var yh=Y(OO,[["render",TO]]);const EO={name:"NumberInfo",components:{Trend:yh},props:{title:{type:String},subTitle:{type:String},total:{type:[String,Number]},subTotal:{type:[String,Number]},status:{validator(K){return Ie(K,["up","down"])}},gap:{type:[String,Number],default:8}},computed:{valueStyle(){return{"margin-top":this.gap+"px"}}}},AO={class:"ivu-number-info"},MO={key:0,class:"ivu-number-info-title"},PO={key:1,class:"ivu-number-info-subTitle"},RO={class:"ivu-number-info-total"},kO={key:0,class:"ivu-number-info-subTotal"};function IO(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Trend");return E.openBlock(),E.createElementBlock("div",AO,[me.title||K.$slots.title?(E.openBlock(),E.createElementBlock("div",MO,[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])])):E.createCommentVNode("",!0),me.subTitle||K.$slots.subTitle?(E.openBlock(),E.createElementBlock("div",PO,[E.renderSlot(K.$slots,"subTitle",{},()=>[E.createTextVNode(E.toDisplayString(me.subTitle),1)])])):E.createCommentVNode("",!0),E.createElementVNode("div",{class:"ivu-number-info-value",style:E.normalizeStyle(ve.valueStyle)},[E.createElementVNode("span",RO,[E.renderSlot(K.$slots,"total",{},()=>[E.createTextVNode(E.toDisplayString(me.total),1)])]),me.subTotal||K.$slots.subTotal?(E.openBlock(),E.createElementBlock("span",kO,[E.renderSlot(K.$slots,"subTotal",{},()=>[E.createVNode(Fe,{flag:me.status},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(me.subTotal),1)]),_:1},8,["flag"])])])):E.createCommentVNode("",!0)],4)])}var Kf=Y(EO,[["render",IO]]),Zf={exports:{}};/*! @preserve
* numeral.js
* version : 2.0.6
* author : Adam Draper
* license : MIT
* http://adamwdraper.github.com/Numeral-js/
*/(function(K){(function(se,me){K.exports?K.exports=me():se.numeral=me()})(ct,function(){var se,me,Be="2.0.6",Re={},ve={},Fe={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},Xe={currentLocale:Fe.currentLocale,zeroFormat:Fe.zeroFormat,nullFormat:Fe.nullFormat,defaultFormat:Fe.defaultFormat,scalePercentBy100:Fe.scalePercentBy100};function tt(Ze,it){this._input=Ze,this._value=it}return se=function(Ze){var it,nr,jr,zr;if(se.isNumeral(Ze))it=Ze.value();else if(Ze===0||typeof Ze>"u")it=0;else if(Ze===null||me.isNaN(Ze))it=null;else if(typeof Ze=="string")if(Xe.zeroFormat&&Ze===Xe.zeroFormat)it=0;else if(Xe.nullFormat&&Ze===Xe.nullFormat||!Ze.replace(/[^0-9]+/g,"").length)it=null;else{for(nr in Re)if(zr=typeof Re[nr].regexps.unformat=="function"?Re[nr].regexps.unformat():Re[nr].regexps.unformat,zr&&Ze.match(zr)){jr=Re[nr].unformat;break}jr=jr||se._.stringToNumber,it=jr(Ze)}else it=Number(Ze)||null;return new tt(Ze,it)},se.version=Be,se.isNumeral=function(Ze){return Ze instanceof tt},se._=me={numberToFormat:function(Ze,it,nr){var jr=ve[se.options.currentLocale],zr=!1,Fr=!1,_t=0,ni="",on=1e12,Gi=1e9,Qi=1e6,wi=1e3,li="",Vi=!1,Pi,pn,fn,Zi,Yi,tn,vn;if(Ze=Ze||0,pn=Math.abs(Ze),se._.includes(it,"(")?(zr=!0,it=it.replace(/[\(|\)]/g,"")):(se._.includes(it,"+")||se._.includes(it,"-"))&&(Yi=se._.includes(it,"+")?it.indexOf("+"):Ze<0?it.indexOf("-"):-1,it=it.replace(/[\+|\-]/g,"")),se._.includes(it,"a")&&(Pi=it.match(/a(k|m|b|t)?/),Pi=Pi?Pi[1]:!1,se._.includes(it," a")&&(ni=" "),it=it.replace(new RegExp(ni+"a[kmbt]?"),""),pn>=on&&!Pi||Pi==="t"?(ni+=jr.abbreviations.trillion,Ze=Ze/on):pn<on&&pn>=Gi&&!Pi||Pi==="b"?(ni+=jr.abbreviations.billion,Ze=Ze/Gi):pn<Gi&&pn>=Qi&&!Pi||Pi==="m"?(ni+=jr.abbreviations.million,Ze=Ze/Qi):(pn<Qi&&pn>=wi&&!Pi||Pi==="k")&&(ni+=jr.abbreviations.thousand,Ze=Ze/wi)),se._.includes(it,"[.]")&&(Fr=!0,it=it.replace("[.]",".")),fn=Ze.toString().split(".")[0],Zi=it.split(".")[1],tn=it.indexOf(","),_t=(it.split(".")[0].split(",")[0].match(/0/g)||[]).length,Zi?(se._.includes(Zi,"[")?(Zi=Zi.replace("]",""),Zi=Zi.split("["),li=se._.toFixed(Ze,Zi[0].length+Zi[1].length,nr,Zi[1].length)):li=se._.toFixed(Ze,Zi.length,nr),fn=li.split(".")[0],se._.includes(li,".")?li=jr.delimiters.decimal+li.split(".")[1]:li="",Fr&&Number(li.slice(1))===0&&(li="")):fn=se._.toFixed(Ze,0,nr),ni&&!Pi&&Number(fn)>=1e3&&ni!==jr.abbreviations.trillion)switch(fn=String(Number(fn)/1e3),ni){case jr.abbreviations.thousand:ni=jr.abbreviations.million;break;case jr.abbreviations.million:ni=jr.abbreviations.billion;break;case jr.abbreviations.billion:ni=jr.abbreviations.trillion;break}if(se._.includes(fn,"-")&&(fn=fn.slice(1),Vi=!0),fn.length<_t)for(var Ji=_t-fn.length;Ji>0;Ji--)fn="0"+fn;return tn>-1&&(fn=fn.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+jr.delimiters.thousands)),it.indexOf(".")===0&&(fn=""),vn=fn+li+(ni||""),zr?vn=(zr&&Vi?"(":"")+vn+(zr&&Vi?")":""):Yi>=0?vn=Yi===0?(Vi?"-":"+")+vn:vn+(Vi?"-":"+"):Vi&&(vn="-"+vn),vn},stringToNumber:function(Ze){var it=ve[Xe.currentLocale],nr=Ze,jr={thousand:3,million:6,billion:9,trillion:12},zr,Fr,_t;if(Xe.zeroFormat&&Ze===Xe.zeroFormat)Fr=0;else if(Xe.nullFormat&&Ze===Xe.nullFormat||!Ze.replace(/[^0-9]+/g,"").length)Fr=null;else{Fr=1,it.delimiters.decimal!=="."&&(Ze=Ze.replace(/\./g,"").replace(it.delimiters.decimal,"."));for(zr in jr)if(_t=new RegExp("[^a-zA-Z]"+it.abbreviations[zr]+"(?:\\)|(\\"+it.currency.symbol+")?(?:\\))?)?$"),nr.match(_t)){Fr*=Math.pow(10,jr[zr]);break}Fr*=(Ze.split("-").length+Math.min(Ze.split("(").length-1,Ze.split(")").length-1))%2?1:-1,Ze=Ze.replace(/[^0-9\.]+/g,""),Fr*=Number(Ze)}return Fr},isNaN:function(Ze){return typeof Ze=="number"&&isNaN(Ze)},includes:function(Ze,it){return Ze.indexOf(it)!==-1},insert:function(Ze,it,nr){return Ze.slice(0,nr)+it+Ze.slice(nr)},reduce:function(Ze,it){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof it!="function")throw new TypeError(it+" is not a function");var nr=Object(Ze),jr=nr.length>>>0,zr=0,Fr;if(arguments.length===3)Fr=arguments[2];else{for(;zr<jr&&!(zr in nr);)zr++;if(zr>=jr)throw new TypeError("Reduce of empty array with no initial value");Fr=nr[zr++]}for(;zr<jr;zr++)zr in nr&&(Fr=it(Fr,nr[zr],zr,nr));return Fr},multiplier:function(Ze){var it=Ze.toString().split(".");return it.length<2?1:Math.pow(10,it[1].length)},correctionFactor:function(){var Ze=Array.prototype.slice.call(arguments);return Ze.reduce(function(it,nr){var jr=me.multiplier(nr);return it>jr?it:jr},1)},toFixed:function(Ze,it,nr,jr){var zr=Ze.toString().split("."),Fr=it-(jr||0),_t,ni,on,Gi;return zr.length===2?_t=Math.min(Math.max(zr[1].length,Fr),it):_t=Fr,on=Math.pow(10,_t),Gi=(nr(Ze+"e+"+_t)/on).toFixed(_t),jr>it-_t&&(ni=new RegExp("\\.?0{1,"+(jr-(it-_t))+"}$"),Gi=Gi.replace(ni,"")),Gi}},se.options=Xe,se.formats=Re,se.locales=ve,se.locale=function(Ze){return Ze&&(Xe.currentLocale=Ze.toLowerCase()),Xe.currentLocale},se.localeData=function(Ze){if(!Ze)return ve[Xe.currentLocale];if(Ze=Ze.toLowerCase(),!ve[Ze])throw new Error("Unknown locale : "+Ze);return ve[Ze]},se.reset=function(){for(var Ze in Fe)Xe[Ze]=Fe[Ze]},se.zeroFormat=function(Ze){Xe.zeroFormat=typeof Ze=="string"?Ze:null},se.nullFormat=function(Ze){Xe.nullFormat=typeof Ze=="string"?Ze:null},se.defaultFormat=function(Ze){Xe.defaultFormat=typeof Ze=="string"?Ze:"0.0"},se.register=function(Ze,it,nr){if(it=it.toLowerCase(),this[Ze+"s"][it])throw new TypeError(it+" "+Ze+" already registered.");return this[Ze+"s"][it]=nr,nr},se.validate=function(Ze,it){var nr,jr,zr,Fr,_t,ni,on,Gi;if(typeof Ze!="string"&&(Ze+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",Ze)),Ze=Ze.trim(),Ze.match(/^\d+$/))return!0;if(Ze==="")return!1;try{on=se.localeData(it)}catch{on=se.localeData(se.locale())}return zr=on.currency.symbol,_t=on.abbreviations,nr=on.delimiters.decimal,on.delimiters.thousands==="."?jr="\\.":jr=on.delimiters.thousands,Gi=Ze.match(/^[^\d]+/),Gi!==null&&(Ze=Ze.substr(1),Gi[0]!==zr)||(Gi=Ze.match(/[^\d]+$/),Gi!==null&&(Ze=Ze.slice(0,-1),Gi[0]!==_t.thousand&&Gi[0]!==_t.million&&Gi[0]!==_t.billion&&Gi[0]!==_t.trillion))?!1:(ni=new RegExp(jr+"{2}"),Ze.match(/[^\d.,]/g)?!1:(Fr=Ze.split(nr),Fr.length>2?!1:Fr.length<2?!!Fr[0].match(/^\d+.*\d$/)&&!Fr[0].match(ni):Fr[0].length===1?!!Fr[0].match(/^\d+$/)&&!Fr[0].match(ni)&&!!Fr[1].match(/^\d+$/):!!Fr[0].match(/^\d+.*\d$/)&&!Fr[0].match(ni)&&!!Fr[1].match(/^\d+$/)))},se.fn=tt.prototype={clone:function(){return se(this)},format:function(Ze,it){var nr=this._value,jr=Ze||Xe.defaultFormat,zr,Fr,_t;if(it=it||Math.round,nr===0&&Xe.zeroFormat!==null)Fr=Xe.zeroFormat;else if(nr===null&&Xe.nullFormat!==null)Fr=Xe.nullFormat;else{for(zr in Re)if(jr.match(Re[zr].regexps.format)){_t=Re[zr].format;break}_t=_t||se._.numberToFormat,Fr=_t(nr,jr,it)}return Fr},value:function(){return this._value},input:function(){return this._input},set:function(Ze){return this._value=Number(Ze),this},add:function(Ze){var it=me.correctionFactor.call(null,this._value,Ze);function nr(jr,zr,Fr,_t){return jr+Math.round(it*zr)}return this._value=me.reduce([this._value,Ze],nr,0)/it,this},subtract:function(Ze){var it=me.correctionFactor.call(null,this._value,Ze);function nr(jr,zr,Fr,_t){return jr-Math.round(it*zr)}return this._value=me.reduce([Ze],nr,Math.round(this._value*it))/it,this},multiply:function(Ze){function it(nr,jr,zr,Fr){var _t=me.correctionFactor(nr,jr);return Math.round(nr*_t)*Math.round(jr*_t)/Math.round(_t*_t)}return this._value=me.reduce([this._value,Ze],it,1),this},divide:function(Ze){function it(nr,jr,zr,Fr){var _t=me.correctionFactor(nr,jr);return Math.round(nr*_t)/Math.round(jr*_t)}return this._value=me.reduce([this._value,Ze],it),this},difference:function(Ze){return Math.abs(se(this._value).subtract(Ze).value())}},se.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(Ze){var it=Ze%10;return~~(Ze%100/10)===1?"th":it===1?"st":it===2?"nd":it===3?"rd":"th"},currency:{symbol:"$"}}),function(){se.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(Ze,it,nr){var jr=se._.includes(it," BPS")?" ":"",zr;return Ze=Ze*1e4,it=it.replace(/\s?BPS/,""),zr=se._.numberToFormat(Ze,it,nr),se._.includes(zr,")")?(zr=zr.split(""),zr.splice(-1,0,jr+"BPS"),zr=zr.join("")):zr=zr+jr+"BPS",zr},unformat:function(Ze){return+(se._.stringToNumber(Ze)*1e-4).toFixed(15)}})}(),function(){var Ze={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},it={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},nr=Ze.suffixes.concat(it.suffixes.filter(function(zr){return Ze.suffixes.indexOf(zr)<0})),jr=nr.join("|");jr="("+jr.replace("B","B(?!PS)")+")",se.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(jr)},format:function(zr,Fr,_t){var ni,on=se._.includes(Fr,"ib")?it:Ze,Gi=se._.includes(Fr," b")||se._.includes(Fr," ib")?" ":"",Qi,wi,li;for(Fr=Fr.replace(/\s?i?b/,""),Qi=0;Qi<=on.suffixes.length;Qi++)if(wi=Math.pow(on.base,Qi),li=Math.pow(on.base,Qi+1),zr===null||zr===0||zr>=wi&&zr<li){Gi+=on.suffixes[Qi],wi>0&&(zr=zr/wi);break}return ni=se._.numberToFormat(zr,Fr,_t),ni+Gi},unformat:function(zr){var Fr=se._.stringToNumber(zr),_t,ni;if(Fr){for(_t=Ze.suffixes.length-1;_t>=0;_t--){if(se._.includes(zr,Ze.suffixes[_t])){ni=Math.pow(Ze.base,_t);break}if(se._.includes(zr,it.suffixes[_t])){ni=Math.pow(it.base,_t);break}}Fr*=ni||1}return Fr}})}(),function(){se.register("format","currency",{regexps:{format:/(\$)/},format:function(Ze,it,nr){var jr=se.locales[se.options.currentLocale],zr={before:it.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:it.match(/([\+|\-|\)|\s|\$]*)$/)[0]},Fr,_t,ni;for(it=it.replace(/\s?\$\s?/,""),Fr=se._.numberToFormat(Ze,it,nr),Ze>=0?(zr.before=zr.before.replace(/[\-\(]/,""),zr.after=zr.after.replace(/[\-\)]/,"")):Ze<0&&!se._.includes(zr.before,"-")&&!se._.includes(zr.before,"(")&&(zr.before="-"+zr.before),ni=0;ni<zr.before.length;ni++)switch(_t=zr.before[ni],_t){case"$":Fr=se._.insert(Fr,jr.currency.symbol,ni);break;case" ":Fr=se._.insert(Fr," ",ni+jr.currency.symbol.length-1);break}for(ni=zr.after.length-1;ni>=0;ni--)switch(_t=zr.after[ni],_t){case"$":Fr=ni===zr.after.length-1?Fr+jr.currency.symbol:se._.insert(Fr,jr.currency.symbol,-(zr.after.length-(1+ni)));break;case" ":Fr=ni===zr.after.length-1?Fr+" ":se._.insert(Fr," ",-(zr.after.length-(1+ni)+jr.currency.symbol.length-1));break}return Fr}})}(),function(){se.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(Ze,it,nr){var jr,zr=typeof Ze=="number"&&!se._.isNaN(Ze)?Ze.toExponential():"0e+0",Fr=zr.split("e");return it=it.replace(/e[\+|\-]{1}0/,""),jr=se._.numberToFormat(Number(Fr[0]),it,nr),jr+"e"+Fr[1]},unformat:function(Ze){var it=se._.includes(Ze,"e+")?Ze.split("e+"):Ze.split("e-"),nr=Number(it[0]),jr=Number(it[1]);jr=se._.includes(Ze,"e-")?jr*=-1:jr;function zr(Fr,_t,ni,on){var Gi=se._.correctionFactor(Fr,_t),Qi=Fr*Gi*(_t*Gi)/(Gi*Gi);return Qi}return se._.reduce([nr,Math.pow(10,jr)],zr,1)}})}(),function(){se.register("format","ordinal",{regexps:{format:/(o)/},format:function(Ze,it,nr){var jr=se.locales[se.options.currentLocale],zr,Fr=se._.includes(it," o")?" ":"";return it=it.replace(/\s?o/,""),Fr+=jr.ordinal(Ze),zr=se._.numberToFormat(Ze,it,nr),zr+Fr}})}(),function(){se.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(Ze,it,nr){var jr=se._.includes(it," %")?" ":"",zr;return se.options.scalePercentBy100&&(Ze=Ze*100),it=it.replace(/\s?\%/,""),zr=se._.numberToFormat(Ze,it,nr),se._.includes(zr,")")?(zr=zr.split(""),zr.splice(-1,0,jr+"%"),zr=zr.join("")):zr=zr+jr+"%",zr},unformat:function(Ze){var it=se._.stringToNumber(Ze);return se.options.scalePercentBy100?it*.01:it}})}(),function(){se.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(Ze,it,nr){var jr=Math.floor(Ze/60/60),zr=Math.floor((Ze-jr*60*60)/60),Fr=Math.round(Ze-jr*60*60-zr*60);return jr+":"+(zr<10?"0"+zr:zr)+":"+(Fr<10?"0"+Fr:Fr)},unformat:function(Ze){var it=Ze.split(":"),nr=0;return it.length===3?(nr=nr+Number(it[0])*60*60,nr=nr+Number(it[1])*60,nr=nr+Number(it[2])):it.length===2&&(nr=nr+Number(it[0])*60,nr=nr+Number(it[1])),Number(nr)}})}(),se})})(Zf);var BO=Zf.exports;const VO={name:"Numeral",emits:["on-change"],props:{value:{type:[String,Number]},format:{type:String},prefix:{type:[String,Number]},suffix:{type:[String,Number]}},data(){return{currentValue:""}},watch:{value(){this.init()},format(){this.init()}},methods:{init(){if(this.value!==void 0){const K=BO(this.value);this.format?this.currentValue=K.format(this.format):this.currentValue=K.value(),this.$emit("on-change",this.currentValue)}},getValue(){return this.currentValue}},mounted(){this.init()}},DO={class:"ivu-numeral"};function $O(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("span",DO,[E.renderSlot(K.$slots,"prefix",{},()=>[E.createTextVNode(E.toDisplayString(me.prefix),1)]),E.createTextVNode(E.toDisplayString(Re.currentValue),1),E.renderSlot(K.$slots,"suffix",{},()=>[E.createTextVNode(E.toDisplayString(me.suffix),1)])])}var Jf=Y(VO,[["render",$O]]);const LO="ivu-select-group",FO={name:"OptionGroup",props:{label:{type:String,default:""}},provide(){return{OptionGroupInstance:this}},inject:["SelectInstance"],data(){return{prefixCls:LO,hidden:!1,id:gt(6),optionList:[]}},computed:{show(){return this.optionList.find(K=>K.proxy&&K.proxy.isShow)}}};function UO(K,se,me,Be,Re,ve){return E.withDirectives((E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass([Re.prefixCls+"-wrap"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-title"])},E.toDisplayString(me.label),3),E.createElementVNode("ul",null,[E.createElementVNode("li",{class:E.normalizeClass([Re.prefixCls]),ref:"options"},[E.renderSlot(K.$slots,"default")],2)])],2)),[[E.vShow,ve.show]])}var em=Y(FO,[["render",UO]]);const vh="ivu-page";function zO(K){return/^[1-9][0-9]*$/.test(K+"")}const WO={name:"PageOption",mixins:[Xn],components:{iSelect:Es,iOption:ss},emits:["on-size","on-page"],props:{pageSizeOpts:Array,showSizer:Boolean,showElevator:Boolean,current:Number,_current:Number,pageSize:Number,allPages:Number,isSmall:Boolean,placement:String,transfer:Boolean,disabled:Boolean,eventsEnabled:Boolean},data(){return{currentPageSize:this.pageSize}},watch:{pageSize(K){this.currentPageSize=K}},computed:{size(){return this.isSmall?"small":"default"},optsClasses(){return[`${vh}-options`]},sizerClasses(){return[`${vh}-options-sizer`]},ElevatorClasses(){return[`${vh}-options-elevator`]}},methods:{changeSize(){this.$emit("on-size",this.currentPageSize)},changePage(K){let se=K.target.value.trim(),me=0;if(zO(se)){if(se=Number(se),se!=this.current){const Be=this.allPages;se>Be?me=Be:me=se}}else me=1;me&&(this.$emit("on-page",me),K.target.value=me)}}},GO=["value","disabled"];function jO(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("i-option"),Xe=E.resolveComponent("i-select");return me.showSizer||me.showElevator?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.optsClasses)},[me.showSizer?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.sizerClasses)},[E.createVNode(Xe,{modelValue:Re.currentPageSize,"onUpdate:modelValue":se[0]||(se[0]=tt=>Re.currentPageSize=tt),size:ve.size,placement:me.placement,transfer:me.transfer,disabled:me.disabled,eventsEnabled:me.eventsEnabled,onOnChange:ve.changeSize},{default:E.withCtx(()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.pageSizeOpts,tt=>(E.openBlock(),E.createBlock(Fe,{key:tt,value:tt,style:{"text-align":"center"}},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(tt)+" "+E.toDisplayString(K.t("i.page.page")),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","size","placement","transfer","disabled","eventsEnabled","onOnChange"])],2)):E.createCommentVNode("",!0),me.showElevator?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass(ve.ElevatorClasses)},[E.createTextVNode(E.toDisplayString(K.t("i.page.goto"))+" ",1),E.createElementVNode("input",{type:"text",value:me._current,autocomplete:"off",spellcheck:"false",disabled:me.disabled,onKeyup:se[1]||(se[1]=E.withKeys((...tt)=>ve.changePage&&ve.changePage(...tt),["enter"]))},null,40,GO),E.createTextVNode(" "+E.toDisplayString(K.t("i.page.p")),1)],2)):E.createCommentVNode("",!0)],2)):E.createCommentVNode("",!0)}var HO=Y(WO,[["render",jO]]);const Os="ivu-page",XO={name:"Page",mixins:[Xn],components:{Options:HO},emits:["update:modelValue","on-change","on-prev","on-next","on-page-size-change"],props:{modelValue:{type:Number,default:1},total:{type:Number,default:0},pageSize:{type:Number,default:10},pageSizeOpts:{type:Array,default(){return[10,20,30,40]}},placement:{validator(K){return Ie(K,["top","bottom"])},default:"bottom"},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},size:{validator(K){return Ie(K,["small","default"])}},simple:{type:Boolean,default:!1},showTotal:{type:Boolean,default:!1},showElevator:{type:Boolean,default:!1},showSizer:{type:Boolean,default:!1},className:{type:String},styles:{type:Object},prevText:{type:String,default:""},nextText:{type:String,default:""},disabled:{type:Boolean,default:!1},eventsEnabled:{type:Boolean,default:!1}},data(){return{prefixCls:Os,currentPage:this.modelValue,currentPageSize:this.pageSize}},watch:{total(K){let se=Math.ceil(K/this.currentPageSize);se<this.currentPage&&(this.currentPage=se===0?1:se)},modelValue(K){this.currentPage=K},pageSize(K){this.currentPageSize=K}},computed:{isSmall(){return this.size==="small"},allPages(){const K=Math.ceil(this.total/this.currentPageSize);return K===0?1:K},simpleWrapClasses(){return[`${Os}`,`${Os}-simple`,{[`${this.className}`]:!!this.className}]},simplePagerClasses(){return`${Os}-simple-pager`},wrapClasses(){return[`${Os}`,{[`${this.className}`]:!!this.className,[`${Os}-with-disabled`]:this.disabled,mini:this.size==="small"}]},prevClasses(){return[`${Os}-prev`,{[`${Os}-disabled`]:this.currentPage===1||this.disabled,[`${Os}-custom-text`]:this.prevText!==""}]},nextClasses(){return[`${Os}-next`,{[`${Os}-disabled`]:this.currentPage===this.allPages||this.disabled,[`${Os}-custom-text`]:this.nextText!==""}]},firstPageClasses(){return[`${Os}-item`,{[`${Os}-item-active`]:this.currentPage===1}]},lastPageClasses(){return[`${Os}-item`,{[`${Os}-item-active`]:this.currentPage===this.allPages}]}},methods:{changePage(K){this.disabled||this.currentPage!=K&&(this.currentPage=K,this.$emit("update:modelValue",K),this.$emit("on-change",K))},prev(){if(this.disabled)return;const K=this.currentPage;if(K<=1)return!1;this.changePage(K-1),this.$emit("on-prev",K-1)},next(){if(this.disabled)return;const K=this.currentPage;if(K>=this.allPages)return!1;this.changePage(K+1),this.$emit("on-next",K+1)},fastPrev(){if(this.disabled)return;const K=this.currentPage-5;K>0?this.changePage(K):this.changePage(1)},fastNext(){if(this.disabled)return;const K=this.currentPage+5;K>this.allPages?this.changePage(this.allPages):this.changePage(K)},onSize(K){this.disabled||(this.currentPageSize=K,this.$emit("on-page-size-change",K),this.changePage(1))},onPage(K){this.disabled||this.changePage(K)},keyDown(K){const se=K.keyCode;se>=48&&se<=57||se>=96&&se<=105||se===8||se===37||se===39||K.preventDefault()},keyUp(K){const se=K.keyCode,me=parseInt(K.target.value);if(se===38)this.prev();else if(se===40)this.next();else if(se===13){let Be=1;me>this.allPages?Be=this.allPages:me<=0||!me?Be=1:Be=me,K.target.value=Be,this.changePage(Be)}}}},qO=["title"],QO=[E.createElementVNode("a",null,[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-back"})],-1)],YO=["title"],KO=["value","disabled"],ZO=E.createElementVNode("span",null,"/",-1),JO=["title"],eC=[E.createElementVNode("a",null,[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-forward"})],-1)],tC=["title"],rC={key:1,class:"ivu-icon ivu-icon-ios-arrow-back"},iC=[E.createElementVNode("a",null,"1",-1)],nC=["title"],sC=[E.createElementVNode("a",null,[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-back"}),E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-more"})],-1)],oC=["title"],aC=["title"],lC=["title"],cC=["title"],uC=["title"],hC=["title"],dC=["title"],pC=["title"],fC=[E.createElementVNode("a",null,[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-arrow-forward"}),E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-more"})],-1)],mC=["title"],gC=["title"],yC={key:1,class:"ivu-icon ivu-icon-ios-arrow-forward"};function _C(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Options");return me.simple?(E.openBlock(),E.createElementBlock("ul",{key:0,class:E.normalizeClass(ve.simpleWrapClasses),style:E.normalizeStyle(me.styles)},[E.createElementVNode("li",{title:K.t("i.page.prev"),class:E.normalizeClass(ve.prevClasses),onClick:se[0]||(se[0]=(...Xe)=>ve.prev&&ve.prev(...Xe))},QO,10,qO),E.createElementVNode("div",{class:E.normalizeClass(ve.simplePagerClasses),title:Re.currentPage+"/"+ve.allPages},[E.createElementVNode("input",{type:"text",value:Re.currentPage,autocomplete:"off",spellcheck:"false",disabled:me.disabled,onKeydown:se[1]||(se[1]=(...Xe)=>ve.keyDown&&ve.keyDown(...Xe)),onKeyup:se[2]||(se[2]=(...Xe)=>ve.keyUp&&ve.keyUp(...Xe)),onChange:se[3]||(se[3]=(...Xe)=>ve.keyUp&&ve.keyUp(...Xe))},null,40,KO),ZO,E.createTextVNode(" "+E.toDisplayString(ve.allPages),1)],10,YO),E.createElementVNode("li",{title:K.t("i.page.next"),class:E.normalizeClass(ve.nextClasses),onClick:se[4]||(se[4]=(...Xe)=>ve.next&&ve.next(...Xe))},eC,10,JO)],6)):(E.openBlock(),E.createElementBlock("ul",{key:1,class:E.normalizeClass(ve.wrapClasses),style:E.normalizeStyle(me.styles)},[me.showTotal?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass([Re.prefixCls+"-total"])},[E.renderSlot(K.$slots,"default",{},()=>[E.createTextVNode(E.toDisplayString(K.t("i.page.total"))+" "+E.toDisplayString(me.total)+" ",1),me.total<=1?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(K.t("i.page.item")),1)],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createTextVNode(E.toDisplayString(K.t("i.page.items")),1)],64))])],2)):E.createCommentVNode("",!0),E.createElementVNode("li",{title:K.t("i.page.prev"),class:E.normalizeClass(ve.prevClasses),onClick:se[5]||(se[5]=(...Xe)=>ve.prev&&ve.prev(...Xe))},[E.createElementVNode("a",null,[me.prevText!==""?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(me.prevText),1)],64)):(E.openBlock(),E.createElementBlock("i",rC))])],10,tC),E.createElementVNode("li",{title:"1",class:E.normalizeClass(ve.firstPageClasses),onClick:se[6]||(se[6]=Xe=>ve.changePage(1))},iC,2),Re.currentPage>5?(E.openBlock(),E.createElementBlock("li",{key:1,title:K.t("i.page.prev5"),class:E.normalizeClass([Re.prefixCls+"-item-jump-prev"]),onClick:se[7]||(se[7]=(...Xe)=>ve.fastPrev&&ve.fastPrev(...Xe))},sC,10,nC)):E.createCommentVNode("",!0),Re.currentPage===5?(E.openBlock(),E.createElementBlock("li",{key:2,title:Re.currentPage-3,class:E.normalizeClass([Re.prefixCls+"-item"]),onClick:se[8]||(se[8]=Xe=>ve.changePage(Re.currentPage-3))},[E.createElementVNode("a",null,E.toDisplayString(Re.currentPage-3),1)],10,oC)):E.createCommentVNode("",!0),Re.currentPage-2>1?(E.openBlock(),E.createElementBlock("li",{key:3,title:Re.currentPage-2,class:E.normalizeClass([Re.prefixCls+"-item"]),onClick:se[9]||(se[9]=Xe=>ve.changePage(Re.currentPage-2))},[E.createElementVNode("a",null,E.toDisplayString(Re.currentPage-2),1)],10,aC)):E.createCommentVNode("",!0),Re.currentPage-1>1?(E.openBlock(),E.createElementBlock("li",{key:4,title:Re.currentPage-1,class:E.normalizeClass([Re.prefixCls+"-item"]),onClick:se[10]||(se[10]=Xe=>ve.changePage(Re.currentPage-1))},[E.createElementVNode("a",null,E.toDisplayString(Re.currentPage-1),1)],10,lC)):E.createCommentVNode("",!0),Re.currentPage!=1&&Re.currentPage!=ve.allPages?(E.openBlock(),E.createElementBlock("li",{key:5,title:Re.currentPage,class:E.normalizeClass([Re.prefixCls+"-item",Re.prefixCls+"-item-active"])},[E.createElementVNode("a",null,E.toDisplayString(Re.currentPage),1)],10,cC)):E.createCommentVNode("",!0),Re.currentPage+1<ve.allPages?(E.openBlock(),E.createElementBlock("li",{key:6,title:Re.currentPage+1,class:E.normalizeClass([Re.prefixCls+"-item"]),onClick:se[11]||(se[11]=Xe=>ve.changePage(Re.currentPage+1))},[E.createElementVNode("a",null,E.toDisplayString(Re.currentPage+1),1)],10,uC)):E.createCommentVNode("",!0),Re.currentPage+2<ve.allPages?(E.openBlock(),E.createElementBlock("li",{key:7,title:Re.currentPage+2,class:E.normalizeClass([Re.prefixCls+"-item"]),onClick:se[12]||(se[12]=Xe=>ve.changePage(Re.currentPage+2))},[E.createElementVNode("a",null,E.toDisplayString(Re.currentPage+2),1)],10,hC)):E.createCommentVNode("",!0),ve.allPages-Re.currentPage===4?(E.openBlock(),E.createElementBlock("li",{key:8,title:Re.currentPage+3,class:E.normalizeClass([Re.prefixCls+"-item"]),onClick:se[13]||(se[13]=Xe=>ve.changePage(Re.currentPage+3))},[E.createElementVNode("a",null,E.toDisplayString(Re.currentPage+3),1)],10,dC)):E.createCommentVNode("",!0),ve.allPages-Re.currentPage>=5?(E.openBlock(),E.createElementBlock("li",{key:9,title:K.t("i.page.next5"),class:E.normalizeClass([Re.prefixCls+"-item-jump-next"]),onClick:se[14]||(se[14]=(...Xe)=>ve.fastNext&&ve.fastNext(...Xe))},fC,10,pC)):E.createCommentVNode("",!0),ve.allPages>1?(E.openBlock(),E.createElementBlock("li",{key:10,title:ve.allPages,class:E.normalizeClass(ve.lastPageClasses),onClick:se[15]||(se[15]=Xe=>ve.changePage(ve.allPages))},[E.createElementVNode("a",null,E.toDisplayString(ve.allPages),1)],10,mC)):E.createCommentVNode("",!0),E.createElementVNode("li",{title:K.t("i.page.next"),class:E.normalizeClass(ve.nextClasses),onClick:se[16]||(se[16]=(...Xe)=>ve.next&&ve.next(...Xe))},[E.createElementVNode("a",null,[me.nextText!==""?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(me.nextText),1)],64)):(E.openBlock(),E.createElementBlock("i",yC))])],10,gC),E.createVNode(Fe,{"show-sizer":me.showSizer,"page-size":Re.currentPageSize,"page-size-opts":me.pageSizeOpts,placement:me.placement,transfer:me.transfer,"show-elevator":me.showElevator,_current:Re.currentPage,current:Re.currentPage,disabled:me.disabled,"all-pages":ve.allPages,"is-small":ve.isSmall,eventsEnabled:me.eventsEnabled,onOnSize:ve.onSize,onOnPage:ve.onPage},null,8,["show-sizer","page-size","page-size-opts","placement","transfer","show-elevator","_current","current","disabled","all-pages","is-small","eventsEnabled","onOnSize","onOnPage"])],6))}var tm=Y(XO,[["render",_C]]);const vC={name:"PageHeader",components:{Breadcrumb:Eu,BreadcrumbItem:Au,Divider:mc,Icon:Ae,Tabs:eu,TabPane:iu},emits:["on-tab-change","on-back"],props:{title:{type:String},back:{type:Boolean,default:!1},logo:{type:String},action:{type:String},content:{type:String},extra:{type:String},breadcrumbList:{type:Array},hiddenBreadcrumb:{type:Boolean,default:!1},tabList:{type:Array},tabActiveKey:{type:String},wide:{type:Boolean,default:!1}},computed:{classes(){return{"ivu-page-header-wide":this.wide}}},methods:{handleTabChange(K){const se=this.tabList.find(me=>me.name===K);this.$emit("on-tab-change",JSON.parse(JSON.stringify(se)))},handleBack(){this.$emit("on-back")}}},bC={key:0,class:"ivu-page-header-breadcrumb"},xC={class:"ivu-page-header-detail"},SC={key:1,class:"ivu-page-header-logo"},wC=["src"],OC={class:"ivu-page-header-main"},CC={class:"ivu-page-header-row"},TC={key:1,class:"ivu-page-header-title"},EC={key:2,class:"ivu-page-header-action"},AC={class:"ivu-page-header-row"},MC={key:0,class:"ivu-page-header-content"},PC={key:1,class:"ivu-page-header-extra"},RC={key:1,class:"ivu-page-header-tabs"};function kC(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("BreadcrumbItem"),Xe=E.resolveComponent("Breadcrumb"),tt=E.resolveComponent("Icon"),Ze=E.resolveComponent("Divider"),it=E.resolveComponent("TabPane"),nr=E.resolveComponent("Tabs");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-page-header",ve.classes])},[K.$slots.breadcrumb||!me.hiddenBreadcrumb?(E.openBlock(),E.createElementBlock("div",bC,[E.renderSlot(K.$slots,"breadcrumb",{},()=>[E.createVNode(Xe,null,{default:E.withCtx(()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.breadcrumbList,(jr,zr)=>(E.openBlock(),E.createBlock(Fe,{key:zr,to:jr.to,replace:jr.replace,target:jr.target},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(jr.title),1)]),_:2},1032,["to","replace","target"]))),128))]),_:1})])])):E.createCommentVNode("",!0),E.createElementVNode("div",xC,[me.back||K.$slots.back?(E.openBlock(),E.createElementBlock("div",{key:0,class:"ivu-page-header-back",onClick:se[0]||(se[0]=(...jr)=>ve.handleBack&&ve.handleBack(...jr))},[E.renderSlot(K.$slots,"back",{},()=>[E.createVNode(tt,{type:"md-arrow-back"})]),E.createVNode(Ze,{type:"vertical"})])):E.createCommentVNode("",!0),me.logo||K.$slots.logo?(E.openBlock(),E.createElementBlock("div",SC,[E.renderSlot(K.$slots,"logo",{},()=>[E.createElementVNode("img",{src:me.logo},null,8,wC)])])):E.createCommentVNode("",!0),E.createElementVNode("div",OC,[E.createElementVNode("div",CC,[me.back||K.$slots.back?(E.openBlock(),E.createElementBlock("div",{key:0,class:"ivu-page-header-back",onClick:se[1]||(se[1]=(...jr)=>ve.handleBack&&ve.handleBack(...jr))},[E.renderSlot(K.$slots,"back",{},()=>[E.createVNode(tt,{type:"md-arrow-back"})]),E.createVNode(Ze,{type:"vertical"})])):E.createCommentVNode("",!0),me.title||K.$slots.title?(E.openBlock(),E.createElementBlock("div",TC,[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])])):E.createCommentVNode("",!0),me.action||K.$slots.action?(E.openBlock(),E.createElementBlock("div",EC,[E.renderSlot(K.$slots,"action",{},()=>[E.createTextVNode(E.toDisplayString(me.action),1)])])):E.createCommentVNode("",!0)]),E.createElementVNode("div",AC,[me.content||K.$slots.content?(E.openBlock(),E.createElementBlock("div",MC,[E.renderSlot(K.$slots,"content",{},()=>[E.createTextVNode(E.toDisplayString(me.content),1)])])):E.createCommentVNode("",!0),me.extra||K.$slots.extra?(E.openBlock(),E.createElementBlock("div",PC,[E.renderSlot(K.$slots,"extra",{},()=>[E.createTextVNode(E.toDisplayString(me.extra),1)])])):E.createCommentVNode("",!0)])])]),me.tabList&&me.tabList.length?(E.openBlock(),E.createElementBlock("div",RC,[E.createVNode(nr,{animated:!1,"model-value":me.tabActiveKey,onOnClick:ve.handleTabChange},{default:E.withCtx(()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.tabList,(jr,zr)=>(E.openBlock(),E.createBlock(it,{key:zr,label:jr.label,name:jr.name},null,8,["label","name"]))),128))]),_:1},8,["model-value","onOnClick"])])):E.createCommentVNode("",!0)],2)}var im=Y(vC,[["render",kC]]);const IC=E.defineComponent({name:"CollapseTransition",props:{ready:{type:Boolean,default:!0}},setup(K){return{on:{beforeEnter(se){!K.ready||(st(se,"collapse-transition"),se.dataset||(se.dataset={}),se.dataset.oldPaddingTop=se.style.paddingTop,se.dataset.oldPaddingBottom=se.style.paddingBottom,se.style.height="0",se.style.paddingTop=0,se.style.paddingBottom=0)},enter(se){!K.ready||(se.dataset.oldOverflow=se.style.overflow,se.scrollHeight!==0?(se.style.height=se.scrollHeight+"px",se.style.paddingTop=se.dataset.oldPaddingTop,se.style.paddingBottom=se.dataset.oldPaddingBottom):(se.style.height="",se.style.paddingTop=se.dataset.oldPaddingTop,se.style.paddingBottom=se.dataset.oldPaddingBottom),se.style.overflow="hidden")},afterEnter(se){!K.ready||(sr(se,"collapse-transition"),se.style.height="",se.style.overflow=se.dataset.oldOverflow)},beforeLeave(se){!K.ready||(se.dataset||(se.dataset={}),se.dataset.oldPaddingTop=se.style.paddingTop,se.dataset.oldPaddingBottom=se.style.paddingBottom,se.dataset.oldOverflow=se.style.overflow,se.style.height=se.scrollHeight+"px",se.style.overflow="hidden")},leave(se){!K.ready||se.scrollHeight!==0&&(st(se,"collapse-transition"),se.style.height=0,se.style.paddingTop=0,se.style.paddingBottom=0)},afterLeave(se){!K.ready||(sr(se,"collapse-transition"),se.style.height="",se.style.overflow=se.dataset.oldOverflow,se.style.paddingTop=se.dataset.oldPaddingTop,se.style.paddingBottom=se.dataset.oldPaddingBottom)}}}}});function BC(K,se,me,Be,Re,ve){return E.openBlock(),E.createBlock(E.Transition,E.toHandlers(K.on),{default:E.withCtx(()=>[E.renderSlot(K.$slots,"default")]),_:3},16)}var Sh=Y(IC,[["render",BC]]);const Dl="ivu-collapse",VC={name:"Panel",components:{Icon:Ae,CollapseTransition:Sh},inject:["CollapseInstance"],props:{name:{type:String},hideArrow:{type:Boolean,default:!1}},data(){return{index:0,mounted:!1}},computed:{itemClasses(){return[`${Dl}-item`,{[`${Dl}-item-active`]:this.isActive}]},headerClasses(){return`${Dl}-header`},contentClasses(){return`${Dl}-content`},boxClasses(){return`${Dl}-content-box`},isActive(){const K=this.CollapseInstance.getActiveKey(),se=this.name||this.index.toString();return K.indexOf(se)>-1}},methods:{setIndex(){this.index=this.CollapseInstance.panelCount+1,this.CollapseInstance.panelCount=this.index},toggle(){this.CollapseInstance.toggle({name:this.name||this.index,isActive:this.isActive})}},mounted(){this.setIndex(),this.mounted=!0}};function DC(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("collapse-transition");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.itemClasses)},[E.createElementVNode("div",{class:E.normalizeClass(ve.headerClasses),onClick:se[0]||(se[0]=(...tt)=>ve.toggle&&ve.toggle(...tt))},[me.hideArrow?E.createCommentVNode("",!0):(E.openBlock(),E.createBlock(Fe,{key:0,type:"ios-arrow-forward"})),E.renderSlot(K.$slots,"default")],2),Re.mounted?(E.openBlock(),E.createBlock(Xe,{key:0},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass(ve.contentClasses)},[E.createElementVNode("div",{class:E.normalizeClass(ve.boxClasses)},[E.renderSlot(K.$slots,"content")],2)],2),[[E.vShow,ve.isActive]])]),_:3})):E.createCommentVNode("",!0)],2)}var nm=Y(VC,[["render",DC]]);const sm={name:"Paragraph",mixins:[El],render(){return E.h(Yc,{...this.$props,component:"div",...this.commonEvents()},this.commonSlots())}},om={name:"Password",mixins:[hl],data(){return{className:"ivu-login-password",prefix:"ios-lock-outline",placeholder:"",type:"password"}}},Xo="ivu-poptip",NC={name:"Poptip",mixins:[rd,Xn],emits:["on-ok","on-cancel"],directives:{clickOutside:$u},components:{iButton:As},props:{trigger:{validator(K){return Ie(K,["click","focus","hover"])},default:"click"},placement:{validator(K){return Ie(K,["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"])},default:"top"},title:{type:[String,Number]},content:{type:[String,Number],default:""},width:{type:[String,Number]},confirm:{type:Boolean,default:!1},okText:{type:String},cancelText:{type:String},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}},popperClass:{type:String},wordWrap:{type:Boolean,default:!1},padding:{type:String},disabled:{type:Boolean,default:!1},capture:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return K.$VIEWUI?K.$VIEWUI.capture:!1}},transferClassName:{type:String}},data(){return{prefixCls:Xo,showTitle:!0,isInput:!1,disableCloseUnderTransfer:!1,tIndex:this.handleGetIndex()}},computed:{classes(){return[`${Xo}`,{[`${Xo}-confirm`]:this.confirm}]},popperClasses(){return[`${Xo}-popper`,{[`${Xo}-confirm`]:this.transfer&&this.confirm,[`${this.popperClass}`]:!!this.popperClass,[Xo+"-transfer"]:this.transfer,[this.transferClassName]:this.transferClassName}]},styles(){let K={};return this.width&&(K.width=`${this.width}px`),this.transfer&&(K["z-index"]=1060+this.tIndex),K},localeOkText(){return this.okText===void 0?this.t("i.poptip.okText"):this.okText},localeCancelText(){return this.cancelText===void 0?this.t("i.poptip.cancelText"):this.cancelText},contentClasses(){return[`${Xo}-body-content`,{[`${Xo}-body-content-word-wrap`]:this.wordWrap}]},contentPaddingStyle(){const K={};return this.padding!==""&&(K.padding=this.padding),K}},methods:{handleClick(){if(!this.disabled){if(this.confirm)return this.visible=!this.visible,!0;if(this.trigger!=="click")return!1;this.visible=!this.visible}},handleTransferClick(){this.transfer&&(this.disableCloseUnderTransfer=!0)},handleClose(){if(this.disableCloseUnderTransfer)return this.disableCloseUnderTransfer=!1,!1;if(this.confirm)return this.visible=!1,!0;if(this.trigger!=="click")return!1;this.visible=!1},handleFocus(K=!0){if(!this.disabled){if(this.trigger!=="focus"||this.confirm||this.isInput&&!K)return!1;this.visible=!0}},handleBlur(K=!0){if(this.trigger!=="focus"||this.confirm||this.isInput&&!K)return!1;this.visible=!1},handleMouseenter(){if(!this.disabled){if(this.trigger!=="hover"||this.confirm)return!1;this.enterTimer&&clearTimeout(this.enterTimer),this.enterTimer=setTimeout(()=>{this.visible=!0},100)}},handleMouseleave(){if(this.trigger!=="hover"||this.confirm)return!1;this.enterTimer&&(clearTimeout(this.enterTimer),this.enterTimer=setTimeout(()=>{this.visible=!1},100))},cancel(){this.visible=!1,this.$emit("on-cancel")},ok(){this.visible=!1,this.$emit("on-ok")},getInputChildren(){const K=this.$refs.reference.querySelectorAll("input"),se=this.$refs.reference.querySelectorAll("textarea");let me=null;return K.length?me=K[0]:se.length&&(me=se[0]),me},handleGetIndex(){return Ai(),ti},handleIndexIncrease(){this.tIndex=this.handleGetIndex()}},mounted(){this.confirm||(this.showTitle=this.$slots.title!==void 0||this.title),this.trigger==="focus"&&E.nextTick(()=>{const K=this.getInputChildren();K&&(this.isInput=!0,K.addEventListener("focus",this.handleFocus,!1),K.addEventListener("blur",this.handleBlur,!1))})},beforeUnmount(){const K=this.getInputChildren();K&&(K.removeEventListener("focus",this.handleFocus,!1),K.removeEventListener("blur",this.handleBlur,!1))}},$C=E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-help-circle"},null,-1);function LC(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("i-button"),Xe=E.resolveDirective("click-outside");return E.withDirectives((E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),onMouseenter:se[6]||(se[6]=(...tt)=>ve.handleMouseenter&&ve.handleMouseenter(...tt)),onMouseleave:se[7]||(se[7]=(...tt)=>ve.handleMouseleave&&ve.handleMouseleave(...tt))},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-rel"]),ref:"reference",onClick:se[0]||(se[0]=(...tt)=>ve.handleClick&&ve.handleClick(...tt)),onMousedown:se[1]||(se[1]=tt=>ve.handleFocus(!1)),onMouseup:se[2]||(se[2]=tt=>ve.handleBlur(!1))},[E.renderSlot(K.$slots,"default")],34),(E.openBlock(),E.createBlock(E.Teleport,{to:"body",disabled:!me.transfer},[E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass(ve.popperClasses),style:E.normalizeStyle(ve.styles),ref:"popper",onClick:se[3]||(se[3]=(...tt)=>ve.handleTransferClick&&ve.handleTransferClick(...tt)),onMouseenter:se[4]||(se[4]=(...tt)=>ve.handleMouseenter&&ve.handleMouseenter(...tt)),onMouseleave:se[5]||(se[5]=(...tt)=>ve.handleMouseleave&&ve.handleMouseleave(...tt))},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-content"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-arrow"])},null,2),me.confirm?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-inner"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"])},[$C,E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body-message"])},[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])],2)],2),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-footer"])},[E.createVNode(Fe,{type:"text",size:"small",onClick:ve.cancel},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ve.localeCancelText),1)]),_:1},8,["onClick"]),E.createVNode(Fe,{type:"primary",size:"small",onClick:ve.ok},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ve.localeOkText),1)]),_:1},8,["onClick"])],2)],2)):E.createCommentVNode("",!0),me.confirm?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass([Re.prefixCls+"-inner"])},[Re.showTitle?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-title"]),style:E.normalizeStyle(ve.contentPaddingStyle),ref:"title"},[E.renderSlot(K.$slots,"title",{},()=>[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-title-inner"])},E.toDisplayString(me.title),3)])],6)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"]),style:E.normalizeStyle(ve.contentPaddingStyle)},[E.createElementVNode("div",{class:E.normalizeClass(ve.contentClasses)},[E.renderSlot(K.$slots,"content",{},()=>[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body-content-inner"])},E.toDisplayString(me.content),3)])],2)],6)],2))],2)],38),[[E.vShow,K.visible]])]),_:3})],8,["disabled"]))],34)),[[Xe,ve.handleClose]])}var wh=Y(NC,[["render",LC]]);const wo="ivu-progress",FC={name:"Progress",components:{Icon:Ae},props:{percent:{type:Number,default:0},successPercent:{type:Number,default:0},status:{validator(K){return Ie(K,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1},strokeColor:{type:[String,Array]},textInside:{type:Boolean,default:!1}},data(){return{currentStatus:this.status}},computed:{isStatus(){return this.currentStatus==="wrong"||this.currentStatus==="success"},statusIcon(){let K="";switch(this.currentStatus){case"wrong":K="ios-close-circle";break;case"success":K="ios-checkmark-circle";break}return K},bgStyle(){const K=this.vertical?{height:`${this.percent}%`,width:`${this.strokeWidth}px`}:{width:`${this.percent}%`,height:`${this.strokeWidth}px`};return this.strokeColor&&(typeof this.strokeColor=="string"?K["background-color"]=this.strokeColor:K["background-image"]=`linear-gradient(to right, ${this.strokeColor[0]} 0%, ${this.strokeColor[1]} 100%)`),K},successBgStyle(){return this.vertical?{height:`${this.successPercent}%`,width:`${this.strokeWidth}px`}:{width:`${this.successPercent}%`,height:`${this.strokeWidth}px`}},wrapClasses(){return[`${wo}`,`${wo}-${this.currentStatus}`,{[`${wo}-show-info`]:!this.hideInfo&&!this.textInside,[`${wo}-vertical`]:this.vertical}]},textClasses(){return`${wo}-text`},textInnerClasses(){return`${wo}-text-inner`},outerClasses(){return`${wo}-outer`},innerClasses(){return`${wo}-inner`},bgClasses(){return`${wo}-bg`},successBgClasses(){return`${wo}-success-bg`}},created(){this.handleStatus()},methods:{handleStatus(K){K?(this.currentStatus="normal",this.$emit("on-status-change","normal")):parseInt(this.percent,10)===100&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent(K,se){K<se?this.handleStatus(!0):this.handleStatus()},status(K){this.currentStatus=K}}},UC={key:0,class:"ivu-progress-inner-text"};function zC(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[E.createElementVNode("div",{class:E.normalizeClass(ve.outerClasses)},[E.createElementVNode("div",{class:E.normalizeClass(ve.innerClasses)},[E.createElementVNode("div",{class:E.normalizeClass(ve.bgClasses),style:E.normalizeStyle(ve.bgStyle)},[me.textInside?(E.openBlock(),E.createElementBlock("div",UC,E.toDisplayString(me.percent)+"%",1)):E.createCommentVNode("",!0)],6),E.createElementVNode("div",{class:E.normalizeClass(ve.successBgClasses),style:E.normalizeStyle(ve.successBgStyle)},null,6)],2)],2),!me.hideInfo&&!me.textInside?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(ve.textClasses)},[E.renderSlot(K.$slots,"default",{},()=>[ve.isStatus?(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass(ve.textInnerClasses)},[E.createVNode(Fe,{type:ve.statusIcon},null,8,["type"])],2)):(E.openBlock(),E.createElementBlock("span",{key:1,class:E.normalizeClass(ve.textInnerClasses)},E.toDisplayString(me.percent)+"% ",3))])],2)):E.createCommentVNode("",!0)],2)}var su=Y(FC,[["render",zC]]);const Qo="ivu-rate",WC={name:"Rate",mixins:[Xn,In],emits:["update:modelValue","on-change"],props:{count:{type:Number,default:5},modelValue:{type:Number,default:0},allowHalf:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showText:{type:Boolean,default:!1},name:{type:String},clearable:{type:Boolean,default:!1},character:{type:String,default:""},icon:{type:String,default:""},customIcon:{type:String,default:""}},data(){const K=this.modelValue||0;return{prefixCls:Qo,hoverIndex:-1,isHover:!1,isHalf:this.allowHalf&&K.toString().indexOf(".")>=0,currentValue:K}},computed:{classes(){return[`${Qo}`,{[`${Qo}-disabled`]:this.itemDisabled}]},iconClasses(){return["ivu-icon",{[`ivu-icon-${this.icon}`]:this.icon!=="",[`${this.customIcon}`]:this.customIcon!==""}]},showCharacter(){return this.character!==""||this.icon!==""||this.customIcon!==""}},watch:{modelValue(K){this.currentValue=K||0},currentValue(K){this.setHalf(K)}},methods:{starCls(K){const se=this.hoverIndex,me=this.isHover?se:this.currentValue;let Be=!1,Re=!1;return me>=K&&(Be=!0),this.isHover?Re=me===K:Re=Math.ceil(this.currentValue)===K,[{[`${Qo}-star`]:!this.showCharacter,[`${Qo}-star-chart`]:this.showCharacter,[`${Qo}-star-full`]:!Re&&Be||Re&&!this.isHalf,[`${Qo}-star-half`]:Re&&this.isHalf,[`${Qo}-star-zero`]:!Be}]},handleMousemove(K,se){if(!this.itemDisabled){if(this.isHover=!0,this.allowHalf){const me=se.target.getAttribute("type")||!1;this.isHalf=me==="half"}else this.isHalf=!1;this.hoverIndex=K}},handleMouseleave(){this.itemDisabled||(this.isHover=!1,this.setHalf(this.currentValue),this.hoverIndex=-1)},setHalf(K){this.isHalf=this.allowHalf&&K.toString().indexOf(".")>=0},handleClick(K){this.itemDisabled||(this.isHalf&&(K-=.5),this.clearable&&Math.abs(K-this.currentValue)<.01&&(K=0),this.currentValue=K,this.$emit("update:modelValue",K),this.$emit("on-change",K),this.handleFormItemChange("change",K))}}},GC=["name","value"],jC=["onMousemove","onClick"],HC={key:0},XC={key:1};function qC(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),onMouseleave:se[0]||(se[0]=(...Fe)=>ve.handleMouseleave&&ve.handleMouseleave(...Fe))},[E.createElementVNode("input",{type:"hidden",name:me.name,value:Re.currentValue},null,8,GC),(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.count,Fe=>(E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.starCls(Fe)),onMousemove:Xe=>ve.handleMousemove(Fe,Xe),key:Fe,onClick:Xe=>ve.handleClick(Fe)},[ve.showCharacter?(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createElementVNode("span",{class:E.normalizeClass([Re.prefixCls+"-star-first"]),type:"half"},[me.character!==""?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(me.character),1)],64)):(E.openBlock(),E.createElementBlock("i",{key:1,class:E.normalizeClass(ve.iconClasses),type:"half"},null,2))],2),E.createElementVNode("span",{class:E.normalizeClass([Re.prefixCls+"-star-second"])},[me.character!==""?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createTextVNode(E.toDisplayString(me.character),1)],64)):(E.openBlock(),E.createElementBlock("i",{key:1,class:E.normalizeClass(ve.iconClasses)},null,2))],2)],64)):(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass([Re.prefixCls+"-star-content"]),type:"half"},null,2))],42,jC))),128)),me.showText?E.withDirectives((E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-text"])},[E.renderSlot(K.$slots,"default",{},()=>[E.createElementVNode("span",null,E.toDisplayString(Re.currentValue),1),E.createTextVNode(),Re.currentValue<=1?(E.openBlock(),E.createElementBlock("span",HC,E.toDisplayString(K.t("i.rate.star")),1)):(E.openBlock(),E.createElementBlock("span",XC,E.toDisplayString(K.t("i.rate.stars")),1))])],2)),[[E.vShow,Re.currentValue>0]]):E.createCommentVNode("",!0)],34)}var am=Y(WC,[["render",qC]]);const QC={name:"Result",components:{Icon:Ae},props:{type:{validator(K){return Ie(K,["success","error","warning"])}},title:{type:String},desc:{type:String},extra:{type:String}},computed:{iconClasses(){return{"ivu-result-icon-success":this.type==="success","ivu-result-icon-error":this.type==="error","ivu-result-icon-warning":this.type==="warning"}}}},YC={class:"ivu-result"},KC={key:0,class:"ivu-result-title"},ZC={key:1,class:"ivu-result-desc"},JC={key:2,class:"ivu-result-extra"},eT={key:3,class:"ivu-result-actions"};function tT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",YC,[E.createElementVNode("div",{class:E.normalizeClass(["ivu-result-icon",ve.iconClasses])},[me.type==="success"?(E.openBlock(),E.createBlock(Fe,{key:0,type:"ios-checkmark"})):E.createCommentVNode("",!0),me.type==="error"?(E.openBlock(),E.createBlock(Fe,{key:1,type:"ios-close"})):E.createCommentVNode("",!0),me.type==="warning"?(E.openBlock(),E.createBlock(Fe,{key:2,type:"ios-information"})):E.createCommentVNode("",!0)],2),me.title||K.$slots.title?(E.openBlock(),E.createElementBlock("div",KC,[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])])):E.createCommentVNode("",!0),me.desc||K.$slots.desc?(E.openBlock(),E.createElementBlock("div",ZC,[E.renderSlot(K.$slots,"desc",{},()=>[E.createTextVNode(E.toDisplayString(me.desc),1)])])):E.createCommentVNode("",!0),me.extra||K.$slots.extra?(E.openBlock(),E.createElementBlock("div",JC,[E.renderSlot(K.$slots,"extra",{},()=>[E.createTextVNode(E.toDisplayString(me.extra),1)])])):E.createCommentVNode("",!0),K.$slots.actions?(E.openBlock(),E.createElementBlock("div",eT,[E.renderSlot(K.$slots,"actions")])):E.createCommentVNode("",!0)])}var lm=Y(QC,[["render",tT]]);const Nl="ivu-scroll",rT={props:["text","active","spinnerHeight"],components:{Spin:Xs,Icon:Ae},computed:{wrapperClasses(){return[`${Nl}-loader-wrapper`,{[`${Nl}-loader-wrapper-active`]:this.active}]},spinnerClasses(){return`${Nl}-spinner`},iconClasses(){return`${Nl}-spinner-icon`},textClasses(){return`${Nl}-loader-text`}}};function iT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Spin");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapperClasses)},[E.createElementVNode("div",{class:E.normalizeClass(ve.spinnerClasses)},[E.createVNode(Xe,{fix:""},{default:E.withCtx(()=>[E.createVNode(Fe,{type:"ios-loading",size:"18",class:E.normalizeClass(ve.iconClasses)},null,8,["class"]),me.text?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.textClasses)},E.toDisplayString(me.text),3)):E.createCommentVNode("",!0)]),_:1})],2)],2)}var nT=Y(rT,[["render",iT]]);const za="ivu-scroll",cm={sensitivity:10,minimumStartDragOffset:5},Oh=()=>Promise.resolve(),sT={name:"Scroll",mixins:[Xn],components:{loader:nT},props:{height:{type:[Number,String],default:300},onReachTop:{type:Function},onReachBottom:{type:Function},onReachEdge:{type:Function},loadingText:{type:String},distanceToEdge:[Number,Array],stopSlide:{type:Boolean,default:!1}},data(){const K=this.calculateProximityThreshold();return{showTopLoader:!1,showBottomLoader:!1,showBodyLoader:!1,lastScroll:0,reachedTopScrollLimit:!0,reachedBottomScrollLimit:!1,topRubberPadding:0,bottomRubberPadding:0,rubberRollBackTimeout:!1,isLoading:!1,pointerTouchDown:null,touchScroll:!1,handleScroll:()=>{},pointerUpHandler:()=>{},pointerMoveHandler:()=>{},topProximityThreshold:K[0],bottomProximityThreshold:K[1]}},computed:{wrapClasses(){return`${za}-wrapper`},scrollContainerClasses(){return[`${za}-container`,{[`${za}-container-loading`]:this.showBodyLoader&&this.stopSlide}]},slotContainerClasses(){return[`${za}-content`,{[`${za}-content-loading`]:this.showBodyLoader}]},loaderClasses(){return`${za}-loader`},wrapperPadding(){return{paddingTop:this.topRubberPadding+"px",paddingBottom:this.bottomRubberPadding+"px"}},localeLoadingText(){return this.loadingText===void 0?this.t("i.select.loading"):this.loadingText}},methods:{waitOneSecond(){return new Promise(K=>{setTimeout(K,1e3)})},calculateProximityThreshold(){const K=this.distanceToEdge;return typeof K>"u"?[20,20]:Array.isArray(K)?K:[K,K]},onCallback(K){if(this.isLoading=!0,this.showBodyLoader=!0,K>0)this.showTopLoader=!0,this.topRubberPadding=20;else{this.showBottomLoader=!0,this.bottomRubberPadding=20;let Be=0;const Re=this.$refs.scrollContainer,ve=Re.scrollTop;for(let Fe=0;Fe<20;Fe++)setTimeout(()=>{Be=Math.max(Be,this.$refs.bottomLoader.getBoundingClientRect().height),Re.scrollTop=ve+Be},Fe*50)}const se=[this.waitOneSecond(),this.onReachEdge?this.onReachEdge(K):Oh()];se.push(K>0?this.onReachTop?this.onReachTop():Oh():this.onReachBottom?this.onReachBottom():Oh());let me=setTimeout(()=>{this.reset()},5e3);Promise.all(se).then(()=>{clearTimeout(me),this.reset()})},reset(){["showTopLoader","showBottomLoader","showBodyLoader","isLoading","reachedTopScrollLimit","reachedBottomScrollLimit"].forEach(K=>this[K]=!1),this.lastScroll=0,this.topRubberPadding=0,this.bottomRubberPadding=0,clearInterval(this.rubberRollBackTimeout),this.touchScroll&&setTimeout(()=>{q(window,"touchend",this.pointerUpHandler),this.$refs.scrollContainer.removeEventListener("touchmove",this.pointerMoveHandler),this.touchScroll=!1},500)},onWheel(K){if(this.isLoading)return;const se=K.wheelDelta?K.wheelDelta:-(K.detail||K.deltaY);this.stretchEdge(se)},stretchEdge(K){if(clearTimeout(this.rubberRollBackTimeout),!this.onReachEdge){if(K>0){if(!this.onReachTop)return}else if(!this.onReachBottom)return}this.rubberRollBackTimeout=setTimeout(()=>{this.isLoading||this.reset()},250),K>0&&this.reachedTopScrollLimit?(this.topRubberPadding+=5-this.topRubberPadding/5,this.topRubberPadding>this.topProximityThreshold&&this.onCallback(1)):K<0&&this.reachedBottomScrollLimit?(this.bottomRubberPadding+=6-this.bottomRubberPadding/4,this.bottomRubberPadding>this.bottomProximityThreshold&&this.onCallback(-1)):this.onScroll()},onScroll(){const K=this.$refs.scrollContainer;if(this.isLoading||!K)return;const se=Math.sign(this.lastScroll-K.scrollTop),me=K.scrollHeight-K.clientHeight-K.scrollTop,Be=this.topProximityThreshold<0?this.topProximityThreshold:0,Re=this.bottomProximityThreshold<0?this.bottomProximityThreshold:0;se==-1&&me+Re<=cm.sensitivity?this.reachedBottomScrollLimit=!0:se>=0&&K.scrollTop+Be<=0?this.reachedTopScrollLimit=!0:(this.reachedTopScrollLimit=!1,this.reachedBottomScrollLimit=!1,this.lastScroll=K.scrollTop)},getTouchCoordinates(K){return{x:K.touches[0].pageX,y:K.touches[0].pageY}},onPointerDown(K){if(!this.isLoading){if(K.type=="touchstart"){const se=this.$refs.scrollContainer;this.reachedTopScrollLimit?se.scrollTop=5:this.reachedBottomScrollLimit&&(se.scrollTop-=5)}K.type=="touchstart"&&this.$refs.scrollContainer.scrollTop==0&&(this.$refs.scrollContainer.scrollTop=5),this.pointerTouchDown=this.getTouchCoordinates(K),X(window,"touchend",this.pointerUpHandler),this.$refs.scrollContainer.parentElement.addEventListener("touchmove",se=>{se.stopPropagation(),this.pointerMoveHandler(se)},{passive:!1,useCapture:!0})}},onPointerMove(K){if(!this.pointerTouchDown||this.isLoading)return;const se=this.getTouchCoordinates(K).y-this.pointerTouchDown.y;this.stretchEdge(se),this.touchScroll||Math.abs(se)>cm.minimumStartDragOffset&&(this.touchScroll=!0)},onPointerUp(){this.pointerTouchDown=null}},created(){this.handleScroll=Wc(this.onScroll,150,{leading:!1}),this.pointerUpHandler=this.onPointerUp.bind(this),this.pointerMoveHandler=Wc(this.onPointerMove,50,{leading:!1})}};function oT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("loader");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses),style:{"touch-action":"none"}},[E.createElementVNode("div",{class:E.normalizeClass(ve.scrollContainerClasses),style:E.normalizeStyle({height:me.height+"px"}),onScroll:se[0]||(se[0]=(...Xe)=>Re.handleScroll&&Re.handleScroll(...Xe)),onWheel:se[1]||(se[1]=(...Xe)=>ve.onWheel&&ve.onWheel(...Xe)),onTouchstart:se[2]||(se[2]=(...Xe)=>ve.onPointerDown&&ve.onPointerDown(...Xe)),ref:"scrollContainer"},[E.createElementVNode("div",{class:E.normalizeClass(ve.loaderClasses),style:E.normalizeStyle({paddingTop:ve.wrapperPadding.paddingTop}),ref:"toploader"},[E.createVNode(Fe,{text:ve.localeLoadingText,active:Re.showTopLoader},null,8,["text","active"])],6),E.createElementVNode("div",{class:E.normalizeClass(ve.slotContainerClasses),ref:"scrollContent"},[E.renderSlot(K.$slots,"default")],2),E.createElementVNode("div",{class:E.normalizeClass(ve.loaderClasses),style:E.normalizeStyle({paddingBottom:ve.wrapperPadding.paddingBottom}),ref:"bottomLoader"},[E.createVNode(Fe,{text:ve.localeLoadingText,active:Re.showBottomLoader},null,8,["text","active"])],6)],38)],2)}var um=Y(sT,[["render",oT]]);const aT="COMPLETE",hm="CANCELED";function lT(K){if(W&&"requestAnimationFrame"in window)return window.requestAnimationFrame(K);setTimeout(K,16)}function dm(K,se,me){K===window?K.scrollTo(se,me):(K.scrollLeft=se,K.scrollTop=me)}function cT(K,se,me){if(!W)return;let Be=K.getBoundingClientRect(),Re=null,ve=null,Fe=null,Xe=null,tt=null,Ze=null,it=null,nr=me&&me.left!=null?me.left:.5,jr=me&&me.top!=null?me.top:.5,zr=me&&me.leftOffset!=null?me.leftOffset:0,Fr=me&&me.topOffset!=null?me.topOffset:0,_t=nr,ni=jr;if(se===window)Ze=Math.min(Be.width,window.innerWidth),it=Math.min(Be.height,window.innerHeight),ve=Be.left+window.pageXOffset-window.innerWidth*_t+Ze*_t,Fe=Be.top+window.pageYOffset-window.innerHeight*ni+it*ni,ve-=zr,Fe-=Fr,Xe=ve-window.pageXOffset,tt=Fe-window.pageYOffset;else{Ze=Be.width,it=Be.height,Re=se.getBoundingClientRect();let on=Be.left-(Re.left-se.scrollLeft),Gi=Be.top-(Re.top-se.scrollTop);ve=on+Ze*_t-se.clientWidth*_t,Fe=Gi+it*ni-se.clientHeight*ni,ve=Math.max(Math.min(ve,se.scrollWidth-se.clientWidth),0),Fe=Math.max(Math.min(Fe,se.scrollHeight-se.clientHeight),0),ve-=zr,Fe-=Fr,Xe=ve-se.scrollLeft,tt=Fe-se.scrollTop}return{x:ve,y:Fe,differenceX:Xe,differenceY:tt}}function pm(K){lT(function(){let se=K.scrollOption;if(!se)return;let me=cT(se.target,K,se.align),Be=Date.now()-se.startTime,Re=Math.min(1/se.time*Be,1);if(Be>se.time+20)return dm(K,me.x,me.y),K.scrollOption=null,se.end(aT);let ve=1-se.ease(Re);dm(K,me.x-me.differenceX*ve,me.y-me.differenceY*ve),pm(K)})}function uT(K,se,me,Be){let Re=!se.scrollOption,ve=se.scrollOption,Fe=Date.now(),Xe;ve&&ve.end(hm);function tt(Ze){se.scrollOption=null,se.parentElement&&se.parentElement.scrollOption&&se.parentElement.scrollOption.end(Ze),Be(Ze),se.removeEventListener("touchstart",Xe)}se.scrollOption={startTime:ve?ve.startTime:Date.now(),target:K,time:me.time+(ve?Fe-ve.startTime:0),ease:me.ease,align:me.align,end:tt},Xe=tt.bind(null,hm),se.addEventListener("touchstart",Xe),Re&&pm(se)}function fm(K){if(W)return K===window||(K.scrollHeight!==K.clientHeight||K.scrollWidth!==K.clientWidth)&&getComputedStyle(K).overflow!=="hidden"}function hT(){return!0}function Eh(K,se,me){if(!K)return;typeof se=="function"&&(me=se,se=null),se||(se={}),se.time=isNaN(se.time)?1e3:se.time,se.ease=se.ease||function(tt){return 1-Math.pow(1-tt,tt/2)};let Be=K.parentElement,Re=0;function ve(tt){Re-=1,!Re&&me&&me(tt)}let Fe=se.validTarget||hT,Xe=se.isScrollable;for(;Be;){if(Fe(Be,Re)&&(Xe?Xe(Be,fm):fm(Be))&&(Re+=1,uT(K,Be,se,ve)),Be=Be.parentElement,!Be)return;Be.tagName==="BODY"&&(Be=window)}}function dT(K){if(W&&"requestAnimationFrame"in window)return window.requestAnimationFrame(K);setTimeout(K,16)}function Ah(K,se,me){if(!K)return;typeof se=="function"&&(me=se,se=null),se||(se={}),se.time=isNaN(se.time)?500:se.time;const Be=K.scrollTop,Re=se.to||0,ve=Math.abs(Be-Re),Fe=Math.ceil(ve/se.time*50);function Xe(tt,Ze,it){if(tt===Ze){me&&me();return}let nr=tt+it>Ze?Ze:tt+it;tt>Ze&&(nr=tt-it<Ze?Ze:tt-it),K.scrollTop=nr,dT(()=>Xe(nr,Ze,it))}Xe(Be,Re,Fe)}const Ro="ivu-layout-sider";Tr();const pT={name:"Sider",emits:["on-collapse","update:modelValue"],props:{modelValue:{type:Boolean,default:!1},width:{type:[Number,String],default:200},collapsedWidth:{type:[Number,String],default:64},hideTrigger:{type:Boolean,default:!1},breakpoint:{type:String,validator(K){return Ie(K,["xs","sm","md","lg","xl","xxl"])}},collapsible:{type:Boolean,default:!1},defaultCollapsed:{type:Boolean,default:!1},reverseArrow:{type:Boolean,default:!1}},data(){return{prefixCls:Ro,mediaMatched:!1}},computed:{wrapClasses(){return[`${Ro}`,this.siderWidth?"":`${Ro}-zero-width`,this.modelValue?`${Ro}-collapsed`:""]},wrapStyles(){return{width:`${this.siderWidth}px`,minWidth:`${this.siderWidth}px`,maxWidth:`${this.siderWidth}px`,flex:`0 0 ${this.siderWidth}px`}},triggerClasses(){return[`${Ro}-trigger`,this.modelValue?`${Ro}-trigger-collapsed`:""]},childClasses(){return`${this.prefixCls}-children`},zeroWidthTriggerClasses(){return[`${Ro}-zero-width-trigger`,this.reverseArrow?`${Ro}-zero-width-trigger-left`:""]},triggerIconClasses(){return["ivu-icon",`ivu-icon-ios-arrow-${this.reverseArrow?"forward":"back"}`,`${Ro}-trigger-icon`]},siderWidth(){return this.collapsible?this.modelValue?this.mediaMatched?0:parseInt(this.collapsedWidth):parseInt(this.width):this.width},showZeroTrigger(){return this.collapsible?this.mediaMatched&&!this.hideTrigger||parseInt(this.collapsedWidth)===0&&this.modelValue&&!this.hideTrigger:!1},showBottomTrigger(){return this.collapsible?!this.mediaMatched&&!this.hideTrigger:!1}},methods:{toggleCollapse(){let K=this.collapsible?!this.modelValue:!1;this.$emit("update:modelValue",K)},matchMedia(){if(!W)return;let K;window.matchMedia&&(K=window.matchMedia);let se=this.mediaMatched;this.mediaMatched=K(`(max-width: ${mt[this.breakpoint]})`).matches,this.mediaMatched!==se&&this.$emit("update:modelValue",this.mediaMatched)},onWindowResize(){this.matchMedia()}},watch:{modelValue(K){this.$emit("on-collapse",K)}},mounted(){this.defaultCollapsed&&this.$emit("update:modelValue",this.defaultCollapsed),this.breakpoint!==void 0&&(X(window,"resize",this.onWindowResize),this.matchMedia())},beforeUnmount(){this.breakpoint!==void 0&&q(window,"resize",this.onWindowResize)}},fT=[E.createElementVNode("i",{class:"ivu-icon ivu-icon-ios-menu"},null,-1)];function mT(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses),style:E.normalizeStyle(ve.wrapStyles)},[E.withDirectives(E.createElementVNode("span",{onClick:se[0]||(se[0]=(...Fe)=>ve.toggleCollapse&&ve.toggleCollapse(...Fe)),class:E.normalizeClass(ve.zeroWidthTriggerClasses)},fT,2),[[E.vShow,ve.showZeroTrigger]]),E.createElementVNode("div",{class:E.normalizeClass(ve.childClasses)},[E.renderSlot(K.$slots,"default")],2),E.renderSlot(K.$slots,"trigger",{},()=>[E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass(ve.triggerClasses),onClick:se[1]||(se[1]=(...Fe)=>ve.toggleCollapse&&ve.toggleCollapse(...Fe)),style:E.normalizeStyle({width:ve.siderWidth+"px"})},[E.createElementVNode("i",{class:E.normalizeClass(ve.triggerIconClasses)},null,2)],6),[[E.vShow,ve.showBottomTrigger]])])],6)}var mm=Y(pT,[["render",mT]]);const Yo="ivu-skeleton-item",gT={name:"SkeletonItem",components:{Icon:Ae},inject:{SkeletonInstance:{default:null}},props:{animated:{type:Boolean,default:!1},type:{validator(K){return Ie(K,["circle","square","rect","image"])},default:"rect"},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},width:{type:[String,Number]},height:{type:[String,Number]},block:{type:Boolean,default:!1},imgSrc:{type:String}},data(){return{prefixCls:Yo}},computed:{classes(){return[Yo,Yo+"-"+this.type,Yo+"-"+this.type+"-"+this.size,{[Yo+"-animated"]:this.animated||!!this.SkeletonInstance&&this.SkeletonInstance.animated,[Yo+"-inline"]:!this.block,[Yo+"-with-image"]:this.showImage,[Yo+"-round"]:!!this.SkeletonInstance&&this.SkeletonInstance.round}]},styles(){const K={};return["rect","image"].includes(this.type)&&(this.width&&(K.width=typeof this.width=="number"?`${this.width}px`:this.width),this.height&&(K.height=typeof this.height=="number"?`${this.height}px`:this.height),this.showImage&&(K.background=`no-repeat url(${this.imgSrc}) center center`,K.backgroundSize="contain")),K},showIcon(){return this.type==="image"&&!this.imgSrc},showImage(){return this.type==="image"&&!!this.imgSrc},iconSize(){let K=16;return this.size==="large"&&(K=32),this.size==="small"&&(K=10),K}}};function yT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(ve.styles)},[ve.showIcon?(E.openBlock(),E.createBlock(Fe,{key:0,class:E.normalizeClass(Re.prefixCls+"-image-icon"),type:"ios-image",size:ve.iconSize},null,8,["class","size"])):E.createCommentVNode("",!0)],6)}var Mh=Y(gT,[["render",yT]]);const fa="ivu-skeleton",_T={name:"Skeleton",components:{SkeletonItem:Mh,Row:Lo,Col:vo},provide(){return{SkeletonInstance:this}},props:{animated:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},round:{type:Boolean,default:!1},paragraph:{validator(K){return typeof K=="number"?K>=1:typeof K.rows=="number"&&K.rows>=1},type:[Number,Object],default:3},title:{validator(K){return typeof K=="object"&&K.width?["number","string"].includes(typeof K.width):!0},type:[Boolean,Object],default:!0},avatar:{validator(K){if(typeof K=="object"){if(K.type)return Ie(K.type,["circle","square"]);if(K.size)return Ie(K.size,["small","large","default"])}return!0},type:[Boolean,Object],default:!1}},data(){return{prefixCls:fa}},computed:{classes(){return[fa,{[fa+"-with-title"]:this.showTitle,[fa+"-with-avatar"]:this.showAvatar}]},rows(){return typeof this.paragraph=="number"?this.paragraph:this.paragraph.rows},rowsCount(){return this.rows+Number(this.showTitle)},showTitle(){return!!this.title},titleWidth(){return typeof this.title=="object"&&this.title.width?typeof this.title.width=="string"?this.title.width:`${this.title.width}px`:""},showAvatar(){return!!this.avatar},avatarType(){return typeof this.avatar=="object"&&this.avatar.type?this.avatar.type:"circle"},avatarSize(){return typeof this.avatar=="object"&&this.avatar.size?this.avatar.size:!this.$VIEWUI||this.$VIEWUI.size===""?"default":this.$VIEWUI.size}},methods:{rowClasses(K){return[fa+"-item-inner",{[fa+"-item-round"]:this.round,[fa+"-item-title"]:this.showTitle&&K===1}]},rowWidth(K){if(this.showTitle&&K===1)return this.titleWidth||"38%";if(typeof this.paragraph=="object"){if(typeof this.paragraph.width=="string")return this.paragraph.width;if(typeof this.paragraph.width=="number")return`${this.paragraph.width}px`;const se=K-1-Number(this.showTitle);if(Array.isArray(this.paragraph.width)&&this.paragraph.width[se])return typeof this.paragraph.width[se]=="number"?`${this.paragraph.width[se]}px`:this.paragraph.width[se]}return K===this.rowsCount?"62%":"100%"}}};function vT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("SkeletonItem"),Xe=E.resolveComponent("Col"),tt=E.resolveComponent("Row");return me.loading?(E.openBlock(),E.createElementBlock("div",E.mergeProps({key:0},K.$attrs,{class:ve.classes}),[me.loading?E.renderSlot(K.$slots,"template",{key:0},()=>[E.createVNode(tt,null,{default:E.withCtx(()=>[ve.showAvatar?(E.openBlock(),E.createBlock(Xe,{key:0,flex:"0"},{default:E.withCtx(()=>[E.createVNode(Fe,{type:ve.avatarType,size:ve.avatarSize,animated:me.animated,class:E.normalizeClass(Re.prefixCls+"-item-avatar")},null,8,["type","size","animated","class"])]),_:1})):E.createCommentVNode("",!0),E.createVNode(Xe,{flex:"1"},{default:E.withCtx(()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.rowsCount,Ze=>(E.openBlock(),E.createBlock(Fe,{key:Ze,class:E.normalizeClass(ve.rowClasses(Ze)),animated:me.animated,width:ve.rowWidth(Ze),block:""},null,8,["class","animated","width"]))),128))]),_:1})]),_:1})]):E.createCommentVNode("",!0)],16)):E.renderSlot(K.$slots,"default",E.normalizeProps(E.mergeProps({key:1},K.$attrs)))}var gm=Y(_T,[["render",vT]]),bT={name:"SliderMarker",props:{mark:{type:[String,Object]}},render(){let K=typeof this.mark=="string"?this.mark:[this.mark.label];return E.h("div",{class:"ivu-slider-marks-item",style:this.mark.style||{}},K)}};const ko="ivu-slider",xT={name:"Slider",mixins:[In],emits:["update:modelValue","on-input","on-change"],components:{InputNumber:ch,Tooltip:To,SliderMarker:bT},inject:{ModalInstance:{default:null},DrawerInstance:{default:null}},props:{min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:0},disabled:{type:Boolean,default:!1},showInput:{type:Boolean,default:!1},inputSize:{type:String,default:"default",validator(K){return Ie(K,["small","large","default"])}},showStops:{type:Boolean,default:!1},tipFormat:{type:Function,default(K){return K}},showTip:{type:String,default:"hover",validator(K){return Ie(K,["hover","always","never"])}},name:{type:String},activeChange:{type:Boolean,default:!0},marks:{type:Object}},data(){let K=this.checkLimits(Array.isArray(this.modelValue)?this.modelValue:[this.modelValue]);return this.range&&this.modelValue===null&&(K=[0,0]),{prefixCls:ko,currentValue:K,dragging:!1,pointerDown:"",startX:0,currentX:0,startPos:0,oldValue:[...K],valueIndex:{min:0,max:1},sliderWidth:0,isValueNull:!1,id:gt(6)}},watch:{modelValue(K){K===null&&(this.isValueNull=!0),K=this.checkLimits(Array.isArray(K)?K:[K]),!this.dragging&&(K[0]!==this.currentValue[0]||K[1]!==this.currentValue[1])&&(this.isValueNull&&this.range?this.currentValue=[0,0]:this.currentValue=K)},exportValue(K){E.nextTick(()=>{this.$refs.minTooltip.updatePopper(),this.range&&this.$refs.maxTooltip.updatePopper()});const se=this.range?K:K[0];this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",se),this.$emit("on-input",se)}},computed:{classes(){return[`${ko}`,{[`${ko}-input`]:this.showInput&&!this.range,[`${ko}-range`]:this.range,[`${ko}-disabled`]:this.itemDisabled}]},minButtonClasses(){return[`${ko}-button`,{[`${ko}-button-dragging`]:this.pointerDown==="min"}]},maxButtonClasses(){return[`${ko}-button`,{[`${ko}-button-dragging`]:this.pointerDown==="max"}]},exportValue(){const K=(String(this.step).split(".")[1]||"").length;return this.currentValue.map(se=>Number(se.toFixed(K)))},minPosition(){return(this.currentValue[0]-this.min)/this.valueRange*100},maxPosition:function(){return(this.currentValue[1]-this.min)/this.valueRange*100},barStyle(){const K={width:(this.currentValue[0]-this.min)/this.valueRange*100+"%"};return this.range&&(K.left=(this.currentValue[0]-this.min)/this.valueRange*100+"%",K.width=(this.currentValue[1]-this.currentValue[0])/this.valueRange*100+"%"),K},stops(){let K=this.valueRange/this.step,se=[],me=100*this.step/this.valueRange;for(let Be=1;Be<K;Be++)se.push(Be*me);return se},markList(){return this.marks?Object.keys(this.marks).map(parseFloat).sort((K,se)=>K-se).filter(K=>K<=this.max&&K>=this.min).map(K=>({point:K,position:(K-this.min)*100/(this.max-this.min),mark:this.marks[K]})):[]},tipDisabled(){return this.tipFormat(this.currentValue[0])===null||this.showTip==="never"},valueRange(){return this.max-this.min},firstPosition(){return this.currentValue[0]},secondPosition(){return this.currentValue[1]}},methods:{getPointerX(K){return K.type.indexOf("touch")!==-1?K.touches[0].clientX:K.clientX},checkLimits([K,se]){return K=Math.max(this.min,K),K=Math.min(this.max,K),se=Math.max(this.min,K,se),se=Math.min(this.max,se),[K,se]},getCurrentValue(K,se){if(this.itemDisabled)return;const me=this.valueIndex[se];if(typeof me<"u")return this.currentValue[me]},onKeyLeft(K,se){const me=this.getCurrentValue(K,se);Number.isFinite(me)&&this.changeButtonPosition(me-this.step,se)},onKeyRight(K,se){const me=this.getCurrentValue(K,se);Number.isFinite(me)&&this.changeButtonPosition(me+this.step,se)},onPointerDown(K,se){this.itemDisabled||(K.preventDefault(),this.pointerDown=se,this.onPointerDragStart(K),X(window,"mousemove",this.onPointerDrag),X(window,"touchmove",this.onPointerDrag),X(window,"mouseup",this.onPointerDragEnd),X(window,"touchend",this.onPointerDragEnd))},onPointerDragStart(K){this.dragging=!1,this.startX=this.getPointerX(K),this.startPos=this[`${this.pointerDown}Position`]*this.valueRange/100+this.min},onPointerDrag(K){this.dragging=!0,this.$refs[`${this.pointerDown}Tooltip`].visible=!0,this.currentX=this.getPointerX(K);const se=(this.currentX-this.startX)/this.sliderWidth*this.valueRange;this.changeButtonPosition(this.startPos+se)},onPointerDragEnd(){this.dragging&&(this.dragging=!1,this.$refs[`${this.pointerDown}Tooltip`].visible=!1,this.emitChange()),this.pointerDown="",q(window,"mousemove",this.onPointerDrag),q(window,"touchmove",this.onPointerDrag),q(window,"mouseup",this.onPointerDragEnd),q(window,"touchend",this.onPointerDragEnd)},changeButtonPosition(K,se){const me=se||this.pointerDown,Be=me==="min"?0:1;me==="min"?K=this.checkLimits([K,this.max])[0]:K=this.checkLimits([this.min,K])[1];const Re=this.handleDecimal(K,this.step),ve=this.currentValue;ve[Be]=K-Re,this.range&&(me==="min"&&ve[0]>ve[1]&&(ve[1]=ve[0]),me==="max"&&ve[0]>ve[1]&&(ve[0]=ve[1])),this.currentValue=[...ve],this.dragging||this.currentValue[Be]!==this.oldValue[Be]&&(this.emitChange(),this.oldValue[Be]=this.currentValue[Be])},handleDecimal(K,se){if(se<1){let me=se.toString(),Be=1,Re;try{Re=me.split(".")[1].length}catch{Re=0}return Be=Math.pow(10,Re),K*Be%(se*Be)/Be}else return K%se},emitChange(){const K=this.range?this.exportValue:this.exportValue[0];this.$emit("on-change",K),this.handleFormItemChange("change",K)},sliderClick(K){if(this.itemDisabled)return;const se=this.getPointerX(K),me=this.$refs.slider.getBoundingClientRect().left;let Be=(se-me)/this.sliderWidth*this.valueRange+this.min,Re=Be/this.valueRange*100;!this.range||Re<=this.minPosition?this.changeButtonPosition(Be,"min"):Re>=this.maxPosition?this.changeButtonPosition(Be,"max"):this.changeButtonPosition(Be,Be-this.firstPosition<=this.secondPosition-Be?"min":"max")},handleInputChange(K){this.currentValue=[K===0?0:K||this.min,this.currentValue[1]],this.emitChange()},handleFocus(K){this.$refs[`${K}Tooltip`].handleShowPopper()},handleBlur(K){this.$refs[`${K}Tooltip`].handleClosePopper()},handleSetSliderWidth(){this.sliderWidth=parseInt(He(this.$refs.slider,"width"),10)},handleOnVisibleChange(K){K&&this.showTip==="always"&&(this.$refs.minTooltip.doDestroy(),this.range&&this.$refs.maxTooltip.doDestroy(),E.nextTick(()=>{this.$refs.minTooltip.updatePopper(),this.range&&this.$refs.maxTooltip.updatePopper()}))},addSlider(K){const se=this[K];!se||(se.sliderList||(se.sliderList=[]),se.sliderList.push({id:this.id,slider:this}))},removeSlider(K){const se=this[K];if(!se||!se.sliderList)return;const me=se.sliderList.findIndex(Be=>Be.id===this.id);se.sliderList.splice(me,1)}},mounted(){this.addSlider("ModalInstance"),this.addSlider("DrawerInstance"),this.observer=Na(),this.observer.listenTo(this.$refs.slider,this.handleSetSliderWidth)},beforeUnmount(){this.removeSlider("ModalInstance"),this.removeSlider("DrawerInstance"),this.observer.removeListener(this.$refs.slider,this.handleSetSliderWidth)}},ST=["name","value"],wT={class:"ivu-slider-marks"};function OT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Input-number"),Xe=E.resolveComponent("SliderMarker"),tt=E.resolveComponent("Tooltip");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[!me.range&&me.showInput?(E.openBlock(),E.createBlock(Fe,{key:0,min:me.min,size:me.inputSize,max:me.max,step:me.step,modelValue:ve.exportValue[0],disabled:K.itemDisabled,"active-change":me.activeChange,onOnChange:ve.handleInputChange},null,8,["min","size","max","step","modelValue","disabled","active-change","onOnChange"])):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-wrap"]),ref:"slider",onClick:se[19]||(se[19]=E.withModifiers((...Ze)=>ve.sliderClick&&ve.sliderClick(...Ze),["self"]))},[E.createElementVNode("input",{type:"hidden",name:me.name,value:ve.exportValue},null,8,ST),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-bar"]),style:E.normalizeStyle(ve.barStyle),onClick:se[0]||(se[0]=E.withModifiers((...Ze)=>ve.sliderClick&&ve.sliderClick(...Ze),["self"]))},null,6),me.showStops?(E.openBlock(!0),E.createElementBlock(E.Fragment,{key:0},E.renderList(ve.stops,Ze=>(E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls+"-stop"]),key:Ze,style:E.normalizeStyle({left:Ze+"%"}),onClick:se[1]||(se[1]=E.withModifiers((...it)=>ve.sliderClick&&ve.sliderClick(...it),["self"]))},null,6))),128)):E.createCommentVNode("",!0),ve.markList.length>0?(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.markList,(Ze,it)=>(E.openBlock(),E.createElementBlock("div",{key:it,class:E.normalizeClass([Re.prefixCls+"-stop"]),style:E.normalizeStyle({left:Ze.position+"%"}),onClick:se[2]||(se[2]=E.withModifiers((...nr)=>ve.sliderClick&&ve.sliderClick(...nr),["self"]))},null,6))),128)),E.createElementVNode("div",wT,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.markList,(Ze,it)=>(E.openBlock(),E.createBlock(Xe,{key:it,mark:Ze.mark,style:E.normalizeStyle({left:Ze.position+"%"}),onClick:ve.sliderClick},null,8,["mark","style","onClick"]))),128))])],64)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-button-wrap"]),style:E.normalizeStyle({left:ve.minPosition+"%"}),onTouchstart:se[9]||(se[9]=Ze=>ve.onPointerDown(Ze,"min")),onMousedown:se[10]||(se[10]=Ze=>ve.onPointerDown(Ze,"min"))},[E.createVNode(tt,{controlled:Re.pointerDown==="min",placement:"top",content:me.tipFormat(ve.exportValue[0]),disabled:ve.tipDisabled,always:me.showTip==="always",ref:"minTooltip"},{default:E.withCtx(()=>[E.createElementVNode("div",{class:E.normalizeClass(ve.minButtonClasses),tabindex:"0",onFocus:se[3]||(se[3]=Ze=>ve.handleFocus("min")),onBlur:se[4]||(se[4]=Ze=>ve.handleBlur("min")),onKeydown:[se[5]||(se[5]=E.withKeys(Ze=>ve.onKeyLeft(Ze,"min"),["left"])),se[6]||(se[6]=E.withKeys(Ze=>ve.onKeyLeft(Ze,"min"),["down"])),se[7]||(se[7]=E.withKeys(Ze=>ve.onKeyRight(Ze,"min"),["right"])),se[8]||(se[8]=E.withKeys(Ze=>ve.onKeyRight(Ze,"min"),["up"]))]},null,34)]),_:1},8,["controlled","content","disabled","always"])],38),me.range?(E.openBlock(),E.createElementBlock("div",{key:2,class:E.normalizeClass([Re.prefixCls+"-button-wrap"]),style:E.normalizeStyle({left:ve.maxPosition+"%"}),onTouchstart:se[17]||(se[17]=Ze=>ve.onPointerDown(Ze,"max")),onMousedown:se[18]||(se[18]=Ze=>ve.onPointerDown(Ze,"max"))},[E.createVNode(tt,{controlled:Re.pointerDown==="max",placement:"top",content:me.tipFormat(ve.exportValue[1]),disabled:ve.tipDisabled,always:me.showTip==="always",ref:"maxTooltip"},{default:E.withCtx(()=>[E.createElementVNode("div",{class:E.normalizeClass(ve.maxButtonClasses),tabindex:"0",onFocus:se[11]||(se[11]=Ze=>ve.handleFocus("max")),onBlur:se[12]||(se[12]=Ze=>ve.handleBlur("max")),onKeydown:[se[13]||(se[13]=E.withKeys(Ze=>ve.onKeyLeft(Ze,"max"),["left"])),se[14]||(se[14]=E.withKeys(Ze=>ve.onKeyLeft(Ze,"max"),["down"])),se[15]||(se[15]=E.withKeys(Ze=>ve.onKeyRight(Ze,"max"),["right"])),se[16]||(se[16]=E.withKeys(Ze=>ve.onKeyRight(Ze,"max"),["up"]))]},null,34)]),_:1},8,["controlled","content","disabled","always"])],38)):E.createCommentVNode("",!0)],2)],2)}var ym=Y(xT,[["render",OT]]);const CT={small:8,default:16,large:24},_m={name:"Space",props:{size:{type:[String,Number,Array],validator(K){const se=["small","large","default"];return typeof K=="string"?Ie(K,se):Array.isArray(K)?K.length>0&&K.every(me=>typeof me=="number"||Ie(me,se)):!0},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||!K.$VIEWUI.space||K.$VIEWUI.space.size===""?"small":K.$VIEWUI.space.size}},direction:{type:String,validator(K){return Ie(K,["horizontal","vertical"])},default:"horizontal"},align:{type:String,validator(K){return Ie(K,["start","end","center","baseline","stretch"])}},wrap:{type:Boolean,default:!1},split:{type:Boolean,default:!1},type:{type:String,validator(K){return Ie(K,["inline-flex","flex"])},default:"inline-flex"}},computed:{mergedAlign(){if(!this.align){if(this.direction==="horizontal")return"center";if(this.type==="flex")return"stretch"}return this.align},classes(){return["ivu-space",`ivu-space-${this.direction}`,{"ivu-space-flex":this.type==="flex","ivu-space-wrap":this.wrap,[`ivu-space-${this.mergedAlign}`]:this.mergedAlign}]},styles(){const K={};return["number","string"].includes(typeof this.size)&&(K.gap=this.getSize(this.size)),Array.isArray(this.size)&&(this.size.length===1?K.columnGap=this.getSize(this.size[0]):this.size.length>1&&(K.columnGap=this.getSize(this.size[0]),K.rowGap=this.getSize(this.size[1]))),K}},methods:{getSize(K){return`${typeof K=="string"?CT[K]:K||0}px`},filterEmpty(K=[]){const se=[];return K.forEach(me=>{Array.isArray(me)?se.push(...me):me.type===E.Fragment?se.push(...me.children):se.push(me)}),se.filter(me=>!this.isEmptyElement(me))},isEmptyElement(K){return K&&(K.type===E.Comment||K.type===E.Fragment&&K.children.length===0||K.type===E.Text&&K.children.trim()==="")}},render(){const K=this.filterEmpty(this.$slots.default?this.$slots.default():[]),se=K.length;if(se===0)return null;let me=null;return this.split&&!this.$slots.split?me=E.h(mc,{type:"vertical"}):this.$slots.split&&(me=this.$slots.split()),E.h("div",{class:this.classes,style:this.styles},K.map((Be,Re)=>{const ve=E.h("div",{class:"ivu-space-item"},[Be]);return me&&Re+1<se?[ve,E.h("div",{class:"ivu-space-split"},[me])]:ve}))}},TT={name:"Trigger",props:{mode:String},data(){return{prefix:"ivu-split-trigger",initOffset:0}},computed:{isVertical(){return this.mode==="vertical"},classes(){return[this.prefix,this.isVertical?`${this.prefix}-vertical`:`${this.prefix}-horizontal`]},barConClasses(){return[`${this.prefix}-bar-con`,this.isVertical?"vertical":"horizontal"]}}};function ET(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("div",{class:E.normalizeClass(ve.barConClasses)},[se[0]||(E.setBlockTracking(-1),se[0]=(E.openBlock(),E.createElementBlock(E.Fragment,null,E.renderList(8,Fe=>E.createElementVNode("i",{class:E.normalizeClass(`${Re.prefix}-bar`),key:`trigger-${Fe}`},null,2)),64)),E.setBlockTracking(1),se[0])],2)],2)}var AT=Y(TT,[["render",ET]]);const MT={name:"Split",components:{Trigger:AT},emits:["update:modelValue","on-move-start","on-moving","on-move-end"],props:{modelValue:{type:[Number,String],default:.5},mode:{validator(K){return Ie(K,["horizontal","vertical"])},default:"horizontal"},min:{type:[Number,String],default:"40px"},max:{type:[Number,String],default:"40px"}},data(){return{prefix:"ivu-split",offset:0,oldOffset:0,isMoving:!1,computedMin:0,computedMax:0,currentValue:.5}},computed:{wrapperClasses(){return[`${this.prefix}-wrapper`,this.isMoving?"no-select":""]},paneClasses(){return[`${this.prefix}-pane`,{[`${this.prefix}-pane-moving`]:this.isMoving}]},isHorizontal(){return this.mode==="horizontal"},anotherOffset(){return 100-this.offset},valueIsPx(){return typeof this.modelValue=="string"},offsetSize(){return this.isHorizontal?"offsetWidth":"offsetHeight"}},methods:{px2percent(K,se){return parseFloat(K)/parseFloat(se)},getComputedThresholdValue(K){let se=this.$refs.outerWrapper[this.offsetSize];return this.valueIsPx?typeof this[K]=="string"?this[K]:se*this[K]:typeof this[K]=="string"?this.px2percent(this[K],se):this[K]},getMin(K,se){return this.valueIsPx?`${Math.min(parseFloat(K),parseFloat(se))}px`:Math.min(K,se)},getMax(K,se){return this.valueIsPx?`${Math.max(parseFloat(K),parseFloat(se))}px`:Math.max(K,se)},getAnotherOffset(K){let se=0;return this.valueIsPx?se=`${this.$refs.outerWrapper[this.offsetSize]-parseFloat(K)}px`:se=1-K,se},handleMove(K){let se=(this.isHorizontal?K.pageX:K.pageY)-this.initOffset,me=this.$refs.outerWrapper[this.offsetSize],Be=this.valueIsPx?`${parseFloat(this.oldOffset)+se}px`:this.px2percent(me*this.oldOffset+se,me),Re=this.getAnotherOffset(Be);parseFloat(Be)<=parseFloat(this.computedMin)&&(Be=this.getMax(Be,this.computedMin)),parseFloat(Re)<=parseFloat(this.computedMax)&&(Be=this.getAnotherOffset(this.getMax(Re,this.computedMax))),K.atMin=this.modelValue===this.computedMin,K.atMax=this.valueIsPx?this.getAnotherOffset(this.modelValue)===this.computedMax:this.getAnotherOffset(this.modelValue).toFixed(5)===this.computedMax.toFixed(5),this.$emit("update:modelValue",Be),this.$emit("on-moving",K)},handleUp(){this.isMoving=!1,q(document,"mousemove",this.handleMove),q(document,"mouseup",this.handleUp),this.$emit("on-move-end")},handleMousedown(K){this.initOffset=this.isHorizontal?K.pageX:K.pageY,this.oldOffset=this.modelValue,this.isMoving=!0,X(document,"mousemove",this.handleMove),X(document,"mouseup",this.handleUp),this.$emit("on-move-start")},computeOffset(){E.nextTick(()=>{this.computedMin=this.getComputedThresholdValue("min"),this.computedMax=this.getComputedThresholdValue("max"),this.offset=(this.valueIsPx?this.px2percent(this.modelValue,this.$refs.outerWrapper[this.offsetSize]):this.modelValue)*1e4/100})}},watch:{modelValue(K){K!==this.currentValue&&(this.currentValue=K,this.computeOffset())}},mounted(){E.nextTick(()=>{this.computeOffset()}),X(window,"resize",this.computeOffset)},beforeUnmount(){q(window,"resize",this.computeOffset)}};function PT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("trigger");return E.openBlock(),E.createElementBlock("div",{ref:"outerWrapper",class:E.normalizeClass(ve.wrapperClasses)},[ve.isHorizontal?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(`${Re.prefix}-horizontal`)},[E.createElementVNode("div",{style:E.normalizeStyle({right:`${ve.anotherOffset}%`}),class:E.normalizeClass(["left-pane",ve.paneClasses])},[E.renderSlot(K.$slots,"left")],6),E.createElementVNode("div",{class:E.normalizeClass(`${Re.prefix}-trigger-con`),style:E.normalizeStyle({left:`${Re.offset}%`}),onMousedown:se[0]||(se[0]=(...Xe)=>ve.handleMousedown&&ve.handleMousedown(...Xe))},[E.renderSlot(K.$slots,"trigger",{},()=>[E.createVNode(Fe,{mode:"vertical"})])],38),E.createElementVNode("div",{style:E.normalizeStyle({left:`${Re.offset}%`}),class:E.normalizeClass(["right-pane",ve.paneClasses])},[E.renderSlot(K.$slots,"right")],6)],2)):(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass(`${Re.prefix}-vertical`)},[E.createElementVNode("div",{style:E.normalizeStyle({bottom:`${ve.anotherOffset}%`}),class:E.normalizeClass(["top-pane",ve.paneClasses])},[E.renderSlot(K.$slots,"top")],6),E.createElementVNode("div",{class:E.normalizeClass(`${Re.prefix}-trigger-con`),style:E.normalizeStyle({top:`${Re.offset}%`}),onMousedown:se[1]||(se[1]=(...Xe)=>ve.handleMousedown&&ve.handleMousedown(...Xe))},[E.renderSlot(K.$slots,"trigger",{},()=>[E.createVNode(Fe,{mode:"horizontal"})])],38),E.createElementVNode("div",{style:E.normalizeStyle({top:`${Re.offset}%`}),class:E.normalizeClass(["bottom-pane",ve.paneClasses])},[E.renderSlot(K.$slots,"bottom")],6)],2))],2)}var vm=Y(MT,[["render",PT]]);const Wa="ivu-steps",bm="ivu-icon",RT={name:"Step",inject:["StepsInstance"],props:{status:{validator(K){return Ie(K,["wait","process","finish","error"])}},title:{type:String,default:""},content:{type:String},icon:{type:String}},data(){return{prefixCls:Wa,id:gt(6)}},computed:{wrapClasses(){return[`${Wa}-item`,`${Wa}-status-${this.currentStatus}`,{[`${Wa}-custom`]:!!this.icon||!!this.$slots.icon,[`${Wa}-next-error`]:this.nextError}]},iconClasses(){let K="";return this.icon?K=this.icon:this.currentStatus==="finish"?K="ios-checkmark":this.currentStatus==="error"&&(K="ios-close"),[`${Wa}-icon`,`${bm}`,{[`${bm}-${K}`]:K!==""}]},stepNumber(){return this.StepsInstance.steps.findIndex(K=>K.id===this.id)+1},total(){return this.StepsInstance.direction==="horizontal"?this.StepsInstance.steps.length:1},currentStatus(){let K="";if(this.status)K=this.status;else{const se=this.StepsInstance,me=se.current,Be=se.steps.findIndex(Re=>Re.id===this.id);Be===me?se.status!=="error"?K="process":K="error":Be<me?K="finish":K="wait"}return K},nextError(){let K=!1;const se=this.StepsInstance,me=se.steps.findIndex(Be=>Be.id===this.id);return me+1<se.steps.length&&se.steps[me+1].currentStatus==="error"&&(K=!0),K}},beforeMount(){this.StepsInstance.addStep(this.id,this)},beforeUnmount(){this.StepsInstance.removeStep(this.id)}},kT=[E.createElementVNode("i",null,null,-1)],IT={key:0},BT={key:1,class:"ivu-steps-icon"};function VT(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses)},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-tail"])},kT,2),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-head"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-head-inner"])},[!me.icon&&!K.$slots.icon&&ve.currentStatus!=="finish"&&ve.currentStatus!=="error"?(E.openBlock(),E.createElementBlock("span",IT,E.toDisplayString(ve.stepNumber),1)):K.$slots.icon?(E.openBlock(),E.createElementBlock("span",BT,[E.renderSlot(K.$slots,"icon")])):(E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass(ve.iconClasses)},null,2))],2)],2),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-main"])},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-title"])},[E.renderSlot(K.$slots,"title",{},()=>[E.createTextVNode(E.toDisplayString(me.title),1)])],2),me.content||K.$slots.content?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-content"])},[E.renderSlot(K.$slots,"content",{},()=>[E.createTextVNode(E.toDisplayString(me.content),1)])],2)):E.createCommentVNode("",!0)],2)],2)}var xm=Y(RT,[["render",VT]]);const kh="ivu-steps",DT={name:"Steps",provide(){return{StepsInstance:this}},props:{current:{type:Number,default:0},status:{validator(K){return Ie(K,["wait","process","finish","error"])},default:"process"},size:{validator(K){return Ie(K,["small"])}},direction:{validator(K){return Ie(K,["horizontal","vertical"])},default:"horizontal"}},data(){return{steps:[]}},computed:{classes(){return[`${kh}`,`${kh}-${this.direction}`,{[`${kh}-${this.size}`]:!!this.size}]},children(){return this.steps.map(K=>K.step)}},methods:{addStep(K,se){this.steps.push({id:K,step:se})},removeStep(K){const se=this.steps.findIndex(me=>me.id===K);this.steps.splice(se,1)}}};function NT(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes)},[E.renderSlot(K.$slots,"default")],2)}var Sm=Y(DT,[["render",NT]]);const ma="ivu-menu",$T={name:"Submenu",mixins:[fh,io],components:{Icon:Ae,Drop:ki,CollapseTransition:Sh},provide(){return{SubmenuInstance:this}},props:{name:{type:[String,Number],required:!0},disabled:{type:Boolean,default:!1}},data(){return{prefixCls:ma,active:!1,opened:!1,dropWidth:parseFloat(He(this.$el,"width")),id:gt(6),childSubmenuList:[]}},computed:{classes(){return[`${ma}-submenu`,{[`${ma}-item-active`]:this.active&&!this.hasParentSubmenu,[`${ma}-opened`]:this.opened,[`${ma}-submenu-disabled`]:this.disabled,[`${ma}-submenu-has-parent-submenu`]:this.hasParentSubmenu,[`${ma}-child-item-active`]:this.active}]},accordion(){return this.menu.accordion},dropStyle(){let K={};return this.dropWidth&&(K.minWidth=`${this.dropWidth}px`),K},titleStyle(){return this.hasParentSubmenu&&this.mode!=="horizontal"?{paddingLeft:43+(this.parentSubmenuNum-1)*24+"px"}:{}},arrowType(){const K=this.globalConfig;let se="ios-arrow-down";return K&&(K.menu.customArrow?se="":K.menu.arrow&&(se=K.menu.arrow)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.menu.customArrow&&(se=K.menu.customArrow),se},arrowSize(){const K=this.globalConfig;let se="";return K&&K.menu.arrowSize&&(se=K.menu.arrowSize),se}},methods:{handleMouseenter(){this.disabled||this.mode!=="vertical"&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.menu.updateOpenKeys(this.name),this.opened=!0},250))},handleMouseleave(){this.disabled||this.mode!=="vertical"&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.menu.updateOpenKeys(this.name),this.opened=!1},150))},handleClick(){if(this.disabled||this.mode==="horizontal")return;const K=this.opened;this.opened=!K,this.menu.updateOpenKeys(this.name)},addSubmenu(){const K=this.MenuInstance;K.submenuList||(K.submenuList=[]),K.submenuList.push({id:this.id,submenu:this});const se=Je(this,"Submenu");se&&(se.childSubmenuList||(se.childSubmenuList=[]),se.childSubmenuList.push({id:this.id,submenu:this}))},removeSubmenu(){const K=this.MenuInstance;if(K.submenuList&&K.submenuList.length){const me=K.submenuList.findIndex(Be=>Be.id===this.id);K.submenuList.splice(me,1)}const se=Je(this,"Submenu");if(se&&se.childSubmenuList&&se.childSubmenuList.length){const me=se.childSubmenuList.findIndex(Be=>Be.id===this.id);se.childSubmenuList.splice(me,1)}},handleMenuItemSelect(K){this.mode==="horizontal"&&(this.opened=!1),this.MenuInstance.handleMenuItemSelect(K)},handleUpdateActiveName(K){Je(this,"Submenu")&&this.SubmenuInstance.handleUpdateActiveName(K),this.childSubmenuList&&this.childSubmenuList.length&&this.childSubmenuList.map(se=>se.submenu).forEach(se=>{se.active=!1}),this.active=K}},watch:{mode(K){K==="horizontal"&&this.$refs.drop.update()},opened(K){this.mode!=="vertical"&&(K?(this.dropWidth=parseFloat(He(this.$el,"width")),this.$refs.drop.update()):this.$refs.drop.destroy())}},mounted(){this.addSubmenu()},beforeUnmount(){this.removeSubmenu()}};function LT(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("collapse-transition"),tt=E.resolveComponent("Drop");return E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.classes),onMouseenter:se[1]||(se[1]=(...Ze)=>ve.handleMouseenter&&ve.handleMouseenter(...Ze)),onMouseleave:se[2]||(se[2]=(...Ze)=>ve.handleMouseleave&&ve.handleMouseleave(...Ze))},[E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-submenu-title"]),ref:"reference",onClick:se[0]||(se[0]=E.withModifiers((...Ze)=>ve.handleClick&&ve.handleClick(...Ze),["stop"])),style:E.normalizeStyle(ve.titleStyle)},[E.renderSlot(K.$slots,"title"),E.createVNode(Fe,{type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize,class:E.normalizeClass([Re.prefixCls+"-submenu-title-icon"])},null,8,["type","custom","size","class"])],6),K.mode==="vertical"?(E.openBlock(),E.createBlock(Xe,{key:0,ready:K.menu.ready},{default:E.withCtx(()=>[E.withDirectives(E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls])},[E.renderSlot(K.$slots,"default")],2),[[E.vShow,Re.opened]])]),_:3},8,["ready"])):E.createCommentVNode("",!0),K.mode==="horizontal"?(E.openBlock(),E.createBlock(tt,{key:1,ref:"drop",visible:Re.opened,placement:"bottom","transition-name":"slide-up",styles:ve.dropStyle},{default:E.withCtx(()=>[E.createElementVNode("ul",{class:E.normalizeClass([Re.prefixCls+"-drop-list"])},[E.renderSlot(K.$slots,"default")],2)]),_:3},8,["visible","styles"])):E.createCommentVNode("",!0)],34)}var wm=Y($T,[["render",LT]]);const Tm={name:"Submit",inject:["LoginInstance"],props:{},methods:{handleSubmit(){this.LoginInstance.handleSubmit()}},render(){const K=Object.assign({size:"large",type:"primary",long:!0},this.$attrs),se=E.h(As,{...K,onClick:this.handleSubmit},this.$slots.default||(()=>""));return E.h("div",{class:"ivu-login-submit"},[se])}},Ga="ivu-switch",FT={name:"iSwitch",mixins:[In],emits:["update:modelValue","on-change"],props:{modelValue:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:!1},size:{validator(K){return Ie(K,["large","small","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},name:{type:String},loading:{type:Boolean,default:!1},trueColor:{type:String},falseColor:{type:String},beforeChange:Function},data(){return{currentValue:this.modelValue}},computed:{wrapClasses(){return[`${Ga}`,{[`${Ga}-checked`]:this.currentValue===this.trueValue,[`${Ga}-disabled`]:this.itemDisabled,[`${Ga}-${this.size}`]:!!this.size,[`${Ga}-loading`]:this.loading}]},wrapStyles(){let K={};return this.trueColor&&this.currentValue===this.trueValue?(K["border-color"]=this.trueColor,K["background-color"]=this.trueColor):this.falseColor&&this.currentValue===this.falseValue&&(K["border-color"]=this.falseColor,K["background-color"]=this.falseColor),K},innerClasses(){return`${Ga}-inner`}},methods:{handleToggle(){const K=this.currentValue===this.trueValue?this.falseValue:this.trueValue;this.currentValue=K,this.$emit("update:modelValue",K),this.$emit("on-change",K),this.handleFormItemChange("change",K)},toggle(K){if(K.preventDefault(),this.itemDisabled||this.loading)return!1;if(!this.beforeChange)return this.handleToggle();const se=this.beforeChange();se&&se.then?se.then(()=>{this.handleToggle()}):this.handleToggle()}},watch:{modelValue(K){if(K!==this.trueValue&&K!==this.falseValue&&K!==null)throw"Value should be trueValue or falseValue.";this.currentValue=K}}},UT=["name","value"];function zT(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("span",{tabindex:"0",class:E.normalizeClass(ve.wrapClasses),style:E.normalizeStyle(ve.wrapStyles),onClick:se[0]||(se[0]=(...Fe)=>ve.toggle&&ve.toggle(...Fe)),onKeydown:se[1]||(se[1]=E.withKeys((...Fe)=>ve.toggle&&ve.toggle(...Fe),["space"]))},[E.createElementVNode("input",{type:"hidden",name:me.name,value:Re.currentValue},null,8,UT),E.createElementVNode("span",{class:E.normalizeClass(ve.innerClasses)},[Re.currentValue===me.trueValue?E.renderSlot(K.$slots,"open",{key:0}):E.createCommentVNode("",!0),Re.currentValue===me.falseValue?E.renderSlot(K.$slots,"close",{key:1}):E.createCommentVNode("",!0)],2)],38)}var Bh=Y(FT,[["render",zT]]),WT={name:"TableRenderHeader",props:{render:Function,column:Object,index:Number},render(){const K={column:this.column,index:this.index};return this.render(E.h,K)}},Vh={methods:{alignCls(K,se={}){let me="";return se.cellClassName&&K.key&&se.cellClassName[K.key]&&(me=se.cellClassName[K.key]),[`${this.prefixCls}-column-${K.__id}`,{[`${me}`]:me,[`${K.className}`]:K.className,[`${this.prefixCls}-column-${K.align}`]:K.align,[`${this.prefixCls}-hidden`]:this.fixed==="left"&&K.fixed!=="left"||this.fixed==="right"&&K.fixed!=="right"||!this.fixed&&K.fixed&&(K.fixed==="left"||K.fixed==="right")}]},isPopperShow(K){return K.filters&&(!this.fixed&&!K.fixed||this.fixed==="left"&&K.fixed==="left"||this.fixed==="right"&&K.fixed==="right")},setCellWidth(K){let se="";return K.width?se=K.width:this.columnsWidth[K._index]&&(se=this.columnsWidth[K._index].width),se==="0"&&(se=""),se}}};const GT={name:"TableHead",mixins:[Vh,Xn],components:{CheckboxGroup:Lu,Checkbox:wa,Poptip:wh,iButton:As,renderHeader:WT},props:{prefixCls:String,styleObject:Object,columns:Array,objData:Object,data:Array,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1},columnRows:Array,fixedColumnRows:Array},data(){return{draggingColumn:null,dragging:!1,dragState:{}}},computed:{styles(){const K=Object.assign({},this.styleObject),se=parseInt(this.styleObject.width);return K.width=`${se}px`,K},isSelectAll(){let K=!0;this.data.length||(K=!1);let se=!0;for(let me in this.objData){const Be=this.objData[me];if(!Be._isChecked&&!Be._isDisabled){K=!1;break}else Be.children&&Be.children.length&&(K=this.isChildrenSelected(Be,K));Be._isDisabled&&!Be._isChecked?Be.children&&Be.children.length&&(se=this.isChildrenAllDisabledAndUnSelected(Be,se)):se=!1}return se&&(K=!1),K},headRows(){return this.columnRows.length>1?this.fixed?this.fixedColumnRows:this.columnRows:[this.columns]},isSelectDisabled(){let K=!0;if(this.data.length)for(let se in this.objData){const me=this.objData[se];me._isDisabled?me.children&&me.children.length&&(K=this.isChildrenDisabled(me,K)):K=!1}return K}},methods:{cellClasses(K){return[`${this.prefixCls}-cell`,{[`${this.prefixCls}-hidden`]:!this.fixed&&K.fixed&&(K.fixed==="left"||K.fixed==="right"),[`${this.prefixCls}-cell-with-selection`]:K.type==="selection"}]},scrollBarCellClass(){let K=!1;for(let se in this.headRows)for(let me in this.headRows[se]){if(this.headRows[se][me].fixed==="right"){K=!0;break}if(K)break}return[{[`${this.prefixCls}-hidden`]:K}]},itemClasses(K,se){return[`${this.prefixCls}-filter-select-item`,{[`${this.prefixCls}-filter-select-item-selected`]:K._filterChecked[0]===se.value}]},itemAllClasses(K){return[`${this.prefixCls}-filter-select-item`,{[`${this.prefixCls}-filter-select-item-selected`]:!K._filterChecked.length}]},selectAll(){const K=!this.isSelectAll;this.$parent.selectAll(K)},handleSort(K,se){const me=this.columns.find(Re=>Re._index===K),Be=me._index;me._sortType===se&&(se="normal"),this.$parent.handleSort(Be,se)},handleSortByHead(K){const se=this.columns.find(me=>me._index===K);if(se.sortable){const me=se._sortType;me==="normal"?this.handleSort(K,"asc"):me==="asc"?this.handleSort(K,"desc"):this.handleSort(K,"normal")}},handleFilter(K){this.$parent.handleFilter(K)},handleSelect(K,se){this.$parent.handleFilterSelect(K,se)},handleReset(K){this.$parent.handleFilterReset(K)},handleFilterHide(K){this.$parent.handleFilterHide(K)},getColumn(K,se){if(this.columnRows.length>1){const me=this.headRows[K][se].__id;return this.columns.filter(Be=>Be.__id===me)[0]}else return this.headRows[K][se]},handleMouseDown(K,se){if(!this.$isServer&&W&&this.draggingColumn){this.dragging=!0;const me=this.$parent,Be=me.$el.getBoundingClientRect().left,Re=this.$el.querySelector(`th.ivu-table-column-${K.__id}`).getBoundingClientRect(),ve=Re.left-Be+30;me.showResizeLine=!0,this.dragState={startMouseLeft:se.clientX,startLeft:Re.right-Be,startColumnLeft:Re.left-Be,tableLeft:Be};const Fe=me.$refs.resizeLine;Fe.style.left=this.dragState.startLeft+"px",document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const Xe=Ze=>{const it=Ze.clientX-this.dragState.startMouseLeft,nr=this.dragState.startLeft+it;Fe.style.left=Math.max(ve,nr)+"px"},tt=()=>{if(this.dragging){const{startColumnLeft:Ze,startLeft:it}=this.dragState,nr=parseInt(Fe.style.left,10)-Ze,jr=me.allColumns.find(zr=>zr.__id===K.__id);jr&&(jr.width=nr,K.width=nr,me.handleResize()),me.$emit("on-column-width-resize",jr.width,it-Ze,K,se),W&&(document.body.style.cursor=""),this.dragging=!1,this.draggingColumn=null,this.dragState={},me.showResizeLine=!1}!W||(document.removeEventListener("mousemove",Xe),document.removeEventListener("mouseup",tt),document.onselectstart=null,document.ondragstart=null)};if(!W)return;document.addEventListener("mousemove",Xe),document.addEventListener("mouseup",tt)}},handleMouseMove(K,se){let me=se.target;for(;me&&me.tagName!=="TH";)me=me.parentNode;if(!(!K||!K.resizable)&&W&&!this.dragging){let Be=me.getBoundingClientRect();const Re=document.body.style;Be.width>12&&Be.right-se.pageX<8?(Re.cursor="col-resize",this.draggingColumn=K):this.dragging||(Re.cursor="",this.draggingColumn=null)}},handleMouseOut(){this.$isServer||W&&(document.body.style.cursor="")},isChildrenSelected(K,se){let me=se;return K.children&&K.children.length&&K.children.forEach(Be=>{!Be._isChecked&&!Be._isDisabled?me=!1:Be.children&&Be.children.length&&(me=this.isChildrenSelected(Be,me))}),me},isChildrenAllDisabledAndUnSelected(K,se){let me=se;return K.children&&K.children.length&&K.children.forEach(Be=>{Be._isDisabled&&!Be._isChecked?Be.children&&Be.children.length&&(me=this.isChildrenAllDisabledAndUnSelected(Be,me)):me=!1}),me},isChildrenDisabled(K,se){let me=se;return K.children&&K.children.length&&K.children.forEach(Be=>{Be._isDisabled?Be.children&&Be.children.length&&(me=this.isChildrenDisabled(Be,me)):me=!1}),me}}},jT=["width"],HT=["width"],XT=["colspan","rowspan"],qT={key:0},QT=["onClick"],YT=["onClick"],KT=["onClick"],ZT=["onMousedown","onMousemove"],JT=["rowspan"];function eE(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("render-header"),Xe=E.resolveComponent("Checkbox"),tt=E.resolveComponent("checkbox"),Ze=E.resolveComponent("checkbox-group"),it=E.resolveComponent("i-button"),nr=E.resolveComponent("Poptip");return E.openBlock(),E.createElementBlock("table",{cellspacing:"0",cellpadding:"0",border:"0",style:E.normalizeStyle(ve.styles)},[E.createElementVNode("colgroup",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.columns,(jr,zr)=>(E.openBlock(),E.createElementBlock("col",{key:zr,width:K.setCellWidth(jr)},null,8,jT))),128)),K.$parent.showVerticalScrollBar?(E.openBlock(),E.createElementBlock("col",{key:0,width:K.$parent.scrollBarWidth},null,8,HT)):E.createCommentVNode("",!0)]),E.createElementVNode("thead",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.headRows,(jr,zr)=>(E.openBlock(),E.createElementBlock("tr",{key:zr},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(jr,(Fr,_t)=>(E.openBlock(),E.createElementBlock("th",{key:_t,colspan:Fr.colSpan,rowspan:Fr.rowSpan,class:E.normalizeClass(K.alignCls(Fr))},[E.createElementVNode("div",{class:E.normalizeClass(ve.cellClasses(Fr))},[Fr.type==="expand"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[Fr.renderHeader?(E.openBlock(),E.createBlock(Fe,{key:1,render:Fr.renderHeader,column:Fr,index:_t},null,8,["render","column","index"])):(E.openBlock(),E.createElementBlock("span",qT,E.toDisplayString(Fr.title||""),1))],64)):Fr.type==="selection"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[Fr.hideSelectAll?E.createCommentVNode("",!0):(E.openBlock(),E.createBlock(Xe,{key:0,"model-value":ve.isSelectAll,disabled:ve.isSelectDisabled,onOnChange:ve.selectAll},null,8,["model-value","disabled","onOnChange"]))],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:2},[Fr.renderHeader?(E.openBlock(),E.createBlock(Fe,{key:1,render:Fr.renderHeader,column:Fr,index:_t},null,8,["render","column","index"])):(E.openBlock(),E.createElementBlock("span",{key:0,class:E.normalizeClass({[me.prefixCls+"-cell-sort"]:Fr.sortable}),onClick:ni=>Fr.sortable&&ve.handleSortByHead(ve.getColumn(zr,_t)._index)},E.toDisplayString(Fr.title||"#"),11,QT)),Fr.sortable?(E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass([me.prefixCls+"-sort"])},[E.createElementVNode("i",{class:E.normalizeClass(["ivu-icon ivu-icon-md-arrow-dropup",{on:ve.getColumn(zr,_t)._sortType==="asc"}]),onClick:ni=>ve.handleSort(ve.getColumn(zr,_t)._index,"asc")},null,10,YT),E.createElementVNode("i",{class:E.normalizeClass(["ivu-icon ivu-icon-md-arrow-dropdown",{on:ve.getColumn(zr,_t)._sortType==="desc"}]),onClick:ni=>ve.handleSort(ve.getColumn(zr,_t)._index,"desc")},null,10,KT)],2)):E.createCommentVNode("",!0),K.isPopperShow(Fr)?(E.openBlock(),E.createBlock(nr,{key:3,modelValue:ve.getColumn(zr,_t)._filterVisible,"onUpdate:modelValue":ni=>ve.getColumn(zr,_t)._filterVisible=ni,placement:"bottom","popper-class":"ivu-table-popper",transfer:"",capture:!1,onOnPopperHide:ni=>ve.handleFilterHide(ve.getColumn(zr,_t)._index)},E.createSlots({default:E.withCtx(()=>[E.createElementVNode("span",{class:E.normalizeClass([me.prefixCls+"-filter"])},[E.createElementVNode("i",{class:E.normalizeClass(["ivu-icon ivu-icon-ios-funnel",{on:ve.getColumn(zr,_t)._isFiltered}])},null,2)],2)]),_:2},[ve.getColumn(zr,_t)._filterMultiple?{name:"content",fn:E.withCtx(()=>[E.createElementVNode("div",{class:E.normalizeClass([me.prefixCls+"-filter-list"])},[E.createElementVNode("div",{class:E.normalizeClass([me.prefixCls+"-filter-list-item"])},[E.createVNode(Ze,{modelValue:ve.getColumn(zr,_t)._filterChecked,"onUpdate:modelValue":ni=>ve.getColumn(zr,_t)._filterChecked=ni},{default:E.withCtx(()=>[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Fr.filters,(ni,on)=>(E.openBlock(),E.createBlock(tt,{key:on,label:ni.value},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(ni.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])],2),E.createElementVNode("div",{class:E.normalizeClass([me.prefixCls+"-filter-footer"])},[E.createVNode(it,{type:"text",size:"small",disabled:!ve.getColumn(zr,_t)._filterChecked.length,onClick:ni=>ve.handleFilter(ve.getColumn(zr,_t)._index)},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(K.t("i.table.confirmFilter")),1)]),_:2},1032,["disabled","onClick"]),E.createVNode(it,{type:"text",size:"small",onClick:ni=>ve.handleReset(ve.getColumn(zr,_t)._index)},{default:E.withCtx(()=>[E.createTextVNode(E.toDisplayString(K.t("i.table.resetFilter")),1)]),_:2},1032,["onClick"])],2)],2)]),key:"0"}:{name:"content",fn:E.withCtx(()=>[E.createElementVNode("div",{class:E.normalizeClass([me.prefixCls+"-filter-list"])},[E.createElementVNode("ul",{class:E.normalizeClass([me.prefixCls+"-filter-list-single"])},[E.createElementVNode("li",{class:E.normalizeClass(ve.itemAllClasses(ve.getColumn(zr,_t))),onClick:ni=>ve.handleReset(ve.getColumn(zr,_t)._index)},E.toDisplayString(K.t("i.table.clearFilter")),11,["onClick"]),(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Fr.filters,ni=>(E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.itemClasses(ve.getColumn(zr,_t),ni)),key:ni.value,onClick:on=>ve.handleSelect(ve.getColumn(zr,_t)._index,ni.value)},E.toDisplayString(ni.label),11,["onClick"]))),128))],2)],2)]),key:"1"}]),1032,["modelValue","onUpdate:modelValue","onOnPopperHide"])):E.createCommentVNode("",!0)],64))],2),Fr.resizable?(E.openBlock(),E.createElementBlock("div",{key:0,class:"ivu-table-header-resizable",onMousedown:ni=>ve.handleMouseDown(Fr,ni),onMousemove:ni=>ve.handleMouseMove(Fr,ni),onMouseout:se[0]||(se[0]=(...ni)=>ve.handleMouseOut&&ve.handleMouseOut(...ni))},null,40,ZT)):E.createCommentVNode("",!0)],10,XT))),128)),K.$parent.showVerticalScrollBar&&zr===0?(E.openBlock(),E.createElementBlock("th",{key:0,class:E.normalizeClass(ve.scrollBarCellClass()),rowspan:ve.headRows.length},null,10,JT)):E.createCommentVNode("",!0)]))),128))])],4)}var tE=Y(GT,[["render",eE]]);const rE={props:{row:Object,prefixCls:String,draggable:Boolean,isChildren:Boolean},computed:{objData(){return this.$parent.objData}},methods:{onDrag(K,se){K.dataTransfer.setData("index",se)},onDrop(K,se){const me=K.dataTransfer.getData("index");this.$parent.$parent.dragAndDrop(me,se),K.preventDefault()},allowDrop(K){K.preventDefault()},rowClasses(K){const se=this.isChildren?this.$parent.$parent.getDataByRowKey(this.row._rowKey):this.objData[K];return[`${this.prefixCls}-row`,this.rowClsName(K),{[`${this.prefixCls}-row-highlight`]:se&&se._isHighlight,[`${this.prefixCls}-row-hover`]:se&&se._isHover}]},rowClsName(K){return this.$parent.$parent.rowClassName(this.objData[K],K)}}},iE=["draggable"];function nE(K,se,me,Be,Re,ve){return me.draggable?(E.openBlock(),E.createElementBlock("tr",{key:0,class:E.normalizeClass(ve.rowClasses(me.row._index)),draggable:me.draggable,onDragstart:se[0]||(se[0]=Fe=>ve.onDrag(Fe,me.row._index)),onDrop:se[1]||(se[1]=Fe=>ve.onDrop(Fe,me.row._index)),onDragover:se[2]||(se[2]=Fe=>ve.allowDrop(Fe))},[E.renderSlot(K.$slots,"default")],42,iE)):(E.openBlock(),E.createElementBlock("tr",{key:1,class:E.normalizeClass(ve.rowClasses(me.row._index)),draggable:!1},[E.renderSlot(K.$slots,"default")],2))}var Nh=Y(rE,[["render",nE]]),$h={name:"TableExpand",props:{row:Object,render:Function,index:Number,column:{type:Object,default:null}},render(){const K={row:this.row,index:this.index};return this.column&&(K.column=this.column),this.render(E.h,K)}},sE={name:"TableSlot",inject:["TableInstance"],props:{row:Object,index:Number,column:{type:Object,default:null},display:{type:String,default:"block"}},render(){return E.h("div",{class:{"ivu-table-cell-slot":!0,"ivu-table-cell-slot-inline":this.display==="inline","ivu-table-cell-slot-inline-block":this.display==="inline-block"}},this.TableInstance.$slots[this.column.slot]({row:this.row,column:this.column,index:this.index}))}};const oE={name:"TableCell",components:{Icon:Ae,Checkbox:wa,TableExpand:$h,TableSlot:sE,Tooltip:To},inject:["TableInstance"],props:{prefixCls:String,row:Object,column:Object,naturalIndex:Number,index:Number,checked:Boolean,disabled:Boolean,expanded:Boolean,fixed:{type:[Boolean,String],default:!1},treeNode:Boolean,treeLevel:{type:Number,default:0}},data(){return{renderType:"",uid:-1,context:this.$parent.$parent.$parent.currentContext,showTooltip:!1}},computed:{classes(){return[`${this.prefixCls}-cell`,{[`${this.prefixCls}-hidden`]:!this.fixed&&this.column.fixed&&(this.column.fixed==="left"||this.column.fixed==="right"),[`${this.prefixCls}-cell-ellipsis`]:this.column.ellipsis||!1,[`${this.prefixCls}-cell-with-expand`]:this.renderType==="expand",[`${this.prefixCls}-cell-with-selection`]:this.renderType==="selection"}]},expandCls(){return[`${this.prefixCls}-cell-expand`,{[`${this.prefixCls}-cell-expand-expanded`]:this.expanded}]},showChildren(){let K=!1;if(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot"){const se=this.row;(se.children&&se.children.length||"_loading"in se)&&this.column.tree&&(K=!0)}return K},showTreeNode(){let K=!1;return(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot")&&this.column.tree&&this.treeNode&&(K=!0),K},showLevel(){let K=!1;return(this.renderType==="html"||this.renderType==="normal"||this.renderType==="render"||this.renderType==="slot")&&this.column.tree&&this.treeNode&&(K=!0),K},treeLevelStyle(){return{"padding-left":this.treeLevel*this.TableInstance.indentSize+"px"}},childrenExpand(){return this.TableInstance.getDataByRowKey(this.row._rowKey)._isShowChildren},childrenLoading(){const K=this.TableInstance.getDataByRowKey(this.row._rowKey);return"_loading"in K&&K._loading}},methods:{toggleSelect(){this.treeNode?this.$parent.$parent.$parent.toggleSelect(this.index,this.row._rowKey):this.$parent.$parent.$parent.toggleSelect(this.index)},toggleExpand(){this.$parent.$parent.$parent.toggleExpand(this.index)},handleClick(){},handleTooltipIn(){if(!W)return;const K=this.$refs.content;let se=document.createRange();se.setStart(K,0),se.setEnd(K,K.childNodes.length);const me=se.getBoundingClientRect().width;this.showTooltip=me>K.offsetWidth,se=null},handleToggleTree(){this.$parent.$parent.$parent.toggleTree(this.row._rowKey)}},created(){this.column.type==="index"?this.renderType="index":this.column.type==="selection"?this.renderType="selection":this.column.type==="html"?this.renderType="html":this.column.type==="expand"?this.renderType="expand":this.column.render?this.renderType="render":this.column.slot?this.renderType="slot":this.renderType="normal"}},aE={key:0},lE={key:4,class:"ivu-table-cell-tree ivu-table-cell-tree-empty"},cE=["innerHTML"],uE={key:1};function hE(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Checkbox"),Xe=E.resolveComponent("Icon"),tt=E.resolveComponent("Tooltip"),Ze=E.resolveComponent("table-expand"),it=E.resolveComponent("table-slot");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),ref:"cell"},[Re.renderType==="index"?(E.openBlock(),E.createElementBlock("span",aE,E.toDisplayString(me.column.indexMethod?me.column.indexMethod(me.row,me.naturalIndex):me.naturalIndex+1),1)):E.createCommentVNode("",!0),Re.renderType==="selection"?(E.openBlock(),E.createBlock(Fe,{key:1,"model-value":me.checked,onClick:E.withModifiers(ve.handleClick,["stop"]),onOnChange:ve.toggleSelect,disabled:me.disabled},null,8,["model-value","onClick","onOnChange","disabled"])):E.createCommentVNode("",!0),ve.showLevel?(E.openBlock(),E.createElementBlock("div",{key:2,class:"ivu-table-cell-tree-level",style:E.normalizeStyle(ve.treeLevelStyle)},null,4)):E.createCommentVNode("",!0),ve.showChildren?(E.openBlock(),E.createElementBlock("div",{key:3,class:E.normalizeClass(["ivu-table-cell-tree",{"ivu-table-cell-tree-loading":ve.childrenLoading}]),onClick:se[0]||(se[0]=E.withModifiers((...nr)=>ve.handleToggleTree&&ve.handleToggleTree(...nr),["prevent","stop"]))},[ve.childrenLoading?(E.openBlock(),E.createBlock(Xe,{key:0,type:"ios-loading",class:"ivu-load-loop"})):ve.childrenExpand?(E.openBlock(),E.createBlock(Xe,{key:2,type:"ios-remove"})):(E.openBlock(),E.createBlock(Xe,{key:1,type:"ios-add"}))],2)):ve.showTreeNode?(E.openBlock(),E.createElementBlock("div",lE)):E.createCommentVNode("",!0),Re.renderType==="html"?(E.openBlock(),E.createElementBlock("span",{key:5,innerHTML:me.row[me.column.key]},null,8,cE)):E.createCommentVNode("",!0),Re.renderType==="normal"?(E.openBlock(),E.createElementBlock(E.Fragment,{key:6},[me.column.tooltip?(E.openBlock(),E.createBlock(tt,{key:0,transfer:"",content:me.row[me.column.key],theme:me.column.tooltipTheme?me.column.tooltipTheme:ve.TableInstance.tooltipTheme,disabled:!Re.showTooltip,"max-width":me.column.tooltipMaxWidth?me.column.tooltipMaxWidth:ve.TableInstance.tooltipMaxWidth,class:"ivu-table-cell-tooltip"},{default:E.withCtx(()=>[E.createElementVNode("span",{ref:"content",onMouseenter:se[1]||(se[1]=(...nr)=>ve.handleTooltipIn&&ve.handleTooltipIn(...nr)),class:"ivu-table-cell-tooltip-content"},E.toDisplayString(me.row[me.column.key]),545)]),_:1},8,["content","theme","disabled","max-width"])):(E.openBlock(),E.createElementBlock("span",uE,E.toDisplayString(me.row[me.column.key]),1))],64)):E.createCommentVNode("",!0),Re.renderType==="expand"&&!me.row._disableExpand?(E.openBlock(),E.createElementBlock("div",{key:7,class:E.normalizeClass(ve.expandCls),onClick:se[2]||(se[2]=(...nr)=>ve.toggleExpand&&ve.toggleExpand(...nr))},[E.createVNode(Xe,{type:"ios-arrow-forward"})],2)):E.createCommentVNode("",!0),Re.renderType==="render"?(E.openBlock(),E.createBlock(Ze,{key:8,row:me.row,column:me.column,index:me.index,render:me.column.render},null,8,["row","column","index","render"])):E.createCommentVNode("",!0),Re.renderType==="slot"?(E.openBlock(),E.createBlock(it,{key:9,row:me.row,column:me.column,display:me.column.display||"block",index:me.index},null,8,["row","column","display","index"])):E.createCommentVNode("",!0)],2)}var Lh=Y(oE,[["render",hE]]);const dE={name:"TableBody",mixins:[Vh],components:{TableCell:Lh,Expand:$h,TableTr:Nh},props:{prefixCls:String,styleObject:Object,columns:Array,data:Array,objData:Object,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1},draggable:{type:Boolean,default:!1},rowKey:{type:[Boolean,String],default:!1}},computed:{expandRender(){let K=function(){return""};for(let se=0;se<this.columns.length;se++){const me=this.columns[se];me.type&&me.type==="expand"&&me.render&&(K=me.render)}return K}},methods:{rowChecked(K){return this.objData[K]&&this.objData[K]._isChecked},rowDisabled(K){return this.objData[K]&&this.objData[K]._isDisabled},rowExpanded(K){return this.objData[K]&&this.objData[K]._isExpanded},rowStatusByRowKey(K,se){return this.$parent.getDataByRowKey(se)[K]},handleMouseIn(K,se,me){se.stopPropagation(),this.$parent.handleMouseIn(K,me)},handleMouseOut(K,se,me){se.stopPropagation(),this.$parent.handleMouseOut(K,me)},clickCurrentRow(K,se,me){this.$parent.clickCurrentRow(K,me)},dblclickCurrentRow(K,se,me){se.stopPropagation(),this.$parent.dblclickCurrentRow(K,me)},clickCell(K,se,me,Be){this.$parent.$emit("on-cell-click",K,se,K[me],Be)},contextmenuCurrentRow(K,se,me){se.stopPropagation(),this.$parent.contextMenu&&se.preventDefault(),this.$parent.contextmenuCurrentRow(K,me,se)},selectStartCurrentRow(){this.$parent.contextMenu},getSpan(K,se,me,Be){const Re=this.$parent.spanMethod;if(typeof Re=="function"){const ve=Re({row:K,column:se,rowIndex:me,columnIndex:Be});let Fe=1,Xe=1;return Array.isArray(ve)?(Fe=ve[0],Xe=ve[1]):typeof ve=="object"&&(Fe=ve.rowspan,Xe=ve.colspan),{rowspan:Fe,colspan:Xe}}else return{}},showWithSpan(K,se,me,Be){const Re=this.getSpan(K,se,me,Be);return!("rowspan"in Re&&Re.rowspan===0||"colspan"in Re&&Re.colspan===0)},isTrShow(K){let se=!0,me;for(let Be in this.objData){const Re=this.objData[Be],ve=Re._isShowChildren;if(Re._rowKey===K){se=se&&ve;break}else if(Re.children&&Re.children.length&&(me=this.getTrStatus(K,Re,se&&ve),me[0]&&me[0]._rowKey===K))return me[1]}return se},getTrStatus(K,se,me){let Be=me,Re;if(se.children&&se.children.length)for(let ve=0;ve<se.children.length;ve++){const Fe=se.children[ve],Xe=Fe._isShowChildren;if(Fe._rowKey===K){Re=Fe,Be=Be&&Xe;break}else if(Fe.children&&Fe.children.length){const tt=this.getTrStatus(K,Fe,Be&&Xe);if(tt[0]&&tt[0]._rowKey===K)return tt}}return[Re,Be]},getLevel(K){let se,me;for(let Be=0;Be<this.data.length;Be++){const Re=this.data[Be];if(Re[this.rowKey]===K){se=0;break}else if(Re.children&&Re.children.length&&(me=this.getChildLevel(Re,K,1),me[0]&&me[0][this.rowKey]===K))return me[1]}return se},getChildLevel(K,se,me){let Be,Re;if(K.children&&K.children.length)for(let ve=0;ve<K.children.length;ve++){const Fe=K.children[ve];if(Fe[this.rowKey]===se){Re=Fe,Be=me;break}else if(Fe.children&&Fe.children.length){const Xe=this.getChildLevel(Fe,se,me+1);if(Xe[0]&&Xe[0][this.rowKey]===se)return Xe}}return[Re,Be]},getChildNode(K,se,me){return se.children&&se.children.length&&se.children.forEach((Be,Re)=>{let ve=[];this.columns.forEach((tt,Ze)=>{if(this.showWithSpan(Be,tt,Re,Ze)){const it=K(Lh,{fixed:this.fixed,"prefix-cls":this.prefixCls,row:Be,column:tt,"natural-index":Re,index:Be._index,checked:this.rowStatusByRowKey("_isChecked",Be._rowKey),disabled:this.rowStatusByRowKey("_isDisabled",Be._rowKey),expanded:this.rowStatusByRowKey("_isExpanded",Be._rowKey),treeNode:!0,treeLevel:this.getLevel(Be._rowKey),key:tt._columnKey}),nr=K("td",{class:this.alignCls(tt,Be),...this.getSpan(Be,tt,Re,Ze),onClick:jr=>this.clickCell(Be,tt,tt.key,jr)},[it]);ve.push(nr)}});const Fe={};this.isTrShow(se._rowKey)||(Fe.display="none");const Xe=K(Nh,{draggable:!1,row:Be,"prefix-cls":this.prefixCls,isChildren:!0,style:Fe,key:this.rowKey?Be._rowKey:Re,onMouseenter:tt=>this.handleMouseIn(Be._index,tt,Be._rowKey),onMouseleave:tt=>this.handleMouseOut(Be._index,tt,Be._rowKey),onClick:tt=>this.clickCurrentRow(Be._index,tt,Be._rowKey),onDblclick:tt=>this.dblclickCurrentRow(Be._index,tt,Be._rowKey),onContextmenu:tt=>this.contextmenuCurrentRow(Be._index,tt,Be._rowKey),onSelectstart:tt=>this.selectStartCurrentRow(Be._index,tt,Be._rowKey)},()=>ve);me.push(Xe),Be.children&&Be.children.length&&this.getChildNode(K,Be,me)}),me}},render(){let K=[];this.columns.forEach(Re=>{const ve=E.h("col",{width:this.setCellWidth(Re)});K.push(ve)});const se=E.h("colgroup",{},K);let me=[];this.data.forEach((Re,ve)=>{let Fe=[];this.columns.forEach((tt,Ze)=>{if(this.showWithSpan(Re,tt,ve,Ze)){const it=E.h(Lh,{fixed:this.fixed,"prefix-cls":this.prefixCls,row:Re,column:tt,"natural-index":ve,index:Re._index,checked:this.rowChecked(Re._index),disabled:this.rowDisabled(Re._index),expanded:this.rowExpanded(Re._index),key:tt._columnKey}),nr=E.h("td",{class:this.alignCls(tt,Re),...this.getSpan(Re,tt,ve,Ze),onClick:jr=>this.clickCell(Re,tt,tt.key,jr)},[it]);Fe.push(nr)}});const Xe=E.h(Nh,{draggable:this.draggable,row:Re,"prefix-cls":this.prefixCls,key:this.rowKey?Re._rowKey:ve,onMouseenter:tt=>this.handleMouseIn(Re._index,tt),onMouseleave:tt=>this.handleMouseOut(Re._index,tt),onClick:tt=>this.clickCurrentRow(Re._index,tt),onDblclick:tt=>this.dblclickCurrentRow(Re._index,tt),onContextmenu:tt=>this.contextmenuCurrentRow(Re._index,tt),onSelectstart:tt=>this.selectStartCurrentRow(Re._index,tt)},()=>Fe);if(me.push(Xe),this.rowExpanded(Re._index)){const tt=E.h($h,{row:Re,render:this.expandRender,index:Re._index,key:this.rowKey?Re._rowKey:ve}),Ze=E.h("td",{colspan:this.columns.length,class:this.prefixCls+"-expanded-cell"},[tt]),it=E.h("tr",{class:{[this.prefixCls+"-expanded-hidden"]:this.fixed}},[Ze]);me.push(it)}Re.children&&Re.children.length&&this.getChildNode(E.h,Re,[]).forEach(tt=>{me.push(tt)})});const Be=E.h("tbody",{class:this.prefixCls+"-tbody"},[me]);return E.h("table",{cellspacing:"0",cellpadding:"0",border:"0",style:this.styleObject},[se,Be])}},pE={name:"TableSummary",mixins:[Vh],props:{prefixCls:String,styleObject:Object,columns:Array,data:Object,columnsWidth:Object,fixed:{type:[Boolean,String],default:!1}},methods:{cellCls(K){return[{"ivu-table-hidden":this.fixed==="left"&&K.fixed!=="left"||this.fixed==="right"&&K.fixed!=="right"||!this.fixed&&K.fixed&&(K.fixed==="left"||K.fixed==="right")}]}}},fE={style:{overflow:"hidden"}},mE=["width"],gE={class:"ivu-table-row"};function yE(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("div",fE,[E.createElementVNode("table",{class:"ivu-table-summary",cellspacing:"0",cellpadding:"0",border:"0",style:E.normalizeStyle(me.styleObject)},[E.createElementVNode("colgroup",null,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.columns,(Fe,Xe)=>(E.openBlock(),E.createElementBlock("col",{key:Xe,width:K.setCellWidth(Fe)},null,8,mE))),128))]),E.createElementVNode("tbody",{class:E.normalizeClass([me.prefixCls+"-tbody"])},[E.createElementVNode("tr",gE,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.columns,(Fe,Xe)=>(E.openBlock(),E.createElementBlock("td",{key:Xe,class:E.normalizeClass(K.alignCls(Fe))},[E.createElementVNode("div",{class:E.normalizeClass(["ivu-table-cell",ve.cellCls(Fe)])},[E.createElementVNode("span",null,E.toDisplayString(me.data[Fe.key].value),1)],2)],2))),128))])],2)],4)])}var _E=Y(pE,[["render",yE]]);const vE=`\r
`,Fh=(K,se,{separator:me,quoted:Be})=>{const Re=se.map(ve=>Be?(ve=typeof ve=="string"?ve.replace(/"/g,'"'):ve,`"${ve}"`):ve);K.push(Re.join(me))},bE={separator:",",quoted:!1};function xE(K,se,me,Be=!1){me=Object.assign({},bE,me);let Re;const ve=[],Fe=[];return K?(Re=K.map(Xe=>typeof Xe=="string"?Xe:(Be||Fe.push(typeof Xe.title<"u"?Xe.title:Xe.key),Xe.key)),Fe.length>0&&Fh(ve,Fe,me)):(Re=[],se.forEach(Xe=>{Array.isArray(Xe)||(Re=Re.concat(Object.keys(Xe)))}),Re.length>0&&(Re=Re.filter((Xe,tt,Ze)=>Ze.indexOf(Xe)===tt),Be||Fh(ve,Re,me))),Array.isArray(se)&&se.forEach(Xe=>{Array.isArray(Xe)||(Xe=Re.map(tt=>typeof Xe[tt]<"u"?Xe[tt]:"")),Fh(ve,Xe,me)}),ve.join(vE)}function Uh(K){const se=navigator.userAgent;return se.indexOf("compatible")>-1&&se.indexOf("MSIE")>-1?(new RegExp("MSIE (\\d+\\.\\d+);").test(se),parseFloat(RegExp.$1)):!1}const SE={_isIE11(){let K=0;const se=/MSIE (\d+\.\d+);/.test(navigator.userAgent),me=!!navigator.userAgent.match(/Trident\/7.0/),Be=navigator.userAgent.indexOf("rv:11.0");return se&&(K=Number(RegExp.$1)),navigator.appVersion.indexOf("MSIE 10")!==-1&&(K=10),me&&Be!==-1&&(K=11),K===11},_isEdge(){return/Edge/.test(navigator.userAgent)},_getDownloadUrl(K){const se="\uFEFF";if(W&&window.Blob&&window.URL&&window.URL.createObjectURL){const me=new Blob([se+K],{type:"text/csv"});return URL.createObjectURL(me)}else return"data:attachment/csv;charset=utf-8,"+se+encodeURIComponent(K)},download(K,se){if(W)if(Uh()&&Uh()<10){const me=window.top.open("about:blank","_blank");me.document.charset="utf-8",me.document.write(se),me.document.close(),me.document.execCommand("SaveAs",K),me.close()}else if(Uh()===10||this._isIE11()||this._isEdge()){const me="\uFEFF",Be=new Blob([me+se],{type:"text/csv"});navigator.msSaveBlob(Be,K)}else{const me=document.createElement("a");me.download=K,me.href=this._getDownloadUrl(se),document.body.appendChild(me),me.click(),document.body.removeChild(me)}}},ou=(K,se)=>{let me=[],Be=[];return K.forEach(Re=>{Re.fixed&&Re.fixed===se?me.push(Re):Be.push(Re)}),me.concat(Be)},$l=(K,se=!1)=>{const me=Qe(K),Be=[];return me.forEach(Re=>{Re.children?(se&&Be.push(Re),Be.push.apply(Be,$l(Re.children,se))):Be.push(Re)}),Be},wE=(K,se=!1)=>{const me=Qe(se?se==="left"?ou(K,"left"):ou(K,"right"):K);let Be=1;const Re=(Fe,Xe)=>{if(Xe&&(Fe.level=Xe.level+1,Be<Fe.level&&(Be=Fe.level)),Fe.children){let tt=0;Fe.children.forEach(Ze=>{Re(Ze,Fe),tt+=Ze.colSpan}),Fe.colSpan=tt}else Fe.colSpan=1};me.forEach(Fe=>{Fe.level=1,Re(Fe)});const ve=[];for(let Fe=0;Fe<Be;Fe++)ve.push([]);return $l(me,!0).forEach(Fe=>{Fe.children?Fe.rowSpan=1:Fe.rowSpan=Be-Fe.level+1,ve[Fe.level-1].push(Fe)}),ve},OE=function(K=32){const se="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",me=se.length;let Be="";for(let Re=0;Re<K;Re++)Be+=se.charAt(Math.floor(Math.random()*me));return Be},gs="ivu-table";let Em=1,CE=1;const TE={name:"Table",mixins:[Xn],components:{tableHead:tE,tableBody:dE,tableSummary:_E,Spin:Xs,Dropdown:ca,DropdownMenu:ua},emits:["on-current-change","on-row-click","on-row-dblclick","on-contextmenu","on-select","on-select-cancel","on-selection-change","on-expand","on-expand-tree","on-select-all","on-select-all-cancel","on-sort-change","on-filter-change","on-drag-drop","on-cell-click","on-column-width-resize"],provide(){return{TableInstance:this}},inject:{TabsInstance:{default:null},ModalInstance:{default:null},DrawerInstance:{default:null}},props:{data:{type:Array,default(){return[]}},columns:{type:Array,default(){return[]}},size:{validator(K){return Ie(K,["small","large","default"])},default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.size===""?"default":K.$VIEWUI.size}},width:{type:[Number,String]},height:{type:[Number,String]},maxHeight:{type:[Number,String]},stripe:{type:Boolean,default:!1},border:{type:Boolean,default:!1},showHeader:{type:Boolean,default:!0},highlightRow:{type:Boolean,default:!1},rowClassName:{type:Function,default(){return""}},context:{type:Object},noDataText:{type:String},noFilteredDataText:{type:String},disabledHover:{type:Boolean},loading:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},tooltipTheme:{validator(K){return Ie(K,["dark","light"])},default:"dark"},tooltipMaxWidth:{type:Number,default:300},rowKey:{type:[Boolean,String],default:!1},spanMethod:{type:Function},showSummary:{type:Boolean,default:!1},summaryMethod:{type:Function},sumText:{type:String},indentSize:{type:Number,default:16},loadData:{type:Function},updateShowChildren:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},showContextMenu:{type:Boolean,default:!1},fixedShadow:{validator(K){return Ie(K,["auto","show","hide"])},default:"show"},autoCloseContextmenu:{type:Boolean,default:!0}},data(){const K=this.makeColumnsId(this.columns);return{ready:!1,tableWidth:0,columnsWidth:{},prefixCls:gs,compiledUids:[],objData:this.makeObjData(),rebuildData:[],cloneColumns:this.makeColumns(K),columnRows:this.makeColumnRows(!1,K),leftFixedColumnRows:this.makeColumnRows("left",K),rightFixedColumnRows:this.makeColumnRows("right",K),allColumns:$l(K),showSlotHeader:!0,showSlotFooter:!0,bodyHeight:0,scrollBarWidth:$e(),currentContext:this.context,cloneData:Qe(this.data),showVerticalScrollBar:!1,showHorizontalScrollBar:!1,headerWidth:0,headerHeight:0,showResizeLine:!1,contextMenuVisible:!1,contextMenuStyles:{top:0,left:0},scrollOnTheLeft:!1,scrollOnTheRight:!1,id:gt(6)}},computed:{localeNoDataText(){return this.noDataText===void 0?this.t("i.table.noDataText"):this.noDataText},localeNoFilteredDataText(){return this.noFilteredDataText===void 0?this.t("i.table.noFilteredDataText"):this.noFilteredDataText},localeSumText(){return this.sumText===void 0?this.t("i.table.sumText"):this.sumText},wrapClasses(){return[`${gs}-wrapper`,{[`${gs}-hide`]:!this.ready,[`${gs}-with-header`]:this.showSlotHeader,[`${gs}-with-footer`]:this.showSlotFooter,[`${gs}-with-summary`]:this.showSummary,[`${gs}-wrapper-with-border`]:this.border}]},classes(){return[`${gs}`,{[`${gs}-${this.size}`]:!!this.size,[`${gs}-border`]:this.border,[`${gs}-stripe`]:this.stripe,[`${gs}-with-fixed-top`]:!!this.height}]},fixedTableClasses(){return[`${gs}-fixed`,{[`${gs}-fixed-shadow`]:this.fixedShadow==="show"||this.fixedShadow==="auto"&&!this.scrollOnTheLeft}]},fixedRightTableClasses(){return[`${gs}-fixed-right`,{[`${gs}-fixed-shadow`]:this.fixedShadow==="show"||this.fixedShadow==="auto"&&!this.scrollOnTheRight}]},fixedHeaderClasses(){return[`${gs}-fixed-header`,{[`${gs}-fixed-header-with-empty`]:!this.rebuildData.length}]},styles(){let K={},se=0;if(this.showSummary&&(this.size==="small"?se=40:this.size==="large"?se=60:se=48),this.height){let me=parseInt(this.height)+se;K.height=`${me}px`}if(this.maxHeight){const me=parseInt(this.maxHeight)+se;K.maxHeight=`${me}px`}return this.width&&(K.width=`${this.width}px`),K},tableStyle(){let K={};if(this.tableWidth!==0){let se="";this.bodyHeight===0?se=this.tableWidth:se=this.tableWidth-(this.showVerticalScrollBar?this.scrollBarWidth:0),K.width=`${se}px`}return K},tableHeaderStyle(){let K={};if(this.tableWidth!==0){let se="";se=this.tableWidth,K.width=`${se}px`}return K},fixedTableStyle(){let K={},se=0;return this.leftFixedColumns.forEach(me=>{me.fixed&&me.fixed==="left"&&(se+=me._width)}),K.width=`${se}px`,K},fixedRightTableStyle(){let K={},se=0;return this.rightFixedColumns.forEach(me=>{me.fixed&&me.fixed==="right"&&(se+=me._width)}),K.width=`${se}px`,K.right=`${this.showVerticalScrollBar?this.scrollBarWidth:0}px`,K},fixedRightHeaderStyle(){let K={},se=0,me=this.headerHeight+1;return this.showVerticalScrollBar&&(se=this.scrollBarWidth),K.width=`${se}px`,K.height=`${me}px`,K},bodyStyle(){let K={};if(this.bodyHeight!==0){const se=this.bodyHeight;this.height?K.height=`${se}px`:this.maxHeight&&(K.maxHeight=`${se}px`)}return K},fixedBodyStyle(){let K={};if(this.bodyHeight!==0){let se=this.bodyHeight-(this.showHorizontalScrollBar?this.scrollBarWidth:0);const me=this.showHorizontalScrollBar?`${se}px`:`${se-1}px`;this.height?K.height=me:this.maxHeight&&(K.maxHeight=me)}return K},leftFixedColumns(){return ou(this.cloneColumns,"left")},rightFixedColumns(){return ou(this.cloneColumns,"right")},isLeftFixed(){return this.columns.some(K=>K.fixed&&K.fixed==="left")},isRightFixed(){return this.columns.some(K=>K.fixed&&K.fixed==="right")},summaryData(){if(!this.showSummary)return{};let K={};return this.summaryMethod?K=this.summaryMethod({columns:this.cloneColumns,data:this.rebuildData}):this.cloneColumns.forEach((se,me)=>{const Be=se.key;if(me===0){K[Be]={key:se.key,value:this.localeSumText};return}const Re=this.rebuildData.map(tt=>Number(tt[se.key])),ve=[];let Fe=!0;Re.forEach(tt=>{if(!isNaN(tt)){Fe=!1;let Ze=(""+tt).split(".")[1];ve.push(Ze?Ze.length:0)}});const Xe=Math.max.apply(null,ve);if(Fe)K[Be]={key:se.key,value:""};else{const tt=Re.reduce((Ze,it)=>{const nr=Number(it);return isNaN(nr)?Ze:parseFloat((Ze+it).toFixed(Math.min(Xe,20)))},0);K[Be]={key:se.key,value:tt}}}),K}},methods:{rowClsName(K){return this.rowClassName(this.data[K],K)},handleResize(){let K=this.$el.offsetWidth-1,se={},me=0,Be=[],Re=[],ve=[];this.cloneColumns.forEach(it=>{it.width?Be.push(it):(Re.push(it),it.minWidth&&(me+=it.minWidth),it.maxWidth||ve.push(it)),it._width=null});let Fe=Be.map(it=>it.width).reduce((it,nr)=>it+nr,0),Xe=K-Fe-me-(this.showVerticalScrollBar?this.scrollBarWidth:0)-1,tt=Re.length,Ze=0;Xe>0&&tt>0&&(Ze=parseInt(Xe/tt));for(let it=0;it<this.cloneColumns.length;it++){const nr=this.cloneColumns[it];let jr=Ze+(nr.minWidth?nr.minWidth:0);nr.width?jr=nr.width:nr._width?jr=nr._width:(nr.minWidth>jr?jr=nr.minWidth:nr.maxWidth<jr&&(jr=nr.maxWidth),Xe>0?(Xe-=jr-(nr.minWidth?nr.minWidth:0),tt--,tt>0?Ze=parseInt(Xe/tt):Ze=0):Ze=0),nr._width=jr,se[nr._index]={width:jr}}if(Xe>0){tt=ve.length,Ze=parseInt(Xe/tt);for(let it=0;it<ve.length;it++){const nr=ve[it];let jr=nr._width+Ze;tt>1?(tt--,Xe-=Ze,Ze=parseInt(Xe/tt)):Ze=0,nr._width=jr,se[nr._index]={width:jr}}}this.tableWidth=this.cloneColumns.map(it=>it._width).reduce((it,nr)=>it+nr,0)+(this.showVerticalScrollBar?this.scrollBarWidth:0)+1,this.columnsWidth=se,this.fixedHeader(),this.fixedShadow==="auto"&&E.nextTick(()=>{const it=this.$refs.body;this.scrollOnTheLeft=it.scrollLeft===0,this.scrollOnTheRight=it.scrollWidth===it.scrollLeft+it.clientWidth})},handleMouseIn(K,se){if(this.disabledHover)return;const me=se?this.getDataByRowKey(se):this.objData[K];me._isHover||(me._isHover=!0)},handleMouseOut(K,se){if(this.disabledHover)return;const me=se?this.getDataByRowKey(se):this.objData[K];me._isHover=!1},handleCurrentRow(K,se,me){const Be=me?this.getDataByRowKey(me):this.objData[se];let Re=null,ve=-1;for(let Xe in this.objData)if(this.objData[Xe]._isHighlight){ve=parseInt(Xe),this.objData[Xe]._isHighlight=!1;break}else if(this.objData[Xe].children&&this.objData[Xe].children.length){const tt=this.handleResetChildrenRow(this.objData[Xe]);tt&&(Re=JSON.parse(JSON.stringify(tt)))}K==="highlight"&&(Be._isHighlight=!0),ve>=0&&(Re=JSON.parse(JSON.stringify(this.cloneData[ve])));const Fe=K==="highlight"?JSON.parse(JSON.stringify(me?this.getBaseDataByRowKey(me):this.cloneData[se])):null;this.$emit("on-current-change",Fe,Re)},handleResetChildrenRow(K){let se=null;if(K.children&&K.children.length)for(let me=0;me<K.children.length;me++){const Be=K.children[me];if(Be._isHighlight){Be._isHighlight=!1,se=Be;break}else Be.children&&Be.children.length&&(se=this.handleResetChildrenRow(Be))}return se},highlightCurrentRow(K,se){const me=se?this.getDataByRowKey(se):this.objData[K];!this.highlightRow||me._isHighlight||this.handleCurrentRow("highlight",K,se)},clearCurrentRow(){!this.highlightRow||this.handleCurrentRow("clear")},clickCurrentRow(K,se){this.highlightCurrentRow(K,se),se?this.$emit("on-row-click",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(se)))):this.$emit("on-row-click",JSON.parse(JSON.stringify(this.cloneData[K])),K)},dblclickCurrentRow(K,se){this.highlightCurrentRow(K,se),se?this.$emit("on-row-dblclick",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(se)))):this.$emit("on-row-dblclick",JSON.parse(JSON.stringify(this.cloneData[K])),K)},contextmenuCurrentRow(K,se,me){this.contextMenuVisible&&this.handleClickContextMenuOutside(),E.nextTick(()=>{const Be=this.$refs.tableWrap.getBoundingClientRect(),Re={left:`${me.clientX-Be.left}px`,top:`${me.clientY-Be.top}px`};this.contextMenuStyles=Re,this.contextMenuVisible=!0,se?this.$emit("on-contextmenu",JSON.parse(JSON.stringify(this.getBaseDataByRowKey(se))),me,Re):this.$emit("on-contextmenu",JSON.parse(JSON.stringify(this.cloneData[K])),me,Re)})},getSelection(){let K=[],se=[];for(let Be in this.objData){const Re=this.objData[Be];Re._isChecked&&K.push(parseInt(Be)),Re.children&&Re.children.length&&(se=se.concat(this.getSelectionChildrenRowKeys(Re,se)))}se=[...new Set(se)];let me=[];return this.data.forEach((Be,Re)=>{K.indexOf(Re)>-1&&(me=me.concat(Be)),Be.children&&Be.children.length&&se.length&&(me=me.concat(this.getSelectionChildren(Be,me,se)))}),me=[...new Set(me)],JSON.parse(JSON.stringify(me))},getSelectionChildrenRowKeys(K,se){return K.children&&K.children.length&&K.children.forEach(me=>{me._isChecked&&se.push(me._rowKey),me.children&&me.children.length&&(se=se.concat(this.getSelectionChildrenRowKeys(me,se)))}),se},getSelectionChildren(K,se,me){return K.children&&K.children.length&&K.children.forEach(Be=>{me.indexOf(Be[this.rowKey])>-1&&(se=se.concat(Be)),Be.children&&Be.children.length&&(se=se.concat(this.getSelectionChildren(Be,se,me)))}),se},toggleSelect(K,se){let me={};if(se)me=this.getDataByRowKey(se);else for(let Fe in this.objData)if(parseInt(Fe)===K){me=this.objData[Fe];break}const Be=!me._isChecked;me._isChecked=Be;const Re=this.getSelection(),ve=se?this.getBaseDataByRowKey(se,this.data):this.data[K];this.$emit(Be?"on-select":"on-select-cancel",Re,JSON.parse(JSON.stringify(ve))),this.$emit("on-selection-change",Re)},toggleExpand(K){let se={};for(let Be in this.objData)if(parseInt(Be)===K){se=this.objData[Be];break}const me=!se._isExpanded;this.objData[K]._isExpanded=me,this.$emit("on-expand",JSON.parse(JSON.stringify(this.cloneData[K])),me),(this.height||this.maxHeight)&&E.nextTick(()=>this.fixedBody())},toggleTree(K){const se=this.getDataByRowKey(K);if(!("_loading"in se&&se._loading)){if("_loading"in se&&!se._loading&&se.children.length===0){const me=this.getBaseDataByRowKey(K,this.data);me._loading=!0,this.loadData(me,Be=>{me._loading=!1,Be.length&&(me.children=Be,E.nextTick(()=>{const Re=this.getDataByRowKey(K);Re._isShowChildren=!Re._isShowChildren,this.updateDataStatus(K,"_showChildren",Re._isShowChildren)}))});return}se._isShowChildren=!se._isShowChildren,this.updateShowChildren&&this.updateDataStatus(K,"_showChildren",se._isShowChildren),this.$emit("on-expand-tree",K,se._isShowChildren)}},updateDataStatus(K,se,me){const Be=this.getBaseDataByRowKey(K,this.data);Be[se]=me},getDataByRowKey(K,se=this.objData){let me=null;for(let Be in se){const Re=se[Be];if(Re._rowKey===K){me=Re;break}else if(Re.children&&Re.children.length&&(me=this.getChildrenByRowKey(K,Re),me))break}return me},getChildrenByRowKey(K,se){let me=null;if(se.children&&se.children.length)for(let Be=0;Be<se.children.length;Be++){const Re=se.children[Be];if(Re._rowKey===K){me=Re;break}else if(Re.children&&Re.children.length&&(me=this.getChildrenByRowKey(K,Re),me))break}return me},getBaseDataByRowKey(K,se=this.cloneData){let me=null;for(let Be=0;Be<se.length;Be++){const Re=se[Be];if(Re[this.rowKey]===K){me=Re;break}else if(Re.children&&Re.children.length&&(me=this.getChildrenDataByRowKey(K,Re),me&&me[this.rowKey]===K))return me}return me},getChildrenDataByRowKey(K,se){let me=null;if(se.children&&se.children.length)for(let Be=0;Be<se.children.length;Be++){const Re=se.children[Be];if(Re[this.rowKey]===K){me=Re;break}else if(Re.children&&Re.children.length&&(me=this.getChildrenDataByRowKey(K,Re),me))break}return me},selectAll(K){for(const me of this.rebuildData){const Be=this.objData[me._index];Be._isDisabled||(Be._isChecked=K),me.children&&me.children.length&&this.selectAllChildren(Be,K)}const se=this.getSelection();K?this.$emit("on-select-all",se):this.$emit("on-select-all-cancel",se),this.$emit("on-selection-change",se)},selectAllChildren(K,se){K.children&&K.children.length&&K.children.map(me=>{me._isDisabled||(me._isChecked=se),me.children&&me.children.length&&this.selectAllChildren(me,se)})},fixedHeader(){this.height||this.maxHeight?E.nextTick(()=>{const K=parseInt(He(this.$refs.title,"height"))||0,se=parseInt(He(this.$refs.header,"height"))||0,me=parseInt(He(this.$refs.footer,"height"))||0;this.height?this.bodyHeight=this.height-K-se-me:this.maxHeight&&(this.bodyHeight=this.maxHeight-K-se-me),E.nextTick(()=>this.fixedBody())}):(this.bodyHeight=0,E.nextTick(()=>this.fixedBody()))},fixedBody(){if(this.$refs.header&&(this.headerWidth=this.$refs.header.children[0].offsetWidth,this.headerHeight=this.$refs.header.children[0].offsetHeight),!this.$refs.tbody||!this.data||this.data.length===0)this.showVerticalScrollBar=!1;else{let K=this.$refs.tbody.$el,se=K.parentElement,me=K.offsetHeight,Be=se.offsetHeight;this.showHorizontalScrollBar=se.offsetWidth<K.offsetWidth+(this.showVerticalScrollBar?this.scrollBarWidth:0),this.showVerticalScrollBar=this.bodyHeight?Be-(this.showHorizontalScrollBar?this.scrollBarWidth:0)<me:!1,this.showVerticalScrollBar?se.classList.add(this.prefixCls+"-overflowY"):se.classList.remove(this.prefixCls+"-overflowY"),this.showHorizontalScrollBar?se.classList.add(this.prefixCls+"-overflowX"):se.classList.remove(this.prefixCls+"-overflowX")}},hideColumnFilter(){this.cloneColumns.forEach(K=>K._filterVisible=!1)},handleBodyScroll(K){this.scrollOnTheLeft=K.target.scrollLeft===0,this.scrollOnTheRight=K.target.scrollWidth===K.target.scrollLeft+K.target.clientWidth,this.showHeader&&(this.$refs.header.scrollLeft=K.target.scrollLeft),this.isLeftFixed&&(this.$refs.fixedBody.scrollTop=K.target.scrollTop),this.isRightFixed&&(this.$refs.fixedRightBody.scrollTop=K.target.scrollTop),this.showSummary&&this.$refs.summary&&(this.$refs.summary.$el.scrollLeft=K.target.scrollLeft),this.hideColumnFilter()},handleFixedMousewheel(K){let se=K.deltaY;if(!se&&K.detail&&(se=K.detail*40),!se&&K.wheelDeltaY&&(se=-K.wheelDeltaY),!se&&K.wheelDelta&&(se=-K.wheelDelta),!se)return;const me=this.$refs.body,Be=me.scrollTop;se<0&&Be!==0&&K.preventDefault(),se>0&&me.scrollHeight-me.clientHeight>Be&&K.preventDefault();let Re=0,ve=setInterval(()=>{Re+=5,se>0?me.scrollTop+=2:me.scrollTop-=2,Re>=Math.abs(se)&&clearInterval(ve)},5)},handleMouseWheel(K){const se=K.deltaX,me=this.$refs.body;se>0?me.scrollLeft=me.scrollLeft+10:me.scrollLeft=me.scrollLeft-10},sortData(K,se,me){const Be=this.cloneColumns[me].key;K.sort((Re,ve)=>{if(this.cloneColumns[me].sortMethod)return this.cloneColumns[me].sortMethod(Re[Be],ve[Be],se);if(se==="asc")return Re[Be]>ve[Be]?1:-1;if(se==="desc")return Re[Be]<ve[Be]?1:-1});for(let Re=0;Re<K.length;Re++)K[Re].children&&K[Re].children.length&&(K[Re].children=this.sortData(K[Re].children,se,me));return K},handleSort(K,se){const me=this.GetOriginalIndex(K);this.cloneColumns.forEach(Re=>Re._sortType="normal");const Be=this.cloneColumns[me].key;this.cloneColumns[me].sortable!=="custom"&&(se==="normal"?this.rebuildData=this.makeDataWithFilter():this.rebuildData=this.sortData(this.rebuildData,se,me)),this.cloneColumns[me]._sortType=se,this.$emit("on-sort-change",{column:JSON.parse(JSON.stringify(this.allColumns[this.cloneColumns[me]._index])),key:Be,order:se})},handleFilterHide(K){this.cloneColumns[K]._isFiltered||(this.cloneColumns[K]._filterChecked=[])},filterData(K,se){return K.filter(me=>{if(typeof se.filterRemote=="function")return!0;let Be=!se._filterChecked.length;for(let Re=0;Re<se._filterChecked.length&&(Be=se.filterMethod(se._filterChecked[Re],me),!Be);Re++);return Be})},filterOtherData(K,se){let me=this.cloneColumns[se];return typeof me.filterRemote=="function"&&me.filterRemote.call(this.$parent,me._filterChecked,me.key,me),this.cloneColumns.forEach((Be,Re)=>{Re!==se&&(K=this.filterData(K,Be))}),K},handleFilter(K){const se=this.cloneColumns[K];let me=this.makeDataWithSort();me=this.filterOtherData(me,K),this.rebuildData=this.filterData(me,se),this.cloneColumns[K]._isFiltered=!0,this.cloneColumns[K]._filterVisible=!1,this.$emit("on-filter-change",se)},GetOriginalIndex(K){return this.cloneColumns.findIndex(se=>se._index===K)},handleFilterSelect(K,se){const me=this.GetOriginalIndex(K);this.cloneColumns[me]._filterChecked=[se],this.handleFilter(me)},handleFilterReset(K){const se=this.GetOriginalIndex(K);this.cloneColumns[se]._isFiltered=!1,this.cloneColumns[se]._filterVisible=!1,this.cloneColumns[se]._filterChecked=[];let me=this.makeDataWithSort();me=this.filterOtherData(me,se),this.rebuildData=me,this.$emit("on-filter-change",this.cloneColumns[se])},makeData(){let K=Qe(this.data);return K.forEach((se,me)=>{se._index=me,se._rowKey=typeof this.rowKey=="string"?se[this.rowKey]:Em++,se.children&&se.children.length&&(se.children=this.makeChildrenData(se))}),K},makeChildrenData(K){return K.children&&K.children.length?K.children.map((se,me)=>{const Be=Qe(se);return Be._index=me,Be._rowKey=typeof this.rowKey=="string"?Be[this.rowKey]:Em++,Be.children&&Be.children.length&&(Be.children=this.makeChildrenData(Be)),Be}):K},makeDataWithSort(){let K=this.makeData(),se="normal",me=-1,Be=!1;for(let Re=0;Re<this.cloneColumns.length;Re++)if(this.cloneColumns[Re]._sortType!=="normal"){se=this.cloneColumns[Re]._sortType,me=Re,Be=this.cloneColumns[Re].sortable==="custom";break}return se!=="normal"&&!Be&&(K=this.sortData(K,se,me)),K},makeDataWithFilter(){let K=this.makeData();return this.cloneColumns.forEach(se=>K=this.filterData(K,se)),K},makeDataWithSortAndFilter(){let K=this.makeDataWithSort();return this.cloneColumns.forEach(se=>K=this.filterData(K,se)),K},makeObjBaseData(K){const se=Qe(K);return typeof this.rowKey=="string"&&(se._rowKey=se[this.rowKey]),se._isHover=!1,se._disabled?se._isDisabled=se._disabled:se._isDisabled=!1,se._checked?se._isChecked=se._checked:se._isChecked=!1,se._expanded?se._isExpanded=se._expanded:se._isExpanded=!1,se._highlight?se._isHighlight=se._highlight:se._isHighlight=!1,se},makeObjData(){let K={};return this.data.forEach((se,me)=>{const Be=this.makeObjBaseData(se);Be.children&&Be.children.length&&(Be._showChildren?Be._isShowChildren=Be._showChildren:Be._isShowChildren=!1,Be.children=this.makeChildrenObjData(Be)),K[me]=Be}),K},makeChildrenObjData(K){return K.children&&K.children.length?K.children.map(se=>{const me=this.makeObjBaseData(se);return me._showChildren?me._isShowChildren=me._showChildren:me._isShowChildren=!1,me.children&&me.children.length&&(me.children=this.makeChildrenObjData(me)),me}):K},makeColumnsId(K){return Qe(K).map(se=>("children"in se&&this.makeColumnsId(se.children),se.__id=OE(6),se))},makeColumns(K){let se=Qe($l(K)),me=[],Be=[],Re=[];return se.forEach((ve,Fe)=>{ve._index=Fe,ve._columnKey=CE++,ve.width=parseInt(ve.width),ve._width=ve.width?ve.width:"",ve._sortType="normal",ve._filterVisible=!1,ve._isFiltered=!1,ve._filterChecked=[],"filterMultiple"in ve?ve._filterMultiple=ve.filterMultiple:ve._filterMultiple=!0,"filteredValue"in ve&&(ve._filterChecked=ve.filteredValue,ve._isFiltered=!0),"sortType"in ve&&(ve._sortType=ve.sortType),ve.fixed&&ve.fixed==="left"?me.push(ve):ve.fixed&&ve.fixed==="right"?Be.push(ve):Re.push(ve)}),me.concat(Re).concat(Be)},makeColumnRows(K,se){return wE(se,K)},exportCsv(K){K.filename?K.filename.indexOf(".csv")===-1&&(K.filename+=".csv"):K.filename="table.csv";let se=[],me=[];K.columns&&K.data?(se=K.columns,me=K.data):(se=this.allColumns,"original"in K||(K.original=!0),me=K.original?this.data:this.rebuildData);let Be=!1;"noHeader"in K&&(Be=K.noHeader);const Re=xE(se,me,K,Be);K.callback?K.callback(Re):SE.download(K.filename,Re)},dragAndDrop(K,se){this.$emit("on-drag-drop",K,se)},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handleOnVisibleChange(K){K&&E.nextTick(()=>{this.handleResize()})},addTable(K){const se=this[K];!se||(se.tableList||(se.tableList=[]),se.tableList.push({id:this.id,table:this}))},removeTable(K){const se=this[K];if(!se||!se.tableList)return;const me=se.tableList.findIndex(Be=>Be.id===this.id);se.tableList.splice(me,1)},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},created(){this.context||(this.currentContext=this.$parent),this.showSlotHeader=this.$slots.header!==void 0,this.showSlotFooter=this.$slots.footer!==void 0,this.rebuildData=this.makeDataWithSortAndFilter()},mounted(){this.addTable("TabsInstance"),this.addTable("ModalInstance"),this.addTable("DrawerInstance"),this.handleResize(),E.nextTick(()=>this.ready=!0),X(window,"resize",this.handleResize),this.observer=Na(),this.observer.listenTo(this.$el,this.handleResize)},beforeUnmount(){this.removeTable("TabsInstance"),this.removeTable("ModalInstance"),this.removeTable("DrawerInstance"),q(window,"resize",this.handleResize),this.observer.removeAllListeners(this.$el),this.observer.uninstall(this.$el),this.observer=null},watch:{data:{handler(){const K=this.rebuildData.length;this.objData=this.makeObjData(),this.rebuildData=this.makeDataWithSortAndFilter(),this.handleResize(),K||this.fixedHeader(),setTimeout(()=>{this.cloneData=Qe(this.data)},0)},deep:!0},columns:{handler(){const K=this.makeColumnsId(this.columns);this.allColumns=$l(K),this.cloneColumns=this.makeColumns(K),this.columnRows=this.makeColumnRows(!1,K),this.leftFixedColumnRows=this.makeColumnRows("left",K),this.rightFixedColumnRows=this.makeColumnRows("right",K),this.rebuildData=this.makeDataWithSortAndFilter(),this.handleResize()},deep:!0},height(){this.handleResize()},maxHeight(){this.handleResize()},showHorizontalScrollBar(){this.handleResize()},showVerticalScrollBar(){this.handleResize()}}},EE={cellspacing:"0",cellpadding:"0",border:"0"},AE=["innerHTML"],ME=["innerHTML"],PE={class:"ivu-table-resize-line",ref:"resizeLine"};function RE(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("table-head"),Xe=E.resolveComponent("table-body"),tt=E.resolveComponent("table-summary"),Ze=E.resolveComponent("DropdownMenu"),it=E.resolveComponent("Dropdown"),nr=E.resolveComponent("Spin");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.wrapClasses),style:E.normalizeStyle(ve.styles),ref:"tableWrap"},[E.createElementVNode("div",{class:E.normalizeClass(ve.classes)},[Re.showSlotHeader?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-title"]),ref:"title"},[E.renderSlot(K.$slots,"header")],2)):E.createCommentVNode("",!0),me.showHeader?(E.openBlock(),E.createElementBlock("div",{key:1,class:E.normalizeClass([Re.prefixCls+"-header"]),ref:"header",onMousewheel:se[0]||(se[0]=(...jr)=>ve.handleMouseWheel&&ve.handleMouseWheel(...jr))},[E.createVNode(Fe,{"prefix-cls":Re.prefixCls,styleObject:ve.tableHeaderStyle,columns:Re.cloneColumns,"column-rows":Re.columnRows,"obj-data":Re.objData,"columns-width":Re.columnsWidth,data:Re.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","obj-data","columns-width","data"])],34)):E.createCommentVNode("",!0),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-body"]),style:E.normalizeStyle(ve.bodyStyle),ref:"body",onScroll:se[1]||(se[1]=(...jr)=>ve.handleBodyScroll&&ve.handleBodyScroll(...jr))},[E.createVNode(Xe,{ref:"tbody",draggable:me.draggable,"prefix-cls":Re.prefixCls,styleObject:ve.tableStyle,columns:Re.cloneColumns,data:Re.rebuildData,"row-key":me.rowKey,"columns-width":Re.columnsWidth,"obj-data":Re.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),[[E.vShow,!(ve.localeNoDataText&&(!me.data||me.data.length===0)||ve.localeNoFilteredDataText&&(!Re.rebuildData||Re.rebuildData.length===0))]]),me.showSummary&&me.data&&me.data.length?(E.openBlock(),E.createBlock(tt,{key:2,ref:"summary","prefix-cls":Re.prefixCls,styleObject:ve.tableStyle,columns:Re.cloneColumns,data:ve.summaryData,"columns-width":Re.columnsWidth},null,8,["prefix-cls","styleObject","columns","data","columns-width"])):E.createCommentVNode("",!0),E.withDirectives(E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-tip"]),style:E.normalizeStyle(ve.bodyStyle),onScroll:se[2]||(se[2]=(...jr)=>ve.handleBodyScroll&&ve.handleBodyScroll(...jr))},[E.createElementVNode("table",EE,[E.createElementVNode("tbody",null,[E.createElementVNode("tr",null,[E.createElementVNode("td",{style:E.normalizeStyle({height:ve.bodyStyle.height,width:`${Re.headerWidth}px`})},[!me.data||me.data.length===0?(E.openBlock(),E.createElementBlock("span",{key:0,innerHTML:ve.localeNoDataText},null,8,AE)):(E.openBlock(),E.createElementBlock("span",{key:1,innerHTML:ve.localeNoFilteredDataText},null,8,ME))],4)])])])],38),[[E.vShow,!!ve.localeNoDataText&&(!me.data||me.data.length===0)||!!ve.localeNoFilteredDataText&&(!Re.rebuildData||Re.rebuildData.length===0)]]),ve.isLeftFixed?(E.openBlock(),E.createElementBlock("div",{key:3,class:E.normalizeClass(ve.fixedTableClasses),style:E.normalizeStyle(ve.fixedTableStyle)},[me.showHeader?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.fixedHeaderClasses)},[E.createVNode(Fe,{fixed:"left","prefix-cls":Re.prefixCls,styleObject:ve.fixedTableStyle,columns:ve.leftFixedColumns,"column-rows":Re.columnRows,"fixed-column-rows":Re.leftFixedColumnRows,"obj-data":Re.objData,"columns-width":Re.columnsWidth,data:Re.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","fixed-column-rows","obj-data","columns-width","data"])],2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-fixed-body"]),style:E.normalizeStyle(ve.fixedBodyStyle),ref:"fixedBody",onMousewheel:se[3]||(se[3]=(...jr)=>ve.handleFixedMousewheel&&ve.handleFixedMousewheel(...jr)),"on:DOMMouseScroll":se[4]||(se[4]=(...jr)=>ve.handleFixedMousewheel&&ve.handleFixedMousewheel(...jr))},[E.createVNode(Xe,{fixed:"left",draggable:me.draggable,"prefix-cls":Re.prefixCls,styleObject:ve.fixedTableStyle,columns:ve.leftFixedColumns,data:Re.rebuildData,"row-key":me.rowKey,"columns-width":Re.columnsWidth,"obj-data":Re.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),me.showSummary&&me.data&&me.data.length?(E.openBlock(),E.createBlock(tt,{key:1,fixed:"left","prefix-cls":Re.prefixCls,styleObject:ve.fixedTableStyle,columns:ve.leftFixedColumns,data:ve.summaryData,"columns-width":Re.columnsWidth,style:E.normalizeStyle({"margin-top":Re.showHorizontalScrollBar?Re.scrollBarWidth+"px":0})},null,8,["prefix-cls","styleObject","columns","data","columns-width","style"])):E.createCommentVNode("",!0)],6)):E.createCommentVNode("",!0),ve.isRightFixed?(E.openBlock(),E.createElementBlock("div",{key:4,class:E.normalizeClass(ve.fixedRightTableClasses),style:E.normalizeStyle(ve.fixedRightTableStyle)},[me.showHeader?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(ve.fixedHeaderClasses)},[E.createVNode(Fe,{fixed:"right","prefix-cls":Re.prefixCls,styleObject:ve.fixedRightTableStyle,columns:ve.rightFixedColumns,"column-rows":Re.columnRows,"fixed-column-rows":Re.rightFixedColumnRows,"obj-data":Re.objData,"columns-width":Re.columnsWidth,data:Re.rebuildData},null,8,["prefix-cls","styleObject","columns","column-rows","fixed-column-rows","obj-data","columns-width","data"])],2)):E.createCommentVNode("",!0),E.createElementVNode("div",{class:E.normalizeClass([Re.prefixCls+"-fixed-body"]),style:E.normalizeStyle(ve.fixedBodyStyle),ref:"fixedRightBody",onMousewheel:se[5]||(se[5]=(...jr)=>ve.handleFixedMousewheel&&ve.handleFixedMousewheel(...jr)),"on:DOMMouseScroll":se[6]||(se[6]=(...jr)=>ve.handleFixedMousewheel&&ve.handleFixedMousewheel(...jr))},[E.createVNode(Xe,{fixed:"right",draggable:me.draggable,"prefix-cls":Re.prefixCls,styleObject:ve.fixedRightTableStyle,columns:ve.rightFixedColumns,data:Re.rebuildData,"row-key":me.rowKey,"columns-width":Re.columnsWidth,"obj-data":Re.objData},null,8,["draggable","prefix-cls","styleObject","columns","data","row-key","columns-width","obj-data"])],38),me.showSummary&&me.data&&me.data.length?(E.openBlock(),E.createBlock(tt,{key:1,fixed:"right","prefix-cls":Re.prefixCls,styleObject:ve.fixedRightTableStyle,columns:ve.rightFixedColumns,data:ve.summaryData,"columns-width":Re.columnsWidth,style:E.normalizeStyle({"margin-top":Re.showHorizontalScrollBar?Re.scrollBarWidth+"px":0})},null,8,["prefix-cls","styleObject","columns","data","columns-width","style"])):E.createCommentVNode("",!0)],6)):E.createCommentVNode("",!0),ve.isRightFixed?(E.openBlock(),E.createElementBlock("div",{key:5,class:E.normalizeClass([Re.prefixCls+"-fixed-right-header"]),style:E.normalizeStyle(ve.fixedRightHeaderStyle)},null,6)):E.createCommentVNode("",!0),Re.showSlotFooter?(E.openBlock(),E.createElementBlock("div",{key:6,class:E.normalizeClass([Re.prefixCls+"-footer"]),ref:"footer"},[E.renderSlot(K.$slots,"footer")],2)):E.createCommentVNode("",!0)],2),E.withDirectives(E.createElementVNode("div",PE,null,512),[[E.vShow,Re.showResizeLine]]),me.showContextMenu?(E.openBlock(),E.createElementBlock("div",{key:0,class:"ivu-table-context-menu",style:E.normalizeStyle(Re.contextMenuStyles)},[E.createVNode(it,{trigger:"custom",visible:Re.contextMenuVisible,transfer:"",onOnClick:ve.handleClickDropdownItem,onOnClickoutside:ve.handleClickContextMenuOutside},{list:E.withCtx(()=>[E.createVNode(Ze,null,{default:E.withCtx(()=>[E.renderSlot(K.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)):E.createCommentVNode("",!0),E.createVNode(nr,{fix:"",size:"large",show:me.loading},{default:E.withCtx(()=>[E.renderSlot(K.$slots,"loading")]),_:3},8,["show"])],6)}var au=Y(TE,[["render",RE]]);const kE={name:"TablePaste",components:{Row:Lo,Col:vo,Input:Js,Table:au},emits:["on-change","on-error","on-success"],props:{value:{type:String},inputProps:{type:Object,default(){return{}}},tableProps:{type:Object,default(){return{}}},hideTable:{type:Boolean,default:!1}},data(){return{content:"",tableColumns:[],tableData:[]}},watch:{value:{handler(K){this.handleResolveContent(K)},immediate:!0}},methods:{handleContentChange(K){const se=K.target.value.trim();this.$emit("on-change",se),this.handleResolveContent(se)},handleResolveContent(K){let se=[];K!==""&&K!==void 0&&(se=K.split(/[\n\u0085\u2028\u2029]|\r\n?/g).map(Re=>Re.split("	")));const me=this.handleGetErrorIndex(se),Be=this.contentToTable(se);this.tableColumns=Be.columns,this.tableData=Be.data,me.length?this.$emit("on-error",Be,me):this.$emit("on-success",Be)},handleGetErrorIndex(K){const se=Qe(K),me=[];if(se.length){const Be=se[0].length;se.forEach((Re,ve)=>{Re.length!==Be&&me.push(ve)})}return me},contentToTable(K){const se=Qe(K);let me=[],Be=[];return se.length>1&&(me=se.shift().map((Re,ve)=>({title:Re,key:`key${ve}`})),Be=se.map(Re=>{const ve={};return Re.forEach((Fe,Xe)=>{ve[`key${Xe}`]=Fe}),ve})),{columns:me,data:Be}}}},IE={class:"ivu-table-paste"},BE={key:0,class:"ivu-table-paste-input"},VE={key:0,class:"ivu-table-paste-input"};function DE(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Input"),Xe=E.resolveComponent("Col"),tt=E.resolveComponent("Table"),Ze=E.resolveComponent("Row");return E.openBlock(),E.createElementBlock("div",IE,[me.hideTable?(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[me.value!==void 0||!K.$slots.default?(E.openBlock(),E.createElementBlock("div",VE,[E.renderSlot(K.$slots,"default",{},()=>[E.createVNode(Fe,E.mergeProps({modelValue:Re.content,"onUpdate:modelValue":se[1]||(se[1]=it=>Re.content=it),type:"textarea"},me.inputProps,{onOnChange:ve.handleContentChange}),null,16,["modelValue","onOnChange"])])])):E.createCommentVNode("",!0)],64)):(E.openBlock(),E.createBlock(Ze,{key:0,gutter:32},{default:E.withCtx(()=>[E.createVNode(Xe,{span:"12"},{default:E.withCtx(()=>[me.value!==void 0||!K.$slots.default?(E.openBlock(),E.createElementBlock("div",BE,[E.renderSlot(K.$slots,"default",{},()=>[E.createVNode(Fe,E.mergeProps({modelValue:Re.content,"onUpdate:modelValue":se[0]||(se[0]=it=>Re.content=it),type:"textarea"},me.inputProps,{onOnChange:ve.handleContentChange}),null,16,["modelValue","onOnChange"])])])):E.createCommentVNode("",!0)]),_:3}),E.createVNode(Xe,{span:"12"},{default:E.withCtx(()=>[E.createVNode(tt,E.mergeProps({columns:Re.tableColumns,data:Re.tableData},me.tableProps),null,16,["columns","data"])]),_:1})]),_:3}))])}var Mm=Y(kE,[["render",DE]]);const NE={name:"TagSelect",mixins:[In],components:{Tag:Ta,Icon:Ae},emits:["on-change","on-checked-all","update:modelValue"],provide(){return{TagSelectInstance:this}},props:{modelValue:{type:Array,default(){return[]}},expandable:{type:Boolean,default:!1},hideCheckAll:{type:Boolean,default:!1},locale:{type:Object,default(){return{collapseText:"",expandText:""}}}},data(){return{currentValue:this.modelValue,checkedAll:!1,expand:!1,tagSelectOptionList:[]}},computed:{classes(){return{"ivu-tag-select-with-expanded":this.expandable,"ivu-tag-select-expanded":this.expand}}},watch:{modelValue(K){this.currentValue=K,this.handleUpdateTags()}},methods:{handleUpdateTags(){let K=!0;this.tagSelectOptionList.map(se=>se.option).forEach(se=>{this.currentValue.indexOf(se.name)>=0?se.checked=!0:(se.checked=!1,K=!1)}),this.checkedAll=K},handleChangeTag(K){const se=[];let me=!0;this.tagSelectOptionList.map(Be=>Be.option).forEach(Be=>{Be.checked?se.push(Be.name):me=!1}),this.currentValue=se,this.$emit("update:modelValue",se),this.$emit("on-change",[...se],K),this.handleFormItemChange("change",K),K&&(this.checkedAll=me)},handleCheckAll(K){this.checkedAll=K,this.tagSelectOptionList.map(se=>se.option).forEach(se=>{se.checked=K}),this.handleChangeTag(),this.$emit("on-checked-all",K)},handleToggleExpand(){this.expand=!this.expand}},mounted(){this.handleUpdateTags()}},$E={key:0,class:"ivu-tag-select-option"},LE={key:0},FE={key:1};function UE(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Tag"),Xe=E.resolveComponent("Icon");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(["ivu-tag-select",ve.classes])},[me.hideCheckAll?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("div",$E,[E.createVNode(Fe,{checkable:"",checked:Re.checkedAll,onOnChange:ve.handleCheckAll,color:"primary"},{default:E.withCtx(()=>[E.createTextVNode("")]),_:1},8,["checked","onOnChange"])])),E.renderSlot(K.$slots,"default"),me.expandable?(E.openBlock(),E.createElementBlock("a",{key:1,class:"ivu-tag-select-expand-btn",onClick:se[0]||(se[0]=(...tt)=>ve.handleToggleExpand&&ve.handleToggleExpand(...tt))},[Re.expand?(E.openBlock(),E.createElementBlock("span",LE,E.toDisplayString(me.locale.collapseText),1)):(E.openBlock(),E.createElementBlock("span",FE,E.toDisplayString(me.locale.expandText),1)),Re.expand?(E.openBlock(),E.createBlock(Xe,{key:2,type:"ios-arrow-up"})):(E.openBlock(),E.createBlock(Xe,{key:3,type:"ios-arrow-down"}))])):E.createCommentVNode("",!0)],2)}var Bm=Y(NE,[["render",UE]]);const zE={name:"TagSelectOption",components:{Tag:Ta},inject:["TagSelectInstance"],props:{name:{type:[String,Number],required:!0},tagProps:{type:Object,default(){return{}}},color:{type:String,default:"primary"}},data(){return{checked:!1,id:gt(6)}},methods:{handleChange(K){this.checked=K,this.TagSelectInstance.handleChangeTag(this.name)},addOption(){this.TagSelectInstance.tagSelectOptionList.push({id:this.id,option:this})},removeOption(){const K=this.TagSelectInstance,se=K.tagSelectOptionList.findIndex(me=>me.id===this.id);K.tagSelectOptionList.splice(se,1)}},mounted(){this.addOption()},beforeUnmount(){this.removeOption()}},WE={class:"ivu-tag-select-option"};function GE(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Tag");return E.openBlock(),E.createElementBlock("div",WE,[E.createVNode(Fe,E.mergeProps({checkable:"",checked:Re.checked,onOnChange:ve.handleChange,color:me.color},me.tagProps),{default:E.withCtx(()=>[E.renderSlot(K.$slots,"default")]),_:3},16,["checked","onOnChange","color"])])}var Vm=Y(zE,[["render",GE]]);const Nm={name:"Text",mixins:[El],render(){return E.h(Yc,{...this.$props,component:"span",...this.commonEvents()},this.commonSlots())}},$m="ivu-timeline",jE={name:"Timeline",props:{pending:{type:Boolean,default:!1}},computed:{classes(){return[`${$m}`,{[`${$m}-pending`]:this.pending}]}}};function HE(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("ul",{class:E.normalizeClass(ve.classes)},[E.renderSlot(K.$slots,"default")],2)}var Um=Y(jE,[["render",HE]]);const ja="ivu-timeline",XE={name:"TimelineItem",props:{color:{type:String,default:"blue"}},data(){return{dot:!1}},mounted(){this.dot=!!this.$refs.dot.innerHTML.length},computed:{itemClasses(){return`${ja}-item`},tailClasses(){return`${ja}-item-tail`},headClasses(){return[`${ja}-item-head`,{[`${ja}-item-head-custom`]:this.dot,[`${ja}-item-head-${this.color}`]:this.headColorShow}]},headColorShow(){return this.color==="blue"||this.color==="red"||this.color==="green"},customColor(){let K={};return this.color&&(this.headColorShow||(K={color:this.color,"border-color":this.color})),K},contentClasses(){return`${ja}-item-content`}}};function qE(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("li",{class:E.normalizeClass(ve.itemClasses)},[E.createElementVNode("div",{class:E.normalizeClass(ve.tailClasses)},null,2),E.createElementVNode("div",{class:E.normalizeClass(ve.headClasses),style:E.normalizeStyle(ve.customColor),ref:"dot"},[E.renderSlot(K.$slots,"dot")],6),E.createElementVNode("div",{class:E.normalizeClass(ve.contentClasses)},[E.renderSlot(K.$slots,"default")],2)],2)}var zm=Y(XE,[["render",qE]]),Wm={mixins:[pp,dc],components:{TimePickerPanel:Ep,RangeTimePickerPanel:kp},props:{type:{validator(K){return Ie(K,["time","timerange"])},default:"time"}},computed:{panel(){return this.type==="timerange"?"RangeTimePickerPanel":"TimePickerPanel"},ownPickerProps(){return{disabledHours:this.disabledHours,disabledMinutes:this.disabledMinutes,disabledSeconds:this.disabledSeconds,hideDisabledOptions:this.hideDisabledOptions}}},watch:{visible(K){K&&E.nextTick(()=>{this.timeSpinnerList.map(se=>se.timeSpinner).forEach(se=>se.updateScroll())})}}};const Gm={name:"Title",mixins:[El],props:{level:{type:Number,validator(K){return Ie(K,[1,2,3,4,5,6])},default:1}},render(){return E.h(Yc,{...this.$props,component:`h${this.level}`,...this.commonEvents()},this.commonSlots())}},QE={name:"Search",components:{Input:Js},emits:["on-query-change","on-query-clear"],props:{prefixCls:String,placeholder:String,query:String},data(){return{currentQuery:this.query}},watch:{query(K){this.currentQuery=K},currentQuery(K){this.$emit("on-query-change",K)}},computed:{icon(){return this.query===""?"ios-search":"ios-close-circle"}},methods:{handleClick(){this.currentQuery!==""&&(this.currentQuery="",this.$emit("on-query-clear"))}}};function YE(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Input");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(me.prefixCls)},[E.createVNode(Fe,{modelValue:Re.currentQuery,"onUpdate:modelValue":se[0]||(se[0]=Xe=>Re.currentQuery=Xe),size:"small",icon:ve.icon,placeholder:me.placeholder,onOnClick:ve.handleClick},null,8,["modelValue","icon","placeholder","onOnClick"])],2)}var KE=Y(QE,[["render",YE]]);const ZE={name:"TransferList",components:{Search:KE,Checkbox:wa},inject:["TransferInstance"],emits:["on-checked-keys-change"],props:{prefixCls:String,data:Array,renderFormat:Function,checkedKeys:Array,listStyle:Object,title:[String,Number],filterable:Boolean,filterPlaceholder:String,filterMethod:Function,notFoundText:String,validKeysCount:Number},data(){return{showItems:[],query:"",showFooter:!0}},watch:{data(){this.updateFilteredData()}},computed:{classes(){return[`${this.prefixCls}`,{[`${this.prefixCls}-with-footer`]:this.showFooter}]},bodyClasses(){return[`${this.prefixCls}-body`,{[`${this.prefixCls}-body-with-search`]:this.filterable,[`${this.prefixCls}-body-with-footer`]:this.showFooter}]},count(){const K=this.validKeysCount;return(K>0?`${K}/`:"")+`${this.data.length}`},checkedAll(){return this.filterData.filter(K=>!K.disabled).length===this.validKeysCount&&this.validKeysCount!==0},checkedAllDisabled(){return this.filterData.filter(K=>!K.disabled).length<=0},filterData(){return this.showItems.filter(K=>this.filterMethod(K,this.query))}},methods:{itemClasses(K){return[`${this.prefixCls}-content-item`,{[`${this.prefixCls}-content-item-disabled`]:K.disabled}]},showLabel(K){return this.renderFormat(K)},isCheck(K){return this.checkedKeys.some(se=>se===K.key)},select(K){if(K.disabled)return;const se=this.checkedKeys.indexOf(K.key);se>-1?this.checkedKeys.splice(se,1):this.checkedKeys.push(K.key),this.TransferInstance.handleCheckedKeys()},updateFilteredData(){this.showItems=this.data},toggleSelectAll(K){const se=K?this.filterData.filter(me=>!me.disabled||this.checkedKeys.indexOf(me.key)>-1).map(me=>me.key):this.filterData.filter(me=>me.disabled&&this.checkedKeys.indexOf(me.key)>-1).map(me=>me.key);this.$emit("on-checked-keys-change",se)},handleQueryClear(){this.query=""},handleQueryChange(K){this.query=K}},created(){this.updateFilteredData()},mounted(){this.showFooter=this.$slots.default!==void 0}},JE=["onClick"],eA=["innerHTML"];function tA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Checkbox"),Xe=E.resolveComponent("Search");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(ve.classes),style:E.normalizeStyle(me.listStyle)},[E.createElementVNode("div",{class:E.normalizeClass(me.prefixCls+"-header")},[E.createVNode(Fe,{modelValue:ve.checkedAll,disabled:ve.checkedAllDisabled,"onUpdate:modelValue":ve.toggleSelectAll},null,8,["modelValue","disabled","onUpdate:modelValue"]),E.createElementVNode("span",{class:E.normalizeClass(me.prefixCls+"-header-title"),onClick:se[0]||(se[0]=tt=>ve.toggleSelectAll(!ve.checkedAll))},E.toDisplayString(me.title),3),E.createElementVNode("span",{class:E.normalizeClass(me.prefixCls+"-header-count")},E.toDisplayString(ve.count),3)],2),E.createElementVNode("div",{class:E.normalizeClass(ve.bodyClasses)},[me.filterable?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(me.prefixCls+"-body-search-wrapper")},[E.createVNode(Xe,{"prefix-cls":me.prefixCls+"-search",query:Re.query,onOnQueryClear:ve.handleQueryClear,onOnQueryChange:ve.handleQueryChange,placeholder:me.filterPlaceholder},null,8,["prefix-cls","query","onOnQueryClear","onOnQueryChange","placeholder"])],2)):E.createCommentVNode("",!0),E.createElementVNode("ul",{class:E.normalizeClass(me.prefixCls+"-content")},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.filterData,(tt,Ze)=>(E.openBlock(),E.createElementBlock("li",{key:Ze,class:E.normalizeClass(ve.itemClasses(tt)),onClick:E.withModifiers(it=>ve.select(tt),["prevent"])},[E.createVNode(Fe,{modelValue:ve.isCheck(tt),disabled:tt.disabled},null,8,["modelValue","disabled"]),E.createElementVNode("span",{innerHTML:ve.showLabel(tt)},null,8,eA)],10,JE))),128)),E.createElementVNode("li",{class:E.normalizeClass(me.prefixCls+"-content-not-found")},E.toDisplayString(me.notFoundText),3)],2)],2),Re.showFooter?(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass(me.prefixCls+"-footer")},[E.renderSlot(K.$slots,"default")],2)):E.createCommentVNode("",!0)],6)}var jm=Y(ZE,[["render",tA]]);const iA={name:"Operation",components:{Button:As,Icon:Ae},inject:["TransferInstance"],props:{prefixCls:String,operations:Array,leftActive:Boolean,rightActive:Boolean,reverseOperation:Boolean},methods:{moveToLeft(){this.TransferInstance.moveTo("left")},moveToRight(){this.TransferInstance.moveTo("right")}}},nA={key:0},sA={key:0},oA={key:0},aA={key:0};function lA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Button");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(me.prefixCls+"-operation")},[me.reverseOperation?(E.openBlock(),E.createElementBlock(E.Fragment,{key:0},[E.createVNode(Xe,{type:"primary",size:"small",disabled:!me.leftActive,onClick:ve.moveToRight},{default:E.withCtx(()=>[me.operations[1]?(E.openBlock(),E.createElementBlock("span",nA,E.toDisplayString(me.operations[1]),1)):E.createCommentVNode("",!0),E.createVNode(Fe,{type:"ios-arrow-forward"})]),_:1},8,["disabled","onClick"]),E.createVNode(Xe,{type:"primary",size:"small",disabled:!me.rightActive,onClick:ve.moveToLeft},{default:E.withCtx(()=>[E.createVNode(Fe,{type:"ios-arrow-back"}),me.operations[0]?(E.openBlock(),E.createElementBlock("span",sA,E.toDisplayString(me.operations[0]),1)):E.createCommentVNode("",!0)]),_:1},8,["disabled","onClick"])],64)):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[E.createVNode(Xe,{type:"primary",size:"small",disabled:!me.rightActive,onClick:ve.moveToLeft},{default:E.withCtx(()=>[E.createVNode(Fe,{type:"ios-arrow-back"}),me.operations[0]?(E.openBlock(),E.createElementBlock("span",oA,E.toDisplayString(me.operations[0]),1)):E.createCommentVNode("",!0)]),_:1},8,["disabled","onClick"]),E.createVNode(Xe,{type:"primary",size:"small",disabled:!me.leftActive,onClick:ve.moveToRight},{default:E.withCtx(()=>[me.operations[1]?(E.openBlock(),E.createElementBlock("span",aA,E.toDisplayString(me.operations[1]),1)):E.createCommentVNode("",!0),E.createVNode(Fe,{type:"ios-arrow-forward"})]),_:1},8,["disabled","onClick"])],64))],2)}var uA=Y(iA,[["render",lA]]);const Hm="ivu-transfer",Xm={name:"Transfer",mixins:[Xn,In],emits:["on-change","on-selected-change"],provide(){return{TransferInstance:this}},render(){const K=this.$slots.default?this.$slots.default():"";return E.h("div",{class:this.classes},[E.h(jm,{ref:"left",prefixCls:this.prefixCls+"-list",data:this.leftData,renderFormat:this.renderFormat,checkedKeys:this.leftCheckedKeys,validKeysCount:this.leftValidKeysCount,listStyle:this.listStyle,title:this.localeTitles[0],filterable:this.filterable,filterPlaceholder:this.localeFilterPlaceholder,filterMethod:this.filterMethod,notFoundText:this.localeNotFoundText,"onOn-checked-keys-change":this.handleLeftCheckedKeysChange},()=>K),E.h(uA,{prefixCls:this.prefixCls,operations:this.operations,leftActive:this.leftValidKeysCount>0,rightActive:this.rightValidKeysCount>0,reverseOperation:this.reverseOperation}),E.h(jm,{ref:"right",prefixCls:this.prefixCls+"-list",data:this.rightData,renderFormat:this.renderFormat,checkedKeys:this.rightCheckedKeys,validKeysCount:this.rightValidKeysCount,listStyle:this.listStyle,title:this.localeTitles[1],filterable:this.filterable,filterPlaceholder:this.localeFilterPlaceholder,filterMethod:this.filterMethod,notFoundText:this.localeNotFoundText,"onOn-checked-keys-change":this.handleRightCheckedKeysChange},()=>K)])},props:{data:{type:Array,default(){return[]}},renderFormat:{type:Function,default(K){return K.label||K.key}},targetKeys:{type:Array,default(){return[]}},selectedKeys:{type:Array,default(){return[]}},listStyle:{type:Object,default(){return{}}},titles:{type:Array},operations:{type:Array,default(){return[]}},filterable:{type:Boolean,default:!1},filterPlaceholder:{type:String},filterMethod:{type:Function,default(K,se){const me="label"in K?"label":"key";return K[me].indexOf(se)>-1}},notFoundText:{type:String},reverseOperation:{type:Boolean,default:!1}},data(){return{prefixCls:Hm,leftData:[],rightData:[],leftCheckedKeys:[],rightCheckedKeys:[]}},computed:{classes(){return[`${Hm}`]},leftValidKeysCount(){return this.getValidKeys("left").length},rightValidKeysCount(){return this.getValidKeys("right").length},localeFilterPlaceholder(){return this.filterPlaceholder===void 0?this.t("i.transfer.filterPlaceholder"):this.filterPlaceholder},localeNotFoundText(){return this.notFoundText===void 0?this.t("i.transfer.notFoundText"):this.notFoundText},localeTitles(){return this.titles===void 0?[this.t("i.transfer.titles.source"),this.t("i.transfer.titles.target")]:this.titles}},methods:{getValidKeys(K){return this[`${K}Data`].filter(se=>!se.disabled&&this[`${K}CheckedKeys`].indexOf(se.key)>-1).map(se=>se.key)},splitData(K=!1){this.leftData=[...this.data],this.rightData=[],this.targetKeys.length>0&&this.targetKeys.forEach(se=>{const me=this.leftData.filter((Be,Re)=>Be.key===se?(this.leftData.splice(Re,1),!0):!1);me&&me.length>0&&this.rightData.push(me[0])}),K&&this.splitSelectedKey()},splitSelectedKey(){const K=this.selectedKeys;K.length>0&&(this.leftCheckedKeys=this.leftData.filter(se=>K.indexOf(se.key)>-1).map(se=>se.key),this.rightCheckedKeys=this.rightData.filter(se=>K.indexOf(se.key)>-1).map(se=>se.key))},moveTo(K){const se=this.targetKeys,me=K==="left"?"right":"left",Be=this.getValidKeys(me),Re=K==="right"?Be.concat(se):se.filter(ve=>!Be.some(Fe=>ve===Fe));this.$refs[me].toggleSelectAll(!1),this.$emit("on-change",Re,K,Be),this.handleFormItemChange("change",{tarketKeys:Re,direction:K,moveKeys:Be})},handleLeftCheckedKeysChange(K){this.leftCheckedKeys=K},handleRightCheckedKeysChange(K){this.rightCheckedKeys=K},handleCheckedKeys(){const K=this.getValidKeys("left"),se=this.getValidKeys("right");this.$emit("on-selected-change",K,se)}},watch:{targetKeys(){this.splitData(!1)},data(){this.splitData(!1)}},mounted(){this.splitData(!0)}};var hA={name:"RenderCell",props:{render:Function,data:Object,node:Array},render(){const K={root:this.node[0],node:this.node[1],data:this.data};return this.render(E.h,K)}};const Ko="ivu-tree",dA={name:"TreeNode",inject:["TreeInstance"],components:{Checkbox:wa,Icon:Ae,CollapseTransition:Sh,Render:hA},props:{data:{type:Object,default:()=>{}},multiple:{type:Boolean,default:!1},childrenKey:{type:String,default:"children"},showCheckbox:{type:Boolean,default:!1},appear:{type:Boolean,default:!1}},data(){return{prefixCls:Ko,appearByClickArrow:!1,globalConfig:{}}},computed:{classes(){return[`${Ko}-children`]},selectedCls(){return[{[`${Ko}-node-selected`]:this.data.selected}]},arrowClasses(){return[`${Ko}-arrow`,{[`${Ko}-arrow-disabled`]:this.data.disabled,[`${Ko}-arrow-open`]:this.data.expand}]},titleClasses(){return[`${Ko}-title`,{[`${Ko}-title-selected`]:this.data.selected}]},showArrow(){return this.data[this.childrenKey]&&this.data[this.childrenKey].length||"loading"in this.data&&!this.data.loading},showLoading(){return"loading"in this.data&&this.data.loading},isParentRender(){const K=Je(this,"Tree");return K&&K.render},parentRender(){const K=Je(this,"Tree");return K&&K.render?K.render:null},node(){const K=Je(this,"Tree");return K?[K.flatState,K.flatState.find(se=>se.nodeKey===this.data.nodeKey)]:[]},children(){return this.data[this.childrenKey]},arrowType(){const K=this.globalConfig;let se="ios-arrow-forward";return K&&(K.tree.customArrow?se="":K.tree.arrow&&(se=K.tree.arrow)),se},customArrowType(){const K=this.globalConfig;let se="";return K&&K.tree.customArrow&&(se=K.tree.customArrow),se},arrowSize(){const K=this.globalConfig;let se="";return K&&K.tree.arrowSize&&(se=K.tree.arrowSize),se}},methods:{handleExpand(){const K=this.data;if(this.appearByClickArrow=!0,K[this.childrenKey].length===0){const se=Je(this,"Tree");if(se&&se.loadData){this.data.loading=!0,se.loadData(K,me=>{this.data.loading=!1,me.length&&(this.data[this.childrenKey]=me,E.nextTick(()=>this.handleExpand()))});return}}K[this.childrenKey]&&K[this.childrenKey].length&&(this.data.expand=!this.data.expand,this.TreeInstance.handleToggleExpand(this.data))},handleClickNode(){this.TreeInstance.expandNode?this.showArrow&&this.handleExpand():this.TreeInstance.selectNode&&this.handleSelect()},handleSelect(){this.data.disabled||(this.TreeInstance.showCheckbox&&this.TreeInstance.checkDirectly?this.handleCheck():this.TreeInstance.handleOnSelected(this.data.nodeKey))},handleCheck(){if(this.data.disabled)return;const K={checked:!this.data.checked&&!this.data.indeterminate,nodeKey:this.data.nodeKey};this.TreeInstance.handleOnCheck(K)},handleContextmenu(K,se){K.contextmenu&&(se.preventDefault(),this.TreeInstance.handleOnContextmenu({data:K,event:se}))},handlePreventSelect(K,se){K.contextmenu&&se.preventDefault()}},created(){const K=E.getCurrentInstance();this.globalConfig=K.appContext.config.globalProperties.$VIEWUI}},fA={key:0,class:"ivu-tree-expand"};function mA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("Checkbox"),tt=E.resolveComponent("Render"),Ze=E.resolveComponent("TreeNode"),it=E.resolveComponent("collapse-transition");return E.openBlock(),E.createElementBlock("ul",{class:E.normalizeClass(ve.classes)},[E.createElementVNode("li",{onContextmenu:se[2]||(se[2]=E.withModifiers(nr=>ve.handleContextmenu(me.data,nr),["stop"])),onSelectstart:se[3]||(se[3]=E.withModifiers(nr=>ve.handlePreventSelect(me.data,nr),["stop"]))},[E.createElementVNode("span",{class:E.normalizeClass(ve.arrowClasses),onClick:se[0]||(se[0]=(...nr)=>ve.handleExpand&&ve.handleExpand(...nr))},[ve.showArrow?(E.openBlock(),E.createBlock(Fe,{key:0,type:ve.arrowType,custom:ve.customArrowType,size:ve.arrowSize},null,8,["type","custom","size"])):E.createCommentVNode("",!0),ve.showLoading?(E.openBlock(),E.createBlock(Fe,{key:1,type:"ios-loading",class:"ivu-load-loop"})):E.createCommentVNode("",!0)],2),me.showCheckbox?(E.openBlock(),E.createBlock(Xe,{key:0,"model-value":me.data.checked,indeterminate:me.data.indeterminate,disabled:me.data.disabled||me.data.disableCheckbox,onClick:E.withModifiers(ve.handleCheck,["prevent"])},null,8,["model-value","indeterminate","disabled","onClick"])):E.createCommentVNode("",!0),E.createElementVNode("span",{class:E.normalizeClass(ve.titleClasses),onClick:se[1]||(se[1]=(...nr)=>ve.handleClickNode&&ve.handleClickNode(...nr))},[me.data.render?(E.openBlock(),E.createBlock(tt,{key:0,render:me.data.render,data:me.data,node:ve.node},null,8,["render","data","node"])):ve.isParentRender?(E.openBlock(),E.createBlock(tt,{key:1,render:ve.parentRender,data:me.data,node:ve.node},null,8,["render","data","node"])):(E.openBlock(),E.createElementBlock(E.Fragment,{key:2},[E.createTextVNode(E.toDisplayString(me.data.title),1)],64))],2),E.createVNode(it,{appear:me.appear},{default:E.withCtx(()=>[me.data.expand?(E.openBlock(),E.createElementBlock("div",fA,[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(ve.children,(nr,jr)=>(E.openBlock(),E.createBlock(Ze,{appear:Re.appearByClickArrow,key:jr,data:nr,multiple:me.multiple,"show-checkbox":me.showCheckbox,"children-key":me.childrenKey},null,8,["appear","data","multiple","show-checkbox","children-key"]))),128))])):E.createCommentVNode("",!0)]),_:1},8,["appear"])],32)],2)}var gA=Y(dA,[["render",mA]]);const yA="ivu-tree",_A={name:"Tree",mixins:[Xn],components:{TreeNode:gA,Dropdown:ca,DropdownMenu:ua},emits:["on-select-change","on-check-change","on-contextmenu","on-toggle-expand"],provide(){return{TreeInstance:this}},props:{data:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},checkStrictly:{type:Boolean,default:!1},checkDirectly:{type:Boolean,default:!1},emptyText:{type:String},childrenKey:{type:String,default:"children"},loadData:{type:Function},render:{type:Function},selectNode:{type:Boolean,default:!0},expandNode:{type:Boolean,default:!1},autoCloseContextmenu:{type:Boolean,default:!0}},data(){return{prefixCls:yA,stateTree:this.data,flatState:[],contextMenuVisible:!1,contextMenuStyles:{top:0,left:0}}},watch:{data:{deep:!0,handler(){this.stateTree=this.data,this.flatState=this.compileFlatState(),this.rebuildTree()}}},computed:{localeEmptyText(){return typeof this.emptyText>"u"?this.t("i.tree.emptyText"):this.emptyText}},methods:{compileFlatState(){let K=0,se=this.childrenKey;const me=[];function Be(Re,ve){Re.nodeKey=K++,me[Re.nodeKey]={node:Re,nodeKey:Re.nodeKey},typeof ve<"u"&&(me[Re.nodeKey].parent=ve.nodeKey,me[ve.nodeKey][se].push(Re.nodeKey)),Re[se]&&(me[Re.nodeKey][se]=[],Re[se].forEach(Fe=>Be(Fe,Re)))}return this.stateTree.forEach(Re=>{Be(Re)}),me},updateTreeUp(K){const se=this.flatState[K].parent;if(typeof se>"u"||this.checkStrictly)return;const me=this.flatState[K].node,Be=this.flatState[se].node;me.checked==Be.checked&&me.indeterminate==Be.indeterminate||(me.checked==!0?(Be.checked=Be[this.childrenKey].every(Re=>Re.checked),Be.indeterminate=!Be.checked):(Be.checked=!1,Be.indeterminate=Be[this.childrenKey].some(Re=>Re.checked||Re.indeterminate)),this.updateTreeUp(se))},rebuildTree(){this.getCheckedNodes().forEach(K=>{this.updateTreeDown(K,{checked:!0});const se=this.flatState[K.nodeKey].parent;if(!se&&se!==0)return;const me=this.flatState[se].node;typeof K.checked<"u"&&K.checked&&me.checked!=K.checked&&this.updateTreeUp(K.nodeKey)})},getSelectedNodes(){return this.flatState.filter(K=>K.node.selected).map(K=>K.node)},getCheckedNodes(){return this.flatState.filter(K=>K.node.checked).map(K=>K.node)},getCheckedAndIndeterminateNodes(){return this.flatState.filter(K=>K.node.checked||K.node.indeterminate).map(K=>K.node)},updateTreeDown(K,se={}){if(!this.checkStrictly){for(let me in se)K[me]=se[me];K[this.childrenKey]&&K[this.childrenKey].forEach(me=>{this.updateTreeDown(me,se)})}},handleSelect(K){if(!this.flatState[K])return;const se=this.flatState[K].node;if(!this.multiple){const me=this.flatState.findIndex(Be=>Be.node.selected);me>=0&&me!==K&&(this.flatState[me].node.selected=!1)}se.selected=!se.selected,this.$emit("on-select-change",this.getSelectedNodes(),se)},handleCheck({checked:K,nodeKey:se}){if(!this.flatState[se])return;const me=this.flatState[se].node;me.checked=K,me.indeterminate=!1,this.updateTreeUp(se),this.updateTreeDown(me,{checked:K,indeterminate:!1}),this.$emit("on-check-change",this.getCheckedNodes(),me)},handleContextmenu({data:K,event:se}){this.contextMenuVisible&&this.handleClickContextMenuOutside(),E.nextTick(()=>{const me=this.$refs.treeWrap.getBoundingClientRect(),Be={left:`${se.clientX-me.left}px`,top:`${se.clientY-me.top}px`};this.contextMenuStyles=Be,this.contextMenuVisible=!0,this.$emit("on-contextmenu",K,se,Be)})},handleClickContextMenuOutside(){this.contextMenuVisible=!1},handleOnCheck(K){this.handleCheck(K)},handleOnSelected(K){this.handleSelect(K)},handleToggleExpand(K){this.$emit("on-toggle-expand",K)},handleOnContextmenu(K){this.handleContextmenu(K)},closeContextMenu(){this.handleClickContextMenuOutside()},handleClickDropdownItem(){this.autoCloseContextmenu&&this.closeContextMenu()}},created(){this.flatState=this.compileFlatState(),this.rebuildTree()}};function bA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("TreeNode"),Xe=E.resolveComponent("DropdownMenu"),tt=E.resolveComponent("Dropdown");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass(Re.prefixCls),ref:"treeWrap"},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(Re.stateTree,(Ze,it)=>(E.openBlock(),E.createBlock(Fe,{key:it,data:Ze,visible:"",multiple:me.multiple,"show-checkbox":me.showCheckbox,"children-key":me.childrenKey},null,8,["data","multiple","show-checkbox","children-key"]))),128)),Re.stateTree.length?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock("div",{key:0,class:E.normalizeClass([Re.prefixCls+"-empty"])},E.toDisplayString(ve.localeEmptyText),3)),E.createElementVNode("div",{class:"ivu-tree-context-menu",style:E.normalizeStyle(Re.contextMenuStyles)},[E.createVNode(tt,{trigger:"custom",visible:Re.contextMenuVisible,transfer:"",onOnClick:ve.handleClickDropdownItem,onOnClickoutside:ve.handleClickContextMenuOutside},{list:E.withCtx(()=>[E.createVNode(Xe,null,{default:E.withCtx(()=>[E.renderSlot(K.$slots,"contextMenu")]),_:3})]),_:3},8,["visible","onOnClick","onOnClickoutside"])],4)],2)}var zh=Y(_A,[["render",bA]]);const xA={name:"TreeSelect",components:{Select:Es,Tree:zh},emits:["on-change","update:modelValue","on-open-change"],mixins:[In],props:{modelValue:{type:[String,Number,Array]},data:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},loadData:{type:Function},transfer:{type:Boolean,default(){const K=E.getCurrentInstance().appContext.config.globalProperties;return!K.$VIEWUI||K.$VIEWUI.transfer===""?!1:K.$VIEWUI.transfer}}},data(){let K=this.modelValue;return K===null&&(this.multiple?K=[]:K=""),{currentValue:K,isChangeValueInTree:!1,isValueChangeByTree:!1,isValueNull:!1}},watch:{modelValue(K){if(this.isChangeValueInTree)this.isChangeValueInTree=!1;else{let se=K;se===null&&(this.isValueNull=!0,this.multiple?se=[]:se=""),this.currentValue=se,this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0)}},data(){this.isChangeValueInTree?this.isChangeValueInTree=!1:(this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0))}},computed:{valueToArray(){return typeof this.currentValue=="object"?this.currentValue:[this.currentValue]},isCheckboxUsable(){return this.multiple&&this.showCheckbox},transferClassName(){return this.transfer?"ivu-tree-select-transfer":""},classes(){return{"ivu-tree-select-with-checkbox":this.showCheckbox}}},methods:{handleSelectNode(K,se){if(this.multiple)K.length?(this.currentValue=K.map(me=>me.value),this.handleUpdateSelectValue(se.value,se.title)):(this.currentValue=[],this.handleUpdateSelectValue("",""));else if(K.length){const me=K[0];this.currentValue=me.value,this.handleUpdateSelectValue(me.value,me.title)}else this.currentValue="",this.handleUpdateSelectValue("","");this.isChangeValueInTree=!0,this.$emit("update:modelValue",this.currentValue),this.$emit("on-change",this.currentValue),this.handleFormItemChange("change",this.currentValue)},handleUpdateTreeNodes(K,se=!1){K.forEach(me=>{this.valueToArray.indexOf(me.value)>=0?(this.isCheckboxUsable?me.checked=!0:me.selected=!0,this.handleUpdateSelectValue(me.value,me.title)):this.isCheckboxUsable?me.checked=!1:me.selected=!1,me.children&&me.children.length&&this.handleUpdateTreeNodes(me.children)}),se&&(this.$refs.select.isFocused=!1)},handleUpdateSelectValue(K,se){K===""?this.$refs.select.reset():(this.isValueChangeByTree=!0,this.$refs.select.onOptionClick({value:K,label:se}))},handleChange(K){this.isValueChangeByTree?this.isValueChangeByTree=!1:(this.currentValue=K,this.isValueNull?(this.isValueNull=!1,this.$emit("update:modelValue",null)):this.$emit("update:modelValue",K),this.$emit("on-change",K),this.handleFormItemChange("change",K),this.$refs.select.reset(),this.handleUpdateTreeNodes(this.data,!0),E.nextTick(()=>{this.isValueChangeByTree=!1}))},handleOpenChange(K){this.$emit("on-open-change",K)}},mounted(){this.handleUpdateTreeNodes(this.data,!0)}};function SA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Tree"),Xe=E.resolveComponent("Select");return E.openBlock(),E.createBlock(Xe,E.mergeProps({ref:"select"},K.$attrs,{multiple:me.multiple,class:["ivu-tree-select",ve.classes],"transfer-class-name":ve.transferClassName,onOnChange:ve.handleChange,onOnOpenChange:ve.handleOpenChange,hideNotFound:"",transfer:me.transfer}),{default:E.withCtx(()=>[E.createVNode(Fe,{data:me.data,multiple:me.multiple,onOnSelectChange:ve.handleSelectNode,onOnCheckChange:ve.handleSelectNode,"check-strictly":"","show-checkbox":me.multiple&&me.showCheckbox,"check-directly":"","load-data":me.loadData},null,8,["data","multiple","onOnSelectChange","onOnCheckChange","show-checkbox","load-data"])]),_:1},16,["multiple","class","transfer-class-name","onOnChange","onOnOpenChange","transfer"])}var qm=Y(xA,[["render",SA]]);const wA={name:"Typography"},OA={class:"ivu-typography"};function CA(K,se,me,Be,Re,ve){return E.openBlock(),E.createElementBlock("article",OA,[E.renderSlot(K.$slots,"default")])}var Qm=Y(wA,[["render",CA]]);const Wh="ivu-upload",TA={name:"UploadList",components:{Icon:Ae,iProgress:su},emits:["on-file-click","on-file-preview","on-file-remove"],props:{files:{type:Array,default(){return[]}}},data(){return{prefixCls:Wh}},methods:{fileCls(K){return[`${Wh}-list-file`,{[`${Wh}-list-file-finish`]:K.status==="finished"}]},handleClick(K){this.$emit("on-file-click",K)},handlePreview(K){this.$emit("on-file-preview",K)},handleRemove(K){this.$emit("on-file-remove",K)},format(K){const se=K.name.split(".").pop().toLocaleLowerCase()||"";let me="ios-document-outline";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(se)>-1&&(me="ios-image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(se)>-1&&(me="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(se)>-1&&(me="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(se)>-1&&(me="md-document"),["numbers","csv","xls","xlsx"].indexOf(se)>-1&&(me="ios-stats"),["keynote","ppt","pptx"].indexOf(se)>-1&&(me="ios-videocam"),me},parsePercentage(K){return parseInt(K,10)}}},EA=["onClick"],AA=["onClick"];function MA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Icon"),Xe=E.resolveComponent("i-progress");return E.openBlock(),E.createElementBlock("ul",{class:E.normalizeClass([Re.prefixCls+"-list"])},[(E.openBlock(!0),E.createElementBlock(E.Fragment,null,E.renderList(me.files,(tt,Ze)=>(E.openBlock(),E.createElementBlock("li",{key:Ze,class:E.normalizeClass(ve.fileCls(tt)),onClick:it=>ve.handleClick(tt)},[E.createElementVNode("span",{onClick:it=>ve.handlePreview(tt)},[E.createVNode(Fe,{type:ve.format(tt)},null,8,["type"]),E.createTextVNode(" "+E.toDisplayString(tt.name),1)],8,AA),E.withDirectives(E.createVNode(Fe,{type:"ios-close",class:E.normalizeClass([Re.prefixCls+"-list-remove"]),onClick:it=>ve.handleRemove(tt)},null,8,["class","onClick"]),[[E.vShow,tt.status==="finished"]]),E.createVNode(E.Transition,{name:"fade"},{default:E.withCtx(()=>[tt.showProgress?(E.openBlock(),E.createBlock(Xe,{key:0,"stroke-width":2,percent:ve.parsePercentage(tt.percentage),status:tt.status==="finished"&&tt.showProgress?"success":"normal"},null,8,["percent","status"])):E.createCommentVNode("",!0)]),_:2},1024)],10,EA))),128))],2)}var PA=Y(TA,[["render",MA]]);function RA(K,se,me){const Be=`fail to post ${K} ${me.status}'`,Re=new Error(Be);return Re.status=me.status,Re.method="post",Re.url=K,Re}function Ym(K){const se=K.responseText||K.response;if(!se)return se;try{return JSON.parse(se)}catch{return se}}function kA(K){if(typeof XMLHttpRequest>"u")return;const se=new XMLHttpRequest,me=K.action;se.upload&&(se.upload.onprogress=function(ve){ve.total>0&&(ve.percent=ve.loaded/ve.total*100),K.onProgress(ve)});const Be=new FormData;K.data&&Object.keys(K.data).map(ve=>{Be.append(ve,K.data[ve])}),Be.append(K.filename,K.file),se.onerror=function(ve){K.onError(ve)},se.onload=function(){if(se.status<200||se.status>=300)return K.onError(RA(me,K,se),Ym(se));K.onSuccess(Ym(se))},se.open("post",me,!0),K.withCredentials&&"withCredentials"in se&&(se.withCredentials=!0);const Re=K.headers||{};for(let ve in Re)Re.hasOwnProperty(ve)&&Re[ve]!==null&&se.setRequestHeader(ve,Re[ve]);se.send(Be)}const Ll="ivu-upload",IA={name:"Upload",mixins:[In],components:{UploadList:PA},props:{action:{type:String,required:!0},headers:{type:Object,default(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator(K){return Ie(K,["select","drag"])},default:"select"},format:{type:Array,default(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default(){return{}}},onSuccess:{type:Function,default(){return{}}},onError:{type:Function,default(){return{}}},onRemove:{type:Function,default(){return{}}},onPreview:{type:Function,default(){return{}}},onExceededSize:{type:Function,default(){return{}}},onFormatError:{type:Function,default(){return{}}},defaultFileList:{type:Array,default(){return[]}},paste:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},webkitdirectory:{type:Boolean,default:!1}},data(){return{prefixCls:Ll,dragOver:!1,fileList:[],tempIndex:1}},computed:{classes(){return[`${Ll}`,{[`${Ll}-select`]:this.type==="select",[`${Ll}-drag`]:this.type==="drag",[`${Ll}-dragOver`]:this.type==="drag"&&this.dragOver}]}},methods:{handleClick(){this.itemDisabled||this.$refs.input.click()},handleChange(K){const se=K.target.files;!se||(this.uploadFiles(se),this.$refs.input.value=null)},onDrop(K){this.dragOver=!1,!this.itemDisabled&&this.uploadFiles(K.dataTransfer.files)},handlePaste(K){this.itemDisabled||this.paste&&this.uploadFiles(K.clipboardData.files)},uploadFiles(K){let se=Array.prototype.slice.call(K);this.multiple||(se=se.slice(0,1)),se.length!==0&&se.forEach(me=>{this.upload(me)})},upload(K){if(!this.beforeUpload)return this.post(K);const se=this.beforeUpload(K);se&&se.then?se.then(me=>{Object.prototype.toString.call(me)==="[object File]"?this.post(me):this.post(K)},()=>{}):se!==!1&&this.post(K)},post(K){if(this.format.length){const se=K.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(me=>me.toLocaleLowerCase()===se))return this.onFormatError(K,this.fileList),!1}if(this.maxSize&&K.size>this.maxSize*1024)return this.onExceededSize(K,this.fileList),!1;this.handleStart(K),new FormData().append(this.name,K),kA({headers:this.headers,withCredentials:this.withCredentials,file:K,data:this.data,filename:this.name,action:this.action,onProgress:se=>{this.handleProgress(se,K)},onSuccess:se=>{this.handleSuccess(se,K)},onError:(se,me)=>{this.handleError(se,me,K)}})},handleStart(K){K.uid=Date.now()+this.tempIndex++;const se={status:"uploading",name:K.name,size:K.size,percentage:0,uid:K.uid,showProgress:!0};this.fileList.push(se)},getFile(K){const se=this.fileList;let me;return se.every(Be=>(me=K.uid===Be.uid?Be:null,!me)),me},handleProgress(K,se){const me=this.getFile(se);this.onProgress(K,me,this.fileList),me.percentage=K.percent||0},handleSuccess(K,se){const me=this.getFile(se);me&&(me.status="finished",me.response=K,this.onSuccess(K,me,this.fileList),this.handleFormItemChange("change",me),setTimeout(()=>{me.showProgress=!1},1e3))},handleError(K,se,me){const Be=this.getFile(me),Re=this.fileList;Be.status="fail",Re.splice(Re.indexOf(Be),1),this.onError(K,se,me)},handleRemove(K){const se=this.fileList;se.splice(se.indexOf(K),1),this.onRemove(K,se)},handlePreview(K){K.status==="finished"&&this.onPreview(K)},clearFiles(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler(K){this.fileList=K.map(se=>(se.status="finished",se.percentage=100,se.uid=Date.now()+this.tempIndex++,se))}}}},BA=["multiple","webkitdirectory","accept"];function VA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("upload-list");return E.openBlock(),E.createElementBlock("div",{class:E.normalizeClass([Re.prefixCls])},[E.createElementVNode("div",{class:E.normalizeClass(ve.classes),onClick:se[1]||(se[1]=(...Xe)=>ve.handleClick&&ve.handleClick(...Xe)),onDrop:se[2]||(se[2]=E.withModifiers((...Xe)=>ve.onDrop&&ve.onDrop(...Xe),["prevent"])),onPaste:se[3]||(se[3]=(...Xe)=>ve.handlePaste&&ve.handlePaste(...Xe)),onDragover:se[4]||(se[4]=E.withModifiers(Xe=>Re.dragOver=!0,["prevent"])),onDragleave:se[5]||(se[5]=E.withModifiers(Xe=>Re.dragOver=!1,["prevent"]))},[E.createElementVNode("input",{ref:"input",type:"file",class:E.normalizeClass([Re.prefixCls+"-input"]),onChange:se[0]||(se[0]=(...Xe)=>ve.handleChange&&ve.handleChange(...Xe)),multiple:me.multiple,webkitdirectory:me.webkitdirectory,accept:me.accept},null,42,BA),E.renderSlot(K.$slots,"default")],34),E.renderSlot(K.$slots,"tip"),me.showUploadList?(E.openBlock(),E.createBlock(Fe,{key:0,files:Re.fileList,onOnFileRemove:ve.handleRemove,onOnFilePreview:ve.handlePreview},null,8,["files","onOnFileRemove","onOnFilePreview"])):E.createCommentVNode("",!0)],2)}var Km=Y(IA,[["render",VA]]);const Zm={name:"UserName",mixins:[hl],data(){return{className:"ivu-login-username",prefix:"ios-contact-outline",placeholder:"",type:"text",validateMessage:""}}},DA={name:"WordCount",components:{Circle:rc},props:{value:{type:[String,Number],default:""},total:{type:Number,default:0},hideTotal:{type:Boolean,default:!1},overflow:{type:Boolean,default:!1},circle:{type:Boolean,default:!1},size:{type:[String,Number],default:14}},computed:{isOverflow(){return this.value.length>this.total},percent(){let K=this.value.length/this.total*100;return K>100&&(K=100),K},strokeColor(){return this.isOverflow?"#ed4014":"#2d8cf0"}}},NA={class:"ivu-word-count"},$A={key:0,class:"ivu-word-count-prefix"},LA={key:1,class:"ivu-word-count-prefix ivu-word-count-overflow"},FA={key:3,class:"ivu-word-count-overflow"},UA={key:5,class:"ivu-word-count-suffix"},zA={key:6,class:"ivu-word-count-suffix ivu-word-count-overflow"};function WA(K,se,me,Be,Re,ve){const Fe=E.resolveComponent("Circle");return E.openBlock(),E.createElementBlock("div",NA,[me.circle?(E.openBlock(),E.createBlock(Fe,{key:0,percent:ve.percent,size:me.size,"stroke-color":ve.strokeColor},null,8,["percent","size","stroke-color"])):(E.openBlock(),E.createElementBlock(E.Fragment,{key:1},[ve.isOverflow?(E.openBlock(),E.createElementBlock("span",LA,[E.renderSlot(K.$slots,"prefix-overflow")])):(E.openBlock(),E.createElementBlock("span",$A,[E.renderSlot(K.$slots,"prefix")])),!ve.isOverflow||!me.overflow?(E.openBlock(),E.createElementBlock("span",{key:2,class:E.normalizeClass({"ivu-word-count-overflow":ve.isOverflow})},[E.renderSlot(K.$slots,"length",{length:me.value.length},()=>[E.createTextVNode(E.toDisplayString(me.value.length),1)])],2)):(E.openBlock(),E.createElementBlock("span",FA,E.toDisplayString(me.value.length-me.total),1)),me.hideTotal?E.createCommentVNode("",!0):(E.openBlock(),E.createElementBlock(E.Fragment,{key:4},[E.renderSlot(K.$slots,"separator",{},()=>[E.createTextVNode(" / ")]),E.renderSlot(K.$slots,"total",{total:me.total},()=>[E.createTextVNode(E.toDisplayString(me.total),1)])],64)),ve.isOverflow?(E.openBlock(),E.createElementBlock("span",zA,[E.renderSlot(K.$slots,"suffix-overflow")])):(E.openBlock(),E.createElementBlock("span",UA,[E.renderSlot(K.$slots,"suffix")]))],64))])}var Jm=Y(DA,[["render",WA]]),eg=Object.freeze(Object.defineProperty({__proto__:null,Affix:ge,Alert:fi,Anchor:rt,AnchorLink:Rr,Auth:oi,AutoComplete:ed,Avatar:rl,AvatarList:nd,BackTop:sd,Badge:Ql,Breadcrumb:Eu,BreadcrumbItem:Au,Button:As,ButtonGroup:Mu,Calendar:md,Captcha:wd,Card:Cd,Carousel:Td,CarouselItem:Ed,Cascader:Ad,Cell:Md,CellGroup:Pd,Checkbox:wa,CheckboxGroup:Lu,Circle:rc,City:Bd,Col:vo,Collapse:Dd,ColorPicker:qd,Content:zu,Copy:lc,CountDown:tp,CountUp:rp,DatePicker:Bp,Description:Vp,DescriptionList:Dp,Divider:mc,Drawer:$p,Dropdown:ca,DropdownItem:Lp,DropdownMenu:ua,Ellipsis:Fp,Email:Wp,Exception:Gp,Footer:ih,FooterToolbar:jp,Form:vc,FormItem:tc,GlobalFooter:Xp,Grid:lf,GridItem:cf,Header:lh,Icon:Ae,Image:uf,ImagePreview:Ho,Input:Js,InputNumber:ch,Layout:df,Link:gf,List:bf,ListItem:Sf,ListItemMeta:wf,LoadingBar:hh,Login:Rf,Menu:ph,MenuGroup:kf,MenuItem:If,Message:xl,Mobile:Bf,Modal:to,Notice:mh,Notification:jf,NotificationItem:qf,NotificationTab:Qf,NumberInfo:Kf,Numeral:Jf,Option:ss,OptionGroup:em,Page:tm,PageHeader:im,Panel:nm,Paragraph:sm,Password:om,Poptip:wh,Progress:su,Radio:Zl,RadioGroup:Kl,Rate:am,Result:lm,Row:Lo,Scroll:um,ScrollIntoView:Eh,ScrollTop:Ah,Select:Es,Sider:mm,Skeleton:gm,SkeletonItem:Mh,Slider:ym,Space:_m,Spin:Xs,Split:vm,Step:xm,Steps:Sm,Submenu:wm,Submit:Tm,Switch:Bh,Table:au,TablePaste:Mm,TabPane:iu,Tabs:eu,Tag:Ta,TagSelect:Bm,TagSelectOption:Vm,Text:Nm,Time:ru,Timeline:Um,TimelineItem:zm,TimePicker:Wm,Title:Gm,Tooltip:To,Transfer:Xm,Tree:zh,TreeSelect:qm,Trend:yh,Typography:Qm,Upload:Km,UserName:Zm,WordCount:Jm},Symbol.toStringTag,{value:"Module"})),GA={mounted(K,se){se.value&&(st(K,"ivu-line-clamp"),K.style["-webkit-line-clamp"]=se.value)},updated(K,se){se.value&&(K.style["-webkit-line-clamp"]=se.value)},unmounted(K){sr(K,"ivu-line-clamp"),K.style["-webkit-line-clamp"]=null}},jA={mounted(K,se){function me(Be){se.value(Be)}K.__resizeHandler__=me,K.__observer__=Na(),K.__observer__.listenTo(K,me)},updated(){},unmounted(K,se){K.__observer__.removeListener(K,K.__resizeHandler__),delete K.__resizeHandler__,delete K.__observer__}};function Zo(K){return String(K).endsWith("%")?"":"px"}var Jo={display:{mounted(K,se){se.value&&(K.style.display=se.value)},updated(K,se){se.value&&(K.style.display=se.value)},unmounted(K){K.style.display=null}},width:{mounted(K,se){se.value&&(K.style.width=se.value+Zo(se.value))},updated(K,se){se.value&&(K.style.width=se.value+Zo(se.value))},unmounted(K){K.style.width=null}},height:{mounted(K,se){se.value&&(K.style.height=se.value+Zo(se.value))},updated(K,se){se.value&&(K.style.height=se.value+Zo(se.value))},unmounted(K){K.style.height=null}},margin:{mounted(K,se){se.value&&(K.style.margin=se.value+Zo(se.value))},updated(K,se){se.value&&(K.style.margin=se.value+Zo(se.value))},unmounted(K){K.style.margin=null}},padding:{mounted(K,se){se.value&&(K.style.padding=se.value+Zo(se.value))},updated(K,se){se.value&&(K.style.padding=se.value+Zo(se.value))},unmounted(K){K.style.padding=null}},font:{mounted(K,se){se&&se.value&&(K.style.fontSize=`${se.value}px`)},updated(K,se){se&&se.value&&(K.style.fontSize=`${se.value}px`)},unmounted(K){K.style.fontSize=null}},color:{mounted(K,se){se.value&&(K.style.color=se.value)},updated(K,se){se.value&&(K.style.color=se.value)},unmounted(K){K.style.color=null}},bgColor:{mounted(K,se){se.value&&(K.style.backgroundColor=se.value)},updated(K,se){se.value&&(K.style.backgroundColor=se.value)},unmounted(K){K.style.backgroundColor=null}}},HA={name:"view-ui-plus",version:"1.3.17",title:"ViewUIPlus",description:"A high quality UI components Library with Vue.js 3",homepage:"http://www.iviewui.com",keywords:["iview","vue","viewui","viewuiplus","vue.js","component","components","ui","framework"],main:"dist/viewuiplus.min.js",typings:"types/index.d.ts",files:["dist","src","types"],scripts:{dev:"vue-cli-service serve",build:"npm run build:prod && npm run build:style && npm run build:lang","build:style":"gulp --gulpfile build/build-style.js","build:prod":"vite build","build:lang":"vite build --config build/vite.lang.config.js",lint:"vue-cli-service lint --fix"},repository:{type:"git",url:"https://github.com/view-design/ViewUIPlus"},author:"Aresn",license:"MIT",bugs:{url:"https://github.com/view-design/ViewUIPlus/issues"},dependencies:{"async-validator":"^3.3.0","countup.js":"^1.9.3",dayjs:"^1.11.0",deepmerge:"^2.2.1","element-resize-detector":"^1.2.0","js-calendar":"^1.2.3","lodash.chunk":"^4.2.0","lodash.throttle":"^4.1.1",numeral:"^2.0.6","popper.js":"^1.14.6",select:"^1.1.2",tinycolor2:"^1.4.1","v-click-outside-x":"^3.7.1"},devDependencies:{"@vitejs/plugin-vue":"^1.9.3","@vue/cli-plugin-babel":"~4.5.0","@vue/cli-plugin-eslint":"~4.5.0","@vue/cli-service":"~4.5.0","@vue/compiler-sfc":"^3.0.0","babel-eslint":"^10.1.0","babel-plugin-import":"^1.13.3",chai:"^4.2.0","copy-webpack-plugin":"^6.4.1","cross-env":"^5.2.0",eslint:"^6.7.2","eslint-plugin-vue":"^7.0.0-0",gulp:"^4.0.2","gulp-autoprefixer":"^8.0.0","gulp-clean-css":"^4.3.0","gulp-less":"^4.0.1","gulp-rename":"^2.0.0",karma:"^2.0.5","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-mocha":"^1.3.0","karma-sinon-chai":"^1.3.3","karma-sourcemap-loader":"^0.3.7","karma-spec-reporter":"^0.0.32","karma-webpack":"^2.0.13",less:"^2.7.3","less-loader":"^4.1.0","lint-staged":"^10.5.4",lolex:"^2.7.5",mocha:"^5.0.4",sinon:"^4.4.2","sinon-chai":"^3.3.0","style-loader":"^0.20.2",tslint:"^5.14.0",typescript:"^3.3.4000","uglifyjs-webpack-plugin":"^1.3.0","url-loader":"^1.1.2",vite:"^2.6.4",vue:"^3.2.47","vue-hot-reload-api":"^2.3.4","vue-html-loader":"^1.2.4","vue-loader":"^17.0.0","vue-router":"^4.0.14","vue-style-loader":"^4.1.3","vue-template-compiler":"^2.6.14"}};const tg={display:Jo.display,width:Jo.width,height:Jo.height,margin:Jo.margin,padding:Jo.padding,font:Jo.font,color:Jo.color,"bg-color":Jo.bgColor,resize:jA,"line-clamp":GA},rg={...eg,iButton:As,iCircle:rc,iCol:vo,iContent:zu,iForm:vc,iFooter:ih,iHeader:lh,iInput:Js,iMenu:ph,iOption:ss,iProgress:su,iSelect:Es,iSwitch:Bh,iTable:au,iTime:ru},Gh=function(K,se={}){Gh.installed||(se.locale&&Do.use(se.locale),se.i18n&&Do.i18n(se.i18n),Object.keys(rg).forEach(me=>{K.component(me,rg[me])}),Object.keys(tg).forEach(me=>{K.directive(me,tg[me])}),K.config.globalProperties.$VIEWUI={size:se.size||"",capture:"capture"in se?se.capture:!0,transfer:"transfer"in se?se.transfer:"",cell:{arrow:se.cell&&se.cell.arrow?se.cell.arrow:"",customArrow:se.cell&&se.cell.customArrow?se.cell.customArrow:"",arrowSize:se.cell&&se.cell.arrowSize?se.cell.arrowSize:""},menu:{arrow:se.menu&&se.menu.arrow?se.menu.arrow:"",customArrow:se.menu&&se.menu.customArrow?se.menu.customArrow:"",arrowSize:se.menu&&se.menu.arrowSize?se.menu.arrowSize:""},modal:{maskClosable:se.modal&&"maskClosable"in se.modal?se.modal.maskClosable:""},tabs:{closeIcon:se.tabs&&se.tabs.closeIcon?se.tabs.closeIcon:"",customCloseIcon:se.tabs&&se.tabs.customCloseIcon?se.tabs.customCloseIcon:"",closeIconSize:se.tabs&&se.tabs.closeIconSize?se.tabs.closeIconSize:""},select:{arrow:se.select&&se.select.arrow?se.select.arrow:"",customArrow:se.select&&se.select.customArrow?se.select.customArrow:"",arrowSize:se.select&&se.select.arrowSize?se.select.arrowSize:""},colorPicker:{arrow:se.colorPicker&&se.colorPicker.arrow?se.colorPicker.arrow:"",customArrow:se.colorPicker&&se.colorPicker.customArrow?se.colorPicker.customArrow:"",arrowSize:se.colorPicker&&se.colorPicker.arrowSize?se.colorPicker.arrowSize:""},cascader:{arrow:se.cascader&&se.cascader.arrow?se.cascader.arrow:"",customArrow:se.cascader&&se.cascader.customArrow?se.cascader.customArrow:"",arrowSize:se.cascader&&se.cascader.arrowSize?se.cascader.arrowSize:"",itemArrow:se.cascader&&se.cascader.itemArrow?se.cascader.itemArrow:"",customItemArrow:se.cascader&&se.cascader.customItemArrow?se.cascader.customItemArrow:"",itemArrowSize:se.cascader&&se.cascader.itemArrowSize?se.cascader.itemArrowSize:""},tree:{arrow:se.tree&&se.tree.arrow?se.tree.arrow:"",customArrow:se.tree&&se.tree.customArrow?se.tree.customArrow:"",arrowSize:se.tree&&se.tree.arrowSize?se.tree.arrowSize:""},datePicker:{icon:se.datePicker&&se.datePicker.icon?se.datePicker.icon:"",customIcon:se.datePicker&&se.datePicker.customIcon?se.datePicker.customIcon:"",iconSize:se.datePicker&&se.datePicker.iconSize?se.datePicker.iconSize:""},timePicker:{icon:se.timePicker&&se.timePicker.icon?se.timePicker.icon:"",customIcon:se.timePicker&&se.timePicker.customIcon?se.timePicker.customIcon:"",iconSize:se.timePicker&&se.timePicker.iconSize?se.timePicker.iconSize:""},typography:{copyConfig:se.typography&&se.typography.copyConfig?se.typography.copyConfig:"",editConfig:se.typography&&se.typography.editConfig?se.typography.editConfig:"",ellipsisConfig:se.typography&&se.typography.ellipsisConfig?se.typography.ellipsisConfig:""},space:{size:se.space&&se.space.size?se.space.size:""},image:{toolbar:se.image&&se.image.toolbar?se.image.toolbar:""}},K.config.globalProperties.$Spin=Xs,K.config.globalProperties.$Loading=hh,K.config.globalProperties.$Message=xl,K.config.globalProperties.$Notice=mh,K.config.globalProperties.$Modal=to,K.config.globalProperties.$ImagePreview=Ho,K.config.globalProperties.$Copy=lc,K.config.globalProperties.$ScrollIntoView=Eh,K.config.globalProperties.$ScrollTop=Ah,K.config.globalProperties.$Date=Fs)},ig=HA.version,ng=Do.use,sg=Do.i18n,og=K=>{const se=window["viewuiplus/locale"].default;K===se.i.locale?Do.use(se):console.log(`The ${K} language pack is not loaded.`)},XA={version:ig,locale:ng,i18n:sg,install:Gh,lang:og,...eg};T.Affix=ge,T.Alert=fi,T.Anchor=rt,T.AnchorLink=Rr,T.Auth=oi,T.AutoComplete=ed,T.Avatar=rl,T.AvatarList=nd,T.BackTop=sd,T.Badge=Ql,T.Breadcrumb=Eu,T.BreadcrumbItem=Au,T.Button=As,T.ButtonGroup=Mu,T.Calendar=md,T.Captcha=wd,T.Card=Cd,T.Carousel=Td,T.CarouselItem=Ed,T.Cascader=Ad,T.Cell=Md,T.CellGroup=Pd,T.Checkbox=wa,T.CheckboxGroup=Lu,T.Circle=rc,T.City=Bd,T.Col=vo,T.Collapse=Dd,T.ColorPicker=qd,T.Content=zu,T.Copy=lc,T.CountDown=tp,T.CountUp=rp,T.DatePicker=Bp,T.Description=Vp,T.DescriptionList=Dp,T.Divider=mc,T.Drawer=$p,T.Dropdown=ca,T.DropdownItem=Lp,T.DropdownMenu=ua,T.Ellipsis=Fp,T.Email=Wp,T.Exception=Gp,T.Footer=ih,T.FooterToolbar=jp,T.Form=vc,T.FormItem=tc,T.GlobalFooter=Xp,T.Grid=lf,T.GridItem=cf,T.Header=lh,T.Icon=Ae,T.Image=uf,T.ImagePreview=Ho,T.Input=Js,T.InputNumber=ch,T.Layout=df,T.Link=gf,T.List=bf,T.ListItem=Sf,T.ListItemMeta=wf,T.LoadingBar=hh,T.Login=Rf,T.Menu=ph,T.MenuGroup=kf,T.MenuItem=If,T.Message=xl,T.Mobile=Bf,T.Modal=to,T.Notice=mh,T.Notification=jf,T.NotificationItem=qf,T.NotificationTab=Qf,T.NumberInfo=Kf,T.Numeral=Jf,T.Option=ss,T.OptionGroup=em,T.Page=tm,T.PageHeader=im,T.Panel=nm,T.Paragraph=sm,T.Password=om,T.Poptip=wh,T.Progress=su,T.Radio=Zl,T.RadioGroup=Kl,T.Rate=am,T.Result=lm,T.Row=Lo,T.Scroll=um,T.ScrollIntoView=Eh,T.ScrollTop=Ah,T.Select=Es,T.Sider=mm,T.Skeleton=gm,T.SkeletonItem=Mh,T.Slider=ym,T.Space=_m,T.Spin=Xs,T.Split=vm,T.Step=xm,T.Steps=Sm,T.Submenu=wm,T.Submit=Tm,T.Switch=Bh,T.TabPane=iu,T.Table=au,T.TablePaste=Mm,T.Tabs=eu,T.Tag=Ta,T.TagSelect=Bm,T.TagSelectOption=Vm,T.Text=Nm,T.Time=ru,T.TimePicker=Wm,T.Timeline=Um,T.TimelineItem=zm,T.Title=Gm,T.Tooltip=To,T.Transfer=Xm,T.Tree=zh,T.TreeSelect=qm,T.Trend=yh,T.Typography=Qm,T.Upload=Km,T.UserName=Zm,T.WordCount=Jm,T.default=XA,T.i18n=sg,T.install=Gh,T.lang=og,T.locale=ng,T.version=ig,Object.defineProperties(T,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})})})(viewuiplus_min,viewuiplus_min.exports);var viewuiplus_minExports=viewuiplus_min.exports;const ViewUIPlus=getDefaultExportFromCjs(viewuiplus_minExports);var ENV=(B=>(B[B.WEBGL_LEGACY=0]="WEBGL_LEGACY",B[B.WEBGL=1]="WEBGL",B[B.WEBGL2=2]="WEBGL2",B))(ENV||{}),RENDERER_TYPE=(B=>(B[B.UNKNOWN=0]="UNKNOWN",B[B.WEBGL=1]="WEBGL",B[B.CANVAS=2]="CANVAS",B))(RENDERER_TYPE||{}),BUFFER_BITS=(B=>(B[B.COLOR=16384]="COLOR",B[B.DEPTH=256]="DEPTH",B[B.STENCIL=1024]="STENCIL",B))(BUFFER_BITS||{}),BLEND_MODES=(B=>(B[B.NORMAL=0]="NORMAL",B[B.ADD=1]="ADD",B[B.MULTIPLY=2]="MULTIPLY",B[B.SCREEN=3]="SCREEN",B[B.OVERLAY=4]="OVERLAY",B[B.DARKEN=5]="DARKEN",B[B.LIGHTEN=6]="LIGHTEN",B[B.COLOR_DODGE=7]="COLOR_DODGE",B[B.COLOR_BURN=8]="COLOR_BURN",B[B.HARD_LIGHT=9]="HARD_LIGHT",B[B.SOFT_LIGHT=10]="SOFT_LIGHT",B[B.DIFFERENCE=11]="DIFFERENCE",B[B.EXCLUSION=12]="EXCLUSION",B[B.HUE=13]="HUE",B[B.SATURATION=14]="SATURATION",B[B.COLOR=15]="COLOR",B[B.LUMINOSITY=16]="LUMINOSITY",B[B.NORMAL_NPM=17]="NORMAL_NPM",B[B.ADD_NPM=18]="ADD_NPM",B[B.SCREEN_NPM=19]="SCREEN_NPM",B[B.NONE=20]="NONE",B[B.SRC_OVER=0]="SRC_OVER",B[B.SRC_IN=21]="SRC_IN",B[B.SRC_OUT=22]="SRC_OUT",B[B.SRC_ATOP=23]="SRC_ATOP",B[B.DST_OVER=24]="DST_OVER",B[B.DST_IN=25]="DST_IN",B[B.DST_OUT=26]="DST_OUT",B[B.DST_ATOP=27]="DST_ATOP",B[B.ERASE=26]="ERASE",B[B.SUBTRACT=28]="SUBTRACT",B[B.XOR=29]="XOR",B))(BLEND_MODES||{}),DRAW_MODES=(B=>(B[B.POINTS=0]="POINTS",B[B.LINES=1]="LINES",B[B.LINE_LOOP=2]="LINE_LOOP",B[B.LINE_STRIP=3]="LINE_STRIP",B[B.TRIANGLES=4]="TRIANGLES",B[B.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",B[B.TRIANGLE_FAN=6]="TRIANGLE_FAN",B))(DRAW_MODES||{}),FORMATS=(B=>(B[B.RGBA=6408]="RGBA",B[B.RGB=6407]="RGB",B[B.RG=33319]="RG",B[B.RED=6403]="RED",B[B.RGBA_INTEGER=36249]="RGBA_INTEGER",B[B.RGB_INTEGER=36248]="RGB_INTEGER",B[B.RG_INTEGER=33320]="RG_INTEGER",B[B.RED_INTEGER=36244]="RED_INTEGER",B[B.ALPHA=6406]="ALPHA",B[B.LUMINANCE=6409]="LUMINANCE",B[B.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",B[B.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",B[B.DEPTH_STENCIL=34041]="DEPTH_STENCIL",B))(FORMATS||{}),TARGETS=(B=>(B[B.TEXTURE_2D=3553]="TEXTURE_2D",B[B.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",B[B.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",B[B.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",B[B.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",B[B.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",B[B.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",B[B.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",B[B.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",B))(TARGETS||{}),TYPES=(B=>(B[B.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",B[B.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",B[B.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",B[B.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",B[B.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",B[B.UNSIGNED_INT=5125]="UNSIGNED_INT",B[B.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",B[B.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",B[B.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",B[B.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",B[B.BYTE=5120]="BYTE",B[B.SHORT=5122]="SHORT",B[B.INT=5124]="INT",B[B.FLOAT=5126]="FLOAT",B[B.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",B[B.HALF_FLOAT=36193]="HALF_FLOAT",B))(TYPES||{}),SAMPLER_TYPES=(B=>(B[B.FLOAT=0]="FLOAT",B[B.INT=1]="INT",B[B.UINT=2]="UINT",B))(SAMPLER_TYPES||{}),SCALE_MODES=(B=>(B[B.NEAREST=0]="NEAREST",B[B.LINEAR=1]="LINEAR",B))(SCALE_MODES||{}),WRAP_MODES=(B=>(B[B.CLAMP=33071]="CLAMP",B[B.REPEAT=10497]="REPEAT",B[B.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",B))(WRAP_MODES||{}),MIPMAP_MODES=(B=>(B[B.OFF=0]="OFF",B[B.POW2=1]="POW2",B[B.ON=2]="ON",B[B.ON_MANUAL=3]="ON_MANUAL",B))(MIPMAP_MODES||{}),ALPHA_MODES=(B=>(B[B.NPM=0]="NPM",B[B.UNPACK=1]="UNPACK",B[B.PMA=2]="PMA",B[B.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",B[B.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",B[B.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",B))(ALPHA_MODES||{}),CLEAR_MODES=(B=>(B[B.NO=0]="NO",B[B.YES=1]="YES",B[B.AUTO=2]="AUTO",B[B.BLEND=0]="BLEND",B[B.CLEAR=1]="CLEAR",B[B.BLIT=2]="BLIT",B))(CLEAR_MODES||{}),GC_MODES=(B=>(B[B.AUTO=0]="AUTO",B[B.MANUAL=1]="MANUAL",B))(GC_MODES||{}),PRECISION=(B=>(B.LOW="lowp",B.MEDIUM="mediump",B.HIGH="highp",B))(PRECISION||{}),MASK_TYPES=(B=>(B[B.NONE=0]="NONE",B[B.SCISSOR=1]="SCISSOR",B[B.STENCIL=2]="STENCIL",B[B.SPRITE=3]="SPRITE",B[B.COLOR=4]="COLOR",B))(MASK_TYPES||{}),MSAA_QUALITY=(B=>(B[B.NONE=0]="NONE",B[B.LOW=2]="LOW",B[B.MEDIUM=4]="MEDIUM",B[B.HIGH=8]="HIGH",B))(MSAA_QUALITY||{}),BUFFER_TYPE=(B=>(B[B.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",B[B.ARRAY_BUFFER=34962]="ARRAY_BUFFER",B[B.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",B))(BUFFER_TYPE||{});const BrowserAdapter={createCanvas:(B,_)=>{const T=document.createElement("canvas");return T.width=B,T.height=_,T},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(B,_)=>fetch(B,_),parseXML:B=>new DOMParser().parseFromString(B,"text/xml")},settings={ADAPTER:BrowserAdapter,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(B){return typeof B<"u"&&B.platform==="MacIntel"&&typeof B.maxTouchPoints=="number"&&B.maxTouchPoints>1&&typeof MSStream>"u"};function createMatch(B){return function(_){return _.test(B)}}function isMobile$2(B){var _={userAgent:"",platform:"",maxTouchPoints:0};!B&&typeof navigator<"u"?_={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof B=="string"?_.userAgent=B:B&&B.userAgent&&(_={userAgent:B.userAgent,platform:B.platform,maxTouchPoints:B.maxTouchPoints||0});var T=_.userAgent,E=T.split("[FBAN");typeof E[1]<"u"&&(T=E[0]),E=T.split("Twitter"),typeof E[1]<"u"&&(T=E[0]);var W=createMatch(T),X={apple:{phone:W(appleIphone)&&!W(windowsPhone),ipod:W(appleIpod),tablet:!W(appleIphone)&&(W(appleTablet)||isAppleTabletOnIos13(_))&&!W(windowsPhone),universal:W(appleUniversal),device:(W(appleIphone)||W(appleIpod)||W(appleTablet)||W(appleUniversal)||isAppleTabletOnIos13(_))&&!W(windowsPhone)},amazon:{phone:W(amazonPhone),tablet:!W(amazonPhone)&&W(amazonTablet),device:W(amazonPhone)||W(amazonTablet)},android:{phone:!W(windowsPhone)&&W(amazonPhone)||!W(windowsPhone)&&W(androidPhone),tablet:!W(windowsPhone)&&!W(amazonPhone)&&!W(androidPhone)&&(W(amazonTablet)||W(androidTablet)),device:!W(windowsPhone)&&(W(amazonPhone)||W(amazonTablet)||W(androidPhone)||W(androidTablet))||W(/\bokhttp\b/i)},windows:{phone:W(windowsPhone),tablet:W(windowsTablet),device:W(windowsPhone)||W(windowsTablet)},other:{blackberry:W(otherBlackBerry),blackberry10:W(otherBlackBerry10),opera:W(otherOpera),firefox:W(otherFirefox),chrome:W(otherChrome),device:W(otherBlackBerry)||W(otherBlackBerry10)||W(otherOpera)||W(otherFirefox)||W(otherChrome)},any:!1,phone:!1,tablet:!1};return X.any=X.apple.device||X.android.device||X.windows.device||X.other.device,X.phone=X.apple.phone||X.android.phone||X.windows.phone,X.tablet=X.apple.tablet||X.android.tablet||X.windows.tablet,X}const isMobileCall=isMobile$2.default??isMobile$2,isMobile$1=isMobileCall(globalThis.navigator);settings.RETINA_PREFIX=/@([0-9\.]+)x/;settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var eventemitter3={exports:{}};(function(B){var _=Object.prototype.hasOwnProperty,T="~";function E(){}Object.create&&(E.prototype=Object.create(null),new E().__proto__||(T=!1));function W(te,ne,ae){this.fn=te,this.context=ne,this.once=ae||!1}function X(te,ne,ae,le,ue){if(typeof ae!="function")throw new TypeError("The listener must be a function");var ge=new W(ae,le||te,ue),ye=T?T+ne:ne;return te._events[ye]?te._events[ye].fn?te._events[ye]=[te._events[ye],ge]:te._events[ye].push(ge):(te._events[ye]=ge,te._eventsCount++),te}function q(te,ne){--te._eventsCount===0?te._events=new E:delete te._events[ne]}function Y(){this._events=new E,this._eventsCount=0}Y.prototype.eventNames=function(){var ne=[],ae,le;if(this._eventsCount===0)return ne;for(le in ae=this._events)_.call(ae,le)&&ne.push(T?le.slice(1):le);return Object.getOwnPropertySymbols?ne.concat(Object.getOwnPropertySymbols(ae)):ne},Y.prototype.listeners=function(ne){var ae=T?T+ne:ne,le=this._events[ae];if(!le)return[];if(le.fn)return[le.fn];for(var ue=0,ge=le.length,ye=new Array(ge);ue<ge;ue++)ye[ue]=le[ue].fn;return ye},Y.prototype.listenerCount=function(ne){var ae=T?T+ne:ne,le=this._events[ae];return le?le.fn?1:le.length:0},Y.prototype.emit=function(ne,ae,le,ue,ge,ye){var xe=T?T+ne:ne;if(!this._events[xe])return!1;var Te=this._events[xe],Ae=arguments.length,Ie,Ve;if(Te.fn){switch(Te.once&&this.removeListener(ne,Te.fn,void 0,!0),Ae){case 1:return Te.fn.call(Te.context),!0;case 2:return Te.fn.call(Te.context,ae),!0;case 3:return Te.fn.call(Te.context,ae,le),!0;case 4:return Te.fn.call(Te.context,ae,le,ue),!0;case 5:return Te.fn.call(Te.context,ae,le,ue,ge),!0;case 6:return Te.fn.call(Te.context,ae,le,ue,ge,ye),!0}for(Ve=1,Ie=new Array(Ae-1);Ve<Ae;Ve++)Ie[Ve-1]=arguments[Ve];Te.fn.apply(Te.context,Ie)}else{var $e=Te.length,We;for(Ve=0;Ve<$e;Ve++)switch(Te[Ve].once&&this.removeListener(ne,Te[Ve].fn,void 0,!0),Ae){case 1:Te[Ve].fn.call(Te[Ve].context);break;case 2:Te[Ve].fn.call(Te[Ve].context,ae);break;case 3:Te[Ve].fn.call(Te[Ve].context,ae,le);break;case 4:Te[Ve].fn.call(Te[Ve].context,ae,le,ue);break;default:if(!Ie)for(We=1,Ie=new Array(Ae-1);We<Ae;We++)Ie[We-1]=arguments[We];Te[Ve].fn.apply(Te[Ve].context,Ie)}}return!0},Y.prototype.on=function(ne,ae,le){return X(this,ne,ae,le,!1)},Y.prototype.once=function(ne,ae,le){return X(this,ne,ae,le,!0)},Y.prototype.removeListener=function(ne,ae,le,ue){var ge=T?T+ne:ne;if(!this._events[ge])return this;if(!ae)return q(this,ge),this;var ye=this._events[ge];if(ye.fn)ye.fn===ae&&(!ue||ye.once)&&(!le||ye.context===le)&&q(this,ge);else{for(var xe=0,Te=[],Ae=ye.length;xe<Ae;xe++)(ye[xe].fn!==ae||ue&&!ye[xe].once||le&&ye[xe].context!==le)&&Te.push(ye[xe]);Te.length?this._events[ge]=Te.length===1?Te[0]:Te:q(this,ge)}return this},Y.prototype.removeAllListeners=function(ne){var ae;return ne?(ae=T?T+ne:ne,this._events[ae]&&q(this,ae)):(this._events=new E,this._eventsCount=0),this},Y.prototype.off=Y.prototype.removeListener,Y.prototype.addListener=Y.prototype.on,Y.prefixed=T,Y.EventEmitter=Y,B.exports=Y})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);var earcut$2={exports:{}};earcut$2.exports=earcut;earcut$2.exports.default=earcut;function earcut(B,_,T){T=T||2;var E=_&&_.length,W=E?_[0]*T:B.length,X=linkedList$1(B,0,W,T,!0),q=[];if(!X||X.next===X.prev)return q;var Y,te,ne,ae,le,ue,ge;if(E&&(X=eliminateHoles$1(B,_,X,T)),B.length>80*T){Y=ne=B[0],te=ae=B[1];for(var ye=T;ye<W;ye+=T)le=B[ye],ue=B[ye+1],le<Y&&(Y=le),ue<te&&(te=ue),le>ne&&(ne=le),ue>ae&&(ae=ue);ge=Math.max(ne-Y,ae-te),ge=ge!==0?32767/ge:0}return earcutLinked$1(X,q,T,Y,te,ge,0),q}function linkedList$1(B,_,T,E,W){var X,q;if(W===signedArea$1(B,_,T,E)>0)for(X=_;X<T;X+=E)q=insertNode$1(X,B[X],B[X+1],q);else for(X=T-E;X>=_;X-=E)q=insertNode$1(X,B[X],B[X+1],q);return q&&equals$1(q,q.next)&&(removeNode$1(q),q=q.next),q}function filterPoints$1(B,_){if(!B)return B;_||(_=B);var T=B,E;do if(E=!1,!T.steiner&&(equals$1(T,T.next)||area$1(T.prev,T,T.next)===0)){if(removeNode$1(T),T=_=T.prev,T===T.next)break;E=!0}else T=T.next;while(E||T!==_);return _}function earcutLinked$1(B,_,T,E,W,X,q){if(B){!q&&X&&indexCurve$1(B,E,W,X);for(var Y=B,te,ne;B.prev!==B.next;){if(te=B.prev,ne=B.next,X?isEarHashed$1(B,E,W,X):isEar$1(B)){_.push(te.i/T|0),_.push(B.i/T|0),_.push(ne.i/T|0),removeNode$1(B),B=ne.next,Y=ne.next;continue}if(B=ne,B===Y){q?q===1?(B=cureLocalIntersections$1(filterPoints$1(B),_,T),earcutLinked$1(B,_,T,E,W,X,2)):q===2&&splitEarcut$1(B,_,T,E,W,X):earcutLinked$1(filterPoints$1(B),_,T,E,W,X,1);break}}}}function isEar$1(B){var _=B.prev,T=B,E=B.next;if(area$1(_,T,E)>=0)return!1;for(var W=_.x,X=T.x,q=E.x,Y=_.y,te=T.y,ne=E.y,ae=W<X?W<q?W:q:X<q?X:q,le=Y<te?Y<ne?Y:ne:te<ne?te:ne,ue=W>X?W>q?W:q:X>q?X:q,ge=Y>te?Y>ne?Y:ne:te>ne?te:ne,ye=E.next;ye!==_;){if(ye.x>=ae&&ye.x<=ue&&ye.y>=le&&ye.y<=ge&&pointInTriangle$1(W,Y,X,te,q,ne,ye.x,ye.y)&&area$1(ye.prev,ye,ye.next)>=0)return!1;ye=ye.next}return!0}function isEarHashed$1(B,_,T,E){var W=B.prev,X=B,q=B.next;if(area$1(W,X,q)>=0)return!1;for(var Y=W.x,te=X.x,ne=q.x,ae=W.y,le=X.y,ue=q.y,ge=Y<te?Y<ne?Y:ne:te<ne?te:ne,ye=ae<le?ae<ue?ae:ue:le<ue?le:ue,xe=Y>te?Y>ne?Y:ne:te>ne?te:ne,Te=ae>le?ae>ue?ae:ue:le>ue?le:ue,Ae=zOrder$1(ge,ye,_,T,E),Ie=zOrder$1(xe,Te,_,T,E),Ve=B.prevZ,$e=B.nextZ;Ve&&Ve.z>=Ae&&$e&&$e.z<=Ie;){if(Ve.x>=ge&&Ve.x<=xe&&Ve.y>=ye&&Ve.y<=Te&&Ve!==W&&Ve!==q&&pointInTriangle$1(Y,ae,te,le,ne,ue,Ve.x,Ve.y)&&area$1(Ve.prev,Ve,Ve.next)>=0||(Ve=Ve.prevZ,$e.x>=ge&&$e.x<=xe&&$e.y>=ye&&$e.y<=Te&&$e!==W&&$e!==q&&pointInTriangle$1(Y,ae,te,le,ne,ue,$e.x,$e.y)&&area$1($e.prev,$e,$e.next)>=0))return!1;$e=$e.nextZ}for(;Ve&&Ve.z>=Ae;){if(Ve.x>=ge&&Ve.x<=xe&&Ve.y>=ye&&Ve.y<=Te&&Ve!==W&&Ve!==q&&pointInTriangle$1(Y,ae,te,le,ne,ue,Ve.x,Ve.y)&&area$1(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.prevZ}for(;$e&&$e.z<=Ie;){if($e.x>=ge&&$e.x<=xe&&$e.y>=ye&&$e.y<=Te&&$e!==W&&$e!==q&&pointInTriangle$1(Y,ae,te,le,ne,ue,$e.x,$e.y)&&area$1($e.prev,$e,$e.next)>=0)return!1;$e=$e.nextZ}return!0}function cureLocalIntersections$1(B,_,T){var E=B;do{var W=E.prev,X=E.next.next;!equals$1(W,X)&&intersects$2(W,E,E.next,X)&&locallyInside$1(W,X)&&locallyInside$1(X,W)&&(_.push(W.i/T|0),_.push(E.i/T|0),_.push(X.i/T|0),removeNode$1(E),removeNode$1(E.next),E=B=X),E=E.next}while(E!==B);return filterPoints$1(E)}function splitEarcut$1(B,_,T,E,W,X){var q=B;do{for(var Y=q.next.next;Y!==q.prev;){if(q.i!==Y.i&&isValidDiagonal$1(q,Y)){var te=splitPolygon$1(q,Y);q=filterPoints$1(q,q.next),te=filterPoints$1(te,te.next),earcutLinked$1(q,_,T,E,W,X,0),earcutLinked$1(te,_,T,E,W,X,0);return}Y=Y.next}q=q.next}while(q!==B)}function eliminateHoles$1(B,_,T,E){var W=[],X,q,Y,te,ne;for(X=0,q=_.length;X<q;X++)Y=_[X]*E,te=X<q-1?_[X+1]*E:B.length,ne=linkedList$1(B,Y,te,E,!1),ne===ne.next&&(ne.steiner=!0),W.push(getLeftmost$1(ne));for(W.sort(compareX$1),X=0;X<W.length;X++)T=eliminateHole$1(W[X],T);return T}function compareX$1(B,_){return B.x-_.x}function eliminateHole$1(B,_){var T=findHoleBridge$1(B,_);if(!T)return _;var E=splitPolygon$1(T,B);return filterPoints$1(E,E.next),filterPoints$1(T,T.next)}function findHoleBridge$1(B,_){var T=_,E=B.x,W=B.y,X=-1/0,q;do{if(W<=T.y&&W>=T.next.y&&T.next.y!==T.y){var Y=T.x+(W-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(Y<=E&&Y>X&&(X=Y,q=T.x<T.next.x?T:T.next,Y===E))return q}T=T.next}while(T!==_);if(!q)return null;var te=q,ne=q.x,ae=q.y,le=1/0,ue;T=q;do E>=T.x&&T.x>=ne&&E!==T.x&&pointInTriangle$1(W<ae?E:X,W,ne,ae,W<ae?X:E,W,T.x,T.y)&&(ue=Math.abs(W-T.y)/(E-T.x),locallyInside$1(T,B)&&(ue<le||ue===le&&(T.x>q.x||T.x===q.x&&sectorContainsSector$1(q,T)))&&(q=T,le=ue)),T=T.next;while(T!==te);return q}function sectorContainsSector$1(B,_){return area$1(B.prev,B,_.prev)<0&&area$1(_.next,B,B.next)<0}function indexCurve$1(B,_,T,E){var W=B;do W.z===0&&(W.z=zOrder$1(W.x,W.y,_,T,E)),W.prevZ=W.prev,W.nextZ=W.next,W=W.next;while(W!==B);W.prevZ.nextZ=null,W.prevZ=null,sortLinked$1(W)}function sortLinked$1(B){var _,T,E,W,X,q,Y,te,ne=1;do{for(T=B,B=null,X=null,q=0;T;){for(q++,E=T,Y=0,_=0;_<ne&&(Y++,E=E.nextZ,!!E);_++);for(te=ne;Y>0||te>0&&E;)Y!==0&&(te===0||!E||T.z<=E.z)?(W=T,T=T.nextZ,Y--):(W=E,E=E.nextZ,te--),X?X.nextZ=W:B=W,W.prevZ=X,X=W;T=E}X.nextZ=null,ne*=2}while(q>1);return B}function zOrder$1(B,_,T,E,W){return B=(B-T)*W|0,_=(_-E)*W|0,B=(B|B<<8)&16711935,B=(B|B<<4)&252645135,B=(B|B<<2)&858993459,B=(B|B<<1)&1431655765,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,B|_<<1}function getLeftmost$1(B){var _=B,T=B;do(_.x<T.x||_.x===T.x&&_.y<T.y)&&(T=_),_=_.next;while(_!==B);return T}function pointInTriangle$1(B,_,T,E,W,X,q,Y){return(W-q)*(_-Y)>=(B-q)*(X-Y)&&(B-q)*(E-Y)>=(T-q)*(_-Y)&&(T-q)*(X-Y)>=(W-q)*(E-Y)}function isValidDiagonal$1(B,_){return B.next.i!==_.i&&B.prev.i!==_.i&&!intersectsPolygon$1(B,_)&&(locallyInside$1(B,_)&&locallyInside$1(_,B)&&middleInside$1(B,_)&&(area$1(B.prev,B,_.prev)||area$1(B,_.prev,_))||equals$1(B,_)&&area$1(B.prev,B,B.next)>0&&area$1(_.prev,_,_.next)>0)}function area$1(B,_,T){return(_.y-B.y)*(T.x-_.x)-(_.x-B.x)*(T.y-_.y)}function equals$1(B,_){return B.x===_.x&&B.y===_.y}function intersects$2(B,_,T,E){var W=sign$4(area$1(B,_,T)),X=sign$4(area$1(B,_,E)),q=sign$4(area$1(T,E,B)),Y=sign$4(area$1(T,E,_));return!!(W!==X&&q!==Y||W===0&&onSegment$1(B,T,_)||X===0&&onSegment$1(B,E,_)||q===0&&onSegment$1(T,B,E)||Y===0&&onSegment$1(T,_,E))}function onSegment$1(B,_,T){return _.x<=Math.max(B.x,T.x)&&_.x>=Math.min(B.x,T.x)&&_.y<=Math.max(B.y,T.y)&&_.y>=Math.min(B.y,T.y)}function sign$4(B){return B>0?1:B<0?-1:0}function intersectsPolygon$1(B,_){var T=B;do{if(T.i!==B.i&&T.next.i!==B.i&&T.i!==_.i&&T.next.i!==_.i&&intersects$2(T,T.next,B,_))return!0;T=T.next}while(T!==B);return!1}function locallyInside$1(B,_){return area$1(B.prev,B,B.next)<0?area$1(B,_,B.next)>=0&&area$1(B,B.prev,_)>=0:area$1(B,_,B.prev)<0||area$1(B,B.next,_)<0}function middleInside$1(B,_){var T=B,E=!1,W=(B.x+_.x)/2,X=(B.y+_.y)/2;do T.y>X!=T.next.y>X&&T.next.y!==T.y&&W<(T.next.x-T.x)*(X-T.y)/(T.next.y-T.y)+T.x&&(E=!E),T=T.next;while(T!==B);return E}function splitPolygon$1(B,_){var T=new Node$2(B.i,B.x,B.y),E=new Node$2(_.i,_.x,_.y),W=B.next,X=_.prev;return B.next=_,_.prev=B,T.next=W,W.prev=T,E.next=T,T.prev=E,X.next=E,E.prev=X,E}function insertNode$1(B,_,T,E){var W=new Node$2(B,_,T);return E?(W.next=E.next,W.prev=E,E.next.prev=W,E.next=W):(W.prev=W,W.next=W),W}function removeNode$1(B){B.next.prev=B.prev,B.prev.next=B.next,B.prevZ&&(B.prevZ.nextZ=B.nextZ),B.nextZ&&(B.nextZ.prevZ=B.prevZ)}function Node$2(B,_,T){this.i=B,this.x=_,this.y=T,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}earcut.deviation=function(B,_,T,E){var W=_&&_.length,X=W?_[0]*T:B.length,q=Math.abs(signedArea$1(B,0,X,T));if(W)for(var Y=0,te=_.length;Y<te;Y++){var ne=_[Y]*T,ae=Y<te-1?_[Y+1]*T:B.length;q-=Math.abs(signedArea$1(B,ne,ae,T))}var le=0;for(Y=0;Y<E.length;Y+=3){var ue=E[Y]*T,ge=E[Y+1]*T,ye=E[Y+2]*T;le+=Math.abs((B[ue]-B[ye])*(B[ge+1]-B[ue+1])-(B[ue]-B[ge])*(B[ye+1]-B[ue+1]))}return q===0&&le===0?0:Math.abs((le-q)/q)};function signedArea$1(B,_,T,E){for(var W=0,X=_,q=T-E;X<T;X+=E)W+=(B[q]-B[X])*(B[X+1]+B[q+1]),q=X;return W}earcut.flatten=function(B){for(var _=B[0][0].length,T={vertices:[],holes:[],dimensions:_},E=0,W=0;W<B.length;W++){for(var X=0;X<B[W].length;X++)for(var q=0;q<_;q++)T.vertices.push(B[W][X][q]);W>0&&(E+=B[W-1].length,T.holes.push(E))}return T};var earcutExports=earcut$2.exports;const earcut$1=getDefaultExportFromCjs(earcutExports);var punycode$1={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */punycode$1.exports;(function(B,_){(function(T){var E=_&&!_.nodeType&&_,W=B&&!B.nodeType&&B,X=typeof commonjsGlobal=="object"&&commonjsGlobal;(X.global===X||X.window===X||X.self===X)&&(T=X);var q,Y=2147483647,te=36,ne=1,ae=26,le=38,ue=700,ge=72,ye=128,xe="-",Te=/^xn--/,Ae=/[^\x20-\x7E]/,Ie=/[\x2E\u3002\uFF0E\uFF61]/g,Ve={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},$e=te-ne,We=Math.floor,Ue=String.fromCharCode,je;function ze(mt){throw new RangeError(Ve[mt])}function He(mt,Tr){for(var di=mt.length,Mi=[];di--;)Mi[di]=Tr(mt[di]);return Mi}function Le(mt,Tr){var di=mt.split("@"),Mi="";di.length>1&&(Mi=di[0]+"@",mt=di[1]),mt=mt.replace(Ie,".");var Gr=mt.split("."),ci=He(Gr,Tr).join(".");return Mi+ci}function qe(mt){for(var Tr=[],di=0,Mi=mt.length,Gr,ci;di<Mi;)Gr=mt.charCodeAt(di++),Gr>=55296&&Gr<=56319&&di<Mi?(ci=mt.charCodeAt(di++),(ci&64512)==56320?Tr.push(((Gr&1023)<<10)+(ci&1023)+65536):(Tr.push(Gr),di--)):Tr.push(Gr);return Tr}function Qe(mt){return He(mt,function(Tr){var di="";return Tr>65535&&(Tr-=65536,di+=Ue(Tr>>>10&1023|55296),Tr=56320|Tr&1023),di+=Ue(Tr),di}).join("")}function Ke(mt){return mt-48<10?mt-22:mt-65<26?mt-65:mt-97<26?mt-97:te}function Je(mt,Tr){return mt+22+75*(mt<26)-((Tr!=0)<<5)}function pt(mt,Tr,di){var Mi=0;for(mt=di?We(mt/ue):mt>>1,mt+=We(mt/Tr);mt>$e*ae>>1;Mi+=te)mt=We(mt/$e);return We(Mi+($e+1)*mt/(mt+le))}function ut(mt){var Tr=[],di=mt.length,Mi,Gr=0,ci=ye,gi=ge,fi,ri,ot,rt,gt,Or,et,at,Rr;for(fi=mt.lastIndexOf(xe),fi<0&&(fi=0),ri=0;ri<fi;++ri)mt.charCodeAt(ri)>=128&&ze("not-basic"),Tr.push(mt.charCodeAt(ri));for(ot=fi>0?fi+1:0;ot<di;){for(rt=Gr,gt=1,Or=te;ot>=di&&ze("invalid-input"),et=Ke(mt.charCodeAt(ot++)),(et>=te||et>We((Y-Gr)/gt))&&ze("overflow"),Gr+=et*gt,at=Or<=gi?ne:Or>=gi+ae?ae:Or-gi,!(et<at);Or+=te)Rr=te-at,gt>We(Y/Rr)&&ze("overflow"),gt*=Rr;Mi=Tr.length+1,gi=pt(Gr-rt,Mi,rt==0),We(Gr/Mi)>Y-ci&&ze("overflow"),ci+=We(Gr/Mi),Gr%=Mi,Tr.splice(Gr++,0,ci)}return Qe(Tr)}function lt(mt){var Tr,di,Mi,Gr,ci,gi,fi,ri,ot,rt,gt,Or=[],et,at,Rr,Br;for(mt=qe(mt),et=mt.length,Tr=ye,di=0,ci=ge,gi=0;gi<et;++gi)gt=mt[gi],gt<128&&Or.push(Ue(gt));for(Mi=Gr=Or.length,Gr&&Or.push(xe);Mi<et;){for(fi=Y,gi=0;gi<et;++gi)gt=mt[gi],gt>=Tr&&gt<fi&&(fi=gt);for(at=Mi+1,fi-Tr>We((Y-di)/at)&&ze("overflow"),di+=(fi-Tr)*at,Tr=fi,gi=0;gi<et;++gi)if(gt=mt[gi],gt<Tr&&++di>Y&&ze("overflow"),gt==Tr){for(ri=di,ot=te;rt=ot<=ci?ne:ot>=ci+ae?ae:ot-ci,!(ri<rt);ot+=te)Br=ri-rt,Rr=te-rt,Or.push(Ue(Je(rt+Br%Rr,0))),ri=We(Br/Rr);Or.push(Ue(Je(ri,0))),ci=pt(di,at,Mi==Gr),di=0,++Mi}++di,++Tr}return Or.join("")}function st(mt){return Le(mt,function(Tr){return Te.test(Tr)?ut(Tr.slice(4).toLowerCase()):Tr})}function sr(mt){return Le(mt,function(Tr){return Ae.test(Tr)?"xn--"+lt(Tr):Tr})}if(q={version:"1.4.1",ucs2:{decode:qe,encode:Qe},decode:ut,encode:lt,toASCII:sr,toUnicode:st},E&&W)if(B.exports==E)W.exports=q;else for(je in q)q.hasOwnProperty(je)&&(E[je]=q[je]);else T.punycode=q})(commonjsGlobal)})(punycode$1,punycode$1.exports);var punycodeExports=punycode$1.exports,type=TypeError;const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);var hasMap=typeof Map=="function"&&Map.prototype,mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,mapSize$1=hasMap&&mapSizeDescriptor&&typeof mapSizeDescriptor.get=="function"?mapSizeDescriptor.get:null,mapForEach=hasMap&&Map.prototype.forEach,hasSet=typeof Set=="function"&&Set.prototype,setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,setSize=hasSet&&setSizeDescriptor&&typeof setSizeDescriptor.get=="function"?setSizeDescriptor.get:null,setForEach=hasSet&&Set.prototype.forEach,hasWeakMap=typeof WeakMap=="function"&&WeakMap.prototype,weakMapHas=hasWeakMap?WeakMap.prototype.has:null,hasWeakSet=typeof WeakSet=="function"&&WeakSet.prototype,weakSetHas=hasWeakSet?WeakSet.prototype.has:null,hasWeakRef=typeof WeakRef=="function"&&WeakRef.prototype,weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null,booleanValueOf=Boolean.prototype.valueOf,objectToString=Object.prototype.toString,functionToString=Function.prototype.toString,$match=String.prototype.match,$slice=String.prototype.slice,$replace$1=String.prototype.replace,$toUpperCase=String.prototype.toUpperCase,$toLowerCase=String.prototype.toLowerCase,$test=RegExp.prototype.test,$concat$1=Array.prototype.concat,$join=Array.prototype.join,$arrSlice=Array.prototype.slice,$floor=Math.floor,bigIntValueOf=typeof BigInt=="function"?BigInt.prototype.valueOf:null,gOPS=Object.getOwnPropertySymbols,symToString=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,hasShammedSymbols=typeof Symbol=="function"&&typeof Symbol.iterator=="object",toStringTag=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===hasShammedSymbols||!0)?Symbol.toStringTag:null,isEnumerable=Object.prototype.propertyIsEnumerable,gPO=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(B){return B.__proto__}:null);function addNumericSeparator(B,_){if(B===1/0||B===-1/0||B!==B||B&&B>-1e3&&B<1e3||$test.call(/e/,_))return _;var T=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof B=="number"){var E=B<0?-$floor(-B):$floor(B);if(E!==B){var W=String(E),X=$slice.call(_,W.length+1);return $replace$1.call(W,T,"$&_")+"."+$replace$1.call($replace$1.call(X,/([0-9]{3})/g,"$&_"),/_$/,"")}}return $replace$1.call(_,T,"$&_")}var utilInspect=require$$0,inspectCustom=utilInspect.custom,inspectSymbol=isSymbol(inspectCustom)?inspectCustom:null,quotes={__proto__:null,double:'"',single:"'"},quoteREs={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},objectInspect=function B(_,T,E,W){var X=T||{};if(has$3(X,"quoteStyle")&&!has$3(quotes,X.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(has$3(X,"maxStringLength")&&(typeof X.maxStringLength=="number"?X.maxStringLength<0&&X.maxStringLength!==1/0:X.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var q=has$3(X,"customInspect")?X.customInspect:!0;if(typeof q!="boolean"&&q!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(has$3(X,"indent")&&X.indent!==null&&X.indent!=="	"&&!(parseInt(X.indent,10)===X.indent&&X.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(has$3(X,"numericSeparator")&&typeof X.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var Y=X.numericSeparator;if(typeof _>"u")return"undefined";if(_===null)return"null";if(typeof _=="boolean")return _?"true":"false";if(typeof _=="string")return inspectString(_,X);if(typeof _=="number"){if(_===0)return 1/0/_>0?"0":"-0";var te=String(_);return Y?addNumericSeparator(_,te):te}if(typeof _=="bigint"){var ne=String(_)+"n";return Y?addNumericSeparator(_,ne):ne}var ae=typeof X.depth>"u"?5:X.depth;if(typeof E>"u"&&(E=0),E>=ae&&ae>0&&typeof _=="object")return isArray$3(_)?"[Array]":"[Object]";var le=getIndent(X,E);if(typeof W>"u")W=[];else if(indexOf(W,_)>=0)return"[Circular]";function ue(Ke,Je,pt){if(Je&&(W=$arrSlice.call(W),W.push(Je)),pt){var ut={depth:X.depth};return has$3(X,"quoteStyle")&&(ut.quoteStyle=X.quoteStyle),B(Ke,ut,E+1,W)}return B(Ke,X,E+1,W)}if(typeof _=="function"&&!isRegExp$1(_)){var ge=nameOf(_),ye=arrObjKeys(_,ue);return"[Function"+(ge?": "+ge:" (anonymous)")+"]"+(ye.length>0?" { "+$join.call(ye,", ")+" }":"")}if(isSymbol(_)){var xe=hasShammedSymbols?$replace$1.call(String(_),/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(_);return typeof _=="object"&&!hasShammedSymbols?markBoxed(xe):xe}if(isElement(_)){for(var Te="<"+$toLowerCase.call(String(_.nodeName)),Ae=_.attributes||[],Ie=0;Ie<Ae.length;Ie++)Te+=" "+Ae[Ie].name+"="+wrapQuotes(quote(Ae[Ie].value),"double",X);return Te+=">",_.childNodes&&_.childNodes.length&&(Te+="..."),Te+="</"+$toLowerCase.call(String(_.nodeName))+">",Te}if(isArray$3(_)){if(_.length===0)return"[]";var Ve=arrObjKeys(_,ue);return le&&!singleLineValues(Ve)?"["+indentedJoin(Ve,le)+"]":"[ "+$join.call(Ve,", ")+" ]"}if(isError(_)){var $e=arrObjKeys(_,ue);return!("cause"in Error.prototype)&&"cause"in _&&!isEnumerable.call(_,"cause")?"{ ["+String(_)+"] "+$join.call($concat$1.call("[cause]: "+ue(_.cause),$e),", ")+" }":$e.length===0?"["+String(_)+"]":"{ ["+String(_)+"] "+$join.call($e,", ")+" }"}if(typeof _=="object"&&q){if(inspectSymbol&&typeof _[inspectSymbol]=="function"&&utilInspect)return utilInspect(_,{depth:ae-E});if(q!=="symbol"&&typeof _.inspect=="function")return _.inspect()}if(isMap(_)){var We=[];return mapForEach&&mapForEach.call(_,function(Ke,Je){We.push(ue(Je,_,!0)+" => "+ue(Ke,_))}),collectionOf("Map",mapSize$1.call(_),We,le)}if(isSet(_)){var Ue=[];return setForEach&&setForEach.call(_,function(Ke){Ue.push(ue(Ke,_))}),collectionOf("Set",setSize.call(_),Ue,le)}if(isWeakMap(_))return weakCollectionOf("WeakMap");if(isWeakSet(_))return weakCollectionOf("WeakSet");if(isWeakRef(_))return weakCollectionOf("WeakRef");if(isNumber(_))return markBoxed(ue(Number(_)));if(isBigInt(_))return markBoxed(ue(bigIntValueOf.call(_)));if(isBoolean(_))return markBoxed(booleanValueOf.call(_));if(isString(_))return markBoxed(ue(String(_)));if(typeof window<"u"&&_===window)return"{ [object Window] }";if(typeof globalThis<"u"&&_===globalThis||typeof commonjsGlobal<"u"&&_===commonjsGlobal)return"{ [object globalThis] }";if(!isDate(_)&&!isRegExp$1(_)){var je=arrObjKeys(_,ue),ze=gPO?gPO(_)===Object.prototype:_ instanceof Object||_.constructor===Object,He=_ instanceof Object?"":"null prototype",Le=!ze&&toStringTag&&Object(_)===_&&toStringTag in _?$slice.call(toStr(_),8,-1):He?"Object":"",qe=ze||typeof _.constructor!="function"?"":_.constructor.name?_.constructor.name+" ":"",Qe=qe+(Le||He?"["+$join.call($concat$1.call([],Le||[],He||[]),": ")+"] ":"");return je.length===0?Qe+"{}":le?Qe+"{"+indentedJoin(je,le)+"}":Qe+"{ "+$join.call(je,", ")+" }"}return String(_)};function wrapQuotes(B,_,T){var E=T.quoteStyle||_,W=quotes[E];return W+B+W}function quote(B){return $replace$1.call(String(B),/"/g,"&quot;")}function isArray$3(B){return toStr(B)==="[object Array]"&&(!toStringTag||!(typeof B=="object"&&toStringTag in B))}function isDate(B){return toStr(B)==="[object Date]"&&(!toStringTag||!(typeof B=="object"&&toStringTag in B))}function isRegExp$1(B){return toStr(B)==="[object RegExp]"&&(!toStringTag||!(typeof B=="object"&&toStringTag in B))}function isError(B){return toStr(B)==="[object Error]"&&(!toStringTag||!(typeof B=="object"&&toStringTag in B))}function isString(B){return toStr(B)==="[object String]"&&(!toStringTag||!(typeof B=="object"&&toStringTag in B))}function isNumber(B){return toStr(B)==="[object Number]"&&(!toStringTag||!(typeof B=="object"&&toStringTag in B))}function isBoolean(B){return toStr(B)==="[object Boolean]"&&(!toStringTag||!(typeof B=="object"&&toStringTag in B))}function isSymbol(B){if(hasShammedSymbols)return B&&typeof B=="object"&&B instanceof Symbol;if(typeof B=="symbol")return!0;if(!B||typeof B!="object"||!symToString)return!1;try{return symToString.call(B),!0}catch{}return!1}function isBigInt(B){if(!B||typeof B!="object"||!bigIntValueOf)return!1;try{return bigIntValueOf.call(B),!0}catch{}return!1}var hasOwn$1=Object.prototype.hasOwnProperty||function(B){return B in this};function has$3(B,_){return hasOwn$1.call(B,_)}function toStr(B){return objectToString.call(B)}function nameOf(B){if(B.name)return B.name;var _=$match.call(functionToString.call(B),/^function\s*([\w$]+)/);return _?_[1]:null}function indexOf(B,_){if(B.indexOf)return B.indexOf(_);for(var T=0,E=B.length;T<E;T++)if(B[T]===_)return T;return-1}function isMap(B){if(!mapSize$1||!B||typeof B!="object")return!1;try{mapSize$1.call(B);try{setSize.call(B)}catch{return!0}return B instanceof Map}catch{}return!1}function isWeakMap(B){if(!weakMapHas||!B||typeof B!="object")return!1;try{weakMapHas.call(B,weakMapHas);try{weakSetHas.call(B,weakSetHas)}catch{return!0}return B instanceof WeakMap}catch{}return!1}function isWeakRef(B){if(!weakRefDeref||!B||typeof B!="object")return!1;try{return weakRefDeref.call(B),!0}catch{}return!1}function isSet(B){if(!setSize||!B||typeof B!="object")return!1;try{setSize.call(B);try{mapSize$1.call(B)}catch{return!0}return B instanceof Set}catch{}return!1}function isWeakSet(B){if(!weakSetHas||!B||typeof B!="object")return!1;try{weakSetHas.call(B,weakSetHas);try{weakMapHas.call(B,weakMapHas)}catch{return!0}return B instanceof WeakSet}catch{}return!1}function isElement(B){return!B||typeof B!="object"?!1:typeof HTMLElement<"u"&&B instanceof HTMLElement?!0:typeof B.nodeName=="string"&&typeof B.getAttribute=="function"}function inspectString(B,_){if(B.length>_.maxStringLength){var T=B.length-_.maxStringLength,E="... "+T+" more character"+(T>1?"s":"");return inspectString($slice.call(B,0,_.maxStringLength),_)+E}var W=quoteREs[_.quoteStyle||"single"];W.lastIndex=0;var X=$replace$1.call($replace$1.call(B,W,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(X,"single",_)}function lowbyte(B){var _=B.charCodeAt(0),T={8:"b",9:"t",10:"n",12:"f",13:"r"}[_];return T?"\\"+T:"\\x"+(_<16?"0":"")+$toUpperCase.call(_.toString(16))}function markBoxed(B){return"Object("+B+")"}function weakCollectionOf(B){return B+" { ? }"}function collectionOf(B,_,T,E){var W=E?indentedJoin(T,E):$join.call(T,", ");return B+" ("+_+") {"+W+"}"}function singleLineValues(B){for(var _=0;_<B.length;_++)if(indexOf(B[_],`
`)>=0)return!1;return!0}function getIndent(B,_){var T;if(B.indent==="	")T="	";else if(typeof B.indent=="number"&&B.indent>0)T=$join.call(Array(B.indent+1)," ");else return null;return{base:T,prev:$join.call(Array(_+1),T)}}function indentedJoin(B,_){if(B.length===0)return"";var T=`
`+_.prev+_.base;return T+$join.call(B,","+T)+`
`+_.prev}function arrObjKeys(B,_){var T=isArray$3(B),E=[];if(T){E.length=B.length;for(var W=0;W<B.length;W++)E[W]=has$3(B,W)?_(B[W],B):""}var X=typeof gOPS=="function"?gOPS(B):[],q;if(hasShammedSymbols){q={};for(var Y=0;Y<X.length;Y++)q["$"+X[Y]]=X[Y]}for(var te in B)has$3(B,te)&&(T&&String(Number(te))===te&&te<B.length||hasShammedSymbols&&q["$"+te]instanceof Symbol||($test.call(/[^\w$]/,te)?E.push(_(te,B)+": "+_(B[te],B)):E.push(te+": "+_(B[te],B))));if(typeof gOPS=="function")for(var ne=0;ne<X.length;ne++)isEnumerable.call(B,X[ne])&&E.push("["+_(X[ne])+"]: "+_(B[X[ne]],B));return E}var inspect$3=objectInspect,$TypeError$5=type,listGetNode=function(B,_,T){for(var E=B,W;(W=E.next)!=null;E=W)if(W.key===_)return E.next=W.next,T||(W.next=B.next,B.next=W),W},listGet=function(B,_){if(B){var T=listGetNode(B,_);return T&&T.value}},listSet=function(B,_,T){var E=listGetNode(B,_);E?E.value=T:B.next={key:_,next:B.next,value:T}},listHas=function(B,_){return B?!!listGetNode(B,_):!1},listDelete=function(B,_){if(B)return listGetNode(B,_,!0)},sideChannelList=function(){var _,T={assert:function(E){if(!T.has(E))throw new $TypeError$5("Side channel does not contain "+inspect$3(E))},delete:function(E){var W=_&&_.next,X=listDelete(_,E);return X&&W&&W===X&&(_=void 0),!!X},get:function(E){return listGet(_,E)},has:function(E){return listHas(_,E)},set:function(E,W){_||(_={next:void 0}),listSet(_,E,W)}};return T},esObjectAtoms=Object,esErrors=Error,_eval=EvalError,range=RangeError,ref=ReferenceError,syntax=SyntaxError,uri=URIError,abs$3=Math.abs,floor$1=Math.floor,max$2=Math.max,min$2=Math.min,pow$2=Math.pow,round$2=Math.round,_isNaN=Number.isNaN||function(_){return _!==_},$isNaN=_isNaN,sign$3=function(_){return $isNaN(_)||_===0?_:_<0?-1:1},gOPD=Object.getOwnPropertyDescriptor,$gOPD$1=gOPD;if($gOPD$1)try{$gOPD$1([],"length")}catch{$gOPD$1=null}var gopd=$gOPD$1,$defineProperty$1=Object.defineProperty||!1;if($defineProperty$1)try{$defineProperty$1({},"a",{value:1})}catch{$defineProperty$1=!1}var esDefineProperty=$defineProperty$1,shams,hasRequiredShams;function requireShams(){return hasRequiredShams||(hasRequiredShams=1,shams=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var _={},T=Symbol("test"),E=Object(T);if(typeof T=="string"||Object.prototype.toString.call(T)!=="[object Symbol]"||Object.prototype.toString.call(E)!=="[object Symbol]")return!1;var W=42;_[T]=W;for(var X in _)return!1;if(typeof Object.keys=="function"&&Object.keys(_).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(_).length!==0)return!1;var q=Object.getOwnPropertySymbols(_);if(q.length!==1||q[0]!==T||!Object.prototype.propertyIsEnumerable.call(_,T))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var Y=Object.getOwnPropertyDescriptor(_,T);if(Y.value!==W||Y.enumerable!==!0)return!1}return!0}),shams}var hasSymbols$1,hasRequiredHasSymbols;function requireHasSymbols(){if(hasRequiredHasSymbols)return hasSymbols$1;hasRequiredHasSymbols=1;var B=typeof Symbol<"u"&&Symbol,_=requireShams();return hasSymbols$1=function(){return typeof B!="function"||typeof Symbol!="function"||typeof B("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:_()},hasSymbols$1}var Reflect_getPrototypeOf,hasRequiredReflect_getPrototypeOf;function requireReflect_getPrototypeOf(){return hasRequiredReflect_getPrototypeOf||(hasRequiredReflect_getPrototypeOf=1,Reflect_getPrototypeOf=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Reflect_getPrototypeOf}var Object_getPrototypeOf,hasRequiredObject_getPrototypeOf;function requireObject_getPrototypeOf(){if(hasRequiredObject_getPrototypeOf)return Object_getPrototypeOf;hasRequiredObject_getPrototypeOf=1;var B=esObjectAtoms;return Object_getPrototypeOf=B.getPrototypeOf||null,Object_getPrototypeOf}var implementation,hasRequiredImplementation;function requireImplementation(){if(hasRequiredImplementation)return implementation;hasRequiredImplementation=1;var B="Function.prototype.bind called on incompatible ",_=Object.prototype.toString,T=Math.max,E="[object Function]",W=function(te,ne){for(var ae=[],le=0;le<te.length;le+=1)ae[le]=te[le];for(var ue=0;ue<ne.length;ue+=1)ae[ue+te.length]=ne[ue];return ae},X=function(te,ne){for(var ae=[],le=ne,ue=0;le<te.length;le+=1,ue+=1)ae[ue]=te[le];return ae},q=function(Y,te){for(var ne="",ae=0;ae<Y.length;ae+=1)ne+=Y[ae],ae+1<Y.length&&(ne+=te);return ne};return implementation=function(te){var ne=this;if(typeof ne!="function"||_.apply(ne)!==E)throw new TypeError(B+ne);for(var ae=X(arguments,1),le,ue=function(){if(this instanceof le){var Ae=ne.apply(this,W(ae,arguments));return Object(Ae)===Ae?Ae:this}return ne.apply(te,W(ae,arguments))},ge=T(0,ne.length-ae.length),ye=[],xe=0;xe<ge;xe++)ye[xe]="$"+xe;if(le=Function("binder","return function ("+q(ye,",")+"){ return binder.apply(this,arguments); }")(ue),ne.prototype){var Te=function(){};Te.prototype=ne.prototype,le.prototype=new Te,Te.prototype=null}return le},implementation}var functionBind,hasRequiredFunctionBind;function requireFunctionBind(){if(hasRequiredFunctionBind)return functionBind;hasRequiredFunctionBind=1;var B=requireImplementation();return functionBind=Function.prototype.bind||B,functionBind}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){return hasRequiredFunctionCall||(hasRequiredFunctionCall=1,functionCall=Function.prototype.call),functionCall}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){return hasRequiredFunctionApply||(hasRequiredFunctionApply=1,functionApply=Function.prototype.apply),functionApply}var reflectApply=typeof Reflect<"u"&&Reflect&&Reflect.apply,bind$2=requireFunctionBind(),$apply$1=requireFunctionApply(),$call$2=requireFunctionCall(),$reflectApply=reflectApply,actualApply=$reflectApply||bind$2.call($call$2,$apply$1),bind$1=requireFunctionBind(),$TypeError$4=type,$call$1=requireFunctionCall(),$actualApply=actualApply,callBindApplyHelpers=function(_){if(_.length<1||typeof _[0]!="function")throw new $TypeError$4("a function is required");return $actualApply(bind$1,$call$1,_)},get,hasRequiredGet;function requireGet(){if(hasRequiredGet)return get;hasRequiredGet=1;var B=callBindApplyHelpers,_=gopd,T;try{T=[].__proto__===Array.prototype}catch(q){if(!q||typeof q!="object"||!("code"in q)||q.code!=="ERR_PROTO_ACCESS")throw q}var E=!!T&&_&&_(Object.prototype,"__proto__"),W=Object,X=W.getPrototypeOf;return get=E&&typeof E.get=="function"?B([E.get]):typeof X=="function"?function(Y){return X(Y==null?Y:W(Y))}:!1,get}var getProto$1,hasRequiredGetProto;function requireGetProto(){if(hasRequiredGetProto)return getProto$1;hasRequiredGetProto=1;var B=requireReflect_getPrototypeOf(),_=requireObject_getPrototypeOf(),T=requireGet();return getProto$1=B?function(W){return B(W)}:_?function(W){if(!W||typeof W!="object"&&typeof W!="function")throw new TypeError("getProto: not an object");return _(W)}:T?function(W){return T(W)}:null,getProto$1}var hasown,hasRequiredHasown;function requireHasown(){if(hasRequiredHasown)return hasown;hasRequiredHasown=1;var B=Function.prototype.call,_=Object.prototype.hasOwnProperty,T=requireFunctionBind();return hasown=T.call(B,_),hasown}var undefined$1,$Object=esObjectAtoms,$Error=esErrors,$EvalError=_eval,$RangeError=range,$ReferenceError=ref,$SyntaxError=syntax,$TypeError$3=type,$URIError=uri,abs$2=abs$3,floor=floor$1,max$1=max$2,min$1=min$2,pow$1=pow$2,round$1=round$2,sign$2=sign$3,$Function=Function,getEvalledConstructor=function(B){try{return $Function('"use strict"; return ('+B+").constructor;")()}catch{}},$gOPD=gopd,$defineProperty=esDefineProperty,throwTypeError=function(){throw new $TypeError$3},ThrowTypeError=$gOPD?function(){try{return arguments.callee,throwTypeError}catch{try{return $gOPD(arguments,"callee").get}catch{return throwTypeError}}}():throwTypeError,hasSymbols=requireHasSymbols()(),getProto=requireGetProto(),$ObjectGPO=requireObject_getPrototypeOf(),$ReflectGPO=requireReflect_getPrototypeOf(),$apply=requireFunctionApply(),$call=requireFunctionCall(),needsEval={},TypedArray=typeof Uint8Array>"u"||!getProto?undefined$1:getProto(Uint8Array),INTRINSICS={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols&&getProto?getProto([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics>"u"?undefined$1:Atomics,"%BigInt%":typeof BigInt>"u"?undefined$1:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?undefined$1:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":$Error,"%eval%":eval,"%EvalError%":$EvalError,"%Float32Array%":typeof Float32Array>"u"?undefined$1:Float32Array,"%Float64Array%":typeof Float64Array>"u"?undefined$1:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array>"u"?undefined$1:Int8Array,"%Int16Array%":typeof Int16Array>"u"?undefined$1:Int16Array,"%Int32Array%":typeof Int32Array>"u"?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols&&getProto?getProto(getProto([][Symbol.iterator]())):undefined$1,"%JSON%":typeof JSON=="object"?JSON:undefined$1,"%Map%":typeof Map>"u"?undefined$1:Map,"%MapIteratorPrototype%":typeof Map>"u"||!hasSymbols||!getProto?undefined$1:getProto(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":$Object,"%Object.getOwnPropertyDescriptor%":$gOPD,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?undefined$1:Promise,"%Proxy%":typeof Proxy>"u"?undefined$1:Proxy,"%RangeError%":$RangeError,"%ReferenceError%":$ReferenceError,"%Reflect%":typeof Reflect>"u"?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?undefined$1:Set,"%SetIteratorPrototype%":typeof Set>"u"||!hasSymbols||!getProto?undefined$1:getProto(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols&&getProto?getProto(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols?Symbol:undefined$1,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError$3,"%Uint8Array%":typeof Uint8Array>"u"?undefined$1:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?undefined$1:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?undefined$1:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?undefined$1:Uint32Array,"%URIError%":$URIError,"%WeakMap%":typeof WeakMap>"u"?undefined$1:WeakMap,"%WeakRef%":typeof WeakRef>"u"?undefined$1:WeakRef,"%WeakSet%":typeof WeakSet>"u"?undefined$1:WeakSet,"%Function.prototype.call%":$call,"%Function.prototype.apply%":$apply,"%Object.defineProperty%":$defineProperty,"%Object.getPrototypeOf%":$ObjectGPO,"%Math.abs%":abs$2,"%Math.floor%":floor,"%Math.max%":max$1,"%Math.min%":min$1,"%Math.pow%":pow$1,"%Math.round%":round$1,"%Math.sign%":sign$2,"%Reflect.getPrototypeOf%":$ReflectGPO};if(getProto)try{null.error}catch(B){var errorProto=getProto(getProto(B));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function B(_){var T;if(_==="%AsyncFunction%")T=getEvalledConstructor("async function () {}");else if(_==="%GeneratorFunction%")T=getEvalledConstructor("function* () {}");else if(_==="%AsyncGeneratorFunction%")T=getEvalledConstructor("async function* () {}");else if(_==="%AsyncGenerator%"){var E=B("%AsyncGeneratorFunction%");E&&(T=E.prototype)}else if(_==="%AsyncIteratorPrototype%"){var W=B("%AsyncGenerator%");W&&getProto&&(T=getProto(W.prototype))}return INTRINSICS[_]=T,T},LEGACY_ALIASES={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=requireFunctionBind(),hasOwn=requireHasown(),$concat=bind.call($call,Array.prototype.concat),$spliceApply=bind.call($apply,Array.prototype.splice),$replace=bind.call($call,String.prototype.replace),$strSlice=bind.call($call,String.prototype.slice),$exec=bind.call($call,RegExp.prototype.exec),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function(_){var T=$strSlice(_,0,1),E=$strSlice(_,-1);if(T==="%"&&E!=="%")throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`");if(E==="%"&&T!=="%")throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`");var W=[];return $replace(_,rePropName,function(X,q,Y,te){W[W.length]=Y?$replace(te,reEscapeChar,"$1"):q||X}),W},getBaseIntrinsic=function(_,T){var E=_,W;if(hasOwn(LEGACY_ALIASES,E)&&(W=LEGACY_ALIASES[E],E="%"+W[0]+"%"),hasOwn(INTRINSICS,E)){var X=INTRINSICS[E];if(X===needsEval&&(X=doEval(E)),typeof X>"u"&&!T)throw new $TypeError$3("intrinsic "+_+" exists, but is not available. Please file an issue!");return{alias:W,name:E,value:X}}throw new $SyntaxError("intrinsic "+_+" does not exist!")},getIntrinsic=function(_,T){if(typeof _!="string"||_.length===0)throw new $TypeError$3("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof T!="boolean")throw new $TypeError$3('"allowMissing" argument must be a boolean');if($exec(/^%?[^%]*%?$/,_)===null)throw new $SyntaxError("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var E=stringToPath(_),W=E.length>0?E[0]:"",X=getBaseIntrinsic("%"+W+"%",T),q=X.name,Y=X.value,te=!1,ne=X.alias;ne&&(W=ne[0],$spliceApply(E,$concat([0,1],ne)));for(var ae=1,le=!0;ae<E.length;ae+=1){var ue=E[ae],ge=$strSlice(ue,0,1),ye=$strSlice(ue,-1);if((ge==='"'||ge==="'"||ge==="`"||ye==='"'||ye==="'"||ye==="`")&&ge!==ye)throw new $SyntaxError("property names with quotes must have matching quotes");if((ue==="constructor"||!le)&&(te=!0),W+="."+ue,q="%"+W+"%",hasOwn(INTRINSICS,q))Y=INTRINSICS[q];else if(Y!=null){if(!(ue in Y)){if(!T)throw new $TypeError$3("base intrinsic for "+_+" exists, but the property is not available.");return}if($gOPD&&ae+1>=E.length){var xe=$gOPD(Y,ue);le=!!xe,le&&"get"in xe&&!("originalValue"in xe.get)?Y=xe.get:Y=Y[ue]}else le=hasOwn(Y,ue),Y=Y[ue];le&&!te&&(INTRINSICS[q]=Y)}}return Y},GetIntrinsic$2=getIntrinsic,callBindBasic=callBindApplyHelpers,$indexOf=callBindBasic([GetIntrinsic$2("%String.prototype.indexOf%")]),callBound$2=function(_,T){var E=GetIntrinsic$2(_,!!T);return typeof E=="function"&&$indexOf(_,".prototype.")>-1?callBindBasic([E]):E},GetIntrinsic$1=getIntrinsic,callBound$1=callBound$2,inspect$2=objectInspect,$TypeError$2=type,$Map=GetIntrinsic$1("%Map%",!0),$mapGet=callBound$1("Map.prototype.get",!0),$mapSet=callBound$1("Map.prototype.set",!0),$mapHas=callBound$1("Map.prototype.has",!0),$mapDelete=callBound$1("Map.prototype.delete",!0),$mapSize=callBound$1("Map.prototype.size",!0),sideChannelMap=!!$Map&&function(){var _,T={assert:function(E){if(!T.has(E))throw new $TypeError$2("Side channel does not contain "+inspect$2(E))},delete:function(E){if(_){var W=$mapDelete(_,E);return $mapSize(_)===0&&(_=void 0),W}return!1},get:function(E){if(_)return $mapGet(_,E)},has:function(E){return _?$mapHas(_,E):!1},set:function(E,W){_||(_=new $Map),$mapSet(_,E,W)}};return T},GetIntrinsic=getIntrinsic,callBound=callBound$2,inspect$1=objectInspect,getSideChannelMap$1=sideChannelMap,$TypeError$1=type,$WeakMap=GetIntrinsic("%WeakMap%",!0),$weakMapGet=callBound("WeakMap.prototype.get",!0),$weakMapSet=callBound("WeakMap.prototype.set",!0),$weakMapHas=callBound("WeakMap.prototype.has",!0),$weakMapDelete=callBound("WeakMap.prototype.delete",!0),sideChannelWeakmap=$WeakMap?function(){var _,T,E={assert:function(W){if(!E.has(W))throw new $TypeError$1("Side channel does not contain "+inspect$1(W))},delete:function(W){if($WeakMap&&W&&(typeof W=="object"||typeof W=="function")){if(_)return $weakMapDelete(_,W)}else if(getSideChannelMap$1&&T)return T.delete(W);return!1},get:function(W){return $WeakMap&&W&&(typeof W=="object"||typeof W=="function")&&_?$weakMapGet(_,W):T&&T.get(W)},has:function(W){return $WeakMap&&W&&(typeof W=="object"||typeof W=="function")&&_?$weakMapHas(_,W):!!T&&T.has(W)},set:function(W,X){$WeakMap&&W&&(typeof W=="object"||typeof W=="function")?(_||(_=new $WeakMap),$weakMapSet(_,W,X)):getSideChannelMap$1&&(T||(T=getSideChannelMap$1()),T.set(W,X))}};return E}:getSideChannelMap$1,$TypeError=type,inspect=objectInspect,getSideChannelList=sideChannelList,getSideChannelMap=sideChannelMap,getSideChannelWeakMap=sideChannelWeakmap,makeChannel=getSideChannelWeakMap||getSideChannelMap||getSideChannelList,sideChannel=function(){var _,T={assert:function(E){if(!T.has(E))throw new $TypeError("Side channel does not contain "+inspect(E))},delete:function(E){return!!_&&_.delete(E)},get:function(E){return _&&_.get(E)},has:function(E){return!!_&&_.has(E)},set:function(E,W){_||(_=makeChannel()),_.set(E,W)}};return T},replace$1=String.prototype.replace,percentTwenties=/%20/g,Format={RFC1738:"RFC1738",RFC3986:"RFC3986"},formats$4={default:Format.RFC3986,formatters:{RFC1738:function(B){return replace$1.call(B,percentTwenties,"+")},RFC3986:function(B){return String(B)}},RFC1738:Format.RFC1738,RFC3986:Format.RFC3986},formats$3=formats$4,has$2=Object.prototype.hasOwnProperty,isArray$2=Array.isArray,hexTable=function(){for(var B=[],_=0;_<256;++_)B.push("%"+((_<16?"0":"")+_.toString(16)).toUpperCase());return B}(),compactQueue=function(_){for(;_.length>1;){var T=_.pop(),E=T.obj[T.prop];if(isArray$2(E)){for(var W=[],X=0;X<E.length;++X)typeof E[X]<"u"&&W.push(E[X]);T.obj[T.prop]=W}}},arrayToObject=function(_,T){for(var E=T&&T.plainObjects?{__proto__:null}:{},W=0;W<_.length;++W)typeof _[W]<"u"&&(E[W]=_[W]);return E},merge=function B(_,T,E){if(!T)return _;if(typeof T!="object"&&typeof T!="function"){if(isArray$2(_))_.push(T);else if(_&&typeof _=="object")(E&&(E.plainObjects||E.allowPrototypes)||!has$2.call(Object.prototype,T))&&(_[T]=!0);else return[_,T];return _}if(!_||typeof _!="object")return[_].concat(T);var W=_;return isArray$2(_)&&!isArray$2(T)&&(W=arrayToObject(_,E)),isArray$2(_)&&isArray$2(T)?(T.forEach(function(X,q){if(has$2.call(_,q)){var Y=_[q];Y&&typeof Y=="object"&&X&&typeof X=="object"?_[q]=B(Y,X,E):_.push(X)}else _[q]=X}),_):Object.keys(T).reduce(function(X,q){var Y=T[q];return has$2.call(X,q)?X[q]=B(X[q],Y,E):X[q]=Y,X},W)},assign=function(_,T){return Object.keys(T).reduce(function(E,W){return E[W]=T[W],E},_)},decode=function(B,_,T){var E=B.replace(/\+/g," ");if(T==="iso-8859-1")return E.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(E)}catch{return E}},limit=1024,encode=function(_,T,E,W,X){if(_.length===0)return _;var q=_;if(typeof _=="symbol"?q=Symbol.prototype.toString.call(_):typeof _!="string"&&(q=String(_)),E==="iso-8859-1")return escape(q).replace(/%u[0-9a-f]{4}/gi,function(ge){return"%26%23"+parseInt(ge.slice(2),16)+"%3B"});for(var Y="",te=0;te<q.length;te+=limit){for(var ne=q.length>=limit?q.slice(te,te+limit):q,ae=[],le=0;le<ne.length;++le){var ue=ne.charCodeAt(le);if(ue===45||ue===46||ue===95||ue===126||ue>=48&&ue<=57||ue>=65&&ue<=90||ue>=97&&ue<=122||X===formats$3.RFC1738&&(ue===40||ue===41)){ae[ae.length]=ne.charAt(le);continue}if(ue<128){ae[ae.length]=hexTable[ue];continue}if(ue<2048){ae[ae.length]=hexTable[192|ue>>6]+hexTable[128|ue&63];continue}if(ue<55296||ue>=57344){ae[ae.length]=hexTable[224|ue>>12]+hexTable[128|ue>>6&63]+hexTable[128|ue&63];continue}le+=1,ue=65536+((ue&1023)<<10|ne.charCodeAt(le)&1023),ae[ae.length]=hexTable[240|ue>>18]+hexTable[128|ue>>12&63]+hexTable[128|ue>>6&63]+hexTable[128|ue&63]}Y+=ae.join("")}return Y},compact=function(_){for(var T=[{obj:{o:_},prop:"o"}],E=[],W=0;W<T.length;++W)for(var X=T[W],q=X.obj[X.prop],Y=Object.keys(q),te=0;te<Y.length;++te){var ne=Y[te],ae=q[ne];typeof ae=="object"&&ae!==null&&E.indexOf(ae)===-1&&(T.push({obj:q,prop:ne}),E.push(ae))}return compactQueue(T),_},isRegExp=function(_){return Object.prototype.toString.call(_)==="[object RegExp]"},isBuffer=function(_){return!_||typeof _!="object"?!1:!!(_.constructor&&_.constructor.isBuffer&&_.constructor.isBuffer(_))},combine=function(_,T){return[].concat(_,T)},maybeMap=function(_,T){if(isArray$2(_)){for(var E=[],W=0;W<_.length;W+=1)E.push(T(_[W]));return E}return T(_)},utils$3={arrayToObject,assign,combine,compact,decode,encode,isBuffer,isRegExp,maybeMap,merge},getSideChannel=sideChannel,utils$2=utils$3,formats$2=formats$4,has$1=Object.prototype.hasOwnProperty,arrayPrefixGenerators={brackets:function(_){return _+"[]"},comma:"comma",indices:function(_,T){return _+"["+T+"]"},repeat:function(_){return _}},isArray$1=Array.isArray,push=Array.prototype.push,pushToArray=function(B,_){push.apply(B,isArray$1(_)?_:[_])},toISO=Date.prototype.toISOString,defaultFormat=formats$2.default,defaults$3={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:utils$2.encode,encodeValuesOnly:!1,filter:void 0,format:defaultFormat,formatter:formats$2.formatters[defaultFormat],indices:!1,serializeDate:function(_){return toISO.call(_)},skipNulls:!1,strictNullHandling:!1},isNonNullishPrimitive=function(_){return typeof _=="string"||typeof _=="number"||typeof _=="boolean"||typeof _=="symbol"||typeof _=="bigint"},sentinel={},stringify$1=function B(_,T,E,W,X,q,Y,te,ne,ae,le,ue,ge,ye,xe,Te,Ae,Ie){for(var Ve=_,$e=Ie,We=0,Ue=!1;($e=$e.get(sentinel))!==void 0&&!Ue;){var je=$e.get(_);if(We+=1,typeof je<"u"){if(je===We)throw new RangeError("Cyclic object value");Ue=!0}typeof $e.get(sentinel)>"u"&&(We=0)}if(typeof ae=="function"?Ve=ae(T,Ve):Ve instanceof Date?Ve=ge(Ve):E==="comma"&&isArray$1(Ve)&&(Ve=utils$2.maybeMap(Ve,function(mt){return mt instanceof Date?ge(mt):mt})),Ve===null){if(q)return ne&&!Te?ne(T,defaults$3.encoder,Ae,"key",ye):T;Ve=""}if(isNonNullishPrimitive(Ve)||utils$2.isBuffer(Ve)){if(ne){var ze=Te?T:ne(T,defaults$3.encoder,Ae,"key",ye);return[xe(ze)+"="+xe(ne(Ve,defaults$3.encoder,Ae,"value",ye))]}return[xe(T)+"="+xe(String(Ve))]}var He=[];if(typeof Ve>"u")return He;var Le;if(E==="comma"&&isArray$1(Ve))Te&&ne&&(Ve=utils$2.maybeMap(Ve,ne)),Le=[{value:Ve.length>0?Ve.join(",")||null:void 0}];else if(isArray$1(ae))Le=ae;else{var qe=Object.keys(Ve);Le=le?qe.sort(le):qe}var Qe=te?String(T).replace(/\./g,"%2E"):String(T),Ke=W&&isArray$1(Ve)&&Ve.length===1?Qe+"[]":Qe;if(X&&isArray$1(Ve)&&Ve.length===0)return Ke+"[]";for(var Je=0;Je<Le.length;++Je){var pt=Le[Je],ut=typeof pt=="object"&&pt&&typeof pt.value<"u"?pt.value:Ve[pt];if(!(Y&&ut===null)){var lt=ue&&te?String(pt).replace(/\./g,"%2E"):String(pt),st=isArray$1(Ve)?typeof E=="function"?E(Ke,lt):Ke:Ke+(ue?"."+lt:"["+lt+"]");Ie.set(_,We);var sr=getSideChannel();sr.set(sentinel,Ie),pushToArray(He,B(ut,st,E,W,X,q,Y,te,E==="comma"&&Te&&isArray$1(Ve)?null:ne,ae,le,ue,ge,ye,xe,Te,Ae,sr))}}return He},normalizeStringifyOptions=function(_){if(!_)return defaults$3;if(typeof _.allowEmptyArrays<"u"&&typeof _.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof _.encodeDotInKeys<"u"&&typeof _.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(_.encoder!==null&&typeof _.encoder<"u"&&typeof _.encoder!="function")throw new TypeError("Encoder has to be a function.");var T=_.charset||defaults$3.charset;if(typeof _.charset<"u"&&_.charset!=="utf-8"&&_.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var E=formats$2.default;if(typeof _.format<"u"){if(!has$1.call(formats$2.formatters,_.format))throw new TypeError("Unknown format option provided.");E=_.format}var W=formats$2.formatters[E],X=defaults$3.filter;(typeof _.filter=="function"||isArray$1(_.filter))&&(X=_.filter);var q;if(_.arrayFormat in arrayPrefixGenerators?q=_.arrayFormat:"indices"in _?q=_.indices?"indices":"repeat":q=defaults$3.arrayFormat,"commaRoundTrip"in _&&typeof _.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var Y=typeof _.allowDots>"u"?_.encodeDotInKeys===!0?!0:defaults$3.allowDots:!!_.allowDots;return{addQueryPrefix:typeof _.addQueryPrefix=="boolean"?_.addQueryPrefix:defaults$3.addQueryPrefix,allowDots:Y,allowEmptyArrays:typeof _.allowEmptyArrays=="boolean"?!!_.allowEmptyArrays:defaults$3.allowEmptyArrays,arrayFormat:q,charset:T,charsetSentinel:typeof _.charsetSentinel=="boolean"?_.charsetSentinel:defaults$3.charsetSentinel,commaRoundTrip:!!_.commaRoundTrip,delimiter:typeof _.delimiter>"u"?defaults$3.delimiter:_.delimiter,encode:typeof _.encode=="boolean"?_.encode:defaults$3.encode,encodeDotInKeys:typeof _.encodeDotInKeys=="boolean"?_.encodeDotInKeys:defaults$3.encodeDotInKeys,encoder:typeof _.encoder=="function"?_.encoder:defaults$3.encoder,encodeValuesOnly:typeof _.encodeValuesOnly=="boolean"?_.encodeValuesOnly:defaults$3.encodeValuesOnly,filter:X,format:E,formatter:W,serializeDate:typeof _.serializeDate=="function"?_.serializeDate:defaults$3.serializeDate,skipNulls:typeof _.skipNulls=="boolean"?_.skipNulls:defaults$3.skipNulls,sort:typeof _.sort=="function"?_.sort:null,strictNullHandling:typeof _.strictNullHandling=="boolean"?_.strictNullHandling:defaults$3.strictNullHandling}},stringify_1=function(B,_){var T=B,E=normalizeStringifyOptions(_),W,X;typeof E.filter=="function"?(X=E.filter,T=X("",T)):isArray$1(E.filter)&&(X=E.filter,W=X);var q=[];if(typeof T!="object"||T===null)return"";var Y=arrayPrefixGenerators[E.arrayFormat],te=Y==="comma"&&E.commaRoundTrip;W||(W=Object.keys(T)),E.sort&&W.sort(E.sort);for(var ne=getSideChannel(),ae=0;ae<W.length;++ae){var le=W[ae],ue=T[le];E.skipNulls&&ue===null||pushToArray(q,stringify$1(ue,le,Y,te,E.allowEmptyArrays,E.strictNullHandling,E.skipNulls,E.encodeDotInKeys,E.encode?E.encoder:null,E.filter,E.sort,E.allowDots,E.serializeDate,E.format,E.formatter,E.encodeValuesOnly,E.charset,ne))}var ge=q.join(E.delimiter),ye=E.addQueryPrefix===!0?"?":"";return E.charsetSentinel&&(E.charset==="iso-8859-1"?ye+="utf8=%26%2310003%3B&":ye+="utf8=%E2%9C%93&"),ge.length>0?ye+ge:""},utils$1=utils$3,has=Object.prototype.hasOwnProperty,isArray=Array.isArray,defaults$2={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:utils$1.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},interpretNumericEntities=function(B){return B.replace(/&#(\d+);/g,function(_,T){return String.fromCharCode(parseInt(T,10))})},parseArrayValue=function(B,_,T){if(B&&typeof B=="string"&&_.comma&&B.indexOf(",")>-1)return B.split(",");if(_.throwOnLimitExceeded&&T>=_.arrayLimit)throw new RangeError("Array limit exceeded. Only "+_.arrayLimit+" element"+(_.arrayLimit===1?"":"s")+" allowed in an array.");return B},isoSentinel="utf8=%26%2310003%3B",charsetSentinel="utf8=%E2%9C%93",parseValues=function(_,T){var E={__proto__:null},W=T.ignoreQueryPrefix?_.replace(/^\?/,""):_;W=W.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var X=T.parameterLimit===1/0?void 0:T.parameterLimit,q=W.split(T.delimiter,T.throwOnLimitExceeded?X+1:X);if(T.throwOnLimitExceeded&&q.length>X)throw new RangeError("Parameter limit exceeded. Only "+X+" parameter"+(X===1?"":"s")+" allowed.");var Y=-1,te,ne=T.charset;if(T.charsetSentinel)for(te=0;te<q.length;++te)q[te].indexOf("utf8=")===0&&(q[te]===charsetSentinel?ne="utf-8":q[te]===isoSentinel&&(ne="iso-8859-1"),Y=te,te=q.length);for(te=0;te<q.length;++te)if(te!==Y){var ae=q[te],le=ae.indexOf("]="),ue=le===-1?ae.indexOf("="):le+1,ge,ye;ue===-1?(ge=T.decoder(ae,defaults$2.decoder,ne,"key"),ye=T.strictNullHandling?null:""):(ge=T.decoder(ae.slice(0,ue),defaults$2.decoder,ne,"key"),ye=utils$1.maybeMap(parseArrayValue(ae.slice(ue+1),T,isArray(E[ge])?E[ge].length:0),function(Te){return T.decoder(Te,defaults$2.decoder,ne,"value")})),ye&&T.interpretNumericEntities&&ne==="iso-8859-1"&&(ye=interpretNumericEntities(String(ye))),ae.indexOf("[]=")>-1&&(ye=isArray(ye)?[ye]:ye);var xe=has.call(E,ge);xe&&T.duplicates==="combine"?E[ge]=utils$1.combine(E[ge],ye):(!xe||T.duplicates==="last")&&(E[ge]=ye)}return E},parseObject$1=function(B,_,T,E){var W=0;if(B.length>0&&B[B.length-1]==="[]"){var X=B.slice(0,-1).join("");W=Array.isArray(_)&&_[X]?_[X].length:0}for(var q=E?_:parseArrayValue(_,T,W),Y=B.length-1;Y>=0;--Y){var te,ne=B[Y];if(ne==="[]"&&T.parseArrays)te=T.allowEmptyArrays&&(q===""||T.strictNullHandling&&q===null)?[]:utils$1.combine([],q);else{te=T.plainObjects?{__proto__:null}:{};var ae=ne.charAt(0)==="["&&ne.charAt(ne.length-1)==="]"?ne.slice(1,-1):ne,le=T.decodeDotInKeys?ae.replace(/%2E/g,"."):ae,ue=parseInt(le,10);!T.parseArrays&&le===""?te={0:q}:!isNaN(ue)&&ne!==le&&String(ue)===le&&ue>=0&&T.parseArrays&&ue<=T.arrayLimit?(te=[],te[ue]=q):le!=="__proto__"&&(te[le]=q)}q=te}return q},parseKeys=function(_,T,E,W){if(_){var X=E.allowDots?_.replace(/\.([^.[]+)/g,"[$1]"):_,q=/(\[[^[\]]*])/,Y=/(\[[^[\]]*])/g,te=E.depth>0&&q.exec(X),ne=te?X.slice(0,te.index):X,ae=[];if(ne){if(!E.plainObjects&&has.call(Object.prototype,ne)&&!E.allowPrototypes)return;ae.push(ne)}for(var le=0;E.depth>0&&(te=Y.exec(X))!==null&&le<E.depth;){if(le+=1,!E.plainObjects&&has.call(Object.prototype,te[1].slice(1,-1))&&!E.allowPrototypes)return;ae.push(te[1])}if(te){if(E.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+E.depth+" and strictDepth is true");ae.push("["+X.slice(te.index)+"]")}return parseObject$1(ae,T,E,W)}},normalizeParseOptions=function(_){if(!_)return defaults$2;if(typeof _.allowEmptyArrays<"u"&&typeof _.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof _.decodeDotInKeys<"u"&&typeof _.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(_.decoder!==null&&typeof _.decoder<"u"&&typeof _.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof _.charset<"u"&&_.charset!=="utf-8"&&_.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof _.throwOnLimitExceeded<"u"&&typeof _.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var T=typeof _.charset>"u"?defaults$2.charset:_.charset,E=typeof _.duplicates>"u"?defaults$2.duplicates:_.duplicates;if(E!=="combine"&&E!=="first"&&E!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var W=typeof _.allowDots>"u"?_.decodeDotInKeys===!0?!0:defaults$2.allowDots:!!_.allowDots;return{allowDots:W,allowEmptyArrays:typeof _.allowEmptyArrays=="boolean"?!!_.allowEmptyArrays:defaults$2.allowEmptyArrays,allowPrototypes:typeof _.allowPrototypes=="boolean"?_.allowPrototypes:defaults$2.allowPrototypes,allowSparse:typeof _.allowSparse=="boolean"?_.allowSparse:defaults$2.allowSparse,arrayLimit:typeof _.arrayLimit=="number"?_.arrayLimit:defaults$2.arrayLimit,charset:T,charsetSentinel:typeof _.charsetSentinel=="boolean"?_.charsetSentinel:defaults$2.charsetSentinel,comma:typeof _.comma=="boolean"?_.comma:defaults$2.comma,decodeDotInKeys:typeof _.decodeDotInKeys=="boolean"?_.decodeDotInKeys:defaults$2.decodeDotInKeys,decoder:typeof _.decoder=="function"?_.decoder:defaults$2.decoder,delimiter:typeof _.delimiter=="string"||utils$1.isRegExp(_.delimiter)?_.delimiter:defaults$2.delimiter,depth:typeof _.depth=="number"||_.depth===!1?+_.depth:defaults$2.depth,duplicates:E,ignoreQueryPrefix:_.ignoreQueryPrefix===!0,interpretNumericEntities:typeof _.interpretNumericEntities=="boolean"?_.interpretNumericEntities:defaults$2.interpretNumericEntities,parameterLimit:typeof _.parameterLimit=="number"?_.parameterLimit:defaults$2.parameterLimit,parseArrays:_.parseArrays!==!1,plainObjects:typeof _.plainObjects=="boolean"?_.plainObjects:defaults$2.plainObjects,strictDepth:typeof _.strictDepth=="boolean"?!!_.strictDepth:defaults$2.strictDepth,strictNullHandling:typeof _.strictNullHandling=="boolean"?_.strictNullHandling:defaults$2.strictNullHandling,throwOnLimitExceeded:typeof _.throwOnLimitExceeded=="boolean"?_.throwOnLimitExceeded:!1}},parse$1=function(B,_){var T=normalizeParseOptions(_);if(B===""||B===null||typeof B>"u")return T.plainObjects?{__proto__:null}:{};for(var E=typeof B=="string"?parseValues(B,T):B,W=T.plainObjects?{__proto__:null}:{},X=Object.keys(E),q=0;q<X.length;++q){var Y=X[q],te=parseKeys(Y,E[Y],T,typeof B=="string");W=utils$1.merge(W,te,T)}return T.allowSparse===!0?W:utils$1.compact(W)},stringify=stringify_1,parse=parse$1,formats$1=formats$4,lib={formats:formats$1,parse,stringify},punycode=punycodeExports;function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r",`
`,"	"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=lib;function urlParse(B,_,T){if(B&&typeof B=="object"&&B instanceof Url)return B;var E=new Url;return E.parse(B,_,T),E}Url.prototype.parse=function(B,_,T){if(typeof B!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof B);var E=B.indexOf("?"),W=E!==-1&&E<B.indexOf("#")?"?":"#",X=B.split(W),q=/\\/g;X[0]=X[0].replace(q,"/"),B=X.join(W);var Y=B;if(Y=Y.trim(),!T&&B.split("#").length===1){var te=simplePathPattern.exec(Y);if(te)return this.path=Y,this.href=Y,this.pathname=te[1],te[2]?(this.search=te[2],_?this.query=querystring.parse(this.search.substr(1)):this.query=this.search.substr(1)):_&&(this.search="",this.query={}),this}var ne=protocolPattern.exec(Y);if(ne){ne=ne[0];var ae=ne.toLowerCase();this.protocol=ae,Y=Y.substr(ne.length)}if(T||ne||Y.match(/^\/\/[^@/]+@[^@/]+/)){var le=Y.substr(0,2)==="//";le&&!(ne&&hostlessProtocol[ne])&&(Y=Y.substr(2),this.slashes=!0)}if(!hostlessProtocol[ne]&&(le||ne&&!slashedProtocol[ne])){for(var ue=-1,ge=0;ge<hostEndingChars.length;ge++){var ye=Y.indexOf(hostEndingChars[ge]);ye!==-1&&(ue===-1||ye<ue)&&(ue=ye)}var xe,Te;ue===-1?Te=Y.lastIndexOf("@"):Te=Y.lastIndexOf("@",ue),Te!==-1&&(xe=Y.slice(0,Te),Y=Y.slice(Te+1),this.auth=decodeURIComponent(xe)),ue=-1;for(var ge=0;ge<nonHostChars.length;ge++){var ye=Y.indexOf(nonHostChars[ge]);ye!==-1&&(ue===-1||ye<ue)&&(ue=ye)}ue===-1&&(ue=Y.length),this.host=Y.slice(0,ue),Y=Y.slice(ue),this.parseHost(),this.hostname=this.hostname||"";var Ae=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Ae)for(var Ie=this.hostname.split(/\./),ge=0,Ve=Ie.length;ge<Ve;ge++){var $e=Ie[ge];if($e&&!$e.match(hostnamePartPattern)){for(var We="",Ue=0,je=$e.length;Ue<je;Ue++)$e.charCodeAt(Ue)>127?We+="x":We+=$e[Ue];if(!We.match(hostnamePartPattern)){var ze=Ie.slice(0,ge),He=Ie.slice(ge+1),Le=$e.match(hostnamePartStart);Le&&(ze.push(Le[1]),He.unshift(Le[2])),He.length&&(Y="/"+He.join(".")+Y),this.hostname=ze.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),Ae||(this.hostname=punycode.toASCII(this.hostname));var qe=this.port?":"+this.port:"",Qe=this.hostname||"";this.host=Qe+qe,this.href+=this.host,Ae&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),Y[0]!=="/"&&(Y="/"+Y))}if(!unsafeProtocol[ae])for(var ge=0,Ve=autoEscape.length;ge<Ve;ge++){var Ke=autoEscape[ge];if(Y.indexOf(Ke)!==-1){var Je=encodeURIComponent(Ke);Je===Ke&&(Je=escape(Ke)),Y=Y.split(Ke).join(Je)}}var pt=Y.indexOf("#");pt!==-1&&(this.hash=Y.substr(pt),Y=Y.slice(0,pt));var ut=Y.indexOf("?");if(ut!==-1?(this.search=Y.substr(ut),this.query=Y.substr(ut+1),_&&(this.query=querystring.parse(this.query)),Y=Y.slice(0,ut)):_&&(this.search="",this.query={}),Y&&(this.pathname=Y),slashedProtocol[ae]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var qe=this.pathname||"",lt=this.search||"";this.path=qe+lt}return this.href=this.format(),this};Url.prototype.format=function(){var B=this.auth||"";B&&(B=encodeURIComponent(B),B=B.replace(/%3A/i,":"),B+="@");var _=this.protocol||"",T=this.pathname||"",E=this.hash||"",W=!1,X="";this.host?W=B+this.host:this.hostname&&(W=B+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(W+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(X=querystring.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var q=this.search||X&&"?"+X||"";return _&&_.substr(-1)!==":"&&(_+=":"),this.slashes||(!_||slashedProtocol[_])&&W!==!1?(W="//"+(W||""),T&&T.charAt(0)!=="/"&&(T="/"+T)):W||(W=""),E&&E.charAt(0)!=="#"&&(E="#"+E),q&&q.charAt(0)!=="?"&&(q="?"+q),T=T.replace(/[?#]/g,function(Y){return encodeURIComponent(Y)}),q=q.replace("#","%23"),_+W+T+q+E};Url.prototype.resolve=function(B){return this.resolveObject(urlParse(B,!1,!0)).format()};Url.prototype.resolveObject=function(B){if(typeof B=="string"){var _=new Url;_.parse(B,!1,!0),B=_}for(var T=new Url,E=Object.keys(this),W=0;W<E.length;W++){var X=E[W];T[X]=this[X]}if(T.hash=B.hash,B.href==="")return T.href=T.format(),T;if(B.slashes&&!B.protocol){for(var q=Object.keys(B),Y=0;Y<q.length;Y++){var te=q[Y];te!=="protocol"&&(T[te]=B[te])}return slashedProtocol[T.protocol]&&T.hostname&&!T.pathname&&(T.pathname="/",T.path=T.pathname),T.href=T.format(),T}if(B.protocol&&B.protocol!==T.protocol){if(!slashedProtocol[B.protocol]){for(var ne=Object.keys(B),ae=0;ae<ne.length;ae++){var le=ne[ae];T[le]=B[le]}return T.href=T.format(),T}if(T.protocol=B.protocol,!B.host&&!hostlessProtocol[B.protocol]){for(var Ve=(B.pathname||"").split("/");Ve.length&&!(B.host=Ve.shift()););B.host||(B.host=""),B.hostname||(B.hostname=""),Ve[0]!==""&&Ve.unshift(""),Ve.length<2&&Ve.unshift(""),T.pathname=Ve.join("/")}else T.pathname=B.pathname;if(T.search=B.search,T.query=B.query,T.host=B.host||"",T.auth=B.auth,T.hostname=B.hostname||B.host,T.port=B.port,T.pathname||T.search){var ue=T.pathname||"",ge=T.search||"";T.path=ue+ge}return T.slashes=T.slashes||B.slashes,T.href=T.format(),T}var ye=T.pathname&&T.pathname.charAt(0)==="/",xe=B.host||B.pathname&&B.pathname.charAt(0)==="/",Te=xe||ye||T.host&&B.pathname,Ae=Te,Ie=T.pathname&&T.pathname.split("/")||[],Ve=B.pathname&&B.pathname.split("/")||[],$e=T.protocol&&!slashedProtocol[T.protocol];if($e&&(T.hostname="",T.port=null,T.host&&(Ie[0]===""?Ie[0]=T.host:Ie.unshift(T.host)),T.host="",B.protocol&&(B.hostname=null,B.port=null,B.host&&(Ve[0]===""?Ve[0]=B.host:Ve.unshift(B.host)),B.host=null),Te=Te&&(Ve[0]===""||Ie[0]==="")),xe)T.host=B.host||B.host===""?B.host:T.host,T.hostname=B.hostname||B.hostname===""?B.hostname:T.hostname,T.search=B.search,T.query=B.query,Ie=Ve;else if(Ve.length)Ie||(Ie=[]),Ie.pop(),Ie=Ie.concat(Ve),T.search=B.search,T.query=B.query;else if(B.search!=null){if($e){T.host=Ie.shift(),T.hostname=T.host;var We=T.host&&T.host.indexOf("@")>0?T.host.split("@"):!1;We&&(T.auth=We.shift(),T.hostname=We.shift(),T.host=T.hostname)}return T.search=B.search,T.query=B.query,(T.pathname!==null||T.search!==null)&&(T.path=(T.pathname?T.pathname:"")+(T.search?T.search:"")),T.href=T.format(),T}if(!Ie.length)return T.pathname=null,T.search?T.path="/"+T.search:T.path=null,T.href=T.format(),T;for(var Ue=Ie.slice(-1)[0],je=(T.host||B.host||Ie.length>1)&&(Ue==="."||Ue==="..")||Ue==="",ze=0,He=Ie.length;He>=0;He--)Ue=Ie[He],Ue==="."?Ie.splice(He,1):Ue===".."?(Ie.splice(He,1),ze++):ze&&(Ie.splice(He,1),ze--);if(!Te&&!Ae)for(;ze--;ze)Ie.unshift("..");Te&&Ie[0]!==""&&(!Ie[0]||Ie[0].charAt(0)!=="/")&&Ie.unshift(""),je&&Ie.join("/").substr(-1)!=="/"&&Ie.push("");var Le=Ie[0]===""||Ie[0]&&Ie[0].charAt(0)==="/";if($e){T.hostname=Le?"":Ie.length?Ie.shift():"",T.host=T.hostname;var We=T.host&&T.host.indexOf("@")>0?T.host.split("@"):!1;We&&(T.auth=We.shift(),T.hostname=We.shift(),T.host=T.hostname)}return Te=Te||T.host&&Ie.length,Te&&!Le&&Ie.unshift(""),Ie.length>0?T.pathname=Ie.join("/"):(T.pathname=null,T.path=null),(T.pathname!==null||T.search!==null)&&(T.path=(T.pathname?T.pathname:"")+(T.search?T.search:"")),T.auth=B.auth||T.auth,T.slashes=T.slashes||B.slashes,T.href=T.format(),T};Url.prototype.parseHost=function(){var B=this.host,_=portPattern.exec(B);_&&(_=_[0],_!==":"&&(this.port=_.substr(1)),B=B.substr(0,B.length-_.length)),B&&(this.hostname=B)};const warnings={};function deprecation(B,_,T=3){if(warnings[_])return;let E=new Error().stack;typeof E>"u"?console.warn("PixiJS Deprecation Warning: ",`${_}
Deprecated since v${B}`):(E=E.split(`
`).splice(T).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${_}
Deprecated since v${B}`),console.warn(E),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${_}
Deprecated since v${B}`),console.warn(E))),warnings[_]=!0}function assertPath(B){if(typeof B!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(B)}`)}function removeUrlParams(B){return B.split("?")[0].split("#")[0]}function escapeRegExp(B){return B.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll$1(B,_,T){return B.replace(new RegExp(escapeRegExp(_),"g"),T)}function normalizeStringPosix(B,_){let T="",E=0,W=-1,X=0,q=-1;for(let Y=0;Y<=B.length;++Y){if(Y<B.length)q=B.charCodeAt(Y);else{if(q===47)break;q=47}if(q===47){if(!(W===Y-1||X===1))if(W!==Y-1&&X===2){if(T.length<2||E!==2||T.charCodeAt(T.length-1)!==46||T.charCodeAt(T.length-2)!==46){if(T.length>2){const te=T.lastIndexOf("/");if(te!==T.length-1){te===-1?(T="",E=0):(T=T.slice(0,te),E=T.length-1-T.lastIndexOf("/")),W=Y,X=0;continue}}else if(T.length===2||T.length===1){T="",E=0,W=Y,X=0;continue}}}else T.length>0?T+=`/${B.slice(W+1,Y)}`:T=B.slice(W+1,Y),E=Y-W-1;W=Y,X=0}else q===46&&X!==-1?++X:X=-1}return T}const path={toPosix(B){return replaceAll$1(B,"\\","/")},isUrl(B){return/^https?:/.test(this.toPosix(B))},isDataUrl(B){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(B)},isBlobUrl(B){return B.startsWith("blob:")},hasProtocol(B){return/^[^/:]+:/.test(this.toPosix(B))},getProtocol(B){assertPath(B),B=this.toPosix(B);const _=/^file:\/\/\//.exec(B);if(_)return _[0];const T=/^[^/:]+:\/{0,2}/.exec(B);return T?T[0]:""},toAbsolute(B,_,T){if(assertPath(B),this.isDataUrl(B)||this.isBlobUrl(B))return B;const E=removeUrlParams(this.toPosix(_??settings.ADAPTER.getBaseUrl())),W=removeUrlParams(this.toPosix(T??this.rootname(E)));return B=this.toPosix(B),B.startsWith("/")?path.join(W,B.slice(1)):this.isAbsolute(B)?B:this.join(E,B)},normalize(B){if(assertPath(B),B.length===0)return".";if(this.isDataUrl(B)||this.isBlobUrl(B))return B;B=this.toPosix(B);let _="";const T=B.startsWith("/");this.hasProtocol(B)&&(_=this.rootname(B),B=B.slice(_.length));const E=B.endsWith("/");return B=normalizeStringPosix(B),B.length>0&&E&&(B+="/"),T?`/${B}`:_+B},isAbsolute(B){return assertPath(B),B=this.toPosix(B),this.hasProtocol(B)?!0:B.startsWith("/")},join(...B){if(B.length===0)return".";let _;for(let T=0;T<B.length;++T){const E=B[T];if(assertPath(E),E.length>0)if(_===void 0)_=E;else{const W=B[T-1]??"";this.joinExtensions.includes(this.extname(W).toLowerCase())?_+=`/../${E}`:_+=`/${E}`}}return _===void 0?".":this.normalize(_)},dirname(B){if(assertPath(B),B.length===0)return".";B=this.toPosix(B);let _=B.charCodeAt(0);const T=_===47;let E=-1,W=!0;const X=this.getProtocol(B),q=B;B=B.slice(X.length);for(let Y=B.length-1;Y>=1;--Y)if(_=B.charCodeAt(Y),_===47){if(!W){E=Y;break}}else W=!1;return E===-1?T?"/":this.isUrl(q)?X+B:X:T&&E===1?"//":X+B.slice(0,E)},rootname(B){assertPath(B),B=this.toPosix(B);let _="";if(B.startsWith("/")?_="/":_=this.getProtocol(B),this.isUrl(B)){const T=B.indexOf("/",_.length);T!==-1?_=B.slice(0,T):_=B,_.endsWith("/")||(_+="/")}return _},basename(B,_){assertPath(B),_&&assertPath(_),B=removeUrlParams(this.toPosix(B));let T=0,E=-1,W=!0,X;if(_!==void 0&&_.length>0&&_.length<=B.length){if(_.length===B.length&&_===B)return"";let q=_.length-1,Y=-1;for(X=B.length-1;X>=0;--X){const te=B.charCodeAt(X);if(te===47){if(!W){T=X+1;break}}else Y===-1&&(W=!1,Y=X+1),q>=0&&(te===_.charCodeAt(q)?--q===-1&&(E=X):(q=-1,E=Y))}return T===E?E=Y:E===-1&&(E=B.length),B.slice(T,E)}for(X=B.length-1;X>=0;--X)if(B.charCodeAt(X)===47){if(!W){T=X+1;break}}else E===-1&&(W=!1,E=X+1);return E===-1?"":B.slice(T,E)},extname(B){assertPath(B),B=removeUrlParams(this.toPosix(B));let _=-1,T=0,E=-1,W=!0,X=0;for(let q=B.length-1;q>=0;--q){const Y=B.charCodeAt(q);if(Y===47){if(!W){T=q+1;break}continue}E===-1&&(W=!1,E=q+1),Y===46?_===-1?_=q:X!==1&&(X=1):_!==-1&&(X=-1)}return _===-1||E===-1||X===0||X===1&&_===E-1&&_===T+1?"":B.slice(_,E)},parse(B){assertPath(B);const _={root:"",dir:"",base:"",ext:"",name:""};if(B.length===0)return _;B=removeUrlParams(this.toPosix(B));let T=B.charCodeAt(0);const E=this.isAbsolute(B);let W;_.root=this.rootname(B),E||this.hasProtocol(B)?W=1:W=0;let X=-1,q=0,Y=-1,te=!0,ne=B.length-1,ae=0;for(;ne>=W;--ne){if(T=B.charCodeAt(ne),T===47){if(!te){q=ne+1;break}continue}Y===-1&&(te=!1,Y=ne+1),T===46?X===-1?X=ne:ae!==1&&(ae=1):X!==-1&&(ae=-1)}return X===-1||Y===-1||ae===0||ae===1&&X===Y-1&&X===q+1?Y!==-1&&(q===0&&E?_.base=_.name=B.slice(1,Y):_.base=_.name=B.slice(q,Y)):(q===0&&E?(_.name=B.slice(1,X),_.base=B.slice(1,Y)):(_.name=B.slice(q,X),_.base=B.slice(q,Y)),_.ext=B.slice(X,Y)),_.dir=this.dirname(B),_},sep:"/",delimiter:":",joinExtensions:[".html"]};let promise;async function detectVideoAlphaMode(){return promise??(promise=(async()=>{var X;const B=document.createElement("canvas").getContext("webgl");if(!B)return ALPHA_MODES.UNPACK;const _=await new Promise(q=>{const Y=document.createElement("video");Y.onloadeddata=()=>q(Y),Y.onerror=()=>q(null),Y.autoplay=!1,Y.crossOrigin="anonymous",Y.preload="auto",Y.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",Y.load()});if(!_)return ALPHA_MODES.UNPACK;const T=B.createTexture();B.bindTexture(B.TEXTURE_2D,T);const E=B.createFramebuffer();B.bindFramebuffer(B.FRAMEBUFFER,E),B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_2D,T,0),B.pixelStorei(B.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),B.pixelStorei(B.UNPACK_COLORSPACE_CONVERSION_WEBGL,B.NONE),B.texImage2D(B.TEXTURE_2D,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,_);const W=new Uint8Array(4);return B.readPixels(0,0,1,1,B.RGBA,B.UNSIGNED_BYTE,W),B.deleteFramebuffer(E),B.deleteTexture(T),(X=B.getExtension("WEBGL_lose_context"))==null||X.loseContext(),W[0]<=W[3]?ALPHA_MODES.PMA:ALPHA_MODES.UNPACK})()),promise}let supported;function isWebGLSupported(){return typeof supported>"u"&&(supported=function(){var _;const B={stencil:!0,failIfMajorPerformanceCaveat:settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!settings.ADAPTER.getWebGLRenderingContext())return!1;const T=settings.ADAPTER.createCanvas();let E=T.getContext("webgl",B)||T.getContext("experimental-webgl",B);const W=!!((_=E==null?void 0:E.getContextAttributes())!=null&&_.stencil);if(E){const X=E.getExtension("WEBGL_lose_context");X&&X.loseContext()}return E=null,W}catch{return!1}}()),supported}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t$2=function(B){return typeof B=="string"?B.length>0:typeof B=="number"},n$3=function(B,_,T){return _===void 0&&(_=0),T===void 0&&(T=Math.pow(10,_)),Math.round(T*B)/T+0},e$2=function(B,_,T){return _===void 0&&(_=0),T===void 0&&(T=1),B>T?T:B>_?B:_},u$1=function(B){return(B=isFinite(B)?B%360:0)>0?B:B+360},a$2=function(B){return{r:e$2(B.r,0,255),g:e$2(B.g,0,255),b:e$2(B.b,0,255),a:e$2(B.a)}},o=function(B){return{r:n$3(B.r),g:n$3(B.g),b:n$3(B.b),a:n$3(B.a,3)}},i$1=/^#([0-9a-f]{3,8})$/i,s$1=function(B){var _=B.toString(16);return _.length<2?"0"+_:_},h=function(B){var _=B.r,T=B.g,E=B.b,W=B.a,X=Math.max(_,T,E),q=X-Math.min(_,T,E),Y=q?X===_?(T-E)/q:X===T?2+(E-_)/q:4+(_-T)/q:0;return{h:60*(Y<0?Y+6:Y),s:X?q/X*100:0,v:X/255*100,a:W}},b$1=function(B){var _=B.h,T=B.s,E=B.v,W=B.a;_=_/360*6,T/=100,E/=100;var X=Math.floor(_),q=E*(1-T),Y=E*(1-(_-X)*T),te=E*(1-(1-_+X)*T),ne=X%6;return{r:255*[E,Y,q,q,te,E][ne],g:255*[te,E,E,Y,q,q][ne],b:255*[q,q,te,E,E,Y][ne],a:W}},g$1=function(B){return{h:u$1(B.h),s:e$2(B.s,0,100),l:e$2(B.l,0,100),a:e$2(B.a)}},d$1=function(B){return{h:n$3(B.h),s:n$3(B.s),l:n$3(B.l),a:n$3(B.a,3)}},f=function(B){return b$1((T=(_=B).s,{h:_.h,s:(T*=((E=_.l)<50?E:100-E)/100)>0?2*T/(E+T)*100:0,v:E+T,a:_.a}));var _,T,E},c$1=function(B){return{h:(_=h(B)).h,s:(W=(200-(T=_.s))*(E=_.v)/100)>0&&W<200?T*E/100/(W<=100?W:200-W)*100:0,l:W/2,a:_.a};var _,T,E,W},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y={string:[[function(B){var _=i$1.exec(B);return _?(B=_[1]).length<=4?{r:parseInt(B[0]+B[0],16),g:parseInt(B[1]+B[1],16),b:parseInt(B[2]+B[2],16),a:B.length===4?n$3(parseInt(B[3]+B[3],16)/255,2):1}:B.length===6||B.length===8?{r:parseInt(B.substr(0,2),16),g:parseInt(B.substr(2,2),16),b:parseInt(B.substr(4,2),16),a:B.length===8?n$3(parseInt(B.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(B){var _=v$1.exec(B)||m.exec(B);return _?_[2]!==_[4]||_[4]!==_[6]?null:a$2({r:Number(_[1])/(_[2]?100/255:1),g:Number(_[3])/(_[4]?100/255:1),b:Number(_[5])/(_[6]?100/255:1),a:_[7]===void 0?1:Number(_[7])/(_[8]?100:1)}):null},"rgb"],[function(B){var _=l.exec(B)||p.exec(B);if(!_)return null;var T,E,W=g$1({h:(T=_[1],E=_[2],E===void 0&&(E="deg"),Number(T)*(r[E]||1)),s:Number(_[3]),l:Number(_[4]),a:_[5]===void 0?1:Number(_[5])/(_[6]?100:1)});return f(W)},"hsl"]],object:[[function(B){var _=B.r,T=B.g,E=B.b,W=B.a,X=W===void 0?1:W;return t$2(_)&&t$2(T)&&t$2(E)?a$2({r:Number(_),g:Number(T),b:Number(E),a:Number(X)}):null},"rgb"],[function(B){var _=B.h,T=B.s,E=B.l,W=B.a,X=W===void 0?1:W;if(!t$2(_)||!t$2(T)||!t$2(E))return null;var q=g$1({h:Number(_),s:Number(T),l:Number(E),a:Number(X)});return f(q)},"hsl"],[function(B){var _=B.h,T=B.s,E=B.v,W=B.a,X=W===void 0?1:W;if(!t$2(_)||!t$2(T)||!t$2(E))return null;var q=function(Y){return{h:u$1(Y.h),s:e$2(Y.s,0,100),v:e$2(Y.v,0,100),a:e$2(Y.a)}}({h:Number(_),s:Number(T),v:Number(E),a:Number(X)});return b$1(q)},"hsv"]]},N=function(B,_){for(var T=0;T<_.length;T++){var E=_[T][0](B);if(E)return[E,_[T][1]]}return[null,void 0]},x$1=function(B){return typeof B=="string"?N(B.trim(),y.string):typeof B=="object"&&B!==null?N(B,y.object):[null,void 0]},M=function(B,_){var T=c$1(B);return{h:T.h,s:e$2(T.s+100*_,0,100),l:T.l,a:T.a}},H=function(B){return(299*B.r+587*B.g+114*B.b)/1e3/255},$$1=function(B,_){var T=c$1(B);return{h:T.h,s:T.s,l:e$2(T.l+100*_,0,100),a:T.a}},j$1=function(){function B(_){this.parsed=x$1(_)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return B.prototype.isValid=function(){return this.parsed!==null},B.prototype.brightness=function(){return n$3(H(this.rgba),2)},B.prototype.isDark=function(){return H(this.rgba)<.5},B.prototype.isLight=function(){return H(this.rgba)>=.5},B.prototype.toHex=function(){return _=o(this.rgba),T=_.r,E=_.g,W=_.b,q=(X=_.a)<1?s$1(n$3(255*X)):"","#"+s$1(T)+s$1(E)+s$1(W)+q;var _,T,E,W,X,q},B.prototype.toRgb=function(){return o(this.rgba)},B.prototype.toRgbString=function(){return _=o(this.rgba),T=_.r,E=_.g,W=_.b,(X=_.a)<1?"rgba("+T+", "+E+", "+W+", "+X+")":"rgb("+T+", "+E+", "+W+")";var _,T,E,W,X},B.prototype.toHsl=function(){return d$1(c$1(this.rgba))},B.prototype.toHslString=function(){return _=d$1(c$1(this.rgba)),T=_.h,E=_.s,W=_.l,(X=_.a)<1?"hsla("+T+", "+E+"%, "+W+"%, "+X+")":"hsl("+T+", "+E+"%, "+W+"%)";var _,T,E,W,X},B.prototype.toHsv=function(){return _=h(this.rgba),{h:n$3(_.h),s:n$3(_.s),v:n$3(_.v),a:n$3(_.a,3)};var _},B.prototype.invert=function(){return w({r:255-(_=this.rgba).r,g:255-_.g,b:255-_.b,a:_.a});var _},B.prototype.saturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,_))},B.prototype.desaturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,-_))},B.prototype.grayscale=function(){return w(M(this.rgba,-1))},B.prototype.lighten=function(_){return _===void 0&&(_=.1),w($$1(this.rgba,_))},B.prototype.darken=function(_){return _===void 0&&(_=.1),w($$1(this.rgba,-_))},B.prototype.rotate=function(_){return _===void 0&&(_=15),this.hue(this.hue()+_)},B.prototype.alpha=function(_){return typeof _=="number"?w({r:(T=this.rgba).r,g:T.g,b:T.b,a:_}):n$3(this.rgba.a,3);var T},B.prototype.hue=function(_){var T=c$1(this.rgba);return typeof _=="number"?w({h:_,s:T.s,l:T.l,a:T.a}):n$3(T.h)},B.prototype.isEqual=function(_){return this.toHex()===w(_).toHex()},B}(),w=function(B){return B instanceof j$1?B:new j$1(B)},S=[],k=function(B){B.forEach(function(_){S.indexOf(_)<0&&(_(j$1,y),S.push(_))})};function namesPlugin(B,_){var T={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},E={};for(var W in T)E[T[W]]=W;var X={};B.prototype.toName=function(q){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var Y,te,ne=E[this.toHex()];if(ne)return ne;if(q!=null&&q.closest){var ae=this.toRgb(),le=1/0,ue="black";if(!X.length)for(var ge in T)X[ge]=new B(T[ge]).toRgb();for(var ye in T){var xe=(Y=ae,te=X[ye],Math.pow(Y.r-te.r,2)+Math.pow(Y.g-te.g,2)+Math.pow(Y.b-te.b,2));xe<le&&(le=xe,ue=ye)}return ue}},_.string.push([function(q){var Y=q.toLowerCase(),te=Y==="transparent"?"#0000":T[Y];return te?new B(te).toRgb():null},"name"])}k([namesPlugin]);const _Color=class fu{constructor(_=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=_}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(_){return this.value=_,this}set value(_){if(_ instanceof fu)this._value=this.cloneSource(_._value),this._int=_._int,this._components.set(_._components);else{if(_===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,_))&&(this.normalize(_),this._value=this.cloneSource(_))}}get value(){return this._value}cloneSource(_){return typeof _=="string"||typeof _=="number"||_ instanceof Number||_===null?_:Array.isArray(_)||ArrayBuffer.isView(_)?_.slice(0):typeof _=="object"&&_!==null?{..._}:_}isSourceEqual(_,T){const E=typeof _;if(E!==typeof T)return!1;if(E==="number"||E==="string"||_ instanceof Number)return _===T;if(Array.isArray(_)&&Array.isArray(T)||ArrayBuffer.isView(_)&&ArrayBuffer.isView(T))return _.length!==T.length?!1:_.every((W,X)=>W===T[X]);if(_!==null&&T!==null){const W=Object.keys(_),X=Object.keys(T);return W.length!==X.length?!1:W.every(q=>_[q]===T[q])}return _===T}toRgba(){const[_,T,E,W]=this._components;return{r:_,g:T,b:E,a:W}}toRgb(){const[_,T,E]=this._components;return{r:_,g:T,b:E}}toRgbaString(){const[_,T,E]=this.toUint8RgbArray();return`rgba(${_},${T},${E},${this.alpha})`}toUint8RgbArray(_){const[T,E,W]=this._components;return _=_??[],_[0]=Math.round(T*255),_[1]=Math.round(E*255),_[2]=Math.round(W*255),_}toRgbArray(_){_=_??[];const[T,E,W]=this._components;return _[0]=T,_[1]=E,_[2]=W,_}toNumber(){return this._int}toLittleEndianNumber(){const _=this._int;return(_>>16)+(_&65280)+((_&255)<<16)}multiply(_){const[T,E,W,X]=fu.temp.setValue(_)._components;return this._components[0]*=T,this._components[1]*=E,this._components[2]*=W,this._components[3]*=X,this.refreshInt(),this._value=null,this}premultiply(_,T=!0){return T&&(this._components[0]*=_,this._components[1]*=_,this._components[2]*=_),this._components[3]=_,this.refreshInt(),this._value=null,this}toPremultiplied(_,T=!0){if(_===1)return(255<<24)+this._int;if(_===0)return T?0:this._int;let E=this._int>>16&255,W=this._int>>8&255,X=this._int&255;return T&&(E=E*_+.5|0,W=W*_+.5|0,X=X*_+.5|0),(_*255<<24)+(E<<16)+(W<<8)+X}toHex(){const _=this._int.toString(16);return`#${"000000".substring(0,6-_.length)+_}`}toHexa(){const _=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-_.length)+_}setAlpha(_){return this._components[3]=this._clamp(_),this}round(_){const[T,E,W]=this._components;return this._components[0]=Math.round(T*_)/_,this._components[1]=Math.round(E*_)/_,this._components[2]=Math.round(W*_)/_,this.refreshInt(),this._value=null,this}toArray(_){_=_??[];const[T,E,W,X]=this._components;return _[0]=T,_[1]=E,_[2]=W,_[3]=X,_}normalize(_){let T,E,W,X;if((typeof _=="number"||_ instanceof Number)&&_>=0&&_<=16777215){const q=_;T=(q>>16&255)/255,E=(q>>8&255)/255,W=(q&255)/255,X=1}else if((Array.isArray(_)||_ instanceof Float32Array)&&_.length>=3&&_.length<=4)_=this._clamp(_),[T,E,W,X=1]=_;else if((_ instanceof Uint8Array||_ instanceof Uint8ClampedArray)&&_.length>=3&&_.length<=4)_=this._clamp(_,0,255),[T,E,W,X=255]=_,T/=255,E/=255,W/=255,X/=255;else if(typeof _=="string"||typeof _=="object"){if(typeof _=="string"){const Y=fu.HEX_PATTERN.exec(_);Y&&(_=`#${Y[2]}`)}const q=w(_);q.isValid()&&({r:T,g:E,b:W,a:X}=q.rgba,T/=255,E/=255,W/=255)}if(T!==void 0)this._components[0]=T,this._components[1]=E,this._components[2]=W,this._components[3]=X,this.refreshInt();else throw new Error(`Unable to convert color ${_}`)}refreshInt(){this._clamp(this._components);const[_,T,E]=this._components;this._int=(_*255<<16)+(T*255<<8)+(E*255|0)}_clamp(_,T=0,E=1){return typeof _=="number"?Math.min(Math.max(_,T),E):(_.forEach((W,X)=>{_[X]=Math.min(Math.max(W,T),E)}),_)}};_Color.shared=new _Color,_Color.temp=new _Color,_Color.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Color$1=_Color;function hex2string(B){return deprecation("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Color$1.shared.setValue(B).toHex()}function rgb2hex(B){return deprecation("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Color$1.shared.setValue(B).toNumber()}function mapPremultipliedBlendModes(){const B=[],_=[];for(let E=0;E<32;E++)B[E]=E,_[E]=E;B[BLEND_MODES.NORMAL_NPM]=BLEND_MODES.NORMAL,B[BLEND_MODES.ADD_NPM]=BLEND_MODES.ADD,B[BLEND_MODES.SCREEN_NPM]=BLEND_MODES.SCREEN,_[BLEND_MODES.NORMAL]=BLEND_MODES.NORMAL_NPM,_[BLEND_MODES.ADD]=BLEND_MODES.ADD_NPM,_[BLEND_MODES.SCREEN]=BLEND_MODES.SCREEN_NPM;const T=[];return T.push(_),T.push(B),T}const premultiplyBlendMode=mapPremultipliedBlendModes();function correctBlendMode(B,_){return premultiplyBlendMode[_?1:0][B]}function createIndicesForQuads(B,_=null){const T=B*6;if(_=_||new Uint16Array(T),_.length!==T)throw new Error(`Out buffer length is incorrect, got ${_.length} and expected ${T}`);for(let E=0,W=0;E<T;E+=6,W+=4)_[E+0]=W+0,_[E+1]=W+1,_[E+2]=W+2,_[E+3]=W+0,_[E+4]=W+2,_[E+5]=W+3;return _}function getBufferType(B){if(B.BYTES_PER_ELEMENT===4)return B instanceof Float32Array?"Float32Array":B instanceof Uint32Array?"Uint32Array":"Int32Array";if(B.BYTES_PER_ELEMENT===2){if(B instanceof Uint16Array)return"Uint16Array"}else if(B.BYTES_PER_ELEMENT===1&&B instanceof Uint8Array)return"Uint8Array";return null}function nextPow2(B){return B+=B===0?1:0,--B,B|=B>>>1,B|=B>>>2,B|=B>>>4,B|=B>>>8,B|=B>>>16,B+1}function isPow2(B){return!(B&B-1)&&!!B}function log2(B){let _=(B>65535?1:0)<<4;B>>>=_;let T=(B>255?1:0)<<3;return B>>>=T,_|=T,T=(B>15?1:0)<<2,B>>>=T,_|=T,T=(B>3?1:0)<<1,B>>>=T,_|=T,_|B>>1}function removeItems(B,_,T){const E=B.length;let W;if(_>=E||T===0)return;T=_+T>E?E-_:T;const X=E-T;for(W=_;W<X;++W)B[W]=B[W+T];B.length=X}function sign$1(B){return B===0?0:B<0?-1:1}let nextUid=0;function uid(){return++nextUid}const _BoundingBox=class{constructor(B,_,T,E){this.left=B,this.top=_,this.right=T,this.bottom=E}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};_BoundingBox.EMPTY=new _BoundingBox(0,0,0,0);let BoundingBox=_BoundingBox;const ProgramCache={},TextureCache=Object.create(null),BaseTextureCache=Object.create(null);class CanvasRenderTarget{constructor(_,T,E){this._canvas=settings.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=E||settings.RESOLUTION,this.resize(_,T)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(_,T){this._checkDestroyed(),this._canvas.width=Math.round(_*this.resolution),this._canvas.height=Math.round(T*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(_){this._checkDestroyed(),this._canvas.width=Math.round(_)}get height(){return this._checkDestroyed(),this._canvas.height}set height(_){this._checkDestroyed(),this._canvas.height=Math.round(_)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function checkRow(B,_,T){for(let E=0,W=4*T*_;E<_;++E,W+=4)if(B[W+3]!==0)return!1;return!0}function checkColumn(B,_,T,E,W){const X=4*_;for(let q=E,Y=E*X+4*T;q<=W;++q,Y+=X)if(B[Y+3]!==0)return!1;return!0}function getCanvasBoundingBox(B){const{width:_,height:T}=B,E=B.getContext("2d",{willReadFrequently:!0});if(E===null)throw new TypeError("Failed to get canvas 2D context");const W=E.getImageData(0,0,_,T).data;let X=0,q=0,Y=_-1,te=T-1;for(;q<T&&checkRow(W,_,q);)++q;if(q===T)return BoundingBox.EMPTY;for(;checkRow(W,_,te);)--te;for(;checkColumn(W,_,X,q,te);)++X;for(;checkColumn(W,_,Y,q,te);)--Y;return++Y,++te,new BoundingBox(X,q,Y,te)}function trimCanvas(B){const _=getCanvasBoundingBox(B),{width:T,height:E}=_;let W=null;if(!_.isEmpty()){const X=B.getContext("2d");if(X===null)throw new TypeError("Failed to get canvas 2D context");W=X.getImageData(_.left,_.top,T,E)}return{width:T,height:E,data:W}}function determineCrossOrigin(B,_=globalThis.location){if(B.startsWith("data:"))return"";_=_||globalThis.location;const T=new URL(B,document.baseURI);return T.hostname!==_.hostname||T.port!==_.port||T.protocol!==_.protocol?"anonymous":""}function getResolutionOfUrl(B,_=1){var E;const T=(E=settings.RETINA_PREFIX)==null?void 0:E.exec(B);return T?parseFloat(T[1]):_}var ExtensionType=(B=>(B.Renderer="renderer",B.Application="application",B.RendererSystem="renderer-webgl-system",B.RendererPlugin="renderer-webgl-plugin",B.CanvasRendererSystem="renderer-canvas-system",B.CanvasRendererPlugin="renderer-canvas-plugin",B.Asset="asset",B.LoadParser="load-parser",B.ResolveParser="resolve-parser",B.CacheParser="cache-parser",B.DetectionParser="detection-parser",B))(ExtensionType||{});const normalizeExtension=B=>{if(typeof B=="function"||typeof B=="object"&&B.extension){if(!B.extension)throw new Error("Extension class must have an extension object");B={...typeof B.extension!="object"?{type:B.extension}:B.extension,ref:B}}if(typeof B=="object")B={...B};else throw new Error("Invalid extension type");return typeof B.type=="string"&&(B.type=[B.type]),B},normalizePriority=(B,_)=>normalizeExtension(B).priority??_,extensions$1={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...B){return B.map(normalizeExtension).forEach(_=>{_.type.forEach(T=>{var E,W;return(W=(E=this._removeHandlers)[T])==null?void 0:W.call(E,_)})}),this},add(...B){return B.map(normalizeExtension).forEach(_=>{_.type.forEach(T=>{var X,q;const E=this._addHandlers,W=this._queue;E[T]?(X=E[T])==null||X.call(E,_):(W[T]=W[T]||[],(q=W[T])==null||q.push(_))})}),this},handle(B,_,T){var q;const E=this._addHandlers,W=this._removeHandlers;if(E[B]||W[B])throw new Error(`Extension type ${B} already has a handler`);E[B]=_,W[B]=T;const X=this._queue;return X[B]&&((q=X[B])==null||q.forEach(Y=>_(Y)),delete X[B]),this},handleByMap(B,_){return this.handle(B,T=>{T.name&&(_[T.name]=T.ref)},T=>{T.name&&delete _[T.name]})},handleByList(B,_,T=-1){return this.handle(B,E=>{_.includes(E.ref)||(_.push(E.ref),_.sort((W,X)=>normalizePriority(X,T)-normalizePriority(W,T)))},E=>{const W=_.indexOf(E.ref);W!==-1&&_.splice(W,1)})}};class ViewableBuffer{constructor(_){typeof _=="number"?this.rawBinaryData=new ArrayBuffer(_):_ instanceof Uint8Array?this.rawBinaryData=_.buffer:this.rawBinaryData=_,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(_){return this[`${_}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(_){switch(_){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${_} isn't a valid view type`)}}}const fragTemplate$1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(B){let _="";for(let T=0;T<B;++T)T>0&&(_+=`
else `),T<B-1&&(_+=`if(test == ${T}.0){}`);return _}function checkMaxIfStatementsInShader(B,_){if(B===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const T=_.createShader(_.FRAGMENT_SHADER);for(;;){const E=fragTemplate$1.replace(/%forloop%/gi,generateIfTestSrc(B));if(_.shaderSource(T,E),_.compileShader(T),!_.getShaderParameter(T,_.COMPILE_STATUS))B=B/2|0;else break}return B}const BLEND$1=0,OFFSET$1=1,CULLING$1=2,DEPTH_TEST$1=3,WINDING$1=4,DEPTH_MASK$1=5;class State{constructor(){this.data=0,this.blendMode=BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<BLEND$1)}set blend(_){!!(this.data&1<<BLEND$1)!==_&&(this.data^=1<<BLEND$1)}get offsets(){return!!(this.data&1<<OFFSET$1)}set offsets(_){!!(this.data&1<<OFFSET$1)!==_&&(this.data^=1<<OFFSET$1)}get culling(){return!!(this.data&1<<CULLING$1)}set culling(_){!!(this.data&1<<CULLING$1)!==_&&(this.data^=1<<CULLING$1)}get depthTest(){return!!(this.data&1<<DEPTH_TEST$1)}set depthTest(_){!!(this.data&1<<DEPTH_TEST$1)!==_&&(this.data^=1<<DEPTH_TEST$1)}get depthMask(){return!!(this.data&1<<DEPTH_MASK$1)}set depthMask(_){!!(this.data&1<<DEPTH_MASK$1)!==_&&(this.data^=1<<DEPTH_MASK$1)}get clockwiseFrontFace(){return!!(this.data&1<<WINDING$1)}set clockwiseFrontFace(_){!!(this.data&1<<WINDING$1)!==_&&(this.data^=1<<WINDING$1)}get blendMode(){return this._blendMode}set blendMode(_){this.blend=_!==BLEND_MODES.NONE,this._blendMode=_}get polygonOffset(){return this._polygonOffset}set polygonOffset(_){this.offsets=!!_,this._polygonOffset=_}static for2d(){const _=new State;return _.depthTest=!1,_.blend=!0,_}}State.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const INSTALLED=[];function autoDetectResource(B,_){if(!B)return null;let T="";if(typeof B=="string"){const E=/\.(\w{3,4})(?:$|\?|#)/i.exec(B);E&&(T=E[1].toLowerCase())}for(let E=INSTALLED.length-1;E>=0;--E){const W=INSTALLED[E];if(W.test&&W.test(B,T))return new W(B,_)}throw new Error("Unrecognized source type to auto-detect Resource")}class Runner{constructor(_){this.items=[],this._name=_,this._aliasCount=0}emit(_,T,E,W,X,q,Y,te){if(arguments.length>8)throw new Error("max arguments reached");const{name:ne,items:ae}=this;this._aliasCount++;for(let le=0,ue=ae.length;le<ue;le++)ae[le][ne](_,T,E,W,X,q,Y,te);return ae===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(_){return _[this._name]&&(this.ensureNonAliasedItems(),this.remove(_),this.items.push(_)),this}remove(_){const T=this.items.indexOf(_);return T!==-1&&(this.ensureNonAliasedItems(),this.items.splice(T,1)),this}contains(_){return this.items.includes(_)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Runner.prototype,{dispatch:{value:Runner.prototype.emit},run:{value:Runner.prototype.emit}});class Resource{constructor(_=0,T=0){this._width=_,this._height=T,this.destroyed=!1,this.internal=!1,this.onResize=new Runner("setRealSize"),this.onUpdate=new Runner("update"),this.onError=new Runner("onError")}bind(_){this.onResize.add(_),this.onUpdate.add(_),this.onError.add(_),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(_){this.onResize.remove(_),this.onUpdate.remove(_),this.onError.remove(_)}resize(_,T){(_!==this._width||T!==this._height)&&(this._width=_,this._height=T,this.onResize.emit(_,T))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(_,T,E){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(_,T){return!1}}class BufferResource extends Resource{constructor(_,T){const{width:E,height:W}=T||{};if(!E||!W)throw new Error("BufferResource width or height invalid");super(E,W),this.data=_,this.unpackAlignment=T.unpackAlignment??4}upload(_,T,E){const W=_.gl;W.pixelStorei(W.UNPACK_ALIGNMENT,this.unpackAlignment),W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T.alphaMode===ALPHA_MODES.UNPACK);const X=T.realWidth,q=T.realHeight;return E.width===X&&E.height===q?W.texSubImage2D(T.target,0,0,0,X,q,T.format,E.type,this.data):(E.width=X,E.height=q,W.texImage2D(T.target,0,E.internalFormat,X,q,0,T.format,E.type,this.data)),!0}dispose(){this.data=null}static test(_){return _===null||_ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array}}const defaultBufferOptions={scaleMode:SCALE_MODES.NEAREST,alphaMode:ALPHA_MODES.NPM},_BaseTexture=class Qa extends EventEmitter{constructor(_=null,T=null){super(),T=Object.assign({},Qa.defaultOptions,T);const{alphaMode:E,mipmap:W,anisotropicLevel:X,scaleMode:q,width:Y,height:te,wrapMode:ne,format:ae,type:le,target:ue,resolution:ge,resourceOptions:ye}=T;_&&!(_ instanceof Resource)&&(_=autoDetectResource(_,ye),_.internal=!0),this.resolution=ge||settings.RESOLUTION,this.width=Math.round((Y||0)*this.resolution)/this.resolution,this.height=Math.round((te||0)*this.resolution)/this.resolution,this._mipmap=W,this.anisotropicLevel=X,this._wrapMode=ne,this._scaleMode=q,this.format=ae,this.type=le,this.target=ue,this.alphaMode=E,this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=Y>0&&te>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(_)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(_){this._mipmap!==_&&(this._mipmap=_,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(_){this._scaleMode!==_&&(this._scaleMode=_,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(_){this._wrapMode!==_&&(this._wrapMode=_,this.dirtyStyleId++)}setStyle(_,T){let E;return _!==void 0&&_!==this.scaleMode&&(this.scaleMode=_,E=!0),T!==void 0&&T!==this.mipmap&&(this.mipmap=T,E=!0),E&&this.dirtyStyleId++,this}setSize(_,T,E){return E=E||this.resolution,this.setRealSize(_*E,T*E,E)}setRealSize(_,T,E){return this.resolution=E||this.resolution,this.width=Math.round(_)/this.resolution,this.height=Math.round(T)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)}setResolution(_){const T=this.resolution;return T===_?this:(this.resolution=_,this.valid&&(this.width=Math.round(this.width*T)/_,this.height=Math.round(this.height*T)/_,this.emit("update",this)),this._refreshPOT(),this)}setResource(_){if(this.resource===_)return this;if(this.resource)throw new Error("Resource can be set only once");return _.bind(this),this.resource=_,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(_){this.emit("error",this,_)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache[this.cacheId],delete TextureCache[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Qa.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(_,T,E=settings.STRICT_TEXTURE_CACHE){const W=typeof _=="string";let X=null;if(W)X=_;else{if(!_._pixiId){const Y=(T==null?void 0:T.pixiIdPrefix)||"pixiid";_._pixiId=`${Y}_${uid()}`}X=_._pixiId}let q=BaseTextureCache[X];if(W&&E&&!q)throw new Error(`The cacheId "${X}" does not exist in BaseTextureCache.`);return q||(q=new Qa(_,T),q.cacheId=X,Qa.addToCache(q,X)),q}static fromBuffer(_,T,E,W){_=_||new Float32Array(T*E*4);const X=new BufferResource(_,{width:T,height:E,...W==null?void 0:W.resourceOptions});let q,Y;return _ instanceof Float32Array?(q=FORMATS.RGBA,Y=TYPES.FLOAT):_ instanceof Int32Array?(q=FORMATS.RGBA_INTEGER,Y=TYPES.INT):_ instanceof Uint32Array?(q=FORMATS.RGBA_INTEGER,Y=TYPES.UNSIGNED_INT):_ instanceof Int16Array?(q=FORMATS.RGBA_INTEGER,Y=TYPES.SHORT):_ instanceof Uint16Array?(q=FORMATS.RGBA_INTEGER,Y=TYPES.UNSIGNED_SHORT):_ instanceof Int8Array?(q=FORMATS.RGBA,Y=TYPES.BYTE):(q=FORMATS.RGBA,Y=TYPES.UNSIGNED_BYTE),X.internal=!0,new Qa(X,Object.assign({},defaultBufferOptions,{type:Y,format:q},W))}static addToCache(_,T){T&&(_.textureCacheIds.includes(T)||_.textureCacheIds.push(T),BaseTextureCache[T]&&BaseTextureCache[T]!==_&&console.warn(`BaseTexture added to the cache with an id [${T}] that already had an entry`),BaseTextureCache[T]=_)}static removeFromCache(_){if(typeof _=="string"){const T=BaseTextureCache[_];if(T){const E=T.textureCacheIds.indexOf(_);return E>-1&&T.textureCacheIds.splice(E,1),delete BaseTextureCache[_],T}}else if(_!=null&&_.textureCacheIds){for(let T=0;T<_.textureCacheIds.length;++T)delete BaseTextureCache[_.textureCacheIds[T]];return _.textureCacheIds.length=0,_}return null}};_BaseTexture.defaultOptions={mipmap:MIPMAP_MODES.POW2,anisotropicLevel:0,scaleMode:SCALE_MODES.LINEAR,wrapMode:WRAP_MODES.CLAMP,alphaMode:ALPHA_MODES.UNPACK,target:TARGETS.TEXTURE_2D,format:FORMATS.RGBA,type:TYPES.UNSIGNED_BYTE},_BaseTexture._globalBatch=0;let BaseTexture=_BaseTexture;class BatchDrawCall{constructor(){this.texArray=null,this.blend=0,this.type=DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}}let UID$4=0,Buffer$1=class lg{constructor(_,T=!0,E=!1){this.data=_||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=E,this.static=T,this.id=UID$4++,this.disposeRunner=new Runner("disposeBuffer")}update(_){_ instanceof Array&&(_=new Float32Array(_)),this.data=_||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(_){this.type=_?BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:BUFFER_TYPE.ARRAY_BUFFER}get index(){return this.type===BUFFER_TYPE.ELEMENT_ARRAY_BUFFER}static from(_){return _ instanceof Array&&(_=new Float32Array(_)),new lg(_)}};class Attribute{constructor(_,T=0,E=!1,W=TYPES.FLOAT,X,q,Y,te=1){this.buffer=_,this.size=T,this.normalized=E,this.type=W,this.stride=X,this.start=q,this.instance=Y,this.divisor=te}destroy(){this.buffer=null}static from(_,T,E,W,X){return new Attribute(_,T,E,W,X)}}const map$1={Float32Array,Uint32Array,Int32Array,Uint8Array};function interleaveTypedArrays(B,_){let T=0,E=0;const W={};for(let te=0;te<B.length;te++)E+=_[te],T+=B[te].length;const X=new ArrayBuffer(T*4);let q=null,Y=0;for(let te=0;te<B.length;te++){const ne=_[te],ae=B[te],le=getBufferType(ae);W[le]||(W[le]=new map$1[le](X)),q=W[le];for(let ue=0;ue<ae.length;ue++){const ge=(ue/ne|0)*E+Y,ye=ue%ne;q[ge+ye]=ae[ue]}Y+=ne}return new Float32Array(X)}const byteSizeMap$1={5126:4,5123:2,5121:1};let UID$3=0;const map={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Geometry{constructor(_=[],T={}){this.buffers=_,this.indexBuffer=null,this.attributes=T,this.glVertexArrayObjects={},this.id=UID$3++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner("disposeGeometry"),this.refCount=0}addAttribute(_,T,E=0,W=!1,X,q,Y,te=!1){if(!T)throw new Error("You must pass a buffer when creating an attribute");T instanceof Buffer$1||(T instanceof Array&&(T=new Float32Array(T)),T=new Buffer$1(T));const ne=_.split("|");if(ne.length>1){for(let le=0;le<ne.length;le++)this.addAttribute(ne[le],T,E,W,X);return this}let ae=this.buffers.indexOf(T);return ae===-1&&(this.buffers.push(T),ae=this.buffers.length-1),this.attributes[_]=new Attribute(ae,E,W,X,q,Y,te),this.instanced=this.instanced||te,this}getAttribute(_){return this.attributes[_]}getBuffer(_){return this.buffers[this.getAttribute(_).buffer]}addIndex(_){return _ instanceof Buffer$1||(_ instanceof Array&&(_=new Uint16Array(_)),_=new Buffer$1(_)),_.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=_,this.buffers.includes(_)||this.buffers.push(_),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const _=[],T=[],E=new Buffer$1;let W;for(W in this.attributes){const X=this.attributes[W],q=this.buffers[X.buffer];_.push(q.data),T.push(X.size*byteSizeMap$1[X.type]/4),X.buffer=0}for(E.data=interleaveTypedArrays(_,T),W=0;W<this.buffers.length;W++)this.buffers[W]!==this.indexBuffer&&this.buffers[W].destroy();return this.buffers=[E],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const _ in this.attributes){const T=this.attributes[_];return this.buffers[T.buffer].data.length/(T.stride/4||T.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const _=new Geometry;for(let T=0;T<this.buffers.length;T++)_.buffers[T]=new Buffer$1(this.buffers[T].data.slice(0));for(const T in this.attributes){const E=this.attributes[T];_.attributes[T]=new Attribute(E.buffer,E.size,E.normalized,E.type,E.stride,E.start,E.instance)}return this.indexBuffer&&(_.indexBuffer=_.buffers[this.buffers.indexOf(this.indexBuffer)],_.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),_}static merge(_){const T=new Geometry,E=[],W=[],X=[];let q;for(let Y=0;Y<_.length;Y++){q=_[Y];for(let te=0;te<q.buffers.length;te++)W[te]=W[te]||0,W[te]+=q.buffers[te].data.length,X[te]=0}for(let Y=0;Y<q.buffers.length;Y++)E[Y]=new map[getBufferType(q.buffers[Y].data)](W[Y]),T.buffers[Y]=new Buffer$1(E[Y]);for(let Y=0;Y<_.length;Y++){q=_[Y];for(let te=0;te<q.buffers.length;te++)E[te].set(q.buffers[te].data,X[te]),X[te]+=q.buffers[te].data.length}if(T.attributes=q.attributes,q.indexBuffer){T.indexBuffer=T.buffers[q.buffers.indexOf(q.indexBuffer)],T.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;let Y=0,te=0,ne=0,ae=0;for(let le=0;le<q.buffers.length;le++)if(q.buffers[le]!==q.indexBuffer){ae=le;break}for(const le in q.attributes){const ue=q.attributes[le];(ue.buffer|0)===ae&&(te+=ue.size*byteSizeMap$1[ue.type]/4)}for(let le=0;le<_.length;le++){const ue=_[le].indexBuffer.data;for(let ge=0;ge<ue.length;ge++)T.indexBuffer.data[ge+ne]+=Y;Y+=_[le].buffers[ae].data.length/te,ne+=ue.length}}return T}}class BatchGeometry extends Geometry{constructor(_=!1){super(),this._buffer=new Buffer$1(null,_,!1),this._indexBuffer=new Buffer$1(null,_,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,TYPES.FLOAT).addIndex(this._indexBuffer)}}const PI_2=Math.PI*2,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;var SHAPES=(B=>(B[B.POLY=0]="POLY",B[B.RECT=1]="RECT",B[B.CIRC=2]="CIRC",B[B.ELIP=3]="ELIP",B[B.RREC=4]="RREC",B))(SHAPES||{});class Point{constructor(_=0,T=0){this.x=0,this.y=0,this.x=_,this.y=T}clone(){return new Point(this.x,this.y)}copyFrom(_){return this.set(_.x,_.y),this}copyTo(_){return _.set(this.x,this.y),_}equals(_){return _.x===this.x&&_.y===this.y}set(_=0,T=_){return this.x=_,this.y=T,this}}Point.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const tempPoints$1=[new Point,new Point,new Point,new Point];class Rectangle{constructor(_=0,T=0,E=0,W=0){this.x=Number(_),this.y=Number(T),this.width=Number(E),this.height=Number(W),this.type=SHAPES.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFrom(_){return this.x=_.x,this.y=_.y,this.width=_.width,this.height=_.height,this}copyTo(_){return _.x=this.x,_.y=this.y,_.width=this.width,_.height=this.height,_}contains(_,T){return this.width<=0||this.height<=0?!1:_>=this.x&&_<this.x+this.width&&T>=this.y&&T<this.y+this.height}intersects(_,T){if(!T){const ze=this.x<_.x?_.x:this.x;if((this.right>_.right?_.right:this.right)<=ze)return!1;const He=this.y<_.y?_.y:this.y;return(this.bottom>_.bottom?_.bottom:this.bottom)>He}const E=this.left,W=this.right,X=this.top,q=this.bottom;if(W<=E||q<=X)return!1;const Y=tempPoints$1[0].set(_.left,_.top),te=tempPoints$1[1].set(_.left,_.bottom),ne=tempPoints$1[2].set(_.right,_.top),ae=tempPoints$1[3].set(_.right,_.bottom);if(ne.x<=Y.x||te.y<=Y.y)return!1;const le=Math.sign(T.a*T.d-T.b*T.c);if(le===0||(T.apply(Y,Y),T.apply(te,te),T.apply(ne,ne),T.apply(ae,ae),Math.max(Y.x,te.x,ne.x,ae.x)<=E||Math.min(Y.x,te.x,ne.x,ae.x)>=W||Math.max(Y.y,te.y,ne.y,ae.y)<=X||Math.min(Y.y,te.y,ne.y,ae.y)>=q))return!1;const ue=le*(te.y-Y.y),ge=le*(Y.x-te.x),ye=ue*E+ge*X,xe=ue*W+ge*X,Te=ue*E+ge*q,Ae=ue*W+ge*q;if(Math.max(ye,xe,Te,Ae)<=ue*Y.x+ge*Y.y||Math.min(ye,xe,Te,Ae)>=ue*ae.x+ge*ae.y)return!1;const Ie=le*(Y.y-ne.y),Ve=le*(ne.x-Y.x),$e=Ie*E+Ve*X,We=Ie*W+Ve*X,Ue=Ie*E+Ve*q,je=Ie*W+Ve*q;return!(Math.max($e,We,Ue,je)<=Ie*Y.x+Ve*Y.y||Math.min($e,We,Ue,je)>=Ie*ae.x+Ve*ae.y)}pad(_=0,T=_){return this.x-=_,this.y-=T,this.width+=_*2,this.height+=T*2,this}fit(_){const T=Math.max(this.x,_.x),E=Math.min(this.x+this.width,_.x+_.width),W=Math.max(this.y,_.y),X=Math.min(this.y+this.height,_.y+_.height);return this.x=T,this.width=Math.max(E-T,0),this.y=W,this.height=Math.max(X-W,0),this}ceil(_=1,T=.001){const E=Math.ceil((this.x+this.width-T)*_)/_,W=Math.ceil((this.y+this.height-T)*_)/_;return this.x=Math.floor((this.x+T)*_)/_,this.y=Math.floor((this.y+T)*_)/_,this.width=E-this.x,this.height=W-this.y,this}enlarge(_){const T=Math.min(this.x,_.x),E=Math.max(this.x+this.width,_.x+_.width),W=Math.min(this.y,_.y),X=Math.max(this.y+this.height,_.y+_.height);return this.x=T,this.width=E-T,this.y=W,this.height=X-W,this}}Rectangle.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};let Circle$1=class cg{constructor(_=0,T=0,E=0){this.x=_,this.y=T,this.radius=E,this.type=SHAPES.CIRC}clone(){return new cg(this.x,this.y,this.radius)}contains(_,T){if(this.radius<=0)return!1;const E=this.radius*this.radius;let W=this.x-_,X=this.y-T;return W*=W,X*=X,W+X<=E}getBounds(){return new Rectangle(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}};Circle$1.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Ellipse{constructor(_=0,T=0,E=0,W=0){this.x=_,this.y=T,this.width=E,this.height=W,this.type=SHAPES.ELIP}clone(){return new Ellipse(this.x,this.y,this.width,this.height)}contains(_,T){if(this.width<=0||this.height<=0)return!1;let E=(_-this.x)/this.width,W=(T-this.y)/this.height;return E*=E,W*=W,E+W<=1}getBounds(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}}Ellipse.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Polygon{constructor(..._){let T=Array.isArray(_[0])?_[0]:_;if(typeof T[0]!="number"){const E=[];for(let W=0,X=T.length;W<X;W++)E.push(T[W].x,T[W].y);T=E}this.points=T,this.type=SHAPES.POLY,this.closeStroke=!0}clone(){const _=this.points.slice(),T=new Polygon(_);return T.closeStroke=this.closeStroke,T}contains(_,T){let E=!1;const W=this.points.length/2;for(let X=0,q=W-1;X<W;q=X++){const Y=this.points[X*2],te=this.points[X*2+1],ne=this.points[q*2],ae=this.points[q*2+1];te>T!=ae>T&&_<(ne-Y)*((T-te)/(ae-te))+Y&&(E=!E)}return E}}Polygon.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((B,_)=>`${B}, ${_}`,"")}]`};class RoundedRectangle{constructor(_=0,T=0,E=0,W=0,X=20){this.x=_,this.y=T,this.width=E,this.height=W,this.radius=X,this.type=SHAPES.RREC}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}contains(_,T){if(this.width<=0||this.height<=0)return!1;if(_>=this.x&&_<=this.x+this.width&&T>=this.y&&T<=this.y+this.height){const E=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(T>=this.y+E&&T<=this.y+this.height-E||_>=this.x+E&&_<=this.x+this.width-E)return!0;let W=_-(this.x+E),X=T-(this.y+E);const q=E*E;if(W*W+X*X<=q||(W=_-(this.x+this.width-E),W*W+X*X<=q)||(X=T-(this.y+this.height-E),W*W+X*X<=q)||(W=_-(this.x+E),W*W+X*X<=q))return!0}return!1}}RoundedRectangle.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Matrix{constructor(_=1,T=0,E=0,W=1,X=0,q=0){this.array=null,this.a=_,this.b=T,this.c=E,this.d=W,this.tx=X,this.ty=q}fromArray(_){this.a=_[0],this.b=_[1],this.c=_[3],this.d=_[4],this.tx=_[2],this.ty=_[5]}set(_,T,E,W,X,q){return this.a=_,this.b=T,this.c=E,this.d=W,this.tx=X,this.ty=q,this}toArray(_,T){this.array||(this.array=new Float32Array(9));const E=T||this.array;return _?(E[0]=this.a,E[1]=this.b,E[2]=0,E[3]=this.c,E[4]=this.d,E[5]=0,E[6]=this.tx,E[7]=this.ty,E[8]=1):(E[0]=this.a,E[1]=this.c,E[2]=this.tx,E[3]=this.b,E[4]=this.d,E[5]=this.ty,E[6]=0,E[7]=0,E[8]=1),E}apply(_,T){T=T||new Point;const E=_.x,W=_.y;return T.x=this.a*E+this.c*W+this.tx,T.y=this.b*E+this.d*W+this.ty,T}applyInverse(_,T){T=T||new Point;const E=1/(this.a*this.d+this.c*-this.b),W=_.x,X=_.y;return T.x=this.d*E*W+-this.c*E*X+(this.ty*this.c-this.tx*this.d)*E,T.y=this.a*E*X+-this.b*E*W+(-this.ty*this.a+this.tx*this.b)*E,T}translate(_,T){return this.tx+=_,this.ty+=T,this}scale(_,T){return this.a*=_,this.d*=T,this.c*=_,this.b*=T,this.tx*=_,this.ty*=T,this}rotate(_){const T=Math.cos(_),E=Math.sin(_),W=this.a,X=this.c,q=this.tx;return this.a=W*T-this.b*E,this.b=W*E+this.b*T,this.c=X*T-this.d*E,this.d=X*E+this.d*T,this.tx=q*T-this.ty*E,this.ty=q*E+this.ty*T,this}append(_){const T=this.a,E=this.b,W=this.c,X=this.d;return this.a=_.a*T+_.b*W,this.b=_.a*E+_.b*X,this.c=_.c*T+_.d*W,this.d=_.c*E+_.d*X,this.tx=_.tx*T+_.ty*W+this.tx,this.ty=_.tx*E+_.ty*X+this.ty,this}setTransform(_,T,E,W,X,q,Y,te,ne){return this.a=Math.cos(Y+ne)*X,this.b=Math.sin(Y+ne)*X,this.c=-Math.sin(Y-te)*q,this.d=Math.cos(Y-te)*q,this.tx=_-(E*this.a+W*this.c),this.ty=T-(E*this.b+W*this.d),this}prepend(_){const T=this.tx;if(_.a!==1||_.b!==0||_.c!==0||_.d!==1){const E=this.a,W=this.c;this.a=E*_.a+this.b*_.c,this.b=E*_.b+this.b*_.d,this.c=W*_.a+this.d*_.c,this.d=W*_.b+this.d*_.d}return this.tx=T*_.a+this.ty*_.c+_.tx,this.ty=T*_.b+this.ty*_.d+_.ty,this}decompose(_){const T=this.a,E=this.b,W=this.c,X=this.d,q=_.pivot,Y=-Math.atan2(-W,X),te=Math.atan2(E,T),ne=Math.abs(Y+te);return ne<1e-5||Math.abs(PI_2-ne)<1e-5?(_.rotation=te,_.skew.x=_.skew.y=0):(_.rotation=0,_.skew.x=Y,_.skew.y=te),_.scale.x=Math.sqrt(T*T+E*E),_.scale.y=Math.sqrt(W*W+X*X),_.position.x=this.tx+(q.x*T+q.y*W),_.position.y=this.ty+(q.x*E+q.y*X),_}invert(){const _=this.a,T=this.b,E=this.c,W=this.d,X=this.tx,q=_*W-T*E;return this.a=W/q,this.b=-T/q,this.c=-E/q,this.d=_/q,this.tx=(E*this.ty-W*X)/q,this.ty=-(_*this.ty-T*X)/q,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const _=new Matrix;return _.a=this.a,_.b=this.b,_.c=this.c,_.d=this.d,_.tx=this.tx,_.ty=this.ty,_}copyTo(_){return _.a=this.a,_.b=this.b,_.c=this.c,_.d=this.d,_.tx=this.tx,_.ty=this.ty,_}copyFrom(_){return this.a=_.a,this.b=_.b,this.c=_.c,this.d=_.d,this.tx=_.tx,this.ty=_.ty,this}static get IDENTITY(){return new Matrix}static get TEMP_MATRIX(){return new Matrix}}Matrix.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init(){for(let B=0;B<16;B++){const _=[];rotationCayley.push(_);for(let T=0;T<16;T++){const E=signum(ux[B]*ux[T]+vx[B]*uy[T]),W=signum(uy[B]*ux[T]+vy[B]*uy[T]),X=signum(ux[B]*vx[T]+vx[B]*vy[T]),q=signum(uy[B]*vx[T]+vy[B]*vy[T]);for(let Y=0;Y<16;Y++)if(ux[Y]===E&&uy[Y]===W&&vx[Y]===X&&vy[Y]===q){_.push(Y);break}}}for(let B=0;B<16;B++){const _=new Matrix;_.set(ux[B],uy[B],vx[B],vy[B],0,0),rotationMatrices.push(_)}}init();const groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:B=>ux[B],uY:B=>uy[B],vX:B=>vx[B],vY:B=>vy[B],inv:B=>B&8?B&15:-B&7,add:(B,_)=>rotationCayley[B][_],sub:(B,_)=>rotationCayley[B][groupD8.inv(_)],rotate180:B=>B^4,isVertical:B=>(B&3)===2,byDirection:(B,_)=>Math.abs(B)*2<=Math.abs(_)?_>=0?groupD8.S:groupD8.N:Math.abs(_)*2<=Math.abs(B)?B>0?groupD8.E:groupD8.W:_>0?B>0?groupD8.SE:groupD8.SW:B>0?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(B,_,T=0,E=0)=>{const W=rotationMatrices[groupD8.inv(_)];W.tx=T,W.ty=E,B.append(W)}};class ObservablePoint{constructor(_,T,E=0,W=0){this._x=E,this._y=W,this.cb=_,this.scope=T}clone(_=this.cb,T=this.scope){return new ObservablePoint(_,T,this._x,this._y)}set(_=0,T=_){return(this._x!==_||this._y!==T)&&(this._x=_,this._y=T,this.cb.call(this.scope)),this}copyFrom(_){return(this._x!==_.x||this._y!==_.y)&&(this._x=_.x,this._y=_.y,this.cb.call(this.scope)),this}copyTo(_){return _.set(this._x,this._y),_}equals(_){return _.x===this._x&&_.y===this._y}get x(){return this._x}set x(_){this._x!==_&&(this._x=_,this.cb.call(this.scope))}get y(){return this._y}set y(_){this._y!==_&&(this._y=_,this.cb.call(this.scope))}}ObservablePoint.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const _Transform=class{constructor(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const B=this.localTransform;this._localID!==this._currentLocalID&&(B.a=this._cx*this.scale.x,B.b=this._sx*this.scale.x,B.c=this._cy*this.scale.y,B.d=this._sy*this.scale.y,B.tx=this.position.x-(this.pivot.x*B.a+this.pivot.y*B.c),B.ty=this.position.y-(this.pivot.x*B.b+this.pivot.y*B.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(B){const _=this.localTransform;if(this._localID!==this._currentLocalID&&(_.a=this._cx*this.scale.x,_.b=this._sx*this.scale.x,_.c=this._cy*this.scale.y,_.d=this._sy*this.scale.y,_.tx=this.position.x-(this.pivot.x*_.a+this.pivot.y*_.c),_.ty=this.position.y-(this.pivot.x*_.b+this.pivot.y*_.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==B._worldID){const T=B.worldTransform,E=this.worldTransform;E.a=_.a*T.a+_.b*T.c,E.b=_.a*T.b+_.b*T.d,E.c=_.c*T.a+_.d*T.c,E.d=_.c*T.b+_.d*T.d,E.tx=_.tx*T.a+_.ty*T.c+T.tx,E.ty=_.tx*T.b+_.ty*T.d+T.ty,this._parentID=B._worldID,this._worldID++}}setFromMatrix(B){B.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(B){this._rotation!==B&&(this._rotation=B,this.updateSkew())}};_Transform.IDENTITY=new _Transform;let Transform$1=_Transform;Transform$1.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var defaultFragment$2=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,defaultVertex$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function compileShader(B,_,T){const E=B.createShader(_);return B.shaderSource(E,T),B.compileShader(E),E}function booleanArray(B){const _=new Array(B);for(let T=0;T<_.length;T++)_[T]=!1;return _}function defaultValue(B,_){switch(B){case"float":return 0;case"vec2":return new Float32Array(2*_);case"vec3":return new Float32Array(3*_);case"vec4":return new Float32Array(4*_);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*_);case"ivec3":return new Int32Array(3*_);case"ivec4":return new Int32Array(4*_);case"uvec2":return new Uint32Array(2*_);case"uvec3":return new Uint32Array(3*_);case"uvec4":return new Uint32Array(4*_);case"bool":return!1;case"bvec2":return booleanArray(2*_);case"bvec3":return booleanArray(3*_);case"bvec4":return booleanArray(4*_);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const uniformParsers=[{test:B=>B.type==="float"&&B.size===1&&!B.isArray,code:B=>`
            if(uv["${B}"] !== ud["${B}"].value)
            {
                ud["${B}"].value = uv["${B}"]
                gl.uniform1f(ud["${B}"].location, uv["${B}"])
            }
            `},{test:(B,_)=>(B.type==="sampler2D"||B.type==="samplerCube"||B.type==="sampler2DArray")&&B.size===1&&!B.isArray&&(_==null||_.castToBaseTexture!==void 0),code:B=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${B}"], t);

            if(ud["${B}"].value !== t)
            {
                ud["${B}"].value = t;
                gl.uniform1i(ud["${B}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(B,_)=>B.type==="mat3"&&B.size===1&&!B.isArray&&_.a!==void 0,code:B=>`
            gl.uniformMatrix3fv(ud["${B}"].location, false, uv["${B}"].toArray(true));
            `,codeUbo:B=>`
                var ${B}_matrix = uv.${B}.toArray(true);

                data[offset] = ${B}_matrix[0];
                data[offset+1] = ${B}_matrix[1];
                data[offset+2] = ${B}_matrix[2];
        
                data[offset + 4] = ${B}_matrix[3];
                data[offset + 5] = ${B}_matrix[4];
                data[offset + 6] = ${B}_matrix[5];
        
                data[offset + 8] = ${B}_matrix[6];
                data[offset + 9] = ${B}_matrix[7];
                data[offset + 10] = ${B}_matrix[8];
            `},{test:(B,_)=>B.type==="vec2"&&B.size===1&&!B.isArray&&_.x!==void 0,code:B=>`
                cv = ud["${B}"].value;
                v = uv["${B}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${B}"].location, v.x, v.y);
                }`,codeUbo:B=>`
                v = uv.${B};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:B=>B.type==="vec2"&&B.size===1&&!B.isArray,code:B=>`
                cv = ud["${B}"].value;
                v = uv["${B}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${B}"].location, v[0], v[1]);
                }
            `},{test:(B,_)=>B.type==="vec4"&&B.size===1&&!B.isArray&&_.width!==void 0,code:B=>`
                cv = ud["${B}"].value;
                v = uv["${B}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${B}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:B=>`
                    v = uv.${B};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(B,_)=>B.type==="vec4"&&B.size===1&&!B.isArray&&_.red!==void 0,code:B=>`
                cv = ud["${B}"].value;
                v = uv["${B}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${B}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:B=>`
                    v = uv.${B};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(B,_)=>B.type==="vec3"&&B.size===1&&!B.isArray&&_.red!==void 0,code:B=>`
                cv = ud["${B}"].value;
                v = uv["${B}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${B}"].location, v.red, v.green, v.blue)
                }`,codeUbo:B=>`
                    v = uv.${B};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:B=>B.type==="vec4"&&B.size===1&&!B.isArray,code:B=>`
                cv = ud["${B}"].value;
                v = uv["${B}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${B}"].location, v[0], v[1], v[2], v[3])
                }`}],GLSL_TO_SINGLE_SETTERS_CACHED={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(B,_){var E;const T=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const W in B.uniforms){const X=_[W];if(!X){((E=B.uniforms[W])==null?void 0:E.group)===!0&&(B.uniforms[W].ubo?T.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${W}, '${W}');
                    `):T.push(`
                        renderer.shader.syncUniformGroup(uv.${W}, syncData);
                    `));continue}const q=B.uniforms[W];let Y=!1;for(let te=0;te<uniformParsers.length;te++)if(uniformParsers[te].test(X,q)){T.push(uniformParsers[te].code(W,q)),Y=!0;break}if(!Y){const te=(X.size===1&&!X.isArray?GLSL_TO_SINGLE_SETTERS_CACHED:GLSL_TO_ARRAY_SETTERS)[X.type].replace("location",`ud["${W}"].location`);T.push(`
            cu = ud["${W}"];
            cv = cu.value;
            v = uv["${W}"];
            ${te};`)}}return new Function("ud","uv","renderer","syncData",T.join(`
`))}const unknownContext={};let context=unknownContext;function getTestContext(){if(context===unknownContext||context!=null&&context.isContextLost()){const B=settings.ADAPTER.createCanvas();let _;settings.PREFER_ENV>=ENV.WEBGL2&&(_=B.getContext("webgl2",{})),_||(_=B.getContext("webgl",{})||B.getContext("experimental-webgl",{}),_?_.getExtension("WEBGL_draw_buffers"):_=null),context=_}return context}let maxFragmentPrecision;function getMaxFragmentPrecision(){if(!maxFragmentPrecision){maxFragmentPrecision=PRECISION.MEDIUM;const B=getTestContext();if(B&&B.getShaderPrecisionFormat){const _=B.getShaderPrecisionFormat(B.FRAGMENT_SHADER,B.HIGH_FLOAT);_&&(maxFragmentPrecision=_.precision?PRECISION.HIGH:PRECISION.MEDIUM)}}return maxFragmentPrecision}function logPrettyShaderError(B,_){const T=B.getShaderSource(_).split(`
`).map((ne,ae)=>`${ae}: ${ne}`),E=B.getShaderInfoLog(_),W=E.split(`
`),X={},q=W.map(ne=>parseFloat(ne.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(ne=>ne&&!X[ne]?(X[ne]=!0,!0):!1),Y=[""];q.forEach(ne=>{T[ne-1]=`%c${T[ne-1]}%c`,Y.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const te=T.join(`
`);Y[0]=te,console.error(E),console.groupCollapsed("click to view full shader code"),console.warn(...Y),console.groupEnd()}function logProgramError(B,_,T,E){B.getProgramParameter(_,B.LINK_STATUS)||(B.getShaderParameter(T,B.COMPILE_STATUS)||logPrettyShaderError(B,T),B.getShaderParameter(E,B.COMPILE_STATUS)||logPrettyShaderError(B,E),console.error("PixiJS Error: Could not initialize shader."),B.getProgramInfoLog(_)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",B.getProgramInfoLog(_)))}const GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(B){return GLSL_TO_SIZE[B]}let GL_TABLE=null;const GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(B,_){if(!GL_TABLE){const T=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(let E=0;E<T.length;++E){const W=T[E];GL_TABLE[B[W]]=GL_TO_GLSL_TYPES[W]}}return GL_TABLE[_]}function setPrecision(B,_,T){if(B.substring(0,9)!=="precision"){let E=_;return _===PRECISION.HIGH&&T!==PRECISION.HIGH&&(E=PRECISION.MEDIUM),`precision ${E} float;
${B}`}else if(T!==PRECISION.HIGH&&B.substring(0,15)==="precision highp")return B.replace("precision highp","precision mediump");return B}let unsafeEval;function unsafeEvalSupported(){if(typeof unsafeEval=="boolean")return unsafeEval;try{unsafeEval=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{unsafeEval=!1}return unsafeEval}let UID$2=0;const nameCache={},_Program=class Ya{constructor(_,T,E="pixi-shader",W={}){this.extra={},this.id=UID$2++,this.vertexSrc=_||Ya.defaultVertexSrc,this.fragmentSrc=T||Ya.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=W,this.vertexSrc.substring(0,8)!=="#version"&&(E=E.replace(/\s+/g,"-"),nameCache[E]?(nameCache[E]++,E+=`-${nameCache[E]}`):nameCache[E]=1,this.vertexSrc=`#define SHADER_NAME ${E}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${E}
${this.fragmentSrc}`,this.vertexSrc=setPrecision(this.vertexSrc,Ya.defaultVertexPrecision,PRECISION.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,Ya.defaultFragmentPrecision,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return defaultVertex$3}static get defaultFragmentSrc(){return defaultFragment$2}static from(_,T,E){const W=_+T;let X=ProgramCache[W];return X||(ProgramCache[W]=X=new Ya(_,T,E)),X}};_Program.defaultVertexPrecision=PRECISION.HIGH,_Program.defaultFragmentPrecision=isMobile$1.apple.device?PRECISION.HIGH:PRECISION.MEDIUM;let Program=_Program,UID$1=0;class UniformGroup{constructor(_,T,E){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$1++,this.static=!!T,this.ubo=!!E,_ instanceof Buffer$1?(this.buffer=_,this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=_,this.ubo&&(this.buffer=new Buffer$1(new Float32Array(1)),this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(_,T,E){if(!this.ubo)this.uniforms[_]=new UniformGroup(T,E);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(_,T,E){return new UniformGroup(_,T,E)}static uboFrom(_,T){return new UniformGroup(_,T??!0,!0)}}class Shader{constructor(_,T){this.uniformBindCount=0,this.program=_,T?T instanceof UniformGroup?this.uniformGroup=T:this.uniformGroup=new UniformGroup(T):this.uniformGroup=new UniformGroup({}),this.disposeRunner=new Runner("disposeShader")}checkUniformExists(_,T){if(T.uniforms[_])return!0;for(const E in T.uniforms){const W=T.uniforms[E];if(W.group===!0&&this.checkUniformExists(_,W))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(_,T,E){const W=Program.from(_,T);return new Shader(W,E)}}class BatchShaderGenerator{constructor(_,T){if(this.vertexSrc=_,this.fragTemplate=T,this.programCache={},this.defaultGroupCache={},!T.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!T.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(_){if(!this.programCache[_]){const E=new Int32Array(_);for(let X=0;X<_;X++)E[X]=X;this.defaultGroupCache[_]=UniformGroup.from({uSamplers:E},!0);let W=this.fragTemplate;W=W.replace(/%count%/gi,`${_}`),W=W.replace(/%forloop%/gi,this.generateSampleSrc(_)),this.programCache[_]=new Program(this.vertexSrc,W)}const T={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[_]};return new Shader(this.programCache[_],T)}generateSampleSrc(_){let T="";T+=`
`,T+=`
`;for(let E=0;E<_;E++)E>0&&(T+=`
else `),E<_-1&&(T+=`if(vTextureId < ${E}.5)`),T+=`
{`,T+=`
	color = texture2D(uSamplers[${E}], vTextureCoord);`,T+=`
}`;return T+=`
`,T+=`
`,T}}class BatchTextureArray{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let _=0;_<this.count;_++)this.elements[_]=null;this.count=0}}function canUploadSameBuffer(){return!isMobile$1.apple.device}function maxRecommendedTextures(B){let _=!0;const T=settings.ADAPTER.getNavigator();if(isMobile$1.tablet||isMobile$1.phone){if(isMobile$1.apple.device){const E=T.userAgent.match(/OS (\d+)_(\d+)?/);E&&parseInt(E[1],10)<11&&(_=!1)}if(isMobile$1.android.device){const E=T.userAgent.match(/Android\s([0-9.]*)/);E&&parseInt(E[1],10)<7&&(_=!1)}}return _?B:4}class ObjectRenderer{constructor(_){this.renderer=_}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(_){}}var defaultFragment$1=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,defaultVertex$2=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const _BatchRenderer=class mo extends ObjectRenderer{constructor(_){super(_),this.setShaderGenerator(),this.geometryClass=BatchGeometry,this.vertexSize=6,this.state=State.for2d(),this.size=mo.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),_.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??maxRecommendedTextures(32),this._defaultMaxTextures}static set defaultMaxTextures(_){this._defaultMaxTextures=_}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??canUploadSameBuffer(),this._canUploadSameBuffer}static set canUploadSameBuffer(_){this._canUploadSameBuffer=_}get MAX_TEXTURES(){return deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return defaultVertex$2}static get defaultFragmentTemplate(){return defaultFragment$1}setShaderGenerator({vertex:_=mo.defaultVertexSrc,fragment:T=mo.defaultFragmentTemplate}={}){this.shaderGenerator=new BatchShaderGenerator(_,T)}contextChange(){const _=this.renderer.gl;settings.PREFER_ENV===ENV.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(_.getParameter(_.MAX_TEXTURE_IMAGE_UNITS),mo.defaultMaxTextures),this.maxTextures=checkMaxIfStatementsInShader(this.maxTextures,_)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let T=0;T<this._packedGeometryPoolSize;T++)this._packedGeometries[T]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:_,_textureArrayPool:T}=mo,E=this.size/4,W=Math.floor(E/this.maxTextures)+1;for(;_.length<E;)_.push(new BatchDrawCall);for(;T.length<W;)T.push(new BatchTextureArray);for(let X=0;X<this.maxTextures;X++)this._tempBoundTextures[X]=null}onPrerender(){this._flushId=0}render(_){_._texture.valid&&(this._vertexCount+_.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=_.vertexData.length/2,this._indexCount+=_.indices.length,this._bufferedTextures[this._bufferSize]=_._texture.baseTexture,this._bufferedElements[this._bufferSize++]=_)}buildTexturesAndDrawCalls(){const{_bufferedTextures:_,maxTextures:T}=this,E=mo._textureArrayPool,W=this.renderer.batch,X=this._tempBoundTextures,q=this.renderer.textureGC.count;let Y=++BaseTexture._globalBatch,te=0,ne=E[0],ae=0;W.copyBoundTextures(X,T);for(let le=0;le<this._bufferSize;++le){const ue=_[le];_[le]=null,ue._batchEnabled!==Y&&(ne.count>=T&&(W.boundArray(ne,X,Y,T),this.buildDrawCalls(ne,ae,le),ae=le,ne=E[++te],++Y),ue._batchEnabled=Y,ue.touched=q,ne.elements[ne.count++]=ue)}ne.count>0&&(W.boundArray(ne,X,Y,T),this.buildDrawCalls(ne,ae,this._bufferSize),++te,++Y);for(let le=0;le<X.length;le++)X[le]=null;BaseTexture._globalBatch=Y}buildDrawCalls(_,T,E){const{_bufferedElements:W,_attributeBuffer:X,_indexBuffer:q,vertexSize:Y}=this,te=mo._drawCallPool;let ne=this._dcIndex,ae=this._aIndex,le=this._iIndex,ue=te[ne];ue.start=this._iIndex,ue.texArray=_;for(let ge=T;ge<E;++ge){const ye=W[ge],xe=ye._texture.baseTexture,Te=premultiplyBlendMode[xe.alphaMode?1:0][ye.blendMode];W[ge]=null,T<ge&&ue.blend!==Te&&(ue.size=le-ue.start,T=ge,ue=te[++ne],ue.texArray=_,ue.start=le),this.packInterleavedGeometry(ye,X,q,ae,le),ae+=ye.vertexData.length/2*Y,le+=ye.indices.length,ue.blend=Te}T<E&&(ue.size=le-ue.start,++ne),this._dcIndex=ne,this._aIndex=ae,this._iIndex=le}bindAndClearTexArray(_){const T=this.renderer.texture;for(let E=0;E<_.count;E++)T.bind(_.elements[E],_.ids[E]),_.elements[E]=null;_.count=0}updateGeometry(){const{_packedGeometries:_,_attributeBuffer:T,_indexBuffer:E}=this;mo.canUploadSameBuffer?(_[this._flushId]._buffer.update(T.rawBinaryData),_[this._flushId]._indexBuffer.update(E),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,_[this._flushId]=new this.geometryClass),_[this._flushId]._buffer.update(T.rawBinaryData),_[this._flushId]._indexBuffer.update(E),this.renderer.geometry.bind(_[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const _=this._dcIndex,{gl:T,state:E}=this.renderer,W=mo._drawCallPool;let X=null;for(let q=0;q<_;q++){const{texArray:Y,type:te,size:ne,start:ae,blend:le}=W[q];X!==Y&&(X=Y,this.bindAndClearTexArray(Y)),this.state.blendMode=le,E.set(this.state),T.drawElements(te,ne,T.UNSIGNED_SHORT,ae*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),mo.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let _=0;_<this._packedGeometryPoolSize;_++)this._packedGeometries[_]&&this._packedGeometries[_].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(_){const T=nextPow2(Math.ceil(_/8)),E=log2(T),W=T*8;this._aBuffers.length<=E&&(this._iBuffers.length=E+1);let X=this._aBuffers[W];return X||(this._aBuffers[W]=X=new ViewableBuffer(W*this.vertexSize*4)),X}getIndexBuffer(_){const T=nextPow2(Math.ceil(_/12)),E=log2(T),W=T*12;this._iBuffers.length<=E&&(this._iBuffers.length=E+1);let X=this._iBuffers[E];return X||(this._iBuffers[E]=X=new Uint16Array(W)),X}packInterleavedGeometry(_,T,E,W,X){const{uint32View:q,float32View:Y}=T,te=W/this.vertexSize,ne=_.uvs,ae=_.indices,le=_.vertexData,ue=_._texture.baseTexture._batchLocation,ge=Math.min(_.worldAlpha,1),ye=Color$1.shared.setValue(_._tintRGB).toPremultiplied(ge,_._texture.baseTexture.alphaMode>0);for(let xe=0;xe<le.length;xe+=2)Y[W++]=le[xe],Y[W++]=le[xe+1],Y[W++]=ne[xe],Y[W++]=ne[xe+1],q[W++]=ye,Y[W++]=ue;for(let xe=0;xe<ae.length;xe++)E[X++]=te+ae[xe]}};_BatchRenderer.defaultBatchSize=4096,_BatchRenderer.extension={name:"batch",type:ExtensionType.RendererPlugin},_BatchRenderer._drawCallPool=[],_BatchRenderer._textureArrayPool=[];let BatchRenderer=_BatchRenderer;extensions$1.add(BatchRenderer);var defaultFragment=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,defaultVertex$1=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const _Filter=class zl extends Shader{constructor(_,T,E){const W=Program.from(_||zl.defaultVertexSrc,T||zl.defaultFragmentSrc);super(W,E),this.padding=0,this.resolution=zl.defaultResolution,this.multisample=zl.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new State}apply(_,T,E,W,X){_.applyFilter(this,T,E,W)}get blendMode(){return this.state.blendMode}set blendMode(_){this.state.blendMode=_}get resolution(){return this._resolution}set resolution(_){this._resolution=_}static get defaultVertexSrc(){return defaultVertex$1}static get defaultFragmentSrc(){return defaultFragment}};_Filter.defaultResolution=1,_Filter.defaultMultisample=MSAA_QUALITY.NONE;let Filter=_Filter;class BackgroundSystem{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Color$1(0),this.alpha=1}init(_){this.clearBeforeRender=_.clearBeforeRender;const{backgroundColor:T,background:E,backgroundAlpha:W}=_,X=E??T;X!==void 0&&(this.color=X),this.alpha=W}get color(){return this._backgroundColor.value}set color(_){this._backgroundColor.setValue(_)}get alpha(){return this._backgroundColor.alpha}set alpha(_){this._backgroundColor.setAlpha(_)}get backgroundColor(){return this._backgroundColor}destroy(){}}BackgroundSystem.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},BackgroundSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"background"};extensions$1.add(BackgroundSystem);class BatchSystem{constructor(_){this.renderer=_,this.emptyRenderer=new ObjectRenderer(_),this.currentRenderer=this.emptyRenderer}setObjectRenderer(_){this.currentRenderer!==_&&(this.currentRenderer.stop(),this.currentRenderer=_,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(_,T){const{boundTextures:E}=this.renderer.texture;for(let W=T-1;W>=0;--W)_[W]=E[W]||null,_[W]&&(_[W]._batchLocation=W)}boundArray(_,T,E,W){const{elements:X,ids:q,count:Y}=_;let te=0;for(let ne=0;ne<Y;ne++){const ae=X[ne],le=ae._batchLocation;if(le>=0&&le<W&&T[le]===ae){q[ne]=le;continue}for(;te<W;){const ue=T[te];if(ue&&ue._batchEnabled===E&&ue._batchLocation===te){te++;continue}q[ne]=te,ae._batchLocation=te,T[te]=ae;break}}}destroy(){this.renderer=null}}BatchSystem.extension={type:ExtensionType.RendererSystem,name:"batch"};extensions$1.add(BatchSystem);let CONTEXT_UID_COUNTER=0;class ContextSystem{constructor(_){this.renderer=_,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(_){this.gl=_,this.renderer.gl=_,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++}init(_){if(_.context)this.initFromContext(_.context);else{const T=this.renderer.background.alpha<1,E=_.premultipliedAlpha;this.preserveDrawingBuffer=_.preserveDrawingBuffer,this.useContextAlpha=_.useContextAlpha,this.powerPreference=_.powerPreference,this.initFromOptions({alpha:T,premultipliedAlpha:E,antialias:_.antialias,stencil:!0,preserveDrawingBuffer:_.preserveDrawingBuffer,powerPreference:_.powerPreference})}}initFromContext(_){this.gl=_,this.validateContext(_),this.renderer.gl=_,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(_);const T=this.renderer.view;T.addEventListener!==void 0&&(T.addEventListener("webglcontextlost",this.handleContextLost,!1),T.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(_){const T=this.createContext(this.renderer.view,_);this.initFromContext(T)}createContext(_,T){let E;if(settings.PREFER_ENV>=ENV.WEBGL2&&(E=_.getContext("webgl2",T)),E)this.webGLVersion=2;else if(this.webGLVersion=1,E=_.getContext("webgl",T)||_.getContext("experimental-webgl",T),!E)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=E,this.getExtensions(),this.gl}getExtensions(){const{gl:_}=this,T={loseContext:_.getExtension("WEBGL_lose_context"),anisotropicFiltering:_.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:_.getExtension("OES_texture_float_linear"),s3tc:_.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:_.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:_.getExtension("WEBGL_compressed_texture_etc"),etc1:_.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:_.getExtension("WEBGL_compressed_texture_pvrtc")||_.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:_.getExtension("WEBGL_compressed_texture_atc"),astc:_.getExtension("WEBGL_compressed_texture_astc"),bptc:_.getExtension("EXT_texture_compression_bptc")};this.webGLVersion===1?Object.assign(this.extensions,T,{drawBuffers:_.getExtension("WEBGL_draw_buffers"),depthTexture:_.getExtension("WEBGL_depth_texture"),vertexArrayObject:_.getExtension("OES_vertex_array_object")||_.getExtension("MOZ_OES_vertex_array_object")||_.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:_.getExtension("OES_element_index_uint"),floatTexture:_.getExtension("OES_texture_float"),floatTextureLinear:_.getExtension("OES_texture_float_linear"),textureHalfFloat:_.getExtension("OES_texture_half_float"),textureHalfFloatLinear:_.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,T,{colorBufferFloat:_.getExtension("EXT_color_buffer_float")})}handleContextLost(_){_.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const _=this.renderer.view;this.renderer=null,_.removeEventListener!==void 0&&(_.removeEventListener("webglcontextlost",this.handleContextLost),_.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(_){const T=_.getContextAttributes(),E="WebGL2RenderingContext"in globalThis&&_ instanceof globalThis.WebGL2RenderingContext;E&&(this.webGLVersion=2),T&&!T.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const W=E||!!_.getExtension("OES_element_index_uint");this.supports.uint32Indices=W,W||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}ContextSystem.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},ContextSystem.extension={type:ExtensionType.RendererSystem,name:"context"};extensions$1.add(ContextSystem);class Framebuffer{constructor(_,T){if(this.width=Math.round(_),this.height=Math.round(T),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner("disposeFramebuffer"),this.multisample=MSAA_QUALITY.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(_=0,T){return this.colorTextures[_]=T||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,mipmap:MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(_){return this.depthTexture=_||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:MIPMAP_MODES.OFF,format:FORMATS.DEPTH_COMPONENT,type:TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(_,T){if(_=Math.round(_),T=Math.round(T),!_||!T)throw new Error("Framebuffer width and height must not be zero");if(!(_===this.width&&T===this.height)){this.width=_,this.height=T,this.dirtyId++,this.dirtySize++;for(let E=0;E<this.colorTextures.length;E++){const W=this.colorTextures[E],X=W.resolution;W.setSize(_/X,T/X)}if(this.depthTexture){const E=this.depthTexture.resolution;this.depthTexture.setSize(_/E,T/E)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class BaseRenderTexture extends BaseTexture{constructor(_={}){if(typeof _=="number"){const T=arguments[0],E=arguments[1],W=arguments[2],X=arguments[3];_={width:T,height:E,scaleMode:W,resolution:X}}_.width=_.width??100,_.height=_.height??100,_.multisample??(_.multisample=MSAA_QUALITY.NONE),super(null,_),this.mipmap=MIPMAP_MODES.OFF,this.valid=!0,this._clear=new Color$1([0,0,0,0]),this.framebuffer=new Framebuffer(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=_.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(_){this._clear.setValue(_)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(_){this.framebuffer.multisample=_}resize(_,T){this.framebuffer.resize(_*this.resolution,T*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class BaseImageResource extends Resource{constructor(_){const T=_,E=T.naturalWidth||T.videoWidth||T.displayWidth||T.width,W=T.naturalHeight||T.videoHeight||T.displayHeight||T.height;super(E,W),this.source=_,this.noSubImage=!1}static crossOrigin(_,T,E){E===void 0&&!T.startsWith("data:")?_.crossOrigin=determineCrossOrigin(T):E!==!1&&(_.crossOrigin=typeof E=="string"?E:"anonymous")}upload(_,T,E,W){const X=_.gl,q=T.realWidth,Y=T.realHeight;if(W=W||this.source,typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement){if(!W.complete||W.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&W instanceof HTMLVideoElement&&W.readyState<=1)return!1;return X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,T.alphaMode===ALPHA_MODES.UNPACK),!this.noSubImage&&T.target===X.TEXTURE_2D&&E.width===q&&E.height===Y?X.texSubImage2D(X.TEXTURE_2D,0,0,0,T.format,E.type,W):(E.width=q,E.height=Y,X.texImage2D(T.target,0,E.internalFormat,T.format,E.type,W)),!0}update(){if(this.destroyed)return;const _=this.source,T=_.naturalWidth||_.videoWidth||_.width,E=_.naturalHeight||_.videoHeight||_.height;this.resize(T,E),super.update()}dispose(){this.source=null}}class ImageResource extends BaseImageResource{constructor(_,T){if(T=T||{},typeof _=="string"){const E=new Image;BaseImageResource.crossOrigin(E,_,T.crossorigin),E.src=_,_=E}super(_),!_.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=_.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(T.createBitmap??settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof T.alphaMode=="number"?T.alphaMode:null,this.bitmap=null,this._load=null,T.autoLoad!==!1&&this.load()}load(_){return this._load?this._load:(_!==void 0&&(this.createBitmap=_),this._load=new Promise((T,E)=>{const W=this.source;this.url=W.src;const X=()=>{this.destroyed||(W.onload=null,W.onerror=null,this.update(),this._load=null,this.createBitmap?T(this.process()):T(this))};W.complete&&W.src?X():(W.onload=X,W.onerror=q=>{E(q),this.onError.emit(q)})}),this._load)}process(){const _=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const T=globalThis.createImageBitmap,E=!_.crossOrigin||_.crossOrigin==="anonymous";return this._process=fetch(_.src,{mode:E?"cors":"no-cors"}).then(W=>W.blob()).then(W=>T(W,0,0,_.width,_.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"})).then(W=>this.destroyed?Promise.reject():(this.bitmap=W,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(_,T,E){if(typeof this.alphaMode=="number"&&(T.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(_,T,E);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(_,T,E,this.bitmap),!this.preserveBitmap){let W=!0;const X=T._glTextures;for(const q in X){const Y=X[q];if(Y!==E&&Y.dirtyId!==T.dirtyId){W=!1;break}}W&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(_){return typeof HTMLImageElement<"u"&&(typeof _=="string"||_ instanceof HTMLImageElement)}}class TextureUvs{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(_,T,E){const W=T.width,X=T.height;if(E){const q=_.width/2/W,Y=_.height/2/X,te=_.x/W+q,ne=_.y/X+Y;E=groupD8.add(E,groupD8.NW),this.x0=te+q*groupD8.uX(E),this.y0=ne+Y*groupD8.uY(E),E=groupD8.add(E,2),this.x1=te+q*groupD8.uX(E),this.y1=ne+Y*groupD8.uY(E),E=groupD8.add(E,2),this.x2=te+q*groupD8.uX(E),this.y2=ne+Y*groupD8.uY(E),E=groupD8.add(E,2),this.x3=te+q*groupD8.uX(E),this.y3=ne+Y*groupD8.uY(E)}else this.x0=_.x/W,this.y0=_.y/X,this.x1=(_.x+_.width)/W,this.y1=_.y/X,this.x2=(_.x+_.width)/W,this.y2=(_.y+_.height)/X,this.x3=_.x/W,this.y3=(_.y+_.height)/X;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}TextureUvs.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const DEFAULT_UVS=new TextureUvs;function removeAllHandlers(B){B.destroy=function(){},B.on=function(){},B.once=function(){},B.emit=function(){}}let Texture$1=class Zn extends EventEmitter{constructor(_,T,E,W,X,q,Y){if(super(),this.noFrame=!1,T||(this.noFrame=!0,T=new Rectangle(0,0,1,1)),_ instanceof Zn&&(_=_.baseTexture),this.baseTexture=_,this._frame=T,this.trim=W,this.valid=!1,this.destroyed=!1,this._uvs=DEFAULT_UVS,this.uvMatrix=null,this.orig=E||T,this._rotate=Number(X||0),X===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=q?new Point(q.x,q.y):new Point(0,0),this.defaultBorders=Y,this._updateID=0,this.textureCacheIds=[],_.valid?this.noFrame?_.valid&&this.onBaseTextureUpdated(_):this.frame=T:_.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&_.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(_){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=_.width,this._frame.height=_.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(_){if(this.baseTexture){if(_){const{resource:T}=this.baseTexture;T!=null&&T.url&&TextureCache[T.url]&&Zn.removeFromCache(T.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Zn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var W;const _=this._frame.clone(),T=this._frame===this.orig?_:this.orig.clone(),E=new Zn(this.baseTexture,!this.noFrame&&_,T,(W=this.trim)==null?void 0:W.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(E._frame=_),E}updateUvs(){this._uvs===DEFAULT_UVS&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(_,T={},E=settings.STRICT_TEXTURE_CACHE){const W=typeof _=="string";let X=null;if(W)X=_;else if(_ instanceof BaseTexture){if(!_.cacheId){const Y=(T==null?void 0:T.pixiIdPrefix)||"pixiid";_.cacheId=`${Y}-${uid()}`,BaseTexture.addToCache(_,_.cacheId)}X=_.cacheId}else{if(!_._pixiId){const Y=(T==null?void 0:T.pixiIdPrefix)||"pixiid";_._pixiId=`${Y}_${uid()}`}X=_._pixiId}let q=TextureCache[X];if(W&&E&&!q)throw new Error(`The cacheId "${X}" does not exist in TextureCache.`);return!q&&!(_ instanceof BaseTexture)?(T.resolution||(T.resolution=getResolutionOfUrl(_)),q=new Zn(new BaseTexture(_,T)),q.baseTexture.cacheId=X,BaseTexture.addToCache(q.baseTexture,X),Zn.addToCache(q,X)):!q&&_ instanceof BaseTexture&&(q=new Zn(_),Zn.addToCache(q,X)),q}static fromURL(_,T){const E=Object.assign({autoLoad:!1},T==null?void 0:T.resourceOptions),W=Zn.from(_,Object.assign({resourceOptions:E},T),!1),X=W.baseTexture.resource;return W.baseTexture.valid?Promise.resolve(W):X.load().then(()=>Promise.resolve(W))}static fromBuffer(_,T,E,W){return new Zn(BaseTexture.fromBuffer(_,T,E,W))}static fromLoader(_,T,E,W){const X=new BaseTexture(_,Object.assign({scaleMode:BaseTexture.defaultOptions.scaleMode,resolution:getResolutionOfUrl(T)},W)),{resource:q}=X;q instanceof ImageResource&&(q.url=T);const Y=new Zn(X);return E||(E=T),BaseTexture.addToCache(Y.baseTexture,E),Zn.addToCache(Y,E),E!==T&&(BaseTexture.addToCache(Y.baseTexture,T),Zn.addToCache(Y,T)),Y.baseTexture.valid?Promise.resolve(Y):new Promise(te=>{Y.baseTexture.once("loaded",()=>te(Y))})}static addToCache(_,T){T&&(_.textureCacheIds.includes(T)||_.textureCacheIds.push(T),TextureCache[T]&&TextureCache[T]!==_&&console.warn(`Texture added to the cache with an id [${T}] that already had an entry`),TextureCache[T]=_)}static removeFromCache(_){if(typeof _=="string"){const T=TextureCache[_];if(T){const E=T.textureCacheIds.indexOf(_);return E>-1&&T.textureCacheIds.splice(E,1),delete TextureCache[_],T}}else if(_!=null&&_.textureCacheIds){for(let T=0;T<_.textureCacheIds.length;++T)TextureCache[_.textureCacheIds[T]]===_&&delete TextureCache[_.textureCacheIds[T]];return _.textureCacheIds.length=0,_}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(_){this._frame=_,this.noFrame=!1;const{x:T,y:E,width:W,height:X}=_,q=T+W>this.baseTexture.width,Y=E+X>this.baseTexture.height;if(q||Y){const te=q&&Y?"and":"or",ne=`X: ${T} + ${W} = ${T+W} > ${this.baseTexture.width}`,ae=`Y: ${E} + ${X} = ${E+X} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${ne} ${te} ${ae}`)}this.valid=W&&X&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=_),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(_){this._rotate=_,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Zn._EMPTY||(Zn._EMPTY=new Zn(new BaseTexture),removeAllHandlers(Zn._EMPTY),removeAllHandlers(Zn._EMPTY.baseTexture)),Zn._EMPTY}static get WHITE(){if(!Zn._WHITE){const _=settings.ADAPTER.createCanvas(16,16),T=_.getContext("2d");_.width=16,_.height=16,T.fillStyle="white",T.fillRect(0,0,16,16),Zn._WHITE=new Zn(BaseTexture.from(_)),removeAllHandlers(Zn._WHITE),removeAllHandlers(Zn._WHITE.baseTexture)}return Zn._WHITE}};class RenderTexture extends Texture$1{constructor(_,T){super(_,T),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(_){this.framebuffer.multisample=_}resize(_,T,E=!0){const W=this.baseTexture.resolution,X=Math.round(_*W)/W,q=Math.round(T*W)/W;this.valid=X>0&&q>0,this._frame.width=this.orig.width=X,this._frame.height=this.orig.height=q,E&&this.baseTexture.resize(X,q),this.updateUvs()}setResolution(_){const{baseTexture:T}=this;T.resolution!==_&&(T.setResolution(_),this.resize(T.width,T.height,!1))}static create(_){return new RenderTexture(new BaseRenderTexture(_))}}class RenderTexturePool{constructor(_){this.texturePool={},this.textureOptions=_||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(_,T,E=MSAA_QUALITY.NONE){const W=new BaseRenderTexture(Object.assign({width:_,height:T,resolution:1,multisample:E},this.textureOptions));return new RenderTexture(W)}getOptimalTexture(_,T,E=1,W=MSAA_QUALITY.NONE){let X;_=Math.max(Math.ceil(_*E-1e-6),1),T=Math.max(Math.ceil(T*E-1e-6),1),!this.enableFullScreen||_!==this._pixelsWidth||T!==this._pixelsHeight?(_=nextPow2(_),T=nextPow2(T),X=((_&65535)<<16|T&65535)>>>0,W>1&&(X+=W*4294967296)):X=W>1?-W:-1,this.texturePool[X]||(this.texturePool[X]=[]);let q=this.texturePool[X].pop();return q||(q=this.createTexture(_,T,W)),q.filterPoolKey=X,q.setResolution(E),q}getFilterTexture(_,T,E){const W=this.getOptimalTexture(_.width,_.height,T||_.resolution,E||MSAA_QUALITY.NONE);return W.filterFrame=_.filterFrame,W}returnTexture(_){const T=_.filterPoolKey;_.filterFrame=null,this.texturePool[T].push(_)}returnFilterTexture(_){this.returnTexture(_)}clear(_){if(_=_!==!1,_)for(const T in this.texturePool){const E=this.texturePool[T];if(E)for(let W=0;W<E.length;W++)E[W].destroy(!0)}this.texturePool={}}setScreenSize(_){if(!(_.width===this._pixelsWidth&&_.height===this._pixelsHeight)){this.enableFullScreen=_.width>0&&_.height>0;for(const T in this.texturePool){if(!(Number(T)<0))continue;const E=this.texturePool[T];if(E)for(let W=0;W<E.length;W++)E[W].destroy(!0);this.texturePool[T]=[]}this._pixelsWidth=_.width,this._pixelsHeight=_.height}}}RenderTexturePool.SCREEN_KEY=-1;class Quad extends Geometry{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class QuadUv extends Geometry{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Buffer$1(this.vertices),this.uvBuffer=new Buffer$1(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(_,T){let E=0,W=0;return this.uvs[0]=E,this.uvs[1]=W,this.uvs[2]=E+T.width/_.width,this.uvs[3]=W,this.uvs[4]=E+T.width/_.width,this.uvs[5]=W+T.height/_.height,this.uvs[6]=E,this.uvs[7]=W+T.height/_.height,E=T.x,W=T.y,this.vertices[0]=E,this.vertices[1]=W,this.vertices[2]=E+T.width,this.vertices[3]=W,this.vertices[4]=E+T.width,this.vertices[5]=W+T.height,this.vertices[6]=E,this.vertices[7]=W+T.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class FilterState{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=MSAA_QUALITY.NONE,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const tempPoints=[new Point,new Point,new Point,new Point],tempMatrix$2=new Matrix;class FilterSystem{constructor(_){this.renderer=_,this.defaultFilterStack=[{}],this.texturePool=new RenderTexturePool,this.statePool=[],this.quad=new Quad,this.quadUv=new QuadUv,this.tempRect=new Rectangle,this.activeState={},this.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(_,T){const E=this.renderer,W=this.defaultFilterStack,X=this.statePool.pop()||new FilterState,q=E.renderTexture;let Y,te;if(q.current){const Te=q.current;Y=Te.resolution,te=Te.multisample}else Y=E.resolution,te=E.multisample;let ne=T[0].resolution||Y,ae=T[0].multisample??te,le=T[0].padding,ue=T[0].autoFit,ge=T[0].legacy??!0;for(let Te=1;Te<T.length;Te++){const Ae=T[Te];ne=Math.min(ne,Ae.resolution||Y),ae=Math.min(ae,Ae.multisample??te),le=this.useMaxPadding?Math.max(le,Ae.padding):le+Ae.padding,ue=ue&&Ae.autoFit,ge=ge||(Ae.legacy??!0)}W.length===1&&(this.defaultFilterStack[0].renderTexture=q.current),W.push(X),X.resolution=ne,X.multisample=ae,X.legacy=ge,X.target=_,X.sourceFrame.copyFrom(_.filterArea||_.getBounds(!0)),X.sourceFrame.pad(le);const ye=this.tempRect.copyFrom(q.sourceFrame);E.projection.transform&&this.transformAABB(tempMatrix$2.copyFrom(E.projection.transform).invert(),ye),ue?(X.sourceFrame.fit(ye),(X.sourceFrame.width<=0||X.sourceFrame.height<=0)&&(X.sourceFrame.width=0,X.sourceFrame.height=0)):X.sourceFrame.intersects(ye)||(X.sourceFrame.width=0,X.sourceFrame.height=0),this.roundFrame(X.sourceFrame,q.current?q.current.resolution:E.resolution,q.sourceFrame,q.destinationFrame,E.projection.transform),X.renderTexture=this.getOptimalFilterTexture(X.sourceFrame.width,X.sourceFrame.height,ne,ae),X.filters=T,X.destinationFrame.width=X.renderTexture.width,X.destinationFrame.height=X.renderTexture.height;const xe=this.tempRect;xe.x=0,xe.y=0,xe.width=X.sourceFrame.width,xe.height=X.sourceFrame.height,X.renderTexture.filterFrame=X.sourceFrame,X.bindingSourceFrame.copyFrom(q.sourceFrame),X.bindingDestinationFrame.copyFrom(q.destinationFrame),X.transform=E.projection.transform,E.projection.transform=null,q.bind(X.renderTexture,X.sourceFrame,xe),E.framebuffer.clear(0,0,0,0)}pop(){const _=this.defaultFilterStack,T=_.pop(),E=T.filters;this.activeState=T;const W=this.globalUniforms.uniforms;W.outputFrame=T.sourceFrame,W.resolution=T.resolution;const X=W.inputSize,q=W.inputPixel,Y=W.inputClamp;if(X[0]=T.destinationFrame.width,X[1]=T.destinationFrame.height,X[2]=1/X[0],X[3]=1/X[1],q[0]=Math.round(X[0]*T.resolution),q[1]=Math.round(X[1]*T.resolution),q[2]=1/q[0],q[3]=1/q[1],Y[0]=.5*q[2],Y[1]=.5*q[3],Y[2]=T.sourceFrame.width*X[2]-.5*q[2],Y[3]=T.sourceFrame.height*X[3]-.5*q[3],T.legacy){const ne=W.filterArea;ne[0]=T.destinationFrame.width,ne[1]=T.destinationFrame.height,ne[2]=T.sourceFrame.x,ne[3]=T.sourceFrame.y,W.filterClamp=W.inputClamp}this.globalUniforms.update();const te=_[_.length-1];if(this.renderer.framebuffer.blit(),E.length===1)E[0].apply(this,T.renderTexture,te.renderTexture,CLEAR_MODES.BLEND,T),this.returnFilterTexture(T.renderTexture);else{let ne=T.renderTexture,ae=this.getOptimalFilterTexture(ne.width,ne.height,T.resolution);ae.filterFrame=ne.filterFrame;let le=0;for(le=0;le<E.length-1;++le){le===1&&T.multisample>1&&(ae=this.getOptimalFilterTexture(ne.width,ne.height,T.resolution),ae.filterFrame=ne.filterFrame),E[le].apply(this,ne,ae,CLEAR_MODES.CLEAR,T);const ue=ne;ne=ae,ae=ue}E[le].apply(this,ne,te.renderTexture,CLEAR_MODES.BLEND,T),le>1&&T.multisample>1&&this.returnFilterTexture(T.renderTexture),this.returnFilterTexture(ne),this.returnFilterTexture(ae)}T.clear(),this.statePool.push(T)}bindAndClear(_,T=CLEAR_MODES.CLEAR){const{renderTexture:E,state:W}=this.renderer;if(_===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,_==null?void 0:_.filterFrame){const q=this.tempRect;q.x=0,q.y=0,q.width=_.filterFrame.width,q.height=_.filterFrame.height,E.bind(_,_.filterFrame,q)}else _!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?E.bind(_):this.renderer.renderTexture.bind(_,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const X=W.stateId&1||this.forceClear;(T===CLEAR_MODES.CLEAR||T===CLEAR_MODES.BLIT&&X)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(_,T,E,W){const X=this.renderer;X.state.set(_.state),this.bindAndClear(E,W),_.uniforms.uSampler=T,_.uniforms.filterGlobals=this.globalUniforms,X.shader.bind(_),_.legacy=!!_.program.attributeData.aTextureCoord,_.legacy?(this.quadUv.map(T._frame,T.filterFrame),X.geometry.bind(this.quadUv),X.geometry.draw(DRAW_MODES.TRIANGLES)):(X.geometry.bind(this.quad),X.geometry.draw(DRAW_MODES.TRIANGLE_STRIP))}calculateSpriteMatrix(_,T){const{sourceFrame:E,destinationFrame:W}=this.activeState,{orig:X}=T._texture,q=_.set(W.width,0,0,W.height,E.x,E.y),Y=T.worldTransform.copyTo(Matrix.TEMP_MATRIX);return Y.invert(),q.prepend(Y),q.scale(1/X.width,1/X.height),q.translate(T.anchor.x,T.anchor.y),q}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(_,T,E=1,W=MSAA_QUALITY.NONE){return this.texturePool.getOptimalTexture(_,T,E,W)}getFilterTexture(_,T,E){if(typeof _=="number"){const X=_;_=T,T=X}_=_||this.activeState.renderTexture;const W=this.texturePool.getOptimalTexture(_.width,_.height,T||_.resolution,E||MSAA_QUALITY.NONE);return W.filterFrame=_.filterFrame,W}returnFilterTexture(_){this.texturePool.returnTexture(_)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(_,T){const E=tempPoints[0],W=tempPoints[1],X=tempPoints[2],q=tempPoints[3];E.set(T.left,T.top),W.set(T.left,T.bottom),X.set(T.right,T.top),q.set(T.right,T.bottom),_.apply(E,E),_.apply(W,W),_.apply(X,X),_.apply(q,q);const Y=Math.min(E.x,W.x,X.x,q.x),te=Math.min(E.y,W.y,X.y,q.y),ne=Math.max(E.x,W.x,X.x,q.x),ae=Math.max(E.y,W.y,X.y,q.y);T.x=Y,T.y=te,T.width=ne-Y,T.height=ae-te}roundFrame(_,T,E,W,X){if(!(_.width<=0||_.height<=0||E.width<=0||E.height<=0)){if(X){const{a:q,b:Y,c:te,d:ne}=X;if((Math.abs(Y)>1e-4||Math.abs(te)>1e-4)&&(Math.abs(q)>1e-4||Math.abs(ne)>1e-4))return}X=X?tempMatrix$2.copyFrom(X):tempMatrix$2.identity(),X.translate(-E.x,-E.y).scale(W.width/E.width,W.height/E.height).translate(W.x,W.y),this.transformAABB(X,_),_.ceil(T),this.transformAABB(X.invert(),_)}}}FilterSystem.extension={type:ExtensionType.RendererSystem,name:"filter"};extensions$1.add(FilterSystem);class GLFramebuffer{constructor(_){this.framebuffer=_,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const tempRectangle=new Rectangle;class FramebufferSystem{constructor(_){this.renderer=_,this.managedFramebuffers=[],this.unknownFramebuffer=new Framebuffer(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const _=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let T=this.renderer.context.extensions.drawBuffers,E=this.renderer.context.extensions.depthTexture;settings.PREFER_ENV===ENV.WEBGL_LEGACY&&(T=null,E=null),T?_.drawBuffers=W=>T.drawBuffersWEBGL(W):(this.hasMRT=!1,_.drawBuffers=()=>{}),E||(this.writeDepthTexture=!1)}else this.msaaSamples=_.getInternalformatParameter(_.RENDERBUFFER,_.RGBA8,_.SAMPLES)}bind(_,T,E=0){const{gl:W}=this;if(_){const X=_.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(_);this.current!==_&&(this.current=_,W.bindFramebuffer(W.FRAMEBUFFER,X.framebuffer)),X.mipLevel!==E&&(_.dirtyId++,_.dirtyFormat++,X.mipLevel=E),X.dirtyId!==_.dirtyId&&(X.dirtyId=_.dirtyId,X.dirtyFormat!==_.dirtyFormat?(X.dirtyFormat=_.dirtyFormat,X.dirtySize=_.dirtySize,this.updateFramebuffer(_,E)):X.dirtySize!==_.dirtySize&&(X.dirtySize=_.dirtySize,this.resizeFramebuffer(_)));for(let q=0;q<_.colorTextures.length;q++){const Y=_.colorTextures[q];this.renderer.texture.unbind(Y.parentTextureArray||Y)}if(_.depthTexture&&this.renderer.texture.unbind(_.depthTexture),T){const q=T.width>>E,Y=T.height>>E,te=q/T.width;this.setViewport(T.x*te,T.y*te,q,Y)}else{const q=_.width>>E,Y=_.height>>E;this.setViewport(0,0,q,Y)}}else this.current&&(this.current=null,W.bindFramebuffer(W.FRAMEBUFFER,null)),T?this.setViewport(T.x,T.y,T.width,T.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(_,T,E,W){const X=this.viewport;_=Math.round(_),T=Math.round(T),E=Math.round(E),W=Math.round(W),(X.width!==E||X.height!==W||X.x!==_||X.y!==T)&&(X.x=_,X.y=T,X.width=E,X.height=W,this.gl.viewport(_,T,E,W))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(_,T,E,W,X=BUFFER_BITS.COLOR|BUFFER_BITS.DEPTH){const{gl:q}=this;q.clearColor(_,T,E,W),q.clear(X)}initFramebuffer(_){const{gl:T}=this,E=new GLFramebuffer(T.createFramebuffer());return E.multisample=this.detectSamples(_.multisample),_.glFramebuffers[this.CONTEXT_UID]=E,this.managedFramebuffers.push(_),_.disposeRunner.add(this),E}resizeFramebuffer(_){const{gl:T}=this,E=_.glFramebuffers[this.CONTEXT_UID];if(E.stencil){T.bindRenderbuffer(T.RENDERBUFFER,E.stencil);let q;this.renderer.context.webGLVersion===1?q=T.DEPTH_STENCIL:_.depth&&_.stencil?q=T.DEPTH24_STENCIL8:_.depth?q=T.DEPTH_COMPONENT24:q=T.STENCIL_INDEX8,E.msaaBuffer?T.renderbufferStorageMultisample(T.RENDERBUFFER,E.multisample,q,_.width,_.height):T.renderbufferStorage(T.RENDERBUFFER,q,_.width,_.height)}const W=_.colorTextures;let X=W.length;T.drawBuffers||(X=Math.min(X,1));for(let q=0;q<X;q++){const Y=W[q],te=Y.parentTextureArray||Y;this.renderer.texture.bind(te,0),q===0&&E.msaaBuffer&&(T.bindRenderbuffer(T.RENDERBUFFER,E.msaaBuffer),T.renderbufferStorageMultisample(T.RENDERBUFFER,E.multisample,te._glTextures[this.CONTEXT_UID].internalFormat,_.width,_.height))}_.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(_.depthTexture,0)}updateFramebuffer(_,T){const{gl:E}=this,W=_.glFramebuffers[this.CONTEXT_UID],X=_.colorTextures;let q=X.length;E.drawBuffers||(q=Math.min(q,1)),W.multisample>1&&this.canMultisampleFramebuffer(_)?W.msaaBuffer=W.msaaBuffer||E.createRenderbuffer():W.msaaBuffer&&(E.deleteRenderbuffer(W.msaaBuffer),W.msaaBuffer=null,W.blitFramebuffer&&(W.blitFramebuffer.dispose(),W.blitFramebuffer=null));const Y=[];for(let te=0;te<q;te++){const ne=X[te],ae=ne.parentTextureArray||ne;this.renderer.texture.bind(ae,0),te===0&&W.msaaBuffer?(E.bindRenderbuffer(E.RENDERBUFFER,W.msaaBuffer),E.renderbufferStorageMultisample(E.RENDERBUFFER,W.multisample,ae._glTextures[this.CONTEXT_UID].internalFormat,_.width,_.height),E.framebufferRenderbuffer(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.RENDERBUFFER,W.msaaBuffer)):(E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0+te,ne.target,ae._glTextures[this.CONTEXT_UID].texture,T),Y.push(E.COLOR_ATTACHMENT0+te))}if(Y.length>1&&E.drawBuffers(Y),_.depthTexture&&this.writeDepthTexture){const te=_.depthTexture;this.renderer.texture.bind(te,0),E.framebufferTexture2D(E.FRAMEBUFFER,E.DEPTH_ATTACHMENT,E.TEXTURE_2D,te._glTextures[this.CONTEXT_UID].texture,T)}if((_.stencil||_.depth)&&!(_.depthTexture&&this.writeDepthTexture)){W.stencil=W.stencil||E.createRenderbuffer();let te,ne;this.renderer.context.webGLVersion===1?(te=E.DEPTH_STENCIL_ATTACHMENT,ne=E.DEPTH_STENCIL):_.depth&&_.stencil?(te=E.DEPTH_STENCIL_ATTACHMENT,ne=E.DEPTH24_STENCIL8):_.depth?(te=E.DEPTH_ATTACHMENT,ne=E.DEPTH_COMPONENT24):(te=E.STENCIL_ATTACHMENT,ne=E.STENCIL_INDEX8),E.bindRenderbuffer(E.RENDERBUFFER,W.stencil),W.msaaBuffer?E.renderbufferStorageMultisample(E.RENDERBUFFER,W.multisample,ne,_.width,_.height):E.renderbufferStorage(E.RENDERBUFFER,ne,_.width,_.height),E.framebufferRenderbuffer(E.FRAMEBUFFER,te,E.RENDERBUFFER,W.stencil)}else W.stencil&&(E.deleteRenderbuffer(W.stencil),W.stencil=null)}canMultisampleFramebuffer(_){return this.renderer.context.webGLVersion!==1&&_.colorTextures.length<=1&&!_.depthTexture}detectSamples(_){const{msaaSamples:T}=this;let E=MSAA_QUALITY.NONE;if(_<=1||T===null)return E;for(let W=0;W<T.length;W++)if(T[W]<=_){E=T[W];break}return E===1&&(E=MSAA_QUALITY.NONE),E}blit(_,T,E){const{current:W,renderer:X,gl:q,CONTEXT_UID:Y}=this;if(X.context.webGLVersion!==2||!W)return;const te=W.glFramebuffers[Y];if(!te)return;if(!_){if(!te.msaaBuffer)return;const ae=W.colorTextures[0];if(!ae)return;te.blitFramebuffer||(te.blitFramebuffer=new Framebuffer(W.width,W.height),te.blitFramebuffer.addColorTexture(0,ae)),_=te.blitFramebuffer,_.colorTextures[0]!==ae&&(_.colorTextures[0]=ae,_.dirtyId++,_.dirtyFormat++),(_.width!==W.width||_.height!==W.height)&&(_.width=W.width,_.height=W.height,_.dirtyId++,_.dirtySize++)}T||(T=tempRectangle,T.width=W.width,T.height=W.height),E||(E=T);const ne=T.width===E.width&&T.height===E.height;this.bind(_),q.bindFramebuffer(q.READ_FRAMEBUFFER,te.framebuffer),q.blitFramebuffer(T.left,T.top,T.right,T.bottom,E.left,E.top,E.right,E.bottom,q.COLOR_BUFFER_BIT,ne?q.NEAREST:q.LINEAR),q.bindFramebuffer(q.READ_FRAMEBUFFER,_.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(_,T){const E=_.glFramebuffers[this.CONTEXT_UID],W=this.gl;if(!E)return;delete _.glFramebuffers[this.CONTEXT_UID];const X=this.managedFramebuffers.indexOf(_);X>=0&&this.managedFramebuffers.splice(X,1),_.disposeRunner.remove(this),T||(W.deleteFramebuffer(E.framebuffer),E.msaaBuffer&&W.deleteRenderbuffer(E.msaaBuffer),E.stencil&&W.deleteRenderbuffer(E.stencil)),E.blitFramebuffer&&this.disposeFramebuffer(E.blitFramebuffer,T)}disposeAll(_){const T=this.managedFramebuffers;this.managedFramebuffers=[];for(let E=0;E<T.length;E++)this.disposeFramebuffer(T[E],_)}forceStencil(){const _=this.current;if(!_)return;const T=_.glFramebuffers[this.CONTEXT_UID];if(!T||T.stencil&&_.stencil)return;_.stencil=!0;const E=_.width,W=_.height,X=this.gl,q=T.stencil=X.createRenderbuffer();X.bindRenderbuffer(X.RENDERBUFFER,q);let Y,te;this.renderer.context.webGLVersion===1?(Y=X.DEPTH_STENCIL_ATTACHMENT,te=X.DEPTH_STENCIL):_.depth?(Y=X.DEPTH_STENCIL_ATTACHMENT,te=X.DEPTH24_STENCIL8):(Y=X.STENCIL_ATTACHMENT,te=X.STENCIL_INDEX8),T.msaaBuffer?X.renderbufferStorageMultisample(X.RENDERBUFFER,T.multisample,te,E,W):X.renderbufferStorage(X.RENDERBUFFER,te,E,W),X.framebufferRenderbuffer(X.FRAMEBUFFER,Y,X.RENDERBUFFER,q)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle}destroy(){this.renderer=null}}FramebufferSystem.extension={type:ExtensionType.RendererSystem,name:"framebuffer"};extensions$1.add(FramebufferSystem);const byteSizeMap={5126:4,5123:2,5121:1};class GeometrySystem{constructor(_){this.renderer=_,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const _=this.gl=this.renderer.gl,T=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,T.webGLVersion!==2){let E=this.renderer.context.extensions.vertexArrayObject;settings.PREFER_ENV===ENV.WEBGL_LEGACY&&(E=null),E?(_.createVertexArray=()=>E.createVertexArrayOES(),_.bindVertexArray=W=>E.bindVertexArrayOES(W),_.deleteVertexArray=W=>E.deleteVertexArrayOES(W)):(this.hasVao=!1,_.createVertexArray=()=>null,_.bindVertexArray=()=>null,_.deleteVertexArray=()=>null)}if(T.webGLVersion!==2){const E=_.getExtension("ANGLE_instanced_arrays");E?(_.vertexAttribDivisor=(W,X)=>E.vertexAttribDivisorANGLE(W,X),_.drawElementsInstanced=(W,X,q,Y,te)=>E.drawElementsInstancedANGLE(W,X,q,Y,te),_.drawArraysInstanced=(W,X,q,Y)=>E.drawArraysInstancedANGLE(W,X,q,Y)):this.hasInstance=!1}this.canUseUInt32ElementIndex=T.webGLVersion===2||!!T.extensions.uint32ElementIndex}bind(_,T){T=T||this.renderer.shader.shader;const{gl:E}=this;let W=_.glVertexArrayObjects[this.CONTEXT_UID],X=!1;W||(this.managedGeometries[_.id]=_,_.disposeRunner.add(this),_.glVertexArrayObjects[this.CONTEXT_UID]=W={},X=!0);const q=W[T.program.id]||this.initGeometryVao(_,T,X);this._activeGeometry=_,this._activeVao!==q&&(this._activeVao=q,this.hasVao?E.bindVertexArray(q):this.activateVao(_,T.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const _=this._activeGeometry,T=this.renderer.buffer;for(let E=0;E<_.buffers.length;E++){const W=_.buffers[E];T.update(W)}}checkCompatibility(_,T){const E=_.attributes,W=T.attributeData;for(const X in W)if(!E[X])throw new Error(`shader and geometry incompatible, geometry missing the "${X}" attribute`)}getSignature(_,T){const E=_.attributes,W=T.attributeData,X=["g",_.id];for(const q in E)W[q]&&X.push(q,W[q].location);return X.join("-")}initGeometryVao(_,T,E=!0){const W=this.gl,X=this.CONTEXT_UID,q=this.renderer.buffer,Y=T.program;Y.glPrograms[X]||this.renderer.shader.generateProgram(T),this.checkCompatibility(_,Y);const te=this.getSignature(_,Y),ne=_.glVertexArrayObjects[this.CONTEXT_UID];let ae=ne[te];if(ae)return ne[Y.id]=ae,ae;const le=_.buffers,ue=_.attributes,ge={},ye={};for(const xe in le)ge[xe]=0,ye[xe]=0;for(const xe in ue)!ue[xe].size&&Y.attributeData[xe]?ue[xe].size=Y.attributeData[xe].size:ue[xe].size||console.warn(`PIXI Geometry attribute '${xe}' size cannot be determined (likely the bound shader does not have the attribute)`),ge[ue[xe].buffer]+=ue[xe].size*byteSizeMap[ue[xe].type];for(const xe in ue){const Te=ue[xe],Ae=Te.size;Te.stride===void 0&&(ge[Te.buffer]===Ae*byteSizeMap[Te.type]?Te.stride=0:Te.stride=ge[Te.buffer]),Te.start===void 0&&(Te.start=ye[Te.buffer],ye[Te.buffer]+=Ae*byteSizeMap[Te.type])}ae=W.createVertexArray(),W.bindVertexArray(ae);for(let xe=0;xe<le.length;xe++){const Te=le[xe];q.bind(Te),E&&Te._glBuffers[X].refCount++}return this.activateVao(_,Y),ne[Y.id]=ae,ne[te]=ae,W.bindVertexArray(null),q.unbind(BUFFER_TYPE.ARRAY_BUFFER),ae}disposeGeometry(_,T){var Y;if(!this.managedGeometries[_.id])return;delete this.managedGeometries[_.id];const E=_.glVertexArrayObjects[this.CONTEXT_UID],W=this.gl,X=_.buffers,q=(Y=this.renderer)==null?void 0:Y.buffer;if(_.disposeRunner.remove(this),!!E){if(q)for(let te=0;te<X.length;te++){const ne=X[te]._glBuffers[this.CONTEXT_UID];ne&&(ne.refCount--,ne.refCount===0&&!T&&q.dispose(X[te],T))}if(!T){for(const te in E)if(te[0]==="g"){const ne=E[te];this._activeVao===ne&&this.unbind(),W.deleteVertexArray(ne)}}delete _.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(_){const T=Object.keys(this.managedGeometries);for(let E=0;E<T.length;E++)this.disposeGeometry(this.managedGeometries[T[E]],_)}activateVao(_,T){const E=this.gl,W=this.CONTEXT_UID,X=this.renderer.buffer,q=_.buffers,Y=_.attributes;_.indexBuffer&&X.bind(_.indexBuffer);let te=null;for(const ne in Y){const ae=Y[ne],le=q[ae.buffer],ue=le._glBuffers[W];if(T.attributeData[ne]){te!==ue&&(X.bind(le),te=ue);const ge=T.attributeData[ne].location;if(E.enableVertexAttribArray(ge),E.vertexAttribPointer(ge,ae.size,ae.type||E.FLOAT,ae.normalized,ae.stride,ae.start),ae.instance)if(this.hasInstance)E.vertexAttribDivisor(ge,ae.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(_,T,E,W){const{gl:X}=this,q=this._activeGeometry;if(q.indexBuffer){const Y=q.indexBuffer.data.BYTES_PER_ELEMENT,te=Y===2?X.UNSIGNED_SHORT:X.UNSIGNED_INT;Y===2||Y===4&&this.canUseUInt32ElementIndex?q.instanced?X.drawElementsInstanced(_,T||q.indexBuffer.data.length,te,(E||0)*Y,W||1):X.drawElements(_,T||q.indexBuffer.data.length,te,(E||0)*Y):console.warn("unsupported index buffer type: uint32")}else q.instanced?X.drawArraysInstanced(_,E,T||q.getSize(),W||1):X.drawArrays(_,E,T||q.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}GeometrySystem.extension={type:ExtensionType.RendererSystem,name:"geometry"};extensions$1.add(GeometrySystem);const tempMat$1=new Matrix;class TextureMatrix{constructor(_,T){this._texture=_,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof T>"u"?.5:T,this.isSimple=!1}get texture(){return this._texture}set texture(_){this._texture=_,this._textureID=-1}multiplyUvs(_,T){T===void 0&&(T=_);const E=this.mapCoord;for(let W=0;W<_.length;W+=2){const X=_[W],q=_[W+1];T[W]=X*E.a+q*E.c+E.tx,T[W+1]=X*E.b+q*E.d+E.ty}return T}update(_){const T=this._texture;if(!T||!T.valid||!_&&this._textureID===T._updateID)return!1;this._textureID=T._updateID,this._updateID++;const E=T._uvs;this.mapCoord.set(E.x1-E.x0,E.y1-E.y0,E.x3-E.x0,E.y3-E.y0,E.x0,E.y0);const W=T.orig,X=T.trim;X&&(tempMat$1.set(W.width/X.width,0,0,W.height/X.height,-X.x/X.width,-X.y/X.height),this.mapCoord.append(tempMat$1));const q=T.baseTexture,Y=this.uClampFrame,te=this.clampMargin/q.resolution,ne=this.clampOffset;return Y[0]=(T._frame.x+te+ne)/q.width,Y[1]=(T._frame.y+te+ne)/q.height,Y[2]=(T._frame.x+T._frame.width-te+ne)/q.width,Y[3]=(T._frame.y+T._frame.height-te+ne)/q.height,this.uClampOffset[0]=ne/q.realWidth,this.uClampOffset[1]=ne/q.realHeight,this.isSimple=T._frame.width===q.width&&T._frame.height===q.height&&T.rotate===0,!0}}var fragment$q=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,vertex$n=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class SpriteMaskFilter extends Filter{constructor(_,T,E){let W=null;typeof _!="string"&&T===void 0&&E===void 0&&(W=_,_=void 0,T=void 0,E=void 0),super(_||vertex$n,T||fragment$q,E),this.maskSprite=W,this.maskMatrix=new Matrix}get maskSprite(){return this._maskSprite}set maskSprite(_){this._maskSprite=_,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(_,T,E,W){const X=this._maskSprite,q=X._texture;q.valid&&(q.uvMatrix||(q.uvMatrix=new TextureMatrix(q,0)),q.uvMatrix.update(),this.uniforms.npmAlpha=q.baseTexture.alphaMode?0:1,this.uniforms.mask=q,this.uniforms.otherMatrix=_.calculateSpriteMatrix(this.maskMatrix,X).prepend(q.uvMatrix.mapCoord),this.uniforms.alpha=X.worldAlpha,this.uniforms.maskClamp=q.uvMatrix.uClampFrame,_.applyFilter(this,T,E,W))}}class MaskData{constructor(_=null){this.type=MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=_||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Filter.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(_){_?this._filters?this._filters[0]=_:this._filters=[_]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(_){_?(this._stencilCounter=_._stencilCounter,this._scissorCounter=_._scissorCounter,this._scissorRect=_._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class MaskSystem{constructor(_){this.renderer=_,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(_){this.maskStack=_,this.renderer.scissor.setMaskStack(_),this.renderer.stencil.setMaskStack(_)}push(_,T){let E=T;if(!E.isMaskData){const X=this.maskDataPool.pop()||new MaskData;X.pooled=!0,X.maskObject=T,E=X}const W=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(E.copyCountersOrReset(W),E._colorMask=W?W._colorMask:15,E.autoDetect&&this.detect(E),E._target=_,E.type!==MASK_TYPES.SPRITE&&this.maskStack.push(E),E.enabled)switch(E.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.push(E);break;case MASK_TYPES.STENCIL:this.renderer.stencil.push(E);break;case MASK_TYPES.SPRITE:E.copyCountersOrReset(null),this.pushSpriteMask(E);break;case MASK_TYPES.COLOR:this.pushColorMask(E);break}E.type===MASK_TYPES.SPRITE&&this.maskStack.push(E)}pop(_){const T=this.maskStack.pop();if(!(!T||T._target!==_)){if(T.enabled)switch(T.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.pop(T);break;case MASK_TYPES.STENCIL:this.renderer.stencil.pop(T.maskObject);break;case MASK_TYPES.SPRITE:this.popSpriteMask(T);break;case MASK_TYPES.COLOR:this.popColorMask(T);break}if(T.reset(),T.pooled&&this.maskDataPool.push(T),this.maskStack.length!==0){const E=this.maskStack[this.maskStack.length-1];E.type===MASK_TYPES.SPRITE&&E._filters&&(E._filters[0].maskSprite=E.maskObject)}}}detect(_){const T=_.maskObject;T?T.isSprite?_.type=MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(_)?_.type=MASK_TYPES.SCISSOR:_.type=MASK_TYPES.STENCIL:_.type=MASK_TYPES.COLOR}pushSpriteMask(_){const{maskObject:T}=_,E=_._target;let W=_._filters;W||(W=this.alphaMaskPool[this.alphaMaskIndex],W||(W=this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter])),W[0].resolution=_.resolution,W[0].multisample=_.multisample,W[0].maskSprite=T;const X=E.filterArea;E.filterArea=T.getBounds(!0),this.renderer.filter.push(E,W),E.filterArea=X,_._filters||this.alphaMaskIndex++}popSpriteMask(_){this.renderer.filter.pop(),_._filters?_._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(_){const T=_._colorMask,E=_._colorMask=T&_.colorMask;E!==T&&this.renderer.gl.colorMask((E&1)!==0,(E&2)!==0,(E&4)!==0,(E&8)!==0)}popColorMask(_){const T=_._colorMask,E=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;E!==T&&this.renderer.gl.colorMask((E&1)!==0,(E&2)!==0,(E&4)!==0,(E&8)!==0)}destroy(){this.renderer=null}}MaskSystem.extension={type:ExtensionType.RendererSystem,name:"mask"};extensions$1.add(MaskSystem);class AbstractMaskSystem{constructor(_){this.renderer=_,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(_){const{gl:T}=this.renderer,E=this.getStackLength();this.maskStack=_;const W=this.getStackLength();W!==E&&(W===0?T.disable(this.glConst):(T.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const tempMatrix$1=new Matrix,rectPool=[],_ScissorSystem=class yu extends AbstractMaskSystem{constructor(_){super(_),this.glConst=settings.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const _=this.maskStack[this.maskStack.length-1];return _?_._scissorCounter:0}calcScissorRect(_){if(_._scissorRectLocal)return;const T=_._scissorRect,{maskObject:E}=_,{renderer:W}=this,X=W.renderTexture,q=E.getBounds(!0,rectPool.pop()??new Rectangle);this.roundFrameToPixels(q,X.current?X.current.resolution:W.resolution,X.sourceFrame,X.destinationFrame,W.projection.transform),T&&q.fit(T),_._scissorRectLocal=q}static isMatrixRotated(_){if(!_)return!1;const{a:T,b:E,c:W,d:X}=_;return(Math.abs(E)>1e-4||Math.abs(W)>1e-4)&&(Math.abs(T)>1e-4||Math.abs(X)>1e-4)}testScissor(_){const{maskObject:T}=_;if(!T.isFastRect||!T.isFastRect()||yu.isMatrixRotated(T.worldTransform)||yu.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(_);const E=_._scissorRectLocal;return E.width>0&&E.height>0}roundFrameToPixels(_,T,E,W,X){yu.isMatrixRotated(X)||(X=X?tempMatrix$1.copyFrom(X):tempMatrix$1.identity(),X.translate(-E.x,-E.y).scale(W.width/E.width,W.height/E.height).translate(W.x,W.y),this.renderer.filter.transformAABB(X,_),_.fit(W),_.x=Math.round(_.x*T),_.y=Math.round(_.y*T),_.width=Math.round(_.width*T),_.height=Math.round(_.height*T))}push(_){_._scissorRectLocal||this.calcScissorRect(_);const{gl:T}=this.renderer;_._scissorRect||T.enable(T.SCISSOR_TEST),_._scissorCounter++,_._scissorRect=_._scissorRectLocal,this._useCurrent()}pop(_){const{gl:T}=this.renderer;_&&rectPool.push(_._scissorRectLocal),this.getStackLength()>0?this._useCurrent():T.disable(T.SCISSOR_TEST)}_useCurrent(){const _=this.maskStack[this.maskStack.length-1]._scissorRect;let T;this.renderer.renderTexture.current?T=_.y:T=this.renderer.height-_.height-_.y,this.renderer.gl.scissor(_.x,T,_.width,_.height)}};_ScissorSystem.extension={type:ExtensionType.RendererSystem,name:"scissor"};let ScissorSystem=_ScissorSystem;extensions$1.add(ScissorSystem);class StencilSystem extends AbstractMaskSystem{constructor(_){super(_),this.glConst=settings.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const _=this.maskStack[this.maskStack.length-1];return _?_._stencilCounter:0}push(_){const T=_.maskObject,{gl:E}=this.renderer,W=_._stencilCounter;W===0&&(this.renderer.framebuffer.forceStencil(),E.clearStencil(0),E.clear(E.STENCIL_BUFFER_BIT),E.enable(E.STENCIL_TEST)),_._stencilCounter++;const X=_._colorMask;X!==0&&(_._colorMask=0,E.colorMask(!1,!1,!1,!1)),E.stencilFunc(E.EQUAL,W,4294967295),E.stencilOp(E.KEEP,E.KEEP,E.INCR),T.renderable=!0,T.render(this.renderer),this.renderer.batch.flush(),T.renderable=!1,X!==0&&(_._colorMask=X,E.colorMask((X&1)!==0,(X&2)!==0,(X&4)!==0,(X&8)!==0)),this._useCurrent()}pop(_){const T=this.renderer.gl;if(this.getStackLength()===0)T.disable(T.STENCIL_TEST);else{const E=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,W=E?E._colorMask:15;W!==0&&(E._colorMask=0,T.colorMask(!1,!1,!1,!1)),T.stencilOp(T.KEEP,T.KEEP,T.DECR),_.renderable=!0,_.render(this.renderer),this.renderer.batch.flush(),_.renderable=!1,W!==0&&(E._colorMask=W,T.colorMask((W&1)!==0,(W&2)!==0,(W&4)!==0,(W&8)!==0)),this._useCurrent()}}_useCurrent(){const _=this.renderer.gl;_.stencilFunc(_.EQUAL,this.getStackLength(),4294967295),_.stencilOp(_.KEEP,_.KEEP,_.KEEP)}}StencilSystem.extension={type:ExtensionType.RendererSystem,name:"stencil"};extensions$1.add(StencilSystem);class PluginSystem{constructor(_){this.renderer=_,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),_.extract}},prepare:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),_.prepare}},interaction:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),_.events}}})}init(){const _=this.rendererPlugins;for(const T in _)this.plugins[T]=new _[T](this.renderer)}destroy(){for(const _ in this.plugins)this.plugins[_].destroy(),this.plugins[_]=null}}PluginSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_plugin"};extensions$1.add(PluginSystem);class ProjectionSystem{constructor(_){this.renderer=_,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Matrix,this.transform=null}update(_,T,E,W){this.destinationFrame=_||this.destinationFrame||this.defaultFrame,this.sourceFrame=T||this.sourceFrame||_,this.calculateProjection(this.destinationFrame,this.sourceFrame,E,W),this.transform&&this.projectionMatrix.append(this.transform);const X=this.renderer;X.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,X.globalUniforms.update(),X.shader.shader&&X.shader.syncUniformGroup(X.shader.shader.uniforms.globals)}calculateProjection(_,T,E,W){const X=this.projectionMatrix,q=W?-1:1;X.identity(),X.a=1/T.width*2,X.d=q*(1/T.height*2),X.tx=-1-T.x*X.a,X.ty=-q-T.y*X.d}setTransform(_){}destroy(){this.renderer=null}}ProjectionSystem.extension={type:ExtensionType.RendererSystem,name:"projection"};extensions$1.add(ProjectionSystem);const tempTransform=new Transform$1,tempRect$1=new Rectangle;class GenerateTextureSystem{constructor(_){this.renderer=_,this._tempMatrix=new Matrix}generateTexture(_,T){const{region:E,...W}=T||{},X=(E==null?void 0:E.copyTo(tempRect$1))||_.getLocalBounds(tempRect$1,!0),q=W.resolution||this.renderer.resolution;X.width=Math.max(X.width,1/q),X.height=Math.max(X.height,1/q),W.width=X.width,W.height=X.height,W.resolution=q,W.multisample??(W.multisample=this.renderer.multisample);const Y=RenderTexture.create(W);this._tempMatrix.tx=-X.x,this._tempMatrix.ty=-X.y;const te=_.transform;return _.transform=tempTransform,this.renderer.render(_,{renderTexture:Y,transform:this._tempMatrix,skipUpdateTransform:!!_.parent,blit:!0}),_.transform=te,Y}destroy(){}}GenerateTextureSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"textureGenerator"};extensions$1.add(GenerateTextureSystem);const tempRect=new Rectangle,tempRect2=new Rectangle;class RenderTextureSystem{constructor(_){this.renderer=_,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.viewportFrame=new Rectangle}contextChange(){var T;const _=(T=this.renderer)==null?void 0:T.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(_&&_.alpha&&_.premultipliedAlpha)}bind(_=null,T,E){const W=this.renderer;this.current=_;let X,q,Y;_?(X=_.baseTexture,Y=X.resolution,T||(tempRect.width=_.frame.width,tempRect.height=_.frame.height,T=tempRect),E||(tempRect2.x=_.frame.x,tempRect2.y=_.frame.y,tempRect2.width=T.width,tempRect2.height=T.height,E=tempRect2),q=X.framebuffer):(Y=W.resolution,T||(tempRect.width=W._view.screen.width,tempRect.height=W._view.screen.height,T=tempRect),E||(E=tempRect,E.width=T.width,E.height=T.height));const te=this.viewportFrame;te.x=E.x*Y,te.y=E.y*Y,te.width=E.width*Y,te.height=E.height*Y,_||(te.y=W.view.height-(te.y+te.height)),te.ceil(),this.renderer.framebuffer.bind(q,te),this.renderer.projection.update(E,T,Y,!q),_?this.renderer.mask.setMaskStack(X.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(T),this.destinationFrame.copyFrom(E)}clear(_,T){const E=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,W=Color$1.shared.setValue(_||E);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&W.premultiply(W.alpha);const X=this.destinationFrame,q=this.current?this.current.baseTexture:this.renderer._view.screen,Y=X.width!==q.width||X.height!==q.height;if(Y){let{x:te,y:ne,width:ae,height:le}=this.viewportFrame;te=Math.round(te),ne=Math.round(ne),ae=Math.round(ae),le=Math.round(le),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(te,ne,ae,le)}this.renderer.framebuffer.clear(W.red,W.green,W.blue,W.alpha,T),Y&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}RenderTextureSystem.extension={type:ExtensionType.RendererSystem,name:"renderTexture"};extensions$1.add(RenderTextureSystem);class GLProgram{constructor(_,T){this.program=_,this.uniformData=T,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function getAttributeData(B,_){const T={},E=_.getProgramParameter(B,_.ACTIVE_ATTRIBUTES);for(let W=0;W<E;W++){const X=_.getActiveAttrib(B,W);if(X.name.startsWith("gl_"))continue;const q=mapType(_,X.type),Y={type:q,name:X.name,size:mapSize(q),location:_.getAttribLocation(B,X.name)};T[X.name]=Y}return T}function getUniformData(B,_){const T={},E=_.getProgramParameter(B,_.ACTIVE_UNIFORMS);for(let W=0;W<E;W++){const X=_.getActiveUniform(B,W),q=X.name.replace(/\[.*?\]$/,""),Y=!!X.name.match(/\[.*?\]$/),te=mapType(_,X.type);T[q]={name:q,index:W,type:te,size:X.size,isArray:Y,value:defaultValue(te,X.size)}}return T}function generateProgram(B,_){var Y;const T=compileShader(B,B.VERTEX_SHADER,_.vertexSrc),E=compileShader(B,B.FRAGMENT_SHADER,_.fragmentSrc),W=B.createProgram();B.attachShader(W,T),B.attachShader(W,E);const X=(Y=_.extra)==null?void 0:Y.transformFeedbackVaryings;if(X&&(typeof B.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):B.transformFeedbackVaryings(W,X.names,X.bufferMode==="separate"?B.SEPARATE_ATTRIBS:B.INTERLEAVED_ATTRIBS)),B.linkProgram(W),B.getProgramParameter(W,B.LINK_STATUS)||logProgramError(B,W,T,E),_.attributeData=getAttributeData(W,B),_.uniformData=getUniformData(W,B),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(_.vertexSrc)){const te=Object.keys(_.attributeData);te.sort((ne,ae)=>ne>ae?1:-1);for(let ne=0;ne<te.length;ne++)_.attributeData[te[ne]].location=ne,B.bindAttribLocation(W,ne,te[ne]);B.linkProgram(W)}B.deleteShader(T),B.deleteShader(E);const q={};for(const te in _.uniformData){const ne=_.uniformData[te];q[te]={location:B.getUniformLocation(W,te),value:defaultValue(ne.type,ne.size)}}return new GLProgram(W,q)}function uboUpdate(B,_,T,E,W){T.buffer.update(W)}const UBO_TO_SINGLE_SETTERS={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},GLSL_TO_STD40_SIZE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function createUBOElements(B){const _=B.map(X=>({data:X,offset:0,dataLen:0,dirty:0}));let T=0,E=0,W=0;for(let X=0;X<_.length;X++){const q=_[X];if(T=GLSL_TO_STD40_SIZE[q.data.type],q.data.size>1&&(T=Math.max(T,16)*q.data.size),q.dataLen=T,E%T!==0&&E<16){const Y=E%T%16;E+=Y,W+=Y}E+T>16?(W=Math.ceil(W/16)*16,q.offset=W,W+=T,E=T):(q.offset=W,E+=T,W+=T)}return W=Math.ceil(W/16)*16,{uboElements:_,size:W}}function getUBOData(B,_){const T=[];for(const E in B)_[E]&&T.push(_[E]);return T.sort((E,W)=>E.index-W.index),T}function generateUniformBufferSync(B,_){if(!B.autoManage)return{size:0,syncFunc:uboUpdate};const T=getUBOData(B.uniforms,_),{uboElements:E,size:W}=createUBOElements(T),X=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let q=0;q<E.length;q++){const Y=E[q],te=B.uniforms[Y.data.name],ne=Y.data.name;let ae=!1;for(let le=0;le<uniformParsers.length;le++){const ue=uniformParsers[le];if(ue.codeUbo&&ue.test(Y.data,te)){X.push(`offset = ${Y.offset/4};`,uniformParsers[le].codeUbo(Y.data.name,te)),ae=!0;break}}if(!ae)if(Y.data.size>1){const le=mapSize(Y.data.type),ue=Math.max(GLSL_TO_STD40_SIZE[Y.data.type]/16,1),ge=le/ue,ye=(4-ge%4)%4;X.push(`
                cv = ud.${ne}.value;
                v = uv.${ne};
                offset = ${Y.offset/4};

                t = 0;

                for(var i=0; i < ${Y.data.size*ue}; i++)
                {
                    for(var j = 0; j < ${ge}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${ye};
                }

                `)}else{const le=UBO_TO_SINGLE_SETTERS[Y.data.type];X.push(`
                cv = ud.${ne}.value;
                v = uv.${ne};
                offset = ${Y.offset/4};
                ${le};
                `)}}return X.push(`
       renderer.buffer.update(buffer);
    `),{size:W,syncFunc:new Function("ud","uv","renderer","syncData","buffer",X.join(`
`))}}let UID=0;const defaultSyncData={textureCount:0,uboCount:0};class ShaderSystem{constructor(_){this.destroyed=!1,this.renderer=_,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=UID++}systemCheck(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(_){this.gl=_,this.reset()}bind(_,T){_.disposeRunner.add(this),_.uniforms.globals=this.renderer.globalUniforms;const E=_.program,W=E.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(_);return this.shader=_,this.program!==E&&(this.program=E,this.gl.useProgram(W.program)),T||(defaultSyncData.textureCount=0,defaultSyncData.uboCount=0,this.syncUniformGroup(_.uniformGroup,defaultSyncData)),W}setUniforms(_){const T=this.shader.program,E=T.glPrograms[this.renderer.CONTEXT_UID];T.syncUniforms(E.uniformData,_,this.renderer)}syncUniformGroup(_,T){const E=this.getGlProgram();(!_.static||_.dirtyId!==E.uniformDirtyGroups[_.id])&&(E.uniformDirtyGroups[_.id]=_.dirtyId,this.syncUniforms(_,E,T))}syncUniforms(_,T,E){(_.syncUniforms[this.shader.program.id]||this.createSyncGroups(_))(T.uniformData,_.uniforms,this.renderer,E)}createSyncGroups(_){const T=this.getSignature(_,this.shader.program.uniformData,"u");return this.cache[T]||(this.cache[T]=generateUniformsSync(_,this.shader.program.uniformData)),_.syncUniforms[this.shader.program.id]=this.cache[T],_.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(_,T){const E=this.getGlProgram();if(!_.static||_.dirtyId!==0||!E.uniformGroups[_.id]){_.dirtyId=0;const W=E.uniformGroups[_.id]||this.createSyncBufferGroup(_,E,T);_.buffer.update(),W(E.uniformData,_.uniforms,this.renderer,defaultSyncData,_.buffer)}this.renderer.buffer.bindBufferBase(_.buffer,E.uniformBufferBindings[T])}createSyncBufferGroup(_,T,E){const{gl:W}=this.renderer;this.renderer.buffer.bind(_.buffer);const X=this.gl.getUniformBlockIndex(T.program,E);T.uniformBufferBindings[E]=this.shader.uniformBindCount,W.uniformBlockBinding(T.program,X,this.shader.uniformBindCount),this.shader.uniformBindCount++;const q=this.getSignature(_,this.shader.program.uniformData,"ubo");let Y=this._uboCache[q];if(Y||(Y=this._uboCache[q]=generateUniformBufferSync(_,this.shader.program.uniformData)),_.autoManage){const te=new Float32Array(Y.size/4);_.buffer.update(te)}return T.uniformGroups[_.id]=Y.syncFunc,T.uniformGroups[_.id]}getSignature(_,T,E){const W=_.uniforms,X=[`${E}-`];for(const q in W)X.push(q),T[q]&&X.push(T[q].type);return X.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(_){const T=this.gl,E=_.program,W=generateProgram(T,E);return E.glPrograms[this.renderer.CONTEXT_UID]=W,W}reset(){this.program=null,this.shader=null}disposeShader(_){this.shader===_&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ShaderSystem.extension={type:ExtensionType.RendererSystem,name:"shader"};extensions$1.add(ShaderSystem);class StartupSystem{constructor(_){this.renderer=_}run(_){const{renderer:T}=this;T.runners.init.emit(T.options),_.hello&&console.log(`PixiJS 7.4.2 - ${T.rendererLogId} - https://pixijs.com`),T.resize(T.screen.width,T.screen.height)}destroy(){}}StartupSystem.defaultOptions={hello:!1},StartupSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"startup"};extensions$1.add(StartupSystem);function mapWebGLBlendModesToPixi(B,_=[]){return _[BLEND_MODES.NORMAL]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.ADD]=[B.ONE,B.ONE],_[BLEND_MODES.MULTIPLY]=[B.DST_COLOR,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.SCREEN]=[B.ONE,B.ONE_MINUS_SRC_COLOR,B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.OVERLAY]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.DARKEN]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.LIGHTEN]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.COLOR_DODGE]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.COLOR_BURN]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.HARD_LIGHT]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.SOFT_LIGHT]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.DIFFERENCE]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.EXCLUSION]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.HUE]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.SATURATION]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.COLOR]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.LUMINOSITY]=[B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.NONE]=[0,0],_[BLEND_MODES.NORMAL_NPM]=[B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.ADD_NPM]=[B.SRC_ALPHA,B.ONE,B.ONE,B.ONE],_[BLEND_MODES.SCREEN_NPM]=[B.SRC_ALPHA,B.ONE_MINUS_SRC_COLOR,B.ONE,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.SRC_IN]=[B.DST_ALPHA,B.ZERO],_[BLEND_MODES.SRC_OUT]=[B.ONE_MINUS_DST_ALPHA,B.ZERO],_[BLEND_MODES.SRC_ATOP]=[B.DST_ALPHA,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.DST_OVER]=[B.ONE_MINUS_DST_ALPHA,B.ONE],_[BLEND_MODES.DST_IN]=[B.ZERO,B.SRC_ALPHA],_[BLEND_MODES.DST_OUT]=[B.ZERO,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.DST_ATOP]=[B.ONE_MINUS_DST_ALPHA,B.SRC_ALPHA],_[BLEND_MODES.XOR]=[B.ONE_MINUS_DST_ALPHA,B.ONE_MINUS_SRC_ALPHA],_[BLEND_MODES.SUBTRACT]=[B.ONE,B.ONE,B.ONE,B.ONE,B.FUNC_REVERSE_SUBTRACT,B.FUNC_ADD],_}const BLEND=0,OFFSET=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5,_StateSystem=class Xh{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[BLEND]=this.setBlend,this.map[OFFSET]=this.setOffset,this.map[CULLING]=this.setCullFace,this.map[DEPTH_TEST]=this.setDepthTest,this.map[WINDING]=this.setFrontFace,this.map[DEPTH_MASK]=this.setDepthMask,this.checks=[],this.defaultState=new State,this.defaultState.blend=!0}contextChange(_){this.gl=_,this.blendModes=mapWebGLBlendModesToPixi(_),this.set(this.defaultState),this.reset()}set(_){if(_=_||this.defaultState,this.stateId!==_.data){let T=this.stateId^_.data,E=0;for(;T;)T&1&&this.map[E].call(this,!!(_.data&1<<E)),T=T>>1,E++;this.stateId=_.data}for(let T=0;T<this.checks.length;T++)this.checks[T](this,_)}forceState(_){_=_||this.defaultState;for(let T=0;T<this.map.length;T++)this.map[T].call(this,!!(_.data&1<<T));for(let T=0;T<this.checks.length;T++)this.checks[T](this,_);this.stateId=_.data}setBlend(_){this.updateCheck(Xh.checkBlendMode,_),this.gl[_?"enable":"disable"](this.gl.BLEND)}setOffset(_){this.updateCheck(Xh.checkPolygonOffset,_),this.gl[_?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(_){this.gl[_?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(_){this.gl.depthMask(_)}setCullFace(_){this.gl[_?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(_){this.gl.frontFace(this.gl[_?"CW":"CCW"])}setBlendMode(_){if(_===this.blendMode)return;this.blendMode=_;const T=this.blendModes[_],E=this.gl;T.length===2?E.blendFunc(T[0],T[1]):E.blendFuncSeparate(T[0],T[1],T[2],T[3]),T.length===6?(this._blendEq=!0,E.blendEquationSeparate(T[4],T[5])):this._blendEq&&(this._blendEq=!1,E.blendEquationSeparate(E.FUNC_ADD,E.FUNC_ADD))}setPolygonOffset(_,T){this.gl.polygonOffset(_,T)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(_,T){const E=this.checks.indexOf(_);T&&E===-1?this.checks.push(_):!T&&E!==-1&&this.checks.splice(E,1)}static checkBlendMode(_,T){_.setBlendMode(T.blendMode)}static checkPolygonOffset(_,T){_.setPolygonOffset(1,T.polygonOffset)}destroy(){this.gl=null}};_StateSystem.extension={type:ExtensionType.RendererSystem,name:"state"};let StateSystem=_StateSystem;extensions$1.add(StateSystem);class SystemManager extends EventEmitter{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(_){this.addRunners(..._.runners);const T=(_.priority??[]).filter(W=>_.systems[W]),E=[...T,...Object.keys(_.systems).filter(W=>!T.includes(W))];for(const W of E)this.addSystem(_.systems[W],W)}addRunners(..._){_.forEach(T=>{this.runners[T]=new Runner(T)})}addSystem(_,T){const E=new _(this);if(this[T])throw new Error(`Whoops! The name "${T}" is already in use`);this[T]=E,this._systemsHash[T]=E;for(const W in this.runners)this.runners[W].add(E);return this}emitWithCustomOptions(_,T){const E=Object.keys(this._systemsHash);_.items.forEach(W=>{const X=E.find(q=>this._systemsHash[q]===W);W[_.name](T[X])})}destroy(){Object.values(this.runners).forEach(_=>{_.destroy()}),this._systemsHash={}}}const _TextureGCSystem=class _u{constructor(_){this.renderer=_,this.count=0,this.checkCount=0,this.maxIdle=_u.defaultMaxIdle,this.checkCountMax=_u.defaultCheckCountMax,this.mode=_u.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const _=this.renderer.texture,T=_.managedTextures;let E=!1;for(let W=0;W<T.length;W++){const X=T[W];X.resource&&this.count-X.touched>this.maxIdle&&(_.destroyTexture(X,!0),T[W]=null,E=!0)}if(E){let W=0;for(let X=0;X<T.length;X++)T[X]!==null&&(T[W++]=T[X]);T.length=W}}unload(_){const T=this.renderer.texture,E=_._texture;E&&!E.framebuffer&&T.destroyTexture(E);for(let W=_.children.length-1;W>=0;W--)this.unload(_.children[W])}destroy(){this.renderer=null}};_TextureGCSystem.defaultMode=GC_MODES.AUTO,_TextureGCSystem.defaultMaxIdle=60*60,_TextureGCSystem.defaultCheckCountMax=60*10,_TextureGCSystem.extension={type:ExtensionType.RendererSystem,name:"textureGC"};let TextureGCSystem=_TextureGCSystem;extensions$1.add(TextureGCSystem);class GLTexture{constructor(_){this.texture=_,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=TYPES.UNSIGNED_BYTE,this.internalFormat=FORMATS.RGBA,this.samplerType=0}}function mapInternalFormatToSamplerType(B){let _;return"WebGL2RenderingContext"in globalThis&&B instanceof globalThis.WebGL2RenderingContext?_={[B.RGB]:SAMPLER_TYPES.FLOAT,[B.RGBA]:SAMPLER_TYPES.FLOAT,[B.ALPHA]:SAMPLER_TYPES.FLOAT,[B.LUMINANCE]:SAMPLER_TYPES.FLOAT,[B.LUMINANCE_ALPHA]:SAMPLER_TYPES.FLOAT,[B.R8]:SAMPLER_TYPES.FLOAT,[B.R8_SNORM]:SAMPLER_TYPES.FLOAT,[B.RG8]:SAMPLER_TYPES.FLOAT,[B.RG8_SNORM]:SAMPLER_TYPES.FLOAT,[B.RGB8]:SAMPLER_TYPES.FLOAT,[B.RGB8_SNORM]:SAMPLER_TYPES.FLOAT,[B.RGB565]:SAMPLER_TYPES.FLOAT,[B.RGBA4]:SAMPLER_TYPES.FLOAT,[B.RGB5_A1]:SAMPLER_TYPES.FLOAT,[B.RGBA8]:SAMPLER_TYPES.FLOAT,[B.RGBA8_SNORM]:SAMPLER_TYPES.FLOAT,[B.RGB10_A2]:SAMPLER_TYPES.FLOAT,[B.RGB10_A2UI]:SAMPLER_TYPES.FLOAT,[B.SRGB8]:SAMPLER_TYPES.FLOAT,[B.SRGB8_ALPHA8]:SAMPLER_TYPES.FLOAT,[B.R16F]:SAMPLER_TYPES.FLOAT,[B.RG16F]:SAMPLER_TYPES.FLOAT,[B.RGB16F]:SAMPLER_TYPES.FLOAT,[B.RGBA16F]:SAMPLER_TYPES.FLOAT,[B.R32F]:SAMPLER_TYPES.FLOAT,[B.RG32F]:SAMPLER_TYPES.FLOAT,[B.RGB32F]:SAMPLER_TYPES.FLOAT,[B.RGBA32F]:SAMPLER_TYPES.FLOAT,[B.R11F_G11F_B10F]:SAMPLER_TYPES.FLOAT,[B.RGB9_E5]:SAMPLER_TYPES.FLOAT,[B.R8I]:SAMPLER_TYPES.INT,[B.R8UI]:SAMPLER_TYPES.UINT,[B.R16I]:SAMPLER_TYPES.INT,[B.R16UI]:SAMPLER_TYPES.UINT,[B.R32I]:SAMPLER_TYPES.INT,[B.R32UI]:SAMPLER_TYPES.UINT,[B.RG8I]:SAMPLER_TYPES.INT,[B.RG8UI]:SAMPLER_TYPES.UINT,[B.RG16I]:SAMPLER_TYPES.INT,[B.RG16UI]:SAMPLER_TYPES.UINT,[B.RG32I]:SAMPLER_TYPES.INT,[B.RG32UI]:SAMPLER_TYPES.UINT,[B.RGB8I]:SAMPLER_TYPES.INT,[B.RGB8UI]:SAMPLER_TYPES.UINT,[B.RGB16I]:SAMPLER_TYPES.INT,[B.RGB16UI]:SAMPLER_TYPES.UINT,[B.RGB32I]:SAMPLER_TYPES.INT,[B.RGB32UI]:SAMPLER_TYPES.UINT,[B.RGBA8I]:SAMPLER_TYPES.INT,[B.RGBA8UI]:SAMPLER_TYPES.UINT,[B.RGBA16I]:SAMPLER_TYPES.INT,[B.RGBA16UI]:SAMPLER_TYPES.UINT,[B.RGBA32I]:SAMPLER_TYPES.INT,[B.RGBA32UI]:SAMPLER_TYPES.UINT,[B.DEPTH_COMPONENT16]:SAMPLER_TYPES.FLOAT,[B.DEPTH_COMPONENT24]:SAMPLER_TYPES.FLOAT,[B.DEPTH_COMPONENT32F]:SAMPLER_TYPES.FLOAT,[B.DEPTH_STENCIL]:SAMPLER_TYPES.FLOAT,[B.DEPTH24_STENCIL8]:SAMPLER_TYPES.FLOAT,[B.DEPTH32F_STENCIL8]:SAMPLER_TYPES.FLOAT}:_={[B.RGB]:SAMPLER_TYPES.FLOAT,[B.RGBA]:SAMPLER_TYPES.FLOAT,[B.ALPHA]:SAMPLER_TYPES.FLOAT,[B.LUMINANCE]:SAMPLER_TYPES.FLOAT,[B.LUMINANCE_ALPHA]:SAMPLER_TYPES.FLOAT,[B.DEPTH_STENCIL]:SAMPLER_TYPES.FLOAT},_}function mapTypeAndFormatToInternalFormat(B){let _;return"WebGL2RenderingContext"in globalThis&&B instanceof globalThis.WebGL2RenderingContext?_={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:B.RGBA8,[FORMATS.RGB]:B.RGB8,[FORMATS.RG]:B.RG8,[FORMATS.RED]:B.R8,[FORMATS.RGBA_INTEGER]:B.RGBA8UI,[FORMATS.RGB_INTEGER]:B.RGB8UI,[FORMATS.RG_INTEGER]:B.RG8UI,[FORMATS.RED_INTEGER]:B.R8UI,[FORMATS.ALPHA]:B.ALPHA,[FORMATS.LUMINANCE]:B.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:B.LUMINANCE_ALPHA},[TYPES.BYTE]:{[FORMATS.RGBA]:B.RGBA8_SNORM,[FORMATS.RGB]:B.RGB8_SNORM,[FORMATS.RG]:B.RG8_SNORM,[FORMATS.RED]:B.R8_SNORM,[FORMATS.RGBA_INTEGER]:B.RGBA8I,[FORMATS.RGB_INTEGER]:B.RGB8I,[FORMATS.RG_INTEGER]:B.RG8I,[FORMATS.RED_INTEGER]:B.R8I},[TYPES.UNSIGNED_SHORT]:{[FORMATS.RGBA_INTEGER]:B.RGBA16UI,[FORMATS.RGB_INTEGER]:B.RGB16UI,[FORMATS.RG_INTEGER]:B.RG16UI,[FORMATS.RED_INTEGER]:B.R16UI,[FORMATS.DEPTH_COMPONENT]:B.DEPTH_COMPONENT16},[TYPES.SHORT]:{[FORMATS.RGBA_INTEGER]:B.RGBA16I,[FORMATS.RGB_INTEGER]:B.RGB16I,[FORMATS.RG_INTEGER]:B.RG16I,[FORMATS.RED_INTEGER]:B.R16I},[TYPES.UNSIGNED_INT]:{[FORMATS.RGBA_INTEGER]:B.RGBA32UI,[FORMATS.RGB_INTEGER]:B.RGB32UI,[FORMATS.RG_INTEGER]:B.RG32UI,[FORMATS.RED_INTEGER]:B.R32UI,[FORMATS.DEPTH_COMPONENT]:B.DEPTH_COMPONENT24},[TYPES.INT]:{[FORMATS.RGBA_INTEGER]:B.RGBA32I,[FORMATS.RGB_INTEGER]:B.RGB32I,[FORMATS.RG_INTEGER]:B.RG32I,[FORMATS.RED_INTEGER]:B.R32I},[TYPES.FLOAT]:{[FORMATS.RGBA]:B.RGBA32F,[FORMATS.RGB]:B.RGB32F,[FORMATS.RG]:B.RG32F,[FORMATS.RED]:B.R32F,[FORMATS.DEPTH_COMPONENT]:B.DEPTH_COMPONENT32F},[TYPES.HALF_FLOAT]:{[FORMATS.RGBA]:B.RGBA16F,[FORMATS.RGB]:B.RGB16F,[FORMATS.RG]:B.RG16F,[FORMATS.RED]:B.R16F},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:B.RGB565},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:B.RGBA4},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:B.RGB5_A1},[TYPES.UNSIGNED_INT_2_10_10_10_REV]:{[FORMATS.RGBA]:B.RGB10_A2,[FORMATS.RGBA_INTEGER]:B.RGB10_A2UI},[TYPES.UNSIGNED_INT_10F_11F_11F_REV]:{[FORMATS.RGB]:B.R11F_G11F_B10F},[TYPES.UNSIGNED_INT_5_9_9_9_REV]:{[FORMATS.RGB]:B.RGB9_E5},[TYPES.UNSIGNED_INT_24_8]:{[FORMATS.DEPTH_STENCIL]:B.DEPTH24_STENCIL8},[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[FORMATS.DEPTH_STENCIL]:B.DEPTH32F_STENCIL8}}:_={[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:B.RGBA,[FORMATS.RGB]:B.RGB,[FORMATS.ALPHA]:B.ALPHA,[FORMATS.LUMINANCE]:B.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:B.LUMINANCE_ALPHA},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:B.RGB},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:B.RGBA},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:B.RGBA}},_}class TextureSystem{constructor(_){this.renderer=_,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new BaseTexture,this.hasIntegerTextures=!1}contextChange(){const _=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mapTypeAndFormatToInternalFormat(_),this.samplerTypes=mapInternalFormatToSamplerType(_);const T=_.getParameter(_.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=T;for(let W=0;W<T;W++)this.boundTextures[W]=null;this.emptyTextures={};const E=new GLTexture(_.createTexture());_.bindTexture(_.TEXTURE_2D,E.texture),_.texImage2D(_.TEXTURE_2D,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[_.TEXTURE_2D]=E,this.emptyTextures[_.TEXTURE_CUBE_MAP]=new GLTexture(_.createTexture()),_.bindTexture(_.TEXTURE_CUBE_MAP,this.emptyTextures[_.TEXTURE_CUBE_MAP].texture);for(let W=0;W<6;W++)_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,_.RGBA,1,1,0,_.RGBA,_.UNSIGNED_BYTE,null);_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_CUBE_MAP,_.TEXTURE_MIN_FILTER,_.LINEAR);for(let W=0;W<this.boundTextures.length;W++)this.bind(null,W)}bind(_,T=0){const{gl:E}=this;if(_=_==null?void 0:_.castToBaseTexture(),(_==null?void 0:_.valid)&&!_.parentTextureArray){_.touched=this.renderer.textureGC.count;const W=_._glTextures[this.CONTEXT_UID]||this.initTexture(_);this.boundTextures[T]!==_&&(this.currentLocation!==T&&(this.currentLocation=T,E.activeTexture(E.TEXTURE0+T)),E.bindTexture(_.target,W.texture)),W.dirtyId!==_.dirtyId?(this.currentLocation!==T&&(this.currentLocation=T,E.activeTexture(E.TEXTURE0+T)),this.updateTexture(_)):W.dirtyStyleId!==_.dirtyStyleId&&this.updateTextureStyle(_),this.boundTextures[T]=_}else this.currentLocation!==T&&(this.currentLocation=T,E.activeTexture(E.TEXTURE0+T)),E.bindTexture(E.TEXTURE_2D,this.emptyTextures[E.TEXTURE_2D].texture),this.boundTextures[T]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let _=0;_<this.boundTextures.length;_++)this.boundTextures[_]=this.unknownTexture}unbind(_){const{gl:T,boundTextures:E}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let W=0;W<E.length;W++)E[W]===this.unknownTexture&&this.bind(null,W)}for(let W=0;W<E.length;W++)E[W]===_&&(this.currentLocation!==W&&(T.activeTexture(T.TEXTURE0+W),this.currentLocation=W),T.bindTexture(_.target,this.emptyTextures[_.target].texture),E[W]=null)}ensureSamplerType(_){const{boundTextures:T,hasIntegerTextures:E,CONTEXT_UID:W}=this;if(E)for(let X=_-1;X>=0;--X){const q=T[X];q&&q._glTextures[W].samplerType!==SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(q)}}initTexture(_){const T=new GLTexture(this.gl.createTexture());return T.dirtyId=-1,_._glTextures[this.CONTEXT_UID]=T,this.managedTextures.push(_),_.on("dispose",this.destroyTexture,this),T}initTextureType(_,T){var E;T.internalFormat=((E=this.internalFormats[_.type])==null?void 0:E[_.format])??_.format,T.samplerType=this.samplerTypes[T.internalFormat]??SAMPLER_TYPES.FLOAT,this.webGLVersion===2&&_.type===TYPES.HALF_FLOAT?T.type=this.gl.HALF_FLOAT:T.type=_.type}updateTexture(_){var W;const T=_._glTextures[this.CONTEXT_UID];if(!T)return;const E=this.renderer;if(this.initTextureType(_,T),(W=_.resource)==null?void 0:W.upload(E,_,T))T.samplerType!==SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0);else{const X=_.realWidth,q=_.realHeight,Y=E.gl;(T.width!==X||T.height!==q||T.dirtyId<0)&&(T.width=X,T.height=q,Y.texImage2D(_.target,0,T.internalFormat,X,q,0,_.format,T.type,null))}_.dirtyStyleId!==T.dirtyStyleId&&this.updateTextureStyle(_),T.dirtyId=_.dirtyId}destroyTexture(_,T){const{gl:E}=this;if(_=_.castToBaseTexture(),_._glTextures[this.CONTEXT_UID]&&(this.unbind(_),E.deleteTexture(_._glTextures[this.CONTEXT_UID].texture),_.off("dispose",this.destroyTexture,this),delete _._glTextures[this.CONTEXT_UID],!T)){const W=this.managedTextures.indexOf(_);W!==-1&&removeItems(this.managedTextures,W,1)}}updateTextureStyle(_){var E;const T=_._glTextures[this.CONTEXT_UID];T&&((_.mipmap===MIPMAP_MODES.POW2||this.webGLVersion!==2)&&!_.isPowerOfTwo?T.mipmap=!1:T.mipmap=_.mipmap>=1,this.webGLVersion!==2&&!_.isPowerOfTwo?T.wrapMode=WRAP_MODES.CLAMP:T.wrapMode=_.wrapMode,(E=_.resource)!=null&&E.style(this.renderer,_,T)||this.setStyle(_,T),T.dirtyStyleId=_.dirtyStyleId)}setStyle(_,T){const E=this.gl;if(T.mipmap&&_.mipmap!==MIPMAP_MODES.ON_MANUAL&&E.generateMipmap(_.target),E.texParameteri(_.target,E.TEXTURE_WRAP_S,T.wrapMode),E.texParameteri(_.target,E.TEXTURE_WRAP_T,T.wrapMode),T.mipmap){E.texParameteri(_.target,E.TEXTURE_MIN_FILTER,_.scaleMode===SCALE_MODES.LINEAR?E.LINEAR_MIPMAP_LINEAR:E.NEAREST_MIPMAP_NEAREST);const W=this.renderer.context.extensions.anisotropicFiltering;if(W&&_.anisotropicLevel>0&&_.scaleMode===SCALE_MODES.LINEAR){const X=Math.min(_.anisotropicLevel,E.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT));E.texParameterf(_.target,W.TEXTURE_MAX_ANISOTROPY_EXT,X)}}else E.texParameteri(_.target,E.TEXTURE_MIN_FILTER,_.scaleMode===SCALE_MODES.LINEAR?E.LINEAR:E.NEAREST);E.texParameteri(_.target,E.TEXTURE_MAG_FILTER,_.scaleMode===SCALE_MODES.LINEAR?E.LINEAR:E.NEAREST)}destroy(){this.renderer=null}}TextureSystem.extension={type:ExtensionType.RendererSystem,name:"texture"};extensions$1.add(TextureSystem);class TransformFeedbackSystem{constructor(_){this.renderer=_}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(_){const{gl:T,CONTEXT_UID:E}=this,W=_._glTransformFeedbacks[E]||this.createGLTransformFeedback(_);T.bindTransformFeedback(T.TRANSFORM_FEEDBACK,W)}unbind(){const{gl:_}=this;_.bindTransformFeedback(_.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(_,T){const{gl:E,renderer:W}=this;T&&W.shader.bind(T),E.beginTransformFeedback(_)}endTransformFeedback(){const{gl:_}=this;_.endTransformFeedback()}createGLTransformFeedback(_){const{gl:T,renderer:E,CONTEXT_UID:W}=this,X=T.createTransformFeedback();_._glTransformFeedbacks[W]=X,T.bindTransformFeedback(T.TRANSFORM_FEEDBACK,X);for(let q=0;q<_.buffers.length;q++){const Y=_.buffers[q];Y&&(E.buffer.update(Y),Y._glBuffers[W].refCount++,T.bindBufferBase(T.TRANSFORM_FEEDBACK_BUFFER,q,Y._glBuffers[W].buffer||null))}return T.bindTransformFeedback(T.TRANSFORM_FEEDBACK,null),_.disposeRunner.add(this),X}disposeTransformFeedback(_,T){const E=_._glTransformFeedbacks[this.CONTEXT_UID],W=this.gl;_.disposeRunner.remove(this);const X=this.renderer.buffer;if(X)for(let q=0;q<_.buffers.length;q++){const Y=_.buffers[q];if(!Y)continue;const te=Y._glBuffers[this.CONTEXT_UID];te&&(te.refCount--,te.refCount===0&&!T&&X.dispose(Y,T))}E&&(T||W.deleteTransformFeedback(E),delete _._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}TransformFeedbackSystem.extension={type:ExtensionType.RendererSystem,name:"transformFeedback"};extensions$1.add(TransformFeedbackSystem);class ViewSystem{constructor(_){this.renderer=_}init(_){this.screen=new Rectangle(0,0,_.width,_.height),this.element=_.view||settings.ADAPTER.createCanvas(),this.resolution=_.resolution||settings.RESOLUTION,this.autoDensity=!!_.autoDensity}resizeView(_,T){this.element.width=Math.round(_*this.resolution),this.element.height=Math.round(T*this.resolution);const E=this.element.width/this.resolution,W=this.element.height/this.resolution;this.screen.width=E,this.screen.height=W,this.autoDensity&&(this.element.style.width=`${E}px`,this.element.style.height=`${W}px`),this.renderer.emit("resize",E,W),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(_){var T;_&&((T=this.element.parentNode)==null||T.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ViewSystem.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ViewSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_view"};extensions$1.add(ViewSystem);settings.PREFER_ENV=ENV.WEBGL2;settings.STRICT_TEXTURE_CACHE=!1;settings.RENDER_OPTIONS={...ContextSystem.defaultOptions,...BackgroundSystem.defaultOptions,...ViewSystem.defaultOptions,...StartupSystem.defaultOptions};Object.defineProperties(settings,{WRAP_MODE:{get(){return BaseTexture.defaultOptions.wrapMode},set(B){deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),BaseTexture.defaultOptions.wrapMode=B}},SCALE_MODE:{get(){return BaseTexture.defaultOptions.scaleMode},set(B){deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),BaseTexture.defaultOptions.scaleMode=B}},MIPMAP_TEXTURES:{get(){return BaseTexture.defaultOptions.mipmap},set(B){deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),BaseTexture.defaultOptions.mipmap=B}},ANISOTROPIC_LEVEL:{get(){return BaseTexture.defaultOptions.anisotropicLevel},set(B){deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),BaseTexture.defaultOptions.anisotropicLevel=B}},FILTER_RESOLUTION:{get(){return deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Filter.defaultResolution},set(B){Filter.defaultResolution=B}},FILTER_MULTISAMPLE:{get(){return deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Filter.defaultMultisample},set(B){Filter.defaultMultisample=B}},SPRITE_MAX_TEXTURES:{get(){return BatchRenderer.defaultMaxTextures},set(B){deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),BatchRenderer.defaultMaxTextures=B}},SPRITE_BATCH_SIZE:{get(){return BatchRenderer.defaultBatchSize},set(B){deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),BatchRenderer.defaultBatchSize=B}},CAN_UPLOAD_SAME_BUFFER:{get(){return BatchRenderer.canUploadSameBuffer},set(B){deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),BatchRenderer.canUploadSameBuffer=B}},GC_MODE:{get(){return TextureGCSystem.defaultMode},set(B){deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),TextureGCSystem.defaultMode=B}},GC_MAX_IDLE:{get(){return TextureGCSystem.defaultMaxIdle},set(B){deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),TextureGCSystem.defaultMaxIdle=B}},GC_MAX_CHECK_COUNT:{get(){return TextureGCSystem.defaultCheckCountMax},set(B){deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),TextureGCSystem.defaultCheckCountMax=B}},PRECISION_VERTEX:{get(){return Program.defaultVertexPrecision},set(B){deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Program.defaultVertexPrecision=B}},PRECISION_FRAGMENT:{get(){return Program.defaultFragmentPrecision},set(B){deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Program.defaultFragmentPrecision=B}}});var UPDATE_PRIORITY=(B=>(B[B.INTERACTION=50]="INTERACTION",B[B.HIGH=25]="HIGH",B[B.NORMAL=0]="NORMAL",B[B.LOW=-25]="LOW",B[B.UTILITY=-50]="UTILITY",B))(UPDATE_PRIORITY||{});class TickerListener{constructor(_,T=null,E=0,W=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=_,this.context=T,this.priority=E,this.once=W}match(_,T=null){return this.fn===_&&this.context===T}emit(_){this.fn&&(this.context?this.fn.call(this.context,_):this.fn(_));const T=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),T}connect(_){this.previous=_,_.next&&(_.next.previous=this),this.next=_.next,_.next=this}destroy(_=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const T=this.next;return this.next=_?null:T,this.previous=null,T}}const _Ticker=class Ks{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/Ks.targetFPMS,this.elapsedMS=1/Ks.targetFPMS,this._tick=_=>{this._requestId=null,this.started&&(this.update(_),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(_,T,E=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(_,T,E))}addOnce(_,T,E=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(_,T,E,!0))}_addListener(_){let T=this._head.next,E=this._head;if(!T)_.connect(E);else{for(;T;){if(_.priority>T.priority){_.connect(E);break}E=T,T=T.next}_.previous||_.connect(E)}return this._startIfPossible(),this}remove(_,T){let E=this._head.next;for(;E;)E.match(_,T)?E=E.destroy():E=E.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let _=0,T=this._head;for(;T=T.next;)_++;return _}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let _=this._head.next;for(;_;)_=_.destroy(!0);this._head.destroy(),this._head=null}}update(_=performance.now()){let T;if(_>this.lastTime){if(T=this.elapsedMS=_-this.lastTime,T>this._maxElapsedMS&&(T=this._maxElapsedMS),T*=this.speed,this._minElapsedMS){const X=_-this._lastFrame|0;if(X<this._minElapsedMS)return;this._lastFrame=_-X%this._minElapsedMS}this.deltaMS=T,this.deltaTime=this.deltaMS*Ks.targetFPMS;const E=this._head;let W=E.next;for(;W;)W=W.emit(this.deltaTime);E.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=_}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(_){const T=Math.min(this.maxFPS,_),E=Math.min(Math.max(0,T)/1e3,Ks.targetFPMS);this._maxElapsedMS=1/E}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(_){if(_===0)this._minElapsedMS=0;else{const T=Math.max(this.minFPS,_);this._minElapsedMS=1/(T/1e3)}}static get shared(){if(!Ks._shared){const _=Ks._shared=new Ks;_.autoStart=!0,_._protected=!0}return Ks._shared}static get system(){if(!Ks._system){const _=Ks._system=new Ks;_.autoStart=!0,_._protected=!0}return Ks._system}};_Ticker.targetFPMS=.06;let Ticker$1=_Ticker;Object.defineProperties(settings,{TARGET_FPMS:{get(){return Ticker$1.targetFPMS},set(B){deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ticker$1.targetFPMS=B}}});class TickerPlugin{static init(_){_=Object.assign({autoStart:!0,sharedTicker:!1},_),Object.defineProperty(this,"ticker",{set(T){this._ticker&&this._ticker.remove(this.render,this),this._ticker=T,T&&T.add(this.render,this,UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=_.sharedTicker?Ticker$1.shared:new Ticker$1,_.autoStart&&this.start()}static destroy(){if(this._ticker){const _=this._ticker;this.ticker=null,_.destroy()}}}TickerPlugin.extension=ExtensionType.Application;extensions$1.add(TickerPlugin);const renderers=[];extensions$1.handleByList(ExtensionType.Renderer,renderers);function autoDetectRenderer(B){for(const _ of renderers)if(_.test(B))return new _(B);throw new Error("Unable to auto-detect a suitable renderer.")}var $defaultVertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$defaultFilterVertex=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const defaultVertex=$defaultVertex,defaultFilterVertex=$defaultFilterVertex;class MultisampleSystem{constructor(_){this.renderer=_}contextChange(_){let T;if(this.renderer.context.webGLVersion===1){const E=_.getParameter(_.FRAMEBUFFER_BINDING);_.bindFramebuffer(_.FRAMEBUFFER,null),T=_.getParameter(_.SAMPLES),_.bindFramebuffer(_.FRAMEBUFFER,E)}else{const E=_.getParameter(_.DRAW_FRAMEBUFFER_BINDING);_.bindFramebuffer(_.DRAW_FRAMEBUFFER,null),T=_.getParameter(_.SAMPLES),_.bindFramebuffer(_.DRAW_FRAMEBUFFER,E)}T>=MSAA_QUALITY.HIGH?this.multisample=MSAA_QUALITY.HIGH:T>=MSAA_QUALITY.MEDIUM?this.multisample=MSAA_QUALITY.MEDIUM:T>=MSAA_QUALITY.LOW?this.multisample=MSAA_QUALITY.LOW:this.multisample=MSAA_QUALITY.NONE}destroy(){}}MultisampleSystem.extension={type:ExtensionType.RendererSystem,name:"_multisample"};extensions$1.add(MultisampleSystem);class GLBuffer{constructor(_){this.buffer=_||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class BufferSystem{constructor(_){this.renderer=_,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(_){const{gl:T,CONTEXT_UID:E}=this,W=_._glBuffers[E]||this.createGLBuffer(_);T.bindBuffer(_.type,W.buffer)}unbind(_){const{gl:T}=this;T.bindBuffer(_,null)}bindBufferBase(_,T){const{gl:E,CONTEXT_UID:W}=this;if(this.boundBufferBases[T]!==_){const X=_._glBuffers[W]||this.createGLBuffer(_);this.boundBufferBases[T]=_,E.bindBufferBase(E.UNIFORM_BUFFER,T,X.buffer)}}bindBufferRange(_,T,E){const{gl:W,CONTEXT_UID:X}=this;E=E||0;const q=_._glBuffers[X]||this.createGLBuffer(_);W.bindBufferRange(W.UNIFORM_BUFFER,T||0,q.buffer,E*256,256)}update(_){const{gl:T,CONTEXT_UID:E}=this,W=_._glBuffers[E]||this.createGLBuffer(_);if(_._updateID!==W.updateID)if(W.updateID=_._updateID,T.bindBuffer(_.type,W.buffer),W.byteLength>=_.data.byteLength)T.bufferSubData(_.type,0,_.data);else{const X=_.static?T.STATIC_DRAW:T.DYNAMIC_DRAW;W.byteLength=_.data.byteLength,T.bufferData(_.type,_.data,X)}}dispose(_,T){if(!this.managedBuffers[_.id])return;delete this.managedBuffers[_.id];const E=_._glBuffers[this.CONTEXT_UID],W=this.gl;_.disposeRunner.remove(this),E&&(T||W.deleteBuffer(E.buffer),delete _._glBuffers[this.CONTEXT_UID])}disposeAll(_){const T=Object.keys(this.managedBuffers);for(let E=0;E<T.length;E++)this.dispose(this.managedBuffers[T[E]],_)}createGLBuffer(_){const{CONTEXT_UID:T,gl:E}=this;return _._glBuffers[T]=new GLBuffer(E.createBuffer()),this.managedBuffers[_.id]=_,_.disposeRunner.add(this),_._glBuffers[T]}}BufferSystem.extension={type:ExtensionType.RendererSystem,name:"buffer"};extensions$1.add(BufferSystem);class ObjectRendererSystem{constructor(_){this.renderer=_}render(_,T){const E=this.renderer;let W,X,q,Y;if(T&&(W=T.renderTexture,X=T.clear,q=T.transform,Y=T.skipUpdateTransform),this.renderingToScreen=!W,E.runners.prerender.emit(),E.emit("prerender"),E.projection.transform=q,!E.context.isLost){if(W||(this.lastObjectRendered=_),!Y){const te=_.enableTempParent();_.updateTransform(),_.disableTempParent(te)}E.renderTexture.bind(W),E.batch.currentRenderer.start(),(X??E.background.clearBeforeRender)&&E.renderTexture.clear(),_.render(E),E.batch.currentRenderer.flush(),W&&(T.blit&&E.framebuffer.blit(),W.baseTexture.update()),E.runners.postrender.emit(),E.projection.transform=null,E.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ObjectRendererSystem.extension={type:ExtensionType.RendererSystem,name:"objectRenderer"};extensions$1.add(ObjectRendererSystem);const _Renderer=class qh extends SystemManager{constructor(_){super(),this.type=RENDERER_TYPE.WEBGL,_=Object.assign({},settings.RENDER_OPTIONS,_),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0);const T={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:qh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(T),"useContextAlpha"in _&&(deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),_.premultipliedAlpha=_.useContextAlpha&&_.useContextAlpha!=="notMultiplied",_.backgroundAlpha=_.useContextAlpha===!1?1:_.backgroundAlpha),this._plugin.rendererPlugins=qh.__plugins,this.options=_,this.startup.run(this.options)}static test(_){return _!=null&&_.forceCanvas?!1:isWebGLSupported()}render(_,T){this.objectRenderer.render(_,T)}resize(_,T){this._view.resizeView(_,T)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(_=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:_}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(_){this._view.resolution=_,this.runners.resolutionChange.emit(_)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(_){deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=_}get backgroundAlpha(){return deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(_){deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=_}get powerPreference(){return deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(_,T){return this.textureGenerator.generateTexture(_,T)}};_Renderer.extension={type:ExtensionType.Renderer,priority:1},_Renderer.__plugins={},_Renderer.__systems={};let Renderer=_Renderer;extensions$1.handleByMap(ExtensionType.RendererPlugin,Renderer.__plugins);extensions$1.handleByMap(ExtensionType.RendererSystem,Renderer.__systems);extensions$1.add(Renderer);class AbstractMultiResource extends Resource{constructor(_,T){const{width:E,height:W}=T||{};super(E,W),this.items=[],this.itemDirtyIds=[];for(let X=0;X<_;X++){const q=new BaseTexture;this.items.push(q),this.itemDirtyIds.push(-2)}this.length=_,this._load=null,this.baseTexture=null}initFromArray(_,T){for(let E=0;E<this.length;E++)_[E]&&(_[E].castToBaseTexture?this.addBaseTextureAt(_[E].castToBaseTexture(),E):_[E]instanceof Resource?this.addResourceAt(_[E],E):this.addResourceAt(autoDetectResource(_[E],T),E))}dispose(){for(let _=0,T=this.length;_<T;_++)this.items[_].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(_,T){if(!this.items[T])throw new Error(`Index ${T} is out of bounds`);return _.valid&&!this.valid&&this.resize(_.width,_.height),this.items[T].setResource(_),this}bind(_){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(_);for(let T=0;T<this.length;T++)this.items[T].parentTextureArray=_,this.items[T].on("update",_.update,_)}unbind(_){super.unbind(_);for(let T=0;T<this.length;T++)this.items[T].parentTextureArray=null,this.items[T].off("update",_.update,_)}load(){if(this._load)return this._load;const _=this.items.map(T=>T.resource).filter(T=>T).map(T=>T.load());return this._load=Promise.all(_).then(()=>{const{realWidth:T,realHeight:E}=this.items[0];return this.resize(T,E),this.update(),Promise.resolve(this)}),this._load}}class ArrayResource extends AbstractMultiResource{constructor(_,T){const{width:E,height:W}=T||{};let X,q;Array.isArray(_)?(X=_,q=_.length):q=_,super(q,{width:E,height:W}),X&&this.initFromArray(X,T)}addBaseTextureAt(_,T){if(_.resource)this.addResourceAt(_.resource,T);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(_){super.bind(_),_.target=TARGETS.TEXTURE_2D_ARRAY}upload(_,T,E){const{length:W,itemDirtyIds:X,items:q}=this,{gl:Y}=_;E.dirtyId<0&&Y.texImage3D(Y.TEXTURE_2D_ARRAY,0,E.internalFormat,this._width,this._height,W,0,T.format,E.type,null);for(let te=0;te<W;te++){const ne=q[te];X[te]<ne.dirtyId&&(X[te]=ne.dirtyId,ne.valid&&Y.texSubImage3D(Y.TEXTURE_2D_ARRAY,0,0,0,te,ne.resource.width,ne.resource.height,1,T.format,E.type,ne.resource.source))}return!0}}class CanvasResource extends BaseImageResource{constructor(_){super(_)}static test(_){const{OffscreenCanvas:T}=globalThis;return T&&_ instanceof T?!0:globalThis.HTMLCanvasElement&&_ instanceof HTMLCanvasElement}}const _CubeResource=class Wl extends AbstractMultiResource{constructor(_,T){const{width:E,height:W,autoLoad:X,linkBaseTexture:q}=T||{};if(_&&_.length!==Wl.SIDES)throw new Error(`Invalid length. Got ${_.length}, expected 6`);super(6,{width:E,height:W});for(let Y=0;Y<Wl.SIDES;Y++)this.items[Y].target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+Y;this.linkBaseTexture=q!==!1,_&&this.initFromArray(_,T),X!==!1&&this.load()}bind(_){super.bind(_),_.target=TARGETS.TEXTURE_CUBE_MAP}addBaseTextureAt(_,T,E){if(E===void 0&&(E=this.linkBaseTexture),!this.items[T])throw new Error(`Index ${T} is out of bounds`);if(!this.linkBaseTexture||_.parentTextureArray||Object.keys(_._glTextures).length>0)if(_.resource)this.addResourceAt(_.resource,T);else throw new Error("CubeResource does not support copying of renderTexture.");else _.target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+T,_.parentTextureArray=this.baseTexture,this.items[T]=_;return _.valid&&!this.valid&&this.resize(_.realWidth,_.realHeight),this.items[T]=_,this}upload(_,T,E){const W=this.itemDirtyIds;for(let X=0;X<Wl.SIDES;X++){const q=this.items[X];(W[X]<q.dirtyId||E.dirtyId<T.dirtyId)&&(q.valid&&q.resource?(q.resource.upload(_,q,E),W[X]=q.dirtyId):W[X]<-1&&(_.gl.texImage2D(q.target,0,E.internalFormat,T.realWidth,T.realHeight,0,T.format,E.type,null),W[X]=-1))}return!0}static test(_){return Array.isArray(_)&&_.length===Wl.SIDES}};_CubeResource.SIDES=6;let CubeResource=_CubeResource;class ImageBitmapResource extends BaseImageResource{constructor(_,T){T=T||{};let E,W,X;typeof _=="string"?(E=ImageBitmapResource.EMPTY,W=_,X=!0):(E=_,W=null,X=!1),super(E),this.url=W,this.crossOrigin=T.crossOrigin??!0,this.alphaMode=typeof T.alphaMode=="number"?T.alphaMode:null,this.ownsImageBitmap=T.ownsImageBitmap??X,this._load=null,T.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(_,T)=>{if(this.url===null){_(this);return}try{const E=await settings.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const W=await E.blob();if(this.destroyed)return;const X=await createImageBitmap(W,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"});if(this.destroyed){X.close();return}this.source=X,this.update(),_(this)}catch(E){if(this.destroyed)return;T(E),this.onError.emit(E)}}),this._load)}upload(_,T,E){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(T.alphaMode=this.alphaMode),super.upload(_,T,E)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(_){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof _=="string"||_ instanceof ImageBitmap)}static get EMPTY(){return ImageBitmapResource._EMPTY=ImageBitmapResource._EMPTY??settings.ADAPTER.createCanvas(0,0),ImageBitmapResource._EMPTY}}const _SVGResource=class vu extends BaseImageResource{constructor(_,T){T=T||{},super(settings.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=_,this.scale=T.scale||1,this._overrideWidth=T.width,this._overrideHeight=T.height,this._resolve=null,this._crossorigin=T.crossorigin,this._load=null,T.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(_=>{if(this._resolve=()=>{this.update(),_(this)},vu.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const _=new Image;BaseImageResource.crossOrigin(_,this.svg,this._crossorigin),_.src=this.svg,_.onerror=T=>{this._resolve&&(_.onerror=null,this.onError.emit(T))},_.onload=()=>{if(!this._resolve)return;const T=_.width,E=_.height;if(!T||!E)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let W=T*this.scale,X=E*this.scale;(this._overrideWidth||this._overrideHeight)&&(W=this._overrideWidth||this._overrideHeight/E*T,X=this._overrideHeight||this._overrideWidth/T*E),W=Math.round(W),X=Math.round(X);const q=this.source;q.width=W,q.height=X,q._pixiId=`canvas_${uid()}`,q.getContext("2d").drawImage(_,0,0,T,E,0,0,W,X),this._resolve(),this._resolve=null}}static getSize(_){const T=vu.SVG_SIZE.exec(_),E={};return T&&(E[T[1]]=Math.round(parseFloat(T[3])),E[T[5]]=Math.round(parseFloat(T[7]))),E}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(_,T){return T==="svg"||typeof _=="string"&&_.startsWith("data:image/svg+xml")||typeof _=="string"&&vu.SVG_XML.test(_)}};_SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,_SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let SVGResource=_SVGResource;class VideoFrameResource extends BaseImageResource{constructor(_){super(_)}static test(_){return!!globalThis.VideoFrame&&_ instanceof globalThis.VideoFrame}}const _VideoResource=class Qh extends BaseImageResource{constructor(_,T){if(T=T||{},!(_ instanceof HTMLVideoElement)){const E=document.createElement("video");T.autoLoad!==!1&&E.setAttribute("preload","auto"),T.playsinline!==!1&&(E.setAttribute("webkit-playsinline",""),E.setAttribute("playsinline","")),T.muted===!0&&(E.setAttribute("muted",""),E.muted=!0),T.loop===!0&&E.setAttribute("loop",""),T.autoPlay!==!1&&E.setAttribute("autoplay",""),typeof _=="string"&&(_=[_]);const W=_[0].src||_[0];BaseImageResource.crossOrigin(E,W,T.crossorigin);for(let X=0;X<_.length;++X){const q=document.createElement("source");let{src:Y,mime:te}=_[X];if(Y=Y||_[X],Y.startsWith("data:"))te=Y.slice(5,Y.indexOf(";"));else if(!Y.startsWith("blob:")){const ne=Y.split("?").shift().toLowerCase(),ae=ne.slice(ne.lastIndexOf(".")+1);te=te||Qh.MIME_TYPES[ae]||`video/${ae}`}q.src=Y,te&&(q.type=te),E.appendChild(q)}_=E}super(_),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=T.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=T.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),T.autoLoad!==!1&&this.load()}update(_=0){if(!this.destroyed){if(this._updateFPS){const T=Ticker$1.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-T)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const _=this.source;return(_.readyState===_.HAVE_ENOUGH_DATA||_.readyState===_.HAVE_FUTURE_DATA)&&_.width&&_.height&&(_.complete=!0),_.addEventListener("play",this._onPlayStart),_.addEventListener("pause",this._onPlayStop),_.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(_.addEventListener("canplay",this._onCanPlay),_.addEventListener("canplaythrough",this._onCanPlay),_.addEventListener("error",this._onError,!0)),this._load=new Promise((T,E)=>{this.valid?T(this):(this._resolve=T,this._reject=E,_.load())}),this._load}_onError(_){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(_),this._reject&&(this._reject(_),this._reject=null,this._resolve=null)}_isSourcePlaying(){const _=this.source;return!_.paused&&!_.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const _=this.source;_.removeEventListener("canplay",this._onCanPlay),_.removeEventListener("canplaythrough",this._onCanPlay);const T=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!T&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&_.play()}dispose(){this._configureAutoUpdate();const _=this.source;_&&(_.removeEventListener("play",this._onPlayStart),_.removeEventListener("pause",this._onPlayStop),_.removeEventListener("seeked",this._onSeeked),_.removeEventListener("canplay",this._onCanPlay),_.removeEventListener("canplaythrough",this._onCanPlay),_.removeEventListener("error",this._onError,!0),_.pause(),_.src="",_.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(_){_!==this._autoUpdate&&(this._autoUpdate=_,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(_){_!==this._updateFPS&&(this._updateFPS=_,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ticker$1.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ticker$1.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ticker$1.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(_,T){return globalThis.HTMLVideoElement&&_ instanceof HTMLVideoElement||Qh.TYPES.includes(T)}};_VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],_VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let VideoResource=_VideoResource;INSTALLED.push(ImageBitmapResource,ImageResource,CanvasResource,VideoResource,VideoFrameResource,SVGResource,BufferResource,CubeResource,ArrayResource);class Bounds{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(_){return this.minX>this.maxX||this.minY>this.maxY?Rectangle.EMPTY:(_=_||new Rectangle(0,0,1,1),_.x=this.minX,_.y=this.minY,_.width=this.maxX-this.minX,_.height=this.maxY-this.minY,_)}addPoint(_){this.minX=Math.min(this.minX,_.x),this.maxX=Math.max(this.maxX,_.x),this.minY=Math.min(this.minY,_.y),this.maxY=Math.max(this.maxY,_.y)}addPointMatrix(_,T){const{a:E,b:W,c:X,d:q,tx:Y,ty:te}=_,ne=E*T.x+X*T.y+Y,ae=W*T.x+q*T.y+te;this.minX=Math.min(this.minX,ne),this.maxX=Math.max(this.maxX,ne),this.minY=Math.min(this.minY,ae),this.maxY=Math.max(this.maxY,ae)}addQuad(_){let T=this.minX,E=this.minY,W=this.maxX,X=this.maxY,q=_[0],Y=_[1];T=q<T?q:T,E=Y<E?Y:E,W=q>W?q:W,X=Y>X?Y:X,q=_[2],Y=_[3],T=q<T?q:T,E=Y<E?Y:E,W=q>W?q:W,X=Y>X?Y:X,q=_[4],Y=_[5],T=q<T?q:T,E=Y<E?Y:E,W=q>W?q:W,X=Y>X?Y:X,q=_[6],Y=_[7],T=q<T?q:T,E=Y<E?Y:E,W=q>W?q:W,X=Y>X?Y:X,this.minX=T,this.minY=E,this.maxX=W,this.maxY=X}addFrame(_,T,E,W,X){this.addFrameMatrix(_.worldTransform,T,E,W,X)}addFrameMatrix(_,T,E,W,X){const q=_.a,Y=_.b,te=_.c,ne=_.d,ae=_.tx,le=_.ty;let ue=this.minX,ge=this.minY,ye=this.maxX,xe=this.maxY,Te=q*T+te*E+ae,Ae=Y*T+ne*E+le;ue=Te<ue?Te:ue,ge=Ae<ge?Ae:ge,ye=Te>ye?Te:ye,xe=Ae>xe?Ae:xe,Te=q*W+te*E+ae,Ae=Y*W+ne*E+le,ue=Te<ue?Te:ue,ge=Ae<ge?Ae:ge,ye=Te>ye?Te:ye,xe=Ae>xe?Ae:xe,Te=q*T+te*X+ae,Ae=Y*T+ne*X+le,ue=Te<ue?Te:ue,ge=Ae<ge?Ae:ge,ye=Te>ye?Te:ye,xe=Ae>xe?Ae:xe,Te=q*W+te*X+ae,Ae=Y*W+ne*X+le,ue=Te<ue?Te:ue,ge=Ae<ge?Ae:ge,ye=Te>ye?Te:ye,xe=Ae>xe?Ae:xe,this.minX=ue,this.minY=ge,this.maxX=ye,this.maxY=xe}addVertexData(_,T,E){let W=this.minX,X=this.minY,q=this.maxX,Y=this.maxY;for(let te=T;te<E;te+=2){const ne=_[te],ae=_[te+1];W=ne<W?ne:W,X=ae<X?ae:X,q=ne>q?ne:q,Y=ae>Y?ae:Y}this.minX=W,this.minY=X,this.maxX=q,this.maxY=Y}addVertices(_,T,E,W){this.addVerticesMatrix(_.worldTransform,T,E,W)}addVerticesMatrix(_,T,E,W,X=0,q=X){const Y=_.a,te=_.b,ne=_.c,ae=_.d,le=_.tx,ue=_.ty;let ge=this.minX,ye=this.minY,xe=this.maxX,Te=this.maxY;for(let Ae=E;Ae<W;Ae+=2){const Ie=T[Ae],Ve=T[Ae+1],$e=Y*Ie+ne*Ve+le,We=ae*Ve+te*Ie+ue;ge=Math.min(ge,$e-X),xe=Math.max(xe,$e+X),ye=Math.min(ye,We-q),Te=Math.max(Te,We+q)}this.minX=ge,this.minY=ye,this.maxX=xe,this.maxY=Te}addBounds(_){const T=this.minX,E=this.minY,W=this.maxX,X=this.maxY;this.minX=_.minX<T?_.minX:T,this.minY=_.minY<E?_.minY:E,this.maxX=_.maxX>W?_.maxX:W,this.maxY=_.maxY>X?_.maxY:X}addBoundsMask(_,T){const E=_.minX>T.minX?_.minX:T.minX,W=_.minY>T.minY?_.minY:T.minY,X=_.maxX<T.maxX?_.maxX:T.maxX,q=_.maxY<T.maxY?_.maxY:T.maxY;if(E<=X&&W<=q){const Y=this.minX,te=this.minY,ne=this.maxX,ae=this.maxY;this.minX=E<Y?E:Y,this.minY=W<te?W:te,this.maxX=X>ne?X:ne,this.maxY=q>ae?q:ae}}addBoundsMatrix(_,T){this.addFrameMatrix(T,_.minX,_.minY,_.maxX,_.maxY)}addBoundsArea(_,T){const E=_.minX>T.x?_.minX:T.x,W=_.minY>T.y?_.minY:T.y,X=_.maxX<T.x+T.width?_.maxX:T.x+T.width,q=_.maxY<T.y+T.height?_.maxY:T.y+T.height;if(E<=X&&W<=q){const Y=this.minX,te=this.minY,ne=this.maxX,ae=this.maxY;this.minX=E<Y?E:Y,this.minY=W<te?W:te,this.maxX=X>ne?X:ne,this.maxY=q>ae?q:ae}}pad(_=0,T=_){this.isEmpty()||(this.minX-=_,this.maxX+=_,this.minY-=T,this.maxY+=T)}addFramePad(_,T,E,W,X,q){_-=X,T-=q,E+=X,W+=q,this.minX=this.minX<_?this.minX:_,this.maxX=this.maxX>E?this.maxX:E,this.minY=this.minY<T?this.minY:T,this.maxY=this.maxY>W?this.maxY:W}}class DisplayObject extends EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Transform$1,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bounds,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(_){const T=Object.keys(_);for(let E=0;E<T.length;++E){const W=T[E];Object.defineProperty(DisplayObject.prototype,W,Object.getOwnPropertyDescriptor(_,W))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(_,T){return _||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),T||(this._boundsRect||(this._boundsRect=new Rectangle),T=this._boundsRect),this._bounds.getRectangle(T)}getLocalBounds(_){_||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),_=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);const T=this.transform,E=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(E==null?void 0:E.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const W=this._bounds,X=this._boundsID;this._bounds=this._localBounds;const q=this.getBounds(!1,_);return this.parent=E,this.transform=T,this._bounds=W,this._bounds.updateID+=this._boundsID-X,q}toGlobal(_,T,E=!1){return E||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(_,T)}toLocal(_,T,E,W){return T&&(_=T.toGlobal(_,E,W)),W||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(_,E)}setParent(_){if(!_||!_.addChild)throw new Error("setParent: Argument must be a Container");return _.addChild(this),_}removeFromParent(){var _;(_=this.parent)==null||_.removeChild(this)}setTransform(_=0,T=0,E=1,W=1,X=0,q=0,Y=0,te=0,ne=0){return this.position.x=_,this.position.y=T,this.scale.x=E||1,this.scale.y=W||1,this.rotation=X,this.skew.x=q,this.skew.y=Y,this.pivot.x=te,this.pivot.y=ne,this}destroy(_){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent}enableTempParent(){const _=this.parent;return this.parent=this._tempDisplayObjectParent,_}disableTempParent(_){this.parent=_}get x(){return this.position.x}set x(_){this.transform.position.x=_}get y(){return this.position.y}set y(_){this.transform.position.y=_}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(_){this.transform.position.copyFrom(_)}get scale(){return this.transform.scale}set scale(_){this.transform.scale.copyFrom(_)}get pivot(){return this.transform.pivot}set pivot(_){this.transform.pivot.copyFrom(_)}get skew(){return this.transform.skew}set skew(_){this.transform.skew.copyFrom(_)}get rotation(){return this.transform.rotation}set rotation(_){this.transform.rotation=_}get angle(){return this.transform.rotation*RAD_TO_DEG}set angle(_){this.transform.rotation=_*DEG_TO_RAD}get zIndex(){return this._zIndex}set zIndex(_){this._zIndex!==_&&(this._zIndex=_,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let _=this;do{if(!_.visible)return!1;_=_.parent}while(_);return!0}get mask(){return this._mask}set mask(_){if(this._mask!==_){if(this._mask){const T=this._mask.isMaskData?this._mask.maskObject:this._mask;T&&(T._maskRefCount--,T._maskRefCount===0&&(T.renderable=!0,T.isMask=!1))}if(this._mask=_,this._mask){const T=this._mask.isMaskData?this._mask.maskObject:this._mask;T&&(T._maskRefCount===0&&(T.renderable=!1,T.isMask=!0),T._maskRefCount++)}}}}class TemporaryDisplayObject extends DisplayObject{constructor(){super(...arguments),this.sortDirty=null}}DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;const tempMatrix=new Matrix;function sortChildren(B,_){return B.zIndex===_.zIndex?B._lastSortedIndex-_._lastSortedIndex:B.zIndex-_.zIndex}const _Container=class Yh extends DisplayObject{constructor(){super(),this.children=[],this.sortableChildren=Yh.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(_){}addChild(..._){if(_.length>1)for(let T=0;T<_.length;T++)this.addChild(_[T]);else{const T=_[0];T.parent&&T.parent.removeChild(T),T.parent=this,this.sortDirty=!0,T.transform._parentID=-1,this.children.push(T),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",T,this,this.children.length-1),T.emit("added",this)}return _[0]}addChildAt(_,T){if(T<0||T>this.children.length)throw new Error(`${_}addChildAt: The index ${T} supplied is out of bounds ${this.children.length}`);return _.parent&&_.parent.removeChild(_),_.parent=this,this.sortDirty=!0,_.transform._parentID=-1,this.children.splice(T,0,_),this._boundsID++,this.onChildrenChange(T),_.emit("added",this),this.emit("childAdded",_,this,T),_}swapChildren(_,T){if(_===T)return;const E=this.getChildIndex(_),W=this.getChildIndex(T);this.children[E]=T,this.children[W]=_,this.onChildrenChange(E<W?E:W)}getChildIndex(_){const T=this.children.indexOf(_);if(T===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return T}setChildIndex(_,T){if(T<0||T>=this.children.length)throw new Error(`The index ${T} supplied is out of bounds ${this.children.length}`);const E=this.getChildIndex(_);removeItems(this.children,E,1),this.children.splice(T,0,_),this.onChildrenChange(T)}getChildAt(_){if(_<0||_>=this.children.length)throw new Error(`getChildAt: Index (${_}) does not exist.`);return this.children[_]}removeChild(..._){if(_.length>1)for(let T=0;T<_.length;T++)this.removeChild(_[T]);else{const T=_[0],E=this.children.indexOf(T);if(E===-1)return null;T.parent=null,T.transform._parentID=-1,removeItems(this.children,E,1),this._boundsID++,this.onChildrenChange(E),T.emit("removed",this),this.emit("childRemoved",T,this,E)}return _[0]}removeChildAt(_){const T=this.getChildAt(_);return T.parent=null,T.transform._parentID=-1,removeItems(this.children,_,1),this._boundsID++,this.onChildrenChange(_),T.emit("removed",this),this.emit("childRemoved",T,this,_),T}removeChildren(_=0,T=this.children.length){const E=_,W=T,X=W-E;let q;if(X>0&&X<=W){q=this.children.splice(E,X);for(let Y=0;Y<q.length;++Y)q[Y].parent=null,q[Y].transform&&(q[Y].transform._parentID=-1);this._boundsID++,this.onChildrenChange(_);for(let Y=0;Y<q.length;++Y)q[Y].emit("removed",this),this.emit("childRemoved",q[Y],this,Y);return q}else if(X===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let _=!1;for(let T=0,E=this.children.length;T<E;++T){const W=this.children[T];W._lastSortedIndex=T,!_&&W.zIndex!==0&&(_=!0)}_&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let _=0,T=this.children.length;_<T;++_){const E=this.children[_];E.visible&&E.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let _=0;_<this.children.length;_++){const T=this.children[_];if(!(!T.visible||!T.renderable))if(T.calculateBounds(),T._mask){const E=T._mask.isMaskData?T._mask.maskObject:T._mask;E?(E.calculateBounds(),this._bounds.addBoundsMask(T._bounds,E._bounds)):this._bounds.addBounds(T._bounds)}else T.filterArea?this._bounds.addBoundsArea(T._bounds,T.filterArea):this._bounds.addBounds(T._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(_,T=!1){const E=super.getLocalBounds(_);if(!T)for(let W=0,X=this.children.length;W<X;++W){const q=this.children[W];q.visible&&q.updateTransform()}return E}_calculateBounds(){}_renderWithCulling(_){const T=_.renderTexture.sourceFrame;if(!(T.width>0&&T.height>0))return;let E,W;this.cullArea?(E=this.cullArea,W=this.worldTransform):this._render!==Yh.prototype._render&&(E=this.getBounds(!0));const X=_.projection.transform;if(X&&(W?(W=tempMatrix.copyFrom(W),W.prepend(X)):W=X),E&&T.intersects(E,W))this._render(_);else if(this.cullArea)return;for(let q=0,Y=this.children.length;q<Y;++q){const te=this.children[q],ne=te.cullable;te.cullable=ne||!this.cullArea,te.render(_),te.cullable=ne}}render(_){var T;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(T=this.filters)!=null&&T.length)this.renderAdvanced(_);else if(this.cullable)this._renderWithCulling(_);else{this._render(_);for(let E=0,W=this.children.length;E<W;++E)this.children[E].render(_)}}renderAdvanced(_){var X,q,Y;const T=this.filters,E=this._mask;if(T){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let te=0;te<T.length;te++)T[te].enabled&&this._enabledFilters.push(T[te])}const W=T&&((X=this._enabledFilters)==null?void 0:X.length)||E&&(!E.isMaskData||E.enabled&&(E.autoDetect||E.type!==MASK_TYPES.NONE));if(W&&_.batch.flush(),T&&((q=this._enabledFilters)!=null&&q.length)&&_.filter.push(this,this._enabledFilters),E&&_.mask.push(this,this._mask),this.cullable)this._renderWithCulling(_);else{this._render(_);for(let te=0,ne=this.children.length;te<ne;++te)this.children[te].render(_)}W&&_.batch.flush(),E&&_.mask.pop(this),T&&((Y=this._enabledFilters)!=null&&Y.length)&&_.filter.pop()}_render(_){}destroy(_){super.destroy(),this.sortDirty=!1;const T=typeof _=="boolean"?_:_==null?void 0:_.children,E=this.removeChildren(0,this.children.length);if(T)for(let W=0;W<E.length;++W)E[W].destroy(_)}get width(){return this.scale.x*this.getLocalBounds().width}set width(_){const T=this.getLocalBounds().width;T!==0?this.scale.x=_/T:this.scale.x=1,this._width=_}get height(){return this.scale.y*this.getLocalBounds().height}set height(_){const T=this.getLocalBounds().height;T!==0?this.scale.y=_/T:this.scale.y=1,this._height=_}};_Container.defaultSortableChildren=!1;let Container=_Container;Container.prototype.containerUpdateTransform=Container.prototype.updateTransform;Object.defineProperties(settings,{SORTABLE_CHILDREN:{get(){return Container.defaultSortableChildren},set(B){deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Container.defaultSortableChildren=B}}});const tempPoint$1=new Point,indices=new Uint16Array([0,1,2,0,2,3]);let Sprite$1=class ug extends Container{constructor(_){super(),this._anchor=new ObservablePoint(this._onAnchorUpdate,this,_?_.defaultAnchor.x:0,_?_.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Color$1(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=BLEND_MODES.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=_||Texture$1.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=indices,this.pluginName="batch",this.isSprite=!0,this._roundPixels=settings.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=sign$1(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign$1(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const _=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===_._updateID)return;this._textureID!==_._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=_._updateID;const T=this.transform.worldTransform,E=T.a,W=T.b,X=T.c,q=T.d,Y=T.tx,te=T.ty,ne=this.vertexData,ae=_.trim,le=_.orig,ue=this._anchor;let ge=0,ye=0,xe=0,Te=0;if(ae?(ye=ae.x-ue._x*le.width,ge=ye+ae.width,Te=ae.y-ue._y*le.height,xe=Te+ae.height):(ye=-ue._x*le.width,ge=ye+le.width,Te=-ue._y*le.height,xe=Te+le.height),ne[0]=E*ye+X*Te+Y,ne[1]=q*Te+W*ye+te,ne[2]=E*ge+X*Te+Y,ne[3]=q*Te+W*ge+te,ne[4]=E*ge+X*xe+Y,ne[5]=q*xe+W*ge+te,ne[6]=E*ye+X*xe+Y,ne[7]=q*xe+W*ye+te,this._roundPixels){const Ae=settings.RESOLUTION;for(let Ie=0;Ie<ne.length;++Ie)ne[Ie]=Math.round(ne[Ie]*Ae)/Ae}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const _=this._texture,T=this.vertexTrimmedData,E=_.orig,W=this._anchor,X=this.transform.worldTransform,q=X.a,Y=X.b,te=X.c,ne=X.d,ae=X.tx,le=X.ty,ue=-W._x*E.width,ge=ue+E.width,ye=-W._y*E.height,xe=ye+E.height;if(T[0]=q*ue+te*ye+ae,T[1]=ne*ye+Y*ue+le,T[2]=q*ge+te*ye+ae,T[3]=ne*ye+Y*ge+le,T[4]=q*ge+te*xe+ae,T[5]=ne*xe+Y*ge+le,T[6]=q*ue+te*xe+ae,T[7]=ne*xe+Y*ue+le,this._roundPixels){const Te=settings.RESOLUTION;for(let Ae=0;Ae<T.length;++Ae)T[Ae]=Math.round(T[Ae]*Te)/Te}}_render(_){this.calculateVertices(),_.batch.setObjectRenderer(_.plugins[this.pluginName]),_.plugins[this.pluginName].render(this)}_calculateBounds(){const _=this._texture.trim,T=this._texture.orig;!_||_.width===T.width&&_.height===T.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(_){return this.children.length===0?(this._localBounds||(this._localBounds=new Bounds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),_||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),_=this._localBoundsRect),this._localBounds.getRectangle(_)):super.getLocalBounds.call(this,_)}containsPoint(_){this.worldTransform.applyInverse(_,tempPoint$1);const T=this._texture.orig.width,E=this._texture.orig.height,W=-T*this.anchor.x;let X=0;return tempPoint$1.x>=W&&tempPoint$1.x<W+T&&(X=-E*this.anchor.y,tempPoint$1.y>=X&&tempPoint$1.y<X+E)}destroy(_){if(super.destroy(_),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof _=="boolean"?_:_==null?void 0:_.texture){const T=typeof _=="boolean"?_:_==null?void 0:_.baseTexture;this._texture.destroy(!!T)}this._texture=null}static from(_,T){const E=_ instanceof Texture$1?_:Texture$1.from(_,T);return new ug(E)}set roundPixels(_){this._roundPixels!==_&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=_}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(_){const T=sign$1(this.scale.x)||1;this.scale.x=T*_/this._texture.orig.width,this._width=_}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(_){const T=sign$1(this.scale.y)||1;this.scale.y=T*_/this._texture.orig.height,this._height=_}get anchor(){return this._anchor}set anchor(_){this._anchor.copyFrom(_)}get tint(){return this._tintColor.value}set tint(_){this._tintColor.setValue(_),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(_){this._texture!==_&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=_||Texture$1.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,_&&(_.baseTexture.valid?this._onTextureUpdate():_.once("update",this._onTextureUpdate,this)))}};const _tempMatrix=new Matrix;DisplayObject.prototype._cacheAsBitmap=!1;DisplayObject.prototype._cacheData=null;DisplayObject.prototype._cacheAsBitmapResolution=null;DisplayObject.prototype._cacheAsBitmapMultisample=null;class CacheData{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(DisplayObject.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(B){B!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=B,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(B){B!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=B,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(B){if(this._cacheAsBitmap===B)return;this._cacheAsBitmap=B;let _;B?(this._cacheData||(this._cacheData=new CacheData),_=this._cacheData,_.originalRender=this.render,_.originalRenderCanvas=this.renderCanvas,_.originalUpdateTransform=this.updateTransform,_.originalCalculateBounds=this.calculateBounds,_.originalGetLocalBounds=this.getLocalBounds,_.originalDestroy=this.destroy,_.originalContainsPoint=this.containsPoint,_.originalMask=this._mask,_.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(_=this._cacheData,_.sprite&&this._destroyCachedDisplayObject(),this.render=_.originalRender,this.renderCanvas=_.originalRenderCanvas,this.calculateBounds=_.originalCalculateBounds,this.getLocalBounds=_.originalGetLocalBounds,this.destroy=_.originalDestroy,this.updateTransform=_.originalUpdateTransform,this.containsPoint=_.originalContainsPoint,this._mask=_.originalMask,this.filterArea=_.originalFilterArea)}}});DisplayObject.prototype._renderCached=function(B){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(B),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(B))};DisplayObject.prototype._initCachedDisplayObject=function(B){var ue,ge;if((ue=this._cacheData)!=null&&ue.sprite)return;const _=this.alpha;this.alpha=1,B.batch.flush();const T=this.getLocalBounds(new Rectangle,!0);if((ge=this.filters)!=null&&ge.length){const ye=this.filters[0].padding;T.pad(ye)}const E=this.cacheAsBitmapResolution||B.resolution;T.ceil(E),T.width=Math.max(T.width,1/E),T.height=Math.max(T.height,1/E);const W=B.renderTexture.current,X=B.renderTexture.sourceFrame.clone(),q=B.renderTexture.destinationFrame.clone(),Y=B.projection.transform,te=RenderTexture.create({width:T.width,height:T.height,resolution:E,multisample:this.cacheAsBitmapMultisample??B.multisample}),ne=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=ne,BaseTexture.addToCache(te.baseTexture,ne),Texture$1.addToCache(te,ne);const ae=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-T.x,-T.y);this.render=this._cacheData.originalRender,B.render(this,{renderTexture:te,clear:!0,transform:ae,skipUpdateTransform:!1}),B.framebuffer.blit(),B.projection.transform=Y,B.renderTexture.bind(W,X,q),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=_;const le=new Sprite$1(te);le.transform.worldTransform=this.transform.worldTransform,le.anchor.x=-(T.x/T.width),le.anchor.y=-(T.y/T.height),le.alpha=_,le._bounds=this._bounds,this._cacheData.sprite=le,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=le.containsPoint.bind(le)};DisplayObject.prototype._renderCachedCanvas=function(B){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(B),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(B))};DisplayObject.prototype._initCachedDisplayObjectCanvas=function(B){var ae;if((ae=this._cacheData)!=null&&ae.sprite)return;const _=this.getLocalBounds(new Rectangle,!0),T=this.alpha;this.alpha=1;const E=B.canvasContext.activeContext,W=B._projTransform,X=this.cacheAsBitmapResolution||B.resolution;_.ceil(X),_.width=Math.max(_.width,1/X),_.height=Math.max(_.height,1/X);const q=RenderTexture.create({width:_.width,height:_.height,resolution:X}),Y=`cacheAsBitmap_${uid()}`;this._cacheData.textureCacheId=Y,BaseTexture.addToCache(q.baseTexture,Y),Texture$1.addToCache(q,Y);const te=_tempMatrix;this.transform.localTransform.copyTo(te),te.invert(),te.tx-=_.x,te.ty-=_.y,this.renderCanvas=this._cacheData.originalRenderCanvas,B.render(this,{renderTexture:q,clear:!0,transform:te,skipUpdateTransform:!1}),B.canvasContext.activeContext=E,B._projTransform=W,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=T;const ne=new Sprite$1(q);ne.transform.worldTransform=this.transform.worldTransform,ne.anchor.x=-(_.x/_.width),ne.anchor.y=-(_.y/_.height),ne.alpha=T,ne._bounds=this._bounds,this._cacheData.sprite=ne,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=B._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=ne.containsPoint.bind(ne)};DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,BaseTexture.removeFromCache(this._cacheData.textureCacheId),Texture$1.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};DisplayObject.prototype._cacheAsBitmapDestroy=function(B){this.cacheAsBitmap=!1,this.destroy(B)};DisplayObject.prototype.name=null;Container.prototype.getChildByName=function(B,_){for(let T=0,E=this.children.length;T<E;T++)if(this.children[T].name===B)return this.children[T];if(_)for(let T=0,E=this.children.length;T<E;T++){const W=this.children[T];if(!W.getChildByName)continue;const X=W.getChildByName(B,!0);if(X)return X}return null};DisplayObject.prototype.getGlobalPosition=function(B=new Point,_=!1){return this.parent?this.parent.toGlobal(this.position,B,_):(B.x=this.position.x,B.y=this.position.y),B};var fragment$p=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class AlphaFilter extends Filter{constructor(_=1){super(defaultVertex,fragment$p,{uAlpha:1}),this.alpha=_}get alpha(){return this.uniforms.uAlpha}set alpha(_){this.uniforms.uAlpha=_}}const GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function generateBlurFragSource(B){const _=GAUSSIAN_VALUES[B],T=_.length;let E=fragTemplate,W="";const X="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let q;for(let Y=0;Y<B;Y++){let te=X.replace("%index%",Y.toString());q=Y,Y>=T&&(q=B-Y-1),te=te.replace("%value%",_[q].toString()),W+=te,W+=`
`}return E=E.replace("%blur%",W),E=E.replace("%size%",B.toString()),E}const vertTemplate=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function generateBlurVertSource(B,_){const T=Math.ceil(B/2);let E=vertTemplate,W="",X;_?X="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":X="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let q=0;q<B;q++){let Y=X.replace("%index%",q.toString());Y=Y.replace("%sampleIndex%",`${q-(T-1)}.0`),W+=Y,W+=`
`}return E=E.replace("%blur%",W),E=E.replace("%size%",B.toString()),E}class BlurFilterPass extends Filter{constructor(_,T=8,E=4,W=Filter.defaultResolution,X=5){const q=generateBlurVertSource(X,_),Y=generateBlurFragSource(X);super(q,Y),this.horizontal=_,this.resolution=W,this._quality=0,this.quality=E,this.blur=T}apply(_,T,E,W){if(E?this.horizontal?this.uniforms.strength=1/E.width*(E.width/T.width):this.uniforms.strength=1/E.height*(E.height/T.height):this.horizontal?this.uniforms.strength=1/_.renderer.width*(_.renderer.width/T.width):this.uniforms.strength=1/_.renderer.height*(_.renderer.height/T.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)_.applyFilter(this,T,E,W);else{const X=_.getFilterTexture(),q=_.renderer;let Y=T,te=X;this.state.blend=!1,_.applyFilter(this,Y,te,CLEAR_MODES.CLEAR);for(let ne=1;ne<this.passes-1;ne++){_.bindAndClear(Y,CLEAR_MODES.BLIT),this.uniforms.uSampler=te;const ae=te;te=Y,Y=ae,q.shader.bind(this),q.geometry.draw(5)}this.state.blend=!0,_.applyFilter(this,te,E,W),_.returnFilterTexture(X)}}get blur(){return this.strength}set blur(_){this.padding=1+Math.abs(_)*2,this.strength=_}get quality(){return this._quality}set quality(_){this._quality=_,this.passes=_}}class BlurFilter extends Filter{constructor(_=8,T=4,E=Filter.defaultResolution,W=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new BlurFilterPass(!0,_,T,E,W),this.blurYFilter=new BlurFilterPass(!1,_,T,E,W),this.resolution=E,this.quality=T,this.blur=_,this.repeatEdgePixels=!1}apply(_,T,E,W){const X=Math.abs(this.blurXFilter.strength),q=Math.abs(this.blurYFilter.strength);if(X&&q){const Y=_.getFilterTexture();this.blurXFilter.apply(_,T,Y,CLEAR_MODES.CLEAR),this.blurYFilter.apply(_,Y,E,W),_.returnFilterTexture(Y)}else q?this.blurYFilter.apply(_,T,E,W):this.blurXFilter.apply(_,T,E,W)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(_){this.blurXFilter.blur=this.blurYFilter.blur=_,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(_){this.blurXFilter.quality=this.blurYFilter.quality=_}get blurX(){return this.blurXFilter.blur}set blurX(_){this.blurXFilter.blur=_,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(_){this.blurYFilter.blur=_,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(_){this.blurYFilter.blendMode=_}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(_){this._repeatEdgePixels=_,this.updatePadding()}}var fragment$o=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ColorMatrixFilter extends Filter{constructor(){const _={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(defaultFilterVertex,fragment$o,_),this.alpha=1}_loadMatrix(_,T=!1){let E=_;T&&(this._multiply(E,this.uniforms.m,_),E=this._colorMatrix(E)),this.uniforms.m=E}_multiply(_,T,E){return _[0]=T[0]*E[0]+T[1]*E[5]+T[2]*E[10]+T[3]*E[15],_[1]=T[0]*E[1]+T[1]*E[6]+T[2]*E[11]+T[3]*E[16],_[2]=T[0]*E[2]+T[1]*E[7]+T[2]*E[12]+T[3]*E[17],_[3]=T[0]*E[3]+T[1]*E[8]+T[2]*E[13]+T[3]*E[18],_[4]=T[0]*E[4]+T[1]*E[9]+T[2]*E[14]+T[3]*E[19]+T[4],_[5]=T[5]*E[0]+T[6]*E[5]+T[7]*E[10]+T[8]*E[15],_[6]=T[5]*E[1]+T[6]*E[6]+T[7]*E[11]+T[8]*E[16],_[7]=T[5]*E[2]+T[6]*E[7]+T[7]*E[12]+T[8]*E[17],_[8]=T[5]*E[3]+T[6]*E[8]+T[7]*E[13]+T[8]*E[18],_[9]=T[5]*E[4]+T[6]*E[9]+T[7]*E[14]+T[8]*E[19]+T[9],_[10]=T[10]*E[0]+T[11]*E[5]+T[12]*E[10]+T[13]*E[15],_[11]=T[10]*E[1]+T[11]*E[6]+T[12]*E[11]+T[13]*E[16],_[12]=T[10]*E[2]+T[11]*E[7]+T[12]*E[12]+T[13]*E[17],_[13]=T[10]*E[3]+T[11]*E[8]+T[12]*E[13]+T[13]*E[18],_[14]=T[10]*E[4]+T[11]*E[9]+T[12]*E[14]+T[13]*E[19]+T[14],_[15]=T[15]*E[0]+T[16]*E[5]+T[17]*E[10]+T[18]*E[15],_[16]=T[15]*E[1]+T[16]*E[6]+T[17]*E[11]+T[18]*E[16],_[17]=T[15]*E[2]+T[16]*E[7]+T[17]*E[12]+T[18]*E[17],_[18]=T[15]*E[3]+T[16]*E[8]+T[17]*E[13]+T[18]*E[18],_[19]=T[15]*E[4]+T[16]*E[9]+T[17]*E[14]+T[18]*E[19]+T[19],_}_colorMatrix(_){const T=new Float32Array(_);return T[4]/=255,T[9]/=255,T[14]/=255,T[19]/=255,T}brightness(_,T){const E=[_,0,0,0,0,0,_,0,0,0,0,0,_,0,0,0,0,0,1,0];this._loadMatrix(E,T)}tint(_,T){const[E,W,X]=Color$1.shared.setValue(_).toArray(),q=[E,0,0,0,0,0,W,0,0,0,0,0,X,0,0,0,0,0,1,0];this._loadMatrix(q,T)}greyscale(_,T){const E=[_,_,_,0,0,_,_,_,0,0,_,_,_,0,0,0,0,0,1,0];this._loadMatrix(E,T)}blackAndWhite(_){const T=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(T,_)}hue(_,T){_=(_||0)/180*Math.PI;const E=Math.cos(_),W=Math.sin(_),X=Math.sqrt,q=1/3,Y=X(q),te=E+(1-E)*q,ne=q*(1-E)-Y*W,ae=q*(1-E)+Y*W,le=q*(1-E)+Y*W,ue=E+q*(1-E),ge=q*(1-E)-Y*W,ye=q*(1-E)-Y*W,xe=q*(1-E)+Y*W,Te=E+q*(1-E),Ae=[te,ne,ae,0,0,le,ue,ge,0,0,ye,xe,Te,0,0,0,0,0,1,0];this._loadMatrix(Ae,T)}contrast(_,T){const E=(_||0)+1,W=-.5*(E-1),X=[E,0,0,0,W,0,E,0,0,W,0,0,E,0,W,0,0,0,1,0];this._loadMatrix(X,T)}saturate(_=0,T){const E=_*2/3+1,W=(E-1)*-.5,X=[E,W,W,0,0,W,E,W,0,0,W,W,E,0,0,0,0,0,1,0];this._loadMatrix(X,T)}desaturate(){this.saturate(-1)}negative(_){const T=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(T,_)}sepia(_){const T=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(T,_)}technicolor(_){const T=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(T,_)}polaroid(_){const T=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(T,_)}toBGR(_){const T=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(T,_)}kodachrome(_){const T=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(T,_)}browni(_){const T=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(T,_)}vintage(_){const T=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(T,_)}colorTone(_,T,E,W,X){_=_||.2,T=T||.15,E=E||16770432,W=W||3375104;const q=Color$1.shared,[Y,te,ne]=q.setValue(E).toArray(),[ae,le,ue]=q.setValue(W).toArray(),ge=[.3,.59,.11,0,0,Y,te,ne,_,0,ae,le,ue,T,0,Y-ae,te-le,ne-ue,0,0];this._loadMatrix(ge,X)}night(_,T){_=_||.1;const E=[_*-2,-_,0,0,0,-_,0,_,0,0,0,_,_*2,0,0,0,0,0,1,0];this._loadMatrix(E,T)}predator(_,T){const E=[11.224130630493164*_,-4.794486999511719*_,-2.8746118545532227*_,0*_,.40342438220977783*_,-3.6330697536468506*_,9.193157196044922*_,-2.951810836791992*_,0*_,-1.316135048866272*_,-3.2184197902679443*_,-4.2375030517578125*_,7.476448059082031*_,0*_,.8044459223747253*_,0,0,0,1,0];this._loadMatrix(E,T)}lsd(_){const T=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(T,_)}reset(){const _=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(_,!1)}get matrix(){return this.uniforms.m}set matrix(_){this.uniforms.m=_}get alpha(){return this.uniforms.uAlpha}set alpha(_){this.uniforms.uAlpha=_}}ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var fragment$n=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,vertex$m=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class DisplacementFilter extends Filter{constructor(_,T){const E=new Matrix;_.renderable=!1,super(vertex$m,fragment$n,{mapSampler:_._texture,filterMatrix:E,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=_,this.maskMatrix=E,T==null&&(T=20),this.scale=new Point(T,T)}apply(_,T,E,W){this.uniforms.filterMatrix=_.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const X=this.maskSprite.worldTransform,q=Math.sqrt(X.a*X.a+X.b*X.b),Y=Math.sqrt(X.c*X.c+X.d*X.d);q!==0&&Y!==0&&(this.uniforms.rotation[0]=X.a/q,this.uniforms.rotation[1]=X.b/q,this.uniforms.rotation[2]=X.c/Y,this.uniforms.rotation[3]=X.d/Y),_.applyFilter(this,T,E,W)}get map(){return this.uniforms.mapSampler}set map(_){this.uniforms.mapSampler=_}}var fragment$m=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,vertex$l=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class FXAAFilter extends Filter{constructor(){super(vertex$l,fragment$m)}}var fragment$l=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class NoiseFilter extends Filter{constructor(_=.5,T=Math.random()){super(defaultFilterVertex,fragment$l,{uNoise:0,uSeed:0}),this.noise=_,this.seed=T}get noise(){return this.uniforms.uNoise}set noise(_){this.uniforms.uNoise=_}get seed(){return this.uniforms.uSeed}set seed(_){this.uniforms.uSeed=_}}const filters={AlphaFilter,BlurFilter,BlurFilterPass,ColorMatrixFilter,DisplacementFilter,FXAAFilter,NoiseFilter};Object.entries(filters).forEach(([B,_])=>{Object.defineProperty(filters,B,{get(){return deprecation("7.1.0",`filters.${B} has moved to ${B}`),_}})});class EventsTickerClass{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(_){this.removeTickerListener(),this.events=_,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(_){this._pauseUpdate=_}addTickerListener(){this.tickerAdded||!this.domElement||(Ticker$1.system.add(this.tickerUpdate,this,UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Ticker$1.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const _=this.events.rootPointerEvent;this.events.supportsTouchEvents&&_.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:_.clientX,clientY:_.clientY}))}tickerUpdate(_){this._deltaTime+=_,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const EventsTicker=new EventsTickerClass;class FederatedEvent{constructor(_){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Point,this.page=new Point,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=_}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(_,T,E){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(_,T,E,W,X){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class FederatedMouseEvent extends FederatedEvent{constructor(){super(...arguments),this.client=new Point,this.movement=new Point,this.offset=new Point,this.global=new Point,this.screen=new Point}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(_,T,E){return _.worldTransform.applyInverse(E||this.global,T)}getModifierState(_){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(_)}initMouseEvent(_,T,E,W,X,q,Y,te,ne,ae,le,ue,ge,ye,xe){throw new Error("Method not implemented.")}}class FederatedPointerEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class FederatedWheelEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}FederatedWheelEvent.DOM_DELTA_PIXEL=0,FederatedWheelEvent.DOM_DELTA_LINE=1,FederatedWheelEvent.DOM_DELTA_PAGE=2;const PROPAGATION_LIMIT=2048,tempHitLocation=new Point,tempLocalMapping=new Point;class EventBoundary{constructor(_){this.dispatch=new EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=_,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(_,T){this.mappingTable[_]||(this.mappingTable[_]=[]),this.mappingTable[_].push({fn:T,priority:0}),this.mappingTable[_].sort((E,W)=>E.priority-W.priority)}dispatchEvent(_,T){_.propagationStopped=!1,_.propagationImmediatelyStopped=!1,this.propagate(_,T),this.dispatch.emit(T||_.type,_)}mapEvent(_){if(!this.rootTarget)return;const T=this.mappingTable[_.type];if(T)for(let E=0,W=T.length;E<W;E++)T[E].fn(_);else console.warn(`[EventBoundary]: Event mapping not defined for ${_.type}`)}hitTest(_,T){EventsTicker.pauseUpdate=!0;const E=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",W=this[E](this.rootTarget,this.rootTarget.eventMode,tempHitLocation.set(_,T),this.hitTestFn,this.hitPruneFn);return W&&W[0]}propagate(_,T){if(!_.target)return;const E=_.composedPath();_.eventPhase=_.CAPTURING_PHASE;for(let W=0,X=E.length-1;W<X;W++)if(_.currentTarget=E[W],this.notifyTarget(_,T),_.propagationStopped||_.propagationImmediatelyStopped)return;if(_.eventPhase=_.AT_TARGET,_.currentTarget=_.target,this.notifyTarget(_,T),!(_.propagationStopped||_.propagationImmediatelyStopped)){_.eventPhase=_.BUBBLING_PHASE;for(let W=E.length-2;W>=0;W--)if(_.currentTarget=E[W],this.notifyTarget(_,T),_.propagationStopped||_.propagationImmediatelyStopped)return}}all(_,T,E=this._allInteractiveElements){if(E.length===0)return;_.eventPhase=_.BUBBLING_PHASE;const W=Array.isArray(T)?T:[T];for(let X=E.length-1;X>=0;X--)W.forEach(q=>{_.currentTarget=E[X],this.notifyTarget(_,q)})}propagationPath(_){const T=[_];for(let E=0;E<PROPAGATION_LIMIT&&_!==this.rootTarget;E++){if(!_.parent)throw new Error("Cannot find propagation path to disconnected target");T.push(_.parent),_=_.parent}return T.reverse(),T}hitTestMoveRecursive(_,T,E,W,X,q=!1){let Y=!1;if(this._interactivePrune(_))return null;if((_.eventMode==="dynamic"||T==="dynamic")&&(EventsTicker.pauseUpdate=!1),_.interactiveChildren&&_.children){const ae=_.children;for(let le=ae.length-1;le>=0;le--){const ue=ae[le],ge=this.hitTestMoveRecursive(ue,this._isInteractive(T)?T:ue.eventMode,E,W,X,q||X(_,E));if(ge){if(ge.length>0&&!ge[ge.length-1].parent)continue;const ye=_.isInteractive();(ge.length>0||ye)&&(ye&&this._allInteractiveElements.push(_),ge.push(_)),this._hitElements.length===0&&(this._hitElements=ge),Y=!0}}}const te=this._isInteractive(T),ne=_.isInteractive();return te&&ne&&this._allInteractiveElements.push(_),q||this._hitElements.length>0?null:Y?this._hitElements:te&&!X(_,E)&&W(_,E)?ne?[_]:[]:null}hitTestRecursive(_,T,E,W,X){if(this._interactivePrune(_)||X(_,E))return null;if((_.eventMode==="dynamic"||T==="dynamic")&&(EventsTicker.pauseUpdate=!1),_.interactiveChildren&&_.children){const te=_.children;for(let ne=te.length-1;ne>=0;ne--){const ae=te[ne],le=this.hitTestRecursive(ae,this._isInteractive(T)?T:ae.eventMode,E,W,X);if(le){if(le.length>0&&!le[le.length-1].parent)continue;const ue=_.isInteractive();return(le.length>0||ue)&&le.push(_),le}}}const q=this._isInteractive(T),Y=_.isInteractive();return q&&W(_,E)?Y?[_]:[]:null}_isInteractive(_){return _==="static"||_==="dynamic"}_interactivePrune(_){return!!(!_||_.isMask||!_.visible||!_.renderable||_.eventMode==="none"||_.eventMode==="passive"&&!_.interactiveChildren||_.isMask)}hitPruneFn(_,T){var E;if(_.hitArea&&(_.worldTransform.applyInverse(T,tempLocalMapping),!_.hitArea.contains(tempLocalMapping.x,tempLocalMapping.y)))return!0;if(_._mask){const W=_._mask.isMaskData?_._mask.maskObject:_._mask;if(W&&!((E=W.containsPoint)!=null&&E.call(W,T)))return!0}return!1}hitTestFn(_,T){return _.eventMode==="passive"?!1:_.hitArea?!0:_.containsPoint?_.containsPoint(T):!1}notifyTarget(_,T){var X,q;T=T??_.type;const E=`on${T}`;(q=(X=_.currentTarget)[E])==null||q.call(X,_);const W=_.eventPhase===_.CAPTURING_PHASE||_.eventPhase===_.AT_TARGET?`${T}capture`:T;this.notifyListeners(_,W),_.eventPhase===_.AT_TARGET&&this.notifyListeners(_,T)}mapPointerDown(_){if(!(_ instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const T=this.createPointerEvent(_);if(this.dispatchEvent(T,"pointerdown"),T.pointerType==="touch")this.dispatchEvent(T,"touchstart");else if(T.pointerType==="mouse"||T.pointerType==="pen"){const W=T.button===2;this.dispatchEvent(T,W?"rightdown":"mousedown")}const E=this.trackingData(_.pointerId);E.pressTargetsByButton[_.button]=T.composedPath(),this.freeEvent(T)}mapPointerMove(_){var te,ne;if(!(_ instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const T=this.createPointerEvent(_);this._isPointerMoveEvent=!1;const E=T.pointerType==="mouse"||T.pointerType==="pen",W=this.trackingData(_.pointerId),X=this.findMountedTarget(W.overTargets);if(((te=W.overTargets)==null?void 0:te.length)>0&&X!==T.target){const ae=_.type==="mousemove"?"mouseout":"pointerout",le=this.createPointerEvent(_,ae,X);if(this.dispatchEvent(le,"pointerout"),E&&this.dispatchEvent(le,"mouseout"),!T.composedPath().includes(X)){const ue=this.createPointerEvent(_,"pointerleave",X);for(ue.eventPhase=ue.AT_TARGET;ue.target&&!T.composedPath().includes(ue.target);)ue.currentTarget=ue.target,this.notifyTarget(ue),E&&this.notifyTarget(ue,"mouseleave"),ue.target=ue.target.parent;this.freeEvent(ue)}this.freeEvent(le)}if(X!==T.target){const ae=_.type==="mousemove"?"mouseover":"pointerover",le=this.clonePointerEvent(T,ae);this.dispatchEvent(le,"pointerover"),E&&this.dispatchEvent(le,"mouseover");let ue=X==null?void 0:X.parent;for(;ue&&ue!==this.rootTarget.parent&&ue!==T.target;)ue=ue.parent;if(!ue||ue===this.rootTarget.parent){const ge=this.clonePointerEvent(T,"pointerenter");for(ge.eventPhase=ge.AT_TARGET;ge.target&&ge.target!==X&&ge.target!==this.rootTarget.parent;)ge.currentTarget=ge.target,this.notifyTarget(ge),E&&this.notifyTarget(ge,"mouseenter"),ge.target=ge.target.parent;this.freeEvent(ge)}this.freeEvent(le)}const q=[],Y=this.enableGlobalMoveEvents??!0;this.moveOnAll?q.push("pointermove"):this.dispatchEvent(T,"pointermove"),Y&&q.push("globalpointermove"),T.pointerType==="touch"&&(this.moveOnAll?q.splice(1,0,"touchmove"):this.dispatchEvent(T,"touchmove"),Y&&q.push("globaltouchmove")),E&&(this.moveOnAll?q.splice(1,0,"mousemove"):this.dispatchEvent(T,"mousemove"),Y&&q.push("globalmousemove"),this.cursor=(ne=T.target)==null?void 0:ne.cursor),q.length>0&&this.all(T,q),this._allInteractiveElements.length=0,this._hitElements.length=0,W.overTargets=T.composedPath(),this.freeEvent(T)}mapPointerOver(_){var q;if(!(_ instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const T=this.trackingData(_.pointerId),E=this.createPointerEvent(_),W=E.pointerType==="mouse"||E.pointerType==="pen";this.dispatchEvent(E,"pointerover"),W&&this.dispatchEvent(E,"mouseover"),E.pointerType==="mouse"&&(this.cursor=(q=E.target)==null?void 0:q.cursor);const X=this.clonePointerEvent(E,"pointerenter");for(X.eventPhase=X.AT_TARGET;X.target&&X.target!==this.rootTarget.parent;)X.currentTarget=X.target,this.notifyTarget(X),W&&this.notifyTarget(X,"mouseenter"),X.target=X.target.parent;T.overTargets=E.composedPath(),this.freeEvent(E),this.freeEvent(X)}mapPointerOut(_){if(!(_ instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const T=this.trackingData(_.pointerId);if(T.overTargets){const E=_.pointerType==="mouse"||_.pointerType==="pen",W=this.findMountedTarget(T.overTargets),X=this.createPointerEvent(_,"pointerout",W);this.dispatchEvent(X),E&&this.dispatchEvent(X,"mouseout");const q=this.createPointerEvent(_,"pointerleave",W);for(q.eventPhase=q.AT_TARGET;q.target&&q.target!==this.rootTarget.parent;)q.currentTarget=q.target,this.notifyTarget(q),E&&this.notifyTarget(q,"mouseleave"),q.target=q.target.parent;T.overTargets=null,this.freeEvent(X),this.freeEvent(q)}this.cursor=null}mapPointerUp(_){if(!(_ instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const T=performance.now(),E=this.createPointerEvent(_);if(this.dispatchEvent(E,"pointerup"),E.pointerType==="touch")this.dispatchEvent(E,"touchend");else if(E.pointerType==="mouse"||E.pointerType==="pen"){const Y=E.button===2;this.dispatchEvent(E,Y?"rightup":"mouseup")}const W=this.trackingData(_.pointerId),X=this.findMountedTarget(W.pressTargetsByButton[_.button]);let q=X;if(X&&!E.composedPath().includes(X)){let Y=X;for(;Y&&!E.composedPath().includes(Y);){if(E.currentTarget=Y,this.notifyTarget(E,"pointerupoutside"),E.pointerType==="touch")this.notifyTarget(E,"touchendoutside");else if(E.pointerType==="mouse"||E.pointerType==="pen"){const te=E.button===2;this.notifyTarget(E,te?"rightupoutside":"mouseupoutside")}Y=Y.parent}delete W.pressTargetsByButton[_.button],q=Y}if(q){const Y=this.clonePointerEvent(E,"click");Y.target=q,Y.path=null,W.clicksByButton[_.button]||(W.clicksByButton[_.button]={clickCount:0,target:Y.target,timeStamp:T});const te=W.clicksByButton[_.button];if(te.target===Y.target&&T-te.timeStamp<200?++te.clickCount:te.clickCount=1,te.target=Y.target,te.timeStamp=T,Y.detail=te.clickCount,Y.pointerType==="mouse"){const ne=Y.button===2;this.dispatchEvent(Y,ne?"rightclick":"click")}else Y.pointerType==="touch"&&this.dispatchEvent(Y,"tap");this.dispatchEvent(Y,"pointertap"),this.freeEvent(Y)}this.freeEvent(E)}mapPointerUpOutside(_){if(!(_ instanceof FederatedPointerEvent)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const T=this.trackingData(_.pointerId),E=this.findMountedTarget(T.pressTargetsByButton[_.button]),W=this.createPointerEvent(_);if(E){let X=E;for(;X;)W.currentTarget=X,this.notifyTarget(W,"pointerupoutside"),W.pointerType==="touch"?this.notifyTarget(W,"touchendoutside"):(W.pointerType==="mouse"||W.pointerType==="pen")&&this.notifyTarget(W,W.button===2?"rightupoutside":"mouseupoutside"),X=X.parent;delete T.pressTargetsByButton[_.button]}this.freeEvent(W)}mapWheel(_){if(!(_ instanceof FederatedWheelEvent)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const T=this.createWheelEvent(_);this.dispatchEvent(T),this.freeEvent(T)}findMountedTarget(_){if(!_)return null;let T=_[0];for(let E=1;E<_.length&&_[E].parent===T;E++)T=_[E];return T}createPointerEvent(_,T,E){const W=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(_,W),this.copyMouseData(_,W),this.copyData(_,W),W.nativeEvent=_.nativeEvent,W.originalEvent=_,W.target=E??this.hitTest(W.global.x,W.global.y)??this._hitElements[0],typeof T=="string"&&(W.type=T),W}createWheelEvent(_){const T=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(_,T),this.copyMouseData(_,T),this.copyData(_,T),T.nativeEvent=_.nativeEvent,T.originalEvent=_,T.target=this.hitTest(T.global.x,T.global.y),T}clonePointerEvent(_,T){const E=this.allocateEvent(FederatedPointerEvent);return E.nativeEvent=_.nativeEvent,E.originalEvent=_.originalEvent,this.copyPointerData(_,E),this.copyMouseData(_,E),this.copyData(_,E),E.target=_.target,E.path=_.composedPath().slice(),E.type=T??E.type,E}copyWheelData(_,T){T.deltaMode=_.deltaMode,T.deltaX=_.deltaX,T.deltaY=_.deltaY,T.deltaZ=_.deltaZ}copyPointerData(_,T){_ instanceof FederatedPointerEvent&&T instanceof FederatedPointerEvent&&(T.pointerId=_.pointerId,T.width=_.width,T.height=_.height,T.isPrimary=_.isPrimary,T.pointerType=_.pointerType,T.pressure=_.pressure,T.tangentialPressure=_.tangentialPressure,T.tiltX=_.tiltX,T.tiltY=_.tiltY,T.twist=_.twist)}copyMouseData(_,T){_ instanceof FederatedMouseEvent&&T instanceof FederatedMouseEvent&&(T.altKey=_.altKey,T.button=_.button,T.buttons=_.buttons,T.client.copyFrom(_.client),T.ctrlKey=_.ctrlKey,T.metaKey=_.metaKey,T.movement.copyFrom(_.movement),T.screen.copyFrom(_.screen),T.shiftKey=_.shiftKey,T.global.copyFrom(_.global))}copyData(_,T){T.isTrusted=_.isTrusted,T.srcElement=_.srcElement,T.timeStamp=performance.now(),T.type=_.type,T.detail=_.detail,T.view=_.view,T.which=_.which,T.layer.copyFrom(_.layer),T.page.copyFrom(_.page)}trackingData(_){return this.mappingState.trackingData[_]||(this.mappingState.trackingData[_]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[_]}allocateEvent(_){this.eventPool.has(_)||this.eventPool.set(_,[]);const T=this.eventPool.get(_).pop()||new _(this);return T.eventPhase=T.NONE,T.currentTarget=null,T.path=null,T.target=null,T}freeEvent(_){if(_.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const T=_.constructor;this.eventPool.has(T)||this.eventPool.set(T,[]),this.eventPool.get(T).push(_)}notifyListeners(_,T){const E=_.currentTarget._events[T];if(E&&_.currentTarget.isInteractive())if("fn"in E)E.once&&_.currentTarget.removeListener(T,E.fn,void 0,!0),E.fn.call(E.context,_);else for(let W=0,X=E.length;W<X&&!_.propagationImmediatelyStopped;W++)E[W].once&&_.currentTarget.removeListener(T,E[W].fn,void 0,!0),E[W].fn.call(E[W].context,_)}}const MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},_EventSystem=class Kh{constructor(_){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=_,this.rootBoundary=new EventBoundary(null),EventsTicker.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent(null),this.rootWheelEvent=new FederatedWheelEvent(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Kh.defaultEventFeatures},{set:(T,E,W)=>(E==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=W),T[E]=W,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(_){const{view:T,resolution:E}=this.renderer;this.setTargetElement(T),this.resolution=E,Kh._defaultEventMode=_.eventMode??"auto",Object.assign(this.features,_.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(_){this.resolution=_}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(_){_=_||"default";let T=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(T=!1),this.currentCursor===_)return;this.currentCursor=_;const E=this.cursorStyles[_];if(E)switch(typeof E){case"string":T&&(this.domElement.style.cursor=E);break;case"function":E(_);break;case"object":T&&Object.assign(this.domElement.style,E);break}else T&&typeof _=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,_)&&(this.domElement.style.cursor=_)}get pointer(){return this.rootPointerEvent}onPointerDown(_){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const T=this.normalizeToPointerData(_);this.autoPreventDefault&&T[0].isNormalized&&(_.cancelable||!("cancelable"in _))&&_.preventDefault();for(let E=0,W=T.length;E<W;E++){const X=T[E],q=this.bootstrapEvent(this.rootPointerEvent,X);this.rootBoundary.mapEvent(q)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(_){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,EventsTicker.pointerMoved();const T=this.normalizeToPointerData(_);for(let E=0,W=T.length;E<W;E++){const X=this.bootstrapEvent(this.rootPointerEvent,T[E]);this.rootBoundary.mapEvent(X)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(_){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let T=_.target;_.composedPath&&_.composedPath().length>0&&(T=_.composedPath()[0]);const E=T!==this.domElement?"outside":"",W=this.normalizeToPointerData(_);for(let X=0,q=W.length;X<q;X++){const Y=this.bootstrapEvent(this.rootPointerEvent,W[X]);Y.type+=E,this.rootBoundary.mapEvent(Y)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(_){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const T=this.normalizeToPointerData(_);for(let E=0,W=T.length;E<W;E++){const X=this.bootstrapEvent(this.rootPointerEvent,T[E]);this.rootBoundary.mapEvent(X)}this.setCursor(this.rootBoundary.cursor)}onWheel(_){if(!this.features.wheel)return;const T=this.normalizeWheelEvent(_);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(T)}setTargetElement(_){this.removeEvents(),this.domElement=_,EventsTicker.domElement=_,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;EventsTicker.addTickerListener();const _=this.domElement.style;_&&(globalThis.navigator.msPointerEnabled?(_.msContentZooming="none",_.msTouchAction="none"):this.supportsPointerEvents&&(_.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;EventsTicker.removeTickerListener();const _=this.domElement.style;globalThis.navigator.msPointerEnabled?(_.msContentZooming="",_.msTouchAction=""):this.supportsPointerEvents&&(_.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(_,T,E){const W=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},X=1/this.resolution;_.x=(T-W.left)*(this.domElement.width/W.width)*X,_.y=(E-W.top)*(this.domElement.height/W.height)*X}normalizeToPointerData(_){const T=[];if(this.supportsTouchEvents&&_ instanceof TouchEvent)for(let E=0,W=_.changedTouches.length;E<W;E++){const X=_.changedTouches[E];typeof X.button>"u"&&(X.button=0),typeof X.buttons>"u"&&(X.buttons=1),typeof X.isPrimary>"u"&&(X.isPrimary=_.touches.length===1&&_.type==="touchstart"),typeof X.width>"u"&&(X.width=X.radiusX||1),typeof X.height>"u"&&(X.height=X.radiusY||1),typeof X.tiltX>"u"&&(X.tiltX=0),typeof X.tiltY>"u"&&(X.tiltY=0),typeof X.pointerType>"u"&&(X.pointerType="touch"),typeof X.pointerId>"u"&&(X.pointerId=X.identifier||0),typeof X.pressure>"u"&&(X.pressure=X.force||.5),typeof X.twist>"u"&&(X.twist=0),typeof X.tangentialPressure>"u"&&(X.tangentialPressure=0),typeof X.layerX>"u"&&(X.layerX=X.offsetX=X.clientX),typeof X.layerY>"u"&&(X.layerY=X.offsetY=X.clientY),X.isNormalized=!0,X.type=_.type,T.push(X)}else if(!globalThis.MouseEvent||_ instanceof MouseEvent&&(!this.supportsPointerEvents||!(_ instanceof globalThis.PointerEvent))){const E=_;typeof E.isPrimary>"u"&&(E.isPrimary=!0),typeof E.width>"u"&&(E.width=1),typeof E.height>"u"&&(E.height=1),typeof E.tiltX>"u"&&(E.tiltX=0),typeof E.tiltY>"u"&&(E.tiltY=0),typeof E.pointerType>"u"&&(E.pointerType="mouse"),typeof E.pointerId>"u"&&(E.pointerId=MOUSE_POINTER_ID),typeof E.pressure>"u"&&(E.pressure=.5),typeof E.twist>"u"&&(E.twist=0),typeof E.tangentialPressure>"u"&&(E.tangentialPressure=0),E.isNormalized=!0,T.push(E)}else T.push(_);return T}normalizeWheelEvent(_){const T=this.rootWheelEvent;return this.transferMouseData(T,_),T.deltaX=_.deltaX,T.deltaY=_.deltaY,T.deltaZ=_.deltaZ,T.deltaMode=_.deltaMode,this.mapPositionToPoint(T.screen,_.clientX,_.clientY),T.global.copyFrom(T.screen),T.offset.copyFrom(T.screen),T.nativeEvent=_,T.type=_.type,T}bootstrapEvent(_,T){return _.originalEvent=null,_.nativeEvent=T,_.pointerId=T.pointerId,_.width=T.width,_.height=T.height,_.isPrimary=T.isPrimary,_.pointerType=T.pointerType,_.pressure=T.pressure,_.tangentialPressure=T.tangentialPressure,_.tiltX=T.tiltX,_.tiltY=T.tiltY,_.twist=T.twist,this.transferMouseData(_,T),this.mapPositionToPoint(_.screen,T.clientX,T.clientY),_.global.copyFrom(_.screen),_.offset.copyFrom(_.screen),_.isTrusted=T.isTrusted,_.type==="pointerleave"&&(_.type="pointerout"),_.type.startsWith("mouse")&&(_.type=_.type.replace("mouse","pointer")),_.type.startsWith("touch")&&(_.type=TOUCH_TO_POINTER[_.type]||_.type),_}transferMouseData(_,T){_.isTrusted=T.isTrusted,_.srcElement=T.srcElement,_.timeStamp=performance.now(),_.type=T.type,_.altKey=T.altKey,_.button=T.button,_.buttons=T.buttons,_.client.x=T.clientX,_.client.y=T.clientY,_.ctrlKey=T.ctrlKey,_.metaKey=T.metaKey,_.movement.x=T.movementX,_.movement.y=T.movementY,_.page.x=T.pageX,_.page.y=T.pageY,_.relatedTarget=null,_.shiftKey=T.shiftKey}};_EventSystem.extension={name:"events",type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem]},_EventSystem.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let EventSystem=_EventSystem;extensions$1.add(EventSystem);function convertEventModeToInteractiveMode(B){return B==="dynamic"||B==="static"}const FederatedDisplayObject={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??convertEventModeToInteractiveMode(EventSystem.defaultEventMode)},set interactive(B){deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=B,this.eventMode=B?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??EventSystem.defaultEventMode},set eventMode(B){this._internalInteractive=convertEventModeToInteractiveMode(B),this._internalEventMode=B},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(B,_,T){const E=typeof T=="boolean"&&T||typeof T=="object"&&T.capture,W=typeof T=="object"?T.signal:void 0,X=typeof T=="object"?T.once===!0:!1,q=typeof _=="function"?void 0:_;B=E?`${B}capture`:B;const Y=typeof _=="function"?_:_.handleEvent,te=this;W&&W.addEventListener("abort",()=>{te.off(B,Y,q)}),X?te.once(B,Y,q):te.on(B,Y,q)},removeEventListener(B,_,T){const E=typeof T=="boolean"&&T||typeof T=="object"&&T.capture,W=typeof _=="function"?void 0:_;B=E?`${B}capture`:B,_=typeof _=="function"?_:_.handleEvent,this.off(B,_,W)},dispatchEvent(B){if(!(B instanceof FederatedEvent))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return B.defaultPrevented=!1,B.path=null,B.target=this,B.manager.dispatchEvent(B),!B.defaultPrevented}};DisplayObject.mixin(FederatedDisplayObject);const accessibleTarget={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};DisplayObject.mixin(accessibleTarget);const KEY_CODE_TAB=9,DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2;class AccessibilityManager{constructor(_){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(isMobile$1.tablet||isMobile$1.phone)&&this.createTouchHook();const T=document.createElement("div");T.style.width=`${DIV_TOUCH_SIZE}px`,T.style.height=`${DIV_TOUCH_SIZE}px`,T.style.position="absolute",T.style.top=`${DIV_TOUCH_POS_X}px`,T.style.left=`${DIV_TOUCH_POS_Y}px`,T.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this.div=T,this.renderer=_,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const _=document.createElement("button");_.style.width=`${DIV_HOOK_SIZE}px`,_.style.height=`${DIV_HOOK_SIZE}px`,_.style.position="absolute",_.style.top=`${DIV_HOOK_POS_X}px`,_.style.left=`${DIV_HOOK_POS_Y}px`,_.style.zIndex=DIV_HOOK_ZINDEX.toString(),_.style.backgroundColor="#FF0000",_.title="select to enable accessibility for this content",_.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(_),this._hookDiv=_}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var _;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(_=this.renderer.view.parentNode)==null||_.appendChild(this.div))}deactivate(){var _;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(_=this.div.parentNode)==null||_.removeChild(this.div))}updateAccessibleObjects(_){if(!_.visible||!_.accessibleChildren)return;_.accessible&&_.isInteractive()&&(_._accessibleActive||this.addChild(_),_.renderId=this.renderId);const T=_.children;if(T)for(let E=0;E<T.length;E++)this.updateAccessibleObjects(T[E])}update(){const _=performance.now();if(isMobile$1.android.device&&_<this.androidUpdateCount||(this.androidUpdateCount=_+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:T,y:E,width:W,height:X}=this.renderer.view.getBoundingClientRect(),{width:q,height:Y,resolution:te}=this.renderer,ne=W/q*te,ae=X/Y*te;let le=this.div;le.style.left=`${T}px`,le.style.top=`${E}px`,le.style.width=`${q}px`,le.style.height=`${Y}px`;for(let ue=0;ue<this.children.length;ue++){const ge=this.children[ue];if(ge.renderId!==this.renderId)ge._accessibleActive=!1,removeItems(this.children,ue,1),this.div.removeChild(ge._accessibleDiv),this.pool.push(ge._accessibleDiv),ge._accessibleDiv=null,ue--;else{le=ge._accessibleDiv;let ye=ge.hitArea;const xe=ge.worldTransform;ge.hitArea?(le.style.left=`${(xe.tx+ye.x*xe.a)*ne}px`,le.style.top=`${(xe.ty+ye.y*xe.d)*ae}px`,le.style.width=`${ye.width*xe.a*ne}px`,le.style.height=`${ye.height*xe.d*ae}px`):(ye=ge.getBounds(),this.capHitArea(ye),le.style.left=`${ye.x*ne}px`,le.style.top=`${ye.y*ae}px`,le.style.width=`${ye.width*ne}px`,le.style.height=`${ye.height*ae}px`,le.title!==ge.accessibleTitle&&ge.accessibleTitle!==null&&(le.title=ge.accessibleTitle),le.getAttribute("aria-label")!==ge.accessibleHint&&ge.accessibleHint!==null&&le.setAttribute("aria-label",ge.accessibleHint)),(ge.accessibleTitle!==le.title||ge.tabIndex!==le.tabIndex)&&(le.title=ge.accessibleTitle,le.tabIndex=ge.tabIndex,this.debug&&this.updateDebugHTML(le))}}this.renderId++}updateDebugHTML(_){_.innerHTML=`type: ${_.type}</br> title : ${_.title}</br> tabIndex: ${_.tabIndex}`}capHitArea(_){_.x<0&&(_.width+=_.x,_.x=0),_.y<0&&(_.height+=_.y,_.y=0);const{width:T,height:E}=this.renderer;_.x+_.width>T&&(_.width=T-_.x),_.y+_.height>E&&(_.height=E-_.y)}addChild(_){let T=this.pool.pop();T||(T=document.createElement("button"),T.style.width=`${DIV_TOUCH_SIZE}px`,T.style.height=`${DIV_TOUCH_SIZE}px`,T.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",T.style.position="absolute",T.style.zIndex=DIV_TOUCH_ZINDEX.toString(),T.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?T.setAttribute("aria-live","off"):T.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?T.setAttribute("aria-relevant","additions"):T.setAttribute("aria-relevant","text"),T.addEventListener("click",this._onClick.bind(this)),T.addEventListener("focus",this._onFocus.bind(this)),T.addEventListener("focusout",this._onFocusOut.bind(this))),T.style.pointerEvents=_.accessiblePointerEvents,T.type=_.accessibleType,_.accessibleTitle&&_.accessibleTitle!==null?T.title=_.accessibleTitle:(!_.accessibleHint||_.accessibleHint===null)&&(T.title=`displayObject ${_.tabIndex}`),_.accessibleHint&&_.accessibleHint!==null&&T.setAttribute("aria-label",_.accessibleHint),this.debug&&this.updateDebugHTML(T),_._accessibleActive=!0,_._accessibleDiv=T,T.displayObject=_,this.children.push(_),this.div.appendChild(_._accessibleDiv),_._accessibleDiv.tabIndex=_.tabIndex}_dispatchEvent(_,T){const{displayObject:E}=_.target,W=this.renderer.events.rootBoundary,X=Object.assign(new FederatedEvent(W),{target:E});W.rootTarget=this.renderer.lastObjectRendered,T.forEach(q=>W.dispatchEvent(X,q))}_onClick(_){this._dispatchEvent(_,["click","pointertap","tap"])}_onFocus(_){_.target.getAttribute("aria-live")||_.target.setAttribute("aria-live","assertive"),this._dispatchEvent(_,["mouseover"])}_onFocusOut(_){_.target.getAttribute("aria-live")||_.target.setAttribute("aria-live","polite"),this._dispatchEvent(_,["mouseout"])}_onKeyDown(_){_.keyCode===KEY_CODE_TAB&&this.activate()}_onMouseMove(_){_.movementX===0&&_.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}AccessibilityManager.extension={name:"accessibility",type:[ExtensionType.RendererPlugin,ExtensionType.CanvasRendererPlugin]};extensions$1.add(AccessibilityManager);const _Application=class Zh{constructor(_){this.stage=new Container,_=Object.assign({forceCanvas:!1},_),this.renderer=autoDetectRenderer(_),Zh._plugins.forEach(T=>{T.init.call(this,_)})}render(){this.renderer.render(this.stage)}get view(){var _;return(_=this.renderer)==null?void 0:_.view}get screen(){var _;return(_=this.renderer)==null?void 0:_.screen}destroy(_,T){const E=Zh._plugins.slice(0);E.reverse(),E.forEach(W=>{W.destroy.call(this)}),this.stage.destroy(T),this.stage=null,this.renderer.destroy(_),this.renderer=null}};_Application._plugins=[];let Application=_Application;extensions$1.handleByList(ExtensionType.Application,Application._plugins);class ResizePlugin{static init(_){Object.defineProperty(this,"resizeTo",{set(T){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=T,T&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let T,E;if(this._resizeTo===globalThis.window)T=globalThis.innerWidth,E=globalThis.innerHeight;else{const{clientWidth:W,clientHeight:X}=this._resizeTo;T=W,E=X}this.renderer.resize(T,E),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=_.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ResizePlugin.extension=ExtensionType.Application;extensions$1.add(ResizePlugin);const assetKeyMap={loader:ExtensionType.LoadParser,resolver:ExtensionType.ResolveParser,cache:ExtensionType.CacheParser,detection:ExtensionType.DetectionParser};extensions$1.handle(ExtensionType.Asset,B=>{const _=B.ref;Object.entries(assetKeyMap).filter(([T])=>!!_[T]).forEach(([T,E])=>extensions$1.add(Object.assign(_[T],{extension:_[T].extension??E})))},B=>{const _=B.ref;Object.keys(assetKeyMap).filter(T=>!!_[T]).forEach(T=>extensions$1.remove(_[T]))});class BackgroundLoader{constructor(_,T=!1){this._loader=_,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=T}add(_){_.forEach(T=>{this._assetList.push(T)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const _=[],T=Math.min(this._assetList.length,this._maxConcurrent);for(let E=0;E<T;E++)_.push(this._assetList.pop());await this._loader.load(_),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(_){this._isActive!==_&&(this._isActive=_,_&&!this._isLoading&&this._next())}}function checkDataUrl(B,_){if(Array.isArray(_)){for(const T of _)if(B.startsWith(`data:${T}`))return!0;return!1}return B.startsWith(`data:${_}`)}function checkExtension(B,_){const T=B.split("?")[0],E=path.extname(T).toLowerCase();return Array.isArray(_)?_.includes(E):E===_}const convertToList=(B,_,T=!1)=>(Array.isArray(B)||(B=[B]),_?B.map(E=>typeof E=="string"||T?_(E):E):B),copySearchParams=(B,_)=>{const T=_.split("?")[1];return T&&(B+=`?${T}`),B};function processX(B,_,T,E,W){const X=_[T];for(let q=0;q<X.length;q++){const Y=X[q];T<_.length-1?processX(B.replace(E[T],Y),_,T+1,E,W):W.push(B.replace(E[T],Y))}}function createStringVariations(B){const _=/\{(.*?)\}/g,T=B.match(_),E=[];if(T){const W=[];T.forEach(X=>{const q=X.substring(1,X.length-1).split(",");W.push(q)}),processX(B,W,0,T,E)}else E.push(B);return E}const isSingleItem=B=>!Array.isArray(B);class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(_){return this._cache.has(_)}get(_){const T=this._cache.get(_);return T||console.warn(`[Assets] Asset id ${_} was not found in the Cache`),T}set(_,T){const E=convertToList(_);let W;for(let Y=0;Y<this.parsers.length;Y++){const te=this.parsers[Y];if(te.test(T)){W=te.getCacheableAssets(E,T);break}}W||(W={},E.forEach(Y=>{W[Y]=T}));const X=Object.keys(W),q={cacheKeys:X,keys:E};if(E.forEach(Y=>{this._cacheMap.set(Y,q)}),X.forEach(Y=>{this._cache.has(Y)&&this._cache.get(Y)!==T&&console.warn("[Cache] already has key:",Y),this._cache.set(Y,W[Y])}),T instanceof Texture$1){const Y=T;E.forEach(te=>{Y.baseTexture!==Texture$1.EMPTY.baseTexture&&BaseTexture.addToCache(Y.baseTexture,te),Texture$1.addToCache(Y,te)})}}remove(_){if(!this._cacheMap.has(_)){console.warn(`[Assets] Asset id ${_} was not found in the Cache`);return}const T=this._cacheMap.get(_);T.cacheKeys.forEach(E=>{this._cache.delete(E)}),T.keys.forEach(E=>{this._cacheMap.delete(E)})}get parsers(){return this._parsers}}const Cache$1=new CacheClass;let Loader$1=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(_,T,E)=>(this._parsersValidated=!1,_[T]=E,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(_,T){const E={promise:null,parser:null};return E.promise=(async()=>{var q,Y;let W=null,X=null;if(T.loadParser&&(X=this._parserHash[T.loadParser],X||console.warn(`[Assets] specified load parser "${T.loadParser}" not found while loading ${_}`)),!X){for(let te=0;te<this.parsers.length;te++){const ne=this.parsers[te];if(ne.load&&((q=ne.test)!=null&&q.call(ne,_,T,this))){X=ne;break}}if(!X)return console.warn(`[Assets] ${_} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}W=await X.load(_,T,this),E.parser=X;for(let te=0;te<this.parsers.length;te++){const ne=this.parsers[te];ne.parse&&ne.parse&&await((Y=ne.testParse)==null?void 0:Y.call(ne,W,T,this))&&(W=await ne.parse(W,T,this)||W,E.parser=ne)}return W})(),E}async load(_,T){this._parsersValidated||this._validateParsers();let E=0;const W={},X=isSingleItem(_),q=convertToList(_,ne=>({alias:[ne],src:ne})),Y=q.length,te=q.map(async ne=>{const ae=path.toAbsolute(ne.src);if(!W[ne.src])try{this.promiseCache[ae]||(this.promiseCache[ae]=this._getLoadPromiseAndParser(ae,ne)),W[ne.src]=await this.promiseCache[ae].promise,T&&T(++E/Y)}catch(le){throw delete this.promiseCache[ae],delete W[ne.src],new Error(`[Loader.load] Failed to load ${ae}.
${le}`)}});return await Promise.all(te),X?W[q[0].src]:W}async unload(_){const T=convertToList(_,E=>({alias:[E],src:E})).map(async E=>{var q,Y;const W=path.toAbsolute(E.src),X=this.promiseCache[W];if(X){const te=await X.promise;delete this.promiseCache[W],(Y=(q=X.parser)==null?void 0:q.unload)==null||Y.call(q,te,E,this)}});await Promise.all(T)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(_=>_.name).reduce((_,T)=>(_[T.name]&&console.warn(`[Assets] loadParser name conflict "${T.name}"`),{..._,[T.name]:T}),{})}};var LoaderParserPriority=(B=>(B[B.Low=0]="Low",B[B.Normal=1]="Normal",B[B.High=2]="High",B))(LoaderParserPriority||{});const validJSONExtension=".json",validJSONMIME="application/json",loadJson={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadJson",test(B){return checkDataUrl(B,validJSONMIME)||checkExtension(B,validJSONExtension)},async load(B){return await(await settings.ADAPTER.fetch(B)).json()}};extensions$1.add(loadJson);const validTXTExtension=".txt",validTXTMIME="text/plain",loadTxt={name:"loadTxt",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(B){return checkDataUrl(B,validTXTMIME)||checkExtension(B,validTXTExtension)},async load(B){return await(await settings.ADAPTER.fetch(B)).text()}};extensions$1.add(loadTxt);const validWeights=["normal","bold","100","200","300","400","500","600","700","800","900"],validFontExtensions=[".ttf",".otf",".woff",".woff2"],validFontMIMEs=["font/ttf","font/otf","font/woff","font/woff2"],CSS_IDENT_TOKEN_REGEX=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function getFontFamilyName(B){const _=path.extname(B),T=path.basename(B,_).replace(/(-|_)/g," ").toLowerCase().split(" ").map(X=>X.charAt(0).toUpperCase()+X.slice(1));let E=T.length>0;for(const X of T)if(!X.match(CSS_IDENT_TOKEN_REGEX)){E=!1;break}let W=T.join(" ");return E||(W=`"${W.replace(/[\\"]/g,"\\$&")}"`),W}const validURICharactersRegex=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function encodeURIWhenNeeded(B){return validURICharactersRegex.test(B)?B:encodeURI(B)}const loadWebFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadWebFont",test(B){return checkDataUrl(B,validFontMIMEs)||checkExtension(B,validFontExtensions)},async load(B,_){var E,W,X;const T=settings.ADAPTER.getFontFaceSet();if(T){const q=[],Y=((E=_.data)==null?void 0:E.family)??getFontFamilyName(B),te=((X=(W=_.data)==null?void 0:W.weights)==null?void 0:X.filter(ae=>validWeights.includes(ae)))??["normal"],ne=_.data??{};for(let ae=0;ae<te.length;ae++){const le=te[ae],ue=new FontFace(Y,`url(${encodeURIWhenNeeded(B)})`,{...ne,weight:le});await ue.load(),T.add(ue),q.push(ue)}return q.length===1?q[0]:q}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(B){(Array.isArray(B)?B:[B]).forEach(_=>settings.ADAPTER.getFontFaceSet().delete(_))}};extensions$1.add(loadWebFont);const WORKER_CODE$1=`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`;let WORKER_URL$1=null,WorkerInstance$1=class{constructor(){WORKER_URL$1||(WORKER_URL$1=URL.createObjectURL(new Blob([WORKER_CODE$1],{type:"application/javascript"}))),this.worker=new Worker(WORKER_URL$1)}};WorkerInstance$1.revokeObjectURL=function(){WORKER_URL$1&&(URL.revokeObjectURL(WORKER_URL$1),WORKER_URL$1=null)};const WORKER_CODE=`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`;let WORKER_URL=null;class WorkerInstance{constructor(){WORKER_URL||(WORKER_URL=URL.createObjectURL(new Blob([WORKER_CODE],{type:"application/javascript"}))),this.worker=new Worker(WORKER_URL)}}WorkerInstance.revokeObjectURL=function(){WORKER_URL&&(URL.revokeObjectURL(WORKER_URL),WORKER_URL=null)};let UUID=0,MAX_WORKERS;class WorkerManagerClass{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(_=>{const{worker:T}=new WorkerInstance$1;T.addEventListener("message",E=>{T.terminate(),WorkerInstance$1.revokeObjectURL(),_(E.data)})}),this._isImageBitmapSupported)}loadImageBitmap(_){return this._run("loadImageBitmap",[_])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){MAX_WORKERS===void 0&&(MAX_WORKERS=navigator.hardwareConcurrency||4);let _=this.workerPool.pop();return!_&&this._createdWorkers<MAX_WORKERS&&(this._createdWorkers++,_=new WorkerInstance().worker,_.addEventListener("message",T=>{this.complete(T.data),this.returnWorker(T.target),this.next()})),_}returnWorker(_){this.workerPool.push(_)}complete(_){_.error!==void 0?this.resolveHash[_.uuid].reject(_.error):this.resolveHash[_.uuid].resolve(_.data),this.resolveHash[_.uuid]=null}async _run(_,T){await this._initWorkers();const E=new Promise((W,X)=>{this.queue.push({id:_,arguments:T,resolve:W,reject:X})});return this.next(),E}next(){if(!this.queue.length)return;const _=this.getWorker();if(!_)return;const T=this.queue.pop(),E=T.id;this.resolveHash[UUID]={resolve:T.resolve,reject:T.reject},_.postMessage({data:T.arguments,uuid:UUID++,id:E})}}const WorkerManager=new WorkerManagerClass;function createTexture(B,_,T){B.resource.internal=!0;const E=new Texture$1(B),W=()=>{delete _.promiseCache[T],Cache$1.has(T)&&Cache$1.remove(T)};return E.baseTexture.once("destroyed",()=>{T in _.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),W())}),E.once("destroyed",()=>{B.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),W())}),E}const validImageExtensions=[".jpeg",".jpg",".png",".webp",".avif"],validImageMIMEs=["image/jpeg","image/png","image/webp","image/avif"];async function loadImageBitmap(B){const _=await settings.ADAPTER.fetch(B);if(!_.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${B}: ${_.status} ${_.statusText}`);const T=await _.blob();return await createImageBitmap(T)}const loadTextures={name:"loadTextures",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(B){return checkDataUrl(B,validImageMIMEs)||checkExtension(B,validImageExtensions)},async load(B,_,T){var Y;const E=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let W;E?this.config.preferWorkers&&await WorkerManager.isImageBitmapSupported()?W=await WorkerManager.loadImageBitmap(B):W=await loadImageBitmap(B):W=await new Promise((te,ne)=>{const ae=new Image;ae.crossOrigin=this.config.crossOrigin,ae.src=B,ae.complete?te(ae):(ae.onload=()=>te(ae),ae.onerror=le=>ne(le))});const X={..._.data};X.resolution??(X.resolution=getResolutionOfUrl(B)),E&&((Y=X.resourceOptions)==null?void 0:Y.ownsImageBitmap)===void 0&&(X.resourceOptions={...X.resourceOptions},X.resourceOptions.ownsImageBitmap=!0);const q=new BaseTexture(W,X);return q.resource.src=B,createTexture(q,T,B)},unload(B){B.destroy(!0)}};extensions$1.add(loadTextures);const validSVGExtension=".svg",validSVGMIME="image/svg+xml",loadSVG={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadSVG",test(B){return checkDataUrl(B,validSVGMIME)||checkExtension(B,validSVGExtension)},async testParse(B){return SVGResource.test(B)},async parse(B,_,T){var X;const E=new SVGResource(B,(X=_==null?void 0:_.data)==null?void 0:X.resourceOptions);await E.load();const W=new BaseTexture(E,{resolution:getResolutionOfUrl(B),..._==null?void 0:_.data});return W.resource.src=_.src,createTexture(W,T,_.src)},async load(B,_){return(await settings.ADAPTER.fetch(B)).text()},unload:loadTextures.unload};extensions$1.add(loadSVG);const validVideoExtensions=[".mp4",".m4v",".webm",".ogv"],validVideoMIMEs=["video/mp4","video/webm","video/ogg"],loadVideo={name:"loadVideo",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(B){return checkDataUrl(B,validVideoMIMEs)||checkExtension(B,validVideoExtensions)},async load(B,_,T){var q;let E;const W=await(await settings.ADAPTER.fetch(B)).blob(),X=URL.createObjectURL(W);try{const Y={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...(q=_==null?void 0:_.data)==null?void 0:q.resourceOptions,autoLoad:!0},te=new VideoResource(X,Y);await te.load();const ne=new BaseTexture(te,{alphaMode:await detectVideoAlphaMode(),resolution:getResolutionOfUrl(B),..._==null?void 0:_.data});ne.resource.src=B,E=createTexture(ne,T,B),E.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(X)})}catch(Y){throw URL.revokeObjectURL(X),Y}return E},unload(B){B.destroy(!0)}};extensions$1.add(loadVideo);class Resolver{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(_,T)=>`${_}${this._bundleIdConnector}${T}`,extractAssetIdFromBundle:(_,T)=>T.replace(`${_}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(_){if(this._bundleIdConnector=_.connector??this._bundleIdConnector,this._createBundleAssetId=_.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=_.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(..._){_.forEach(T=>{this._preferredOrder.push(T),T.priority||(T.priority=Object.keys(T.params))}),this._resolverHash={}}set basePath(_){this._basePath=_}get basePath(){return this._basePath}set rootPath(_){this._rootPath=_}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(_){if(typeof _=="string")this._defaultSearchParams=_;else{const T=_;this._defaultSearchParams=Object.keys(T).map(E=>`${encodeURIComponent(E)}=${encodeURIComponent(T[E])}`).join("&")}}getAlias(_){const{alias:T,name:E,src:W,srcs:X}=_;return convertToList(T||E||W||X,q=>typeof q=="string"?q:Array.isArray(q)?q.map(Y=>(Y==null?void 0:Y.src)??(Y==null?void 0:Y.srcs)??Y):q!=null&&q.src||q!=null&&q.srcs?q.src??q.srcs:q,!0)}addManifest(_){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=_,_.bundles.forEach(T=>{this.addBundle(T.name,T.assets)})}addBundle(_,T){const E=[];Array.isArray(T)?T.forEach(W=>{const X=W.src??W.srcs,q=W.alias??W.name;let Y;if(typeof q=="string"){const te=this._createBundleAssetId(_,q);E.push(te),Y=[q,te]}else{const te=q.map(ne=>this._createBundleAssetId(_,ne));E.push(...te),Y=[...q,...te]}this.add({...W,alias:Y,src:X})}):Object.keys(T).forEach(W=>{const X=[W,this._createBundleAssetId(_,W)];if(typeof T[W]=="string")this.add({alias:X,src:T[W]});else if(Array.isArray(T[W]))this.add({alias:X,src:T[W]});else{const q=T[W],Y=q.src??q.srcs;this.add({...q,alias:X,src:Array.isArray(Y)?Y:[Y]})}E.push(...X)}),this._bundles[_]=E}add(_,T,E,W,X){const q=[];typeof _=="string"||Array.isArray(_)&&typeof _[0]=="string"?(deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),q.push({alias:_,src:T,data:E,format:W,loadParser:X})):Array.isArray(_)?q.push(..._):q.push(_);let Y;Y=te=>{this.hasKey(te)&&console.warn(`[Resolver] already has key: ${te} overwriting`)},convertToList(q).forEach(te=>{const{src:ne,srcs:ae}=te;let{data:le,format:ue,loadParser:ge}=te;const ye=convertToList(ne||ae).map(Ae=>typeof Ae=="string"?createStringVariations(Ae):Array.isArray(Ae)?Ae:[Ae]),xe=this.getAlias(te);Array.isArray(xe)?xe.forEach(Y):Y(xe);const Te=[];ye.forEach(Ae=>{Ae.forEach(Ie=>{let Ve={};if(typeof Ie!="object"){Ve.src=Ie;for(let $e=0;$e<this._parsers.length;$e++){const We=this._parsers[$e];if(We.test(Ie)){Ve=We.parse(Ie);break}}}else le=Ie.data??le,ue=Ie.format??ue,ge=Ie.loadParser??ge,Ve={...Ve,...Ie};if(!xe)throw new Error(`[Resolver] alias is undefined for this asset: ${Ve.src}`);Ve=this.buildResolvedAsset(Ve,{aliases:xe,data:le,format:ue,loadParser:ge}),Te.push(Ve)})}),xe.forEach(Ae=>{this._assetMap[Ae]=Te})})}resolveBundle(_){const T=isSingleItem(_);_=convertToList(_);const E={};return _.forEach(W=>{const X=this._bundles[W];if(X){const q=this.resolve(X),Y={};for(const te in q){const ne=q[te];Y[this._extractAssetIdFromBundle(W,te)]=ne}E[W]=Y}}),T?E[_[0]]:E}resolveUrl(_){const T=this.resolve(_);if(typeof _!="string"){const E={};for(const W in T)E[W]=T[W].src;return E}return T.src}resolve(_){const T=isSingleItem(_);_=convertToList(_);const E={};return _.forEach(W=>{if(!this._resolverHash[W])if(this._assetMap[W]){let X=this._assetMap[W];const q=X[0],Y=this._getPreferredOrder(X);Y==null||Y.priority.forEach(te=>{Y.params[te].forEach(ne=>{const ae=X.filter(le=>le[te]?le[te]===ne:!1);ae.length&&(X=ae)})}),this._resolverHash[W]=X[0]??q}else this._resolverHash[W]=this.buildResolvedAsset({alias:[W],src:W},{});E[W]=this._resolverHash[W]}),T?E[_[0]]:E}hasKey(_){return!!this._assetMap[_]}hasBundle(_){return!!this._bundles[_]}_getPreferredOrder(_){for(let T=0;T<_.length;T++){const E=_[0],W=this._preferredOrder.find(X=>X.params.format.includes(E.format));if(W)return W}return this._preferredOrder[0]}_appendDefaultSearchParams(_){if(!this._defaultSearchParams)return _;const T=/\?/.test(_)?"&":"?";return`${_}${T}${this._defaultSearchParams}`}buildResolvedAsset(_,T){const{aliases:E,data:W,loadParser:X,format:q}=T;return(this._basePath||this._rootPath)&&(_.src=path.toAbsolute(_.src,this._basePath,this._rootPath)),_.alias=E??_.alias??[_.src],_.src=this._appendDefaultSearchParams(_.src),_.data={...W||{},..._.data},_.loadParser=X??_.loadParser,_.format=q??_.format??path.extname(_.src).slice(1),_.srcs=_.src,_.name=_.alias,_}}class AssetsClass{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Resolver,this.loader=new Loader$1,this.cache=Cache$1,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(_={}){var X,q;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,_.defaultSearchParams&&this.resolver.setDefaultSearchParams(_.defaultSearchParams),_.basePath&&(this.resolver.basePath=_.basePath),_.bundleIdentifier&&this.resolver.setBundleIdentifier(_.bundleIdentifier),_.manifest){let Y=_.manifest;typeof Y=="string"&&(Y=await this.load(Y)),this.resolver.addManifest(Y)}const T=((X=_.texturePreference)==null?void 0:X.resolution)??1,E=typeof T=="number"?[T]:T,W=await this._detectFormats({preferredFormats:(q=_.texturePreference)==null?void 0:q.format,skipDetections:_.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:W,resolution:E}}),_.preferences&&this.setPreferences(_.preferences)}add(_,T,E,W,X){this.resolver.add(_,T,E,W,X)}async load(_,T){this._initialized||await this.init();const E=isSingleItem(_),W=convertToList(_).map(Y=>{if(typeof Y!="string"){const te=this.resolver.getAlias(Y);return te.some(ne=>!this.resolver.hasKey(ne))&&this.add(Y),Array.isArray(te)?te[0]:te}return this.resolver.hasKey(Y)||this.add({alias:Y,src:Y}),Y}),X=this.resolver.resolve(W),q=await this._mapLoadToResolve(X,T);return E?q[W[0]]:q}addBundle(_,T){this.resolver.addBundle(_,T)}async loadBundle(_,T){this._initialized||await this.init();let E=!1;typeof _=="string"&&(E=!0,_=[_]);const W=this.resolver.resolveBundle(_),X={},q=Object.keys(W);let Y=0,te=0;const ne=()=>{T==null||T(++Y/te)},ae=q.map(le=>{const ue=W[le];return te+=Object.keys(ue).length,this._mapLoadToResolve(ue,ne).then(ge=>{X[le]=ge})});return await Promise.all(ae),E?X[_[0]]:X}async backgroundLoad(_){this._initialized||await this.init(),typeof _=="string"&&(_=[_]);const T=this.resolver.resolve(_);this._backgroundLoader.add(Object.values(T))}async backgroundLoadBundle(_){this._initialized||await this.init(),typeof _=="string"&&(_=[_]);const T=this.resolver.resolveBundle(_);Object.values(T).forEach(E=>{this._backgroundLoader.add(Object.values(E))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(_){if(typeof _=="string")return Cache$1.get(_);const T={};for(let E=0;E<_.length;E++)T[E]=Cache$1.get(_[E]);return T}async _mapLoadToResolve(_,T){const E=Object.values(_),W=Object.keys(_);this._backgroundLoader.active=!1;const X=await this.loader.load(E,T);this._backgroundLoader.active=!0;const q={};return E.forEach((Y,te)=>{const ne=X[Y.src],ae=[Y.src];Y.alias&&ae.push(...Y.alias),q[W[te]]=ne,Cache$1.set(ae,ne)}),q}async unload(_){this._initialized||await this.init();const T=convertToList(_).map(W=>typeof W!="string"?W.src:W),E=this.resolver.resolve(T);await this._unloadFromResolved(E)}async unloadBundle(_){this._initialized||await this.init(),_=convertToList(_);const T=this.resolver.resolveBundle(_),E=Object.keys(T).map(W=>this._unloadFromResolved(T[W]));await Promise.all(E)}async _unloadFromResolved(_){const T=Object.values(_);T.forEach(E=>{Cache$1.remove(E.src)}),await this.loader.unload(T)}async _detectFormats(_){let T=[];_.preferredFormats&&(T=Array.isArray(_.preferredFormats)?_.preferredFormats:[_.preferredFormats]);for(const E of _.detections)_.skipDetections||await E.test()?T=await E.add(T):_.skipDetections||(T=await E.remove(T));return T=T.filter((E,W)=>T.indexOf(E)===W),T}get detections(){return this._detections}get preferWorkers(){return loadTextures.config.preferWorkers}set preferWorkers(_){deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:_})}setPreferences(_){this.loader.parsers.forEach(T=>{T.config&&Object.keys(T.config).filter(E=>E in _).forEach(E=>{T.config[E]=_[E]})})}}const Assets=new AssetsClass;extensions$1.handleByList(ExtensionType.LoadParser,Assets.loader.parsers).handleByList(ExtensionType.ResolveParser,Assets.resolver.parsers).handleByList(ExtensionType.CacheParser,Assets.cache.parsers).handleByList(ExtensionType.DetectionParser,Assets.detections);const cacheTextureArray={extension:ExtensionType.CacheParser,test:B=>Array.isArray(B)&&B.every(_=>_ instanceof Texture$1),getCacheableAssets:(B,_)=>{const T={};return B.forEach(E=>{_.forEach((W,X)=>{T[E+(X===0?"":X+1)]=W})}),T}};extensions$1.add(cacheTextureArray);async function testImageFormat(B){if("Image"in globalThis)return new Promise(_=>{const T=new Image;T.onload=()=>{_(!0)},T.onerror=()=>{_(!1)},T.src=B});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const _=await(await fetch(B)).blob();await createImageBitmap(_)}catch{return!1}return!0}return!1}const detectAvif={extension:{type:ExtensionType.DetectionParser,priority:1},test:async()=>testImageFormat("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async B=>[...B,"avif"],remove:async B=>B.filter(_=>_!=="avif")};extensions$1.add(detectAvif);const detectWebp={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testImageFormat("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async B=>[...B,"webp"],remove:async B=>B.filter(_=>_!=="webp")};extensions$1.add(detectWebp);const imageFormats=["png","jpg","jpeg"],detectDefaults={extension:{type:ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async B=>[...B,...imageFormats],remove:async B=>B.filter(_=>!imageFormats.includes(_))};extensions$1.add(detectDefaults);const inWorker="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function testVideoFormat(B){return inWorker?!1:document.createElement("video").canPlayType(B)!==""}const detectWebm={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/webm"),add:async B=>[...B,"webm"],remove:async B=>B.filter(_=>_!=="webm")};extensions$1.add(detectWebm);const detectMp4={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/mp4"),add:async B=>[...B,"mp4","m4v"],remove:async B=>B.filter(_=>_!=="mp4"&&_!=="m4v")};extensions$1.add(detectMp4);const detectOgv={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/ogg"),add:async B=>[...B,"ogv"],remove:async B=>B.filter(_=>_!=="ogv")};extensions$1.add(detectOgv);const resolveTextureUrl={extension:ExtensionType.ResolveParser,test:loadTextures.test,parse:B=>{var _;return{resolution:parseFloat(((_=settings.RETINA_PREFIX.exec(B))==null?void 0:_[1])??"1"),format:path.extname(B).slice(1),src:B}}};extensions$1.add(resolveTextureUrl);var INTERNAL_FORMATS=(B=>(B[B.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",B[B.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",B[B.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",B[B.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",B[B.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",B[B.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",B[B.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",B[B.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",B[B.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",B[B.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",B[B.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",B[B.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",B[B.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",B[B.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",B[B.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",B[B.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",B[B.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",B[B.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",B[B.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",B[B.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",B[B.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",B[B.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",B[B.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",B[B.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",B[B.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",B[B.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",B[B.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",B[B.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",B[B.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",B[B.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",B[B.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",B))(INTERNAL_FORMATS||{});const INTERNAL_FORMAT_TO_BYTES_PER_PIXEL={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1};let storedGl,extensions;function getCompressedTextureExtensions(){extensions={bptc:storedGl.getExtension("EXT_texture_compression_bptc"),astc:storedGl.getExtension("WEBGL_compressed_texture_astc"),etc:storedGl.getExtension("WEBGL_compressed_texture_etc"),s3tc:storedGl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:storedGl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),pvrtc:storedGl.getExtension("WEBGL_compressed_texture_pvrtc")||storedGl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:storedGl.getExtension("WEBGL_compressed_texture_etc1"),atc:storedGl.getExtension("WEBGL_compressed_texture_atc")}}const detectCompressedTextures={extension:{type:ExtensionType.DetectionParser,priority:2},test:async()=>{const B=settings.ADAPTER.createCanvas().getContext("webgl");return B?(storedGl=B,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async B=>{extensions||getCompressedTextureExtensions();const _=[];for(const T in extensions)extensions[T]&&_.push(T);return[..._,...B]},remove:async B=>(extensions||getCompressedTextureExtensions(),B.filter(_=>!(_ in extensions)))};extensions$1.add(detectCompressedTextures);class BlobResource extends BufferResource{constructor(_,T={width:1,height:1,autoLoad:!0}){let E,W;typeof _=="string"?(E=_,W=new Uint8Array):(E=null,W=_),super(W,T),this.origin=E,this.buffer=W?new ViewableBuffer(W):null,this._load=null,this.loaded=!1,this.origin!==null&&T.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(_){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(_=>_.blob()).then(_=>_.arrayBuffer()).then(_=>(this.data=new Uint32Array(_),this.buffer=new ViewableBuffer(_),this.loaded=!0,this.onBlobLoaded(_),this.update(),this)),this._load)}}class CompressedTextureResource extends BlobResource{constructor(_,T){super(_,T),this.format=T.format,this.levels=T.levels||1,this._width=T.width,this._height=T.height,this._extension=CompressedTextureResource._formatToExtension(this.format),(T.levelBuffers||this.buffer)&&(this._levelBuffers=T.levelBuffers||CompressedTextureResource._createLevelBuffers(_ instanceof Uint8Array?_:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(_,T,E){const W=_.gl;if(!_.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;W.pixelStorei(W.UNPACK_ALIGNMENT,4);for(let X=0,q=this.levels;X<q;X++){const{levelID:Y,levelWidth:te,levelHeight:ne,levelBuffer:ae}=this._levelBuffers[X];W.compressedTexImage2D(W.TEXTURE_2D,Y,this.format,te,ne,0,ae)}return!0}onBlobLoaded(){this._levelBuffers=CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(_){if(_>=33776&&_<=33779)return"s3tc";if(_>=35916&&_<=35919)return"s3tc_sRGB";if(_>=37488&&_<=37497)return"etc";if(_>=35840&&_<=35843)return"pvrtc";if(_===36196)return"etc1";if(_===35986||_===35987||_===34798)return"atc";if(_>=36492&&_<=36495)return"bptc";if(_===37808)return"astc";throw new Error(`Invalid (compressed) texture format given: ${_}`)}static _createLevelBuffers(_,T,E,W,X,q,Y){const te=new Array(E);let ne=_.byteOffset,ae=q,le=Y,ue=ae+W-1&~(W-1),ge=le+X-1&~(X-1),ye=ue*ge*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[T];for(let xe=0;xe<E;xe++)te[xe]={levelID:xe,levelWidth:E>1?ae:ue,levelHeight:E>1?le:ge,levelBuffer:new Uint8Array(_.buffer,ne,ye)},ne+=ye,ae=ae>>1||1,le=le>>1||1,ue=ae+W-1&~(W-1),ge=le+X-1&~(X-1),ye=ue*ge*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[T];return te}}const DDS_MAGIC_SIZE=4,DDS_HEADER_SIZE=124,DDS_HEADER_PF_SIZE=32,DDS_HEADER_DX10_SIZE=20,DDS_MAGIC=542327876,DDS_FIELDS={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DDS_PF_FIELDS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},DDS_DX10_FIELDS={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},PF_FLAGS=1,DDPF_ALPHA=2,DDPF_FOURCC=4,DDPF_RGB=64,DDPF_YUV=512,DDPF_LUMINANCE=131072,FOURCC_DXT1=827611204,FOURCC_DXT3=861165636,FOURCC_DXT5=894720068,FOURCC_DX10=808540228,DDS_RESOURCE_MISC_TEXTURECUBE=4,FOURCC_TO_FORMAT={[FOURCC_DXT1]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[FOURCC_DXT3]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[FOURCC_DXT5]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT},DXGI_TO_FORMAT={70:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:INTERNAL_FORMATS.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function parseDDS(B){const _=new Uint32Array(B);if(_[0]!==DDS_MAGIC)throw new Error("Invalid DDS file magic word");const T=new Uint32Array(B,0,DDS_HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT),E=T[DDS_FIELDS.HEIGHT],W=T[DDS_FIELDS.WIDTH],X=T[DDS_FIELDS.MIPMAP_COUNT],q=new Uint32Array(B,DDS_FIELDS.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,DDS_HEADER_PF_SIZE/Uint32Array.BYTES_PER_ELEMENT),Y=q[PF_FLAGS];if(Y&DDPF_FOURCC){const te=q[DDS_PF_FIELDS.FOURCC];if(te!==FOURCC_DX10){const Ie=FOURCC_TO_FORMAT[te],Ve=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,$e=new Uint8Array(B,Ve);return[new CompressedTextureResource($e,{format:Ie,width:W,height:E,levels:X})]}const ne=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,ae=new Uint32Array(_.buffer,ne,DDS_HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT),le=ae[DDS_DX10_FIELDS.DXGI_FORMAT],ue=ae[DDS_DX10_FIELDS.RESOURCE_DIMENSION],ge=ae[DDS_DX10_FIELDS.MISC_FLAG],ye=ae[DDS_DX10_FIELDS.ARRAY_SIZE],xe=DXGI_TO_FORMAT[le];if(xe===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${le}`);if(ge===DDS_RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(ue===6)throw new Error("DDSParser does not supported 3D texture data");const Te=new Array,Ae=DDS_MAGIC_SIZE+DDS_HEADER_SIZE+DDS_HEADER_DX10_SIZE;if(ye===1)Te.push(new Uint8Array(B,Ae));else{const Ie=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[xe];let Ve=0,$e=W,We=E;for(let je=0;je<X;je++){const ze=Math.max(1,$e+3&-4),He=Math.max(1,We+3&-4),Le=ze*He*Ie;Ve+=Le,$e=$e>>>1,We=We>>>1}let Ue=Ae;for(let je=0;je<ye;je++)Te.push(new Uint8Array(B,Ue,Ve)),Ue+=Ve}return Te.map(Ie=>new CompressedTextureResource(Ie,{format:xe,width:W,height:E,levels:X}))}throw Y&DDPF_RGB?new Error("DDSParser does not support uncompressed texture data."):Y&DDPF_YUV?new Error("DDSParser does not supported YUV uncompressed texture data."):Y&DDPF_LUMINANCE?new Error("DDSParser does not support single-channel (lumninance) texture data!"):Y&DDPF_ALPHA?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],ENDIANNESS=67305985,KTX_FIELDS={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},FILE_HEADER_SIZE=64,TYPES_TO_BYTES_PER_COMPONENT={[TYPES.UNSIGNED_BYTE]:1,[TYPES.UNSIGNED_SHORT]:2,[TYPES.INT]:4,[TYPES.UNSIGNED_INT]:4,[TYPES.FLOAT]:4,[TYPES.HALF_FLOAT]:8},FORMATS_TO_COMPONENTS={[FORMATS.RGBA]:4,[FORMATS.RGB]:3,[FORMATS.RG]:2,[FORMATS.RED]:1,[FORMATS.LUMINANCE]:1,[FORMATS.LUMINANCE_ALPHA]:2,[FORMATS.ALPHA]:1},TYPES_TO_BYTES_PER_PIXEL={[TYPES.UNSIGNED_SHORT_4_4_4_4]:2,[TYPES.UNSIGNED_SHORT_5_5_5_1]:2,[TYPES.UNSIGNED_SHORT_5_6_5]:2};function parseKTX(B,_,T=!1){const E=new DataView(_);if(!validate(B,E))return null;const W=E.getUint32(KTX_FIELDS.ENDIANNESS,!0)===ENDIANNESS,X=E.getUint32(KTX_FIELDS.GL_TYPE,W),q=E.getUint32(KTX_FIELDS.GL_FORMAT,W),Y=E.getUint32(KTX_FIELDS.GL_INTERNAL_FORMAT,W),te=E.getUint32(KTX_FIELDS.PIXEL_WIDTH,W),ne=E.getUint32(KTX_FIELDS.PIXEL_HEIGHT,W)||1,ae=E.getUint32(KTX_FIELDS.PIXEL_DEPTH,W)||1,le=E.getUint32(KTX_FIELDS.NUMBER_OF_ARRAY_ELEMENTS,W)||1,ue=E.getUint32(KTX_FIELDS.NUMBER_OF_FACES,W),ge=E.getUint32(KTX_FIELDS.NUMBER_OF_MIPMAP_LEVELS,W),ye=E.getUint32(KTX_FIELDS.BYTES_OF_KEY_VALUE_DATA,W);if(ne===0||ae!==1)throw new Error("Only 2D textures are supported");if(ue!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(le!==1)throw new Error("WebGL does not support array textures");const xe=4,Te=4,Ae=te+3&-4,Ie=ne+3&-4,Ve=new Array(le);let $e=te*ne;X===0&&($e=Ae*Ie);let We;if(X!==0?TYPES_TO_BYTES_PER_COMPONENT[X]?We=TYPES_TO_BYTES_PER_COMPONENT[X]*FORMATS_TO_COMPONENTS[q]:We=TYPES_TO_BYTES_PER_PIXEL[X]:We=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[Y],We===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const Ue=T?parseKvData(E,ye,W):null;let je=$e*We,ze=te,He=ne,Le=Ae,qe=Ie,Qe=FILE_HEADER_SIZE+ye;for(let Ke=0;Ke<ge;Ke++){const Je=E.getUint32(Qe,W);let pt=Qe+4;for(let ut=0;ut<le;ut++){let lt=Ve[ut];lt||(lt=Ve[ut]=new Array(ge)),lt[Ke]={levelID:Ke,levelWidth:ge>1||X!==0?ze:Le,levelHeight:ge>1||X!==0?He:qe,levelBuffer:new Uint8Array(_,pt,je)},pt+=je}Qe+=Je+4,Qe=Qe%4!==0?Qe+4-Qe%4:Qe,ze=ze>>1||1,He=He>>1||1,Le=ze+xe-1&~(xe-1),qe=He+Te-1&~(Te-1),je=Le*qe*We}return X!==0?{uncompressed:Ve.map(Ke=>{let Je=Ke[0].levelBuffer,pt=!1;return X===TYPES.FLOAT?Je=new Float32Array(Ke[0].levelBuffer.buffer,Ke[0].levelBuffer.byteOffset,Ke[0].levelBuffer.byteLength/4):X===TYPES.UNSIGNED_INT?(pt=!0,Je=new Uint32Array(Ke[0].levelBuffer.buffer,Ke[0].levelBuffer.byteOffset,Ke[0].levelBuffer.byteLength/4)):X===TYPES.INT&&(pt=!0,Je=new Int32Array(Ke[0].levelBuffer.buffer,Ke[0].levelBuffer.byteOffset,Ke[0].levelBuffer.byteLength/4)),{resource:new BufferResource(Je,{width:Ke[0].levelWidth,height:Ke[0].levelHeight}),type:X,format:pt?convertFormatToInteger(q):q}}),kvData:Ue}:{compressed:Ve.map(Ke=>new CompressedTextureResource(null,{format:Y,width:te,height:ne,levels:ge,levelBuffers:Ke})),kvData:Ue}}function validate(B,_){for(let T=0;T<FILE_IDENTIFIER.length;T++)if(_.getUint8(T)!==FILE_IDENTIFIER[T])return console.error(`${B} is not a valid *.ktx file!`),!1;return!0}function convertFormatToInteger(B){switch(B){case FORMATS.RGBA:return FORMATS.RGBA_INTEGER;case FORMATS.RGB:return FORMATS.RGB_INTEGER;case FORMATS.RG:return FORMATS.RG_INTEGER;case FORMATS.RED:return FORMATS.RED_INTEGER;default:return B}}function parseKvData(B,_,T){const E=new Map;let W=0;for(;W<_;){const X=B.getUint32(FILE_HEADER_SIZE+W,T),q=FILE_HEADER_SIZE+W+4,Y=3-(X+3)%4;if(X===0||X>_-W){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let te=0;for(;te<X&&B.getUint8(q+te)!==0;te++);if(te===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const ne=new TextDecoder().decode(new Uint8Array(B.buffer,q,te)),ae=new DataView(B.buffer,q+te+1,X-te-1);E.set(ne,ae),W+=4+X+Y}return E}const loadDDS={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadDDS",test(B){return checkExtension(B,".dds")},async load(B,_,T){const E=await(await settings.ADAPTER.fetch(B)).arrayBuffer(),W=parseDDS(E).map(X=>{const q=new BaseTexture(X,{mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(B),..._.data});return createTexture(q,T,B)});return W.length===1?W[0]:W},unload(B){Array.isArray(B)?B.forEach(_=>_.destroy(!0)):B.destroy(!0)}};extensions$1.add(loadDDS);const loadKTX={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadKTX",test(B){return checkExtension(B,".ktx")},async load(B,_,T){const E=await(await settings.ADAPTER.fetch(B)).arrayBuffer(),{compressed:W,uncompressed:X,kvData:q}=parseKTX(B,E),Y=W??X,te={mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(B),..._.data},ne=Y.map(ae=>{Y===X&&Object.assign(te,{type:ae.type,format:ae.format});const le=ae.resource??ae,ue=new BaseTexture(le,te);return ue.ktxKeyValueData=q,createTexture(ue,T,B)});return ne.length===1?ne[0]:ne},unload(B){Array.isArray(B)?B.forEach(_=>_.destroy(!0)):B.destroy(!0)}};extensions$1.add(loadKTX);const knownFormats=["s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"],resolveCompressedTextureUrl={extension:ExtensionType.ResolveParser,test:B=>{const _=path.extname(B).slice(1);return["basis","ktx","dds"].includes(_)},parse:B=>{var E,W;const _=B.split("."),T=_.pop();if(["ktx","dds"].includes(T)){const X=_.pop();if(knownFormats.includes(X))return{resolution:parseFloat(((E=settings.RETINA_PREFIX.exec(B))==null?void 0:E[1])??"1"),format:X,src:B}}return{resolution:parseFloat(((W=settings.RETINA_PREFIX.exec(B))==null?void 0:W[1])??"1"),format:T,src:B}}};extensions$1.add(resolveCompressedTextureUrl);const TEMP_RECT=new Rectangle,BYTES_PER_PIXEL=4,_Extract=class Gl{constructor(_){this.renderer=_,this._rendererPremultipliedAlpha=!1}contextChange(){var T;const _=(T=this.renderer)==null?void 0:T.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(_&&_.alpha&&_.premultipliedAlpha)}async image(_,T,E,W){const X=new Image;return X.src=await this.base64(_,T,E,W),X}async base64(_,T,E,W){const X=this.canvas(_,W);if(X.toBlob!==void 0)return new Promise((q,Y)=>{X.toBlob(te=>{if(!te){Y(new Error("ICanvas.toBlob failed!"));return}const ne=new FileReader;ne.onload=()=>q(ne.result),ne.onerror=Y,ne.readAsDataURL(te)},T,E)});if(X.toDataURL!==void 0)return X.toDataURL(T,E);if(X.convertToBlob!==void 0){const q=await X.convertToBlob({type:T,quality:E});return new Promise((Y,te)=>{const ne=new FileReader;ne.onload=()=>Y(ne.result),ne.onerror=te,ne.readAsDataURL(q)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(_,T){const{pixels:E,width:W,height:X,flipY:q,premultipliedAlpha:Y}=this._rawPixels(_,T);q&&Gl._flipY(E,W,X),Y&&Gl._unpremultiplyAlpha(E);const te=new CanvasRenderTarget(W,X,1),ne=new ImageData(new Uint8ClampedArray(E.buffer),W,X);return te.context.putImageData(ne,0,0),te.canvas}pixels(_,T){const{pixels:E,width:W,height:X,flipY:q,premultipliedAlpha:Y}=this._rawPixels(_,T);return q&&Gl._flipY(E,W,X),Y&&Gl._unpremultiplyAlpha(E),E}_rawPixels(_,T){const E=this.renderer;if(!E)throw new Error("The Extract has already been destroyed");let W,X=!1,q=!1,Y,te=!1;_&&(_ instanceof RenderTexture?Y=_:(Y=E.generateTexture(_,{region:T,resolution:E.resolution,multisample:E.multisample}),te=!0,T&&(TEMP_RECT.width=T.width,TEMP_RECT.height=T.height,T=TEMP_RECT)));const ne=E.gl;if(Y){if(W=Y.baseTexture.resolution,T=T??Y.frame,X=!1,q=Y.baseTexture.alphaMode>0&&Y.baseTexture.format===FORMATS.RGBA,!te){E.renderTexture.bind(Y);const ge=Y.framebuffer.glFramebuffers[E.CONTEXT_UID];ge.blitFramebuffer&&E.framebuffer.bind(ge.blitFramebuffer)}}else W=E.resolution,T||(T=TEMP_RECT,T.width=E.width/W,T.height=E.height/W),X=!0,q=this._rendererPremultipliedAlpha,E.renderTexture.bind();const ae=Math.max(Math.round(T.width*W),1),le=Math.max(Math.round(T.height*W),1),ue=new Uint8Array(BYTES_PER_PIXEL*ae*le);return ne.readPixels(Math.round(T.x*W),Math.round(T.y*W),ae,le,ne.RGBA,ne.UNSIGNED_BYTE,ue),te&&(Y==null||Y.destroy(!0)),{pixels:ue,width:ae,height:le,flipY:X,premultipliedAlpha:q}}destroy(){this.renderer=null}static _flipY(_,T,E){const W=T<<2,X=E>>1,q=new Uint8Array(W);for(let Y=0;Y<X;Y++){const te=Y*W,ne=(E-Y-1)*W;q.set(_.subarray(te,te+W)),_.copyWithin(te,ne,ne+W),_.set(q,ne)}}static _unpremultiplyAlpha(_){_ instanceof Uint8ClampedArray&&(_=new Uint8Array(_.buffer));const T=_.length;for(let E=0;E<T;E+=4){const W=_[E+3];if(W!==0){const X=255.001/W;_[E]=_[E]*X+.5,_[E+1]=_[E+1]*X+.5,_[E+2]=_[E+2]*X+.5}}}};_Extract.extension={name:"extract",type:ExtensionType.RendererSystem};let Extract=_Extract;extensions$1.add(Extract);const buildCircle={build(B){const _=B.points;let T,E,W,X,q,Y;if(B.type===SHAPES.CIRC){const ye=B.shape;T=ye.x,E=ye.y,q=Y=ye.radius,W=X=0}else if(B.type===SHAPES.ELIP){const ye=B.shape;T=ye.x,E=ye.y,q=ye.width,Y=ye.height,W=X=0}else{const ye=B.shape,xe=ye.width/2,Te=ye.height/2;T=ye.x+xe,E=ye.y+Te,q=Y=Math.max(0,Math.min(ye.radius,Math.min(xe,Te))),W=xe-q,X=Te-Y}if(!(q>=0&&Y>=0&&W>=0&&X>=0)){_.length=0;return}const te=Math.ceil(2.3*Math.sqrt(q+Y)),ne=te*8+(W?4:0)+(X?4:0);if(_.length=ne,ne===0)return;if(te===0){_.length=8,_[0]=_[6]=T+W,_[1]=_[3]=E+X,_[2]=_[4]=T-W,_[5]=_[7]=E-X;return}let ae=0,le=te*4+(W?2:0)+2,ue=le,ge=ne;{const ye=W+q,xe=X,Te=T+ye,Ae=T-ye,Ie=E+xe;if(_[ae++]=Te,_[ae++]=Ie,_[--le]=Ie,_[--le]=Ae,X){const Ve=E-xe;_[ue++]=Ae,_[ue++]=Ve,_[--ge]=Ve,_[--ge]=Te}}for(let ye=1;ye<te;ye++){const xe=Math.PI/2*(ye/te),Te=W+Math.cos(xe)*q,Ae=X+Math.sin(xe)*Y,Ie=T+Te,Ve=T-Te,$e=E+Ae,We=E-Ae;_[ae++]=Ie,_[ae++]=$e,_[--le]=$e,_[--le]=Ve,_[ue++]=Ve,_[ue++]=We,_[--ge]=We,_[--ge]=Ie}{const ye=W,xe=X+Y,Te=T+ye,Ae=T-ye,Ie=E+xe,Ve=E-xe;_[ae++]=Te,_[ae++]=Ie,_[--ge]=Ve,_[--ge]=Te,W&&(_[ae++]=Ae,_[ae++]=Ie,_[--ge]=Ve,_[--ge]=Ae)}},triangulate(B,_){const T=B.points,E=_.points,W=_.indices;if(T.length===0)return;let X=E.length/2;const q=X;let Y,te;if(B.type!==SHAPES.RREC){const ae=B.shape;Y=ae.x,te=ae.y}else{const ae=B.shape;Y=ae.x+ae.width/2,te=ae.y+ae.height/2}const ne=B.matrix;E.push(B.matrix?ne.a*Y+ne.c*te+ne.tx:Y,B.matrix?ne.b*Y+ne.d*te+ne.ty:te),X++,E.push(T[0],T[1]);for(let ae=2;ae<T.length;ae+=2)E.push(T[ae],T[ae+1]),W.push(X++,q,X);W.push(q+1,q,X)}};function fixOrientation(B,_=!1){const T=B.length;if(T<6)return;let E=0;for(let W=0,X=B[T-2],q=B[T-1];W<T;W+=2){const Y=B[W],te=B[W+1];E+=(Y-X)*(te+q),X=Y,q=te}if(!_&&E>0||_&&E<=0){const W=T/2;for(let X=W+W%2;X<T;X+=2){const q=T-X-2,Y=T-X-1,te=X,ne=X+1;[B[q],B[te]]=[B[te],B[q]],[B[Y],B[ne]]=[B[ne],B[Y]]}}}const buildPoly={build(B){B.points=B.shape.points.slice()},triangulate(B,_){let T=B.points;const E=B.holes,W=_.points,X=_.indices;if(T.length>=6){fixOrientation(T,!1);const q=[];for(let ne=0;ne<E.length;ne++){const ae=E[ne];fixOrientation(ae.points,!0),q.push(T.length/2),T=T.concat(ae.points)}const Y=earcut$1(T,q,2);if(!Y)return;const te=W.length/2;for(let ne=0;ne<Y.length;ne+=3)X.push(Y[ne]+te),X.push(Y[ne+1]+te),X.push(Y[ne+2]+te);for(let ne=0;ne<T.length;ne++)W.push(T[ne])}}},buildRectangle={build(B){const _=B.shape,T=_.x,E=_.y,W=_.width,X=_.height,q=B.points;q.length=0,W>=0&&X>=0&&q.push(T,E,T+W,E,T+W,E+X,T,E+X)},triangulate(B,_){const T=B.points,E=_.points;if(T.length===0)return;const W=E.length/2;E.push(T[0],T[1],T[2],T[3],T[6],T[7],T[4],T[5]),_.indices.push(W,W+1,W+2,W+1,W+2,W+3)}},buildRoundedRectangle={build(B){buildCircle.build(B)},triangulate(B,_){buildCircle.triangulate(B,_)}};var LINE_JOIN=(B=>(B.MITER="miter",B.BEVEL="bevel",B.ROUND="round",B))(LINE_JOIN||{}),LINE_CAP=(B=>(B.BUTT="butt",B.ROUND="round",B.SQUARE="square",B))(LINE_CAP||{});const curves={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(B,_=20){if(!this.adaptive||!B||isNaN(B))return _;let T=Math.ceil(B/this.maxLength);return T<this.minSegments?T=this.minSegments:T>this.maxSegments&&(T=this.maxSegments),T}};class ArcUtils{static curveTo(_,T,E,W,X,q){const Y=q[q.length-2],te=q[q.length-1]-T,ne=Y-_,ae=W-T,le=E-_,ue=Math.abs(te*le-ne*ae);if(ue<1e-8||X===0)return(q[q.length-2]!==_||q[q.length-1]!==T)&&q.push(_,T),null;const ge=te*te+ne*ne,ye=ae*ae+le*le,xe=te*ae+ne*le,Te=X*Math.sqrt(ge)/ue,Ae=X*Math.sqrt(ye)/ue,Ie=Te*xe/ge,Ve=Ae*xe/ye,$e=Te*le+Ae*ne,We=Te*ae+Ae*te,Ue=ne*(Ae+Ie),je=te*(Ae+Ie),ze=le*(Te+Ve),He=ae*(Te+Ve),Le=Math.atan2(je-We,Ue-$e),qe=Math.atan2(He-We,ze-$e);return{cx:$e+_,cy:We+T,radius:X,startAngle:Le,endAngle:qe,anticlockwise:ne*ae>le*te}}static arc(_,T,E,W,X,q,Y,te,ne){const ae=Y-q,le=curves._segmentsCount(Math.abs(ae)*X,Math.ceil(Math.abs(ae)/PI_2)*40),ue=ae/(le*2),ge=ue*2,ye=Math.cos(ue),xe=Math.sin(ue),Te=le-1,Ae=Te%1/Te;for(let Ie=0;Ie<=Te;++Ie){const Ve=Ie+Ae*Ie,$e=ue+q+ge*Ve,We=Math.cos($e),Ue=-Math.sin($e);ne.push((ye*We+xe*Ue)*X+E,(ye*-Ue+xe*We)*X+W)}}}class BatchPart{constructor(){this.reset()}begin(_,T,E){this.reset(),this.style=_,this.start=T,this.attribStart=E}end(_,T){this.attribSize=T-this.attribStart,this.size=_-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class BezierUtils{static curveLength(_,T,E,W,X,q,Y,te){let ne=0,ae=0,le=0,ue=0,ge=0,ye=0,xe=0,Te=0,Ae=0,Ie=0,Ve=0,$e=_,We=T;for(let Ue=1;Ue<=10;++Ue)ae=Ue/10,le=ae*ae,ue=le*ae,ge=1-ae,ye=ge*ge,xe=ye*ge,Te=xe*_+3*ye*ae*E+3*ge*le*X+ue*Y,Ae=xe*T+3*ye*ae*W+3*ge*le*q+ue*te,Ie=$e-Te,Ve=We-Ae,$e=Te,We=Ae,ne+=Math.sqrt(Ie*Ie+Ve*Ve);return ne}static curveTo(_,T,E,W,X,q,Y){const te=Y[Y.length-2],ne=Y[Y.length-1];Y.length-=2;const ae=curves._segmentsCount(BezierUtils.curveLength(te,ne,_,T,E,W,X,q));let le=0,ue=0,ge=0,ye=0,xe=0;Y.push(te,ne);for(let Te=1,Ae=0;Te<=ae;++Te)Ae=Te/ae,le=1-Ae,ue=le*le,ge=ue*le,ye=Ae*Ae,xe=ye*Ae,Y.push(ge*te+3*ue*Ae*_+3*le*ye*E+xe*X,ge*ne+3*ue*Ae*T+3*le*ye*W+xe*q)}}function square(B,_,T,E,W,X,q,Y){const te=B-T*W,ne=_-E*W,ae=B+T*X,le=_+E*X;let ue,ge;q?(ue=E,ge=-T):(ue=-E,ge=T);const ye=te+ue,xe=ne+ge,Te=ae+ue,Ae=le+ge;return Y.push(ye,xe,Te,Ae),2}function round(B,_,T,E,W,X,q,Y){const te=T-B,ne=E-_;let ae=Math.atan2(te,ne),le=Math.atan2(W-B,X-_);Y&&ae<le?ae+=Math.PI*2:!Y&&ae>le&&(le+=Math.PI*2);let ue=ae;const ge=le-ae,ye=Math.abs(ge),xe=Math.sqrt(te*te+ne*ne),Te=(15*ye*Math.sqrt(xe)/Math.PI>>0)+1,Ae=ge/Te;if(ue+=Ae,Y){q.push(B,_,T,E);for(let Ie=1,Ve=ue;Ie<Te;Ie++,Ve+=Ae)q.push(B,_,B+Math.sin(Ve)*xe,_+Math.cos(Ve)*xe);q.push(B,_,W,X)}else{q.push(T,E,B,_);for(let Ie=1,Ve=ue;Ie<Te;Ie++,Ve+=Ae)q.push(B+Math.sin(Ve)*xe,_+Math.cos(Ve)*xe,B,_);q.push(W,X,B,_)}return Te*2}function buildNonNativeLine(B,_){const T=B.shape;let E=B.points||T.points.slice();const W=_.closePointEps;if(E.length===0)return;const X=B.lineStyle,q=new Point(E[0],E[1]),Y=new Point(E[E.length-2],E[E.length-1]),te=T.type!==SHAPES.POLY||T.closeStroke,ne=Math.abs(q.x-Y.x)<W&&Math.abs(q.y-Y.y)<W;if(te){E=E.slice(),ne&&(E.pop(),E.pop(),Y.set(E[E.length-2],E[E.length-1]));const lt=(q.x+Y.x)*.5,st=(Y.y+q.y)*.5;E.unshift(lt,st),E.push(lt,st)}const ae=_.points,le=E.length/2;let ue=E.length;const ge=ae.length/2,ye=X.width/2,xe=ye*ye,Te=X.miterLimit*X.miterLimit;let Ae=E[0],Ie=E[1],Ve=E[2],$e=E[3],We=0,Ue=0,je=-(Ie-$e),ze=Ae-Ve,He=0,Le=0,qe=Math.sqrt(je*je+ze*ze);je/=qe,ze/=qe,je*=ye,ze*=ye;const Qe=X.alignment,Ke=(1-Qe)*2,Je=Qe*2;te||(X.cap===LINE_CAP.ROUND?ue+=round(Ae-je*(Ke-Je)*.5,Ie-ze*(Ke-Je)*.5,Ae-je*Ke,Ie-ze*Ke,Ae+je*Je,Ie+ze*Je,ae,!0)+2:X.cap===LINE_CAP.SQUARE&&(ue+=square(Ae,Ie,je,ze,Ke,Je,!0,ae))),ae.push(Ae-je*Ke,Ie-ze*Ke,Ae+je*Je,Ie+ze*Je);for(let lt=1;lt<le-1;++lt){Ae=E[(lt-1)*2],Ie=E[(lt-1)*2+1],Ve=E[lt*2],$e=E[lt*2+1],We=E[(lt+1)*2],Ue=E[(lt+1)*2+1],je=-(Ie-$e),ze=Ae-Ve,qe=Math.sqrt(je*je+ze*ze),je/=qe,ze/=qe,je*=ye,ze*=ye,He=-($e-Ue),Le=Ve-We,qe=Math.sqrt(He*He+Le*Le),He/=qe,Le/=qe,He*=ye,Le*=ye;const st=Ve-Ae,sr=Ie-$e,mt=Ve-We,Tr=Ue-$e,di=st*mt+sr*Tr,Mi=sr*mt-Tr*st,Gr=Mi<0;if(Math.abs(Mi)<.001*Math.abs(di)){ae.push(Ve-je*Ke,$e-ze*Ke,Ve+je*Je,$e+ze*Je),di>=0&&(X.join===LINE_JOIN.ROUND?ue+=round(Ve,$e,Ve-je*Ke,$e-ze*Ke,Ve-He*Ke,$e-Le*Ke,ae,!1)+4:ue+=2,ae.push(Ve-He*Je,$e-Le*Je,Ve+He*Ke,$e+Le*Ke));continue}const ci=(-je+Ae)*(-ze+$e)-(-je+Ve)*(-ze+Ie),gi=(-He+We)*(-Le+$e)-(-He+Ve)*(-Le+Ue),fi=(st*gi-mt*ci)/Mi,ri=(Tr*ci-sr*gi)/Mi,ot=(fi-Ve)*(fi-Ve)+(ri-$e)*(ri-$e),rt=Ve+(fi-Ve)*Ke,gt=$e+(ri-$e)*Ke,Or=Ve-(fi-Ve)*Je,et=$e-(ri-$e)*Je,at=Math.min(st*st+sr*sr,mt*mt+Tr*Tr),Rr=Gr?Ke:Je,Br=at+Rr*Rr*xe,Kr=ot<=Br;let oi=X.join;if(oi===LINE_JOIN.MITER&&ot/xe>Te&&(oi=LINE_JOIN.BEVEL),Kr)switch(oi){case LINE_JOIN.MITER:{ae.push(rt,gt,Or,et);break}case LINE_JOIN.BEVEL:{Gr?ae.push(rt,gt,Ve+je*Je,$e+ze*Je,rt,gt,Ve+He*Je,$e+Le*Je):ae.push(Ve-je*Ke,$e-ze*Ke,Or,et,Ve-He*Ke,$e-Le*Ke,Or,et),ue+=2;break}case LINE_JOIN.ROUND:{Gr?(ae.push(rt,gt,Ve+je*Je,$e+ze*Je),ue+=round(Ve,$e,Ve+je*Je,$e+ze*Je,Ve+He*Je,$e+Le*Je,ae,!0)+4,ae.push(rt,gt,Ve+He*Je,$e+Le*Je)):(ae.push(Ve-je*Ke,$e-ze*Ke,Or,et),ue+=round(Ve,$e,Ve-je*Ke,$e-ze*Ke,Ve-He*Ke,$e-Le*Ke,ae,!1)+4,ae.push(Ve-He*Ke,$e-Le*Ke,Or,et));break}}else{switch(ae.push(Ve-je*Ke,$e-ze*Ke,Ve+je*Je,$e+ze*Je),oi){case LINE_JOIN.MITER:{Gr?ae.push(Or,et,Or,et):ae.push(rt,gt,rt,gt),ue+=2;break}case LINE_JOIN.ROUND:{Gr?ue+=round(Ve,$e,Ve+je*Je,$e+ze*Je,Ve+He*Je,$e+Le*Je,ae,!0)+2:ue+=round(Ve,$e,Ve-je*Ke,$e-ze*Ke,Ve-He*Ke,$e-Le*Ke,ae,!1)+2;break}}ae.push(Ve-He*Ke,$e-Le*Ke,Ve+He*Je,$e+Le*Je),ue+=2}}Ae=E[(le-2)*2],Ie=E[(le-2)*2+1],Ve=E[(le-1)*2],$e=E[(le-1)*2+1],je=-(Ie-$e),ze=Ae-Ve,qe=Math.sqrt(je*je+ze*ze),je/=qe,ze/=qe,je*=ye,ze*=ye,ae.push(Ve-je*Ke,$e-ze*Ke,Ve+je*Je,$e+ze*Je),te||(X.cap===LINE_CAP.ROUND?ue+=round(Ve-je*(Ke-Je)*.5,$e-ze*(Ke-Je)*.5,Ve-je*Ke,$e-ze*Ke,Ve+je*Je,$e+ze*Je,ae,!1)+2:X.cap===LINE_CAP.SQUARE&&(ue+=square(Ve,$e,je,ze,Ke,Je,!1,ae)));const pt=_.indices,ut=curves.epsilon*curves.epsilon;for(let lt=ge;lt<ue+ge-2;++lt)Ae=ae[lt*2],Ie=ae[lt*2+1],Ve=ae[(lt+1)*2],$e=ae[(lt+1)*2+1],We=ae[(lt+2)*2],Ue=ae[(lt+2)*2+1],!(Math.abs(Ae*($e-Ue)+Ve*(Ue-Ie)+We*(Ie-$e))<ut)&&pt.push(lt,lt+1,lt+2)}function buildNativeLine(B,_){let T=0;const E=B.shape,W=B.points||E.points,X=E.type!==SHAPES.POLY||E.closeStroke;if(W.length===0)return;const q=_.points,Y=_.indices,te=W.length/2,ne=q.length/2;let ae=ne;for(q.push(W[0],W[1]),T=1;T<te;T++)q.push(W[T*2],W[T*2+1]),Y.push(ae,ae+1),ae++;X&&Y.push(ae,ne)}function buildLine(B,_){B.lineStyle.native?buildNativeLine(B,_):buildNonNativeLine(B,_)}class QuadraticUtils{static curveLength(_,T,E,W,X,q){const Y=_-2*E+X,te=T-2*W+q,ne=2*E-2*_,ae=2*W-2*T,le=4*(Y*Y+te*te),ue=4*(Y*ne+te*ae),ge=ne*ne+ae*ae,ye=2*Math.sqrt(le+ue+ge),xe=Math.sqrt(le),Te=2*le*xe,Ae=2*Math.sqrt(ge),Ie=ue/xe;return(Te*ye+xe*ue*(ye-Ae)+(4*ge*le-ue*ue)*Math.log((2*xe+Ie+ye)/(Ie+Ae)))/(4*Te)}static curveTo(_,T,E,W,X){const q=X[X.length-2],Y=X[X.length-1],te=curves._segmentsCount(QuadraticUtils.curveLength(q,Y,_,T,E,W));let ne=0,ae=0;for(let le=1;le<=te;++le){const ue=le/te;ne=q+(_-q)*ue,ae=Y+(T-Y)*ue,X.push(ne+(_+(E-_)*ue-ne)*ue,ae+(T+(W-T)*ue-ae)*ue)}}}const FILL_COMMANDS={[SHAPES.POLY]:buildPoly,[SHAPES.CIRC]:buildCircle,[SHAPES.ELIP]:buildCircle,[SHAPES.RECT]:buildRectangle,[SHAPES.RREC]:buildRoundedRectangle},BATCH_POOL=[],DRAW_CALL_POOL=[];class GraphicsData{constructor(_,T=null,E=null,W=null){this.points=[],this.holes=[],this.shape=_,this.lineStyle=E,this.fillStyle=T,this.matrix=W,this.type=_.type}clone(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const tmpPoint=new Point,_GraphicsGeometry=class hg extends BatchGeometry{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Bounds,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let _=0;_<this.drawCalls.length;_++)this.drawCalls[_].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[_]);this.drawCalls.length=0;for(let _=0;_<this.batches.length;_++){const T=this.batches[_];T.reset(),BATCH_POOL.push(T)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(_,T=null,E=null,W=null){const X=new GraphicsData(_,T,E,W);return this.graphicsData.push(X),this.dirty++,this}drawHole(_,T=null){if(!this.graphicsData.length)return null;const E=new GraphicsData(_,null,null,T),W=this.graphicsData[this.graphicsData.length-1];return E.lineStyle=W.lineStyle,W.holes.push(E),this.dirty++,this}destroy(){super.destroy();for(let _=0;_<this.graphicsData.length;++_)this.graphicsData[_].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(_){const T=this.graphicsData;for(let E=0;E<T.length;++E){const W=T[E];if(W.fillStyle.visible&&W.shape&&(W.matrix?W.matrix.applyInverse(_,tmpPoint):tmpPoint.copyFrom(_),W.shape.contains(tmpPoint.x,tmpPoint.y))){let X=!1;if(W.holes){for(let q=0;q<W.holes.length;q++)if(W.holes[q].shape.contains(tmpPoint.x,tmpPoint.y)){X=!0;break}}if(!X)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const _=this.uvs,T=this.graphicsData;let E=null,W=null;this.batches.length>0&&(E=this.batches[this.batches.length-1],W=E.style);for(let te=this.shapeIndex;te<T.length;te++){this.shapeIndex++;const ne=T[te],ae=ne.fillStyle,le=ne.lineStyle;FILL_COMMANDS[ne.type].build(ne),ne.matrix&&this.transformPoints(ne.points,ne.matrix),(ae.visible||le.visible)&&this.processHoles(ne.holes);for(let ue=0;ue<2;ue++){const ge=ue===0?ae:le;if(!ge.visible)continue;const ye=ge.texture.baseTexture,xe=this.indices.length,Te=this.points.length/2;ye.wrapMode=WRAP_MODES.REPEAT,ue===0?this.processFill(ne):this.processLine(ne);const Ae=this.points.length/2-Te;Ae!==0&&(E&&!this._compareStyles(W,ge)&&(E.end(xe,Te),E=null),E||(E=BATCH_POOL.pop()||new BatchPart,E.begin(ge,xe,Te),this.batches.push(E),W=ge),this.addUvs(this.points,_,ge.texture,Te,Ae,ge.matrix))}}const X=this.indices.length,q=this.points.length/2;if(E&&E.end(X,q),this.batches.length===0){this.batchable=!0;return}const Y=q>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&Y===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=Y?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(_,T){return!(!_||!T||_.texture.baseTexture!==T.texture.baseTexture||_.color+_.alpha!==T.color+T.alpha||!!_.native!=!!T.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let _=0,T=this.graphicsData.length;_<T;_++){const E=this.graphicsData[_],W=E.fillStyle,X=E.lineStyle;if(W&&!W.texture.baseTexture.valid||X&&!X.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const _=this.batches;for(let T=0,E=_.length;T<E;T++){const W=_[T];for(let X=0;X<W.size;X++){const q=W.start+X;this.indicesUint16[q]=this.indicesUint16[q]-W.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const _=this.batches;for(let T=0;T<_.length;T++)if(_[T].style.native)return!1;return this.points.length<hg.BATCHABLE_SIZE*2}buildDrawCalls(){let _=++BaseTexture._globalBatch;for(let le=0;le<this.drawCalls.length;le++)this.drawCalls[le].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[le]);this.drawCalls.length=0;const T=this.colors,E=this.textureIds;let W=DRAW_CALL_POOL.pop();W||(W=new BatchDrawCall,W.texArray=new BatchTextureArray),W.texArray.count=0,W.start=0,W.size=0,W.type=DRAW_MODES.TRIANGLES;let X=0,q=null,Y=0,te=!1,ne=DRAW_MODES.TRIANGLES,ae=0;this.drawCalls.push(W);for(let le=0;le<this.batches.length;le++){const ue=this.batches[le],ge=8,ye=ue.style,xe=ye.texture.baseTexture;te!==!!ye.native&&(te=!!ye.native,ne=te?DRAW_MODES.LINES:DRAW_MODES.TRIANGLES,q=null,X=ge,_++),q!==xe&&(q=xe,xe._batchEnabled!==_&&(X===ge&&(_++,X=0,W.size>0&&(W=DRAW_CALL_POOL.pop(),W||(W=new BatchDrawCall,W.texArray=new BatchTextureArray),this.drawCalls.push(W)),W.start=ae,W.size=0,W.texArray.count=0,W.type=ne),xe.touched=1,xe._batchEnabled=_,xe._batchLocation=X,xe.wrapMode=WRAP_MODES.REPEAT,W.texArray.elements[W.texArray.count++]=xe,X++)),W.size+=ue.size,ae+=ue.size,Y=xe._batchLocation,this.addColors(T,ye.color,ye.alpha,ue.attribSize,ue.attribStart),this.addTextureIds(E,Y,ue.attribSize,ue.attribStart)}BaseTexture._globalBatch=_,this.packAttributes()}packAttributes(){const _=this.points,T=this.uvs,E=this.colors,W=this.textureIds,X=new ArrayBuffer(_.length*3*4),q=new Float32Array(X),Y=new Uint32Array(X);let te=0;for(let ne=0;ne<_.length/2;ne++)q[te++]=_[ne*2],q[te++]=_[ne*2+1],q[te++]=T[ne*2],q[te++]=T[ne*2+1],Y[te++]=E[ne],q[te++]=W[ne];this._buffer.update(X),this._indexBuffer.update(this.indicesUint16)}processFill(_){_.holes.length?buildPoly.triangulate(_,this):FILL_COMMANDS[_.type].triangulate(_,this)}processLine(_){buildLine(_,this);for(let T=0;T<_.holes.length;T++)buildLine(_.holes[T],this)}processHoles(_){for(let T=0;T<_.length;T++){const E=_[T];FILL_COMMANDS[E.type].build(E),E.matrix&&this.transformPoints(E.points,E.matrix)}}calculateBounds(){const _=this._bounds;_.clear(),_.addVertexData(this.points,0,this.points.length),_.pad(this.boundsPadding,this.boundsPadding)}transformPoints(_,T){for(let E=0;E<_.length/2;E++){const W=_[E*2],X=_[E*2+1];_[E*2]=T.a*W+T.c*X+T.tx,_[E*2+1]=T.b*W+T.d*X+T.ty}}addColors(_,T,E,W,X=0){const q=Color$1.shared.setValue(T).toLittleEndianNumber(),Y=Color$1.shared.setValue(q).toPremultiplied(E);_.length=Math.max(_.length,X+W);for(let te=0;te<W;te++)_[X+te]=Y}addTextureIds(_,T,E,W=0){_.length=Math.max(_.length,W+E);for(let X=0;X<E;X++)_[W+X]=T}addUvs(_,T,E,W,X,q=null){let Y=0;const te=T.length,ne=E.frame;for(;Y<X;){let le=_[(W+Y)*2],ue=_[(W+Y)*2+1];if(q){const ge=q.a*le+q.c*ue+q.tx;ue=q.b*le+q.d*ue+q.ty,le=ge}Y++,T.push(le/ne.width,ue/ne.height)}const ae=E.baseTexture;(ne.width<ae.width||ne.height<ae.height)&&this.adjustUvs(T,E,te,X)}adjustUvs(_,T,E,W){const X=T.baseTexture,q=1e-6,Y=E+W*2,te=T.frame,ne=te.width/X.width,ae=te.height/X.height;let le=te.x/te.width,ue=te.y/te.height,ge=Math.floor(_[E]+q),ye=Math.floor(_[E+1]+q);for(let xe=E+2;xe<Y;xe+=2)ge=Math.min(ge,Math.floor(_[xe]+q)),ye=Math.min(ye,Math.floor(_[xe+1]+q));le-=ge,ue-=ye;for(let xe=E;xe<Y;xe+=2)_[xe]=(_[xe]+le)*ne,_[xe+1]=(_[xe+1]+ue)*ae}};_GraphicsGeometry.BATCHABLE_SIZE=100;let GraphicsGeometry=_GraphicsGeometry;class FillStyle{constructor(){this.color=16777215,this.alpha=1,this.texture=Texture$1.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const _=new FillStyle;return _.color=this.color,_.alpha=this.alpha,_.texture=this.texture,_.matrix=this.matrix,_.visible=this.visible,_}reset(){this.color=16777215,this.alpha=1,this.texture=Texture$1.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class LineStyle extends FillStyle{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}clone(){const _=new LineStyle;return _.color=this.color,_.alpha=this.alpha,_.texture=this.texture,_.matrix=this.matrix,_.visible=this.visible,_.width=this.width,_.alignment=this.alignment,_.native=this.native,_.cap=this.cap,_.join=this.join,_.miterLimit=this.miterLimit,_}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}}const DEFAULT_SHADERS={},_Graphics=class bu extends Container{constructor(_=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new FillStyle,this._lineStyle=new LineStyle,this._matrix=null,this._holeMode=!1,this.state=State.for2d(),this._geometry=_||new GraphicsGeometry,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Color$1(16777215),this.blendMode=BLEND_MODES.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new bu(this._geometry)}set blendMode(_){this.state.blendMode=_}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(_){this._tintColor.setValue(_)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(_=null,T=0,E,W=.5,X=!1){return typeof _=="number"&&(_={width:_,color:T,alpha:E,alignment:W,native:X}),this.lineTextureStyle(_)}lineTextureStyle(_){const T={width:0,texture:Texture$1.WHITE,color:_!=null&&_.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:LINE_CAP.BUTT,join:LINE_JOIN.MITER,miterLimit:10};_=Object.assign(T,_),this.normalizeColor(_),this.currentPath&&this.startPoly();const E=_.width>0&&_.alpha>0;return E?(_.matrix&&(_.matrix=_.matrix.clone(),_.matrix.invert()),Object.assign(this._lineStyle,{visible:E},_)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const _=this.currentPath.points,T=this.currentPath.points.length;T>2&&(this.drawShape(this.currentPath),this.currentPath=new Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(_[T-2],_[T-1]))}else this.currentPath=new Polygon,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(_,T){return this.startPoly(),this.currentPath.points[0]=_,this.currentPath.points[1]=T,this}lineTo(_,T){this.currentPath||this.moveTo(0,0);const E=this.currentPath.points,W=E[E.length-2],X=E[E.length-1];return(W!==_||X!==T)&&E.push(_,T),this}_initCurve(_=0,T=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[_,T]):this.moveTo(_,T)}quadraticCurveTo(_,T,E,W){this._initCurve();const X=this.currentPath.points;return X.length===0&&this.moveTo(0,0),QuadraticUtils.curveTo(_,T,E,W,X),this}bezierCurveTo(_,T,E,W,X,q){return this._initCurve(),BezierUtils.curveTo(_,T,E,W,X,q,this.currentPath.points),this}arcTo(_,T,E,W,X){this._initCurve(_,T);const q=this.currentPath.points,Y=ArcUtils.curveTo(_,T,E,W,X,q);if(Y){const{cx:te,cy:ne,radius:ae,startAngle:le,endAngle:ue,anticlockwise:ge}=Y;this.arc(te,ne,ae,le,ue,ge)}return this}arc(_,T,E,W,X,q=!1){if(W===X)return this;if(!q&&X<=W?X+=PI_2:q&&W<=X&&(W+=PI_2),X-W===0)return this;const Y=_+Math.cos(W)*E,te=T+Math.sin(W)*E,ne=this._geometry.closePointEps;let ae=this.currentPath?this.currentPath.points:null;if(ae){const le=Math.abs(ae[ae.length-2]-Y),ue=Math.abs(ae[ae.length-1]-te);le<ne&&ue<ne||ae.push(Y,te)}else this.moveTo(Y,te),ae=this.currentPath.points;return ArcUtils.arc(Y,te,_,T,E,W,X,q,ae),this}beginFill(_=0,T){return this.beginTextureFill({texture:Texture$1.WHITE,color:_,alpha:T})}normalizeColor(_){const T=Color$1.shared.setValue(_.color??0);_.color=T.toNumber(),_.alpha??(_.alpha=T.alpha)}beginTextureFill(_){const T={texture:Texture$1.WHITE,color:16777215,matrix:null};_=Object.assign(T,_),this.normalizeColor(_),this.currentPath&&this.startPoly();const E=_.alpha>0;return E?(_.matrix&&(_.matrix=_.matrix.clone(),_.matrix.invert()),Object.assign(this._fillStyle,{visible:E},_)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(_,T,E,W){return this.drawShape(new Rectangle(_,T,E,W))}drawRoundedRect(_,T,E,W,X){return this.drawShape(new RoundedRectangle(_,T,E,W,X))}drawCircle(_,T,E){return this.drawShape(new Circle$1(_,T,E))}drawEllipse(_,T,E,W){return this.drawShape(new Ellipse(_,T,E,W))}drawPolygon(..._){let T,E=!0;const W=_[0];W.points?(E=W.closeStroke,T=W.points):Array.isArray(_[0])?T=_[0]:T=_;const X=new Polygon(T);return X.closeStroke=E,this.drawShape(X),this}drawShape(_){return this._holeMode?this._geometry.drawHole(_,this._matrix):this._geometry.drawShape(_,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const _=this._geometry.graphicsData;return _.length===1&&_[0].shape.type===SHAPES.RECT&&!_[0].matrix&&!_[0].holes.length&&!(_[0].lineStyle.visible&&_[0].lineStyle.width)}_render(_){this.finishPoly();const T=this._geometry;T.updateBatches(),T.batchable?(this.batchDirty!==T.batchDirty&&this._populateBatches(),this._renderBatched(_)):(_.batch.flush(),this._renderDirect(_))}_populateBatches(){const _=this._geometry,T=this.blendMode,E=_.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=_.batchDirty,this.batches.length=E,this.vertexData=new Float32Array(_.points);for(let W=0;W<E;W++){const X=_.batches[W],q=X.style.color,Y=new Float32Array(this.vertexData.buffer,X.attribStart*4*2,X.attribSize*2),te=new Float32Array(_.uvsFloat32.buffer,X.attribStart*4*2,X.attribSize*2),ne=new Uint16Array(_.indicesUint16.buffer,X.start*2,X.size),ae={vertexData:Y,blendMode:T,indices:ne,uvs:te,_batchRGB:Color$1.shared.setValue(q).toRgbArray(),_tintRGB:q,_texture:X.style.texture,alpha:X.style.alpha,worldAlpha:1};this.batches[W]=ae}}_renderBatched(_){if(this.batches.length){_.batch.setObjectRenderer(_.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let T=0,E=this.batches.length;T<E;T++){const W=this.batches[T];W.worldAlpha=this.worldAlpha*W.alpha,_.plugins[this.pluginName].render(W)}}}_renderDirect(_){const T=this._resolveDirectShader(_),E=this._geometry,W=this.worldAlpha,X=T.uniforms,q=E.drawCalls;X.translationMatrix=this.transform.worldTransform,Color$1.shared.setValue(this._tintColor).premultiply(W).toArray(X.tint),_.shader.bind(T),_.geometry.bind(E,T),_.state.set(this.state);for(let Y=0,te=q.length;Y<te;Y++)this._renderDrawCallDirect(_,E.drawCalls[Y])}_renderDrawCallDirect(_,T){const{texArray:E,type:W,size:X,start:q}=T,Y=E.count;for(let te=0;te<Y;te++)_.texture.bind(E.elements[te],te);_.geometry.draw(W,X,q)}_resolveDirectShader(_){let T=this.shader;const E=this.pluginName;if(!T){if(!DEFAULT_SHADERS[E]){const{maxTextures:W}=_.plugins[E],X=new Int32Array(W);for(let te=0;te<W;te++)X[te]=te;const q={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:UniformGroup.from({uSamplers:X},!0)},Y=_.plugins[E]._shader.program;DEFAULT_SHADERS[E]=new Shader(Y,q)}T=DEFAULT_SHADERS[E]}return T}_calculateBounds(){this.finishPoly();const _=this._geometry;if(!_.graphicsData.length)return;const{minX:T,minY:E,maxX:W,maxY:X}=_.bounds;this._bounds.addFrame(this.transform,T,E,W,X)}containsPoint(_){return this.worldTransform.applyInverse(_,bu._TEMP_POINT),this._geometry.containsPoint(bu._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let _=0;_<this.batches.length;_++){const T=this.batches[_];T._tintRGB=Color$1.shared.setValue(this._tintColor).multiply(T._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const _=this.transform._worldID;if(this._transformID===_)return;this._transformID=_;const T=this.transform.worldTransform,E=T.a,W=T.b,X=T.c,q=T.d,Y=T.tx,te=T.ty,ne=this._geometry.points,ae=this.vertexData;let le=0;for(let ue=0;ue<ne.length;ue+=2){const ge=ne[ue],ye=ne[ue+1];ae[le++]=E*ge+X*ye+Y,ae[le++]=q*ye+W*ge+te}}closePath(){const _=this.currentPath;return _&&(_.closeStroke=!0,this.finishPoly()),this}setMatrix(_){return this._matrix=_,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(_){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(_)}};_Graphics.curves=curves,_Graphics._TEMP_POINT=new Point;let Graphics=_Graphics;class MeshBatchUvs{constructor(_,T){this.uvBuffer=_,this.uvMatrix=T,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(_){if(!_&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const T=this.uvBuffer.data;(!this.data||this.data.length!==T.length)&&(this.data=new Float32Array(T.length)),this.uvMatrix.multiplyUvs(T,this.data),this._updateID++}}const tempPoint=new Point,tempPolygon=new Polygon,_Mesh=class dg extends Container{constructor(_,T,E,W=DRAW_MODES.TRIANGLES){super(),this.geometry=_,this.shader=T,this.state=E||State.for2d(),this.drawMode=W,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=settings.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(_){this._geometry!==_&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=_,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(_){this.shader=_}get material(){return this.shader}set blendMode(_){this.state.blendMode=_}get blendMode(){return this.state.blendMode}set roundPixels(_){this._roundPixels!==_&&(this._transformID=-1),this._roundPixels=_}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(_){this.shader.tint=_}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(_){this.shader.texture=_}_render(_){const T=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===DRAW_MODES.TRIANGLES&&T.length<dg.BATCHABLE_SIZE*2?this._renderToBatch(_):this._renderDefault(_)}_renderDefault(_){const T=this.shader;T.alpha=this.worldAlpha,T.update&&T.update(),_.batch.flush(),T.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),_.shader.bind(T),_.state.set(this.state),_.geometry.bind(this.geometry,T),_.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(_){const T=this.geometry,E=this.shader;E.uvMatrix&&(E.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=T.indexBuffer.data,this._tintRGB=E._tintRGB,this._texture=E.texture;const W=this.material.pluginName;_.batch.setObjectRenderer(_.plugins[W]),_.plugins[W].render(this)}calculateVertices(){const _=this.geometry.buffers[0],T=_.data,E=_._updateID;if(E===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==T.length&&(this.vertexData=new Float32Array(T.length));const W=this.transform.worldTransform,X=W.a,q=W.b,Y=W.c,te=W.d,ne=W.tx,ae=W.ty,le=this.vertexData;for(let ue=0;ue<le.length/2;ue++){const ge=T[ue*2],ye=T[ue*2+1];le[ue*2]=X*ge+Y*ye+ne,le[ue*2+1]=q*ge+te*ye+ae}if(this._roundPixels){const ue=settings.RESOLUTION;for(let ge=0;ge<le.length;++ge)le[ge]=Math.round(le[ge]*ue)/ue}this.vertexDirty=E}calculateUvs(){const _=this.geometry.buffers[1],T=this.shader;T.uvMatrix.isSimple?this.uvs=_.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(_,T.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(_){if(!this.getBounds().contains(_.x,_.y))return!1;this.worldTransform.applyInverse(_,tempPoint);const T=this.geometry.getBuffer("aVertexPosition").data,E=tempPolygon.points,W=this.geometry.getIndex().data,X=W.length,q=this.drawMode===4?3:1;for(let Y=0;Y+2<X;Y+=q){const te=W[Y]*2,ne=W[Y+1]*2,ae=W[Y+2]*2;if(E[0]=T[te],E[1]=T[te+1],E[2]=T[ne],E[3]=T[ne+1],E[4]=T[ae],E[5]=T[ae+1],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0}return!1}destroy(_){super.destroy(_),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};_Mesh.BATCHABLE_SIZE=100;let Mesh$1=_Mesh;class MeshGeometry extends Geometry{constructor(_,T,E){super();const W=new Buffer$1(_),X=new Buffer$1(T,!0),q=new Buffer$1(E,!0,!0);this.addAttribute("aVertexPosition",W,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",X,2,!1,TYPES.FLOAT).addIndex(q),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var fragment$k=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,vertex$k=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class MeshMaterial extends Shader{constructor(_,T){const E={uSampler:_,alpha:1,uTextureMatrix:Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};T=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},T),T.uniforms&&Object.assign(E,T.uniforms),super(T.program||Program.from(vertex$k,fragment$k),E),this._colorDirty=!1,this.uvMatrix=new TextureMatrix(_),this.batchable=T.program===void 0,this.pluginName=T.pluginName,this._tintColor=new Color$1(T.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=T.alpha}get texture(){return this.uniforms.uSampler}set texture(_){this.uniforms.uSampler!==_&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!_.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=_,this.uvMatrix.texture=_)}set alpha(_){_!==this._alpha&&(this._alpha=_,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(_){_!==this.tint&&(this._tintColor.setValue(_),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const _=this.texture.baseTexture.alphaMode;Color$1.shared.setValue(this._tintColor).premultiply(this._alpha,_).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class ParticleBuffer{constructor(_,T,E){this.geometry=new Geometry,this.indexBuffer=null,this.size=E,this.dynamicProperties=[],this.staticProperties=[];for(let W=0;W<_.length;++W){let X=_[W];X={attributeName:X.attributeName,size:X.size,uploadFunction:X.uploadFunction,type:X.type||TYPES.FLOAT,offset:X.offset},T[W]?this.dynamicProperties.push(X):this.staticProperties.push(X)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const _=this.geometry;let T=0;this.indexBuffer=new Buffer$1(createIndicesForQuads(this.size),!0,!0),_.addIndex(this.indexBuffer),this.dynamicStride=0;for(let q=0;q<this.dynamicProperties.length;++q){const Y=this.dynamicProperties[q];Y.offset=T,T+=Y.size,this.dynamicStride+=Y.size}const E=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(E),this.dynamicDataUint32=new Uint32Array(E),this.dynamicBuffer=new Buffer$1(this.dynamicData,!1,!1);let W=0;this.staticStride=0;for(let q=0;q<this.staticProperties.length;++q){const Y=this.staticProperties[q];Y.offset=W,W+=Y.size,this.staticStride+=Y.size}const X=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(X),this.staticDataUint32=new Uint32Array(X),this.staticBuffer=new Buffer$1(this.staticData,!0,!1);for(let q=0;q<this.dynamicProperties.length;++q){const Y=this.dynamicProperties[q];_.addAttribute(Y.attributeName,this.dynamicBuffer,0,Y.type===TYPES.UNSIGNED_BYTE,Y.type,this.dynamicStride*4,Y.offset*4)}for(let q=0;q<this.staticProperties.length;++q){const Y=this.staticProperties[q];_.addAttribute(Y.attributeName,this.staticBuffer,0,Y.type===TYPES.UNSIGNED_BYTE,Y.type,this.staticStride*4,Y.offset*4)}}uploadDynamic(_,T,E){for(let W=0;W<this.dynamicProperties.length;W++){const X=this.dynamicProperties[W];X.uploadFunction(_,T,E,X.type===TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,X.offset)}this.dynamicBuffer._updateID++}uploadStatic(_,T,E){for(let W=0;W<this.staticProperties.length;W++){const X=this.staticProperties[W];X.uploadFunction(_,T,E,X.type===TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,X.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var fragment$j=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,vertex$j=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class ParticleRenderer extends ObjectRenderer{constructor(_){super(_),this.shader=null,this.properties=null,this.tempMatrix=new Matrix,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Shader.from(vertex$j,fragment$j,{}),this.state=State.for2d()}render(_){const T=_.children,E=_._maxSize,W=_._batchSize,X=this.renderer;let q=T.length;if(q===0)return;q>E&&!_.autoResize&&(q=E);let Y=_._buffers;Y||(Y=_._buffers=this.generateBuffers(_));const te=T[0]._texture.baseTexture,ne=te.alphaMode>0;this.state.blendMode=correctBlendMode(_.blendMode,ne),X.state.set(this.state);const ae=X.gl,le=_.worldTransform.copyTo(this.tempMatrix);le.prepend(X.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=le.toArray(!0),this.shader.uniforms.uColor=Color$1.shared.setValue(_.tintRgb).premultiply(_.worldAlpha,ne).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=te,this.renderer.shader.bind(this.shader);let ue=!1;for(let ge=0,ye=0;ge<q;ge+=W,ye+=1){let xe=q-ge;xe>W&&(xe=W),ye>=Y.length&&Y.push(this._generateOneMoreBuffer(_));const Te=Y[ye];Te.uploadDynamic(T,ge,xe);const Ae=_._bufferUpdateIDs[ye]||0;ue=ue||Te._updateID<Ae,ue&&(Te._updateID=_._updateID,Te.uploadStatic(T,ge,xe)),X.geometry.bind(Te.geometry),ae.drawElements(ae.TRIANGLES,xe*6,ae.UNSIGNED_SHORT,0)}}generateBuffers(_){const T=[],E=_._maxSize,W=_._batchSize,X=_._properties;for(let q=0;q<E;q+=W)T.push(new ParticleBuffer(this.properties,X,W));return T}_generateOneMoreBuffer(_){const T=_._batchSize,E=_._properties;return new ParticleBuffer(this.properties,E,T)}uploadVertices(_,T,E,W,X,q){let Y=0,te=0,ne=0,ae=0;for(let le=0;le<E;++le){const ue=_[T+le],ge=ue._texture,ye=ue.scale.x,xe=ue.scale.y,Te=ge.trim,Ae=ge.orig;Te?(te=Te.x-ue.anchor.x*Ae.width,Y=te+Te.width,ae=Te.y-ue.anchor.y*Ae.height,ne=ae+Te.height):(Y=Ae.width*(1-ue.anchor.x),te=Ae.width*-ue.anchor.x,ne=Ae.height*(1-ue.anchor.y),ae=Ae.height*-ue.anchor.y),W[q]=te*ye,W[q+1]=ae*xe,W[q+X]=Y*ye,W[q+X+1]=ae*xe,W[q+X*2]=Y*ye,W[q+X*2+1]=ne*xe,W[q+X*3]=te*ye,W[q+X*3+1]=ne*xe,q+=X*4}}uploadPosition(_,T,E,W,X,q){for(let Y=0;Y<E;Y++){const te=_[T+Y].position;W[q]=te.x,W[q+1]=te.y,W[q+X]=te.x,W[q+X+1]=te.y,W[q+X*2]=te.x,W[q+X*2+1]=te.y,W[q+X*3]=te.x,W[q+X*3+1]=te.y,q+=X*4}}uploadRotation(_,T,E,W,X,q){for(let Y=0;Y<E;Y++){const te=_[T+Y].rotation;W[q]=te,W[q+X]=te,W[q+X*2]=te,W[q+X*3]=te,q+=X*4}}uploadUvs(_,T,E,W,X,q){for(let Y=0;Y<E;++Y){const te=_[T+Y]._texture._uvs;te?(W[q]=te.x0,W[q+1]=te.y0,W[q+X]=te.x1,W[q+X+1]=te.y1,W[q+X*2]=te.x2,W[q+X*2+1]=te.y2,W[q+X*3]=te.x3,W[q+X*3+1]=te.y3,q+=X*4):(W[q]=0,W[q+1]=0,W[q+X]=0,W[q+X+1]=0,W[q+X*2]=0,W[q+X*2+1]=0,W[q+X*3]=0,W[q+X*3+1]=0,q+=X*4)}}uploadTint(_,T,E,W,X,q){for(let Y=0;Y<E;++Y){const te=_[T+Y],ne=Color$1.shared.setValue(te._tintRGB).toPremultiplied(te.alpha,te.texture.baseTexture.alphaMode>0);W[q]=ne,W[q+X]=ne,W[q+X*2]=ne,W[q+X*3]=ne,q+=X*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ParticleRenderer.extension={name:"particle",type:ExtensionType.RendererPlugin};extensions$1.add(ParticleRenderer);var TEXT_GRADIENT=(B=>(B[B.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",B[B.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",B))(TEXT_GRADIENT||{});const contextSettings={willReadFrequently:!0},_TextMetrics=class ln{static get experimentalLetterSpacingSupported(){let _=ln._experimentalLetterSpacingSupported;if(_!==void 0){const T=settings.ADAPTER.getCanvasRenderingContext2D().prototype;_=ln._experimentalLetterSpacingSupported="letterSpacing"in T||"textLetterSpacing"in T}return _}constructor(_,T,E,W,X,q,Y,te,ne){this.text=_,this.style=T,this.width=E,this.height=W,this.lines=X,this.lineWidths=q,this.lineHeight=Y,this.maxLineWidth=te,this.fontProperties=ne}static measureText(_,T,E,W=ln._canvas){E=E??T.wordWrap;const X=T.toFontString(),q=ln.measureFont(X);q.fontSize===0&&(q.fontSize=T.fontSize,q.ascent=T.fontSize);const Y=W.getContext("2d",contextSettings);Y.font=X;const te=(E?ln.wordWrap(_,T,W):_).split(/(?:\r\n|\r|\n)/),ne=new Array(te.length);let ae=0;for(let ye=0;ye<te.length;ye++){const xe=ln._measureText(te[ye],T.letterSpacing,Y);ne[ye]=xe,ae=Math.max(ae,xe)}let le=ae+T.strokeThickness;T.dropShadow&&(le+=T.dropShadowDistance);const ue=T.lineHeight||q.fontSize+T.strokeThickness;let ge=Math.max(ue,q.fontSize+T.strokeThickness*2)+T.leading+(te.length-1)*(ue+T.leading);return T.dropShadow&&(ge+=T.dropShadowDistance),new ln(_,T,le,ge,te,ne,ue+T.leading,ae,q)}static _measureText(_,T,E){let W=!1;ln.experimentalLetterSpacingSupported&&(ln.experimentalLetterSpacing?(E.letterSpacing=`${T}px`,E.textLetterSpacing=`${T}px`,W=!0):(E.letterSpacing="0px",E.textLetterSpacing="0px"));let X=E.measureText(_).width;return X>0&&(W?X-=T:X+=(ln.graphemeSegmenter(_).length-1)*T),X}static wordWrap(_,T,E=ln._canvas){const W=E.getContext("2d",contextSettings);let X=0,q="",Y="";const te=Object.create(null),{letterSpacing:ne,whiteSpace:ae}=T,le=ln.collapseSpaces(ae),ue=ln.collapseNewlines(ae);let ge=!le;const ye=T.wordWrapWidth+ne,xe=ln.tokenize(_);for(let Te=0;Te<xe.length;Te++){let Ae=xe[Te];if(ln.isNewline(Ae)){if(!ue){Y+=ln.addLine(q),ge=!le,q="",X=0;continue}Ae=" "}if(le){const Ve=ln.isBreakingSpace(Ae),$e=ln.isBreakingSpace(q[q.length-1]);if(Ve&&$e)continue}const Ie=ln.getFromCache(Ae,ne,te,W);if(Ie>ye)if(q!==""&&(Y+=ln.addLine(q),q="",X=0),ln.canBreakWords(Ae,T.breakWords)){const Ve=ln.wordWrapSplit(Ae);for(let $e=0;$e<Ve.length;$e++){let We=Ve[$e],Ue=We,je=1;for(;Ve[$e+je];){const He=Ve[$e+je];if(!ln.canBreakChars(Ue,He,Ae,$e,T.breakWords))We+=He;else break;Ue=He,je++}$e+=je-1;const ze=ln.getFromCache(We,ne,te,W);ze+X>ye&&(Y+=ln.addLine(q),ge=!1,q="",X=0),q+=We,X+=ze}}else{q.length>0&&(Y+=ln.addLine(q),q="",X=0);const Ve=Te===xe.length-1;Y+=ln.addLine(Ae,!Ve),ge=!1,q="",X=0}else Ie+X>ye&&(ge=!1,Y+=ln.addLine(q),q="",X=0),(q.length>0||!ln.isBreakingSpace(Ae)||ge)&&(q+=Ae,X+=Ie)}return Y+=ln.addLine(q,!1),Y}static addLine(_,T=!0){return _=ln.trimRight(_),_=T?`${_}
`:_,_}static getFromCache(_,T,E,W){let X=E[_];return typeof X!="number"&&(X=ln._measureText(_,T,W)+T,E[_]=X),X}static collapseSpaces(_){return _==="normal"||_==="pre-line"}static collapseNewlines(_){return _==="normal"}static trimRight(_){if(typeof _!="string")return"";for(let T=_.length-1;T>=0;T--){const E=_[T];if(!ln.isBreakingSpace(E))break;_=_.slice(0,-1)}return _}static isNewline(_){return typeof _!="string"?!1:ln._newlines.includes(_.charCodeAt(0))}static isBreakingSpace(_,T){return typeof _!="string"?!1:ln._breakingSpaces.includes(_.charCodeAt(0))}static tokenize(_){const T=[];let E="";if(typeof _!="string")return T;for(let W=0;W<_.length;W++){const X=_[W],q=_[W+1];if(ln.isBreakingSpace(X,q)||ln.isNewline(X)){E!==""&&(T.push(E),E=""),T.push(X);continue}E+=X}return E!==""&&T.push(E),T}static canBreakWords(_,T){return T}static canBreakChars(_,T,E,W,X){return!0}static wordWrapSplit(_){return ln.graphemeSegmenter(_)}static measureFont(_){if(ln._fonts[_])return ln._fonts[_];const T={ascent:0,descent:0,fontSize:0},E=ln._canvas,W=ln._context;W.font=_;const X=ln.METRICS_STRING+ln.BASELINE_SYMBOL,q=Math.ceil(W.measureText(X).width);let Y=Math.ceil(W.measureText(ln.BASELINE_SYMBOL).width);const te=Math.ceil(ln.HEIGHT_MULTIPLIER*Y);if(Y=Y*ln.BASELINE_MULTIPLIER|0,q===0||te===0)return ln._fonts[_]=T,T;E.width=q,E.height=te,W.fillStyle="#f00",W.fillRect(0,0,q,te),W.font=_,W.textBaseline="alphabetic",W.fillStyle="#000",W.fillText(X,0,Y);const ne=W.getImageData(0,0,q,te).data,ae=ne.length,le=q*4;let ue=0,ge=0,ye=!1;for(ue=0;ue<Y;++ue){for(let xe=0;xe<le;xe+=4)if(ne[ge+xe]!==255){ye=!0;break}if(!ye)ge+=le;else break}for(T.ascent=Y-ue,ge=ae-le,ye=!1,ue=te;ue>Y;--ue){for(let xe=0;xe<le;xe+=4)if(ne[ge+xe]!==255){ye=!0;break}if(!ye)ge-=le;else break}return T.descent=ue-Y,T.fontSize=T.ascent+T.descent,ln._fonts[_]=T,T}static clearMetrics(_=""){_?delete ln._fonts[_]:ln._fonts={}}static get _canvas(){var _;if(!ln.__canvas){let T;try{const E=new OffscreenCanvas(0,0);if((_=E.getContext("2d",contextSettings))!=null&&_.measureText)return ln.__canvas=E,E;T=settings.ADAPTER.createCanvas()}catch{T=settings.ADAPTER.createCanvas()}T.width=T.height=10,ln.__canvas=T}return ln.__canvas}static get _context(){return ln.__context||(ln.__context=ln._canvas.getContext("2d",contextSettings)),ln.__context}};_TextMetrics.METRICS_STRING="|q",_TextMetrics.BASELINE_SYMBOL="M",_TextMetrics.BASELINE_MULTIPLIER=1.4,_TextMetrics.HEIGHT_MULTIPLIER=2,_TextMetrics.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const B=new Intl.Segmenter;return _=>[...B.segment(_)].map(T=>T.segment)}return B=>[...B]})(),_TextMetrics.experimentalLetterSpacing=!1,_TextMetrics._fonts={},_TextMetrics._newlines=[10,13],_TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let TextMetrics=_TextMetrics;const genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],_TextStyle=class jl{constructor(_){this.styleID=0,this.reset(),deepCopyProperties(this,_,_)}clone(){const _={};return deepCopyProperties(_,this,jl.defaultStyle),new jl(_)}reset(){deepCopyProperties(this,jl.defaultStyle,jl.defaultStyle)}get align(){return this._align}set align(_){this._align!==_&&(this._align=_,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(_){this._breakWords!==_&&(this._breakWords=_,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(_){this._dropShadow!==_&&(this._dropShadow=_,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(_){this._dropShadowAlpha!==_&&(this._dropShadowAlpha=_,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(_){this._dropShadowAngle!==_&&(this._dropShadowAngle=_,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(_){this._dropShadowBlur!==_&&(this._dropShadowBlur=_,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(_){const T=getColor(_);this._dropShadowColor!==T&&(this._dropShadowColor=T,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(_){this._dropShadowDistance!==_&&(this._dropShadowDistance=_,this.styleID++)}get fill(){return this._fill}set fill(_){const T=getColor(_);this._fill!==T&&(this._fill=T,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(_){this._fillGradientType!==_&&(this._fillGradientType=_,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(_){areArraysEqual(this._fillGradientStops,_)||(this._fillGradientStops=_,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(_){this.fontFamily!==_&&(this._fontFamily=_,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(_){this._fontSize!==_&&(this._fontSize=_,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(_){this._fontStyle!==_&&(this._fontStyle=_,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(_){this._fontVariant!==_&&(this._fontVariant=_,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(_){this._fontWeight!==_&&(this._fontWeight=_,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(_){this._letterSpacing!==_&&(this._letterSpacing=_,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(_){this._lineHeight!==_&&(this._lineHeight=_,this.styleID++)}get leading(){return this._leading}set leading(_){this._leading!==_&&(this._leading=_,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(_){this._lineJoin!==_&&(this._lineJoin=_,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(_){this._miterLimit!==_&&(this._miterLimit=_,this.styleID++)}get padding(){return this._padding}set padding(_){this._padding!==_&&(this._padding=_,this.styleID++)}get stroke(){return this._stroke}set stroke(_){const T=getColor(_);this._stroke!==T&&(this._stroke=T,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(_){this._strokeThickness!==_&&(this._strokeThickness=_,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(_){this._textBaseline!==_&&(this._textBaseline=_,this.styleID++)}get trim(){return this._trim}set trim(_){this._trim!==_&&(this._trim=_,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(_){this._whiteSpace!==_&&(this._whiteSpace=_,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(_){this._wordWrap!==_&&(this._wordWrap=_,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(_){this._wordWrapWidth!==_&&(this._wordWrapWidth=_,this.styleID++)}toFontString(){const _=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let T=this.fontFamily;Array.isArray(this.fontFamily)||(T=this.fontFamily.split(","));for(let E=T.length-1;E>=0;E--){let W=T[E].trim();!/([\"\'])[^\'\"]+\1/.test(W)&&!genericFontFamilies.includes(W)&&(W=`"${W}"`),T[E]=W}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${_} ${T.join(",")}`}};_TextStyle.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let TextStyle=_TextStyle;function getColor(B){const _=Color$1.shared,T=E=>{const W=_.setValue(E);return W.alpha===1?W.toHex():W.toRgbaString()};return Array.isArray(B)?B.map(T):T(B)}function areArraysEqual(B,_){if(!Array.isArray(B)||!Array.isArray(_)||B.length!==_.length)return!1;for(let T=0;T<B.length;++T)if(B[T]!==_[T])return!1;return!0}function deepCopyProperties(B,_,T){for(const E in T)Array.isArray(_[E])?B[E]=_[E].slice():B[E]=_[E]}const defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_Text=class Jh extends Sprite$1{constructor(_,T,E){let W=!1;E||(E=settings.ADAPTER.createCanvas(),W=!0),E.width=3,E.height=3;const X=Texture$1.from(E);X.orig=new Rectangle,X.trim=new Rectangle,super(X),this._ownCanvas=W,this.canvas=E,this.context=E.getContext("2d",{willReadFrequently:!0}),this._resolution=Jh.defaultResolution??settings.RESOLUTION,this._autoResolution=Jh.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=_,this.style=T,this.localStyleID=-1}static get experimentalLetterSpacing(){return TextMetrics.experimentalLetterSpacing}static set experimentalLetterSpacing(_){deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),TextMetrics.experimentalLetterSpacing=_}updateText(_){const T=this._style;if(this.localStyleID!==T.styleID&&(this.dirty=!0,this.localStyleID=T.styleID),!this.dirty&&_)return;this._font=this._style.toFontString();const E=this.context,W=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),X=W.width,q=W.height,Y=W.lines,te=W.lineHeight,ne=W.lineWidths,ae=W.maxLineWidth,le=W.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,X)+T.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,q)+T.padding*2)*this._resolution),E.scale(this._resolution,this._resolution),E.clearRect(0,0,this.canvas.width,this.canvas.height),E.font=this._font,E.lineWidth=T.strokeThickness,E.textBaseline=T.textBaseline,E.lineJoin=T.lineJoin,E.miterLimit=T.miterLimit;let ue,ge;const ye=T.dropShadow?2:1;for(let xe=0;xe<ye;++xe){const Te=T.dropShadow&&xe===0,Ae=Te?Math.ceil(Math.max(1,q)+T.padding*2):0,Ie=Ae*this._resolution;if(Te){E.fillStyle="black",E.strokeStyle="black";const $e=T.dropShadowColor,We=T.dropShadowBlur*this._resolution,Ue=T.dropShadowDistance*this._resolution;E.shadowColor=Color$1.shared.setValue($e).setAlpha(T.dropShadowAlpha).toRgbaString(),E.shadowBlur=We,E.shadowOffsetX=Math.cos(T.dropShadowAngle)*Ue,E.shadowOffsetY=Math.sin(T.dropShadowAngle)*Ue+Ie}else E.fillStyle=this._generateFillStyle(T,Y,W),E.strokeStyle=T.stroke,E.shadowColor="black",E.shadowBlur=0,E.shadowOffsetX=0,E.shadowOffsetY=0;let Ve=(te-le.fontSize)/2;te-le.fontSize<0&&(Ve=0);for(let $e=0;$e<Y.length;$e++)ue=T.strokeThickness/2,ge=T.strokeThickness/2+$e*te+le.ascent+Ve,T.align==="right"?ue+=ae-ne[$e]:T.align==="center"&&(ue+=(ae-ne[$e])/2),T.stroke&&T.strokeThickness&&this.drawLetterSpacing(Y[$e],ue+T.padding,ge+T.padding-Ae,!0),T.fill&&this.drawLetterSpacing(Y[$e],ue+T.padding,ge+T.padding-Ae)}this.updateTexture()}drawLetterSpacing(_,T,E,W=!1){const X=this._style.letterSpacing;let q=!1;if(TextMetrics.experimentalLetterSpacingSupported&&(TextMetrics.experimentalLetterSpacing?(this.context.letterSpacing=`${X}px`,this.context.textLetterSpacing=`${X}px`,q=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),X===0||q){W?this.context.strokeText(_,T,E):this.context.fillText(_,T,E);return}let Y=T;const te=TextMetrics.graphemeSegmenter(_);let ne=this.context.measureText(_).width,ae=0;for(let le=0;le<te.length;++le){const ue=te[le];W?this.context.strokeText(ue,Y,E):this.context.fillText(ue,Y,E);let ge="";for(let ye=le+1;ye<te.length;++ye)ge+=te[ye];ae=this.context.measureText(ge).width,Y+=ne-ae+X,ne=ae}}updateTexture(){const _=this.canvas;if(this._style.trim){const q=trimCanvas(_);q.data&&(_.width=q.width,_.height=q.height,this.context.putImageData(q.data,0,0))}const T=this._texture,E=this._style,W=E.trim?0:E.padding,X=T.baseTexture;T.trim.width=T._frame.width=_.width/this._resolution,T.trim.height=T._frame.height=_.height/this._resolution,T.trim.x=-W,T.trim.y=-W,T.orig.width=T._frame.width-W*2,T.orig.height=T._frame.height-W*2,this._onTextureUpdate(),X.setRealSize(_.width,_.height,this._resolution),T.updateUvs(),this.dirty=!1}_render(_){this._autoResolution&&this._resolution!==_.resolution&&(this._resolution=_.resolution,this.dirty=!0),this.updateText(!0),super._render(_)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(_,T){return this.updateText(!0),this._textureID===-1&&(_=!1),super.getBounds(_,T)}getLocalBounds(_){return this.updateText(!0),super.getLocalBounds.call(this,_)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(_,T,E){const W=_.fill;if(Array.isArray(W)){if(W.length===1)return W[0]}else return W;let X;const q=_.dropShadow?_.dropShadowDistance:0,Y=_.padding||0,te=this.canvas.width/this._resolution-q-Y*2,ne=this.canvas.height/this._resolution-q-Y*2,ae=W.slice(),le=_.fillGradientStops.slice();if(!le.length){const ue=ae.length+1;for(let ge=1;ge<ue;++ge)le.push(ge/ue)}if(ae.unshift(W[0]),le.unshift(0),ae.push(W[W.length-1]),le.push(1),_.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){X=this.context.createLinearGradient(te/2,Y,te/2,ne+Y);const ue=E.fontProperties.fontSize+_.strokeThickness;for(let ge=0;ge<T.length;ge++){const ye=E.lineHeight*(ge-1)+ue,xe=E.lineHeight*ge;let Te=xe;ge>0&&ye>xe&&(Te=(xe+ye)/2);const Ae=xe+ue,Ie=E.lineHeight*(ge+1);let Ve=Ae;ge+1<T.length&&Ie<Ae&&(Ve=(Ae+Ie)/2);const $e=(Ve-Te)/ne;for(let We=0;We<ae.length;We++){let Ue=0;typeof le[We]=="number"?Ue=le[We]:Ue=We/ae.length;let je=Math.min(1,Math.max(0,Te/ne+Ue*$e));je=Number(je.toFixed(5)),X.addColorStop(je,ae[We])}}}else{X=this.context.createLinearGradient(Y,ne/2,te+Y,ne/2);const ue=ae.length+1;let ge=1;for(let ye=0;ye<ae.length;ye++){let xe;typeof le[ye]=="number"?xe=le[ye]:xe=ge/ue,X.addColorStop(xe,ae[ye]),ge++}}return X}destroy(_){typeof _=="boolean"&&(_={children:_}),_=Object.assign({},defaultDestroyOptions,_),super.destroy(_),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(_){this.updateText(!0);const T=sign$1(this.scale.x)||1;this.scale.x=T*_/this._texture.orig.width,this._width=_}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(_){this.updateText(!0);const T=sign$1(this.scale.y)||1;this.scale.y=T*_/this._texture.orig.height,this._height=_}get style(){return this._style}set style(_){_=_||{},_ instanceof TextStyle?this._style=_:this._style=new TextStyle(_),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(_){_=String(_??""),this._text!==_&&(this._text=_,this.dirty=!0)}get resolution(){return this._resolution}set resolution(_){this._autoResolution=!1,this._resolution!==_&&(this._resolution=_,this.dirty=!0)}};_Text.defaultAutoResolution=!0;let Text$1=_Text;class CountLimiter{constructor(_){this.maxItemsPerFrame=_,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function findMultipleBaseTextures(B,_){var E;let T=!1;if((E=B==null?void 0:B._textures)!=null&&E.length){for(let W=0;W<B._textures.length;W++)if(B._textures[W]instanceof Texture$1){const X=B._textures[W].baseTexture;_.includes(X)||(_.push(X),T=!0)}}return T}function findBaseTexture(B,_){if(B.baseTexture instanceof BaseTexture){const T=B.baseTexture;return _.includes(T)||_.push(T),!0}return!1}function findTexture(B,_){if(B._texture&&B._texture instanceof Texture$1){const T=B._texture.baseTexture;return _.includes(T)||_.push(T),!0}return!1}function drawText(B,_){return _ instanceof Text$1?(_.updateText(!0),!0):!1}function calculateTextStyle(B,_){if(_ instanceof TextStyle){const T=_.toFontString();return TextMetrics.measureFont(T),!0}return!1}function findText(B,_){if(B instanceof Text$1){_.includes(B.style)||_.push(B.style),_.includes(B)||_.push(B);const T=B._texture.baseTexture;return _.includes(T)||_.push(T),!0}return!1}function findTextStyle(B,_){return B instanceof TextStyle?(_.includes(B)||_.push(B),!0):!1}const _BasePrepare=class pg{constructor(_){this.limiter=new CountLimiter(pg.uploadsPerFrame),this.renderer=_,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}upload(_){return new Promise(T=>{_&&this.add(_),this.queue.length?(this.completes.push(T),this.ticking||(this.ticking=!0,Ticker$1.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY))):T()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const _=this.queue[0];let T=!1;if(_&&!_._destroyed){for(let E=0,W=this.uploadHooks.length;E<W;E++)if(this.uploadHooks[E](this.uploadHookHelper,_)){this.queue.shift(),T=!0;break}}T||this.queue.shift()}if(this.queue.length)Ticker$1.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;const _=this.completes.slice(0);this.completes.length=0;for(let T=0,E=_.length;T<E;T++)_[T]()}}registerFindHook(_){return _&&this.addHooks.push(_),this}registerUploadHook(_){return _&&this.uploadHooks.push(_),this}add(_){for(let T=0,E=this.addHooks.length;T<E&&!this.addHooks[T](_,this.queue);T++);if(_ instanceof Container)for(let T=_.children.length-1;T>=0;T--)this.add(_.children[T]);return this}destroy(){this.ticking&&Ticker$1.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};_BasePrepare.uploadsPerFrame=4;let BasePrepare=_BasePrepare;Object.defineProperties(settings,{UPLOADS_PER_FRAME:{get(){return BasePrepare.uploadsPerFrame},set(B){deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),BasePrepare.uploadsPerFrame=B}}});function uploadBaseTextures(B,_){return _ instanceof BaseTexture?(_._glTextures[B.CONTEXT_UID]||B.texture.bind(_),!0):!1}function uploadGraphics(B,_){if(!(_ instanceof Graphics))return!1;const{geometry:T}=_;_.finishPoly(),T.updateBatches();const{batches:E}=T;for(let W=0;W<E.length;W++){const{texture:X}=E[W].style;X&&uploadBaseTextures(B,X.baseTexture)}return T.batchable||B.geometry.bind(T,_._resolveDirectShader(B)),!0}function findGraphics(B,_){return B instanceof Graphics?(_.push(B),!0):!1}class Prepare extends BasePrepare{constructor(_){super(_),this.uploadHookHelper=this.renderer,this.registerFindHook(findGraphics),this.registerUploadHook(uploadBaseTextures),this.registerUploadHook(uploadGraphics)}}Prepare.extension={name:"prepare",type:ExtensionType.RendererSystem};extensions$1.add(Prepare);var gl2FragmentSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,gl2VertexSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,gl1FragmentSrc=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,gl1VertexSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,fragmentSimpleSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const tempMat=new Matrix;class TilingSpriteRenderer extends ObjectRenderer{constructor(_){super(_),_.runners.contextChange.add(this),this.quad=new QuadUv,this.state=State.for2d()}contextChange(){const _=this.renderer,T={globals:_.globalUniforms};this.simpleShader=Shader.from(gl1VertexSrc,fragmentSimpleSrc,T),this.shader=_.context.webGLVersion>1?Shader.from(gl2VertexSrc,gl2FragmentSrc,T):Shader.from(gl1VertexSrc,gl1FragmentSrc,T)}render(_){const T=this.renderer,E=this.quad;let W=E.vertices;W[0]=W[6]=_._width*-_.anchor.x,W[1]=W[3]=_._height*-_.anchor.y,W[2]=W[4]=_._width*(1-_.anchor.x),W[5]=W[7]=_._height*(1-_.anchor.y);const X=_.uvRespectAnchor?_.anchor.x:0,q=_.uvRespectAnchor?_.anchor.y:0;W=E.uvs,W[0]=W[6]=-X,W[1]=W[3]=-q,W[2]=W[4]=1-X,W[5]=W[7]=1-q,E.invalidate();const Y=_._texture,te=Y.baseTexture,ne=te.alphaMode>0,ae=_.tileTransform.localTransform,le=_.uvMatrix;let ue=te.isPowerOfTwo&&Y.frame.width===te.width&&Y.frame.height===te.height;ue&&(te._glTextures[T.CONTEXT_UID]?ue=te.wrapMode!==WRAP_MODES.CLAMP:te.wrapMode===WRAP_MODES.CLAMP&&(te.wrapMode=WRAP_MODES.REPEAT));const ge=ue?this.simpleShader:this.shader,ye=Y.width,xe=Y.height,Te=_._width,Ae=_._height;tempMat.set(ae.a*ye/Te,ae.b*ye/Ae,ae.c*xe/Te,ae.d*xe/Ae,ae.tx/Te,ae.ty/Ae),tempMat.invert(),ue?tempMat.prepend(le.mapCoord):(ge.uniforms.uMapCoord=le.mapCoord.toArray(!0),ge.uniforms.uClampFrame=le.uClampFrame,ge.uniforms.uClampOffset=le.uClampOffset),ge.uniforms.uTransform=tempMat.toArray(!0),ge.uniforms.uColor=Color$1.shared.setValue(_.tint).premultiply(_.worldAlpha,ne).toArray(ge.uniforms.uColor),ge.uniforms.translationMatrix=_.transform.worldTransform.toArray(!0),ge.uniforms.uSampler=Y,T.shader.bind(ge),T.geometry.bind(E),this.state.blendMode=correctBlendMode(_.blendMode,ne),T.state.set(this.state),T.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}TilingSpriteRenderer.extension={name:"tilingSprite",type:ExtensionType.RendererPlugin};extensions$1.add(TilingSpriteRenderer);const _Spritesheet=class Hl{constructor(_,T,E){this.linkedSheets=[],(_ instanceof BaseTexture||_ instanceof Texture$1)&&(_={texture:_,data:T,resolutionFilename:E});const{texture:W,data:X,resolutionFilename:q=null,cachePrefix:Y=""}=_;this.cachePrefix=Y,this._texture=W instanceof Texture$1?W:null,this.baseTexture=W instanceof BaseTexture?W:this._texture.baseTexture,this.textures={},this.animations={},this.data=X;const te=this.baseTexture.resource;this.resolution=this._updateResolution(q||(te?te.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(_=null){const{scale:T}=this.data.meta;let E=getResolutionOfUrl(_,null);return E===null&&(E=typeof T=="number"?T:parseFloat(T??"1")),E!==1&&this.baseTexture.setResolution(E),E}parse(){return new Promise(_=>{this._callback=_,this._batchIndex=0,this._frameKeys.length<=Hl.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(_){let T=_;const E=Hl.BATCH_SIZE;for(;T-_<E&&T<this._frameKeys.length;){const W=this._frameKeys[T],X=this._frames[W],q=X.frame;if(q){let Y=null,te=null;const ne=X.trimmed!==!1&&X.sourceSize?X.sourceSize:X.frame,ae=new Rectangle(0,0,Math.floor(ne.w)/this.resolution,Math.floor(ne.h)/this.resolution);X.rotated?Y=new Rectangle(Math.floor(q.x)/this.resolution,Math.floor(q.y)/this.resolution,Math.floor(q.h)/this.resolution,Math.floor(q.w)/this.resolution):Y=new Rectangle(Math.floor(q.x)/this.resolution,Math.floor(q.y)/this.resolution,Math.floor(q.w)/this.resolution,Math.floor(q.h)/this.resolution),X.trimmed!==!1&&X.spriteSourceSize&&(te=new Rectangle(Math.floor(X.spriteSourceSize.x)/this.resolution,Math.floor(X.spriteSourceSize.y)/this.resolution,Math.floor(q.w)/this.resolution,Math.floor(q.h)/this.resolution)),this.textures[W]=new Texture$1(this.baseTexture,Y,ae,te,X.rotated?2:0,X.anchor,X.borders),Texture$1.addToCache(this.textures[W],this.cachePrefix+W.toString())}T++}}_processAnimations(){const _=this.data.animations||{};for(const T in _){this.animations[T]=[];for(let E=0;E<_[T].length;E++){const W=_[T][E];this.animations[T].push(this.textures[W])}}}_parseComplete(){const _=this._callback;this._callback=null,this._batchIndex=0,_.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Hl.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Hl.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(_=!1){var T;for(const E in this.textures)this.textures[E].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,_&&((T=this._texture)==null||T.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};_Spritesheet.BATCH_SIZE=1e3;let Spritesheet=_Spritesheet;const validImages=["jpg","png","jpeg","avif","webp","s3tc","s3tc_sRGB","etc","etc1","pvrtc","atc","astc","bptc"];function getCacheableAssets(B,_,T){const E={};if(B.forEach(W=>{E[W]=_}),Object.keys(_.textures).forEach(W=>{E[`${_.cachePrefix}${W}`]=_.textures[W]}),!T){const W=path.dirname(B[0]);_.linkedSheets.forEach((X,q)=>{Object.assign(E,getCacheableAssets([`${W}/${_.data.meta.related_multi_packs[q]}`],X,!0))})}return E}const spritesheetAsset={extension:ExtensionType.Asset,cache:{test:B=>B instanceof Spritesheet,getCacheableAssets:(B,_)=>getCacheableAssets(B,_,!1)},resolver:{test:B=>{const _=B.split("?")[0].split("."),T=_.pop(),E=_.pop();return T==="json"&&validImages.includes(E)},parse:B=>{var T;const _=B.split(".");return{resolution:parseFloat(((T=settings.RETINA_PREFIX.exec(B))==null?void 0:T[1])??"1"),format:_[_.length-2],src:B}}},loader:{name:"spritesheetLoader",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},async testParse(B,_){return path.extname(_.src).toLowerCase()===".json"&&!!B.frames},async parse(B,_,T){var ae,le;const{texture:E,imageFilename:W,cachePrefix:X}=(_==null?void 0:_.data)??{};let q=path.dirname(_.src);q&&q.lastIndexOf("/")!==q.length-1&&(q+="/");let Y;if(E&&E.baseTexture)Y=E;else{const ue=copySearchParams(q+(W??B.meta.image),_.src);Y=(await T.load([ue]))[ue]}const te=new Spritesheet({texture:Y.baseTexture,data:B,resolutionFilename:_.src,cachePrefix:X});await te.parse();const ne=(ae=B==null?void 0:B.meta)==null?void 0:ae.related_multi_packs;if(Array.isArray(ne)){const ue=[];for(const ye of ne){if(typeof ye!="string")continue;let xe=q+ye;(le=_.data)!=null&&le.ignoreMultiPack||(xe=copySearchParams(xe,_.src),ue.push(T.load({src:xe,data:{ignoreMultiPack:!0}})))}const ge=await Promise.all(ue);te.linkedSheets=ge,ge.forEach(ye=>{ye.linkedSheets=[te].concat(te.linkedSheets.filter(xe=>xe!==ye))})}return te},unload(B){B.destroy(!0)}}};extensions$1.add(spritesheetAsset);class BitmapFontData{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class TextFormat{static test(_){return typeof _=="string"&&_.startsWith("info face=")}static parse(_){const T=_.match(/^[a-z]+\s+.+$/gm),E={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const X in T){const q=T[X].match(/^[a-z]+/gm)[0],Y=T[X].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),te={};for(const ne in Y){const ae=Y[ne].split("="),le=ae[0],ue=ae[1].replace(/"/gm,""),ge=parseFloat(ue),ye=isNaN(ge)?ue:ge;te[le]=ye}E[q].push(te)}const W=new BitmapFontData;return E.info.forEach(X=>W.info.push({face:X.face,size:parseInt(X.size,10)})),E.common.forEach(X=>W.common.push({lineHeight:parseInt(X.lineHeight,10)})),E.page.forEach(X=>W.page.push({id:parseInt(X.id,10),file:X.file})),E.char.forEach(X=>W.char.push({id:parseInt(X.id,10),page:parseInt(X.page,10),x:parseInt(X.x,10),y:parseInt(X.y,10),width:parseInt(X.width,10),height:parseInt(X.height,10),xoffset:parseInt(X.xoffset,10),yoffset:parseInt(X.yoffset,10),xadvance:parseInt(X.xadvance,10)})),E.kerning.forEach(X=>W.kerning.push({first:parseInt(X.first,10),second:parseInt(X.second,10),amount:parseInt(X.amount,10)})),E.distanceField.forEach(X=>W.distanceField.push({distanceRange:parseInt(X.distanceRange,10),fieldType:X.fieldType})),W}}class XMLFormat{static test(_){const T=_;return typeof _!="string"&&"getElementsByTagName"in _&&T.getElementsByTagName("page").length&&T.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(_){const T=new BitmapFontData,E=_.getElementsByTagName("info"),W=_.getElementsByTagName("common"),X=_.getElementsByTagName("page"),q=_.getElementsByTagName("char"),Y=_.getElementsByTagName("kerning"),te=_.getElementsByTagName("distanceField");for(let ne=0;ne<E.length;ne++)T.info.push({face:E[ne].getAttribute("face"),size:parseInt(E[ne].getAttribute("size"),10)});for(let ne=0;ne<W.length;ne++)T.common.push({lineHeight:parseInt(W[ne].getAttribute("lineHeight"),10)});for(let ne=0;ne<X.length;ne++)T.page.push({id:parseInt(X[ne].getAttribute("id"),10)||0,file:X[ne].getAttribute("file")});for(let ne=0;ne<q.length;ne++){const ae=q[ne];T.char.push({id:parseInt(ae.getAttribute("id"),10),page:parseInt(ae.getAttribute("page"),10)||0,x:parseInt(ae.getAttribute("x"),10),y:parseInt(ae.getAttribute("y"),10),width:parseInt(ae.getAttribute("width"),10),height:parseInt(ae.getAttribute("height"),10),xoffset:parseInt(ae.getAttribute("xoffset"),10),yoffset:parseInt(ae.getAttribute("yoffset"),10),xadvance:parseInt(ae.getAttribute("xadvance"),10)})}for(let ne=0;ne<Y.length;ne++)T.kerning.push({first:parseInt(Y[ne].getAttribute("first"),10),second:parseInt(Y[ne].getAttribute("second"),10),amount:parseInt(Y[ne].getAttribute("amount"),10)});for(let ne=0;ne<te.length;ne++)T.distanceField.push({fieldType:te[ne].getAttribute("fieldType"),distanceRange:parseInt(te[ne].getAttribute("distanceRange"),10)});return T}}class XMLStringFormat{static test(_){return typeof _=="string"&&_.includes("<font>")?XMLFormat.test(settings.ADAPTER.parseXML(_)):!1}static parse(_){return XMLFormat.parse(settings.ADAPTER.parseXML(_))}}const formats=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(B){for(let _=0;_<formats.length;_++)if(formats[_].test(B))return formats[_];return null}function generateFillStyle(B,_,T,E,W,X){const q=T.fill;if(Array.isArray(q)){if(q.length===1)return q[0]}else return q;let Y;const te=T.dropShadow?T.dropShadowDistance:0,ne=T.padding||0,ae=B.width/E-te-ne*2,le=B.height/E-te-ne*2,ue=q.slice(),ge=T.fillGradientStops.slice();if(!ge.length){const ye=ue.length+1;for(let xe=1;xe<ye;++xe)ge.push(xe/ye)}if(ue.unshift(q[0]),ge.unshift(0),ue.push(q[q.length-1]),ge.push(1),T.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){Y=_.createLinearGradient(ae/2,ne,ae/2,le+ne);let ye=0;const xe=(X.fontProperties.fontSize+T.strokeThickness)/le;for(let Te=0;Te<W.length;Te++){const Ae=X.lineHeight*Te;for(let Ie=0;Ie<ue.length;Ie++){let Ve=0;typeof ge[Ie]=="number"?Ve=ge[Ie]:Ve=Ie/ue.length;const $e=Ae/le+Ve*xe;let We=Math.max(ye,$e);We=Math.min(We,1),Y.addColorStop(We,ue[Ie]),ye=We}}}else{Y=_.createLinearGradient(ne,le/2,ae+ne,le/2);const ye=ue.length+1;let xe=1;for(let Te=0;Te<ue.length;Te++){let Ae;typeof ge[Te]=="number"?Ae=ge[Te]:Ae=xe/ye,Y.addColorStop(Ae,ue[Te]),xe++}}return Y}function drawGlyph(B,_,T,E,W,X,q){const Y=T.text,te=T.fontProperties;_.translate(E,W),_.scale(X,X);const ne=q.strokeThickness/2,ae=-(q.strokeThickness/2);if(_.font=q.toFontString(),_.lineWidth=q.strokeThickness,_.textBaseline=q.textBaseline,_.lineJoin=q.lineJoin,_.miterLimit=q.miterLimit,_.fillStyle=generateFillStyle(B,_,q,X,[Y],T),_.strokeStyle=q.stroke,q.dropShadow){const le=q.dropShadowColor,ue=q.dropShadowBlur*X,ge=q.dropShadowDistance*X;_.shadowColor=Color$1.shared.setValue(le).setAlpha(q.dropShadowAlpha).toRgbaString(),_.shadowBlur=ue,_.shadowOffsetX=Math.cos(q.dropShadowAngle)*ge,_.shadowOffsetY=Math.sin(q.dropShadowAngle)*ge}else _.shadowColor="black",_.shadowBlur=0,_.shadowOffsetX=0,_.shadowOffsetY=0;q.stroke&&q.strokeThickness&&_.strokeText(Y,ne,ae+T.lineHeight-te.descent),q.fill&&_.fillText(Y,ne,ae+T.lineHeight-te.descent),_.setTransform(1,0,0,1,0,0),_.fillStyle="rgba(0, 0, 0, 0)"}function extractCharCode(B){return B.codePointAt?B.codePointAt(0):B.charCodeAt(0)}function splitTextToCharacters(B){return Array.from?Array.from(B):B.split("")}function resolveCharacters(B){typeof B=="string"&&(B=[B]);const _=[];for(let T=0,E=B.length;T<E;T++){const W=B[T];if(Array.isArray(W)){if(W.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${W.length}.`);const X=W[0].charCodeAt(0),q=W[1].charCodeAt(0);if(q<X)throw new Error("[BitmapFont]: Invalid character range.");for(let Y=X,te=q;Y<=te;Y++)_.push(String.fromCharCode(Y))}else _.push(...splitTextToCharacters(W))}if(_.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return _}const _BitmapFont=class Co{constructor(_,T,E){var ae;const[W]=_.info,[X]=_.common,[q]=_.page,[Y]=_.distanceField,te=getResolutionOfUrl(q.file),ne={};this._ownsTextures=E,this.font=W.face,this.size=W.size,this.lineHeight=X.lineHeight/te,this.chars={},this.pageTextures=ne;for(let le=0;le<_.page.length;le++){const{id:ue,file:ge}=_.page[le];ne[ue]=T instanceof Array?T[le]:T[ge],Y!=null&&Y.fieldType&&Y.fieldType!=="none"&&(ne[ue].baseTexture.alphaMode=ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,ne[ue].baseTexture.mipmap=MIPMAP_MODES.OFF)}for(let le=0;le<_.char.length;le++){const{id:ue,page:ge}=_.char[le];let{x:ye,y:xe,width:Te,height:Ae,xoffset:Ie,yoffset:Ve,xadvance:$e}=_.char[le];ye/=te,xe/=te,Te/=te,Ae/=te,Ie/=te,Ve/=te,$e/=te;const We=new Rectangle(ye+ne[ge].frame.x/te,xe+ne[ge].frame.y/te,Te,Ae);this.chars[ue]={xOffset:Ie,yOffset:Ve,xAdvance:$e,kerning:{},texture:new Texture$1(ne[ge].baseTexture,We),page:ge}}for(let le=0;le<_.kerning.length;le++){let{first:ue,second:ge,amount:ye}=_.kerning[le];ue/=te,ge/=te,ye/=te,this.chars[ge]&&(this.chars[ge].kerning[ue]=ye)}this.distanceFieldRange=Y==null?void 0:Y.distanceRange,this.distanceFieldType=((ae=Y==null?void 0:Y.fieldType)==null?void 0:ae.toLowerCase())??"none"}destroy(){for(const _ in this.chars)this.chars[_].texture.destroy(),this.chars[_].texture=null;for(const _ in this.pageTextures)this._ownsTextures&&this.pageTextures[_].destroy(!0),this.pageTextures[_]=null;this.chars=null,this.pageTextures=null}static install(_,T,E){let W;if(_ instanceof BitmapFontData)W=_;else{const q=autoDetectFormat(_);if(!q)throw new Error("Unrecognized data format for font.");W=q.parse(_)}T instanceof Texture$1&&(T=[T]);const X=new Co(W,T,E);return Co.available[X.font]=X,X}static uninstall(_){const T=Co.available[_];if(!T)throw new Error(`No font found named '${_}'`);T.destroy(),delete Co.available[_]}static from(_,T,E){if(!_)throw new Error("[BitmapFont] Property `name` is required.");const{chars:W,padding:X,resolution:q,textureWidth:Y,textureHeight:te,...ne}=Object.assign({},Co.defaultOptions,E),ae=resolveCharacters(W),le=T instanceof TextStyle?T:new TextStyle(T),ue=Y,ge=new BitmapFontData;ge.info[0]={face:le.fontFamily,size:le.fontSize},ge.common[0]={lineHeight:le.fontSize};let ye=0,xe=0,Te,Ae,Ie,Ve=0;const $e=[];for(let Ue=0;Ue<ae.length;Ue++){Te||(Te=settings.ADAPTER.createCanvas(),Te.width=Y,Te.height=te,Ae=Te.getContext("2d"),Ie=new BaseTexture(Te,{resolution:q,...ne}),$e.push(new Texture$1(Ie)),ge.page.push({id:$e.length-1,file:""}));const je=ae[Ue],ze=TextMetrics.measureText(je,le,!1,Te),He=ze.width,Le=Math.ceil(ze.height),qe=Math.ceil((le.fontStyle==="italic"?2:1)*He);if(xe>=te-Le*q){if(xe===0)throw new Error(`[BitmapFont] textureHeight ${te}px is too small (fontFamily: '${le.fontFamily}', fontSize: ${le.fontSize}px, char: '${je}')`);--Ue,Te=null,Ae=null,Ie=null,xe=0,ye=0,Ve=0;continue}if(Ve=Math.max(Le+ze.fontProperties.descent,Ve),qe*q+ye>=ue){if(ye===0)throw new Error(`[BitmapFont] textureWidth ${Y}px is too small (fontFamily: '${le.fontFamily}', fontSize: ${le.fontSize}px, char: '${je}')`);--Ue,xe+=Ve*q,xe=Math.ceil(xe),ye=0,Ve=0;continue}drawGlyph(Te,Ae,ze,ye,xe,q,le);const Qe=extractCharCode(ze.text);ge.char.push({id:Qe,page:$e.length-1,x:ye/q,y:xe/q,width:qe,height:Le,xoffset:0,yoffset:0,xadvance:He-(le.dropShadow?le.dropShadowDistance:0)-(le.stroke?le.strokeThickness:0)}),ye+=(qe+2*X)*q,ye=Math.ceil(ye)}if(!(E!=null&&E.skipKerning))for(let Ue=0,je=ae.length;Ue<je;Ue++){const ze=ae[Ue];for(let He=0;He<je;He++){const Le=ae[He],qe=Ae.measureText(ze).width,Qe=Ae.measureText(Le).width,Ke=Ae.measureText(ze+Le).width-(qe+Qe);Ke&&ge.kerning.push({first:extractCharCode(ze),second:extractCharCode(Le),amount:Ke})}}const We=new Co(ge,$e,!0);return Co.available[_]!==void 0&&Co.uninstall(_),Co.available[_]=We,We}};_BitmapFont.ALPHA=[["a","z"],["A","Z"]," "],_BitmapFont.NUMERIC=[["0","9"]],_BitmapFont.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],_BitmapFont.ASCII=[[" ","~"]],_BitmapFont.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_BitmapFont.ALPHANUMERIC},_BitmapFont.available={};let BitmapFont=_BitmapFont;var msdfFrag=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,msdfVert=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const pageMeshDataDefaultPageMeshData=[],pageMeshDataMSDFPageMeshData=[],charRenderDataPool=[],_BitmapText=class fg extends Container{constructor(_,T={}){super();const{align:E,tint:W,maxWidth:X,letterSpacing:q,fontName:Y,fontSize:te}=Object.assign({},fg.styleDefaults,T);if(!BitmapFont.available[Y])throw new Error(`Missing BitmapFont "${Y}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=E,this._tintColor=new Color$1(W),this._font=void 0,this._fontName=Y,this._fontSize=te,this.text=_,this._maxWidth=X,this._maxLineHeight=0,this._letterSpacing=q,this._anchor=new ObservablePoint(()=>{this.dirty=!0},this,0,0),this._roundPixels=settings.ROUND_PIXELS,this.dirty=!0,this._resolution=settings.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var qe;const _=BitmapFont.available[this._fontName],T=this.fontSize,E=T/_.size,W=new Point,X=[],q=[],Y=[],te=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",ne=splitTextToCharacters(te),ae=this._maxWidth*_.size/T,le=_.distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;let ue=null,ge=0,ye=0,xe=0,Te=-1,Ae=0,Ie=0,Ve=0,$e=0;for(let Qe=0;Qe<ne.length;Qe++){const Ke=ne[Qe],Je=extractCharCode(Ke);if(/(?:\s)/.test(Ke)&&(Te=Qe,Ae=ge,$e++),Ke==="\r"||Ke===`
`){q.push(ge),Y.push(-1),ye=Math.max(ye,ge),++xe,++Ie,W.x=0,W.y+=_.lineHeight,ue=null,$e=0;continue}const pt=_.chars[Je];if(!pt)continue;ue&&pt.kerning[ue]&&(W.x+=pt.kerning[ue]);const ut=charRenderDataPool.pop()||{texture:Texture$1.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Point};ut.texture=pt.texture,ut.line=xe,ut.charCode=Je,ut.position.x=Math.round(W.x+pt.xOffset+this._letterSpacing/2),ut.position.y=Math.round(W.y+pt.yOffset),ut.prevSpaces=$e,X.push(ut),ge=ut.position.x+Math.max(pt.xAdvance-pt.xOffset,pt.texture.orig.width),W.x+=pt.xAdvance+this._letterSpacing,Ve=Math.max(Ve,pt.yOffset+pt.texture.height),ue=Je,Te!==-1&&ae>0&&W.x>ae&&(++Ie,removeItems(X,1+Te-Ie,1+Qe-Te),Qe=Te,Te=-1,q.push(Ae),Y.push(X.length>0?X[X.length-1].prevSpaces:0),ye=Math.max(ye,Ae),xe++,W.x=0,W.y+=_.lineHeight,ue=null,$e=0)}const We=ne[ne.length-1];We!=="\r"&&We!==`
`&&(/(?:\s)/.test(We)&&(ge=Ae),q.push(ge),ye=Math.max(ye,ge),Y.push(-1));const Ue=[];for(let Qe=0;Qe<=xe;Qe++){let Ke=0;this._align==="right"?Ke=ye-q[Qe]:this._align==="center"?Ke=(ye-q[Qe])/2:this._align==="justify"&&(Ke=Y[Qe]<0?0:(ye-q[Qe])/Y[Qe]),Ue.push(Ke)}const je=X.length,ze={},He=[],Le=this._activePagesMeshData;le.push(...Le);for(let Qe=0;Qe<je;Qe++){const Ke=X[Qe].texture,Je=Ke.baseTexture.uid;if(!ze[Je]){let pt=le.pop();if(!pt){const lt=new MeshGeometry;let st,sr;_.distanceFieldType==="none"?(st=new MeshMaterial(Texture$1.EMPTY),sr=BLEND_MODES.NORMAL):(st=new MeshMaterial(Texture$1.EMPTY,{program:Program.from(msdfVert,msdfFrag),uniforms:{uFWidth:0}}),sr=BLEND_MODES.NORMAL_NPM);const mt=new Mesh$1(lt,st);mt.blendMode=sr,pt={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:mt,vertices:null,uvs:null,indices:null}}pt.index=0,pt.indexCount=0,pt.vertexCount=0,pt.uvsCount=0,pt.total=0;const{_textureCache:ut}=this;ut[Je]=ut[Je]||new Texture$1(Ke.baseTexture),pt.mesh.texture=ut[Je],pt.mesh.tint=this._tintColor.value,He.push(pt),ze[Je]=pt}ze[Je].total++}for(let Qe=0;Qe<Le.length;Qe++)He.includes(Le[Qe])||this.removeChild(Le[Qe].mesh);for(let Qe=0;Qe<He.length;Qe++)He[Qe].mesh.parent!==this&&this.addChild(He[Qe].mesh);this._activePagesMeshData=He;for(const Qe in ze){const Ke=ze[Qe],Je=Ke.total;if(!(((qe=Ke.indices)==null?void 0:qe.length)>6*Je)||Ke.vertices.length<Mesh$1.BATCHABLE_SIZE*2)Ke.vertices=new Float32Array(4*2*Je),Ke.uvs=new Float32Array(4*2*Je),Ke.indices=new Uint16Array(6*Je);else{const pt=Ke.total,ut=Ke.vertices;for(let lt=pt*4*2;lt<ut.length;lt++)ut[lt]=0}Ke.mesh.size=6*Je}for(let Qe=0;Qe<je;Qe++){const Ke=X[Qe];let Je=Ke.position.x+Ue[Ke.line]*(this._align==="justify"?Ke.prevSpaces:1);this._roundPixels&&(Je=Math.round(Je));const pt=Je*E,ut=Ke.position.y*E,lt=Ke.texture,st=ze[lt.baseTexture.uid],sr=lt.frame,mt=lt._uvs,Tr=st.index++;st.indices[Tr*6+0]=0+Tr*4,st.indices[Tr*6+1]=1+Tr*4,st.indices[Tr*6+2]=2+Tr*4,st.indices[Tr*6+3]=0+Tr*4,st.indices[Tr*6+4]=2+Tr*4,st.indices[Tr*6+5]=3+Tr*4,st.vertices[Tr*8+0]=pt,st.vertices[Tr*8+1]=ut,st.vertices[Tr*8+2]=pt+sr.width*E,st.vertices[Tr*8+3]=ut,st.vertices[Tr*8+4]=pt+sr.width*E,st.vertices[Tr*8+5]=ut+sr.height*E,st.vertices[Tr*8+6]=pt,st.vertices[Tr*8+7]=ut+sr.height*E,st.uvs[Tr*8+0]=mt.x0,st.uvs[Tr*8+1]=mt.y0,st.uvs[Tr*8+2]=mt.x1,st.uvs[Tr*8+3]=mt.y1,st.uvs[Tr*8+4]=mt.x2,st.uvs[Tr*8+5]=mt.y2,st.uvs[Tr*8+6]=mt.x3,st.uvs[Tr*8+7]=mt.y3}this._textWidth=ye*E,this._textHeight=(W.y+_.lineHeight)*E;for(const Qe in ze){const Ke=ze[Qe];if(this.anchor.x!==0||this.anchor.y!==0){let lt=0;const st=this._textWidth*this.anchor.x,sr=this._textHeight*this.anchor.y;for(let mt=0;mt<Ke.total;mt++)Ke.vertices[lt++]-=st,Ke.vertices[lt++]-=sr,Ke.vertices[lt++]-=st,Ke.vertices[lt++]-=sr,Ke.vertices[lt++]-=st,Ke.vertices[lt++]-=sr,Ke.vertices[lt++]-=st,Ke.vertices[lt++]-=sr}this._maxLineHeight=Ve*E;const Je=Ke.mesh.geometry.getBuffer("aVertexPosition"),pt=Ke.mesh.geometry.getBuffer("aTextureCoord"),ut=Ke.mesh.geometry.getIndex();Je.data=Ke.vertices,pt.data=Ke.uvs,ut.data=Ke.indices,Je.update(),pt.update(),ut.update()}for(let Qe=0;Qe<X.length;Qe++)charRenderDataPool.push(X[Qe]);this._font=_,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(_){this._autoResolution&&this._resolution!==_.resolution&&(this._resolution=_.resolution,this.dirty=!0);const{distanceFieldRange:T,distanceFieldType:E,size:W}=BitmapFont.available[this._fontName];if(E!=="none"){const{a:X,b:q,c:Y,d:te}=this.worldTransform,ne=Math.sqrt(X*X+q*q),ae=Math.sqrt(Y*Y+te*te),le=(Math.abs(ne)+Math.abs(ae))/2,ue=this.fontSize/W,ge=_._view.resolution;for(const ye of this._activePagesMeshData)ye.mesh.shader.uniforms.uFWidth=le*T*ue*ge}super._render(_)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const _=BitmapFont.available[this._fontName];if(!_)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==_&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(_){if(this.tint!==_){this._tintColor.setValue(_);for(let T=0;T<this._activePagesMeshData.length;T++)this._activePagesMeshData[T].mesh.tint=_}}get align(){return this._align}set align(_){this._align!==_&&(this._align=_,this.dirty=!0)}get fontName(){return this._fontName}set fontName(_){if(!BitmapFont.available[_])throw new Error(`Missing BitmapFont "${_}"`);this._fontName!==_&&(this._fontName=_,this.dirty=!0)}get fontSize(){return this._fontSize??BitmapFont.available[this._fontName].size}set fontSize(_){this._fontSize!==_&&(this._fontSize=_,this.dirty=!0)}get anchor(){return this._anchor}set anchor(_){typeof _=="number"?this._anchor.set(_):this._anchor.copyFrom(_)}get text(){return this._text}set text(_){_=String(_??""),this._text!==_&&(this._text=_,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(_){this._maxWidth!==_&&(this._maxWidth=_,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(_){this._letterSpacing!==_&&(this._letterSpacing=_,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(_){_!==this._roundPixels&&(this._roundPixels=_,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(_){this._autoResolution=!1,this._resolution!==_&&(this._resolution=_,this.dirty=!0)}destroy(_){const{_textureCache:T}=this,E=BitmapFont.available[this._fontName].distanceFieldType==="none"?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;E.push(...this._activePagesMeshData);for(const W of this._activePagesMeshData)this.removeChild(W.mesh);this._activePagesMeshData=[],E.filter(W=>T[W.mesh.texture.baseTexture.uid]).forEach(W=>{W.mesh.texture=Texture$1.EMPTY});for(const W in T)T[W].destroy(),delete T[W];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(_)}};_BitmapText.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const validExtensions=[".xml",".fnt"],loadBitmapFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},name:"loadBitmapFont",test(B){return validExtensions.includes(path.extname(B).toLowerCase())},async testParse(B){return TextFormat.test(B)||XMLStringFormat.test(B)},async parse(B,_,T){const E=TextFormat.test(B)?TextFormat.parse(B):XMLStringFormat.parse(B),{src:W}=_,{page:X}=E,q=[];for(let ne=0;ne<X.length;++ne){const ae=X[ne].file;let le=path.join(path.dirname(W),ae);le=copySearchParams(le,W),q.push(le)}const Y=await T.load(q),te=q.map(ne=>Y[ne]);return BitmapFont.install(E,te,!0)},async load(B,_){return(await settings.ADAPTER.fetch(B)).text()},unload(B){B.destroy()}};extensions$1.add(loadBitmapFont);const _HTMLTextStyle=class Ka extends TextStyle{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(_){return new Ka(Object.keys(Ka.defaultOptions).reduce((T,E)=>({...T,[E]:_[E]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(_=>{URL.revokeObjectURL(_.src),_.refs--,_.refs===0&&(_.fontFace&&document.fonts.delete(_.fontFace),delete Ka.availableFonts[_.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(_,T={}){const{availableFonts:E}=Ka;if(E[_]){const W=E[_];return this._fonts.push(W),W.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return settings.ADAPTER.fetch(_).then(W=>W.blob()).then(async W=>new Promise((X,q)=>{const Y=URL.createObjectURL(W),te=new FileReader;te.onload=()=>X([Y,te.result]),te.onerror=q,te.readAsDataURL(W)})).then(async([W,X])=>{const q=Object.assign({family:path.basename(_,path.extname(_)),weight:"normal",style:"normal",display:"auto",src:W,dataSrc:X,refs:1,originalUrl:_,fontFace:null},T);E[_]=q,this._fonts.push(q),this.styleID++;const Y=new FontFace(q.family,`url(${q.src})`,{weight:q.weight,style:q.style,display:q.display});q.fontFace=Y,await Y.load(),document.fonts.add(Y),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(..._){const T=_.filter(E=>!this._overrides.includes(E));T.length>0&&(this._overrides.push(...T),this.styleID++)}removeOverride(..._){const T=_.filter(E=>this._overrides.includes(E));T.length>0&&(this._overrides=this._overrides.filter(E=>!T.includes(E)),this.styleID++)}toCSS(_){return[`transform: scale(${_})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((_,T)=>`${_}
            @font-face {
                font-family: "${T.family}";
                src: url('${T.dataSrc}');
                font-weight: ${T.weight};
                font-style: ${T.style};
                font-display: ${T.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(_){this._stylesheet!==_&&(this._stylesheet=_,this.styleID++)}normalizeColor(_){return Array.isArray(_)&&(_=rgb2hex(_)),typeof _=="number"?hex2string(_):_}dropShadowToCSS(){let _=this.normalizeColor(this.dropShadowColor);const T=this.dropShadowAlpha,E=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),W=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);_.startsWith("#")&&T<1&&(_+=(T*255|0).toString(16).padStart(2,"0"));const X=`${E}px ${W}px`;return this.dropShadowBlur>0?`text-shadow: ${X} ${this.dropShadowBlur}px ${_}`:`text-shadow: ${X} ${_}`}reset(){Object.assign(this,Ka.defaultOptions)}onBeforeDraw(){const{fontsDirty:_}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&_?new Promise(T=>setTimeout(T,100)):Promise.resolve()}get isSafari(){const{userAgent:_}=settings.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(_)}set fillGradientStops(_){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(_){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(_){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(_){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(_){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(_){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(_){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};_HTMLTextStyle.availableFonts={},_HTMLTextStyle.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let HTMLTextStyle=_HTMLTextStyle;const _HTMLText=class Za extends Sprite$1{constructor(_="",T={}){super(Texture$1.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const E=new Image,W=Texture$1.from(E,{scaleMode:settings.SCALE_MODE,resourceOptions:{autoLoad:!1}});W.orig=new Rectangle,W.trim=new Rectangle,this.texture=W;const X="http://www.w3.org/2000/svg",q="http://www.w3.org/1999/xhtml",Y=document.createElementNS(X,"svg"),te=document.createElementNS(X,"foreignObject"),ne=document.createElementNS(q,"div"),ae=document.createElementNS(q,"style");te.setAttribute("width","10000"),te.setAttribute("height","10000"),te.style.overflow="hidden",Y.appendChild(te),this.maxWidth=Za.defaultMaxWidth,this.maxHeight=Za.defaultMaxHeight,this._domElement=ne,this._styleElement=ae,this._svgRoot=Y,this._foreignObject=te,this._foreignObject.appendChild(ae),this._foreignObject.appendChild(ne),this._image=E,this._loadImage=new Image,this._autoResolution=Za.defaultAutoResolution,this._resolution=Za.defaultResolution??settings.RESOLUTION,this.text=_,this.style=T}measureText(_){var ae,le;const{text:T,style:E,resolution:W}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},_);Object.assign(this._domElement,{innerHTML:T,style:E.toCSS(W)}),this._styleElement.textContent=E.toGlobalCSS(),document.body.appendChild(this._svgRoot);const X=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:q,height:Y}=X;(q>this.maxWidth||Y>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const te=Math.min(this.maxWidth,Math.ceil(q)),ne=Math.min(this.maxHeight,Math.ceil(Y));return this._svgRoot.setAttribute("width",te.toString()),this._svgRoot.setAttribute("height",ne.toString()),T!==this._text&&(this._domElement.innerHTML=this._text),E!==this._style&&(Object.assign(this._domElement,{style:(ae=this._style)==null?void 0:ae.toCSS(W)}),this._styleElement.textContent=(le=this._style)==null?void 0:le.toGlobalCSS()),{width:te+E.padding*2,height:ne+E.padding*2}}async updateText(_=!0){const{style:T,_image:E,_loadImage:W}=this;if(this.localStyleID!==T.styleID&&(this.dirty=!0,this.localStyleID=T.styleID),!this.dirty&&_)return;const{width:X,height:q}=this.measureText();E.width=W.width=Math.ceil(Math.max(1,X)),E.height=W.height=Math.ceil(Math.max(1,q)),this._updateID++;const Y=this._updateID;await new Promise(te=>{W.onload=async()=>{if(Y<this._updateID){te();return}await T.onBeforeDraw(),E.src=W.src,W.onload=null,W.src="",this.updateTexture(),te()};const ne=new XMLSerializer().serializeToString(this._svgRoot);W.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(ne)}`})}get source(){return this._image}updateTexture(){const{style:_,texture:T,_image:E,resolution:W}=this,{padding:X}=_,{baseTexture:q}=T;T.trim.width=T._frame.width=E.width/W,T.trim.height=T._frame.height=E.height/W,T.trim.x=-X,T.trim.y=-X,T.orig.width=T._frame.width-X*2,T.orig.height=T._frame.height-X*2,this._onTextureUpdate(),q.setRealSize(E.width,E.height,W),this.dirty=!1}_render(_){this._autoResolution&&this._resolution!==_.resolution&&(this._resolution=_.resolution,this.dirty=!0),this.updateText(!0),super._render(_)}_renderCanvas(_){this._autoResolution&&this._resolution!==_.resolution&&(this._resolution=_.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(_)}getLocalBounds(_){return this.updateText(!0),super.getLocalBounds(_)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(_){var E,W,X,q,Y;typeof _=="boolean"&&(_={children:_}),_=Object.assign({},Za.defaultDestroyOptions,_),super.destroy(_);const T=null;this.ownsStyle&&((E=this._style)==null||E.cleanFonts()),this._style=T,(W=this._svgRoot)==null||W.remove(),this._svgRoot=T,(X=this._domElement)==null||X.remove(),this._domElement=T,(q=this._foreignObject)==null||q.remove(),this._foreignObject=T,(Y=this._styleElement)==null||Y.remove(),this._styleElement=T,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=T,this._image.src="",this._image=T}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(_){this.updateText(!0);const T=sign$1(this.scale.x)||1;this.scale.x=T*_/this._image.width/this.resolution,this._width=_}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(_){this.updateText(!0);const T=sign$1(this.scale.y)||1;this.scale.y=T*_/this._image.height/this.resolution,this._height=_}get style(){return this._style}set style(_){this._style!==_&&(_=_||{},_ instanceof HTMLTextStyle?(this.ownsStyle=!1,this._style=_):_ instanceof TextStyle?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=HTMLTextStyle.from(_)):(this.ownsStyle=!0,this._style=new HTMLTextStyle(_)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(_){_=String(_===""||_===null||_===void 0?" ":_),_=this.sanitiseText(_),this._text!==_&&(this._text=_,this.dirty=!0)}get resolution(){return this._resolution}set resolution(_){this._autoResolution=!1,this._resolution!==_&&(this._resolution=_,this.dirty=!0)}sanitiseText(_){return _.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};_HTMLText.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_HTMLText.defaultMaxWidth=2024,_HTMLText.defaultMaxHeight=2024,_HTMLText.defaultAutoResolution=!0;const _hoisted_1$f={key:0,class:"loader-container"},_hoisted_2$8={class:"loader-content"},_hoisted_3$6={key:0,class:"current-file"},_hoisted_4$4={class:"progress-bar"},_hoisted_5$2={class:"progress-text"},_sfc_main$f={__name:"PixiLoader",props:{textureUrls:{type:Array,required:!0}},emits:["loaded","progress"],setup(B,{expose:_,emit:T}){const E=B,W=T,X=ref$1(!0),q=ref$1(0),Y=ref$1(0),te=ref$1(0),ne=ref$1(""),ae=ref$1({}),le=async()=>{if(!E.textureUrls||E.textureUrls.length===0){X.value=!1,W("loaded",{});return}te.value=E.textureUrls.length,Y.value=0,q.value=0,ne.value="";for(let ue=0;ue<E.textureUrls.length;ue++){const ge=E.textureUrls[ue],ye=ge.split("/").pop();ne.value=ye;try{const xe=await new Promise((Te,Ae)=>{const Ie=Texture$1.from(ge);if(Ie.baseTexture.valid){Te(Ie);return}Ie.baseTexture.on("loaded",()=>{Te(Ie)}),Ie.baseTexture.on("error",Ve=>{console.error(`: ${ge}`,Ve),Ae(Ve)})});ae.value[ge]=xe,Y.value++,q.value=Math.round(Y.value/te.value*100),W("progress",{loaded:Y.value,total:te.value,progress:q.value,currentUrl:ge,currentFileName:ye})}catch(xe){console.error(`: ${ge}`,xe),ne.value=`: ${ye}`;return}}ne.value="",X.value=!1,W("loaded",ae.value)};return watch(()=>E.textureUrls,ue=>{ue&&ue.length>0&&(X.value=!0,ae.value={},le())},{immediate:!0}),_({textures:ae,isLoading:X,progress:q,currentFileName:ne,reload:le}),(ue,ge)=>X.value?(openBlock(),createElementBlock("div",_hoisted_1$f,[createBaseVNode("div",_hoisted_2$8,[ne.value?(openBlock(),createElementBlock("div",_hoisted_3$6,toDisplayString(ne.value),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_4$4,[createBaseVNode("div",{class:"progress-fill",style:normalizeStyle({width:q.value+"%"})},null,4)]),createBaseVNode("div",_hoisted_5$2,toDisplayString(Y.value)+"/"+toDisplayString(te.value),1)])])):createCommentVNode("",!0)}},PixiLoader=_export_sfc(_sfc_main$f,[["__scopeId","data-v-c476f797"]]),ya=class ya{constructor(){this.pixi=null,this.textures={},this.ticker=null,this.logic=null,this.ui=null,this.uiContainer=null,this.playerData=null}static get instance(){return ya._instance||(ya._instance=new ya),ya._instance}setUI(_){let T=this.ui;T&&T.removeFromParent(),this.ui=_,this.uiContainer.addChild(this.ui),T&&this.makeUIAppear(this.ui)}get winW(){return this.pixi.screen.width}get winH(){return this.pixi.screen.height}makeUIAppear(_,T){if(!_)return;_.x=this.winW/2,_.visible=!0;const E=Date.now(),W=.5,X=this.winW/2,q=0,Y=()=>{const te=(Date.now()-E)/1e3,ne=Math.min(te/W,1),ae=this.easeOutCubic(ne);_.x=X+(q-X)*ae,ne<1?requestAnimationFrame(Y):(T&&T(),_.onAppearFinish&&_.onAppearFinish())};requestAnimationFrame(Y)}makeUIDisappear(_,T){if(!_)return;const E=Date.now(),W=.5,X=0,q=-this.winW/2,Y=()=>{const te=(Date.now()-E)/1e3,ne=Math.min(te/W,1),ae=this.easeInCubic(ne);_.x=X+(q-X)*ae,ne<1?requestAnimationFrame(Y):T&&T()};requestAnimationFrame(Y)}easeOutCubic(_){return 1-Math.pow(1-_,3)}easeInCubic(_){return _*_*_}};Gn(ya,"_instance");let TankApp=ya;function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function initDom(B,_={}){const T=window.innerWidth,E=window.innerHeight,W=_.isFullScreen||isMobile();let X=0,q=0;if(W){const te=T/E,ne=_.designWidth/_.designHeight;te>ne?(q=_.designHeight,X=q*te):(X=_.designWidth,q=X/te)}else X=_.designWidth,q=_.designHeight;let Y=Math.min(T/X,E/q);Y*=_.scale||1,B.style.width=X+"px",B.style.height=q+"px",B.style.transform=`scale(${Y})`,B.style.transformOrigin="center",console.log("initDom",X,q,B.clientWidth,B.clientHeight,B.style.transform,B.style.transformOrigin)}function createPixi(B,_={}){let E={...{width:B.clientWidth,height:B.clientHeight,antialias:!1,autoDensity:!1,view:B},..._};return new Application(E)}class TankPlayerData{constructor(){this.resetPlayerData(),this.resetOneLevelData()}resetPlayerData(){this.levelId=0,this.playerLives=3}resetOneLevelData(){this.enermyDestroyed=[],this.levelEndType=0,this.levelStartTime=Date.now()}addEnemyDestroyed(_,T){this.enermyDestroyed[_]||(this.enermyDestroyed[_]=0),this.enermyDestroyed[_]+=T}calculateLevelTime(){const _=Date.now();return Math.floor((_-this.levelStartTime)/1e3)}getFormattedLevelTime(){const _=this.calculateLevelTime(),T=Math.floor(_/60),E=_%60;return`${T.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`}}class Ticker{constructor(){this._entries=[],this._ticker=new Ticker$1,this._ticker.start(),this._onTick=this._onTick.bind(this),this._ticker.add(this._onTick,this)}_onTick(){const _=this._ticker.deltaMS/1e3;if(this._entries.length===0)return;const T=new Set;for(const E of this._entries){if(E.interval<=0){try{E.cb(_)}catch(W){console.error("Ticker tick error:",W)}E.once&&T.add(E.id);continue}for(E.acc+=_;E.acc>=E.interval;){E.acc-=E.interval;try{E.cb(E.interval)}catch(W){console.error("Ticker tick error:",W)}if(E.once){T.add(E.id);break}}}if(T.size)for(const E of T)this._removeById(E)}_genId(){return`${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`}_removeById(_){const T=this._entries.findIndex(W=>W.id===_);if(T===-1)return!1;const E=this._entries[T];if(E&&E.target&&typeof E.target.off=="function"&&E._onRemoved)try{E.target.off("removed",E._onRemoved)}catch{}return this._entries.splice(T,1),!0}_bindAutoRemove(_){const T=_.target;if(!T||typeof T.on!="function")return;const E=()=>this.removeTick(_.id);_._onRemoved=E;try{T.on("removed",E)}catch{}}tick(_,T=0,E=null){const W=this._genId(),X={id:W,cb:_,interval:Number(T)||0,acc:0,once:!1,target:E};return this._entries.push(X),E&&this._bindAutoRemove(X),W}tickOnce(_,T=0,E=null){const W=this._genId(),X={id:W,cb:_,interval:Number(T)||0,acc:0,once:!0,target:E};return this._entries.push(X),E&&this._bindAutoRemove(X),W}removeTick(_){if(typeof _=="string"){this._removeById(_);return}typeof _=="function"&&(this._entries=this._entries.filter(T=>T.cb!==_))}stop(){this._entries=[],this._ticker.stop()}}new Ticker;const gAnimDef={tankAppear:{pattern:"born_",frameCount:6,totalCount:1,frameRate:8},tankExplode:{pattern:"explode_",frameCount:3,totalCount:1,frameRate:8}};class SpriteSeqAnim extends Container{constructor(_={}){super();const{imgNamePattern:T="born_",frameCount:E=1,frameRate:W=8,basePath:X="tank2",totalCount:q=1,onComplete:Y=null}=_;this.imgNamePattern=T,this.frameCount=E,this.basePath=X,this.totalCount=q,this.playedRounds=0,this.currentFrame=0,this.isPlaying=!1,this.frameRate=W,this.frameTime=1/this.frameRate,this.accumulator=0,this.onComplete=Y,this.sprites=[],this.createSprites(),this.visible=!1,this.tankApp=TankApp.instance,this._tickId=null,this._onTick=te=>this.update(te)}createSprites(){for(let _=1;_<=this.frameCount;_++){const T=Texture$1.from(`${this.basePath}/${this.imgNamePattern}${_}.png`),E=Sprite$1.from(T);E.anchor.set(.5),E.visible=!1,this.sprites.push(E),this.addChild(E)}}play(){this.isPlaying=!0,this.currentFrame=0,this.accumulator=0,this.playedRounds=0,this.visible=!0,this.updateFrame(),this.tankApp&&this.tankApp.ticker&&!this._tickId&&(this._tickId=this.tankApp.ticker.tick(this._onTick,0,this))}stop(){this.isPlaying=!1,this.visible=!1,this.hideAllSprites(),this.tankApp&&this.tankApp.ticker&&this._tickId&&(this.tankApp.ticker.removeTick(this._tickId),this._tickId=null),this.removeFromParent()}update(_){if(!this.isPlaying)return;this.accumulator+=_;let T=!1;for(;this.accumulator>=this.frameTime;)if(this.accumulator-=this.frameTime,this.currentFrame++,T=!0,this.currentFrame>=this.frameCount&&(this.currentFrame=0,this.playedRounds++,this.playedRounds>=this.totalCount)){this.stop(),typeof this.onComplete=="function"&&this.onComplete();return}T&&this.updateFrame()}updateFrame(){this.hideAllSprites(),this.currentFrame<this.sprites.length&&(this.sprites[this.currentFrame].visible=!0)}hideAllSprites(){this.sprites.forEach(_=>{_.visible=!1})}setOnComplete(_){this.onComplete=_}}function createSpriteSeqAnim(B,_){const T=gAnimDef[B]||{},E=new SpriteSeqAnim({imgNamePattern:T.pattern??"born_",frameCount:T.frameCount??1,frameRate:T.frameRate??8,totalCount:T.totalCount??1,basePath:T.basePath??"tank2",onComplete:_||null});return E.play(),E}const TileType={EMPTY:0,BRICK:1,IRON:2,GRASS:3,WATER:4},Dir={UP:0,RIGHT:1,DOWN:2,LEFT:3},TileSize=32,MapRows=26,MapCols=26,MapWidth=MapCols*TileSize,MapHeight=MapRows*TileSize,TankType={PLAYER:0,ENEMY_1:1,ENEMY_2:2,ENEMY_3:3,ENEMY_4:4},TankConfig={[TankType.PLAYER]:{speed:100,health:1,power:1},[TankType.ENEMY_1]:{speed:80,health:1,power:1},[TankType.ENEMY_2]:{speed:100,health:2,power:1},[TankType.ENEMY_3]:{speed:120,health:3,power:1},[TankType.ENEMY_4]:{speed:100,health:4,power:2}};function moveByDir(B,_,T){switch(_){case Dir.UP:B.y-=T;break;case Dir.DOWN:B.y+=T;break;case Dir.LEFT:B.x-=T;break;case Dir.RIGHT:B.x+=T;break}}const BulletType={PLAYER:"player",ENEMY:"enemy"};class Bullet extends Container{constructor(_){super(),this.tankApp=TankApp.instance,this.owner=_,this.bulletType=_.tankType===TankType.PLAYER?BulletType.PLAYER:BulletType.ENEMY,this.direction=_.direction,this.power=1,this.speed=400,this.size=20,this.x=this.owner.x,this.y=this.owner.y,this.createSprite(),this.tankApp.ui.addBullet(this),this.owner&&this.owner.onBulletAdded&&this.owner.onBulletAdded(this)}getPower(){return this.power}setPower(_){this.power=_}getBlood(){return this.blood}setBlood(_){this.blood=_,this.blood<=0&&this.makeDead()}createSprite(){const _=new Graphics;this.bulletType===BulletType.PLAYER?_.beginFill(65280):_.beginFill(16711680),_.drawRect(-this.size/2,-this.size/2,this.size,this.size),_.endFill(),this.sprite=_,this.addChild(this.sprite);const T=this.direction*90*Math.PI/180;this.sprite.rotation=T}update(_){moveByDir(this,this.direction,this.speed*_),this.tankApp.ui.isInBounds(this.x,this.y)||this.makeDead()}makeDead(){this.isDead=!0,this.visible=!1,this.owner&&this.owner.onBulletDestroyed&&this.owner.onBulletDestroyed(),this.tankApp.ui.onBulletDeadFinish(this)}getBounds(){const _=this.size*1;return{x:this.x,y:this.y,width:_,height:_}}}class TankBase extends Container{constructor(_){super(),this.tankApp=TankApp.instance,this.textures=this.tankApp.textures,this.tankType=_,this.direction=Dir.UP,this.size=64,this.isMoving=!1,this.isShooting=!1,this.shootOnce=!1,this.invincibleTime=0,this.animationTimer=0,this.currentFrame=0,this.animationSpeed=.15,this.shootTimer=0,this.shootCooldown=.15,this.maxBullets=1,this.currentBullets=0,this.initByTankType(_)}initByTankType(_){this.tankType=_;const T=TankConfig[_]||TankConfig[TankType.PLAYER];this.speed=T.speed,this.health=T.health,this.power=T.power,this.initSprites()}initSprites(){this.tankSprites=[];let _;this.tankType===TankType.PLAYER?_="tank2/player1_run_":_=`tank2/enermys/enermy_${this.tankType}_run_`;for(let T=1;T<=2;T++){const E=Sprite$1.from(this.textures[`${_}${T}.png`]);E.anchor.set(.5),E.visible=!1,this.tankSprites.push(E),this.addChild(E)}}appear(){this.setInvincible();const _=createSpriteSeqAnim("tankAppear",()=>{this.onAppearFinish()});this.addChild(_)}onAppearFinish(){this.setInvincible(!1),this.enterNextFrame()}isInvincible(){return this.invincibleTime>0}setInvincible(_=3){this.invincibleTime=_}setDirection(_){this.direction=_,this.tankSprites.forEach(T=>T.rotation=_*(Math.PI/2))}setMoving(_){this.isMoving=_}setShooting(_){this.isShooting=_}setShootOnce(){this.shootOnce=!0}shoot(){return new Bullet(this)}onBulletAdded(_){this.currentBullets++}onBulletDestroyed(){this.currentBullets>0&&this.currentBullets--}checkCorrectPath(){const _=TileSize/2,T=Math.round(this.x/_)*_,E=Math.round(this.y/_)*_;this.x=T,this.y=E}checkMoving(_){const T=this.tankApp.ui.map;if(this.isMoving){let E=T.getMovableDistance(this.getBounds(),this.direction);E<=0&&(this.checkCorrectPath(),E=T.getMovableDistance(this.getBounds(),this.direction));let W=this.tankApp.ui.getMovableDistance(this.getBounds(),this.direction,this);E=Math.min(E,W);let X=this.speed*_,q=Math.min(E,X);q>0&&moveByDir(this,this.direction,q)}this.isMoving&&(this.animationTimer+=_,this.animationTimer>=this.animationSpeed&&(this.animationTimer=0,this.enterNextFrame()))}checkShooting(_){this.shootTimer>0&&(this.shootTimer-=_),!(this.shootTimer>0)&&(this.currentBullets>=this.maxBullets||(this.isShooting||this.shootOnce)&&(this.shootOnce=!1,this.shootTimer=this.shootCooldown,this.shoot()))}checkInvincible(_){this.invincibleTime>0?(this.invincibleTime-=_,this.alpha=Math.sin(Date.now()*.01)>0?1:.5):this.alpha=1}takeDamage(_){this.invincibleTime>0||(this.health-=_,this.health<=0&&this.makeDead())}makeDead(){this.isDead=!0,this.visible=!1,this.tankApp.ui.addEffect("tankExplode",this.x,this.y,this.onDeadFinish.bind(this))}onDeadFinish(){this.tankApp.ui.onTankDeadFinish(this)}update(_){this.isDead||(this.checkMoving(_),this.checkShooting(_),this.checkInvincible(_))}setCurrentFrame(_){this.tankSprites.forEach((T,E)=>{T.visible=E===_}),this.currentFrame=_}enterNextFrame(){this.setCurrentFrame((this.currentFrame+1)%this.tankSprites.length)}getBounds(){return{x:this.x,y:this.y,width:this.size,height:this.size}}}class TankHome extends Container{constructor(){super(),this.tankApp=TankApp.instance,this.textures=this.tankApp.textures,this.isDead=!1,this.size=TileSize*2,this.createSprite()}createSprite(){this.sprite=Sprite$1.from("tank2/bigtile_6.png"),this.sprite.width=this.size,this.sprite.height=this.size,this.sprite.anchor.set(.5,.5),this.addChild(this.sprite)}takeDamage(_){this.isDead||(this.isDead=!0,this.changeToDestroyedSprite(),this.addExplodeEffect())}changeToDestroyedSprite(){this.sprite.texture=Texture$1.from("tank2/bigtile_7.png")}addExplodeEffect(){const _=createSpriteSeqAnim("tankExplode",()=>{this.tankApp.ui.onHomeDeadFinish(this)});_.x=0,_.y=0,this.addChild(_)}getBounds(){return{x:this.x-this.size/2,y:this.y-this.size/2,width:this.size,height:this.size}}checkCollision(_,T){const E=this.getBounds();return _>=E.x&&_<=E.x+E.width&&T>=E.y&&T<=E.y+E.height}}class TankCompInput{constructor(_){this.gameUI=_,this.keys={},this.moveKeys=[],this._onKeyDown=null,this._onKeyUp=null,this.setupInput()}setupInput(){this._onKeyDown||(this._onKeyDown=_=>{this.keys[_.code]=!0,this.keyDown(_.code)}),this._onKeyUp||(this._onKeyUp=_=>{this.keys[_.code]=!1,this.keyUp(_.code)}),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),console.log("TankCompInput.setupInput")}keyDown(_){const T=this.gameUI.player;if(T)switch(_){case"ArrowUp":case"KeyW":case"ArrowRight":case"KeyD":case"ArrowDown":case"KeyS":case"ArrowLeft":case"KeyA":this.addMoveKey(_);break;case"Space":T.setShooting(!0);break}}keyUp(_){const T=this.gameUI.player;if(T)switch(_){case"ArrowUp":case"KeyW":case"ArrowRight":case"KeyD":case"ArrowDown":case"KeyS":case"ArrowLeft":case"KeyA":this.removeMoveKey(_);break;case"Space":T.setShooting(!1);break}}addMoveKey(_){this.moveKeys.includes(_)||(this.moveKeys.push(_),this.checkMovePlayer())}removeMoveKey(_){let T=this.moveKeys.indexOf(_);T!==-1&&(this.moveKeys.splice(T,1),this.checkMovePlayer())}checkMovePlayer(){const _=this.gameUI.player,T=this.moveKeys[this.moveKeys.length-1];T?T==="ArrowUp"||T==="KeyW"?(_.setDirection(0),_.setMoving(!0)):T==="ArrowRight"||T==="KeyD"?(_.setDirection(1),_.setMoving(!0)):T==="ArrowDown"||T==="KeyS"?(_.setDirection(2),_.setMoving(!0)):(T==="ArrowLeft"||T==="KeyA")&&(_.setDirection(3),_.setMoving(!0)):_.setMoving(!1)}makeDead(){this._onKeyDown&&(window.removeEventListener("keydown",this._onKeyDown),this._onKeyDown=null),this._onKeyUp&&(window.removeEventListener("keyup",this._onKeyUp),this._onKeyUp=null),console.log("TankCompInput.makeDead")}}class TankTile extends Container{constructor(_,T,E){super(),this.row=_,this.col=T,this.type=E,this.tankApp=TankApp.instance,this.tileSize=32,this.blood=2,this.createSprite(),this.setPosition()}getBlood(){return this.blood}setBlood(_){this.blood=_,this.blood==1&&(this.sprite.alpha=.5)}createSprite(){switch(this.type){case TileType.BRICK:this.sprite=Sprite$1.from("tank2/bigtile_1_tile_1.png");break;case TileType.IRON:this.sprite=Sprite$1.from("tank2/bigtile_2_tile_1.png");break;case TileType.GRASS:this.sprite=Sprite$1.from("tank2/bigtile_3_tile_1.png");break;case TileType.WATER:this.sprite=Sprite$1.from("tank2/bigtile_3_tile_1.png");break;default:this.sprite=new Graphics,this.sprite.beginFill(8421504),this.sprite.drawRect(0,0,this.tileSize,this.tileSize),this.sprite.endFill()}this.sprite.width=this.tileSize,this.sprite.height=this.tileSize,this.addChild(this.sprite)}setPosition(){this.x=this.col*this.tileSize,this.y=this.row*this.tileSize}setType(_){this.type=_,this.removeChild(this.sprite),this.createSprite(),this.setPosition()}getType(){return this.type}makeDead(){this.parent&&this.parent.removeChild(this)}}const allLevels=[{id:1,name:"",map:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,2,2,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,2,2,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0],totalEnemies:20,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.4,type2:.3,type3:.2,type4:.1},itemDropRates:{life:.1,stop:.15,iron:.1,bomb:.05,star:.1,shield:.1}},{id:2,name:"",map:[0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,2,2,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,2,2,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,2,2,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,1,2,2,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,3,3,0,0,0,0,1,1,0,0,0,0,2,2,0,0,0,0,1,1,3,3,1,1,2,2,3,3,0,0,0,0,1,1,0,0,0,0,2,2,0,0,0,0,1,1,3,3,1,1,2,2,3,3,3,3,0,0,0,0,0,0,1,1,0,0,0,0,2,2,0,0,3,3,0,0,0,0,3,3,3,3,0,0,0,0,0,0,1,1,0,0,0,0,2,2,0,0,3,3,0,0,0,0,0,0,1,1,1,1,1,1,3,3,3,3,3,3,2,2,0,0,0,0,3,3,1,1,0,0,0,0,1,1,1,1,1,1,3,3,3,3,3,3,2,2,0,0,0,0,3,3,1,1,0,0,0,0,0,0,0,0,2,2,3,3,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,2,2,3,3,1,1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,2,2,1,1,0,0,2,2,0,0,1,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,2,2,1,1,0,0,2,2,0,0,1,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,1,1,0,0,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,0,0,1,1,0,0,0,1,0,0,1,0,0,0,1,1,1,1,1,1,0,0],totalEnemies:25,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.35,type2:.35,type3:.2,type4:.1},itemDropRates:{life:.12,stop:.12,iron:.12,bomb:.08,star:.12,shield:.12}},{id:3,name:"",map:[0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,1,1,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,1,1,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,0,0,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,0,0,0,0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,2,2,0,0,0,0,2,2,0,0,0,0,0,0,0,0,3,3,3,3,3,3,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,0,0,1,1,1,0,0,0,1,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,2,2,2,2,2,2,2,2,1,1,0,0,0,0,3,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,2,2,0,0,1,1,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,1,1,1,1,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,1,1,1,1,0,0,3,0,0,0,0,1,1,1,1,0,0,0,2,2,2,2,2,2,0,0,3,3,1,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0,3,3,1,1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,1,0,0,0,0,0,0],totalEnemies:30,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.3,type2:.35,type3:.25,type4:.1},itemDropRates:{life:.15,stop:.1,iron:.15,bomb:.1,star:.15,shield:.1}},{id:4,name:"",map:[],totalEnemies:35,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.25,type2:.35,type3:.3,type4:.1},itemDropRates:{life:.18,stop:.08,iron:.18,bomb:.12,star:.18,shield:.08}},{id:5,name:"",map:[],totalEnemies:40,maxEnemiesOnScreen:4,enemySpawnRates:{type1:.2,type2:.35,type3:.35,type4:.1},itemDropRates:{life:.2,stop:.05,iron:.2,bomb:.15,star:.2,shield:.05}}];class TankCompMap{constructor(_){this.gameUI=_,this.tankApp=_.tankApp,this.textures=_.textures,this.config=null,this.mapCols=26,this.mapRows=26,this.tiles=[],this.renderLayers=null}setRenderLayers(_){this.renderLayers=_}loadLevel(_){return this.config=allLevels[_],this.initTilesFromMap(this.config.map),!0}initTilesFromMap(_){for(let T=0;T<this.mapRows;T++){this.tiles[T]=[];for(let E=0;E<this.mapCols;E++){const W=T*this.mapCols+E,X=_[W]||TileType.EMPTY;if(X>TileType.EMPTY){const q=new TankTile(T,E,X);this.tiles[T][E]=q,this.addTileToRenderLayer(q,X)}else this.tiles[T][E]=null}}}addTileToRenderLayer(_,T){const E=this.renderLayers;switch(T){case TileType.BRICK:case TileType.IRON:case TileType.WATER:E.tiles.addChild(_);break;case TileType.GRASS:E.grass.addChild(_);break}}clearTiles(){this.tiles.forEach(_=>{_&&_.forEach(T=>{T&&T.parent&&T.parent.removeChild(T)})}),this.tiles=[]}getTileType(_,T){if(_>=0&&_<this.mapRows&&T>=0&&T<this.mapCols){const E=this.tiles[_]&&this.tiles[_][T];if(E)return E.isHome,E.type}return TileType.EMPTY}setTileType(_,T,E){if(_>=0&&_<this.mapRows&&T>=0&&T<this.mapCols)if(E===TileType.EMPTY){if(this.tiles[_]&&this.tiles[_][T]){const W=this.tiles[_][T];W.parent&&W.parent.removeChild(W),this.tiles[_][T]=null}}else if(this.tiles[_]||(this.tiles[_]=[]),this.tiles[_][T])this.tiles[_][T].setType(E);else{const W=new TankTile(_,T,E);this.tiles[_][T]=W,this.addTileToRenderLayer(W,E)}}isWalkable(_,T){const E=Math.floor(_/TileSize),W=Math.floor(T/TileSize),X=this.getTileType(W,E);return X===TileType.EMPTY||X===TileType.GRASS}isRectWalkable(_,T,E=16){const W=_-E,X=_+E-1,q=T-E,Y=T+E-1,te=Math.floor(W/TileSize),ne=Math.floor(X/TileSize),ae=Math.floor(q/TileSize),le=Math.floor(Y/TileSize);for(let ue=ae;ue<=le;ue++)for(let ge=te;ge<=ne;ge++){const ye=this.getTileType(ue,ge);if(!(ye===TileType.EMPTY||ye===TileType.GRASS))return!1}return!0}getMovableDistance(_,T){const E=_.x,W=_.y,X=_.width,q=_.height;let Y=4;const te=[{x:E-X/2,y:W-q/2},{x:E+X/2,y:W-q/2},{x:E-X/2,y:W+q/2},{x:E+X/2,y:W+q/2}],ue=[{x:E-X/2+Y,y:W-q/2+Y},{x:E+X/2-Y,y:W-q/2+Y},{x:E-X/2+Y,y:W+q/2-Y},{x:E+X/2-Y,y:W+q/2-Y}].map(ye=>this.worldToGrid(ye.x,ye.y)).map(ye=>this.findNextNotWalkRC(ye,T)).map(ye=>this.gridToWorld(ye.row,ye.col)),ge=[];for(let ye=0;ye<te.length;ye++)T===0?ge.push(te[ye].y-(ue[ye].y+TileSize)):T===1?ge.push(ue[ye].x-te[ye].x):T===2?ge.push(ue[ye].y-te[ye].y):ge.push(te[ye].x-(ue[ye].x+TileSize));return Math.min(...ge)}findNextCanWalkRC(_,T){let E=_.row,W=_.col;const X=(q,Y)=>{const te=this.getTileType(q,Y);return te===TileType.EMPTY||te===TileType.GRASS};if(T===0){for(;E-1>=0&&X(E-1,W);)E--;return{row:E,col:W}}if(T===2){for(;E+1<this.mapRows&&X(E+1,W);)E++;return{row:E,col:W}}if(T===1){for(;W+1<this.mapCols&&X(E,W+1);)W++;return{row:E,col:W}}for(;W-1>=0&&X(E,W-1);)W--;return{row:E,col:W}}passable(_,T){if(_<0||_>=this.mapRows||T<0||T>=this.mapCols)return!1;const E=this.getTileType(_,T);return E===TileType.EMPTY||E===TileType.GRASS}findNextNotWalkRC(_,T){let E=_.row,W=_.col;if(T===0){for(;this.passable(E,W);)E--;return{row:E,col:W}}if(T===2){for(;this.passable(E,W);)E++;return{row:E,col:W}}if(T===1){for(;this.passable(E,W);)W++;return{row:E,col:W}}for(;this.passable(E,W);)W--;return{row:E,col:W}}worldToGrid(_,T){const E=Math.floor(_/TileSize);return{row:Math.floor(T/TileSize),col:E}}gridToWorld(_,T){return{x:T*TileSize,y:_*TileSize}}findRCsInBounds(_){const T=[],E=_.x-_.width/2,W=_.y-_.height/2,X=_.x+_.width/2,q=_.y+_.height/2,Y=Math.floor(W/TileSize),te=Math.floor(q/TileSize),ne=Math.floor(E/TileSize),ae=Math.floor(X/TileSize);for(let le=Y;le<=te;le++)for(let ue=ne;ue<=ae;ue++)le>=0&&le<this.mapRows&&ue>=0&&ue<this.mapCols&&T.push({row:le,col:ue});return T}checkCollisionBullet(_){if(_.isDead)return;let T=_.getBounds(),E=this.findRCsInBounds(T);for(let W=0;W<E.length;W++){let X=E[W],q=this.tiles[X.row][X.col];q&&(q.type===TileType.BRICK?(q.setBlood(q.getBlood()-_.getPower()),q.getBlood()<=0&&this.setTileType(X.row,X.col,TileType.EMPTY),_.makeDead()):q.type===TileType.IRON&&(_.getPower()>=2&&this.setTileType(X.row,X.col,TileType.EMPTY),_.makeDead()))}}}class TankEnemy extends TankBase{constructor(_){super(_),this.aiTimer=0,this.moveTimer=0,this.resetShootTimer(),this.aiState=""}random(_,T){return Math.random()*(T-_)+_}onAppearFinish(){super.onAppearFinish(),this.checkAI(0),this.setMoving(!0),this.setShooting(!0)}resetShootTimer(_="normal"){_==="fast"?this.shootTimer=this.random(1,3):this.shootTimer=this.random(1,3)}update(_){this.checkAI(_),super.update(_)}checkAI(_){this.aiTimer-=_,this.moveTimer-=_,this.shootTimer-=_,this.aiTimer<=0&&(this.aiTimer=2,this.makeDecision()),this.moveTimer<=0&&(this.moveTimer=1,this.executeMovement()),this.shootTimer<=0&&(this.resetShootTimer(),this.setShootOnce(!0))}makeDecision(){const _=Math.random(),T=this.aiState;_<1?(this.aiState="random",this.randomWander(T!=="random"),T==="huntHome"&&this.resetShootTimer("normal")):(this.aiState="huntHome",this.huntHome(T!=="huntHome"))}randomWander(_){_?this.changeDirection():Math.random()<.3&&this.changeDirection()}huntHome(_){_&&this.resetShootTimer("fast");const T=25,E=Math.round(this.y/TileSize);if(E<T)this.setDirection(Dir.DOWN);else if(E>T)this.setDirection(Dir.UP);else if(Math.random()<.3){const W=[Dir.LEFT,Dir.RIGHT],X=W[Math.floor(Math.random()*W.length)];this.setDirection(X)}}executeMovement(){this.tankApp.ui.map.getMovableDistance(this.getBounds(),this.direction)<=0&&this.changeDirection()}changeDirection(){const _=this.direction,T=[Dir.UP,Dir.RIGHT,Dir.DOWN,Dir.LEFT],E=[];for(const q of T){const Y=this.tankApp.ui.map.getMovableDistance(this.getBounds(),q),te=this.tankApp.ui.getMovableDistance(this.getBounds(),q,this);Math.min(Y,te)>TileSize/2&&E.push(q)}if(E.length===0)return;const W=Math.random();let X;if(W<.1)X=Dir.DOWN;else if(W<.5)X=_;else if(W<.9){const q=[(_+1)%4,(_+3)%4];X=q[Math.floor(Math.random()*q.length)]}else X=(_+2)%4;if(E.includes(X))this.setDirection(X);else{const q=E[Math.floor(Math.random()*E.length)];this.setDirection(q)}}getDirectionToHome(){const _=this.tankApp.ui.home;if(!_)return Dir.DOWN;const T=_.x-this.x,E=_.y-this.y;return Math.abs(T)>Math.abs(E)?T>0?Dir.RIGHT:Dir.LEFT:E>0?Dir.DOWN:Dir.UP}}class TankCompEnemySpawner{constructor(_){this.gameUI=_,this.spawnIndex=1,this.spawnCount=0}update(_){const T=this.gameUI.map,E=this.gameUI.enemies.length<T.config.maxEnemiesOnScreen,W=this.spawnCount<T.config.totalEnemies;E&&W&&this.createEnemy()}isFinished(){return this.spawnCount>=this.gameUI.map.config.totalEnemies&&this.gameUI.enemies.length===0}getRemainingEnemies(){return this.gameUI.map.config.totalEnemies-this.spawnCount}createEnemy(){const _=TankType.ENEMY_1+this.spawnIndex%4,T=new TankEnemy(_),{r:E,c:W}=this.getStartRC();T.x=W*TileSize,T.y=E*TileSize,T.setDirection(2),T.appear(),this.spawnIndex=(this.spawnIndex+1)%3,this.gameUI.addEnemy(T),this.spawnCount++}getStartRC(){switch(this.spawnIndex){case 0:return{r:1,c:1};case 1:return{r:1,c:Math.floor(this.gameUI.map.mapCols/2)};case 2:return{r:1,c:this.gameUI.map.mapCols-1}}}}class TankGameSide extends Container{constructor(_){super(),this.tankApp=TankApp.instance,this.gameUI=_,this.panelWidth=300,this.panelHeight=600,this.x=this.tankApp.winW-this.panelWidth,this.y=this.tankApp.winH/2,this.createPanel(),this.createInfoTexts()}createPanel(){const _=new Graphics;_.beginFill(0,.8),_.drawRoundedRect(0,-this.panelHeight/2,this.panelWidth,this.panelHeight,10),_.endFill(),_.lineStyle(2,16777215,.8),_.drawRoundedRect(0,-this.panelHeight/2,this.panelWidth,this.panelHeight,10),this.addChild(_)}createInfoTexts(){const _=new TextStyle({fontFamily:"Arial",fontSize:20,fill:16777215,align:"left"}),T=new TextStyle({fontFamily:"Arial",fontSize:28,fill:65280,align:"center",fontWeight:"bold"}),E=new Text$1("",T);E.anchor.set(.5,0),E.x=this.panelWidth/2,E.y=-this.panelHeight/2+30,this.addChild(E),this.levelText=new Text$1(": 1",_),this.levelText.x=30,this.levelText.y=-this.panelHeight/2+80,this.addChild(this.levelText),this.livesText=new Text$1(": 3",_),this.livesText.x=30,this.livesText.y=-this.panelHeight/2+120,this.addChild(this.livesText),this.enemyText=new Text$1(": 0/0",_),this.enemyText.x=30,this.enemyText.y=-this.panelHeight/2+160,this.addChild(this.enemyText);const W=new Graphics;W.lineStyle(2,16777215,.5),W.moveTo(30,-this.panelHeight/2+200),W.lineTo(this.panelWidth-30,-this.panelHeight/2+200),this.addChild(W)}updateView(){this.levelText.text=`: ${this.tankApp.playerData.levelId+1}`,this.livesText.text=`: ${this.tankApp.playerData.playerLives}`,this.updateEnemyInfo()}updateEnemyInfo(){const _=this.gameUI.map.config.totalEnemies,T=this.gameUI.enemySpawner.getRemainingEnemies();this.enemyText.text=`: ${T}/${_}`}}class TankGameUI extends Container{constructor(){super(),this.tankApp=TankApp.instance,this.textures=this.tankApp.textures,this.tileRoot=new Container,this.addChild(this.tileRoot),this.tileRoot.position.set(-MapWidth/2,-MapHeight/2),this.createMapBorder(),this.input=null,this.map=null,this.enemySpawner=null,this.renderLayers={background:null,tiles:null,tank:null,bullets:null,grass:null,effect:null},this.createRenderLayers(),this.initComps(),this.on("removed",this.makeDead,this),this.startLevel(),this.side.updateView()}onAppearFinish(){this.createPlayer()}createMapBorder(){const _=new Graphics;_.lineStyle(3,16777215,.5),_.drawRoundedRect(-MapWidth/2,-MapHeight/2,MapWidth,MapHeight,8),this.addChild(_)}createRenderLayers(){this.renderLayers.background=new Container,this.renderLayers.tiles=new Container,this.renderLayers.tank=new Container,this.renderLayers.bullets=new Container,this.renderLayers.grass=new Container,this.renderLayers.effect=new Container,this.tileRoot.addChild(this.renderLayers.background),this.tileRoot.addChild(this.renderLayers.tiles),this.tileRoot.addChild(this.renderLayers.tank),this.tileRoot.addChild(this.renderLayers.bullets),this.tileRoot.addChild(this.renderLayers.grass),this.tileRoot.addChild(this.renderLayers.effect)}initComps(){this.updater=[],this.map=new TankCompMap(this),this.map.setRenderLayers(this.renderLayers),this.input=new TankCompInput(this),this.enemySpawner=new TankCompEnemySpawner(this),this.updater.push(this.enemySpawner),this.side=new TankGameSide(this),this.addChild(this.side),this.side.position.set(MapWidth/2+50,0)}update(_){this.tankApp.playerData.levelEndType==0&&(this.updater.forEach(T=>{T.update(_)}),this.player&&this.player.update(_),this.enemies.forEach(T=>{T.update(_)}),this.playerBullets.forEach(T=>{T.update(_)}),this.enemyBullets.forEach(T=>{T.update(_)}),this.checkCollisions())}addBullet(_){_.bulletType==="player"?this.playerBullets.push(_):this.enemyBullets.push(_),this.renderLayers.bullets.addChild(_)}removeBullet(_){if(this.renderLayers.bullets.removeChild(_),_.bulletType==="player"){let T=this.playerBullets.indexOf(_);T!==-1&&this.playerBullets.splice(T,1)}else{let T=this.enemyBullets.indexOf(_);T!==-1&&this.enemyBullets.splice(T,1)}}addEnemy(_){this.enemies.push(_),this.renderLayers.tank.addChild(_)}removeEnemy(_){this.renderLayers.tank.removeChild(_);let T=this.enemies.indexOf(_);T!==-1&&this.enemies.splice(T,1)}addPlayer(_){this.player=_,this.renderLayers.tank.addChild(_)}removePlayer(_){this.renderLayers.tank.removeChild(_),this.player=null}addEffect(_,T,E,W){const X=createSpriteSeqAnim(_,W);X.x=T,X.y=E,this.renderLayers.effect.addChild(X)}startLevel(){this.clearLevel(),this.map.loadLevel(this.tankApp.playerData.levelId),this.createHome()}nextLevel(){this.tankApp.playerData.levelId++,this.startLevel()}clearLevel(){this.home=null,this.player=null,this.enemies=[],this.playerBullets=[],this.enemyBullets=[];for(let _ in this.renderLayers)this.renderLayers[_]&&this.renderLayers[_].removeChildren()}createPlayer(){this.player&&this.player.parent&&this.player.parent.removeChild(this.player),this.player=new TankBase(TankType.PLAYER),this.renderLayers.tank.addChild(this.player);const _=this.map.mapRows-1,T=this.map.mapCols/2-1;let E=_,W=T-2;this.player.x=W*TileSize,this.player.y=E*TileSize,this.player.appear()}createHome(){this.home&&this.home.parent&&this.home.parent.removeChild(this.home);const _=this.map.mapRows-1,T=this.map.mapCols/2-1;this.home=new TankHome,this.home.x=T*TileSize+TileSize,this.home.y=(_-1)*TileSize+TileSize,this.renderLayers.tank.addChild(this.home)}checkCollisions(){const _=this.playerBullets.concat(),T=this.enemyBullets.concat(),E=[..._,...T],W=this.player,X=this.enemies;for(let q=0;q<E.length;q++){const Y=E[q];this.map.checkCollisionBullet(Y)}if(this.home&&!this.home.isDead)for(let q=0;q<E.length;q++){const Y=E[q];this.home.checkCollision(Y.x,Y.y)&&(this.home.takeDamage(Y.power),Y.makeDead())}_.forEach(q=>{X.forEach(Y=>{this.checkBulletTankCollision(q,Y)&&(Y.takeDamage(q.power),q.makeDead())})}),T.forEach(q=>{W&&this.checkBulletTankCollision(q,W)&&(W.takeDamage(q.power),q.makeDead())}),_.forEach(q=>{T.forEach(Y=>{this.checkBulletBulletCollision(q,Y)&&(q.makeDead(),Y.makeDead())})})}checkBulletTankCollision(_,T){if(!_||!T||_.isDead||T.isDead)return!1;const E=_.getBounds(),W=T.getBounds();return E.x<W.x+W.width&&E.x+E.width>W.x&&E.y<W.y+W.height&&E.y+E.height>W.y}checkBulletBulletCollision(_,T){if(!_||!T||_.isDead||T.isDead)return!1;const E=_.getBounds(),W=T.getBounds();return E.x<W.x+W.width&&E.x+E.width>W.x&&E.y<W.y+W.height&&E.y+E.height>W.y}checkTankTankCollision(_,T){if(!_||!T||_===T)return!1;const E=_.getBounds(),W=T.getBounds();return E.x<W.x+W.width&&E.x+E.width>W.x&&E.y<W.y+W.height&&E.y+E.height>W.y}getMovableDistance(_,T,E=null){const W=_.x,X=_.y,q=_.width,Y=_.height,te=[this.player,...this.enemies].filter(ae=>ae&&ae!==E);let ne=1/0;for(const ae of te){const le=ae.getBounds(),ue=le.x,ge=le.y,ye=le.width,xe=le.height;let Te=1/0;T===0?W-q/2<ue+ye/2&&W+q/2>ue-ye/2&&(Te=X-Y/2-(ge+xe/2)):T===1?X-Y/2<ge+xe/2&&X+Y/2>ge-xe/2&&(Te=ue-ye/2-(W+q/2)):T===2?W-q/2<ue+ye/2&&W+q/2>ue-ye/2&&(Te=ge-xe/2-(X+Y/2)):T===3&&X-Y/2<ge+xe/2&&X+Y/2>ge-xe/2&&(Te=W-q/2-(ue+ye/2)),Te<ne&&(ne=Te)}return ne===1/0||ne<0?1e3:ne}isInBounds(_,T){return _>=0&&_<MapWidth&&T>=0&&T<MapHeight}onTankDeadFinish(_){_===this.player?(this.removePlayer(_),this.checkCreatePlayer()):(this.removeEnemy(_),this.tankApp.playerData.addEnemyDestroyed(_.tankType,1)),this.side.updateView(),this.checkGameState()}onHomeDeadFinish(_){this.home=null,this.checkGameState()}onBulletDeadFinish(_){this.removeBullet(_)}checkCreatePlayer(){this.tankApp.playerData.playerLives>0&&(this.tankApp.playerData.playerLives--,this.createPlayer())}checkGameState(){if(this.tankApp.playerData.levelEndType==0){do{if(this.enemySpawner.isFinished()){this.tankApp.playerData.levelEndType=1;break}if(!this.home){this.tankApp.playerData.levelEndType=2;break}if(!this.player&&this.tankApp.playerData.playerLives==0){this.tankApp.playerData.levelEndType=2;break}}while(!1);this.tankApp.playerData.levelEndType&&this.tankApp.ticker.tickOnce(()=>{this.tankApp.logic.setUI("TankEndUI")},1)}}makeDead(){this.input.makeDead()}}function makeButton(B,_){B.eventMode="static",B.cursor="pointer",B.on("pointerdown",X=>{X.preventDefault(),X.stopPropagation()}),B.on("pointertap",X=>{X.preventDefault(),X.stopPropagation(),_(X)});const T=X=>{X.preventDefault(),X.stopPropagation(),B.scale.set(.95)},E=X=>{X.preventDefault(),X.stopPropagation(),B.scale.set(1)},W=X=>{X.preventDefault(),X.stopPropagation(),B.scale.set(1)};return B.on("pointerdown",T),B.on("pointerup",E),B.on("pointerupoutside",W),B.on("touchstart",X=>{X.preventDefault(),X.stopPropagation(),T(X)}),B.on("touchend",X=>{X.preventDefault(),X.stopPropagation(),E(X)}),B.on("touchcancel",X=>{X.preventDefault(),X.stopPropagation(),W(X)}),B}class TankStartUI extends Container{constructor(){super(),this.tankApp=TankApp.instance,this.textures=this.tankApp.textures,this.titleText=null,this.singlePlayerButton=null,this.createUI()}createUI(){this.createTitle(),this.createButtons(),this.createBackground()}createTitle(){const _=Math.min(this.tankApp.winW,this.tankApp.winH)*.08,T=_*.5;this.titleText=new Text$1("",{fontFamily:"Arial",fontSize:_,fontWeight:"bold",fill:16766720,align:"center",dropShadow:!0,dropShadowColor:0,dropShadowBlur:8,dropShadowDistance:4,stroke:9127187,strokeThickness:3}),this.titleText.anchor.set(.5,.5),this.titleText.x=0,this.titleText.y=-this.tankApp.winH*.15,this.addChild(this.titleText);const E=new Text$1("TANK BATTLE",{fontFamily:"Arial",fontSize:T,fontWeight:"bold",fill:16753920,align:"center",dropShadow:!0,dropShadowColor:0,dropShadowBlur:4,dropShadowDistance:2});E.anchor.set(.5,.5),E.x=0,E.y=-this.tankApp.winH*.08,this.addChild(E)}createButtons(){const _=this.tankApp.winW*.2,T=this.tankApp.winH*.06;this.tankApp.winH*.08;const E=this.tankApp.winH*.1,W=Math.min(_,T)*.3;this.singlePlayerButton=this.createButton("",2263842,()=>{this.onSinglePlayer()},_,T,W),this.singlePlayerButton.x=0,this.singlePlayerButton.y=E,this.addChild(this.singlePlayerButton)}createButton(_,T,E,W,X,q){const Y=new Container,te=new Graphics;te.beginFill(T),te.lineStyle(4,16777215,1),te.drawRoundedRect(-W/2,-X/2,W,X,X*.25),te.endFill();const ne=new Text$1(_,{fontFamily:"Arial",fontSize:q,fontWeight:"bold",fill:16777215,align:"center",dropShadow:!0,dropShadowColor:0,dropShadowBlur:3,dropShadowDistance:2});return ne.anchor.set(.5,.5),Y.addChild(te),Y.addChild(ne),makeButton(Y,E),Y.on("pointerover",()=>{te.tint=13421772,Y.scale.set(1.05)}),Y.on("pointerout",()=>{te.tint=16777215,Y.scale.set(1)}),Y}createBackground(){this.createDecorativeBorder()}createDecorativeBorder(){const _=this.tankApp.winW*.8,T=this.tankApp.winH*.8,E=Math.min(this.tankApp.winW,this.tankApp.winH)*.02,W=Math.min(this.tankApp.winW,this.tankApp.winH)*.003,X=new Graphics;X.lineStyle(W,16766720,.8),X.drawRoundedRect(-_/2,-T/2,_,T,E),[{x:-_/2+E,y:-T/2+E},{x:_/2-E,y:-T/2+E},{x:-_/2+E,y:T/2-E},{x:_/2-E,y:T/2-E}].forEach(Y=>{X.beginFill(16766720,.3),X.drawRect(Y.x-E/2,Y.y-E/2,E,E),X.endFill()}),this.addChildAt(X,0)}onSinglePlayer(){this.tankApp.playerData.levelId=0,this.tankApp.logic.setUI("TankGameUI")}}class TankEndUI extends Container{constructor(){super(),this.tankApp=TankApp.instance,this.panelWidth=800,this.panelHeight=600,this.createPanel(),this.createTitle(),this.createStats(),this.createButtons(),this.updateTitleAndButton(),this.updateStats()}createPanel(){const _=new Graphics;_.beginFill(0,.9),_.drawRoundedRect(-this.panelWidth/2,-this.panelHeight/2,this.panelWidth,this.panelHeight,15),_.endFill(),_.lineStyle(3,16777215,.8),_.drawRoundedRect(-this.panelWidth/2,-this.panelHeight/2,this.panelWidth,this.panelHeight,15),this.addChild(_)}createTitle(){const _=new TextStyle({fontFamily:"Arial",fontSize:32,fill:65280,align:"center",fontWeight:"bold"});this.titleText=new Text$1("",_),this.titleText.anchor.set(.5,0),this.titleText.x=0,this.titleText.y=-this.panelHeight/2+40,this.addChild(this.titleText)}createStats(){const _=new TextStyle({fontFamily:"Arial",fontSize:20,fill:16777215,align:"left"});new TextStyle({fontFamily:"Arial",fontSize:18,fill:16776960,align:"left"}),this.timeText=new Text$1(": 00:00",_),this.timeText.x=-this.panelWidth/2+50,this.timeText.y=-this.panelHeight/2+100,this.addChild(this.timeText)}createButtons(){this.actionBtn=this.createButton("",0,150),this.addChild(this.actionBtn),this.setupButtonEvents()}createButton(_,T,E){const W=new Container,X=new Graphics;X.beginFill(3355443,.8),X.drawRoundedRect(-80,-25,160,50,8),X.endFill(),X.lineStyle(2,16777215,.8),X.drawRoundedRect(-80,-25,160,50,8),W.addChild(X);const q=new Text$1(_,{fontFamily:"Arial",fontSize:18,fill:16777215,align:"center",fontWeight:"bold"});return q.anchor.set(.5,.5),W.addChild(q),W.x=T,W.y=E,W.eventMode="static",W.cursor="pointer",W.on("pointerover",()=>{X.clear(),X.beginFill(5592405,.9),X.drawRoundedRect(-80,-25,160,50,8),X.endFill(),X.lineStyle(2,65280,1),X.drawRoundedRect(-80,-25,160,50,8)}),W.on("pointerout",()=>{X.clear(),X.beginFill(3355443,.8),X.drawRoundedRect(-80,-25,160,50,8),X.endFill(),X.lineStyle(2,16777215,.8),X.drawRoundedRect(-80,-25,160,50,8)}),W}setupButtonEvents(){this.actionBtn.on("pointerdown",()=>{this.onActionButtonClick()})}onActionButtonClick(){this.tankApp.playerData&&(this.tankApp.playerData.levelEndType===1?this.isLastLevel()?this.onBackToStart():this.onNextLevel():this.onRestart())}onBackToStart(){console.log(""),this.tankApp.logic&&this.tankApp.logic.setUI&&this.tankApp.logic.setUI("TankStartUI")}onRestart(){console.log(""),this.tankApp.playerData&&this.tankApp.playerData.resetOneLevelData(),this.tankApp.logic&&this.tankApp.logic.setUI&&this.tankApp.logic.setUI("TankGameUI")}onNextLevel(){console.log(""),this.tankApp.playerData&&(this.tankApp.playerData.levelId++,this.tankApp.playerData.resetOneLevelData()),this.tankApp.logic&&this.tankApp.logic.setUI&&this.tankApp.logic.setUI("TankGameUI")}updateStats(){this.tankApp.playerData&&(this.timeText.text=`: ${this.tankApp.playerData.getFormattedLevelTime()}`)}setTitle(_){this.titleText.text=_}isLastLevel(){if(!this.tankApp.playerData)return!1;const _=allLevels.length;return this.tankApp.playerData.levelId-1>=_}updateTitleAndButton(){if(!this.tankApp.playerData)return;this.tankApp.playerData.levelEndType===1?(this.titleText.text="",this.titleText.style.fill=65280):(this.titleText.text="",this.titleText.style.fill=16711680);const _=this.actionBtn.children[1];this.tankApp.playerData.levelEndType===1?this.isLastLevel()?_.text="":_.text="":_.text=""}show(){this.visible=!0,this.alpha=1}hide(){this.visible=!1,this.alpha=0}}class TankLogic{constructor(){this.tankApp=TankApp.instance}init(_){initDom(_,{designWidth:1920,designHeight:1080,isFullScreen:!1}),this.tankApp.pixi=createPixi(_),this.tankApp.uiContainer=new Container,this.tankApp.pixi.stage.addChild(this.tankApp.uiContainer),this.tankApp.uiContainer.position.set(this.tankApp.pixi.screen.width/2,this.tankApp.pixi.screen.height/2),this.tankApp.ticker=new Ticker,this._gameTickId=this.tankApp.ticker.tick(T=>this.update(T),0),this.tankApp.playerData=new TankPlayerData,this.setUI("TankStartUI")}setUI(_){_==="TankStartUI"?this.tankApp.setUI(new TankStartUI):_==="TankGameUI"?this.tankApp.setUI(new TankGameUI):_==="TankEndUI"&&this.tankApp.setUI(new TankEndUI)}update(_){this.tankApp.ui&&this.tankApp.ui.update&&this.tankApp.ui.update(_)}makeDead(){this.tankApp.ticker&&(this.tankApp.ticker.stop(),this.tankApp.ticker=null),this.tankApp.pixi&&(this.tankApp.pixi.destroy(!0),this.tankApp.pixi=null)}}const _hoisted_1$e={class:"game-container"},_sfc_main$e={__name:"TankGame",setup(B){const _=ref$1(null),T=ref$1(["tank2/bigtile_1_tile_1.png","tank2/bigtile_2_tile_1.png","tank2/bigtile_3_tile_1.png","tank2/bigtile_4_tile_1.png","tank2/bigtile_6.png","tank2/player1_run_1.png","tank2/player1_run_2.png","tank2/enermys/enermy_1_run_1.png","tank2/enermys/enermy_1_run_2.png","tank2/enermys/enermy_2_run_1.png","tank2/enermys/enermy_2_run_2.png","tank2/enermys/enermy_3_run_1.png","tank2/enermys/enermy_3_run_2.png","tank2/enermys/enermy_4_run_1.png","tank2/enermys/enermy_4_run_2.png","tank2/born_1.png","tank2/born_2.png","tank2/born_3.png","tank2/born_4.png","tank2/born_5.png","tank2/born_6.png","tank2/explode_1.png","tank2/explode_2.png","tank2/explode_3.png"]),E=TankApp.instance;E.logic=new TankLogic;const W=X=>{E.textures=X,E.logic.init(_.value)};return onUnmounted(()=>{E.logic.makeDead()}),(X,q)=>(openBlock(),createElementBlock("div",_hoisted_1$e,[createVNode(PixiLoader,{textureUrls:T.value,onLoaded:W},null,8,["textureUrls"]),createBaseVNode("canvas",{ref_key:"gameContainer",ref:_},null,512)]))}},_hoisted_1$d=["src"],_sfc_main$d={__name:"EasyLink",props:{link:String,width:Number,height:Number},setup(B){const _=B,T=ref$1(null);return onMounted(()=>{var E=_.width?`${E}px`:"100%",W=_.height?`${W}px`:"100vh";T.value={width:E,height:W}}),(E,W)=>(openBlock(),createElementBlock("iframe",{src:_.link,style:normalizeStyle(T.value)},null,12,_hoisted_1$d))}},_hoisted_1$c={style:{"margin-top":"32px",padding:"24px 12px",background:"#fff","border-radius":"12px","box-shadow":"0 2px 8px #f0f1f2"}},_hoisted_2$7=createBaseVNode("h1",{style:{"text-align":"center"}},"",-1),_sfc_main$c={__name:"TrigoCalc",setup(B){const _=ref$1(0),T=ref$1(0),E=ref$1(0),W=ref$1(0),X=ref$1(0),q=ref$1(0),Y=ref$1(0);let te=!1;watch(T,()=>{ne(T,ue=>ue)}),watch(E,()=>{ne(E,ue=>ue*180/Math.PI)}),watch(W,()=>{ne(W,ue=>Math.asin(ue))}),watch(X,()=>{ne(X,ue=>Math.acos(ue))}),watch(q,()=>{ne(q,ue=>Math.atan(ue))}),watch(Y,()=>{ne(Y,ue=>Math.atan(1/ue))});function ne(ue,ge){if(te)return;const ye=ae(ue.value);_.value=ge(ye)}function ae(ue){let ge=parseFloat(ue);return ge||(ge=0),Math.abs(ge)<.001&&(ge=0),ge}watch(_,le);async function le(){te=!0;const ue=_.value*Math.PI/180;T.value=_.value,E.value=ue,W.value=Math.sin(ue),X.value=Math.cos(ue),q.value=Math.tan(ue),q.value?Y.value=1/q.value:Y.value=0,T.value=parseFloat(T.value.toFixed(3)),E.value=parseFloat(E.value.toFixed(3)),W.value=parseFloat(W.value.toFixed(3)),X.value=parseFloat(X.value.toFixed(3)),q.value=parseFloat(q.value.toFixed(3)),Y.value=parseFloat(Y.value.toFixed(3)),await nextTick(),te=!1}return onMounted(()=>{_.value=30}),(ue,ge)=>{const ye=resolveComponent("Input"),xe=resolveComponent("Col"),Te=resolveComponent("Row");return openBlock(),createBlock(Te,{justify:"center"},{default:withCtx(()=>[createVNode(xe,{xs:24,sm:16,md:10,lg:8,xl:6},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$c,[_hoisted_2$7,createVNode(ye,{type:"number",modelValue:T.value,"onUpdate:modelValue":ge[0]||(ge[0]=Ae=>T.value=Ae),style:{"margin-bottom":"12px"}},{prepend:withCtx(()=>[createTextVNode("")]),_:1},8,["modelValue"]),createVNode(ye,{type:"number",modelValue:E.value,"onUpdate:modelValue":ge[1]||(ge[1]=Ae=>E.value=Ae),style:{"margin-bottom":"12px"}},{prepend:withCtx(()=>[createTextVNode("")]),_:1},8,["modelValue"]),createVNode(ye,{type:"number",modelValue:W.value,"onUpdate:modelValue":ge[2]||(ge[2]=Ae=>W.value=Ae),style:{"margin-bottom":"12px"}},{prepend:withCtx(()=>[createTextVNode("")]),_:1},8,["modelValue"]),createVNode(ye,{type:"number",modelValue:X.value,"onUpdate:modelValue":ge[3]||(ge[3]=Ae=>X.value=Ae),style:{"margin-bottom":"12px"}},{prepend:withCtx(()=>[createTextVNode("")]),_:1},8,["modelValue"]),createVNode(ye,{type:"number",modelValue:q.value,"onUpdate:modelValue":ge[4]||(ge[4]=Ae=>q.value=Ae),style:{"margin-bottom":"12px"}},{prepend:withCtx(()=>[createTextVNode("")]),_:1},8,["modelValue"]),createVNode(ye,{type:"number",modelValue:Y.value,"onUpdate:modelValue":ge[5]||(ge[5]=Ae=>Y.value=Ae)},{prepend:withCtx(()=>[createTextVNode("")]),_:1},8,["modelValue"])])]),_:1})]),_:1})}}};/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="164",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,NeutralToneMapping=7,AttachedBindMode="attached",DetachedBindMode="detached",UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,UnsignedInt5999Type=35902,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(_,T){this._listeners===void 0&&(this._listeners={});const E=this._listeners;E[_]===void 0&&(E[_]=[]),E[_].indexOf(T)===-1&&E[_].push(T)}hasEventListener(_,T){if(this._listeners===void 0)return!1;const E=this._listeners;return E[_]!==void 0&&E[_].indexOf(T)!==-1}removeEventListener(_,T){if(this._listeners===void 0)return;const W=this._listeners[_];if(W!==void 0){const X=W.indexOf(T);X!==-1&&W.splice(X,1)}}dispatchEvent(_){if(this._listeners===void 0)return;const E=this._listeners[_.type];if(E!==void 0){_.target=this;const W=E.slice(0);for(let X=0,q=W.length;X<q;X++)W[X].call(this,_);_.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const B=Math.random()*4294967295|0,_=Math.random()*4294967295|0,T=Math.random()*4294967295|0,E=Math.random()*4294967295|0;return(_lut[B&255]+_lut[B>>8&255]+_lut[B>>16&255]+_lut[B>>24&255]+"-"+_lut[_&255]+_lut[_>>8&255]+"-"+_lut[_>>16&15|64]+_lut[_>>24&255]+"-"+_lut[T&63|128]+_lut[T>>8&255]+"-"+_lut[T>>16&255]+_lut[T>>24&255]+_lut[E&255]+_lut[E>>8&255]+_lut[E>>16&255]+_lut[E>>24&255]).toLowerCase()}function clamp$1(B,_,T){return Math.max(_,Math.min(T,B))}function euclideanModulo(B,_){return(B%_+_)%_}function mapLinear(B,_,T,E,W){return E+(B-_)*(W-E)/(T-_)}function inverseLerp(B,_,T){return B!==_?(T-B)/(_-B):0}function lerp(B,_,T){return(1-T)*B+T*_}function damp(B,_,T,E){return lerp(B,_,1-Math.exp(-T*E))}function pingpong(B,_=1){return _-Math.abs(euclideanModulo(B,_*2)-_)}function smoothstep(B,_,T){return B<=_?0:B>=T?1:(B=(B-_)/(T-_),B*B*(3-2*B))}function smootherstep(B,_,T){return B<=_?0:B>=T?1:(B=(B-_)/(T-_),B*B*B*(B*(B*6-15)+10))}function randInt(B,_){return B+Math.floor(Math.random()*(_-B+1))}function randFloat(B,_){return B+Math.random()*(_-B)}function randFloatSpread(B){return B*(.5-Math.random())}function seededRandom(B){B!==void 0&&(_seed=B);let _=_seed+=1831565813;return _=Math.imul(_^_>>>15,_|1),_^=_+Math.imul(_^_>>>7,_|61),((_^_>>>14)>>>0)/4294967296}function degToRad(B){return B*DEG2RAD}function radToDeg(B){return B*RAD2DEG}function isPowerOfTwo$1(B){return(B&B-1)===0&&B!==0}function ceilPowerOfTwo(B){return Math.pow(2,Math.ceil(Math.log(B)/Math.LN2))}function floorPowerOfTwo(B){return Math.pow(2,Math.floor(Math.log(B)/Math.LN2))}function setQuaternionFromProperEuler(B,_,T,E,W){const X=Math.cos,q=Math.sin,Y=X(T/2),te=q(T/2),ne=X((_+E)/2),ae=q((_+E)/2),le=X((_-E)/2),ue=q((_-E)/2),ge=X((E-_)/2),ye=q((E-_)/2);switch(W){case"XYX":B.set(Y*ae,te*le,te*ue,Y*ne);break;case"YZY":B.set(te*ue,Y*ae,te*le,Y*ne);break;case"ZXZ":B.set(te*le,te*ue,Y*ae,Y*ne);break;case"XZX":B.set(Y*ae,te*ye,te*ge,Y*ne);break;case"YXY":B.set(te*ge,Y*ae,te*ye,Y*ne);break;case"ZYZ":B.set(te*ye,te*ge,Y*ae,Y*ne);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+W)}}function denormalize(B,_){switch(_.constructor){case Float32Array:return B;case Uint32Array:return B/4294967295;case Uint16Array:return B/65535;case Uint8Array:return B/255;case Int32Array:return Math.max(B/2147483647,-1);case Int16Array:return Math.max(B/32767,-1);case Int8Array:return Math.max(B/127,-1);default:throw new Error("Invalid component type.")}}function normalize(B,_){switch(_.constructor){case Float32Array:return B;case Uint32Array:return Math.round(B*4294967295);case Uint16Array:return Math.round(B*65535);case Uint8Array:return Math.round(B*255);case Int32Array:return Math.round(B*2147483647);case Int16Array:return Math.round(B*32767);case Int8Array:return Math.round(B*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID,clamp:clamp$1,euclideanModulo,mapLinear,inverseLerp,lerp,damp,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo:isPowerOfTwo$1,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize,denormalize};class Vector2{constructor(_=0,T=0){Vector2.prototype.isVector2=!0,this.x=_,this.y=T}get width(){return this.x}set width(_){this.x=_}get height(){return this.y}set height(_){this.y=_}set(_,T){return this.x=_,this.y=T,this}setScalar(_){return this.x=_,this.y=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setComponent(_,T){switch(_){case 0:this.x=T;break;case 1:this.y=T;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y)}copy(_){return this.x=_.x,this.y=_.y,this}add(_){return this.x+=_.x,this.y+=_.y,this}addScalar(_){return this.x+=_,this.y+=_,this}addVectors(_,T){return this.x=_.x+T.x,this.y=_.y+T.y,this}addScaledVector(_,T){return this.x+=_.x*T,this.y+=_.y*T,this}sub(_){return this.x-=_.x,this.y-=_.y,this}subScalar(_){return this.x-=_,this.y-=_,this}subVectors(_,T){return this.x=_.x-T.x,this.y=_.y-T.y,this}multiply(_){return this.x*=_.x,this.y*=_.y,this}multiplyScalar(_){return this.x*=_,this.y*=_,this}divide(_){return this.x/=_.x,this.y/=_.y,this}divideScalar(_){return this.multiplyScalar(1/_)}applyMatrix3(_){const T=this.x,E=this.y,W=_.elements;return this.x=W[0]*T+W[3]*E+W[6],this.y=W[1]*T+W[4]*E+W[7],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this}clamp(_,T){return this.x=Math.max(_.x,Math.min(T.x,this.x)),this.y=Math.max(_.y,Math.min(T.y,this.y)),this}clampScalar(_,T){return this.x=Math.max(_,Math.min(T,this.x)),this.y=Math.max(_,Math.min(T,this.y)),this}clampLength(_,T){const E=this.length();return this.divideScalar(E||1).multiplyScalar(Math.max(_,Math.min(T,E)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_){return this.x*_.x+this.y*_.y}cross(_){return this.x*_.y-this.y*_.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(_){const T=Math.sqrt(this.lengthSq()*_.lengthSq());if(T===0)return Math.PI/2;const E=this.dot(_)/T;return Math.acos(clamp$1(E,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const T=this.x-_.x,E=this.y-_.y;return T*T+E*E}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,T){return this.x+=(_.x-this.x)*T,this.y+=(_.y-this.y)*T,this}lerpVectors(_,T,E){return this.x=_.x+(T.x-_.x)*E,this.y=_.y+(T.y-_.y)*E,this}equals(_){return _.x===this.x&&_.y===this.y}fromArray(_,T=0){return this.x=_[T],this.y=_[T+1],this}toArray(_=[],T=0){return _[T]=this.x,_[T+1]=this.y,_}fromBufferAttribute(_,T){return this.x=_.getX(T),this.y=_.getY(T),this}rotateAround(_,T){const E=Math.cos(T),W=Math.sin(T),X=this.x-_.x,q=this.y-_.y;return this.x=X*E-q*W+_.x,this.y=X*W+q*E+_.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(_,T,E,W,X,q,Y,te,ne){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],_!==void 0&&this.set(_,T,E,W,X,q,Y,te,ne)}set(_,T,E,W,X,q,Y,te,ne){const ae=this.elements;return ae[0]=_,ae[1]=W,ae[2]=Y,ae[3]=T,ae[4]=X,ae[5]=te,ae[6]=E,ae[7]=q,ae[8]=ne,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const T=this.elements,E=_.elements;return T[0]=E[0],T[1]=E[1],T[2]=E[2],T[3]=E[3],T[4]=E[4],T[5]=E[5],T[6]=E[6],T[7]=E[7],T[8]=E[8],this}extractBasis(_,T,E){return _.setFromMatrix3Column(this,0),T.setFromMatrix3Column(this,1),E.setFromMatrix3Column(this,2),this}setFromMatrix4(_){const T=_.elements;return this.set(T[0],T[4],T[8],T[1],T[5],T[9],T[2],T[6],T[10]),this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,T){const E=_.elements,W=T.elements,X=this.elements,q=E[0],Y=E[3],te=E[6],ne=E[1],ae=E[4],le=E[7],ue=E[2],ge=E[5],ye=E[8],xe=W[0],Te=W[3],Ae=W[6],Ie=W[1],Ve=W[4],$e=W[7],We=W[2],Ue=W[5],je=W[8];return X[0]=q*xe+Y*Ie+te*We,X[3]=q*Te+Y*Ve+te*Ue,X[6]=q*Ae+Y*$e+te*je,X[1]=ne*xe+ae*Ie+le*We,X[4]=ne*Te+ae*Ve+le*Ue,X[7]=ne*Ae+ae*$e+le*je,X[2]=ue*xe+ge*Ie+ye*We,X[5]=ue*Te+ge*Ve+ye*Ue,X[8]=ue*Ae+ge*$e+ye*je,this}multiplyScalar(_){const T=this.elements;return T[0]*=_,T[3]*=_,T[6]*=_,T[1]*=_,T[4]*=_,T[7]*=_,T[2]*=_,T[5]*=_,T[8]*=_,this}determinant(){const _=this.elements,T=_[0],E=_[1],W=_[2],X=_[3],q=_[4],Y=_[5],te=_[6],ne=_[7],ae=_[8];return T*q*ae-T*Y*ne-E*X*ae+E*Y*te+W*X*ne-W*q*te}invert(){const _=this.elements,T=_[0],E=_[1],W=_[2],X=_[3],q=_[4],Y=_[5],te=_[6],ne=_[7],ae=_[8],le=ae*q-Y*ne,ue=Y*te-ae*X,ge=ne*X-q*te,ye=T*le+E*ue+W*ge;if(ye===0)return this.set(0,0,0,0,0,0,0,0,0);const xe=1/ye;return _[0]=le*xe,_[1]=(W*ne-ae*E)*xe,_[2]=(Y*E-W*q)*xe,_[3]=ue*xe,_[4]=(ae*T-W*te)*xe,_[5]=(W*X-Y*T)*xe,_[6]=ge*xe,_[7]=(E*te-ne*T)*xe,_[8]=(q*T-E*X)*xe,this}transpose(){let _;const T=this.elements;return _=T[1],T[1]=T[3],T[3]=_,_=T[2],T[2]=T[6],T[6]=_,_=T[5],T[5]=T[7],T[7]=_,this}getNormalMatrix(_){return this.setFromMatrix4(_).invert().transpose()}transposeIntoArray(_){const T=this.elements;return _[0]=T[0],_[1]=T[3],_[2]=T[6],_[3]=T[1],_[4]=T[4],_[5]=T[7],_[6]=T[2],_[7]=T[5],_[8]=T[8],this}setUvTransform(_,T,E,W,X,q,Y){const te=Math.cos(X),ne=Math.sin(X);return this.set(E*te,E*ne,-E*(te*q+ne*Y)+q+_,-W*ne,W*te,-W*(-ne*q+te*Y)+Y+T,0,0,1),this}scale(_,T){return this.premultiply(_m3.makeScale(_,T)),this}rotate(_){return this.premultiply(_m3.makeRotation(-_)),this}translate(_,T){return this.premultiply(_m3.makeTranslation(_,T)),this}makeTranslation(_,T){return _.isVector2?this.set(1,0,_.x,0,1,_.y,0,0,1):this.set(1,0,_,0,1,T,0,0,1),this}makeRotation(_){const T=Math.cos(_),E=Math.sin(_);return this.set(T,-E,0,E,T,0,0,0,1),this}makeScale(_,T){return this.set(_,0,0,0,T,0,0,0,1),this}equals(_){const T=this.elements,E=_.elements;for(let W=0;W<9;W++)if(T[W]!==E[W])return!1;return!0}fromArray(_,T=0){for(let E=0;E<9;E++)this.elements[E]=_[E+T];return this}toArray(_=[],T=0){const E=this.elements;return _[T]=E[0],_[T+1]=E[1],_[T+2]=E[2],_[T+3]=E[3],_[T+4]=E[4],_[T+5]=E[5],_[T+6]=E[6],_[T+7]=E[7],_[T+8]=E[8],_}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(B){for(let _=B.length-1;_>=0;--_)if(B[_]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(B,_){return new TYPED_ARRAYS[B](_)}function createElementNS(B){return document.createElementNS("http://www.w3.org/1999/xhtml",B)}function createCanvasElement(){const B=createElementNS("canvas");return B.style.display="block",B}const _cache={};function warnOnce(B){B in _cache||(_cache[B]=!0,console.warn(B))}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace]:{transfer:LinearTransfer,primaries:Rec709Primaries,toReference:B=>B,fromReference:B=>B},[SRGBColorSpace]:{transfer:SRGBTransfer,primaries:Rec709Primaries,toReference:B=>B.convertSRGBToLinear(),fromReference:B=>B.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,toReference:B=>B.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:B=>B.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,toReference:B=>B.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:B=>B.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(B){if(!SUPPORTED_WORKING_COLOR_SPACES.has(B))throw new Error(`Unsupported working color space, "${B}".`);this._workingColorSpace=B},convert:function(B,_,T){if(this.enabled===!1||_===T||!_||!T)return B;const E=COLOR_SPACES[_].toReference,W=COLOR_SPACES[T].fromReference;return W(E(B))},fromWorkingColorSpace:function(B,_){return this.convert(B,this._workingColorSpace,_)},toWorkingColorSpace:function(B,_){return this.convert(B,_,this._workingColorSpace)},getPrimaries:function(B){return COLOR_SPACES[B].primaries},getTransfer:function(B){return B===NoColorSpace?LinearTransfer:COLOR_SPACES[B].transfer}};function SRGBToLinear(B){return B<.04045?B*.0773993808:Math.pow(B*.9478672986+.0521327014,2.4)}function LinearToSRGB(B){return B<.0031308?B*12.92:1.055*Math.pow(B,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(_){if(/^data:/i.test(_.src)||typeof HTMLCanvasElement>"u")return _.src;let T;if(_ instanceof HTMLCanvasElement)T=_;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_.width,_canvas.height=_.height;const E=_canvas.getContext("2d");_ instanceof ImageData?E.putImageData(_,0,0):E.drawImage(_,0,0,_.width,_.height),T=_canvas}return T.width>2048||T.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_),T.toDataURL("image/jpeg",.6)):T.toDataURL("image/png")}static sRGBToLinear(_){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap){const T=createElementNS("canvas");T.width=_.width,T.height=_.height;const E=T.getContext("2d");E.drawImage(_,0,0,_.width,_.height);const W=E.getImageData(0,0,_.width,_.height),X=W.data;for(let q=0;q<X.length;q++)X[q]=SRGBToLinear(X[q]/255)*255;return E.putImageData(W,0,0),T}else if(_.data){const T=_.data.slice(0);for(let E=0;E<T.length;E++)T instanceof Uint8Array||T instanceof Uint8ClampedArray?T[E]=Math.floor(SRGBToLinear(T[E]/255)*255):T[E]=SRGBToLinear(T[E]);return{data:T,width:_.width,height:_.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_}}let _sourceId=0;class Source{constructor(_=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=_,this.dataReady=!0,this.version=0}set needsUpdate(_){_===!0&&this.version++}toJSON(_){const T=_===void 0||typeof _=="string";if(!T&&_.images[this.uuid]!==void 0)return _.images[this.uuid];const E={uuid:this.uuid,url:""},W=this.data;if(W!==null){let X;if(Array.isArray(W)){X=[];for(let q=0,Y=W.length;q<Y;q++)W[q].isDataTexture?X.push(serializeImage(W[q].image)):X.push(serializeImage(W[q]))}else X=serializeImage(W);E.url=X}return T||(_.images[this.uuid]=E),E}}function serializeImage(B){return typeof HTMLImageElement<"u"&&B instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&B instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&B instanceof ImageBitmap?ImageUtils.getDataURL(B):B.data?{data:Array.from(B.data),width:B.width,height:B.height,type:B.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0;class Texture extends EventDispatcher{constructor(_=Texture.DEFAULT_IMAGE,T=Texture.DEFAULT_MAPPING,E=ClampToEdgeWrapping,W=ClampToEdgeWrapping,X=LinearFilter,q=LinearMipmapLinearFilter,Y=RGBAFormat,te=UnsignedByteType,ne=Texture.DEFAULT_ANISOTROPY,ae=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(_),this.mipmaps=[],this.mapping=T,this.channel=0,this.wrapS=E,this.wrapT=W,this.magFilter=X,this.minFilter=q,this.anisotropy=ne,this.format=Y,this.internalFormat=null,this.type=te,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=ae,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(_=null){this.source.data=_}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_){return this.name=_.name,this.source=_.source,this.mipmaps=_.mipmaps.slice(0),this.mapping=_.mapping,this.channel=_.channel,this.wrapS=_.wrapS,this.wrapT=_.wrapT,this.magFilter=_.magFilter,this.minFilter=_.minFilter,this.anisotropy=_.anisotropy,this.format=_.format,this.internalFormat=_.internalFormat,this.type=_.type,this.offset.copy(_.offset),this.repeat.copy(_.repeat),this.center.copy(_.center),this.rotation=_.rotation,this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrix.copy(_.matrix),this.generateMipmaps=_.generateMipmaps,this.premultiplyAlpha=_.premultiplyAlpha,this.flipY=_.flipY,this.unpackAlignment=_.unpackAlignment,this.colorSpace=_.colorSpace,this.userData=JSON.parse(JSON.stringify(_.userData)),this.needsUpdate=!0,this}toJSON(_){const T=_===void 0||typeof _=="string";if(!T&&_.textures[this.uuid]!==void 0)return _.textures[this.uuid];const E={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(E.userData=this.userData),T||(_.textures[this.uuid]=E),E}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_){if(this.mapping!==UVMapping)return _;if(_.applyMatrix3(this.matrix),_.x<0||_.x>1)switch(this.wrapS){case RepeatWrapping:_.x=_.x-Math.floor(_.x);break;case ClampToEdgeWrapping:_.x=_.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.x)%2)===1?_.x=Math.ceil(_.x)-_.x:_.x=_.x-Math.floor(_.x);break}if(_.y<0||_.y>1)switch(this.wrapT){case RepeatWrapping:_.y=_.y-Math.floor(_.y);break;case ClampToEdgeWrapping:_.y=_.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.y)%2)===1?_.y=Math.ceil(_.y)-_.y:_.y=_.y-Math.floor(_.y);break}return this.flipY&&(_.y=1-_.y),_}set needsUpdate(_){_===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(_){_===!0&&this.pmremVersion++}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_=0,T=0,E=0,W=1){Vector4.prototype.isVector4=!0,this.x=_,this.y=T,this.z=E,this.w=W}get width(){return this.z}set width(_){this.z=_}get height(){return this.w}set height(_){this.w=_}set(_,T,E,W){return this.x=_,this.y=T,this.z=E,this.w=W,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this.w=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setW(_){return this.w=_,this}setComponent(_,T){switch(_){case 0:this.x=T;break;case 1:this.y=T;break;case 2:this.z=T;break;case 3:this.w=T;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w!==void 0?_.w:1,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this}addVectors(_,T){return this.x=_.x+T.x,this.y=_.y+T.y,this.z=_.z+T.z,this.w=_.w+T.w,this}addScaledVector(_,T){return this.x+=_.x*T,this.y+=_.y*T,this.z+=_.z*T,this.w+=_.w*T,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this}subVectors(_,T){return this.x=_.x-T.x,this.y=_.y-T.y,this.z=_.z-T.z,this.w=_.w-T.w,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this.w*=_.w,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}applyMatrix4(_){const T=this.x,E=this.y,W=this.z,X=this.w,q=_.elements;return this.x=q[0]*T+q[4]*E+q[8]*W+q[12]*X,this.y=q[1]*T+q[5]*E+q[9]*W+q[13]*X,this.z=q[2]*T+q[6]*E+q[10]*W+q[14]*X,this.w=q[3]*T+q[7]*E+q[11]*W+q[15]*X,this}divideScalar(_){return this.multiplyScalar(1/_)}setAxisAngleFromQuaternion(_){this.w=2*Math.acos(_.w);const T=Math.sqrt(1-_.w*_.w);return T<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_.x/T,this.y=_.y/T,this.z=_.z/T),this}setAxisAngleFromRotationMatrix(_){let T,E,W,X;const te=_.elements,ne=te[0],ae=te[4],le=te[8],ue=te[1],ge=te[5],ye=te[9],xe=te[2],Te=te[6],Ae=te[10];if(Math.abs(ae-ue)<.01&&Math.abs(le-xe)<.01&&Math.abs(ye-Te)<.01){if(Math.abs(ae+ue)<.1&&Math.abs(le+xe)<.1&&Math.abs(ye+Te)<.1&&Math.abs(ne+ge+Ae-3)<.1)return this.set(1,0,0,0),this;T=Math.PI;const Ve=(ne+1)/2,$e=(ge+1)/2,We=(Ae+1)/2,Ue=(ae+ue)/4,je=(le+xe)/4,ze=(ye+Te)/4;return Ve>$e&&Ve>We?Ve<.01?(E=0,W=.707106781,X=.707106781):(E=Math.sqrt(Ve),W=Ue/E,X=je/E):$e>We?$e<.01?(E=.707106781,W=0,X=.707106781):(W=Math.sqrt($e),E=Ue/W,X=ze/W):We<.01?(E=.707106781,W=.707106781,X=0):(X=Math.sqrt(We),E=je/X,W=ze/X),this.set(E,W,X,T),this}let Ie=Math.sqrt((Te-ye)*(Te-ye)+(le-xe)*(le-xe)+(ue-ae)*(ue-ae));return Math.abs(Ie)<.001&&(Ie=1),this.x=(Te-ye)/Ie,this.y=(le-xe)/Ie,this.z=(ue-ae)/Ie,this.w=Math.acos((ne+ge+Ae-1)/2),this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this.w=Math.min(this.w,_.w),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this}clamp(_,T){return this.x=Math.max(_.x,Math.min(T.x,this.x)),this.y=Math.max(_.y,Math.min(T.y,this.y)),this.z=Math.max(_.z,Math.min(T.z,this.z)),this.w=Math.max(_.w,Math.min(T.w,this.w)),this}clampScalar(_,T){return this.x=Math.max(_,Math.min(T,this.x)),this.y=Math.max(_,Math.min(T,this.y)),this.z=Math.max(_,Math.min(T,this.z)),this.w=Math.max(_,Math.min(T,this.w)),this}clampLength(_,T){const E=this.length();return this.divideScalar(E||1).multiplyScalar(Math.max(_,Math.min(T,E)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,T){return this.x+=(_.x-this.x)*T,this.y+=(_.y-this.y)*T,this.z+=(_.z-this.z)*T,this.w+=(_.w-this.w)*T,this}lerpVectors(_,T,E){return this.x=_.x+(T.x-_.x)*E,this.y=_.y+(T.y-_.y)*E,this.z=_.z+(T.z-_.z)*E,this.w=_.w+(T.w-_.w)*E,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w}fromArray(_,T=0){return this.x=_[T],this.y=_[T+1],this.z=_[T+2],this.w=_[T+3],this}toArray(_=[],T=0){return _[T]=this.x,_[T+1]=this.y,_[T+2]=this.z,_[T+3]=this.w,_}fromBufferAttribute(_,T){return this.x=_.getX(T),this.y=_.getY(T),this.z=_.getZ(T),this.w=_.getW(T),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher{constructor(_=1,T=1,E={}){super(),this.isRenderTarget=!0,this.width=_,this.height=T,this.depth=1,this.scissor=new Vector4(0,0,_,T),this.scissorTest=!1,this.viewport=new Vector4(0,0,_,T);const W={width:_,height:T,depth:1};E=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},E);const X=new Texture(W,E.mapping,E.wrapS,E.wrapT,E.magFilter,E.minFilter,E.format,E.type,E.anisotropy,E.colorSpace);X.flipY=!1,X.generateMipmaps=E.generateMipmaps,X.internalFormat=E.internalFormat,this.textures=[];const q=E.count;for(let Y=0;Y<q;Y++)this.textures[Y]=X.clone(),this.textures[Y].isRenderTargetTexture=!0;this.depthBuffer=E.depthBuffer,this.stencilBuffer=E.stencilBuffer,this.resolveDepthBuffer=E.resolveDepthBuffer,this.resolveStencilBuffer=E.resolveStencilBuffer,this.depthTexture=E.depthTexture,this.samples=E.samples}get texture(){return this.textures[0]}set texture(_){this.textures[0]=_}setSize(_,T,E=1){if(this.width!==_||this.height!==T||this.depth!==E){this.width=_,this.height=T,this.depth=E;for(let W=0,X=this.textures.length;W<X;W++)this.textures[W].image.width=_,this.textures[W].image.height=T,this.textures[W].image.depth=E;this.dispose()}this.viewport.set(0,0,_,T),this.scissor.set(0,0,_,T)}clone(){return new this.constructor().copy(this)}copy(_){this.width=_.width,this.height=_.height,this.depth=_.depth,this.scissor.copy(_.scissor),this.scissorTest=_.scissorTest,this.viewport.copy(_.viewport),this.textures.length=0;for(let E=0,W=_.textures.length;E<W;E++)this.textures[E]=_.textures[E].clone(),this.textures[E].isRenderTargetTexture=!0;const T=Object.assign({},_.texture.image);return this.texture.source=new Source(T),this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,this.resolveDepthBuffer=_.resolveDepthBuffer,this.resolveStencilBuffer=_.resolveStencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.samples=_.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(_=1,T=1,E={}){super(_,T,E),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture{constructor(_=null,T=1,E=1,W=1){super(null),this.isDataArrayTexture=!0,this.image={data:_,width:T,height:E,depth:W},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(_=1,T=1,E=1,W={}){super(_,T,W),this.isWebGLArrayRenderTarget=!0,this.depth=E,this.texture=new DataArrayTexture(null,_,T,E),this.texture.isRenderTargetTexture=!0}}class Data3DTexture extends Texture{constructor(_=null,T=1,E=1,W=1){super(null),this.isData3DTexture=!0,this.image={data:_,width:T,height:E,depth:W},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(_=1,T=1,E=1,W={}){super(_,T,W),this.isWebGL3DRenderTarget=!0,this.depth=E,this.texture=new Data3DTexture(null,_,T,E),this.texture.isRenderTargetTexture=!0}}class Quaternion{constructor(_=0,T=0,E=0,W=1){this.isQuaternion=!0,this._x=_,this._y=T,this._z=E,this._w=W}static slerpFlat(_,T,E,W,X,q,Y){let te=E[W+0],ne=E[W+1],ae=E[W+2],le=E[W+3];const ue=X[q+0],ge=X[q+1],ye=X[q+2],xe=X[q+3];if(Y===0){_[T+0]=te,_[T+1]=ne,_[T+2]=ae,_[T+3]=le;return}if(Y===1){_[T+0]=ue,_[T+1]=ge,_[T+2]=ye,_[T+3]=xe;return}if(le!==xe||te!==ue||ne!==ge||ae!==ye){let Te=1-Y;const Ae=te*ue+ne*ge+ae*ye+le*xe,Ie=Ae>=0?1:-1,Ve=1-Ae*Ae;if(Ve>Number.EPSILON){const We=Math.sqrt(Ve),Ue=Math.atan2(We,Ae*Ie);Te=Math.sin(Te*Ue)/We,Y=Math.sin(Y*Ue)/We}const $e=Y*Ie;if(te=te*Te+ue*$e,ne=ne*Te+ge*$e,ae=ae*Te+ye*$e,le=le*Te+xe*$e,Te===1-Y){const We=1/Math.sqrt(te*te+ne*ne+ae*ae+le*le);te*=We,ne*=We,ae*=We,le*=We}}_[T]=te,_[T+1]=ne,_[T+2]=ae,_[T+3]=le}static multiplyQuaternionsFlat(_,T,E,W,X,q){const Y=E[W],te=E[W+1],ne=E[W+2],ae=E[W+3],le=X[q],ue=X[q+1],ge=X[q+2],ye=X[q+3];return _[T]=Y*ye+ae*le+te*ge-ne*ue,_[T+1]=te*ye+ae*ue+ne*le-Y*ge,_[T+2]=ne*ye+ae*ge+Y*ue-te*le,_[T+3]=ae*ye-Y*le-te*ue-ne*ge,_}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get w(){return this._w}set w(_){this._w=_,this._onChangeCallback()}set(_,T,E,W){return this._x=_,this._y=T,this._z=E,this._w=W,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_){return this._x=_.x,this._y=_.y,this._z=_.z,this._w=_.w,this._onChangeCallback(),this}setFromEuler(_,T=!0){const E=_._x,W=_._y,X=_._z,q=_._order,Y=Math.cos,te=Math.sin,ne=Y(E/2),ae=Y(W/2),le=Y(X/2),ue=te(E/2),ge=te(W/2),ye=te(X/2);switch(q){case"XYZ":this._x=ue*ae*le+ne*ge*ye,this._y=ne*ge*le-ue*ae*ye,this._z=ne*ae*ye+ue*ge*le,this._w=ne*ae*le-ue*ge*ye;break;case"YXZ":this._x=ue*ae*le+ne*ge*ye,this._y=ne*ge*le-ue*ae*ye,this._z=ne*ae*ye-ue*ge*le,this._w=ne*ae*le+ue*ge*ye;break;case"ZXY":this._x=ue*ae*le-ne*ge*ye,this._y=ne*ge*le+ue*ae*ye,this._z=ne*ae*ye+ue*ge*le,this._w=ne*ae*le-ue*ge*ye;break;case"ZYX":this._x=ue*ae*le-ne*ge*ye,this._y=ne*ge*le+ue*ae*ye,this._z=ne*ae*ye-ue*ge*le,this._w=ne*ae*le+ue*ge*ye;break;case"YZX":this._x=ue*ae*le+ne*ge*ye,this._y=ne*ge*le+ue*ae*ye,this._z=ne*ae*ye-ue*ge*le,this._w=ne*ae*le-ue*ge*ye;break;case"XZY":this._x=ue*ae*le-ne*ge*ye,this._y=ne*ge*le-ue*ae*ye,this._z=ne*ae*ye+ue*ge*le,this._w=ne*ae*le+ue*ge*ye;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+q)}return T===!0&&this._onChangeCallback(),this}setFromAxisAngle(_,T){const E=T/2,W=Math.sin(E);return this._x=_.x*W,this._y=_.y*W,this._z=_.z*W,this._w=Math.cos(E),this._onChangeCallback(),this}setFromRotationMatrix(_){const T=_.elements,E=T[0],W=T[4],X=T[8],q=T[1],Y=T[5],te=T[9],ne=T[2],ae=T[6],le=T[10],ue=E+Y+le;if(ue>0){const ge=.5/Math.sqrt(ue+1);this._w=.25/ge,this._x=(ae-te)*ge,this._y=(X-ne)*ge,this._z=(q-W)*ge}else if(E>Y&&E>le){const ge=2*Math.sqrt(1+E-Y-le);this._w=(ae-te)/ge,this._x=.25*ge,this._y=(W+q)/ge,this._z=(X+ne)/ge}else if(Y>le){const ge=2*Math.sqrt(1+Y-E-le);this._w=(X-ne)/ge,this._x=(W+q)/ge,this._y=.25*ge,this._z=(te+ae)/ge}else{const ge=2*Math.sqrt(1+le-E-Y);this._w=(q-W)/ge,this._x=(X+ne)/ge,this._y=(te+ae)/ge,this._z=.25*ge}return this._onChangeCallback(),this}setFromUnitVectors(_,T){let E=_.dot(T)+1;return E<Number.EPSILON?(E=0,Math.abs(_.x)>Math.abs(_.z)?(this._x=-_.y,this._y=_.x,this._z=0,this._w=E):(this._x=0,this._y=-_.z,this._z=_.y,this._w=E)):(this._x=_.y*T.z-_.z*T.y,this._y=_.z*T.x-_.x*T.z,this._z=_.x*T.y-_.y*T.x,this._w=E),this.normalize()}angleTo(_){return 2*Math.acos(Math.abs(clamp$1(this.dot(_),-1,1)))}rotateTowards(_,T){const E=this.angleTo(_);if(E===0)return this;const W=Math.min(1,T/E);return this.slerp(_,W),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_){return this._x*_._x+this._y*_._y+this._z*_._z+this._w*_._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _=this.length();return _===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_=1/_,this._x=this._x*_,this._y=this._y*_,this._z=this._z*_,this._w=this._w*_),this._onChangeCallback(),this}multiply(_){return this.multiplyQuaternions(this,_)}premultiply(_){return this.multiplyQuaternions(_,this)}multiplyQuaternions(_,T){const E=_._x,W=_._y,X=_._z,q=_._w,Y=T._x,te=T._y,ne=T._z,ae=T._w;return this._x=E*ae+q*Y+W*ne-X*te,this._y=W*ae+q*te+X*Y-E*ne,this._z=X*ae+q*ne+E*te-W*Y,this._w=q*ae-E*Y-W*te-X*ne,this._onChangeCallback(),this}slerp(_,T){if(T===0)return this;if(T===1)return this.copy(_);const E=this._x,W=this._y,X=this._z,q=this._w;let Y=q*_._w+E*_._x+W*_._y+X*_._z;if(Y<0?(this._w=-_._w,this._x=-_._x,this._y=-_._y,this._z=-_._z,Y=-Y):this.copy(_),Y>=1)return this._w=q,this._x=E,this._y=W,this._z=X,this;const te=1-Y*Y;if(te<=Number.EPSILON){const ge=1-T;return this._w=ge*q+T*this._w,this._x=ge*E+T*this._x,this._y=ge*W+T*this._y,this._z=ge*X+T*this._z,this.normalize(),this}const ne=Math.sqrt(te),ae=Math.atan2(ne,Y),le=Math.sin((1-T)*ae)/ne,ue=Math.sin(T*ae)/ne;return this._w=q*le+this._w*ue,this._x=E*le+this._x*ue,this._y=W*le+this._y*ue,this._z=X*le+this._z*ue,this._onChangeCallback(),this}slerpQuaternions(_,T,E){return this.copy(_).slerp(T,E)}random(){const _=2*Math.PI*Math.random(),T=2*Math.PI*Math.random(),E=Math.random(),W=Math.sqrt(1-E),X=Math.sqrt(E);return this.set(W*Math.sin(_),W*Math.cos(_),X*Math.sin(T),X*Math.cos(T))}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._w===this._w}fromArray(_,T=0){return this._x=_[T],this._y=_[T+1],this._z=_[T+2],this._w=_[T+3],this._onChangeCallback(),this}toArray(_=[],T=0){return _[T]=this._x,_[T+1]=this._y,_[T+2]=this._z,_[T+3]=this._w,_}fromBufferAttribute(_,T){return this._x=_.getX(T),this._y=_.getY(T),this._z=_.getZ(T),this._w=_.getW(T),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_=0,T=0,E=0){Vector3.prototype.isVector3=!0,this.x=_,this.y=T,this.z=E}set(_,T,E){return E===void 0&&(E=this.z),this.x=_,this.y=T,this.z=E,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setComponent(_,T){switch(_){case 0:this.x=T;break;case 1:this.y=T;break;case 2:this.z=T;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this}addVectors(_,T){return this.x=_.x+T.x,this.y=_.y+T.y,this.z=_.z+T.z,this}addScaledVector(_,T){return this.x+=_.x*T,this.y+=_.y*T,this.z+=_.z*T,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this}subVectors(_,T){return this.x=_.x-T.x,this.y=_.y-T.y,this.z=_.z-T.z,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}multiplyVectors(_,T){return this.x=_.x*T.x,this.y=_.y*T.y,this.z=_.z*T.z,this}applyEuler(_){return this.applyQuaternion(_quaternion$4.setFromEuler(_))}applyAxisAngle(_,T){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_,T))}applyMatrix3(_){const T=this.x,E=this.y,W=this.z,X=_.elements;return this.x=X[0]*T+X[3]*E+X[6]*W,this.y=X[1]*T+X[4]*E+X[7]*W,this.z=X[2]*T+X[5]*E+X[8]*W,this}applyNormalMatrix(_){return this.applyMatrix3(_).normalize()}applyMatrix4(_){const T=this.x,E=this.y,W=this.z,X=_.elements,q=1/(X[3]*T+X[7]*E+X[11]*W+X[15]);return this.x=(X[0]*T+X[4]*E+X[8]*W+X[12])*q,this.y=(X[1]*T+X[5]*E+X[9]*W+X[13])*q,this.z=(X[2]*T+X[6]*E+X[10]*W+X[14])*q,this}applyQuaternion(_){const T=this.x,E=this.y,W=this.z,X=_.x,q=_.y,Y=_.z,te=_.w,ne=2*(q*W-Y*E),ae=2*(Y*T-X*W),le=2*(X*E-q*T);return this.x=T+te*ne+q*le-Y*ae,this.y=E+te*ae+Y*ne-X*le,this.z=W+te*le+X*ae-q*ne,this}project(_){return this.applyMatrix4(_.matrixWorldInverse).applyMatrix4(_.projectionMatrix)}unproject(_){return this.applyMatrix4(_.projectionMatrixInverse).applyMatrix4(_.matrixWorld)}transformDirection(_){const T=this.x,E=this.y,W=this.z,X=_.elements;return this.x=X[0]*T+X[4]*E+X[8]*W,this.y=X[1]*T+X[5]*E+X[9]*W,this.z=X[2]*T+X[6]*E+X[10]*W,this.normalize()}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this}divideScalar(_){return this.multiplyScalar(1/_)}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}clamp(_,T){return this.x=Math.max(_.x,Math.min(T.x,this.x)),this.y=Math.max(_.y,Math.min(T.y,this.y)),this.z=Math.max(_.z,Math.min(T.z,this.z)),this}clampScalar(_,T){return this.x=Math.max(_,Math.min(T,this.x)),this.y=Math.max(_,Math.min(T,this.y)),this.z=Math.max(_,Math.min(T,this.z)),this}clampLength(_,T){const E=this.length();return this.divideScalar(E||1).multiplyScalar(Math.max(_,Math.min(T,E)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,T){return this.x+=(_.x-this.x)*T,this.y+=(_.y-this.y)*T,this.z+=(_.z-this.z)*T,this}lerpVectors(_,T,E){return this.x=_.x+(T.x-_.x)*E,this.y=_.y+(T.y-_.y)*E,this.z=_.z+(T.z-_.z)*E,this}cross(_){return this.crossVectors(this,_)}crossVectors(_,T){const E=_.x,W=_.y,X=_.z,q=T.x,Y=T.y,te=T.z;return this.x=W*te-X*Y,this.y=X*q-E*te,this.z=E*Y-W*q,this}projectOnVector(_){const T=_.lengthSq();if(T===0)return this.set(0,0,0);const E=_.dot(this)/T;return this.copy(_).multiplyScalar(E)}projectOnPlane(_){return _vector$c.copy(this).projectOnVector(_),this.sub(_vector$c)}reflect(_){return this.sub(_vector$c.copy(_).multiplyScalar(2*this.dot(_)))}angleTo(_){const T=Math.sqrt(this.lengthSq()*_.lengthSq());if(T===0)return Math.PI/2;const E=this.dot(_)/T;return Math.acos(clamp$1(E,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const T=this.x-_.x,E=this.y-_.y,W=this.z-_.z;return T*T+E*E+W*W}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)+Math.abs(this.z-_.z)}setFromSpherical(_){return this.setFromSphericalCoords(_.radius,_.phi,_.theta)}setFromSphericalCoords(_,T,E){const W=Math.sin(T)*_;return this.x=W*Math.sin(E),this.y=Math.cos(T)*_,this.z=W*Math.cos(E),this}setFromCylindrical(_){return this.setFromCylindricalCoords(_.radius,_.theta,_.y)}setFromCylindricalCoords(_,T,E){return this.x=_*Math.sin(T),this.y=E,this.z=_*Math.cos(T),this}setFromMatrixPosition(_){const T=_.elements;return this.x=T[12],this.y=T[13],this.z=T[14],this}setFromMatrixScale(_){const T=this.setFromMatrixColumn(_,0).length(),E=this.setFromMatrixColumn(_,1).length(),W=this.setFromMatrixColumn(_,2).length();return this.x=T,this.y=E,this.z=W,this}setFromMatrixColumn(_,T){return this.fromArray(_.elements,T*4)}setFromMatrix3Column(_,T){return this.fromArray(_.elements,T*3)}setFromEuler(_){return this.x=_._x,this.y=_._y,this.z=_._z,this}setFromColor(_){return this.x=_.r,this.y=_.g,this.z=_.b,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z}fromArray(_,T=0){return this.x=_[T],this.y=_[T+1],this.z=_[T+2],this}toArray(_=[],T=0){return _[T]=this.x,_[T+1]=this.y,_[T+2]=this.z,_}fromBufferAttribute(_,T){return this.x=_.getX(T),this.y=_.getY(T),this.z=_.getZ(T),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _=Math.random()*Math.PI*2,T=Math.random()*2-1,E=Math.sqrt(1-T*T);return this.x=E*Math.cos(_),this.y=T,this.z=E*Math.sin(_),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(_=new Vector3(1/0,1/0,1/0),T=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_,this.max=T}set(_,T){return this.min.copy(_),this.max.copy(T),this}setFromArray(_){this.makeEmpty();for(let T=0,E=_.length;T<E;T+=3)this.expandByPoint(_vector$b.fromArray(_,T));return this}setFromBufferAttribute(_){this.makeEmpty();for(let T=0,E=_.count;T<E;T++)this.expandByPoint(_vector$b.fromBufferAttribute(_,T));return this}setFromPoints(_){this.makeEmpty();for(let T=0,E=_.length;T<E;T++)this.expandByPoint(_[T]);return this}setFromCenterAndSize(_,T){const E=_vector$b.copy(T).multiplyScalar(.5);return this.min.copy(_).sub(E),this.max.copy(_).add(E),this}setFromObject(_,T=!1){return this.makeEmpty(),this.expandByObject(_,T)}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_){return this.isEmpty()?_.set(0,0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}expandByObject(_,T=!1){_.updateWorldMatrix(!1,!1);const E=_.geometry;if(E!==void 0){const X=E.getAttribute("position");if(T===!0&&X!==void 0&&_.isInstancedMesh!==!0)for(let q=0,Y=X.count;q<Y;q++)_.isMesh===!0?_.getVertexPosition(q,_vector$b):_vector$b.fromBufferAttribute(X,q),_vector$b.applyMatrix4(_.matrixWorld),this.expandByPoint(_vector$b);else _.boundingBox!==void 0?(_.boundingBox===null&&_.computeBoundingBox(),_box$4.copy(_.boundingBox)):(E.boundingBox===null&&E.computeBoundingBox(),_box$4.copy(E.boundingBox)),_box$4.applyMatrix4(_.matrixWorld),this.union(_box$4)}const W=_.children;for(let X=0,q=W.length;X<q;X++)this.expandByObject(W[X],T);return this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y||_.z<this.min.z||_.z>this.max.z)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z}getParameter(_,T){return T.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y||_.max.z<this.min.z||_.min.z>this.max.z)}intersectsSphere(_){return this.clampPoint(_.center,_vector$b),_vector$b.distanceToSquared(_.center)<=_.radius*_.radius}intersectsPlane(_){let T,E;return _.normal.x>0?(T=_.normal.x*this.min.x,E=_.normal.x*this.max.x):(T=_.normal.x*this.max.x,E=_.normal.x*this.min.x),_.normal.y>0?(T+=_.normal.y*this.min.y,E+=_.normal.y*this.max.y):(T+=_.normal.y*this.max.y,E+=_.normal.y*this.min.y),_.normal.z>0?(T+=_.normal.z*this.min.z,E+=_.normal.z*this.max.z):(T+=_.normal.z*this.max.z,E+=_.normal.z*this.min.z),T<=-_.constant&&E>=-_.constant}intersectsTriangle(_){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_.a,_center),_v1$7.subVectors(_.b,_center),_v2$4.subVectors(_.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let T=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(T,_v0$2,_v1$7,_v2$4,_extents)||(T=[1,0,0,0,1,0,0,0,1],!satForAxes(T,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),T=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(T,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_,T){return T.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$b).distanceTo(_)}getBoundingSphere(_){return this.isEmpty()?_.makeEmpty():(this.getCenter(_.center),_.radius=this.getSize(_vector$b).length()*.5),_}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}applyMatrix4(_){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_),this.setFromPoints(_points),this)}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(B,_,T,E,W){for(let X=0,q=B.length-3;X<=q;X+=3){_testAxis.fromArray(B,X);const Y=W.x*Math.abs(_testAxis.x)+W.y*Math.abs(_testAxis.y)+W.z*Math.abs(_testAxis.z),te=_.dot(_testAxis),ne=T.dot(_testAxis),ae=E.dot(_testAxis);if(Math.max(-Math.max(te,ne,ae),Math.min(te,ne,ae))>Y)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(_=new Vector3,T=-1){this.isSphere=!0,this.center=_,this.radius=T}set(_,T){return this.center.copy(_),this.radius=T,this}setFromPoints(_,T){const E=this.center;T!==void 0?E.copy(T):_box$3.setFromPoints(_).getCenter(E);let W=0;for(let X=0,q=_.length;X<q;X++)W=Math.max(W,E.distanceToSquared(_[X]));return this.radius=Math.sqrt(W),this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_){return _.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_){return _.distanceTo(this.center)-this.radius}intersectsSphere(_){const T=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=T*T}intersectsBox(_){return _.intersectsSphere(this)}intersectsPlane(_){return Math.abs(_.distanceToPoint(this.center))<=this.radius}clampPoint(_,T){const E=this.center.distanceToSquared(_);return T.copy(_),E>this.radius*this.radius&&(T.sub(this.center).normalize(),T.multiplyScalar(this.radius).add(this.center)),T}getBoundingBox(_){return this.isEmpty()?(_.makeEmpty(),_):(_.set(this.center,this.center),_.expandByScalar(this.radius),_)}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}expandByPoint(_){if(this.isEmpty())return this.center.copy(_),this.radius=0,this;_v1$6.subVectors(_,this.center);const T=_v1$6.lengthSq();if(T>this.radius*this.radius){const E=Math.sqrt(T),W=(E-this.radius)*.5;this.center.addScaledVector(_v1$6,W/E),this.radius+=W}return this}union(_){return _.isEmpty()?this:this.isEmpty()?(this.copy(_),this):(this.center.equals(_.center)===!0?this.radius=Math.max(this.radius,_.radius):(_v2$3.subVectors(_.center,this.center).setLength(_.radius),this.expandByPoint(_v1$6.copy(_.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_.center).sub(_v2$3))),this)}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(_=new Vector3,T=new Vector3(0,0,-1)){this.origin=_,this.direction=T}set(_,T){return this.origin.copy(_),this.direction.copy(T),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,T){return T.copy(this.origin).addScaledVector(this.direction,_)}lookAt(_){return this.direction.copy(_).sub(this.origin).normalize(),this}recast(_){return this.origin.copy(this.at(_,_vector$a)),this}closestPointToPoint(_,T){T.subVectors(_,this.origin);const E=T.dot(this.direction);return E<0?T.copy(this.origin):T.copy(this.origin).addScaledVector(this.direction,E)}distanceToPoint(_){return Math.sqrt(this.distanceSqToPoint(_))}distanceSqToPoint(_){const T=_vector$a.subVectors(_,this.origin).dot(this.direction);return T<0?this.origin.distanceToSquared(_):(_vector$a.copy(this.origin).addScaledVector(this.direction,T),_vector$a.distanceToSquared(_))}distanceSqToSegment(_,T,E,W){_segCenter.copy(_).add(T).multiplyScalar(.5),_segDir.copy(T).sub(_).normalize(),_diff.copy(this.origin).sub(_segCenter);const X=_.distanceTo(T)*.5,q=-this.direction.dot(_segDir),Y=_diff.dot(this.direction),te=-_diff.dot(_segDir),ne=_diff.lengthSq(),ae=Math.abs(1-q*q);let le,ue,ge,ye;if(ae>0)if(le=q*te-Y,ue=q*Y-te,ye=X*ae,le>=0)if(ue>=-ye)if(ue<=ye){const xe=1/ae;le*=xe,ue*=xe,ge=le*(le+q*ue+2*Y)+ue*(q*le+ue+2*te)+ne}else ue=X,le=Math.max(0,-(q*ue+Y)),ge=-le*le+ue*(ue+2*te)+ne;else ue=-X,le=Math.max(0,-(q*ue+Y)),ge=-le*le+ue*(ue+2*te)+ne;else ue<=-ye?(le=Math.max(0,-(-q*X+Y)),ue=le>0?-X:Math.min(Math.max(-X,-te),X),ge=-le*le+ue*(ue+2*te)+ne):ue<=ye?(le=0,ue=Math.min(Math.max(-X,-te),X),ge=ue*(ue+2*te)+ne):(le=Math.max(0,-(q*X+Y)),ue=le>0?X:Math.min(Math.max(-X,-te),X),ge=-le*le+ue*(ue+2*te)+ne);else ue=q>0?-X:X,le=Math.max(0,-(q*ue+Y)),ge=-le*le+ue*(ue+2*te)+ne;return E&&E.copy(this.origin).addScaledVector(this.direction,le),W&&W.copy(_segCenter).addScaledVector(_segDir,ue),ge}intersectSphere(_,T){_vector$a.subVectors(_.center,this.origin);const E=_vector$a.dot(this.direction),W=_vector$a.dot(_vector$a)-E*E,X=_.radius*_.radius;if(W>X)return null;const q=Math.sqrt(X-W),Y=E-q,te=E+q;return te<0?null:Y<0?this.at(te,T):this.at(Y,T)}intersectsSphere(_){return this.distanceSqToPoint(_.center)<=_.radius*_.radius}distanceToPlane(_){const T=_.normal.dot(this.direction);if(T===0)return _.distanceToPoint(this.origin)===0?0:null;const E=-(this.origin.dot(_.normal)+_.constant)/T;return E>=0?E:null}intersectPlane(_,T){const E=this.distanceToPlane(_);return E===null?null:this.at(E,T)}intersectsPlane(_){const T=_.distanceToPoint(this.origin);return T===0||_.normal.dot(this.direction)*T<0}intersectBox(_,T){let E,W,X,q,Y,te;const ne=1/this.direction.x,ae=1/this.direction.y,le=1/this.direction.z,ue=this.origin;return ne>=0?(E=(_.min.x-ue.x)*ne,W=(_.max.x-ue.x)*ne):(E=(_.max.x-ue.x)*ne,W=(_.min.x-ue.x)*ne),ae>=0?(X=(_.min.y-ue.y)*ae,q=(_.max.y-ue.y)*ae):(X=(_.max.y-ue.y)*ae,q=(_.min.y-ue.y)*ae),E>q||X>W||((X>E||isNaN(E))&&(E=X),(q<W||isNaN(W))&&(W=q),le>=0?(Y=(_.min.z-ue.z)*le,te=(_.max.z-ue.z)*le):(Y=(_.max.z-ue.z)*le,te=(_.min.z-ue.z)*le),E>te||Y>W)||((Y>E||E!==E)&&(E=Y),(te<W||W!==W)&&(W=te),W<0)?null:this.at(E>=0?E:W,T)}intersectsBox(_){return this.intersectBox(_,_vector$a)!==null}intersectTriangle(_,T,E,W,X){_edge1.subVectors(T,_),_edge2.subVectors(E,_),_normal$1.crossVectors(_edge1,_edge2);let q=this.direction.dot(_normal$1),Y;if(q>0){if(W)return null;Y=1}else if(q<0)Y=-1,q=-q;else return null;_diff.subVectors(this.origin,_);const te=Y*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(te<0)return null;const ne=Y*this.direction.dot(_edge1.cross(_diff));if(ne<0||te+ne>q)return null;const ae=-Y*_diff.dot(_normal$1);return ae<0?null:this.at(ae/q,X)}applyMatrix4(_){return this.origin.applyMatrix4(_),this.direction.transformDirection(_),this}equals(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(_,T,E,W,X,q,Y,te,ne,ae,le,ue,ge,ye,xe,Te){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_!==void 0&&this.set(_,T,E,W,X,q,Y,te,ne,ae,le,ue,ge,ye,xe,Te)}set(_,T,E,W,X,q,Y,te,ne,ae,le,ue,ge,ye,xe,Te){const Ae=this.elements;return Ae[0]=_,Ae[4]=T,Ae[8]=E,Ae[12]=W,Ae[1]=X,Ae[5]=q,Ae[9]=Y,Ae[13]=te,Ae[2]=ne,Ae[6]=ae,Ae[10]=le,Ae[14]=ue,Ae[3]=ge,Ae[7]=ye,Ae[11]=xe,Ae[15]=Te,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_){const T=this.elements,E=_.elements;return T[0]=E[0],T[1]=E[1],T[2]=E[2],T[3]=E[3],T[4]=E[4],T[5]=E[5],T[6]=E[6],T[7]=E[7],T[8]=E[8],T[9]=E[9],T[10]=E[10],T[11]=E[11],T[12]=E[12],T[13]=E[13],T[14]=E[14],T[15]=E[15],this}copyPosition(_){const T=this.elements,E=_.elements;return T[12]=E[12],T[13]=E[13],T[14]=E[14],this}setFromMatrix3(_){const T=_.elements;return this.set(T[0],T[3],T[6],0,T[1],T[4],T[7],0,T[2],T[5],T[8],0,0,0,0,1),this}extractBasis(_,T,E){return _.setFromMatrixColumn(this,0),T.setFromMatrixColumn(this,1),E.setFromMatrixColumn(this,2),this}makeBasis(_,T,E){return this.set(_.x,T.x,E.x,0,_.y,T.y,E.y,0,_.z,T.z,E.z,0,0,0,0,1),this}extractRotation(_){const T=this.elements,E=_.elements,W=1/_v1$5.setFromMatrixColumn(_,0).length(),X=1/_v1$5.setFromMatrixColumn(_,1).length(),q=1/_v1$5.setFromMatrixColumn(_,2).length();return T[0]=E[0]*W,T[1]=E[1]*W,T[2]=E[2]*W,T[3]=0,T[4]=E[4]*X,T[5]=E[5]*X,T[6]=E[6]*X,T[7]=0,T[8]=E[8]*q,T[9]=E[9]*q,T[10]=E[10]*q,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,this}makeRotationFromEuler(_){const T=this.elements,E=_.x,W=_.y,X=_.z,q=Math.cos(E),Y=Math.sin(E),te=Math.cos(W),ne=Math.sin(W),ae=Math.cos(X),le=Math.sin(X);if(_.order==="XYZ"){const ue=q*ae,ge=q*le,ye=Y*ae,xe=Y*le;T[0]=te*ae,T[4]=-te*le,T[8]=ne,T[1]=ge+ye*ne,T[5]=ue-xe*ne,T[9]=-Y*te,T[2]=xe-ue*ne,T[6]=ye+ge*ne,T[10]=q*te}else if(_.order==="YXZ"){const ue=te*ae,ge=te*le,ye=ne*ae,xe=ne*le;T[0]=ue+xe*Y,T[4]=ye*Y-ge,T[8]=q*ne,T[1]=q*le,T[5]=q*ae,T[9]=-Y,T[2]=ge*Y-ye,T[6]=xe+ue*Y,T[10]=q*te}else if(_.order==="ZXY"){const ue=te*ae,ge=te*le,ye=ne*ae,xe=ne*le;T[0]=ue-xe*Y,T[4]=-q*le,T[8]=ye+ge*Y,T[1]=ge+ye*Y,T[5]=q*ae,T[9]=xe-ue*Y,T[2]=-q*ne,T[6]=Y,T[10]=q*te}else if(_.order==="ZYX"){const ue=q*ae,ge=q*le,ye=Y*ae,xe=Y*le;T[0]=te*ae,T[4]=ye*ne-ge,T[8]=ue*ne+xe,T[1]=te*le,T[5]=xe*ne+ue,T[9]=ge*ne-ye,T[2]=-ne,T[6]=Y*te,T[10]=q*te}else if(_.order==="YZX"){const ue=q*te,ge=q*ne,ye=Y*te,xe=Y*ne;T[0]=te*ae,T[4]=xe-ue*le,T[8]=ye*le+ge,T[1]=le,T[5]=q*ae,T[9]=-Y*ae,T[2]=-ne*ae,T[6]=ge*le+ye,T[10]=ue-xe*le}else if(_.order==="XZY"){const ue=q*te,ge=q*ne,ye=Y*te,xe=Y*ne;T[0]=te*ae,T[4]=-le,T[8]=ne*ae,T[1]=ue*le+xe,T[5]=q*ae,T[9]=ge*le-ye,T[2]=ye*le-ge,T[6]=Y*ae,T[10]=xe*le+ue}return T[3]=0,T[7]=0,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,this}makeRotationFromQuaternion(_){return this.compose(_zero,_,_one)}lookAt(_,T,E){const W=this.elements;return _z.subVectors(_,T),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(E,_z),_x.lengthSq()===0&&(Math.abs(E.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(E,_z)),_x.normalize(),_y.crossVectors(_z,_x),W[0]=_x.x,W[4]=_y.x,W[8]=_z.x,W[1]=_x.y,W[5]=_y.y,W[9]=_z.y,W[2]=_x.z,W[6]=_y.z,W[10]=_z.z,this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,T){const E=_.elements,W=T.elements,X=this.elements,q=E[0],Y=E[4],te=E[8],ne=E[12],ae=E[1],le=E[5],ue=E[9],ge=E[13],ye=E[2],xe=E[6],Te=E[10],Ae=E[14],Ie=E[3],Ve=E[7],$e=E[11],We=E[15],Ue=W[0],je=W[4],ze=W[8],He=W[12],Le=W[1],qe=W[5],Qe=W[9],Ke=W[13],Je=W[2],pt=W[6],ut=W[10],lt=W[14],st=W[3],sr=W[7],mt=W[11],Tr=W[15];return X[0]=q*Ue+Y*Le+te*Je+ne*st,X[4]=q*je+Y*qe+te*pt+ne*sr,X[8]=q*ze+Y*Qe+te*ut+ne*mt,X[12]=q*He+Y*Ke+te*lt+ne*Tr,X[1]=ae*Ue+le*Le+ue*Je+ge*st,X[5]=ae*je+le*qe+ue*pt+ge*sr,X[9]=ae*ze+le*Qe+ue*ut+ge*mt,X[13]=ae*He+le*Ke+ue*lt+ge*Tr,X[2]=ye*Ue+xe*Le+Te*Je+Ae*st,X[6]=ye*je+xe*qe+Te*pt+Ae*sr,X[10]=ye*ze+xe*Qe+Te*ut+Ae*mt,X[14]=ye*He+xe*Ke+Te*lt+Ae*Tr,X[3]=Ie*Ue+Ve*Le+$e*Je+We*st,X[7]=Ie*je+Ve*qe+$e*pt+We*sr,X[11]=Ie*ze+Ve*Qe+$e*ut+We*mt,X[15]=Ie*He+Ve*Ke+$e*lt+We*Tr,this}multiplyScalar(_){const T=this.elements;return T[0]*=_,T[4]*=_,T[8]*=_,T[12]*=_,T[1]*=_,T[5]*=_,T[9]*=_,T[13]*=_,T[2]*=_,T[6]*=_,T[10]*=_,T[14]*=_,T[3]*=_,T[7]*=_,T[11]*=_,T[15]*=_,this}determinant(){const _=this.elements,T=_[0],E=_[4],W=_[8],X=_[12],q=_[1],Y=_[5],te=_[9],ne=_[13],ae=_[2],le=_[6],ue=_[10],ge=_[14],ye=_[3],xe=_[7],Te=_[11],Ae=_[15];return ye*(+X*te*le-W*ne*le-X*Y*ue+E*ne*ue+W*Y*ge-E*te*ge)+xe*(+T*te*ge-T*ne*ue+X*q*ue-W*q*ge+W*ne*ae-X*te*ae)+Te*(+T*ne*le-T*Y*ge-X*q*le+E*q*ge+X*Y*ae-E*ne*ae)+Ae*(-W*Y*ae-T*te*le+T*Y*ue+W*q*le-E*q*ue+E*te*ae)}transpose(){const _=this.elements;let T;return T=_[1],_[1]=_[4],_[4]=T,T=_[2],_[2]=_[8],_[8]=T,T=_[6],_[6]=_[9],_[9]=T,T=_[3],_[3]=_[12],_[12]=T,T=_[7],_[7]=_[13],_[13]=T,T=_[11],_[11]=_[14],_[14]=T,this}setPosition(_,T,E){const W=this.elements;return _.isVector3?(W[12]=_.x,W[13]=_.y,W[14]=_.z):(W[12]=_,W[13]=T,W[14]=E),this}invert(){const _=this.elements,T=_[0],E=_[1],W=_[2],X=_[3],q=_[4],Y=_[5],te=_[6],ne=_[7],ae=_[8],le=_[9],ue=_[10],ge=_[11],ye=_[12],xe=_[13],Te=_[14],Ae=_[15],Ie=le*Te*ne-xe*ue*ne+xe*te*ge-Y*Te*ge-le*te*Ae+Y*ue*Ae,Ve=ye*ue*ne-ae*Te*ne-ye*te*ge+q*Te*ge+ae*te*Ae-q*ue*Ae,$e=ae*xe*ne-ye*le*ne+ye*Y*ge-q*xe*ge-ae*Y*Ae+q*le*Ae,We=ye*le*te-ae*xe*te-ye*Y*ue+q*xe*ue+ae*Y*Te-q*le*Te,Ue=T*Ie+E*Ve+W*$e+X*We;if(Ue===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const je=1/Ue;return _[0]=Ie*je,_[1]=(xe*ue*X-le*Te*X-xe*W*ge+E*Te*ge+le*W*Ae-E*ue*Ae)*je,_[2]=(Y*Te*X-xe*te*X+xe*W*ne-E*Te*ne-Y*W*Ae+E*te*Ae)*je,_[3]=(le*te*X-Y*ue*X-le*W*ne+E*ue*ne+Y*W*ge-E*te*ge)*je,_[4]=Ve*je,_[5]=(ae*Te*X-ye*ue*X+ye*W*ge-T*Te*ge-ae*W*Ae+T*ue*Ae)*je,_[6]=(ye*te*X-q*Te*X-ye*W*ne+T*Te*ne+q*W*Ae-T*te*Ae)*je,_[7]=(q*ue*X-ae*te*X+ae*W*ne-T*ue*ne-q*W*ge+T*te*ge)*je,_[8]=$e*je,_[9]=(ye*le*X-ae*xe*X-ye*E*ge+T*xe*ge+ae*E*Ae-T*le*Ae)*je,_[10]=(q*xe*X-ye*Y*X+ye*E*ne-T*xe*ne-q*E*Ae+T*Y*Ae)*je,_[11]=(ae*Y*X-q*le*X-ae*E*ne+T*le*ne+q*E*ge-T*Y*ge)*je,_[12]=We*je,_[13]=(ae*xe*W-ye*le*W+ye*E*ue-T*xe*ue-ae*E*Te+T*le*Te)*je,_[14]=(ye*Y*W-q*xe*W-ye*E*te+T*xe*te+q*E*Te-T*Y*Te)*je,_[15]=(q*le*W-ae*Y*W+ae*E*te-T*le*te-q*E*ue+T*Y*ue)*je,this}scale(_){const T=this.elements,E=_.x,W=_.y,X=_.z;return T[0]*=E,T[4]*=W,T[8]*=X,T[1]*=E,T[5]*=W,T[9]*=X,T[2]*=E,T[6]*=W,T[10]*=X,T[3]*=E,T[7]*=W,T[11]*=X,this}getMaxScaleOnAxis(){const _=this.elements,T=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],E=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],W=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(T,E,W))}makeTranslation(_,T,E){return _.isVector3?this.set(1,0,0,_.x,0,1,0,_.y,0,0,1,_.z,0,0,0,1):this.set(1,0,0,_,0,1,0,T,0,0,1,E,0,0,0,1),this}makeRotationX(_){const T=Math.cos(_),E=Math.sin(_);return this.set(1,0,0,0,0,T,-E,0,0,E,T,0,0,0,0,1),this}makeRotationY(_){const T=Math.cos(_),E=Math.sin(_);return this.set(T,0,E,0,0,1,0,0,-E,0,T,0,0,0,0,1),this}makeRotationZ(_){const T=Math.cos(_),E=Math.sin(_);return this.set(T,-E,0,0,E,T,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_,T){const E=Math.cos(T),W=Math.sin(T),X=1-E,q=_.x,Y=_.y,te=_.z,ne=X*q,ae=X*Y;return this.set(ne*q+E,ne*Y-W*te,ne*te+W*Y,0,ne*Y+W*te,ae*Y+E,ae*te-W*q,0,ne*te-W*Y,ae*te+W*q,X*te*te+E,0,0,0,0,1),this}makeScale(_,T,E){return this.set(_,0,0,0,0,T,0,0,0,0,E,0,0,0,0,1),this}makeShear(_,T,E,W,X,q){return this.set(1,E,X,0,_,1,q,0,T,W,1,0,0,0,0,1),this}compose(_,T,E){const W=this.elements,X=T._x,q=T._y,Y=T._z,te=T._w,ne=X+X,ae=q+q,le=Y+Y,ue=X*ne,ge=X*ae,ye=X*le,xe=q*ae,Te=q*le,Ae=Y*le,Ie=te*ne,Ve=te*ae,$e=te*le,We=E.x,Ue=E.y,je=E.z;return W[0]=(1-(xe+Ae))*We,W[1]=(ge+$e)*We,W[2]=(ye-Ve)*We,W[3]=0,W[4]=(ge-$e)*Ue,W[5]=(1-(ue+Ae))*Ue,W[6]=(Te+Ie)*Ue,W[7]=0,W[8]=(ye+Ve)*je,W[9]=(Te-Ie)*je,W[10]=(1-(ue+xe))*je,W[11]=0,W[12]=_.x,W[13]=_.y,W[14]=_.z,W[15]=1,this}decompose(_,T,E){const W=this.elements;let X=_v1$5.set(W[0],W[1],W[2]).length();const q=_v1$5.set(W[4],W[5],W[6]).length(),Y=_v1$5.set(W[8],W[9],W[10]).length();this.determinant()<0&&(X=-X),_.x=W[12],_.y=W[13],_.z=W[14],_m1$4.copy(this);const ne=1/X,ae=1/q,le=1/Y;return _m1$4.elements[0]*=ne,_m1$4.elements[1]*=ne,_m1$4.elements[2]*=ne,_m1$4.elements[4]*=ae,_m1$4.elements[5]*=ae,_m1$4.elements[6]*=ae,_m1$4.elements[8]*=le,_m1$4.elements[9]*=le,_m1$4.elements[10]*=le,T.setFromRotationMatrix(_m1$4),E.x=X,E.y=q,E.z=Y,this}makePerspective(_,T,E,W,X,q,Y=WebGLCoordinateSystem){const te=this.elements,ne=2*X/(T-_),ae=2*X/(E-W),le=(T+_)/(T-_),ue=(E+W)/(E-W);let ge,ye;if(Y===WebGLCoordinateSystem)ge=-(q+X)/(q-X),ye=-2*q*X/(q-X);else if(Y===WebGPUCoordinateSystem)ge=-q/(q-X),ye=-q*X/(q-X);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+Y);return te[0]=ne,te[4]=0,te[8]=le,te[12]=0,te[1]=0,te[5]=ae,te[9]=ue,te[13]=0,te[2]=0,te[6]=0,te[10]=ge,te[14]=ye,te[3]=0,te[7]=0,te[11]=-1,te[15]=0,this}makeOrthographic(_,T,E,W,X,q,Y=WebGLCoordinateSystem){const te=this.elements,ne=1/(T-_),ae=1/(E-W),le=1/(q-X),ue=(T+_)*ne,ge=(E+W)*ae;let ye,xe;if(Y===WebGLCoordinateSystem)ye=(q+X)*le,xe=-2*le;else if(Y===WebGPUCoordinateSystem)ye=X*le,xe=-1*le;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+Y);return te[0]=2*ne,te[4]=0,te[8]=0,te[12]=-ue,te[1]=0,te[5]=2*ae,te[9]=0,te[13]=-ge,te[2]=0,te[6]=0,te[10]=xe,te[14]=-ye,te[3]=0,te[7]=0,te[11]=0,te[15]=1,this}equals(_){const T=this.elements,E=_.elements;for(let W=0;W<16;W++)if(T[W]!==E[W])return!1;return!0}fromArray(_,T=0){for(let E=0;E<16;E++)this.elements[E]=_[E+T];return this}toArray(_=[],T=0){const E=this.elements;return _[T]=E[0],_[T+1]=E[1],_[T+2]=E[2],_[T+3]=E[3],_[T+4]=E[4],_[T+5]=E[5],_[T+6]=E[6],_[T+7]=E[7],_[T+8]=E[8],_[T+9]=E[9],_[T+10]=E[10],_[T+11]=E[11],_[T+12]=E[12],_[T+13]=E[13],_[T+14]=E[14],_[T+15]=E[15],_}}const _v1$5=new Vector3,_m1$4=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$2=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_=0,T=0,E=0,W=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_,this._y=T,this._z=E,this._order=W}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get order(){return this._order}set order(_){this._order=_,this._onChangeCallback()}set(_,T,E,W=this._order){return this._x=_,this._y=T,this._z=E,this._order=W,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this._onChangeCallback(),this}setFromRotationMatrix(_,T=this._order,E=!0){const W=_.elements,X=W[0],q=W[4],Y=W[8],te=W[1],ne=W[5],ae=W[9],le=W[2],ue=W[6],ge=W[10];switch(T){case"XYZ":this._y=Math.asin(clamp$1(Y,-1,1)),Math.abs(Y)<.9999999?(this._x=Math.atan2(-ae,ge),this._z=Math.atan2(-q,X)):(this._x=Math.atan2(ue,ne),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$1(ae,-1,1)),Math.abs(ae)<.9999999?(this._y=Math.atan2(Y,ge),this._z=Math.atan2(te,ne)):(this._y=Math.atan2(-le,X),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$1(ue,-1,1)),Math.abs(ue)<.9999999?(this._y=Math.atan2(-le,ge),this._z=Math.atan2(-q,ne)):(this._y=0,this._z=Math.atan2(te,X));break;case"ZYX":this._y=Math.asin(-clamp$1(le,-1,1)),Math.abs(le)<.9999999?(this._x=Math.atan2(ue,ge),this._z=Math.atan2(te,X)):(this._x=0,this._z=Math.atan2(-q,ne));break;case"YZX":this._z=Math.asin(clamp$1(te,-1,1)),Math.abs(te)<.9999999?(this._x=Math.atan2(-ae,ne),this._y=Math.atan2(-le,X)):(this._x=0,this._y=Math.atan2(Y,ge));break;case"XZY":this._z=Math.asin(-clamp$1(q,-1,1)),Math.abs(q)<.9999999?(this._x=Math.atan2(ue,ne),this._y=Math.atan2(Y,X)):(this._x=Math.atan2(-ae,ge),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+T)}return this._order=T,E===!0&&this._onChangeCallback(),this}setFromQuaternion(_,T,E){return _matrix$2.makeRotationFromQuaternion(_),this.setFromRotationMatrix(_matrix$2,T,E)}setFromVector3(_,T=this._order){return this.set(_.x,_.y,_.z,T)}reorder(_){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_)}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._order===this._order}fromArray(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==void 0&&(this._order=_[3]),this._onChangeCallback(),this}toArray(_=[],T=0){return _[T]=this._x,_[T+1]=this._y,_[T+2]=this._z,_[T+3]=this._order,_}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_){this.mask=(1<<_|0)>>>0}enable(_){this.mask|=1<<_|0}enableAll(){this.mask=-1}toggle(_){this.mask^=1<<_|0}disable(_){this.mask&=~(1<<_|0)}disableAll(){this.mask=0}test(_){return(this.mask&_.mask)!==0}isEnabled(_){return(this.mask&(1<<_|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$3=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"},_childaddedEvent={type:"childadded",child:null},_childremovedEvent={type:"childremoved",child:null};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _=new Vector3,T=new Euler,E=new Quaternion,W=new Vector3(1,1,1);function X(){E.setFromEuler(T,!1)}function q(){T.setFromQuaternion(E,void 0,!1)}T._onChange(X),E._onChange(q),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_},rotation:{configurable:!0,enumerable:!0,value:T},quaternion:{configurable:!0,enumerable:!0,value:E},scale:{configurable:!0,enumerable:!0,value:W},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(_){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_){return this.quaternion.premultiply(_),this}setRotationFromAxisAngle(_,T){this.quaternion.setFromAxisAngle(_,T)}setRotationFromEuler(_){this.quaternion.setFromEuler(_,!0)}setRotationFromMatrix(_){this.quaternion.setFromRotationMatrix(_)}setRotationFromQuaternion(_){this.quaternion.copy(_)}rotateOnAxis(_,T){return _q1.setFromAxisAngle(_,T),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(_,T){return _q1.setFromAxisAngle(_,T),this.quaternion.premultiply(_q1),this}rotateX(_){return this.rotateOnAxis(_xAxis,_)}rotateY(_){return this.rotateOnAxis(_yAxis,_)}rotateZ(_){return this.rotateOnAxis(_zAxis,_)}translateOnAxis(_,T){return _v1$4.copy(_).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(T)),this}translateX(_){return this.translateOnAxis(_xAxis,_)}translateY(_){return this.translateOnAxis(_yAxis,_)}translateZ(_){return this.translateOnAxis(_zAxis,_)}localToWorld(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(this.matrixWorld)}worldToLocal(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(_m1$3.copy(this.matrixWorld).invert())}lookAt(_,T,E){_.isVector3?_target.copy(_):_target.set(_,T,E);const W=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$3.lookAt(_position$3,_target,this.up):_m1$3.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$3),W&&(_m1$3.extractRotation(W.matrixWorld),_q1.setFromRotationMatrix(_m1$3),this.quaternion.premultiply(_q1.invert()))}add(_){if(arguments.length>1){for(let T=0;T<arguments.length;T++)this.add(arguments[T]);return this}return _===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_),this):(_&&_.isObject3D?(_.removeFromParent(),_.parent=this,this.children.push(_),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_),this)}remove(_){if(arguments.length>1){for(let E=0;E<arguments.length;E++)this.remove(arguments[E]);return this}const T=this.children.indexOf(_);return T!==-1&&(_.parent=null,this.children.splice(T,1),_.dispatchEvent(_removedEvent),_childremovedEvent.child=_,this.dispatchEvent(_childremovedEvent),_childremovedEvent.child=null),this}removeFromParent(){const _=this.parent;return _!==null&&_.remove(this),this}clear(){return this.remove(...this.children)}attach(_){return this.updateWorldMatrix(!0,!1),_m1$3.copy(this.matrixWorld).invert(),_.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),_m1$3.multiply(_.parent.matrixWorld)),_.applyMatrix4(_m1$3),_.removeFromParent(),_.parent=this,this.children.push(_),_.updateWorldMatrix(!1,!0),_.dispatchEvent(_addedEvent),_childaddedEvent.child=_,this.dispatchEvent(_childaddedEvent),_childaddedEvent.child=null,this}getObjectById(_){return this.getObjectByProperty("id",_)}getObjectByName(_){return this.getObjectByProperty("name",_)}getObjectByProperty(_,T){if(this[_]===T)return this;for(let E=0,W=this.children.length;E<W;E++){const q=this.children[E].getObjectByProperty(_,T);if(q!==void 0)return q}}getObjectsByProperty(_,T,E=[]){this[_]===T&&E.push(this);const W=this.children;for(let X=0,q=W.length;X<q;X++)W[X].getObjectsByProperty(_,T,E);return E}getWorldPosition(_){return this.updateWorldMatrix(!0,!1),_.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_,_scale$2),_}getWorldScale(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_),_}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const T=this.matrixWorld.elements;return _.set(T[8],T[9],T[10]).normalize()}raycast(){}traverse(_){_(this);const T=this.children;for(let E=0,W=T.length;E<W;E++)T[E].traverse(_)}traverseVisible(_){if(this.visible===!1)return;_(this);const T=this.children;for(let E=0,W=T.length;E<W;E++)T[E].traverseVisible(_)}traverseAncestors(_){const T=this.parent;T!==null&&(_(T),T.traverseAncestors(_))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_=!0);const T=this.children;for(let E=0,W=T.length;E<W;E++){const X=T[E];(X.matrixWorldAutoUpdate===!0||_===!0)&&X.updateMatrixWorld(_)}}updateWorldMatrix(_,T){const E=this.parent;if(_===!0&&E!==null&&E.matrixWorldAutoUpdate===!0&&E.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),T===!0){const W=this.children;for(let X=0,q=W.length;X<q;X++){const Y=W[X];Y.matrixWorldAutoUpdate===!0&&Y.updateWorldMatrix(!1,!0)}}}toJSON(_){const T=_===void 0||typeof _=="string",E={};T&&(_={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},E.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const W={};W.uuid=this.uuid,W.type=this.type,this.name!==""&&(W.name=this.name),this.castShadow===!0&&(W.castShadow=!0),this.receiveShadow===!0&&(W.receiveShadow=!0),this.visible===!1&&(W.visible=!1),this.frustumCulled===!1&&(W.frustumCulled=!1),this.renderOrder!==0&&(W.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(W.userData=this.userData),W.layers=this.layers.mask,W.matrix=this.matrix.toArray(),W.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(W.matrixAutoUpdate=!1),this.isInstancedMesh&&(W.type="InstancedMesh",W.count=this.count,W.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(W.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(W.type="BatchedMesh",W.perObjectFrustumCulled=this.perObjectFrustumCulled,W.sortObjects=this.sortObjects,W.drawRanges=this._drawRanges,W.reservedRanges=this._reservedRanges,W.visibility=this._visibility,W.active=this._active,W.bounds=this._bounds.map(Y=>({boxInitialized:Y.boxInitialized,boxMin:Y.box.min.toArray(),boxMax:Y.box.max.toArray(),sphereInitialized:Y.sphereInitialized,sphereRadius:Y.sphere.radius,sphereCenter:Y.sphere.center.toArray()})),W.maxGeometryCount=this._maxGeometryCount,W.maxVertexCount=this._maxVertexCount,W.maxIndexCount=this._maxIndexCount,W.geometryInitialized=this._geometryInitialized,W.geometryCount=this._geometryCount,W.matricesTexture=this._matricesTexture.toJSON(_),this.boundingSphere!==null&&(W.boundingSphere={center:W.boundingSphere.center.toArray(),radius:W.boundingSphere.radius}),this.boundingBox!==null&&(W.boundingBox={min:W.boundingBox.min.toArray(),max:W.boundingBox.max.toArray()}));function X(Y,te){return Y[te.uuid]===void 0&&(Y[te.uuid]=te.toJSON(_)),te.uuid}if(this.isScene)this.background&&(this.background.isColor?W.background=this.background.toJSON():this.background.isTexture&&(W.background=this.background.toJSON(_).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(W.environment=this.environment.toJSON(_).uuid);else if(this.isMesh||this.isLine||this.isPoints){W.geometry=X(_.geometries,this.geometry);const Y=this.geometry.parameters;if(Y!==void 0&&Y.shapes!==void 0){const te=Y.shapes;if(Array.isArray(te))for(let ne=0,ae=te.length;ne<ae;ne++){const le=te[ne];X(_.shapes,le)}else X(_.shapes,te)}}if(this.isSkinnedMesh&&(W.bindMode=this.bindMode,W.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(X(_.skeletons,this.skeleton),W.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const Y=[];for(let te=0,ne=this.material.length;te<ne;te++)Y.push(X(_.materials,this.material[te]));W.material=Y}else W.material=X(_.materials,this.material);if(this.children.length>0){W.children=[];for(let Y=0;Y<this.children.length;Y++)W.children.push(this.children[Y].toJSON(_).object)}if(this.animations.length>0){W.animations=[];for(let Y=0;Y<this.animations.length;Y++){const te=this.animations[Y];W.animations.push(X(_.animations,te))}}if(T){const Y=q(_.geometries),te=q(_.materials),ne=q(_.textures),ae=q(_.images),le=q(_.shapes),ue=q(_.skeletons),ge=q(_.animations),ye=q(_.nodes);Y.length>0&&(E.geometries=Y),te.length>0&&(E.materials=te),ne.length>0&&(E.textures=ne),ae.length>0&&(E.images=ae),le.length>0&&(E.shapes=le),ue.length>0&&(E.skeletons=ue),ge.length>0&&(E.animations=ge),ye.length>0&&(E.nodes=ye)}return E.object=W,E;function q(Y){const te=[];for(const ne in Y){const ae=Y[ne];delete ae.metadata,te.push(ae)}return te}}clone(_){return new this.constructor().copy(this,_)}copy(_,T=!0){if(this.name=_.name,this.up.copy(_.up),this.position.copy(_.position),this.rotation.order=_.rotation.order,this.quaternion.copy(_.quaternion),this.scale.copy(_.scale),this.matrix.copy(_.matrix),this.matrixWorld.copy(_.matrixWorld),this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrixWorldAutoUpdate=_.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=_.matrixWorldNeedsUpdate,this.layers.mask=_.layers.mask,this.visible=_.visible,this.castShadow=_.castShadow,this.receiveShadow=_.receiveShadow,this.frustumCulled=_.frustumCulled,this.renderOrder=_.renderOrder,this.animations=_.animations.slice(),this.userData=JSON.parse(JSON.stringify(_.userData)),T===!0)for(let E=0;E<_.children.length;E++){const W=_.children[E];this.add(W.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$2=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;class Triangle{constructor(_=new Vector3,T=new Vector3,E=new Vector3){this.a=_,this.b=T,this.c=E}static getNormal(_,T,E,W){W.subVectors(E,T),_v0$1.subVectors(_,T),W.cross(_v0$1);const X=W.lengthSq();return X>0?W.multiplyScalar(1/Math.sqrt(X)):W.set(0,0,0)}static getBarycoord(_,T,E,W,X){_v0$1.subVectors(W,T),_v1$3.subVectors(E,T),_v2$2.subVectors(_,T);const q=_v0$1.dot(_v0$1),Y=_v0$1.dot(_v1$3),te=_v0$1.dot(_v2$2),ne=_v1$3.dot(_v1$3),ae=_v1$3.dot(_v2$2),le=q*ne-Y*Y;if(le===0)return X.set(0,0,0),null;const ue=1/le,ge=(ne*te-Y*ae)*ue,ye=(q*ae-Y*te)*ue;return X.set(1-ge-ye,ye,ge)}static containsPoint(_,T,E,W){return this.getBarycoord(_,T,E,W,_v3$2)===null?!1:_v3$2.x>=0&&_v3$2.y>=0&&_v3$2.x+_v3$2.y<=1}static getInterpolation(_,T,E,W,X,q,Y,te){return this.getBarycoord(_,T,E,W,_v3$2)===null?(te.x=0,te.y=0,"z"in te&&(te.z=0),"w"in te&&(te.w=0),null):(te.setScalar(0),te.addScaledVector(X,_v3$2.x),te.addScaledVector(q,_v3$2.y),te.addScaledVector(Y,_v3$2.z),te)}static isFrontFacing(_,T,E,W){return _v0$1.subVectors(E,T),_v1$3.subVectors(_,T),_v0$1.cross(_v1$3).dot(W)<0}set(_,T,E){return this.a.copy(_),this.b.copy(T),this.c.copy(E),this}setFromPointsAndIndices(_,T,E,W){return this.a.copy(_[T]),this.b.copy(_[E]),this.c.copy(_[W]),this}setFromAttributeAndIndices(_,T,E,W){return this.a.fromBufferAttribute(_,T),this.b.fromBufferAttribute(_,E),this.c.fromBufferAttribute(_,W),this}clone(){return new this.constructor().copy(this)}copy(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_){return _.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_){return Triangle.getNormal(this.a,this.b,this.c,_)}getPlane(_){return _.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_,T){return Triangle.getBarycoord(_,this.a,this.b,this.c,T)}getInterpolation(_,T,E,W,X){return Triangle.getInterpolation(_,this.a,this.b,this.c,T,E,W,X)}containsPoint(_){return Triangle.containsPoint(_,this.a,this.b,this.c)}isFrontFacing(_){return Triangle.isFrontFacing(this.a,this.b,this.c,_)}intersectsBox(_){return _.intersectsTriangle(this)}closestPointToPoint(_,T){const E=this.a,W=this.b,X=this.c;let q,Y;_vab.subVectors(W,E),_vac.subVectors(X,E),_vap.subVectors(_,E);const te=_vab.dot(_vap),ne=_vac.dot(_vap);if(te<=0&&ne<=0)return T.copy(E);_vbp.subVectors(_,W);const ae=_vab.dot(_vbp),le=_vac.dot(_vbp);if(ae>=0&&le<=ae)return T.copy(W);const ue=te*le-ae*ne;if(ue<=0&&te>=0&&ae<=0)return q=te/(te-ae),T.copy(E).addScaledVector(_vab,q);_vcp.subVectors(_,X);const ge=_vab.dot(_vcp),ye=_vac.dot(_vcp);if(ye>=0&&ge<=ye)return T.copy(X);const xe=ge*ne-te*ye;if(xe<=0&&ne>=0&&ye<=0)return Y=ne/(ne-ye),T.copy(E).addScaledVector(_vac,Y);const Te=ae*ye-ge*le;if(Te<=0&&le-ae>=0&&ge-ye>=0)return _vbc.subVectors(X,W),Y=(le-ae)/(le-ae+(ge-ye)),T.copy(W).addScaledVector(_vbc,Y);const Ae=1/(Te+xe+ue);return q=xe*Ae,Y=ue*Ae,T.copy(E).addScaledVector(_vab,q).addScaledVector(_vac,Y)}equals(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(B,_,T){return T<0&&(T+=1),T>1&&(T-=1),T<1/6?B+(_-B)*6*T:T<1/2?_:T<2/3?B+(_-B)*6*(2/3-T):B}class Color{constructor(_,T,E){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(_,T,E)}set(_,T,E){if(T===void 0&&E===void 0){const W=_;W&&W.isColor?this.copy(W):typeof W=="number"?this.setHex(W):typeof W=="string"&&this.setStyle(W)}else this.setRGB(_,T,E);return this}setScalar(_){return this.r=_,this.g=_,this.b=_,this}setHex(_,T=SRGBColorSpace){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,ColorManagement.toWorkingColorSpace(this,T),this}setRGB(_,T,E,W=ColorManagement.workingColorSpace){return this.r=_,this.g=T,this.b=E,ColorManagement.toWorkingColorSpace(this,W),this}setHSL(_,T,E,W=ColorManagement.workingColorSpace){if(_=euclideanModulo(_,1),T=clamp$1(T,0,1),E=clamp$1(E,0,1),T===0)this.r=this.g=this.b=E;else{const X=E<=.5?E*(1+T):E+T-E*T,q=2*E-X;this.r=hue2rgb(q,X,_+1/3),this.g=hue2rgb(q,X,_),this.b=hue2rgb(q,X,_-1/3)}return ColorManagement.toWorkingColorSpace(this,W),this}setStyle(_,T=SRGBColorSpace){function E(X){X!==void 0&&parseFloat(X)<1&&console.warn("THREE.Color: Alpha component of "+_+" will be ignored.")}let W;if(W=/^(\w+)\(([^\)]*)\)/.exec(_)){let X;const q=W[1],Y=W[2];switch(q){case"rgb":case"rgba":if(X=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Y))return E(X[4]),this.setRGB(Math.min(255,parseInt(X[1],10))/255,Math.min(255,parseInt(X[2],10))/255,Math.min(255,parseInt(X[3],10))/255,T);if(X=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Y))return E(X[4]),this.setRGB(Math.min(100,parseInt(X[1],10))/100,Math.min(100,parseInt(X[2],10))/100,Math.min(100,parseInt(X[3],10))/100,T);break;case"hsl":case"hsla":if(X=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Y))return E(X[4]),this.setHSL(parseFloat(X[1])/360,parseFloat(X[2])/100,parseFloat(X[3])/100,T);break;default:console.warn("THREE.Color: Unknown color model "+_)}}else if(W=/^\#([A-Fa-f\d]+)$/.exec(_)){const X=W[1],q=X.length;if(q===3)return this.setRGB(parseInt(X.charAt(0),16)/15,parseInt(X.charAt(1),16)/15,parseInt(X.charAt(2),16)/15,T);if(q===6)return this.setHex(parseInt(X,16),T);console.warn("THREE.Color: Invalid hex color "+_)}else if(_&&_.length>0)return this.setColorName(_,T);return this}setColorName(_,T=SRGBColorSpace){const E=_colorKeywords[_.toLowerCase()];return E!==void 0?this.setHex(E,T):console.warn("THREE.Color: Unknown color "+_),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}copySRGBToLinear(_){return this.r=SRGBToLinear(_.r),this.g=SRGBToLinear(_.g),this.b=SRGBToLinear(_.b),this}copyLinearToSRGB(_){return this.r=LinearToSRGB(_.r),this.g=LinearToSRGB(_.g),this.b=LinearToSRGB(_.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),_),Math.round(clamp$1(_color.r*255,0,255))*65536+Math.round(clamp$1(_color.g*255,0,255))*256+Math.round(clamp$1(_color.b*255,0,255))}getHexString(_=SRGBColorSpace){return("000000"+this.getHex(_).toString(16)).slice(-6)}getHSL(_,T=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),T);const E=_color.r,W=_color.g,X=_color.b,q=Math.max(E,W,X),Y=Math.min(E,W,X);let te,ne;const ae=(Y+q)/2;if(Y===q)te=0,ne=0;else{const le=q-Y;switch(ne=ae<=.5?le/(q+Y):le/(2-q-Y),q){case E:te=(W-X)/le+(W<X?6:0);break;case W:te=(X-E)/le+2;break;case X:te=(E-W)/le+4;break}te/=6}return _.h=te,_.s=ne,_.l=ae,_}getRGB(_,T=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),T),_.r=_color.r,_.g=_color.g,_.b=_color.b,_}getStyle(_=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),_);const T=_color.r,E=_color.g,W=_color.b;return _!==SRGBColorSpace?`color(${_} ${T.toFixed(3)} ${E.toFixed(3)} ${W.toFixed(3)})`:`rgb(${Math.round(T*255)},${Math.round(E*255)},${Math.round(W*255)})`}offsetHSL(_,T,E){return this.getHSL(_hslA),this.setHSL(_hslA.h+_,_hslA.s+T,_hslA.l+E)}add(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this}addColors(_,T){return this.r=_.r+T.r,this.g=_.g+T.g,this.b=_.b+T.b,this}addScalar(_){return this.r+=_,this.g+=_,this.b+=_,this}sub(_){return this.r=Math.max(0,this.r-_.r),this.g=Math.max(0,this.g-_.g),this.b=Math.max(0,this.b-_.b),this}multiply(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this}multiplyScalar(_){return this.r*=_,this.g*=_,this.b*=_,this}lerp(_,T){return this.r+=(_.r-this.r)*T,this.g+=(_.g-this.g)*T,this.b+=(_.b-this.b)*T,this}lerpColors(_,T,E){return this.r=_.r+(T.r-_.r)*E,this.g=_.g+(T.g-_.g)*E,this.b=_.b+(T.b-_.b)*E,this}lerpHSL(_,T){this.getHSL(_hslA),_.getHSL(_hslB);const E=lerp(_hslA.h,_hslB.h,T),W=lerp(_hslA.s,_hslB.s,T),X=lerp(_hslA.l,_hslB.l,T);return this.setHSL(E,W,X),this}setFromVector3(_){return this.r=_.x,this.g=_.y,this.b=_.z,this}applyMatrix3(_){const T=this.r,E=this.g,W=this.b,X=_.elements;return this.r=X[0]*T+X[3]*E+X[6]*W,this.g=X[1]*T+X[4]*E+X[7]*W,this.b=X[2]*T+X[5]*E+X[8]*W,this}equals(_){return _.r===this.r&&_.g===this.g&&_.b===this.b}fromArray(_,T=0){return this.r=_[T],this.g=_[T+1],this.b=_[T+2],this}toArray(_=[],T=0){return _[T]=this.r,_[T+1]=this.g,_[T+2]=this.b,_}fromBufferAttribute(_,T){return this.r=_.getX(T),this.g=_.getY(T),this.b=_.getZ(T),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_){this._alphaTest>0!=_>0&&this.version++,this._alphaTest=_}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_){if(_!==void 0)for(const T in _){const E=_[T];if(E===void 0){console.warn(`THREE.Material: parameter '${T}' has value of undefined.`);continue}const W=this[T];if(W===void 0){console.warn(`THREE.Material: '${T}' is not a property of THREE.${this.type}.`);continue}W&&W.isColor?W.set(E):W&&W.isVector3&&E&&E.isVector3?W.copy(E):this[T]=E}}toJSON(_){const T=_===void 0||typeof _=="string";T&&(_={textures:{},images:{}});const E={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};E.uuid=this.uuid,E.type=this.type,this.name!==""&&(E.name=this.name),this.color&&this.color.isColor&&(E.color=this.color.getHex()),this.roughness!==void 0&&(E.roughness=this.roughness),this.metalness!==void 0&&(E.metalness=this.metalness),this.sheen!==void 0&&(E.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(E.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(E.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(E.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(E.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(E.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(E.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(E.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(E.shininess=this.shininess),this.clearcoat!==void 0&&(E.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(E.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(E.clearcoatMap=this.clearcoatMap.toJSON(_).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(E.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(E.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_).uuid,E.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(E.dispersion=this.dispersion),this.iridescence!==void 0&&(E.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(E.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(E.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(E.iridescenceMap=this.iridescenceMap.toJSON(_).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(E.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_).uuid),this.anisotropy!==void 0&&(E.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(E.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(E.anisotropyMap=this.anisotropyMap.toJSON(_).uuid),this.map&&this.map.isTexture&&(E.map=this.map.toJSON(_).uuid),this.matcap&&this.matcap.isTexture&&(E.matcap=this.matcap.toJSON(_).uuid),this.alphaMap&&this.alphaMap.isTexture&&(E.alphaMap=this.alphaMap.toJSON(_).uuid),this.lightMap&&this.lightMap.isTexture&&(E.lightMap=this.lightMap.toJSON(_).uuid,E.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(E.aoMap=this.aoMap.toJSON(_).uuid,E.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(E.bumpMap=this.bumpMap.toJSON(_).uuid,E.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(E.normalMap=this.normalMap.toJSON(_).uuid,E.normalMapType=this.normalMapType,E.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(E.displacementMap=this.displacementMap.toJSON(_).uuid,E.displacementScale=this.displacementScale,E.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(E.roughnessMap=this.roughnessMap.toJSON(_).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(E.metalnessMap=this.metalnessMap.toJSON(_).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(E.emissiveMap=this.emissiveMap.toJSON(_).uuid),this.specularMap&&this.specularMap.isTexture&&(E.specularMap=this.specularMap.toJSON(_).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(E.specularIntensityMap=this.specularIntensityMap.toJSON(_).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(E.specularColorMap=this.specularColorMap.toJSON(_).uuid),this.envMap&&this.envMap.isTexture&&(E.envMap=this.envMap.toJSON(_).uuid,this.combine!==void 0&&(E.combine=this.combine)),this.envMapRotation!==void 0&&(E.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(E.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(E.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(E.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(E.gradientMap=this.gradientMap.toJSON(_).uuid),this.transmission!==void 0&&(E.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(E.transmissionMap=this.transmissionMap.toJSON(_).uuid),this.thickness!==void 0&&(E.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(E.thicknessMap=this.thicknessMap.toJSON(_).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(E.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(E.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(E.size=this.size),this.shadowSide!==null&&(E.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(E.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(E.blending=this.blending),this.side!==FrontSide&&(E.side=this.side),this.vertexColors===!0&&(E.vertexColors=!0),this.opacity<1&&(E.opacity=this.opacity),this.transparent===!0&&(E.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(E.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(E.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(E.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(E.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(E.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(E.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(E.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(E.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(E.depthFunc=this.depthFunc),this.depthTest===!1&&(E.depthTest=this.depthTest),this.depthWrite===!1&&(E.depthWrite=this.depthWrite),this.colorWrite===!1&&(E.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(E.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(E.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(E.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(E.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(E.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(E.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(E.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(E.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(E.rotation=this.rotation),this.polygonOffset===!0&&(E.polygonOffset=!0),this.polygonOffsetFactor!==0&&(E.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(E.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(E.linewidth=this.linewidth),this.dashSize!==void 0&&(E.dashSize=this.dashSize),this.gapSize!==void 0&&(E.gapSize=this.gapSize),this.scale!==void 0&&(E.scale=this.scale),this.dithering===!0&&(E.dithering=!0),this.alphaTest>0&&(E.alphaTest=this.alphaTest),this.alphaHash===!0&&(E.alphaHash=!0),this.alphaToCoverage===!0&&(E.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(E.premultipliedAlpha=!0),this.forceSinglePass===!0&&(E.forceSinglePass=!0),this.wireframe===!0&&(E.wireframe=!0),this.wireframeLinewidth>1&&(E.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(E.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(E.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(E.flatShading=!0),this.visible===!1&&(E.visible=!1),this.toneMapped===!1&&(E.toneMapped=!1),this.fog===!1&&(E.fog=!1),Object.keys(this.userData).length>0&&(E.userData=this.userData);function W(X){const q=[];for(const Y in X){const te=X[Y];delete te.metadata,q.push(te)}return q}if(T){const X=W(_.textures),q=W(_.images);X.length>0&&(E.textures=X),q.length>0&&(E.images=q)}return E}clone(){return new this.constructor().copy(this)}copy(_){this.name=_.name,this.blending=_.blending,this.side=_.side,this.vertexColors=_.vertexColors,this.opacity=_.opacity,this.transparent=_.transparent,this.blendSrc=_.blendSrc,this.blendDst=_.blendDst,this.blendEquation=_.blendEquation,this.blendSrcAlpha=_.blendSrcAlpha,this.blendDstAlpha=_.blendDstAlpha,this.blendEquationAlpha=_.blendEquationAlpha,this.blendColor.copy(_.blendColor),this.blendAlpha=_.blendAlpha,this.depthFunc=_.depthFunc,this.depthTest=_.depthTest,this.depthWrite=_.depthWrite,this.stencilWriteMask=_.stencilWriteMask,this.stencilFunc=_.stencilFunc,this.stencilRef=_.stencilRef,this.stencilFuncMask=_.stencilFuncMask,this.stencilFail=_.stencilFail,this.stencilZFail=_.stencilZFail,this.stencilZPass=_.stencilZPass,this.stencilWrite=_.stencilWrite;const T=_.clippingPlanes;let E=null;if(T!==null){const W=T.length;E=new Array(W);for(let X=0;X!==W;++X)E[X]=T[X].clone()}return this.clippingPlanes=E,this.clipIntersection=_.clipIntersection,this.clipShadows=_.clipShadows,this.shadowSide=_.shadowSide,this.colorWrite=_.colorWrite,this.precision=_.precision,this.polygonOffset=_.polygonOffset,this.polygonOffsetFactor=_.polygonOffsetFactor,this.polygonOffsetUnits=_.polygonOffsetUnits,this.dithering=_.dithering,this.alphaTest=_.alphaTest,this.alphaHash=_.alphaHash,this.alphaToCoverage=_.alphaToCoverage,this.premultipliedAlpha=_.premultipliedAlpha,this.forceSinglePass=_.forceSinglePass,this.visible=_.visible,this.toneMapped=_.toneMapped,this.userData=JSON.parse(JSON.stringify(_.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_){_===!0&&this.version++}}class MeshBasicMaterial extends Material{constructor(_){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}const _tables=_generateTables();function _generateTables(){const B=new ArrayBuffer(4),_=new Float32Array(B),T=new Uint32Array(B),E=new Uint32Array(512),W=new Uint32Array(512);for(let te=0;te<256;++te){const ne=te-127;ne<-27?(E[te]=0,E[te|256]=32768,W[te]=24,W[te|256]=24):ne<-14?(E[te]=1024>>-ne-14,E[te|256]=1024>>-ne-14|32768,W[te]=-ne-1,W[te|256]=-ne-1):ne<=15?(E[te]=ne+15<<10,E[te|256]=ne+15<<10|32768,W[te]=13,W[te|256]=13):ne<128?(E[te]=31744,E[te|256]=64512,W[te]=24,W[te|256]=24):(E[te]=31744,E[te|256]=64512,W[te]=13,W[te|256]=13)}const X=new Uint32Array(2048),q=new Uint32Array(64),Y=new Uint32Array(64);for(let te=1;te<1024;++te){let ne=te<<13,ae=0;for(;!(ne&8388608);)ne<<=1,ae-=8388608;ne&=-8388609,ae+=947912704,X[te]=ne|ae}for(let te=1024;te<2048;++te)X[te]=939524096+(te-1024<<13);for(let te=1;te<31;++te)q[te]=te<<23;q[31]=1199570944,q[32]=2147483648;for(let te=33;te<63;++te)q[te]=2147483648+(te-32<<23);q[63]=3347054592;for(let te=1;te<64;++te)te!==32&&(Y[te]=1024);return{floatView:_,uint32View:T,baseTable:E,shiftTable:W,mantissaTable:X,exponentTable:q,offsetTable:Y}}function toHalfFloat(B){Math.abs(B)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),B=clamp$1(B,-65504,65504),_tables.floatView[0]=B;const _=_tables.uint32View[0],T=_>>23&511;return _tables.baseTable[T]+((_&8388607)>>_tables.shiftTable[T])}function fromHalfFloat(B){const _=B>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_]+(B&1023)]+_tables.exponentTable[_],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat},_vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_,T,E=!1){if(Array.isArray(_))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_,this.itemSize=T,this.count=_!==void 0?_.length/T:0,this.normalized=E,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}get updateRange(){return warnOnce("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_){return this.usage=_,this}addUpdateRange(_,T){this.updateRanges.push({start:_,count:T})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.name=_.name,this.array=new _.array.constructor(_.array),this.itemSize=_.itemSize,this.count=_.count,this.normalized=_.normalized,this.usage=_.usage,this.gpuType=_.gpuType,this}copyAt(_,T,E){_*=this.itemSize,E*=T.itemSize;for(let W=0,X=this.itemSize;W<X;W++)this.array[_+W]=T.array[E+W];return this}copyArray(_){return this.array.set(_),this}applyMatrix3(_){if(this.itemSize===2)for(let T=0,E=this.count;T<E;T++)_vector2$1.fromBufferAttribute(this,T),_vector2$1.applyMatrix3(_),this.setXY(T,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let T=0,E=this.count;T<E;T++)_vector$9.fromBufferAttribute(this,T),_vector$9.applyMatrix3(_),this.setXYZ(T,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(_){for(let T=0,E=this.count;T<E;T++)_vector$9.fromBufferAttribute(this,T),_vector$9.applyMatrix4(_),this.setXYZ(T,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(_){for(let T=0,E=this.count;T<E;T++)_vector$9.fromBufferAttribute(this,T),_vector$9.applyNormalMatrix(_),this.setXYZ(T,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(_){for(let T=0,E=this.count;T<E;T++)_vector$9.fromBufferAttribute(this,T),_vector$9.transformDirection(_),this.setXYZ(T,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(_,T=0){return this.array.set(_,T),this}getComponent(_,T){let E=this.array[_*this.itemSize+T];return this.normalized&&(E=denormalize(E,this.array)),E}setComponent(_,T,E){return this.normalized&&(E=normalize(E,this.array)),this.array[_*this.itemSize+T]=E,this}getX(_){let T=this.array[_*this.itemSize];return this.normalized&&(T=denormalize(T,this.array)),T}setX(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize]=T,this}getY(_){let T=this.array[_*this.itemSize+1];return this.normalized&&(T=denormalize(T,this.array)),T}setY(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize+1]=T,this}getZ(_){let T=this.array[_*this.itemSize+2];return this.normalized&&(T=denormalize(T,this.array)),T}setZ(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize+2]=T,this}getW(_){let T=this.array[_*this.itemSize+3];return this.normalized&&(T=denormalize(T,this.array)),T}setW(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize+3]=T,this}setXY(_,T,E){return _*=this.itemSize,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array)),this.array[_+0]=T,this.array[_+1]=E,this}setXYZ(_,T,E,W){return _*=this.itemSize,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array),W=normalize(W,this.array)),this.array[_+0]=T,this.array[_+1]=E,this.array[_+2]=W,this}setXYZW(_,T,E,W,X){return _*=this.itemSize,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array),W=normalize(W,this.array),X=normalize(X,this.array)),this.array[_+0]=T,this.array[_+1]=E,this.array[_+2]=W,this.array[_+3]=X,this}onUpload(_){return this.onUploadCallback=_,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_.name=this.name),this.usage!==StaticDrawUsage&&(_.usage=this.usage),_}}class Int8BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Int8Array(_),T,E)}}class Uint8BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Uint8Array(_),T,E)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Uint8ClampedArray(_),T,E)}}class Int16BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Int16Array(_),T,E)}}class Uint16BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Uint16Array(_),T,E)}}class Int32BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Int32Array(_),T,E)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Uint32Array(_),T,E)}}class Float16BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Uint16Array(_),T,E),this.isFloat16BufferAttribute=!0}getX(_){let T=fromHalfFloat(this.array[_*this.itemSize]);return this.normalized&&(T=denormalize(T,this.array)),T}setX(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize]=toHalfFloat(T),this}getY(_){let T=fromHalfFloat(this.array[_*this.itemSize+1]);return this.normalized&&(T=denormalize(T,this.array)),T}setY(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize+1]=toHalfFloat(T),this}getZ(_){let T=fromHalfFloat(this.array[_*this.itemSize+2]);return this.normalized&&(T=denormalize(T,this.array)),T}setZ(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize+2]=toHalfFloat(T),this}getW(_){let T=fromHalfFloat(this.array[_*this.itemSize+3]);return this.normalized&&(T=denormalize(T,this.array)),T}setW(_,T){return this.normalized&&(T=normalize(T,this.array)),this.array[_*this.itemSize+3]=toHalfFloat(T),this}setXY(_,T,E){return _*=this.itemSize,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array)),this.array[_+0]=toHalfFloat(T),this.array[_+1]=toHalfFloat(E),this}setXYZ(_,T,E,W){return _*=this.itemSize,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array),W=normalize(W,this.array)),this.array[_+0]=toHalfFloat(T),this.array[_+1]=toHalfFloat(E),this.array[_+2]=toHalfFloat(W),this}setXYZW(_,T,E,W,X){return _*=this.itemSize,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array),W=normalize(W,this.array),X=normalize(X,this.array)),this.array[_+0]=toHalfFloat(T),this.array[_+1]=toHalfFloat(E),this.array[_+2]=toHalfFloat(W),this.array[_+3]=toHalfFloat(X),this}}class Float32BufferAttribute extends BufferAttribute{constructor(_,T,E){super(new Float32Array(_),T,E)}}let _id$2=0;const _m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_){return Array.isArray(_)?this.index=new(arrayNeedsUint32(_)?Uint32BufferAttribute:Uint16BufferAttribute)(_,1):this.index=_,this}getAttribute(_){return this.attributes[_]}setAttribute(_,T){return this.attributes[_]=T,this}deleteAttribute(_){return delete this.attributes[_],this}hasAttribute(_){return this.attributes[_]!==void 0}addGroup(_,T,E=0){this.groups.push({start:_,count:T,materialIndex:E})}clearGroups(){this.groups=[]}setDrawRange(_,T){this.drawRange.start=_,this.drawRange.count=T}applyMatrix4(_){const T=this.attributes.position;T!==void 0&&(T.applyMatrix4(_),T.needsUpdate=!0);const E=this.attributes.normal;if(E!==void 0){const X=new Matrix3().getNormalMatrix(_);E.applyNormalMatrix(X),E.needsUpdate=!0}const W=this.attributes.tangent;return W!==void 0&&(W.transformDirection(_),W.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_){return _m1$2.makeRotationFromQuaternion(_),this.applyMatrix4(_m1$2),this}rotateX(_){return _m1$2.makeRotationX(_),this.applyMatrix4(_m1$2),this}rotateY(_){return _m1$2.makeRotationY(_),this.applyMatrix4(_m1$2),this}rotateZ(_){return _m1$2.makeRotationZ(_),this.applyMatrix4(_m1$2),this}translate(_,T,E){return _m1$2.makeTranslation(_,T,E),this.applyMatrix4(_m1$2),this}scale(_,T,E){return _m1$2.makeScale(_,T,E),this.applyMatrix4(_m1$2),this}lookAt(_){return _obj.lookAt(_),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_){const T=[];for(let E=0,W=_.length;E<W;E++){const X=_[E];T.push(X.x,X.y,X.z||0)}return this.setAttribute("position",new Float32BufferAttribute(T,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this.attributes.position,T=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_!==void 0){if(this.boundingBox.setFromBufferAttribute(_),T)for(let E=0,W=T.length;E<W;E++){const X=T[E];_box$2.setFromBufferAttribute(X),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _=this.attributes.position,T=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Vector3,1/0);return}if(_){const E=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(_),T)for(let X=0,q=T.length;X<q;X++){const Y=T[X];_boxMorphTargets.setFromBufferAttribute(Y),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(E);let W=0;for(let X=0,q=_.count;X<q;X++)_vector$8.fromBufferAttribute(_,X),W=Math.max(W,E.distanceToSquared(_vector$8));if(T)for(let X=0,q=T.length;X<q;X++){const Y=T[X],te=this.morphTargetsRelative;for(let ne=0,ae=Y.count;ne<ae;ne++)_vector$8.fromBufferAttribute(Y,ne),te&&(_offset.fromBufferAttribute(_,ne),_vector$8.add(_offset)),W=Math.max(W,E.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(W),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _=this.index,T=this.attributes;if(_===null||T.position===void 0||T.normal===void 0||T.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const E=T.position,W=T.normal,X=T.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*E.count),4));const q=this.getAttribute("tangent"),Y=[],te=[];for(let ze=0;ze<E.count;ze++)Y[ze]=new Vector3,te[ze]=new Vector3;const ne=new Vector3,ae=new Vector3,le=new Vector3,ue=new Vector2,ge=new Vector2,ye=new Vector2,xe=new Vector3,Te=new Vector3;function Ae(ze,He,Le){ne.fromBufferAttribute(E,ze),ae.fromBufferAttribute(E,He),le.fromBufferAttribute(E,Le),ue.fromBufferAttribute(X,ze),ge.fromBufferAttribute(X,He),ye.fromBufferAttribute(X,Le),ae.sub(ne),le.sub(ne),ge.sub(ue),ye.sub(ue);const qe=1/(ge.x*ye.y-ye.x*ge.y);isFinite(qe)&&(xe.copy(ae).multiplyScalar(ye.y).addScaledVector(le,-ge.y).multiplyScalar(qe),Te.copy(le).multiplyScalar(ge.x).addScaledVector(ae,-ye.x).multiplyScalar(qe),Y[ze].add(xe),Y[He].add(xe),Y[Le].add(xe),te[ze].add(Te),te[He].add(Te),te[Le].add(Te))}let Ie=this.groups;Ie.length===0&&(Ie=[{start:0,count:_.count}]);for(let ze=0,He=Ie.length;ze<He;++ze){const Le=Ie[ze],qe=Le.start,Qe=Le.count;for(let Ke=qe,Je=qe+Qe;Ke<Je;Ke+=3)Ae(_.getX(Ke+0),_.getX(Ke+1),_.getX(Ke+2))}const Ve=new Vector3,$e=new Vector3,We=new Vector3,Ue=new Vector3;function je(ze){We.fromBufferAttribute(W,ze),Ue.copy(We);const He=Y[ze];Ve.copy(He),Ve.sub(We.multiplyScalar(We.dot(He))).normalize(),$e.crossVectors(Ue,He);const qe=$e.dot(te[ze])<0?-1:1;q.setXYZW(ze,Ve.x,Ve.y,Ve.z,qe)}for(let ze=0,He=Ie.length;ze<He;++ze){const Le=Ie[ze],qe=Le.start,Qe=Le.count;for(let Ke=qe,Je=qe+Qe;Ke<Je;Ke+=3)je(_.getX(Ke+0)),je(_.getX(Ke+1)),je(_.getX(Ke+2))}}computeVertexNormals(){const _=this.index,T=this.getAttribute("position");if(T!==void 0){let E=this.getAttribute("normal");if(E===void 0)E=new BufferAttribute(new Float32Array(T.count*3),3),this.setAttribute("normal",E);else for(let ue=0,ge=E.count;ue<ge;ue++)E.setXYZ(ue,0,0,0);const W=new Vector3,X=new Vector3,q=new Vector3,Y=new Vector3,te=new Vector3,ne=new Vector3,ae=new Vector3,le=new Vector3;if(_)for(let ue=0,ge=_.count;ue<ge;ue+=3){const ye=_.getX(ue+0),xe=_.getX(ue+1),Te=_.getX(ue+2);W.fromBufferAttribute(T,ye),X.fromBufferAttribute(T,xe),q.fromBufferAttribute(T,Te),ae.subVectors(q,X),le.subVectors(W,X),ae.cross(le),Y.fromBufferAttribute(E,ye),te.fromBufferAttribute(E,xe),ne.fromBufferAttribute(E,Te),Y.add(ae),te.add(ae),ne.add(ae),E.setXYZ(ye,Y.x,Y.y,Y.z),E.setXYZ(xe,te.x,te.y,te.z),E.setXYZ(Te,ne.x,ne.y,ne.z)}else for(let ue=0,ge=T.count;ue<ge;ue+=3)W.fromBufferAttribute(T,ue+0),X.fromBufferAttribute(T,ue+1),q.fromBufferAttribute(T,ue+2),ae.subVectors(q,X),le.subVectors(W,X),ae.cross(le),E.setXYZ(ue+0,ae.x,ae.y,ae.z),E.setXYZ(ue+1,ae.x,ae.y,ae.z),E.setXYZ(ue+2,ae.x,ae.y,ae.z);this.normalizeNormals(),E.needsUpdate=!0}}normalizeNormals(){const _=this.attributes.normal;for(let T=0,E=_.count;T<E;T++)_vector$8.fromBufferAttribute(_,T),_vector$8.normalize(),_.setXYZ(T,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function _(Y,te){const ne=Y.array,ae=Y.itemSize,le=Y.normalized,ue=new ne.constructor(te.length*ae);let ge=0,ye=0;for(let xe=0,Te=te.length;xe<Te;xe++){Y.isInterleavedBufferAttribute?ge=te[xe]*Y.data.stride+Y.offset:ge=te[xe]*ae;for(let Ae=0;Ae<ae;Ae++)ue[ye++]=ne[ge++]}return new BufferAttribute(ue,ae,le)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const T=new BufferGeometry,E=this.index.array,W=this.attributes;for(const Y in W){const te=W[Y],ne=_(te,E);T.setAttribute(Y,ne)}const X=this.morphAttributes;for(const Y in X){const te=[],ne=X[Y];for(let ae=0,le=ne.length;ae<le;ae++){const ue=ne[ae],ge=_(ue,E);te.push(ge)}T.morphAttributes[Y]=te}T.morphTargetsRelative=this.morphTargetsRelative;const q=this.groups;for(let Y=0,te=q.length;Y<te;Y++){const ne=q[Y];T.addGroup(ne.start,ne.count,ne.materialIndex)}return T}toJSON(){const _={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),Object.keys(this.userData).length>0&&(_.userData=this.userData),this.parameters!==void 0){const te=this.parameters;for(const ne in te)te[ne]!==void 0&&(_[ne]=te[ne]);return _}_.data={attributes:{}};const T=this.index;T!==null&&(_.data.index={type:T.array.constructor.name,array:Array.prototype.slice.call(T.array)});const E=this.attributes;for(const te in E){const ne=E[te];_.data.attributes[te]=ne.toJSON(_.data)}const W={};let X=!1;for(const te in this.morphAttributes){const ne=this.morphAttributes[te],ae=[];for(let le=0,ue=ne.length;le<ue;le++){const ge=ne[le];ae.push(ge.toJSON(_.data))}ae.length>0&&(W[te]=ae,X=!0)}X&&(_.data.morphAttributes=W,_.data.morphTargetsRelative=this.morphTargetsRelative);const q=this.groups;q.length>0&&(_.data.groups=JSON.parse(JSON.stringify(q)));const Y=this.boundingSphere;return Y!==null&&(_.data.boundingSphere={center:Y.center.toArray(),radius:Y.radius}),_}clone(){return new this.constructor().copy(this)}copy(_){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const T={};this.name=_.name;const E=_.index;E!==null&&this.setIndex(E.clone(T));const W=_.attributes;for(const ne in W){const ae=W[ne];this.setAttribute(ne,ae.clone(T))}const X=_.morphAttributes;for(const ne in X){const ae=[],le=X[ne];for(let ue=0,ge=le.length;ue<ge;ue++)ae.push(le[ue].clone(T));this.morphAttributes[ne]=ae}this.morphTargetsRelative=_.morphTargetsRelative;const q=_.groups;for(let ne=0,ae=q.length;ne<ae;ne++){const le=q[ne];this.addGroup(le.start,le.count,le.materialIndex)}const Y=_.boundingBox;Y!==null&&(this.boundingBox=Y.clone());const te=_.boundingSphere;return te!==null&&(this.boundingSphere=te.clone()),this.drawRange.start=_.drawRange.start,this.drawRange.count=_.drawRange.count,this.userData=_.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_=new BufferGeometry,T=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_,this.material=T,this.updateMorphTargets()}copy(_,T){return super.copy(_,T),_.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_.morphTargetInfluences.slice()),_.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_.morphTargetDictionary)),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}updateMorphTargets(){const T=this.geometry.morphAttributes,E=Object.keys(T);if(E.length>0){const W=T[E[0]];if(W!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let X=0,q=W.length;X<q;X++){const Y=W[X].name||String(X);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Y]=X}}}}getVertexPosition(_,T){const E=this.geometry,W=E.attributes.position,X=E.morphAttributes.position,q=E.morphTargetsRelative;T.fromBufferAttribute(W,_);const Y=this.morphTargetInfluences;if(X&&Y){_morphA.set(0,0,0);for(let te=0,ne=X.length;te<ne;te++){const ae=Y[te],le=X[te];ae!==0&&(_tempA.fromBufferAttribute(le,_),q?_morphA.addScaledVector(_tempA,ae):_morphA.addScaledVector(_tempA.sub(T),ae))}T.add(_morphA)}return T}raycast(_,T){const E=this.geometry,W=this.material,X=this.matrixWorld;W!==void 0&&(E.boundingSphere===null&&E.computeBoundingSphere(),_sphere$6.copy(E.boundingSphere),_sphere$6.applyMatrix4(X),_ray$3.copy(_.ray).recast(_.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(_.far-_.near)**2))&&(_inverseMatrix$3.copy(X).invert(),_ray$3.copy(_.ray).applyMatrix4(_inverseMatrix$3),!(E.boundingBox!==null&&_ray$3.intersectsBox(E.boundingBox)===!1)&&this._computeIntersections(_,T,_ray$3)))}_computeIntersections(_,T,E){let W;const X=this.geometry,q=this.material,Y=X.index,te=X.attributes.position,ne=X.attributes.uv,ae=X.attributes.uv1,le=X.attributes.normal,ue=X.groups,ge=X.drawRange;if(Y!==null)if(Array.isArray(q))for(let ye=0,xe=ue.length;ye<xe;ye++){const Te=ue[ye],Ae=q[Te.materialIndex],Ie=Math.max(Te.start,ge.start),Ve=Math.min(Y.count,Math.min(Te.start+Te.count,ge.start+ge.count));for(let $e=Ie,We=Ve;$e<We;$e+=3){const Ue=Y.getX($e),je=Y.getX($e+1),ze=Y.getX($e+2);W=checkGeometryIntersection(this,Ae,_,E,ne,ae,le,Ue,je,ze),W&&(W.faceIndex=Math.floor($e/3),W.face.materialIndex=Te.materialIndex,T.push(W))}}else{const ye=Math.max(0,ge.start),xe=Math.min(Y.count,ge.start+ge.count);for(let Te=ye,Ae=xe;Te<Ae;Te+=3){const Ie=Y.getX(Te),Ve=Y.getX(Te+1),$e=Y.getX(Te+2);W=checkGeometryIntersection(this,q,_,E,ne,ae,le,Ie,Ve,$e),W&&(W.faceIndex=Math.floor(Te/3),T.push(W))}}else if(te!==void 0)if(Array.isArray(q))for(let ye=0,xe=ue.length;ye<xe;ye++){const Te=ue[ye],Ae=q[Te.materialIndex],Ie=Math.max(Te.start,ge.start),Ve=Math.min(te.count,Math.min(Te.start+Te.count,ge.start+ge.count));for(let $e=Ie,We=Ve;$e<We;$e+=3){const Ue=$e,je=$e+1,ze=$e+2;W=checkGeometryIntersection(this,Ae,_,E,ne,ae,le,Ue,je,ze),W&&(W.faceIndex=Math.floor($e/3),W.face.materialIndex=Te.materialIndex,T.push(W))}}else{const ye=Math.max(0,ge.start),xe=Math.min(te.count,ge.start+ge.count);for(let Te=ye,Ae=xe;Te<Ae;Te+=3){const Ie=Te,Ve=Te+1,$e=Te+2;W=checkGeometryIntersection(this,q,_,E,ne,ae,le,Ie,Ve,$e),W&&(W.faceIndex=Math.floor(Te/3),T.push(W))}}}}function checkIntersection$1(B,_,T,E,W,X,q,Y){let te;if(_.side===BackSide?te=E.intersectTriangle(q,X,W,!0,Y):te=E.intersectTriangle(W,X,q,_.side===FrontSide,Y),te===null)return null;_intersectionPointWorld.copy(Y),_intersectionPointWorld.applyMatrix4(B.matrixWorld);const ne=T.ray.origin.distanceTo(_intersectionPointWorld);return ne<T.near||ne>T.far?null:{distance:ne,point:_intersectionPointWorld.clone(),object:B}}function checkGeometryIntersection(B,_,T,E,W,X,q,Y,te,ne){B.getVertexPosition(Y,_vA$1),B.getVertexPosition(te,_vB$1),B.getVertexPosition(ne,_vC$1);const ae=checkIntersection$1(B,_,T,E,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(ae){W&&(_uvA$1.fromBufferAttribute(W,Y),_uvB$1.fromBufferAttribute(W,te),_uvC$1.fromBufferAttribute(W,ne),ae.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),X&&(_uvA$1.fromBufferAttribute(X,Y),_uvB$1.fromBufferAttribute(X,te),_uvC$1.fromBufferAttribute(X,ne),ae.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),q&&(_normalA.fromBufferAttribute(q,Y),_normalB.fromBufferAttribute(q,te),_normalC.fromBufferAttribute(q,ne),ae.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),ae.normal.dot(E.direction)>0&&ae.normal.multiplyScalar(-1));const le={a:Y,b:te,c:ne,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,le.normal),ae.face=le}return ae}class BoxGeometry extends BufferGeometry{constructor(_=1,T=1,E=1,W=1,X=1,q=1){super(),this.type="BoxGeometry",this.parameters={width:_,height:T,depth:E,widthSegments:W,heightSegments:X,depthSegments:q};const Y=this;W=Math.floor(W),X=Math.floor(X),q=Math.floor(q);const te=[],ne=[],ae=[],le=[];let ue=0,ge=0;ye("z","y","x",-1,-1,E,T,_,q,X,0),ye("z","y","x",1,-1,E,T,-_,q,X,1),ye("x","z","y",1,1,_,E,T,W,q,2),ye("x","z","y",1,-1,_,E,-T,W,q,3),ye("x","y","z",1,-1,_,T,E,W,X,4),ye("x","y","z",-1,-1,_,T,-E,W,X,5),this.setIndex(te),this.setAttribute("position",new Float32BufferAttribute(ne,3)),this.setAttribute("normal",new Float32BufferAttribute(ae,3)),this.setAttribute("uv",new Float32BufferAttribute(le,2));function ye(xe,Te,Ae,Ie,Ve,$e,We,Ue,je,ze,He){const Le=$e/je,qe=We/ze,Qe=$e/2,Ke=We/2,Je=Ue/2,pt=je+1,ut=ze+1;let lt=0,st=0;const sr=new Vector3;for(let mt=0;mt<ut;mt++){const Tr=mt*qe-Ke;for(let di=0;di<pt;di++){const Mi=di*Le-Qe;sr[xe]=Mi*Ie,sr[Te]=Tr*Ve,sr[Ae]=Je,ne.push(sr.x,sr.y,sr.z),sr[xe]=0,sr[Te]=0,sr[Ae]=Ue>0?1:-1,ae.push(sr.x,sr.y,sr.z),le.push(di/je),le.push(1-mt/ze),lt+=1}}for(let mt=0;mt<ze;mt++)for(let Tr=0;Tr<je;Tr++){const di=ue+Tr+pt*mt,Mi=ue+Tr+pt*(mt+1),Gr=ue+(Tr+1)+pt*(mt+1),ci=ue+(Tr+1)+pt*mt;te.push(di,Mi,ci),te.push(Mi,Gr,ci),st+=6}Y.addGroup(ge,st,He),ge+=st,ue+=lt}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new BoxGeometry(_.width,_.height,_.depth,_.widthSegments,_.heightSegments,_.depthSegments)}}function cloneUniforms(B){const _={};for(const T in B){_[T]={};for(const E in B[T]){const W=B[T][E];W&&(W.isColor||W.isMatrix3||W.isMatrix4||W.isVector2||W.isVector3||W.isVector4||W.isTexture||W.isQuaternion)?W.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),_[T][E]=null):_[T][E]=W.clone():Array.isArray(W)?_[T][E]=W.slice():_[T][E]=W}}return _}function mergeUniforms(B){const _={};for(let T=0;T<B.length;T++){const E=cloneUniforms(B[T]);for(const W in E)_[W]=E[W]}return _}function cloneUniformsGroups(B){const _=[];for(let T=0;T<B.length;T++)_.push(B[T].clone());return _}function getUnlitUniformColorSpace(B){const _=B.getRenderTarget();return _===null?B.outputColorSpace:_.isXRRenderTarget===!0?_.texture.colorSpace:ColorManagement.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(_){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_!==void 0&&this.setValues(_)}copy(_){return super.copy(_),this.fragmentShader=_.fragmentShader,this.vertexShader=_.vertexShader,this.uniforms=cloneUniforms(_.uniforms),this.uniformsGroups=cloneUniformsGroups(_.uniformsGroups),this.defines=Object.assign({},_.defines),this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.fog=_.fog,this.lights=_.lights,this.clipping=_.clipping,this.extensions=Object.assign({},_.extensions),this.glslVersion=_.glslVersion,this}toJSON(_){const T=super.toJSON(_);T.glslVersion=this.glslVersion,T.uniforms={};for(const W in this.uniforms){const q=this.uniforms[W].value;q&&q.isTexture?T.uniforms[W]={type:"t",value:q.toJSON(_).uuid}:q&&q.isColor?T.uniforms[W]={type:"c",value:q.getHex()}:q&&q.isVector2?T.uniforms[W]={type:"v2",value:q.toArray()}:q&&q.isVector3?T.uniforms[W]={type:"v3",value:q.toArray()}:q&&q.isVector4?T.uniforms[W]={type:"v4",value:q.toArray()}:q&&q.isMatrix3?T.uniforms[W]={type:"m3",value:q.toArray()}:q&&q.isMatrix4?T.uniforms[W]={type:"m4",value:q.toArray()}:T.uniforms[W]={value:q}}Object.keys(this.defines).length>0&&(T.defines=this.defines),T.vertexShader=this.vertexShader,T.fragmentShader=this.fragmentShader,T.lights=this.lights,T.clipping=this.clipping;const E={};for(const W in this.extensions)this.extensions[W]===!0&&(E[W]=!0);return Object.keys(E).length>0&&(T.extensions=E),T}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(_,T){return super.copy(_,T),this.matrixWorldInverse.copy(_.matrixWorldInverse),this.projectionMatrix.copy(_.projectionMatrix),this.projectionMatrixInverse.copy(_.projectionMatrixInverse),this.coordinateSystem=_.coordinateSystem,this}getWorldDirection(_){return super.getWorldDirection(_).negate()}updateMatrixWorld(_){super.updateMatrixWorld(_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_,T){super.updateWorldMatrix(_,T),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const _v3$1=new Vector3,_minTarget=new Vector2,_maxTarget=new Vector2;class PerspectiveCamera extends Camera{constructor(_=50,T=1,E=.1,W=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_,this.zoom=1,this.near=E,this.far=W,this.focus=10,this.aspect=T,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_,T){return super.copy(_,T),this.fov=_.fov,this.zoom=_.zoom,this.near=_.near,this.far=_.far,this.focus=_.focus,this.aspect=_.aspect,this.view=_.view===null?null:Object.assign({},_.view),this.filmGauge=_.filmGauge,this.filmOffset=_.filmOffset,this}setFocalLength(_){const T=.5*this.getFilmHeight()/_;this.fov=RAD2DEG*2*Math.atan(T),this.updateProjectionMatrix()}getFocalLength(){const _=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(_,T,E){_v3$1.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),T.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z),_v3$1.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),E.set(_v3$1.x,_v3$1.y).multiplyScalar(-_/_v3$1.z)}getViewSize(_,T){return this.getViewBounds(_,_minTarget,_maxTarget),T.subVectors(_maxTarget,_minTarget)}setViewOffset(_,T,E,W,X,q){this.aspect=_/T,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=T,this.view.offsetX=E,this.view.offsetY=W,this.view.width=X,this.view.height=q,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=this.near;let T=_*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,E=2*T,W=this.aspect*E,X=-.5*W;const q=this.view;if(this.view!==null&&this.view.enabled){const te=q.fullWidth,ne=q.fullHeight;X+=q.offsetX*W/te,T-=q.offsetY*E/ne,W*=q.width/te,E*=q.height/ne}const Y=this.filmOffset;Y!==0&&(X+=_*Y/this.getFilmWidth()),this.projectionMatrix.makePerspective(X,X+W,T,T-E,_,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const T=super.toJSON(_);return T.object.fov=this.fov,T.object.zoom=this.zoom,T.object.near=this.near,T.object.far=this.far,T.object.focus=this.focus,T.object.aspect=this.aspect,this.view!==null&&(T.object.view=Object.assign({},this.view)),T.object.filmGauge=this.filmGauge,T.object.filmOffset=this.filmOffset,T}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(_,T,E){super(),this.type="CubeCamera",this.renderTarget=E,this.coordinateSystem=null,this.activeMipmapLevel=0;const W=new PerspectiveCamera(fov,aspect,_,T);W.layers=this.layers,this.add(W);const X=new PerspectiveCamera(fov,aspect,_,T);X.layers=this.layers,this.add(X);const q=new PerspectiveCamera(fov,aspect,_,T);q.layers=this.layers,this.add(q);const Y=new PerspectiveCamera(fov,aspect,_,T);Y.layers=this.layers,this.add(Y);const te=new PerspectiveCamera(fov,aspect,_,T);te.layers=this.layers,this.add(te);const ne=new PerspectiveCamera(fov,aspect,_,T);ne.layers=this.layers,this.add(ne)}updateCoordinateSystem(){const _=this.coordinateSystem,T=this.children.concat(),[E,W,X,q,Y,te]=T;for(const ne of T)this.remove(ne);if(_===WebGLCoordinateSystem)E.up.set(0,1,0),E.lookAt(1,0,0),W.up.set(0,1,0),W.lookAt(-1,0,0),X.up.set(0,0,-1),X.lookAt(0,1,0),q.up.set(0,0,1),q.lookAt(0,-1,0),Y.up.set(0,1,0),Y.lookAt(0,0,1),te.up.set(0,1,0),te.lookAt(0,0,-1);else if(_===WebGPUCoordinateSystem)E.up.set(0,-1,0),E.lookAt(-1,0,0),W.up.set(0,-1,0),W.lookAt(1,0,0),X.up.set(0,0,1),X.lookAt(0,1,0),q.up.set(0,0,-1),q.lookAt(0,-1,0),Y.up.set(0,-1,0),Y.lookAt(0,0,1),te.up.set(0,-1,0),te.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+_);for(const ne of T)this.add(ne),ne.updateMatrixWorld()}update(_,T){this.parent===null&&this.updateMatrixWorld();const{renderTarget:E,activeMipmapLevel:W}=this;this.coordinateSystem!==_.coordinateSystem&&(this.coordinateSystem=_.coordinateSystem,this.updateCoordinateSystem());const[X,q,Y,te,ne,ae]=this.children,le=_.getRenderTarget(),ue=_.getActiveCubeFace(),ge=_.getActiveMipmapLevel(),ye=_.xr.enabled;_.xr.enabled=!1;const xe=E.texture.generateMipmaps;E.texture.generateMipmaps=!1,_.setRenderTarget(E,0,W),_.render(T,X),_.setRenderTarget(E,1,W),_.render(T,q),_.setRenderTarget(E,2,W),_.render(T,Y),_.setRenderTarget(E,3,W),_.render(T,te),_.setRenderTarget(E,4,W),_.render(T,ne),E.texture.generateMipmaps=xe,_.setRenderTarget(E,5,W),_.render(T,ae),_.setRenderTarget(le,ue,ge),_.xr.enabled=ye,E.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(_,T,E,W,X,q,Y,te,ne,ae){_=_!==void 0?_:[],T=T!==void 0?T:CubeReflectionMapping,super(_,T,E,W,X,q,Y,te,ne,ae),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_){this.image=_}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_=1,T={}){super(_,_,T),this.isWebGLCubeRenderTarget=!0;const E={width:_,height:_,depth:1},W=[E,E,E,E,E,E];this.texture=new CubeTexture(W,T.mapping,T.wrapS,T.wrapT,T.magFilter,T.minFilter,T.format,T.type,T.anisotropy,T.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=T.generateMipmaps!==void 0?T.generateMipmaps:!1,this.texture.minFilter=T.minFilter!==void 0?T.minFilter:LinearFilter}fromEquirectangularTexture(_,T){this.texture.type=T.type,this.texture.colorSpace=T.colorSpace,this.texture.generateMipmaps=T.generateMipmaps,this.texture.minFilter=T.minFilter,this.texture.magFilter=T.magFilter;const E={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},W=new BoxGeometry(5,5,5),X=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(E.uniforms),vertexShader:E.vertexShader,fragmentShader:E.fragmentShader,side:BackSide,blending:NoBlending});X.uniforms.tEquirect.value=T;const q=new Mesh(W,X),Y=T.minFilter;return T.minFilter===LinearMipmapLinearFilter&&(T.minFilter=LinearFilter),new CubeCamera(1,10,this).update(_,q),T.minFilter=Y,q.geometry.dispose(),q.material.dispose(),this}clear(_,T,E,W){const X=_.getRenderTarget();for(let q=0;q<6;q++)_.setRenderTarget(this,q),_.clear(T,E,W);_.setRenderTarget(X)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_=new Vector3(1,0,0),T=0){this.isPlane=!0,this.normal=_,this.constant=T}set(_,T){return this.normal.copy(_),this.constant=T,this}setComponents(_,T,E,W){return this.normal.set(_,T,E),this.constant=W,this}setFromNormalAndCoplanarPoint(_,T){return this.normal.copy(_),this.constant=-T.dot(this.normal),this}setFromCoplanarPoints(_,T,E){const W=_vector1.subVectors(E,T).cross(_vector2.subVectors(_,T)).normalize();return this.setFromNormalAndCoplanarPoint(W,_),this}copy(_){return this.normal.copy(_.normal),this.constant=_.constant,this}normalize(){const _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_){return this.normal.dot(_)+this.constant}distanceToSphere(_){return this.distanceToPoint(_.center)-_.radius}projectPoint(_,T){return T.copy(_).addScaledVector(this.normal,-this.distanceToPoint(_))}intersectLine(_,T){const E=_.delta(_vector1),W=this.normal.dot(E);if(W===0)return this.distanceToPoint(_.start)===0?T.copy(_.start):null;const X=-(_.start.dot(this.normal)+this.constant)/W;return X<0||X>1?null:T.copy(_.start).addScaledVector(E,X)}intersectsLine(_){const T=this.distanceToPoint(_.start),E=this.distanceToPoint(_.end);return T<0&&E>0||E<0&&T>0}intersectsBox(_){return _.intersectsPlane(this)}intersectsSphere(_){return _.intersectsPlane(this)}coplanarPoint(_){return _.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_,T){const E=T||_normalMatrix.getNormalMatrix(_),W=this.coplanarPoint(_vector1).applyMatrix4(_),X=this.normal.applyMatrix3(E).normalize();return this.constant=-W.dot(X),this}translate(_){return this.constant-=_.dot(this.normal),this}equals(_){return _.normal.equals(this.normal)&&_.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(_=new Plane,T=new Plane,E=new Plane,W=new Plane,X=new Plane,q=new Plane){this.planes=[_,T,E,W,X,q]}set(_,T,E,W,X,q){const Y=this.planes;return Y[0].copy(_),Y[1].copy(T),Y[2].copy(E),Y[3].copy(W),Y[4].copy(X),Y[5].copy(q),this}copy(_){const T=this.planes;for(let E=0;E<6;E++)T[E].copy(_.planes[E]);return this}setFromProjectionMatrix(_,T=WebGLCoordinateSystem){const E=this.planes,W=_.elements,X=W[0],q=W[1],Y=W[2],te=W[3],ne=W[4],ae=W[5],le=W[6],ue=W[7],ge=W[8],ye=W[9],xe=W[10],Te=W[11],Ae=W[12],Ie=W[13],Ve=W[14],$e=W[15];if(E[0].setComponents(te-X,ue-ne,Te-ge,$e-Ae).normalize(),E[1].setComponents(te+X,ue+ne,Te+ge,$e+Ae).normalize(),E[2].setComponents(te+q,ue+ae,Te+ye,$e+Ie).normalize(),E[3].setComponents(te-q,ue-ae,Te-ye,$e-Ie).normalize(),E[4].setComponents(te-Y,ue-le,Te-xe,$e-Ve).normalize(),T===WebGLCoordinateSystem)E[5].setComponents(te+Y,ue+le,Te+xe,$e+Ve).normalize();else if(T===WebGPUCoordinateSystem)E[5].setComponents(Y,le,xe,Ve).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+T);return this}intersectsObject(_){if(_.boundingSphere!==void 0)_.boundingSphere===null&&_.computeBoundingSphere(),_sphere$5.copy(_.boundingSphere).applyMatrix4(_.matrixWorld);else{const T=_.geometry;T.boundingSphere===null&&T.computeBoundingSphere(),_sphere$5.copy(T.boundingSphere).applyMatrix4(_.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(_){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(_.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(_){const T=this.planes,E=_.center,W=-_.radius;for(let X=0;X<6;X++)if(T[X].distanceToPoint(E)<W)return!1;return!0}intersectsBox(_){const T=this.planes;for(let E=0;E<6;E++){const W=T[E];if(_vector$7.x=W.normal.x>0?_.max.x:_.min.x,_vector$7.y=W.normal.y>0?_.max.y:_.min.y,_vector$7.z=W.normal.z>0?_.max.z:_.min.z,W.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(_){const T=this.planes;for(let E=0;E<6;E++)if(T[E].distanceToPoint(_)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let B=null,_=!1,T=null,E=null;function W(X,q){T(X,q),E=B.requestAnimationFrame(W)}return{start:function(){_!==!0&&T!==null&&(E=B.requestAnimationFrame(W),_=!0)},stop:function(){B.cancelAnimationFrame(E),_=!1},setAnimationLoop:function(X){T=X},setContext:function(X){B=X}}}function WebGLAttributes(B){const _=new WeakMap;function T(Y,te){const ne=Y.array,ae=Y.usage,le=ne.byteLength,ue=B.createBuffer();B.bindBuffer(te,ue),B.bufferData(te,ne,ae),Y.onUploadCallback();let ge;if(ne instanceof Float32Array)ge=B.FLOAT;else if(ne instanceof Uint16Array)Y.isFloat16BufferAttribute?ge=B.HALF_FLOAT:ge=B.UNSIGNED_SHORT;else if(ne instanceof Int16Array)ge=B.SHORT;else if(ne instanceof Uint32Array)ge=B.UNSIGNED_INT;else if(ne instanceof Int32Array)ge=B.INT;else if(ne instanceof Int8Array)ge=B.BYTE;else if(ne instanceof Uint8Array)ge=B.UNSIGNED_BYTE;else if(ne instanceof Uint8ClampedArray)ge=B.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+ne);return{buffer:ue,type:ge,bytesPerElement:ne.BYTES_PER_ELEMENT,version:Y.version,size:le}}function E(Y,te,ne){const ae=te.array,le=te._updateRange,ue=te.updateRanges;if(B.bindBuffer(ne,Y),le.count===-1&&ue.length===0&&B.bufferSubData(ne,0,ae),ue.length!==0){for(let ge=0,ye=ue.length;ge<ye;ge++){const xe=ue[ge];B.bufferSubData(ne,xe.start*ae.BYTES_PER_ELEMENT,ae,xe.start,xe.count)}te.clearUpdateRanges()}le.count!==-1&&(B.bufferSubData(ne,le.offset*ae.BYTES_PER_ELEMENT,ae,le.offset,le.count),le.count=-1),te.onUploadCallback()}function W(Y){return Y.isInterleavedBufferAttribute&&(Y=Y.data),_.get(Y)}function X(Y){Y.isInterleavedBufferAttribute&&(Y=Y.data);const te=_.get(Y);te&&(B.deleteBuffer(te.buffer),_.delete(Y))}function q(Y,te){if(Y.isGLBufferAttribute){const ae=_.get(Y);(!ae||ae.version<Y.version)&&_.set(Y,{buffer:Y.buffer,type:Y.type,bytesPerElement:Y.elementSize,version:Y.version});return}Y.isInterleavedBufferAttribute&&(Y=Y.data);const ne=_.get(Y);if(ne===void 0)_.set(Y,T(Y,te));else if(ne.version<Y.version){if(ne.size!==Y.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");E(ne.buffer,Y,te),ne.version=Y.version}}return{get:W,remove:X,update:q}}class PlaneGeometry extends BufferGeometry{constructor(_=1,T=1,E=1,W=1){super(),this.type="PlaneGeometry",this.parameters={width:_,height:T,widthSegments:E,heightSegments:W};const X=_/2,q=T/2,Y=Math.floor(E),te=Math.floor(W),ne=Y+1,ae=te+1,le=_/Y,ue=T/te,ge=[],ye=[],xe=[],Te=[];for(let Ae=0;Ae<ae;Ae++){const Ie=Ae*ue-q;for(let Ve=0;Ve<ne;Ve++){const $e=Ve*le-X;ye.push($e,-Ie,0),xe.push(0,0,1),Te.push(Ve/Y),Te.push(1-Ae/te)}}for(let Ae=0;Ae<te;Ae++)for(let Ie=0;Ie<Y;Ie++){const Ve=Ie+ne*Ae,$e=Ie+ne*(Ae+1),We=Ie+1+ne*(Ae+1),Ue=Ie+1+ne*Ae;ge.push(Ve,$e,Ue),ge.push($e,We,Ue)}this.setIndex(ge),this.setAttribute("position",new Float32BufferAttribute(ye,3)),this.setAttribute("normal",new Float32BufferAttribute(xe,3)),this.setAttribute("uv",new Float32BufferAttribute(Te,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PlaneGeometry(_.width,_.height,_.widthSegments,_.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphinstance_vertex=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphinstance_vertex,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},envMapRotation:{value:new Matrix3},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Matrix3}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0},_e1$1=new Euler,_m1$1=new Matrix4;function WebGLBackground(B,_,T,E,W,X,q){const Y=new Color(0);let te=X===!0?0:1,ne,ae,le=null,ue=0,ge=null;function ye(Ie){let Ve=Ie.isScene===!0?Ie.background:null;return Ve&&Ve.isTexture&&(Ve=(Ie.backgroundBlurriness>0?T:_).get(Ve)),Ve}function xe(Ie){let Ve=!1;const $e=ye(Ie);$e===null?Ae(Y,te):$e&&$e.isColor&&(Ae($e,1),Ve=!0);const We=B.xr.getEnvironmentBlendMode();We==="additive"?E.buffers.color.setClear(0,0,0,1,q):We==="alpha-blend"&&E.buffers.color.setClear(0,0,0,0,q),(B.autoClear||Ve)&&B.clear(B.autoClearColor,B.autoClearDepth,B.autoClearStencil)}function Te(Ie,Ve){const $e=ye(Ve);$e&&($e.isCubeTexture||$e.mapping===CubeUVReflectionMapping)?(ae===void 0&&(ae=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),ae.geometry.deleteAttribute("normal"),ae.geometry.deleteAttribute("uv"),ae.onBeforeRender=function(We,Ue,je){this.matrixWorld.copyPosition(je.matrixWorld)},Object.defineProperty(ae.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),W.update(ae)),_e1$1.copy(Ve.backgroundRotation),_e1$1.x*=-1,_e1$1.y*=-1,_e1$1.z*=-1,$e.isCubeTexture&&$e.isRenderTargetTexture===!1&&(_e1$1.y*=-1,_e1$1.z*=-1),ae.material.uniforms.envMap.value=$e,ae.material.uniforms.flipEnvMap.value=$e.isCubeTexture&&$e.isRenderTargetTexture===!1?-1:1,ae.material.uniforms.backgroundBlurriness.value=Ve.backgroundBlurriness,ae.material.uniforms.backgroundIntensity.value=Ve.backgroundIntensity,ae.material.uniforms.backgroundRotation.value.setFromMatrix4(_m1$1.makeRotationFromEuler(_e1$1)),ae.material.toneMapped=ColorManagement.getTransfer($e.colorSpace)!==SRGBTransfer,(le!==$e||ue!==$e.version||ge!==B.toneMapping)&&(ae.material.needsUpdate=!0,le=$e,ue=$e.version,ge=B.toneMapping),ae.layers.enableAll(),Ie.unshift(ae,ae.geometry,ae.material,0,0,null)):$e&&$e.isTexture&&(ne===void 0&&(ne=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),ne.geometry.deleteAttribute("normal"),Object.defineProperty(ne.material,"map",{get:function(){return this.uniforms.t2D.value}}),W.update(ne)),ne.material.uniforms.t2D.value=$e,ne.material.uniforms.backgroundIntensity.value=Ve.backgroundIntensity,ne.material.toneMapped=ColorManagement.getTransfer($e.colorSpace)!==SRGBTransfer,$e.matrixAutoUpdate===!0&&$e.updateMatrix(),ne.material.uniforms.uvTransform.value.copy($e.matrix),(le!==$e||ue!==$e.version||ge!==B.toneMapping)&&(ne.material.needsUpdate=!0,le=$e,ue=$e.version,ge=B.toneMapping),ne.layers.enableAll(),Ie.unshift(ne,ne.geometry,ne.material,0,0,null))}function Ae(Ie,Ve){Ie.getRGB(_rgb,getUnlitUniformColorSpace(B)),E.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,Ve,q)}return{getClearColor:function(){return Y},setClearColor:function(Ie,Ve=1){Y.set(Ie),te=Ve,Ae(Y,te)},getClearAlpha:function(){return te},setClearAlpha:function(Ie){te=Ie,Ae(Y,te)},render:xe,addToRenderList:Te}}function WebGLBindingStates(B,_){const T=B.getParameter(B.MAX_VERTEX_ATTRIBS),E={},W=ue(null);let X=W,q=!1;function Y(Le,qe,Qe,Ke,Je){let pt=!1;const ut=le(Ke,Qe,qe);X!==ut&&(X=ut,ne(X.object)),pt=ge(Le,Ke,Qe,Je),pt&&ye(Le,Ke,Qe,Je),Je!==null&&_.update(Je,B.ELEMENT_ARRAY_BUFFER),(pt||q)&&(q=!1,$e(Le,qe,Qe,Ke),Je!==null&&B.bindBuffer(B.ELEMENT_ARRAY_BUFFER,_.get(Je).buffer))}function te(){return B.createVertexArray()}function ne(Le){return B.bindVertexArray(Le)}function ae(Le){return B.deleteVertexArray(Le)}function le(Le,qe,Qe){const Ke=Qe.wireframe===!0;let Je=E[Le.id];Je===void 0&&(Je={},E[Le.id]=Je);let pt=Je[qe.id];pt===void 0&&(pt={},Je[qe.id]=pt);let ut=pt[Ke];return ut===void 0&&(ut=ue(te()),pt[Ke]=ut),ut}function ue(Le){const qe=[],Qe=[],Ke=[];for(let Je=0;Je<T;Je++)qe[Je]=0,Qe[Je]=0,Ke[Je]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:qe,enabledAttributes:Qe,attributeDivisors:Ke,object:Le,attributes:{},index:null}}function ge(Le,qe,Qe,Ke){const Je=X.attributes,pt=qe.attributes;let ut=0;const lt=Qe.getAttributes();for(const st in lt)if(lt[st].location>=0){const mt=Je[st];let Tr=pt[st];if(Tr===void 0&&(st==="instanceMatrix"&&Le.instanceMatrix&&(Tr=Le.instanceMatrix),st==="instanceColor"&&Le.instanceColor&&(Tr=Le.instanceColor)),mt===void 0||mt.attribute!==Tr||Tr&&mt.data!==Tr.data)return!0;ut++}return X.attributesNum!==ut||X.index!==Ke}function ye(Le,qe,Qe,Ke){const Je={},pt=qe.attributes;let ut=0;const lt=Qe.getAttributes();for(const st in lt)if(lt[st].location>=0){let mt=pt[st];mt===void 0&&(st==="instanceMatrix"&&Le.instanceMatrix&&(mt=Le.instanceMatrix),st==="instanceColor"&&Le.instanceColor&&(mt=Le.instanceColor));const Tr={};Tr.attribute=mt,mt&&mt.data&&(Tr.data=mt.data),Je[st]=Tr,ut++}X.attributes=Je,X.attributesNum=ut,X.index=Ke}function xe(){const Le=X.newAttributes;for(let qe=0,Qe=Le.length;qe<Qe;qe++)Le[qe]=0}function Te(Le){Ae(Le,0)}function Ae(Le,qe){const Qe=X.newAttributes,Ke=X.enabledAttributes,Je=X.attributeDivisors;Qe[Le]=1,Ke[Le]===0&&(B.enableVertexAttribArray(Le),Ke[Le]=1),Je[Le]!==qe&&(B.vertexAttribDivisor(Le,qe),Je[Le]=qe)}function Ie(){const Le=X.newAttributes,qe=X.enabledAttributes;for(let Qe=0,Ke=qe.length;Qe<Ke;Qe++)qe[Qe]!==Le[Qe]&&(B.disableVertexAttribArray(Qe),qe[Qe]=0)}function Ve(Le,qe,Qe,Ke,Je,pt,ut){ut===!0?B.vertexAttribIPointer(Le,qe,Qe,Je,pt):B.vertexAttribPointer(Le,qe,Qe,Ke,Je,pt)}function $e(Le,qe,Qe,Ke){xe();const Je=Ke.attributes,pt=Qe.getAttributes(),ut=qe.defaultAttributeValues;for(const lt in pt){const st=pt[lt];if(st.location>=0){let sr=Je[lt];if(sr===void 0&&(lt==="instanceMatrix"&&Le.instanceMatrix&&(sr=Le.instanceMatrix),lt==="instanceColor"&&Le.instanceColor&&(sr=Le.instanceColor)),sr!==void 0){const mt=sr.normalized,Tr=sr.itemSize,di=_.get(sr);if(di===void 0)continue;const Mi=di.buffer,Gr=di.type,ci=di.bytesPerElement,gi=Gr===B.INT||Gr===B.UNSIGNED_INT||sr.gpuType===IntType;if(sr.isInterleavedBufferAttribute){const fi=sr.data,ri=fi.stride,ot=sr.offset;if(fi.isInstancedInterleavedBuffer){for(let rt=0;rt<st.locationSize;rt++)Ae(st.location+rt,fi.meshPerAttribute);Le.isInstancedMesh!==!0&&Ke._maxInstanceCount===void 0&&(Ke._maxInstanceCount=fi.meshPerAttribute*fi.count)}else for(let rt=0;rt<st.locationSize;rt++)Te(st.location+rt);B.bindBuffer(B.ARRAY_BUFFER,Mi);for(let rt=0;rt<st.locationSize;rt++)Ve(st.location+rt,Tr/st.locationSize,Gr,mt,ri*ci,(ot+Tr/st.locationSize*rt)*ci,gi)}else{if(sr.isInstancedBufferAttribute){for(let fi=0;fi<st.locationSize;fi++)Ae(st.location+fi,sr.meshPerAttribute);Le.isInstancedMesh!==!0&&Ke._maxInstanceCount===void 0&&(Ke._maxInstanceCount=sr.meshPerAttribute*sr.count)}else for(let fi=0;fi<st.locationSize;fi++)Te(st.location+fi);B.bindBuffer(B.ARRAY_BUFFER,Mi);for(let fi=0;fi<st.locationSize;fi++)Ve(st.location+fi,Tr/st.locationSize,Gr,mt,Tr*ci,Tr/st.locationSize*fi*ci,gi)}}else if(ut!==void 0){const mt=ut[lt];if(mt!==void 0)switch(mt.length){case 2:B.vertexAttrib2fv(st.location,mt);break;case 3:B.vertexAttrib3fv(st.location,mt);break;case 4:B.vertexAttrib4fv(st.location,mt);break;default:B.vertexAttrib1fv(st.location,mt)}}}}Ie()}function We(){ze();for(const Le in E){const qe=E[Le];for(const Qe in qe){const Ke=qe[Qe];for(const Je in Ke)ae(Ke[Je].object),delete Ke[Je];delete qe[Qe]}delete E[Le]}}function Ue(Le){if(E[Le.id]===void 0)return;const qe=E[Le.id];for(const Qe in qe){const Ke=qe[Qe];for(const Je in Ke)ae(Ke[Je].object),delete Ke[Je];delete qe[Qe]}delete E[Le.id]}function je(Le){for(const qe in E){const Qe=E[qe];if(Qe[Le.id]===void 0)continue;const Ke=Qe[Le.id];for(const Je in Ke)ae(Ke[Je].object),delete Ke[Je];delete Qe[Le.id]}}function ze(){He(),q=!0,X!==W&&(X=W,ne(X.object))}function He(){W.geometry=null,W.program=null,W.wireframe=!1}return{setup:Y,reset:ze,resetDefaultState:He,dispose:We,releaseStatesOfGeometry:Ue,releaseStatesOfProgram:je,initAttributes:xe,enableAttribute:Te,disableUnusedAttributes:Ie}}function WebGLBufferRenderer(B,_,T){let E;function W(ne){E=ne}function X(ne,ae){B.drawArrays(E,ne,ae),T.update(ae,E,1)}function q(ne,ae,le){le!==0&&(B.drawArraysInstanced(E,ne,ae,le),T.update(ae,E,le))}function Y(ne,ae,le){if(le===0)return;const ue=_.get("WEBGL_multi_draw");if(ue===null)for(let ge=0;ge<le;ge++)this.render(ne[ge],ae[ge]);else{ue.multiDrawArraysWEBGL(E,ne,0,ae,0,le);let ge=0;for(let ye=0;ye<le;ye++)ge+=ae[ye];T.update(ge,E,1)}}function te(ne,ae,le,ue){if(le===0)return;const ge=_.get("WEBGL_multi_draw");if(ge===null)for(let ye=0;ye<ne.length;ye++)q(ne[ye],ae[ye],ue[ye]);else{ge.multiDrawArraysInstancedWEBGL(E,ne,0,ae,0,ue,0,le);let ye=0;for(let xe=0;xe<le;xe++)ye+=ae[xe];for(let xe=0;xe<ue.length;xe++)T.update(ye,E,ue[xe])}}this.setMode=W,this.render=X,this.renderInstances=q,this.renderMultiDraw=Y,this.renderMultiDrawInstances=te}function WebGLCapabilities(B,_,T,E){let W;function X(){if(W!==void 0)return W;if(_.has("EXT_texture_filter_anisotropic")===!0){const Ue=_.get("EXT_texture_filter_anisotropic");W=B.getParameter(Ue.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else W=0;return W}function q(Ue){return!(Ue!==RGBAFormat&&E.convert(Ue)!==B.getParameter(B.IMPLEMENTATION_COLOR_READ_FORMAT))}function Y(Ue){const je=Ue===HalfFloatType&&(_.has("EXT_color_buffer_half_float")||_.has("EXT_color_buffer_float"));return!(Ue!==UnsignedByteType&&E.convert(Ue)!==B.getParameter(B.IMPLEMENTATION_COLOR_READ_TYPE)&&Ue!==FloatType&&!je)}function te(Ue){if(Ue==="highp"){if(B.getShaderPrecisionFormat(B.VERTEX_SHADER,B.HIGH_FLOAT).precision>0&&B.getShaderPrecisionFormat(B.FRAGMENT_SHADER,B.HIGH_FLOAT).precision>0)return"highp";Ue="mediump"}return Ue==="mediump"&&B.getShaderPrecisionFormat(B.VERTEX_SHADER,B.MEDIUM_FLOAT).precision>0&&B.getShaderPrecisionFormat(B.FRAGMENT_SHADER,B.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let ne=T.precision!==void 0?T.precision:"highp";const ae=te(ne);ae!==ne&&(console.warn("THREE.WebGLRenderer:",ne,"not supported, using",ae,"instead."),ne=ae);const le=T.logarithmicDepthBuffer===!0,ue=B.getParameter(B.MAX_TEXTURE_IMAGE_UNITS),ge=B.getParameter(B.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ye=B.getParameter(B.MAX_TEXTURE_SIZE),xe=B.getParameter(B.MAX_CUBE_MAP_TEXTURE_SIZE),Te=B.getParameter(B.MAX_VERTEX_ATTRIBS),Ae=B.getParameter(B.MAX_VERTEX_UNIFORM_VECTORS),Ie=B.getParameter(B.MAX_VARYING_VECTORS),Ve=B.getParameter(B.MAX_FRAGMENT_UNIFORM_VECTORS),$e=ge>0,We=B.getParameter(B.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:X,getMaxPrecision:te,textureFormatReadable:q,textureTypeReadable:Y,precision:ne,logarithmicDepthBuffer:le,maxTextures:ue,maxVertexTextures:ge,maxTextureSize:ye,maxCubemapSize:xe,maxAttributes:Te,maxVertexUniforms:Ae,maxVaryings:Ie,maxFragmentUniforms:Ve,vertexTextures:$e,maxSamples:We}}function WebGLClipping(B){const _=this;let T=null,E=0,W=!1,X=!1;const q=new Plane,Y=new Matrix3,te={value:null,needsUpdate:!1};this.uniform=te,this.numPlanes=0,this.numIntersection=0,this.init=function(le,ue){const ge=le.length!==0||ue||E!==0||W;return W=ue,E=le.length,ge},this.beginShadows=function(){X=!0,ae(null)},this.endShadows=function(){X=!1},this.setGlobalState=function(le,ue){T=ae(le,ue,0)},this.setState=function(le,ue,ge){const ye=le.clippingPlanes,xe=le.clipIntersection,Te=le.clipShadows,Ae=B.get(le);if(!W||ye===null||ye.length===0||X&&!Te)X?ae(null):ne();else{const Ie=X?0:E,Ve=Ie*4;let $e=Ae.clippingState||null;te.value=$e,$e=ae(ye,ue,Ve,ge);for(let We=0;We!==Ve;++We)$e[We]=T[We];Ae.clippingState=$e,this.numIntersection=xe?this.numPlanes:0,this.numPlanes+=Ie}};function ne(){te.value!==T&&(te.value=T,te.needsUpdate=E>0),_.numPlanes=E,_.numIntersection=0}function ae(le,ue,ge,ye){const xe=le!==null?le.length:0;let Te=null;if(xe!==0){if(Te=te.value,ye!==!0||Te===null){const Ae=ge+xe*4,Ie=ue.matrixWorldInverse;Y.getNormalMatrix(Ie),(Te===null||Te.length<Ae)&&(Te=new Float32Array(Ae));for(let Ve=0,$e=ge;Ve!==xe;++Ve,$e+=4)q.copy(le[Ve]).applyMatrix4(Ie,Y),q.normal.toArray(Te,$e),Te[$e+3]=q.constant}te.value=Te,te.needsUpdate=!0}return _.numPlanes=xe,_.numIntersection=0,Te}}function WebGLCubeMaps(B){let _=new WeakMap;function T(q,Y){return Y===EquirectangularReflectionMapping?q.mapping=CubeReflectionMapping:Y===EquirectangularRefractionMapping&&(q.mapping=CubeRefractionMapping),q}function E(q){if(q&&q.isTexture){const Y=q.mapping;if(Y===EquirectangularReflectionMapping||Y===EquirectangularRefractionMapping)if(_.has(q)){const te=_.get(q).texture;return T(te,q.mapping)}else{const te=q.image;if(te&&te.height>0){const ne=new WebGLCubeRenderTarget(te.height);return ne.fromEquirectangularTexture(B,q),_.set(q,ne),q.addEventListener("dispose",W),T(ne.texture,q.mapping)}else return null}}return q}function W(q){const Y=q.target;Y.removeEventListener("dispose",W);const te=_.get(Y);te!==void 0&&(_.delete(Y),te.dispose())}function X(){_=new WeakMap}return{get:E,dispose:X}}class OrthographicCamera extends Camera{constructor(_=-1,T=1,E=1,W=-1,X=.1,q=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_,this.right=T,this.top=E,this.bottom=W,this.near=X,this.far=q,this.updateProjectionMatrix()}copy(_,T){return super.copy(_,T),this.left=_.left,this.right=_.right,this.top=_.top,this.bottom=_.bottom,this.near=_.near,this.far=_.far,this.zoom=_.zoom,this.view=_.view===null?null:Object.assign({},_.view),this}setViewOffset(_,T,E,W,X,q){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=T,this.view.offsetX=E,this.view.offsetY=W,this.view.width=X,this.view.height=q,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=(this.right-this.left)/(2*this.zoom),T=(this.top-this.bottom)/(2*this.zoom),E=(this.right+this.left)/2,W=(this.top+this.bottom)/2;let X=E-_,q=E+_,Y=W+T,te=W-T;if(this.view!==null&&this.view.enabled){const ne=(this.right-this.left)/this.view.fullWidth/this.zoom,ae=(this.top-this.bottom)/this.view.fullHeight/this.zoom;X+=ne*this.view.offsetX,q=X+ne*this.view.width,Y-=ae*this.view.offsetY,te=Y-ae*this.view.height}this.projectionMatrix.makeOrthographic(X,q,Y,te,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const T=super.toJSON(_);return T.object.zoom=this.zoom,T.object.left=this.left,T.object.right=this.right,T.object.top=this.top,T.object.bottom=this.bottom,T.object.near=this.near,T.object.far=this.far,this.view!==null&&(T.object.view=Object.assign({},this.view)),T}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0,_oldXrEnabled=!1;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(-PHI,INV_PHI,0),new Vector3(PHI,INV_PHI,0),new Vector3(-INV_PHI,0,PHI),new Vector3(INV_PHI,0,PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(0,PHI,INV_PHI),new Vector3(-1,1,-1),new Vector3(1,1,-1),new Vector3(-1,1,1),new Vector3(1,1,1)];class PMREMGenerator{constructor(_){this._renderer=_,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_,T=0,E=.1,W=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const X=this._allocateTargets();return X.depthBuffer=!0,this._sceneToCubeUV(_,E,W,X),T>0&&this._blur(X,0,0,T),this._applyPMREM(X),this._cleanup(X),X}fromEquirectangular(_,T=null){return this._fromTexture(_,T)}fromCubemap(_,T=null){return this._fromTexture(_,T)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_){this._lodMax=Math.floor(Math.log2(_)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _=0;_<this._lodPlanes.length;_++)this._lodPlanes[_].dispose()}_cleanup(_){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),this._renderer.xr.enabled=_oldXrEnabled,_.scissorTest=!1,_setViewport(_,0,0,_.width,_.height)}_fromTexture(_,T){_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping?this._setSize(_.image.length===0?16:_.image[0].width||_.image[0].image.width):this._setSize(_.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),_oldXrEnabled=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const E=T||this._allocateTargets();return this._textureToCubeUV(_,E),this._applyPMREM(E),this._cleanup(E),E}_allocateTargets(){const _=3*Math.max(this._cubeSize,112),T=4*this._cubeSize,E={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!1},W=_createRenderTarget(_,T,E);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_||this._pingPongRenderTarget.height!==T){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_,T,E);const{_lodMax:X}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(X)),this._blurMaterial=_getBlurShader(X,_,T)}return W}_compileMaterial(_){const T=new Mesh(this._lodPlanes[0],_);this._renderer.compile(T,_flatCamera)}_sceneToCubeUV(_,T,E,W){const Y=new PerspectiveCamera(90,1,T,E),te=[1,-1,1,1,1,1],ne=[1,1,1,-1,-1,-1],ae=this._renderer,le=ae.autoClear,ue=ae.toneMapping;ae.getClearColor(_clearColor),ae.toneMapping=NoToneMapping,ae.autoClear=!1;const ge=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),ye=new Mesh(new BoxGeometry,ge);let xe=!1;const Te=_.background;Te?Te.isColor&&(ge.color.copy(Te),_.background=null,xe=!0):(ge.color.copy(_clearColor),xe=!0);for(let Ae=0;Ae<6;Ae++){const Ie=Ae%3;Ie===0?(Y.up.set(0,te[Ae],0),Y.lookAt(ne[Ae],0,0)):Ie===1?(Y.up.set(0,0,te[Ae]),Y.lookAt(0,ne[Ae],0)):(Y.up.set(0,te[Ae],0),Y.lookAt(0,0,ne[Ae]));const Ve=this._cubeSize;_setViewport(W,Ie*Ve,Ae>2?Ve:0,Ve,Ve),ae.setRenderTarget(W),xe&&ae.render(ye,Y),ae.render(_,Y)}ye.geometry.dispose(),ye.material.dispose(),ae.toneMapping=ue,ae.autoClear=le,_.background=Te}_textureToCubeUV(_,T){const E=this._renderer,W=_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping;W?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const X=W?this._cubemapMaterial:this._equirectMaterial,q=new Mesh(this._lodPlanes[0],X),Y=X.uniforms;Y.envMap.value=_;const te=this._cubeSize;_setViewport(T,0,0,3*te,2*te),E.setRenderTarget(T),E.render(q,_flatCamera)}_applyPMREM(_){const T=this._renderer,E=T.autoClear;T.autoClear=!1;const W=this._lodPlanes.length;for(let X=1;X<W;X++){const q=Math.sqrt(this._sigmas[X]*this._sigmas[X]-this._sigmas[X-1]*this._sigmas[X-1]),Y=_axisDirections[(W-X-1)%_axisDirections.length];this._blur(_,X-1,X,q,Y)}T.autoClear=E}_blur(_,T,E,W,X){const q=this._pingPongRenderTarget;this._halfBlur(_,q,T,E,W,"latitudinal",X),this._halfBlur(q,_,E,E,W,"longitudinal",X)}_halfBlur(_,T,E,W,X,q,Y){const te=this._renderer,ne=this._blurMaterial;q!=="latitudinal"&&q!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ae=3,le=new Mesh(this._lodPlanes[W],ne),ue=ne.uniforms,ge=this._sizeLods[E]-1,ye=isFinite(X)?Math.PI/(2*ge):2*Math.PI/(2*MAX_SAMPLES-1),xe=X/ye,Te=isFinite(X)?1+Math.floor(ae*xe):MAX_SAMPLES;Te>MAX_SAMPLES&&console.warn(`sigmaRadians, ${X}, is too large and will clip, as it requested ${Te} samples when the maximum is set to ${MAX_SAMPLES}`);const Ae=[];let Ie=0;for(let je=0;je<MAX_SAMPLES;++je){const ze=je/xe,He=Math.exp(-ze*ze/2);Ae.push(He),je===0?Ie+=He:je<Te&&(Ie+=2*He)}for(let je=0;je<Ae.length;je++)Ae[je]=Ae[je]/Ie;ue.envMap.value=_.texture,ue.samples.value=Te,ue.weights.value=Ae,ue.latitudinal.value=q==="latitudinal",Y&&(ue.poleAxis.value=Y);const{_lodMax:Ve}=this;ue.dTheta.value=ye,ue.mipInt.value=Ve-E;const $e=this._sizeLods[W],We=3*$e*(W>Ve-LOD_MIN?W-Ve+LOD_MIN:0),Ue=4*(this._cubeSize-$e);_setViewport(T,We,Ue,3*$e,2*$e),te.setRenderTarget(T),te.render(le,_flatCamera)}}function _createPlanes(B){const _=[],T=[],E=[];let W=B;const X=B-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let q=0;q<X;q++){const Y=Math.pow(2,W);T.push(Y);let te=1/Y;q>B-LOD_MIN?te=EXTRA_LOD_SIGMA[q-B+LOD_MIN-1]:q===0&&(te=0),E.push(te);const ne=1/(Y-2),ae=-ne,le=1+ne,ue=[ae,ae,le,ae,le,le,ae,ae,le,le,ae,le],ge=6,ye=6,xe=3,Te=2,Ae=1,Ie=new Float32Array(xe*ye*ge),Ve=new Float32Array(Te*ye*ge),$e=new Float32Array(Ae*ye*ge);for(let Ue=0;Ue<ge;Ue++){const je=Ue%3*2/3-1,ze=Ue>2?0:-1,He=[je,ze,0,je+2/3,ze,0,je+2/3,ze+1,0,je,ze,0,je+2/3,ze+1,0,je,ze+1,0];Ie.set(He,xe*ye*Ue),Ve.set(ue,Te*ye*Ue);const Le=[Ue,Ue,Ue,Ue,Ue,Ue];$e.set(Le,Ae*ye*Ue)}const We=new BufferGeometry;We.setAttribute("position",new BufferAttribute(Ie,xe)),We.setAttribute("uv",new BufferAttribute(Ve,Te)),We.setAttribute("faceIndex",new BufferAttribute($e,Ae)),_.push(We),W>LOD_MIN&&W--}return{lodPlanes:_,sizeLods:T,sigmas:E}}function _createRenderTarget(B,_,T){const E=new WebGLRenderTarget(B,_,T);return E.texture.mapping=CubeUVReflectionMapping,E.texture.name="PMREM.cubeUv",E.scissorTest=!0,E}function _setViewport(B,_,T,E,W){B.viewport.set(_,T,E,W),B.scissor.set(_,T,E,W)}function _getBlurShader(B,_,T){const E=new Float32Array(MAX_SAMPLES),W=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_,CUBEUV_TEXEL_HEIGHT:1/T,CUBEUV_MAX_MIP:`${B}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:E},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:W}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(B){let _=new WeakMap,T=null;function E(Y){if(Y&&Y.isTexture){const te=Y.mapping,ne=te===EquirectangularReflectionMapping||te===EquirectangularRefractionMapping,ae=te===CubeReflectionMapping||te===CubeRefractionMapping;if(ne||ae){let le=_.get(Y);const ue=le!==void 0?le.texture.pmremVersion:0;if(Y.isRenderTargetTexture&&Y.pmremVersion!==ue)return T===null&&(T=new PMREMGenerator(B)),le=ne?T.fromEquirectangular(Y,le):T.fromCubemap(Y,le),le.texture.pmremVersion=Y.pmremVersion,_.set(Y,le),le.texture;if(le!==void 0)return le.texture;{const ge=Y.image;return ne&&ge&&ge.height>0||ae&&ge&&W(ge)?(T===null&&(T=new PMREMGenerator(B)),le=ne?T.fromEquirectangular(Y):T.fromCubemap(Y),le.texture.pmremVersion=Y.pmremVersion,_.set(Y,le),Y.addEventListener("dispose",X),le.texture):null}}}return Y}function W(Y){let te=0;const ne=6;for(let ae=0;ae<ne;ae++)Y[ae]!==void 0&&te++;return te===ne}function X(Y){const te=Y.target;te.removeEventListener("dispose",X);const ne=_.get(te);ne!==void 0&&(_.delete(te),ne.dispose())}function q(){_=new WeakMap,T!==null&&(T.dispose(),T=null)}return{get:E,dispose:q}}function WebGLExtensions(B){const _={};function T(E){if(_[E]!==void 0)return _[E];let W;switch(E){case"WEBGL_depth_texture":W=B.getExtension("WEBGL_depth_texture")||B.getExtension("MOZ_WEBGL_depth_texture")||B.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":W=B.getExtension("EXT_texture_filter_anisotropic")||B.getExtension("MOZ_EXT_texture_filter_anisotropic")||B.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":W=B.getExtension("WEBGL_compressed_texture_s3tc")||B.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||B.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":W=B.getExtension("WEBGL_compressed_texture_pvrtc")||B.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:W=B.getExtension(E)}return _[E]=W,W}return{has:function(E){return T(E)!==null},init:function(){T("EXT_color_buffer_float"),T("WEBGL_clip_cull_distance"),T("OES_texture_float_linear"),T("EXT_color_buffer_half_float"),T("WEBGL_multisampled_render_to_texture"),T("WEBGL_render_shared_exponent")},get:function(E){const W=T(E);return W===null&&console.warn("THREE.WebGLRenderer: "+E+" extension not supported."),W}}}function WebGLGeometries(B,_,T,E){const W={},X=new WeakMap;function q(le){const ue=le.target;ue.index!==null&&_.remove(ue.index);for(const ye in ue.attributes)_.remove(ue.attributes[ye]);for(const ye in ue.morphAttributes){const xe=ue.morphAttributes[ye];for(let Te=0,Ae=xe.length;Te<Ae;Te++)_.remove(xe[Te])}ue.removeEventListener("dispose",q),delete W[ue.id];const ge=X.get(ue);ge&&(_.remove(ge),X.delete(ue)),E.releaseStatesOfGeometry(ue),ue.isInstancedBufferGeometry===!0&&delete ue._maxInstanceCount,T.memory.geometries--}function Y(le,ue){return W[ue.id]===!0||(ue.addEventListener("dispose",q),W[ue.id]=!0,T.memory.geometries++),ue}function te(le){const ue=le.attributes;for(const ye in ue)_.update(ue[ye],B.ARRAY_BUFFER);const ge=le.morphAttributes;for(const ye in ge){const xe=ge[ye];for(let Te=0,Ae=xe.length;Te<Ae;Te++)_.update(xe[Te],B.ARRAY_BUFFER)}}function ne(le){const ue=[],ge=le.index,ye=le.attributes.position;let xe=0;if(ge!==null){const Ie=ge.array;xe=ge.version;for(let Ve=0,$e=Ie.length;Ve<$e;Ve+=3){const We=Ie[Ve+0],Ue=Ie[Ve+1],je=Ie[Ve+2];ue.push(We,Ue,Ue,je,je,We)}}else if(ye!==void 0){const Ie=ye.array;xe=ye.version;for(let Ve=0,$e=Ie.length/3-1;Ve<$e;Ve+=3){const We=Ve+0,Ue=Ve+1,je=Ve+2;ue.push(We,Ue,Ue,je,je,We)}}else return;const Te=new(arrayNeedsUint32(ue)?Uint32BufferAttribute:Uint16BufferAttribute)(ue,1);Te.version=xe;const Ae=X.get(le);Ae&&_.remove(Ae),X.set(le,Te)}function ae(le){const ue=X.get(le);if(ue){const ge=le.index;ge!==null&&ue.version<ge.version&&ne(le)}else ne(le);return X.get(le)}return{get:Y,update:te,getWireframeAttribute:ae}}function WebGLIndexedBufferRenderer(B,_,T){let E;function W(ue){E=ue}let X,q;function Y(ue){X=ue.type,q=ue.bytesPerElement}function te(ue,ge){B.drawElements(E,ge,X,ue*q),T.update(ge,E,1)}function ne(ue,ge,ye){ye!==0&&(B.drawElementsInstanced(E,ge,X,ue*q,ye),T.update(ge,E,ye))}function ae(ue,ge,ye){if(ye===0)return;const xe=_.get("WEBGL_multi_draw");if(xe===null)for(let Te=0;Te<ye;Te++)this.render(ue[Te]/q,ge[Te]);else{xe.multiDrawElementsWEBGL(E,ge,0,X,ue,0,ye);let Te=0;for(let Ae=0;Ae<ye;Ae++)Te+=ge[Ae];T.update(Te,E,1)}}function le(ue,ge,ye,xe){if(ye===0)return;const Te=_.get("WEBGL_multi_draw");if(Te===null)for(let Ae=0;Ae<ue.length;Ae++)ne(ue[Ae]/q,ge[Ae],xe[Ae]);else{Te.multiDrawElementsInstancedWEBGL(E,ge,0,X,ue,0,xe,0,ye);let Ae=0;for(let Ie=0;Ie<ye;Ie++)Ae+=ge[Ie];for(let Ie=0;Ie<xe.length;Ie++)T.update(Ae,E,xe[Ie])}}this.setMode=W,this.setIndex=Y,this.render=te,this.renderInstances=ne,this.renderMultiDraw=ae,this.renderMultiDrawInstances=le}function WebGLInfo(B){const _={geometries:0,textures:0},T={frame:0,calls:0,triangles:0,points:0,lines:0};function E(X,q,Y){switch(T.calls++,q){case B.TRIANGLES:T.triangles+=Y*(X/3);break;case B.LINES:T.lines+=Y*(X/2);break;case B.LINE_STRIP:T.lines+=Y*(X-1);break;case B.LINE_LOOP:T.lines+=Y*X;break;case B.POINTS:T.points+=Y*X;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",q);break}}function W(){T.calls=0,T.triangles=0,T.points=0,T.lines=0}return{memory:_,render:T,programs:null,autoReset:!0,reset:W,update:E}}function WebGLMorphtargets(B,_,T){const E=new WeakMap,W=new Vector4;function X(q,Y,te){const ne=q.morphTargetInfluences,ae=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,le=ae!==void 0?ae.length:0;let ue=E.get(Y);if(ue===void 0||ue.count!==le){let Le=function(){ze.dispose(),E.delete(Y),Y.removeEventListener("dispose",Le)};var ge=Le;ue!==void 0&&ue.texture.dispose();const ye=Y.morphAttributes.position!==void 0,xe=Y.morphAttributes.normal!==void 0,Te=Y.morphAttributes.color!==void 0,Ae=Y.morphAttributes.position||[],Ie=Y.morphAttributes.normal||[],Ve=Y.morphAttributes.color||[];let $e=0;ye===!0&&($e=1),xe===!0&&($e=2),Te===!0&&($e=3);let We=Y.attributes.position.count*$e,Ue=1;We>_.maxTextureSize&&(Ue=Math.ceil(We/_.maxTextureSize),We=_.maxTextureSize);const je=new Float32Array(We*Ue*4*le),ze=new DataArrayTexture(je,We,Ue,le);ze.type=FloatType,ze.needsUpdate=!0;const He=$e*4;for(let qe=0;qe<le;qe++){const Qe=Ae[qe],Ke=Ie[qe],Je=Ve[qe],pt=We*Ue*4*qe;for(let ut=0;ut<Qe.count;ut++){const lt=ut*He;ye===!0&&(W.fromBufferAttribute(Qe,ut),je[pt+lt+0]=W.x,je[pt+lt+1]=W.y,je[pt+lt+2]=W.z,je[pt+lt+3]=0),xe===!0&&(W.fromBufferAttribute(Ke,ut),je[pt+lt+4]=W.x,je[pt+lt+5]=W.y,je[pt+lt+6]=W.z,je[pt+lt+7]=0),Te===!0&&(W.fromBufferAttribute(Je,ut),je[pt+lt+8]=W.x,je[pt+lt+9]=W.y,je[pt+lt+10]=W.z,je[pt+lt+11]=Je.itemSize===4?W.w:1)}}ue={count:le,texture:ze,size:new Vector2(We,Ue)},E.set(Y,ue),Y.addEventListener("dispose",Le)}if(q.isInstancedMesh===!0&&q.morphTexture!==null)te.getUniforms().setValue(B,"morphTexture",q.morphTexture,T);else{let ye=0;for(let Te=0;Te<ne.length;Te++)ye+=ne[Te];const xe=Y.morphTargetsRelative?1:1-ye;te.getUniforms().setValue(B,"morphTargetBaseInfluence",xe),te.getUniforms().setValue(B,"morphTargetInfluences",ne)}te.getUniforms().setValue(B,"morphTargetsTexture",ue.texture,T),te.getUniforms().setValue(B,"morphTargetsTextureSize",ue.size)}return{update:X}}function WebGLObjects(B,_,T,E){let W=new WeakMap;function X(te){const ne=E.render.frame,ae=te.geometry,le=_.get(te,ae);if(W.get(le)!==ne&&(_.update(le),W.set(le,ne)),te.isInstancedMesh&&(te.hasEventListener("dispose",Y)===!1&&te.addEventListener("dispose",Y),W.get(te)!==ne&&(T.update(te.instanceMatrix,B.ARRAY_BUFFER),te.instanceColor!==null&&T.update(te.instanceColor,B.ARRAY_BUFFER),W.set(te,ne))),te.isSkinnedMesh){const ue=te.skeleton;W.get(ue)!==ne&&(ue.update(),W.set(ue,ne))}return le}function q(){W=new WeakMap}function Y(te){const ne=te.target;ne.removeEventListener("dispose",Y),T.remove(ne.instanceMatrix),ne.instanceColor!==null&&T.remove(ne.instanceColor)}return{update:X,dispose:q}}class DepthTexture extends Texture{constructor(_,T,E,W,X,q,Y,te,ne,ae){if(ae=ae!==void 0?ae:DepthFormat,ae!==DepthFormat&&ae!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");E===void 0&&ae===DepthFormat&&(E=UnsignedIntType),E===void 0&&ae===DepthStencilFormat&&(E=UnsignedInt248Type),super(null,W,X,q,Y,te,ae,E,ne),this.isDepthTexture=!0,this.image={width:_,height:T},this.magFilter=Y!==void 0?Y:NearestFilter,this.minFilter=te!==void 0?te:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(_){return super.copy(_),this.compareFunction=_.compareFunction,this}toJSON(_){const T=super.toJSON(_);return this.compareFunction!==null&&(T.compareFunction=this.compareFunction),T}}const emptyTexture=new Texture,emptyShadowTexture=new DepthTexture(1,1);emptyShadowTexture.compareFunction=LessEqualCompare;const emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten$1(B,_,T){const E=B[0];if(E<=0||E>0)return B;const W=_*T;let X=arrayCacheF32[W];if(X===void 0&&(X=new Float32Array(W),arrayCacheF32[W]=X),_!==0){E.toArray(X,0);for(let q=1,Y=0;q!==_;++q)Y+=T,B[q].toArray(X,Y)}return X}function arraysEqual(B,_){if(B.length!==_.length)return!1;for(let T=0,E=B.length;T<E;T++)if(B[T]!==_[T])return!1;return!0}function copyArray(B,_){for(let T=0,E=_.length;T<E;T++)B[T]=_[T]}function allocTexUnits(B,_){let T=arrayCacheI32[_];T===void 0&&(T=new Int32Array(_),arrayCacheI32[_]=T);for(let E=0;E!==_;++E)T[E]=B.allocateTextureUnit();return T}function setValueV1f(B,_){const T=this.cache;T[0]!==_&&(B.uniform1f(this.addr,_),T[0]=_)}function setValueV2f(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y)&&(B.uniform2f(this.addr,_.x,_.y),T[0]=_.x,T[1]=_.y);else{if(arraysEqual(T,_))return;B.uniform2fv(this.addr,_),copyArray(T,_)}}function setValueV3f(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y||T[2]!==_.z)&&(B.uniform3f(this.addr,_.x,_.y,_.z),T[0]=_.x,T[1]=_.y,T[2]=_.z);else if(_.r!==void 0)(T[0]!==_.r||T[1]!==_.g||T[2]!==_.b)&&(B.uniform3f(this.addr,_.r,_.g,_.b),T[0]=_.r,T[1]=_.g,T[2]=_.b);else{if(arraysEqual(T,_))return;B.uniform3fv(this.addr,_),copyArray(T,_)}}function setValueV4f(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y||T[2]!==_.z||T[3]!==_.w)&&(B.uniform4f(this.addr,_.x,_.y,_.z,_.w),T[0]=_.x,T[1]=_.y,T[2]=_.z,T[3]=_.w);else{if(arraysEqual(T,_))return;B.uniform4fv(this.addr,_),copyArray(T,_)}}function setValueM2(B,_){const T=this.cache,E=_.elements;if(E===void 0){if(arraysEqual(T,_))return;B.uniformMatrix2fv(this.addr,!1,_),copyArray(T,_)}else{if(arraysEqual(T,E))return;mat2array.set(E),B.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(T,E)}}function setValueM3(B,_){const T=this.cache,E=_.elements;if(E===void 0){if(arraysEqual(T,_))return;B.uniformMatrix3fv(this.addr,!1,_),copyArray(T,_)}else{if(arraysEqual(T,E))return;mat3array.set(E),B.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(T,E)}}function setValueM4(B,_){const T=this.cache,E=_.elements;if(E===void 0){if(arraysEqual(T,_))return;B.uniformMatrix4fv(this.addr,!1,_),copyArray(T,_)}else{if(arraysEqual(T,E))return;mat4array.set(E),B.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(T,E)}}function setValueV1i(B,_){const T=this.cache;T[0]!==_&&(B.uniform1i(this.addr,_),T[0]=_)}function setValueV2i(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y)&&(B.uniform2i(this.addr,_.x,_.y),T[0]=_.x,T[1]=_.y);else{if(arraysEqual(T,_))return;B.uniform2iv(this.addr,_),copyArray(T,_)}}function setValueV3i(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y||T[2]!==_.z)&&(B.uniform3i(this.addr,_.x,_.y,_.z),T[0]=_.x,T[1]=_.y,T[2]=_.z);else{if(arraysEqual(T,_))return;B.uniform3iv(this.addr,_),copyArray(T,_)}}function setValueV4i(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y||T[2]!==_.z||T[3]!==_.w)&&(B.uniform4i(this.addr,_.x,_.y,_.z,_.w),T[0]=_.x,T[1]=_.y,T[2]=_.z,T[3]=_.w);else{if(arraysEqual(T,_))return;B.uniform4iv(this.addr,_),copyArray(T,_)}}function setValueV1ui(B,_){const T=this.cache;T[0]!==_&&(B.uniform1ui(this.addr,_),T[0]=_)}function setValueV2ui(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y)&&(B.uniform2ui(this.addr,_.x,_.y),T[0]=_.x,T[1]=_.y);else{if(arraysEqual(T,_))return;B.uniform2uiv(this.addr,_),copyArray(T,_)}}function setValueV3ui(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y||T[2]!==_.z)&&(B.uniform3ui(this.addr,_.x,_.y,_.z),T[0]=_.x,T[1]=_.y,T[2]=_.z);else{if(arraysEqual(T,_))return;B.uniform3uiv(this.addr,_),copyArray(T,_)}}function setValueV4ui(B,_){const T=this.cache;if(_.x!==void 0)(T[0]!==_.x||T[1]!==_.y||T[2]!==_.z||T[3]!==_.w)&&(B.uniform4ui(this.addr,_.x,_.y,_.z,_.w),T[0]=_.x,T[1]=_.y,T[2]=_.z,T[3]=_.w);else{if(arraysEqual(T,_))return;B.uniform4uiv(this.addr,_),copyArray(T,_)}}function setValueT1(B,_,T){const E=this.cache,W=T.allocateTextureUnit();E[0]!==W&&(B.uniform1i(this.addr,W),E[0]=W);const X=this.type===B.SAMPLER_2D_SHADOW?emptyShadowTexture:emptyTexture;T.setTexture2D(_||X,W)}function setValueT3D1(B,_,T){const E=this.cache,W=T.allocateTextureUnit();E[0]!==W&&(B.uniform1i(this.addr,W),E[0]=W),T.setTexture3D(_||empty3dTexture,W)}function setValueT6(B,_,T){const E=this.cache,W=T.allocateTextureUnit();E[0]!==W&&(B.uniform1i(this.addr,W),E[0]=W),T.setTextureCube(_||emptyCubeTexture,W)}function setValueT2DArray1(B,_,T){const E=this.cache,W=T.allocateTextureUnit();E[0]!==W&&(B.uniform1i(this.addr,W),E[0]=W),T.setTexture2DArray(_||emptyArrayTexture,W)}function getSingularSetter(B){switch(B){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(B,_){B.uniform1fv(this.addr,_)}function setValueV2fArray(B,_){const T=flatten$1(_,this.size,2);B.uniform2fv(this.addr,T)}function setValueV3fArray(B,_){const T=flatten$1(_,this.size,3);B.uniform3fv(this.addr,T)}function setValueV4fArray(B,_){const T=flatten$1(_,this.size,4);B.uniform4fv(this.addr,T)}function setValueM2Array(B,_){const T=flatten$1(_,this.size,4);B.uniformMatrix2fv(this.addr,!1,T)}function setValueM3Array(B,_){const T=flatten$1(_,this.size,9);B.uniformMatrix3fv(this.addr,!1,T)}function setValueM4Array(B,_){const T=flatten$1(_,this.size,16);B.uniformMatrix4fv(this.addr,!1,T)}function setValueV1iArray(B,_){B.uniform1iv(this.addr,_)}function setValueV2iArray(B,_){B.uniform2iv(this.addr,_)}function setValueV3iArray(B,_){B.uniform3iv(this.addr,_)}function setValueV4iArray(B,_){B.uniform4iv(this.addr,_)}function setValueV1uiArray(B,_){B.uniform1uiv(this.addr,_)}function setValueV2uiArray(B,_){B.uniform2uiv(this.addr,_)}function setValueV3uiArray(B,_){B.uniform3uiv(this.addr,_)}function setValueV4uiArray(B,_){B.uniform4uiv(this.addr,_)}function setValueT1Array(B,_,T){const E=this.cache,W=_.length,X=allocTexUnits(T,W);arraysEqual(E,X)||(B.uniform1iv(this.addr,X),copyArray(E,X));for(let q=0;q!==W;++q)T.setTexture2D(_[q]||emptyTexture,X[q])}function setValueT3DArray(B,_,T){const E=this.cache,W=_.length,X=allocTexUnits(T,W);arraysEqual(E,X)||(B.uniform1iv(this.addr,X),copyArray(E,X));for(let q=0;q!==W;++q)T.setTexture3D(_[q]||empty3dTexture,X[q])}function setValueT6Array(B,_,T){const E=this.cache,W=_.length,X=allocTexUnits(T,W);arraysEqual(E,X)||(B.uniform1iv(this.addr,X),copyArray(E,X));for(let q=0;q!==W;++q)T.setTextureCube(_[q]||emptyCubeTexture,X[q])}function setValueT2DArrayArray(B,_,T){const E=this.cache,W=_.length,X=allocTexUnits(T,W);arraysEqual(E,X)||(B.uniform1iv(this.addr,X),copyArray(E,X));for(let q=0;q!==W;++q)T.setTexture2DArray(_[q]||emptyArrayTexture,X[q])}function getPureArraySetter(B){switch(B){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_,T,E){this.id=_,this.addr=E,this.cache=[],this.type=T.type,this.setValue=getSingularSetter(T.type)}}class PureArrayUniform{constructor(_,T,E){this.id=_,this.addr=E,this.cache=[],this.type=T.type,this.size=T.size,this.setValue=getPureArraySetter(T.type)}}class StructuredUniform{constructor(_){this.id=_,this.seq=[],this.map={}}setValue(_,T,E){const W=this.seq;for(let X=0,q=W.length;X!==q;++X){const Y=W[X];Y.setValue(_,T[Y.id],E)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(B,_){B.seq.push(_),B.map[_.id]=_}function parseUniform(B,_,T){const E=B.name,W=E.length;for(RePathPart.lastIndex=0;;){const X=RePathPart.exec(E),q=RePathPart.lastIndex;let Y=X[1];const te=X[2]==="]",ne=X[3];if(te&&(Y=Y|0),ne===void 0||ne==="["&&q+2===W){addUniform(T,ne===void 0?new SingleUniform(Y,B,_):new PureArrayUniform(Y,B,_));break}else{let le=T.map[Y];le===void 0&&(le=new StructuredUniform(Y),addUniform(T,le)),T=le}}}class WebGLUniforms{constructor(_,T){this.seq=[],this.map={};const E=_.getProgramParameter(T,_.ACTIVE_UNIFORMS);for(let W=0;W<E;++W){const X=_.getActiveUniform(T,W),q=_.getUniformLocation(T,X.name);parseUniform(X,q,this)}}setValue(_,T,E,W){const X=this.map[T];X!==void 0&&X.setValue(_,E,W)}setOptional(_,T,E){const W=T[E];W!==void 0&&this.setValue(_,E,W)}static upload(_,T,E,W){for(let X=0,q=T.length;X!==q;++X){const Y=T[X],te=E[Y.id];te.needsUpdate!==!1&&Y.setValue(_,te.value,W)}}static seqWithValue(_,T){const E=[];for(let W=0,X=_.length;W!==X;++W){const q=_[W];q.id in T&&E.push(q)}return E}}function WebGLShader(B,_,T){const E=B.createShader(_);return B.shaderSource(E,T),B.compileShader(E),E}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(B,_){const T=B.split(`
`),E=[],W=Math.max(_-6,0),X=Math.min(_+6,T.length);for(let q=W;q<X;q++){const Y=q+1;E.push(`${Y===_?">":" "} ${Y}: ${T[q]}`)}return E.join(`
`)}function getEncodingComponents(B){const _=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),T=ColorManagement.getPrimaries(B);let E;switch(_===T?E="":_===P3Primaries&&T===Rec709Primaries?E="LinearDisplayP3ToLinearSRGB":_===Rec709Primaries&&T===P3Primaries&&(E="LinearSRGBToLinearDisplayP3"),B){case LinearSRGBColorSpace:case LinearDisplayP3ColorSpace:return[E,"LinearTransferOETF"];case SRGBColorSpace:case DisplayP3ColorSpace:return[E,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",B),[E,"LinearTransferOETF"]}}function getShaderErrors(B,_,T){const E=B.getShaderParameter(_,B.COMPILE_STATUS),W=B.getShaderInfoLog(_).trim();if(E&&W==="")return"";const X=/ERROR: 0:(\d+)/.exec(W);if(X){const q=parseInt(X[1]);return T.toUpperCase()+`

`+W+`

`+handleSource(B.getShaderSource(_),q)}else return W}function getTexelEncodingFunction(B,_){const T=getEncodingComponents(_);return`vec4 ${B}( vec4 value ) { return ${T[0]}( ${T[1]}( value ) ); }`}function getToneMappingFunction(B,_){let T;switch(_){case LinearToneMapping:T="Linear";break;case ReinhardToneMapping:T="Reinhard";break;case CineonToneMapping:T="OptimizedCineon";break;case ACESFilmicToneMapping:T="ACESFilmic";break;case AgXToneMapping:T="AgX";break;case NeutralToneMapping:T="Neutral";break;case CustomToneMapping:T="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_),T="Linear"}return"vec3 "+B+"( vec3 color ) { return "+T+"ToneMapping( color ); }"}function generateVertexExtensions(B){return[B.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",B.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(B){const _=[];for(const T in B){const E=B[T];E!==!1&&_.push("#define "+T+" "+E)}return _.join(`
`)}function fetchAttributeLocations(B,_){const T={},E=B.getProgramParameter(_,B.ACTIVE_ATTRIBUTES);for(let W=0;W<E;W++){const X=B.getActiveAttrib(_,W),q=X.name;let Y=1;X.type===B.FLOAT_MAT2&&(Y=2),X.type===B.FLOAT_MAT3&&(Y=3),X.type===B.FLOAT_MAT4&&(Y=4),T[q]={type:X.type,location:B.getAttribLocation(_,q),locationSize:Y}}return T}function filterEmptyLine(B){return B!==""}function replaceLightNums(B,_){const T=_.numSpotLightShadows+_.numSpotLightMaps-_.numSpotLightShadowsWithMaps;return B.replace(/NUM_DIR_LIGHTS/g,_.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,T).replace(/NUM_RECT_AREA_LIGHTS/g,_.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_.numPointLightShadows)}function replaceClippingPlaneNums(B,_){return B.replace(/NUM_CLIPPING_PLANES/g,_.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_.numClippingPlanes-_.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(B){return B.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map;function includeReplacer(B,_){let T=ShaderChunk[_];if(T===void 0){const E=shaderChunkMap.get(_);if(E!==void 0)T=ShaderChunk[E],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',_,E);else throw new Error("Can not resolve #include <"+_+">")}return resolveIncludes(T)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(B){return B.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(B,_,T,E){let W="";for(let X=parseInt(_);X<parseInt(T);X++)W+=E.replace(/\[\s*i\s*\]/g,"[ "+X+" ]").replace(/UNROLLED_LOOP_INDEX/g,X);return W}function generatePrecision(B){let _=`precision ${B.precision} float;
	precision ${B.precision} int;
	precision ${B.precision} sampler2D;
	precision ${B.precision} samplerCube;
	precision ${B.precision} sampler3D;
	precision ${B.precision} sampler2DArray;
	precision ${B.precision} sampler2DShadow;
	precision ${B.precision} samplerCubeShadow;
	precision ${B.precision} sampler2DArrayShadow;
	precision ${B.precision} isampler2D;
	precision ${B.precision} isampler3D;
	precision ${B.precision} isamplerCube;
	precision ${B.precision} isampler2DArray;
	precision ${B.precision} usampler2D;
	precision ${B.precision} usampler3D;
	precision ${B.precision} usamplerCube;
	precision ${B.precision} usampler2DArray;
	`;return B.precision==="highp"?_+=`
#define HIGH_PRECISION`:B.precision==="mediump"?_+=`
#define MEDIUM_PRECISION`:B.precision==="lowp"&&(_+=`
#define LOW_PRECISION`),_}function generateShadowMapTypeDefine(B){let _="SHADOWMAP_TYPE_BASIC";return B.shadowMapType===PCFShadowMap?_="SHADOWMAP_TYPE_PCF":B.shadowMapType===PCFSoftShadowMap?_="SHADOWMAP_TYPE_PCF_SOFT":B.shadowMapType===VSMShadowMap&&(_="SHADOWMAP_TYPE_VSM"),_}function generateEnvMapTypeDefine(B){let _="ENVMAP_TYPE_CUBE";if(B.envMap)switch(B.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_="ENVMAP_TYPE_CUBE_UV";break}return _}function generateEnvMapModeDefine(B){let _="ENVMAP_MODE_REFLECTION";if(B.envMap)switch(B.envMapMode){case CubeRefractionMapping:_="ENVMAP_MODE_REFRACTION";break}return _}function generateEnvMapBlendingDefine(B){let _="ENVMAP_BLENDING_NONE";if(B.envMap)switch(B.combine){case MultiplyOperation:_="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_="ENVMAP_BLENDING_MIX";break;case AddOperation:_="ENVMAP_BLENDING_ADD";break}return _}function generateCubeUVSize(B){const _=B.envMapCubeUVHeight;if(_===null)return null;const T=Math.log2(_)-2,E=1/_;return{texelWidth:1/(3*Math.max(Math.pow(2,T),7*16)),texelHeight:E,maxMip:T}}function WebGLProgram(B,_,T,E){const W=B.getContext(),X=T.defines;let q=T.vertexShader,Y=T.fragmentShader;const te=generateShadowMapTypeDefine(T),ne=generateEnvMapTypeDefine(T),ae=generateEnvMapModeDefine(T),le=generateEnvMapBlendingDefine(T),ue=generateCubeUVSize(T),ge=generateVertexExtensions(T),ye=generateDefines(X),xe=W.createProgram();let Te,Ae,Ie=T.glslVersion?"#version "+T.glslVersion+`
`:"";T.isRawShaderMaterial?(Te=["#define SHADER_TYPE "+T.shaderType,"#define SHADER_NAME "+T.shaderName,ye].filter(filterEmptyLine).join(`
`),Te.length>0&&(Te+=`
`),Ae=["#define SHADER_TYPE "+T.shaderType,"#define SHADER_NAME "+T.shaderName,ye].filter(filterEmptyLine).join(`
`),Ae.length>0&&(Ae+=`
`)):(Te=[generatePrecision(T),"#define SHADER_TYPE "+T.shaderType,"#define SHADER_NAME "+T.shaderName,ye,T.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",T.batching?"#define USE_BATCHING":"",T.instancing?"#define USE_INSTANCING":"",T.instancingColor?"#define USE_INSTANCING_COLOR":"",T.instancingMorph?"#define USE_INSTANCING_MORPH":"",T.useFog&&T.fog?"#define USE_FOG":"",T.useFog&&T.fogExp2?"#define FOG_EXP2":"",T.map?"#define USE_MAP":"",T.envMap?"#define USE_ENVMAP":"",T.envMap?"#define "+ae:"",T.lightMap?"#define USE_LIGHTMAP":"",T.aoMap?"#define USE_AOMAP":"",T.bumpMap?"#define USE_BUMPMAP":"",T.normalMap?"#define USE_NORMALMAP":"",T.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",T.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",T.displacementMap?"#define USE_DISPLACEMENTMAP":"",T.emissiveMap?"#define USE_EMISSIVEMAP":"",T.anisotropy?"#define USE_ANISOTROPY":"",T.anisotropyMap?"#define USE_ANISOTROPYMAP":"",T.clearcoatMap?"#define USE_CLEARCOATMAP":"",T.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",T.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",T.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",T.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",T.specularMap?"#define USE_SPECULARMAP":"",T.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",T.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",T.roughnessMap?"#define USE_ROUGHNESSMAP":"",T.metalnessMap?"#define USE_METALNESSMAP":"",T.alphaMap?"#define USE_ALPHAMAP":"",T.alphaHash?"#define USE_ALPHAHASH":"",T.transmission?"#define USE_TRANSMISSION":"",T.transmissionMap?"#define USE_TRANSMISSIONMAP":"",T.thicknessMap?"#define USE_THICKNESSMAP":"",T.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",T.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",T.mapUv?"#define MAP_UV "+T.mapUv:"",T.alphaMapUv?"#define ALPHAMAP_UV "+T.alphaMapUv:"",T.lightMapUv?"#define LIGHTMAP_UV "+T.lightMapUv:"",T.aoMapUv?"#define AOMAP_UV "+T.aoMapUv:"",T.emissiveMapUv?"#define EMISSIVEMAP_UV "+T.emissiveMapUv:"",T.bumpMapUv?"#define BUMPMAP_UV "+T.bumpMapUv:"",T.normalMapUv?"#define NORMALMAP_UV "+T.normalMapUv:"",T.displacementMapUv?"#define DISPLACEMENTMAP_UV "+T.displacementMapUv:"",T.metalnessMapUv?"#define METALNESSMAP_UV "+T.metalnessMapUv:"",T.roughnessMapUv?"#define ROUGHNESSMAP_UV "+T.roughnessMapUv:"",T.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+T.anisotropyMapUv:"",T.clearcoatMapUv?"#define CLEARCOATMAP_UV "+T.clearcoatMapUv:"",T.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+T.clearcoatNormalMapUv:"",T.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+T.clearcoatRoughnessMapUv:"",T.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+T.iridescenceMapUv:"",T.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+T.iridescenceThicknessMapUv:"",T.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+T.sheenColorMapUv:"",T.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+T.sheenRoughnessMapUv:"",T.specularMapUv?"#define SPECULARMAP_UV "+T.specularMapUv:"",T.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+T.specularColorMapUv:"",T.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+T.specularIntensityMapUv:"",T.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+T.transmissionMapUv:"",T.thicknessMapUv?"#define THICKNESSMAP_UV "+T.thicknessMapUv:"",T.vertexTangents&&T.flatShading===!1?"#define USE_TANGENT":"",T.vertexColors?"#define USE_COLOR":"",T.vertexAlphas?"#define USE_COLOR_ALPHA":"",T.vertexUv1s?"#define USE_UV1":"",T.vertexUv2s?"#define USE_UV2":"",T.vertexUv3s?"#define USE_UV3":"",T.pointsUvs?"#define USE_POINTS_UV":"",T.flatShading?"#define FLAT_SHADED":"",T.skinning?"#define USE_SKINNING":"",T.morphTargets?"#define USE_MORPHTARGETS":"",T.morphNormals&&T.flatShading===!1?"#define USE_MORPHNORMALS":"",T.morphColors?"#define USE_MORPHCOLORS":"",T.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",T.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+T.morphTextureStride:"",T.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+T.morphTargetsCount:"",T.doubleSided?"#define DOUBLE_SIDED":"",T.flipSided?"#define FLIP_SIDED":"",T.shadowMapEnabled?"#define USE_SHADOWMAP":"",T.shadowMapEnabled?"#define "+te:"",T.sizeAttenuation?"#define USE_SIZEATTENUATION":"",T.numLightProbes>0?"#define USE_LIGHT_PROBES":"",T.useLegacyLights?"#define LEGACY_LIGHTS":"",T.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),Ae=[generatePrecision(T),"#define SHADER_TYPE "+T.shaderType,"#define SHADER_NAME "+T.shaderName,ye,T.useFog&&T.fog?"#define USE_FOG":"",T.useFog&&T.fogExp2?"#define FOG_EXP2":"",T.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",T.map?"#define USE_MAP":"",T.matcap?"#define USE_MATCAP":"",T.envMap?"#define USE_ENVMAP":"",T.envMap?"#define "+ne:"",T.envMap?"#define "+ae:"",T.envMap?"#define "+le:"",ue?"#define CUBEUV_TEXEL_WIDTH "+ue.texelWidth:"",ue?"#define CUBEUV_TEXEL_HEIGHT "+ue.texelHeight:"",ue?"#define CUBEUV_MAX_MIP "+ue.maxMip+".0":"",T.lightMap?"#define USE_LIGHTMAP":"",T.aoMap?"#define USE_AOMAP":"",T.bumpMap?"#define USE_BUMPMAP":"",T.normalMap?"#define USE_NORMALMAP":"",T.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",T.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",T.emissiveMap?"#define USE_EMISSIVEMAP":"",T.anisotropy?"#define USE_ANISOTROPY":"",T.anisotropyMap?"#define USE_ANISOTROPYMAP":"",T.clearcoat?"#define USE_CLEARCOAT":"",T.clearcoatMap?"#define USE_CLEARCOATMAP":"",T.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",T.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",T.dispersion?"#define USE_DISPERSION":"",T.iridescence?"#define USE_IRIDESCENCE":"",T.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",T.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",T.specularMap?"#define USE_SPECULARMAP":"",T.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",T.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",T.roughnessMap?"#define USE_ROUGHNESSMAP":"",T.metalnessMap?"#define USE_METALNESSMAP":"",T.alphaMap?"#define USE_ALPHAMAP":"",T.alphaTest?"#define USE_ALPHATEST":"",T.alphaHash?"#define USE_ALPHAHASH":"",T.sheen?"#define USE_SHEEN":"",T.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",T.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",T.transmission?"#define USE_TRANSMISSION":"",T.transmissionMap?"#define USE_TRANSMISSIONMAP":"",T.thicknessMap?"#define USE_THICKNESSMAP":"",T.vertexTangents&&T.flatShading===!1?"#define USE_TANGENT":"",T.vertexColors||T.instancingColor?"#define USE_COLOR":"",T.vertexAlphas?"#define USE_COLOR_ALPHA":"",T.vertexUv1s?"#define USE_UV1":"",T.vertexUv2s?"#define USE_UV2":"",T.vertexUv3s?"#define USE_UV3":"",T.pointsUvs?"#define USE_POINTS_UV":"",T.gradientMap?"#define USE_GRADIENTMAP":"",T.flatShading?"#define FLAT_SHADED":"",T.doubleSided?"#define DOUBLE_SIDED":"",T.flipSided?"#define FLIP_SIDED":"",T.shadowMapEnabled?"#define USE_SHADOWMAP":"",T.shadowMapEnabled?"#define "+te:"",T.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",T.numLightProbes>0?"#define USE_LIGHT_PROBES":"",T.useLegacyLights?"#define LEGACY_LIGHTS":"",T.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",T.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",T.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",T.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",T.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",T.toneMapping):"",T.dithering?"#define DITHERING":"",T.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",T.outputColorSpace),T.useDepthPacking?"#define DEPTH_PACKING "+T.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),q=resolveIncludes(q),q=replaceLightNums(q,T),q=replaceClippingPlaneNums(q,T),Y=resolveIncludes(Y),Y=replaceLightNums(Y,T),Y=replaceClippingPlaneNums(Y,T),q=unrollLoops(q),Y=unrollLoops(Y),T.isRawShaderMaterial!==!0&&(Ie=`#version 300 es
`,Te=[ge,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Te,Ae=["#define varying in",T.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",T.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Ae);const Ve=Ie+Te+q,$e=Ie+Ae+Y,We=WebGLShader(W,W.VERTEX_SHADER,Ve),Ue=WebGLShader(W,W.FRAGMENT_SHADER,$e);W.attachShader(xe,We),W.attachShader(xe,Ue),T.index0AttributeName!==void 0?W.bindAttribLocation(xe,0,T.index0AttributeName):T.morphTargets===!0&&W.bindAttribLocation(xe,0,"position"),W.linkProgram(xe);function je(qe){if(B.debug.checkShaderErrors){const Qe=W.getProgramInfoLog(xe).trim(),Ke=W.getShaderInfoLog(We).trim(),Je=W.getShaderInfoLog(Ue).trim();let pt=!0,ut=!0;if(W.getProgramParameter(xe,W.LINK_STATUS)===!1)if(pt=!1,typeof B.debug.onShaderError=="function")B.debug.onShaderError(W,xe,We,Ue);else{const lt=getShaderErrors(W,We,"vertex"),st=getShaderErrors(W,Ue,"fragment");console.error("THREE.WebGLProgram: Shader Error "+W.getError()+" - VALIDATE_STATUS "+W.getProgramParameter(xe,W.VALIDATE_STATUS)+`

Material Name: `+qe.name+`
Material Type: `+qe.type+`

Program Info Log: `+Qe+`
`+lt+`
`+st)}else Qe!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Qe):(Ke===""||Je==="")&&(ut=!1);ut&&(qe.diagnostics={runnable:pt,programLog:Qe,vertexShader:{log:Ke,prefix:Te},fragmentShader:{log:Je,prefix:Ae}})}W.deleteShader(We),W.deleteShader(Ue),ze=new WebGLUniforms(W,xe),He=fetchAttributeLocations(W,xe)}let ze;this.getUniforms=function(){return ze===void 0&&je(this),ze};let He;this.getAttributes=function(){return He===void 0&&je(this),He};let Le=T.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Le===!1&&(Le=W.getProgramParameter(xe,COMPLETION_STATUS_KHR)),Le},this.destroy=function(){E.releaseStatesOfProgram(this),W.deleteProgram(xe),this.program=void 0},this.type=T.shaderType,this.name=T.shaderName,this.id=programIdCount++,this.cacheKey=_,this.usedTimes=1,this.program=xe,this.vertexShader=We,this.fragmentShader=Ue,this}let _id$1=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_){const T=_.vertexShader,E=_.fragmentShader,W=this._getShaderStage(T),X=this._getShaderStage(E),q=this._getShaderCacheForMaterial(_);return q.has(W)===!1&&(q.add(W),W.usedTimes++),q.has(X)===!1&&(q.add(X),X.usedTimes++),this}remove(_){const T=this.materialCache.get(_);for(const E of T)E.usedTimes--,E.usedTimes===0&&this.shaderCache.delete(E.code);return this.materialCache.delete(_),this}getVertexShaderID(_){return this._getShaderStage(_.vertexShader).id}getFragmentShaderID(_){return this._getShaderStage(_.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_){const T=this.materialCache;let E=T.get(_);return E===void 0&&(E=new Set,T.set(_,E)),E}_getShaderStage(_){const T=this.shaderCache;let E=T.get(_);return E===void 0&&(E=new WebGLShaderStage(_),T.set(_,E)),E}}class WebGLShaderStage{constructor(_){this.id=_id$1++,this.code=_,this.usedTimes=0}}function WebGLPrograms(B,_,T,E,W,X,q){const Y=new Layers,te=new WebGLShaderCache,ne=new Set,ae=[],le=W.logarithmicDepthBuffer,ue=W.vertexTextures;let ge=W.precision;const ye={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function xe(He){return ne.add(He),He===0?"uv":`uv${He}`}function Te(He,Le,qe,Qe,Ke){const Je=Qe.fog,pt=Ke.geometry,ut=He.isMeshStandardMaterial?Qe.environment:null,lt=(He.isMeshStandardMaterial?T:_).get(He.envMap||ut),st=lt&&lt.mapping===CubeUVReflectionMapping?lt.image.height:null,sr=ye[He.type];He.precision!==null&&(ge=W.getMaxPrecision(He.precision),ge!==He.precision&&console.warn("THREE.WebGLProgram.getParameters:",He.precision,"not supported, using",ge,"instead."));const mt=pt.morphAttributes.position||pt.morphAttributes.normal||pt.morphAttributes.color,Tr=mt!==void 0?mt.length:0;let di=0;pt.morphAttributes.position!==void 0&&(di=1),pt.morphAttributes.normal!==void 0&&(di=2),pt.morphAttributes.color!==void 0&&(di=3);let Mi,Gr,ci,gi;if(sr){const Bn=ShaderLib[sr];Mi=Bn.vertexShader,Gr=Bn.fragmentShader}else Mi=He.vertexShader,Gr=He.fragmentShader,te.update(He),ci=te.getVertexShaderID(He),gi=te.getFragmentShaderID(He);const fi=B.getRenderTarget(),ri=Ke.isInstancedMesh===!0,ot=Ke.isBatchedMesh===!0,rt=!!He.map,gt=!!He.matcap,Or=!!lt,et=!!He.aoMap,at=!!He.lightMap,Rr=!!He.bumpMap,Br=!!He.normalMap,Kr=!!He.displacementMap,oi=!!He.emissiveMap,ct=!!He.metalnessMap,nt=!!He.roughnessMap,Ir=He.anisotropy>0,Dr=He.clearcoat>0,ti=He.dispersion>0,si=He.iridescence>0,Ai=He.sheen>0,Oi=He.transmission>0,Ci=Ir&&!!He.anisotropyMap,Wi=Dr&&!!He.clearcoatMap,ki=Dr&&!!He.clearcoatNormalMap,Li=Dr&&!!He.clearcoatRoughnessMap,mn=si&&!!He.iridescenceMap,cn=si&&!!He.iridescenceThicknessMap,qi=Ai&&!!He.sheenColorMap,wn=Ai&&!!He.sheenRoughnessMap,An=!!He.specularMap,Hr=!!He.specularColorMap,vi=!!He.specularIntensityMap,Lr=Oi&&!!He.transmissionMap,_i=Oi&&!!He.thicknessMap,xi=!!He.gradientMap,Ni=!!He.alphaMap,Ui=He.alphaTest>0,Vn=!!He.alphaHash,Dn=!!He.extensions;let Wn=NoToneMapping;He.toneMapped&&(fi===null||fi.isXRRenderTarget===!0)&&(Wn=B.toneMapping);const es={shaderID:sr,shaderType:He.type,shaderName:He.name,vertexShader:Mi,fragmentShader:Gr,defines:He.defines,customVertexShaderID:ci,customFragmentShaderID:gi,isRawShaderMaterial:He.isRawShaderMaterial===!0,glslVersion:He.glslVersion,precision:ge,batching:ot,instancing:ri,instancingColor:ri&&Ke.instanceColor!==null,instancingMorph:ri&&Ke.morphTexture!==null,supportsVertexTextures:ue,outputColorSpace:fi===null?B.outputColorSpace:fi.isXRRenderTarget===!0?fi.texture.colorSpace:LinearSRGBColorSpace,alphaToCoverage:!!He.alphaToCoverage,map:rt,matcap:gt,envMap:Or,envMapMode:Or&&lt.mapping,envMapCubeUVHeight:st,aoMap:et,lightMap:at,bumpMap:Rr,normalMap:Br,displacementMap:ue&&Kr,emissiveMap:oi,normalMapObjectSpace:Br&&He.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:Br&&He.normalMapType===TangentSpaceNormalMap,metalnessMap:ct,roughnessMap:nt,anisotropy:Ir,anisotropyMap:Ci,clearcoat:Dr,clearcoatMap:Wi,clearcoatNormalMap:ki,clearcoatRoughnessMap:Li,dispersion:ti,iridescence:si,iridescenceMap:mn,iridescenceThicknessMap:cn,sheen:Ai,sheenColorMap:qi,sheenRoughnessMap:wn,specularMap:An,specularColorMap:Hr,specularIntensityMap:vi,transmission:Oi,transmissionMap:Lr,thicknessMap:_i,gradientMap:xi,opaque:He.transparent===!1&&He.blending===NormalBlending&&He.alphaToCoverage===!1,alphaMap:Ni,alphaTest:Ui,alphaHash:Vn,combine:He.combine,mapUv:rt&&xe(He.map.channel),aoMapUv:et&&xe(He.aoMap.channel),lightMapUv:at&&xe(He.lightMap.channel),bumpMapUv:Rr&&xe(He.bumpMap.channel),normalMapUv:Br&&xe(He.normalMap.channel),displacementMapUv:Kr&&xe(He.displacementMap.channel),emissiveMapUv:oi&&xe(He.emissiveMap.channel),metalnessMapUv:ct&&xe(He.metalnessMap.channel),roughnessMapUv:nt&&xe(He.roughnessMap.channel),anisotropyMapUv:Ci&&xe(He.anisotropyMap.channel),clearcoatMapUv:Wi&&xe(He.clearcoatMap.channel),clearcoatNormalMapUv:ki&&xe(He.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Li&&xe(He.clearcoatRoughnessMap.channel),iridescenceMapUv:mn&&xe(He.iridescenceMap.channel),iridescenceThicknessMapUv:cn&&xe(He.iridescenceThicknessMap.channel),sheenColorMapUv:qi&&xe(He.sheenColorMap.channel),sheenRoughnessMapUv:wn&&xe(He.sheenRoughnessMap.channel),specularMapUv:An&&xe(He.specularMap.channel),specularColorMapUv:Hr&&xe(He.specularColorMap.channel),specularIntensityMapUv:vi&&xe(He.specularIntensityMap.channel),transmissionMapUv:Lr&&xe(He.transmissionMap.channel),thicknessMapUv:_i&&xe(He.thicknessMap.channel),alphaMapUv:Ni&&xe(He.alphaMap.channel),vertexTangents:!!pt.attributes.tangent&&(Br||Ir),vertexColors:He.vertexColors,vertexAlphas:He.vertexColors===!0&&!!pt.attributes.color&&pt.attributes.color.itemSize===4,pointsUvs:Ke.isPoints===!0&&!!pt.attributes.uv&&(rt||Ni),fog:!!Je,useFog:He.fog===!0,fogExp2:!!Je&&Je.isFogExp2,flatShading:He.flatShading===!0,sizeAttenuation:He.sizeAttenuation===!0,logarithmicDepthBuffer:le,skinning:Ke.isSkinnedMesh===!0,morphTargets:pt.morphAttributes.position!==void 0,morphNormals:pt.morphAttributes.normal!==void 0,morphColors:pt.morphAttributes.color!==void 0,morphTargetsCount:Tr,morphTextureStride:di,numDirLights:Le.directional.length,numPointLights:Le.point.length,numSpotLights:Le.spot.length,numSpotLightMaps:Le.spotLightMap.length,numRectAreaLights:Le.rectArea.length,numHemiLights:Le.hemi.length,numDirLightShadows:Le.directionalShadowMap.length,numPointLightShadows:Le.pointShadowMap.length,numSpotLightShadows:Le.spotShadowMap.length,numSpotLightShadowsWithMaps:Le.numSpotLightShadowsWithMaps,numLightProbes:Le.numLightProbes,numClippingPlanes:q.numPlanes,numClipIntersection:q.numIntersection,dithering:He.dithering,shadowMapEnabled:B.shadowMap.enabled&&qe.length>0,shadowMapType:B.shadowMap.type,toneMapping:Wn,useLegacyLights:B._useLegacyLights,decodeVideoTexture:rt&&He.map.isVideoTexture===!0&&ColorManagement.getTransfer(He.map.colorSpace)===SRGBTransfer,premultipliedAlpha:He.premultipliedAlpha,doubleSided:He.side===DoubleSide,flipSided:He.side===BackSide,useDepthPacking:He.depthPacking>=0,depthPacking:He.depthPacking||0,index0AttributeName:He.index0AttributeName,extensionClipCullDistance:Dn&&He.extensions.clipCullDistance===!0&&E.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Dn&&He.extensions.multiDraw===!0&&E.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:E.has("KHR_parallel_shader_compile"),customProgramCacheKey:He.customProgramCacheKey()};return es.vertexUv1s=ne.has(1),es.vertexUv2s=ne.has(2),es.vertexUv3s=ne.has(3),ne.clear(),es}function Ae(He){const Le=[];if(He.shaderID?Le.push(He.shaderID):(Le.push(He.customVertexShaderID),Le.push(He.customFragmentShaderID)),He.defines!==void 0)for(const qe in He.defines)Le.push(qe),Le.push(He.defines[qe]);return He.isRawShaderMaterial===!1&&(Ie(Le,He),Ve(Le,He),Le.push(B.outputColorSpace)),Le.push(He.customProgramCacheKey),Le.join()}function Ie(He,Le){He.push(Le.precision),He.push(Le.outputColorSpace),He.push(Le.envMapMode),He.push(Le.envMapCubeUVHeight),He.push(Le.mapUv),He.push(Le.alphaMapUv),He.push(Le.lightMapUv),He.push(Le.aoMapUv),He.push(Le.bumpMapUv),He.push(Le.normalMapUv),He.push(Le.displacementMapUv),He.push(Le.emissiveMapUv),He.push(Le.metalnessMapUv),He.push(Le.roughnessMapUv),He.push(Le.anisotropyMapUv),He.push(Le.clearcoatMapUv),He.push(Le.clearcoatNormalMapUv),He.push(Le.clearcoatRoughnessMapUv),He.push(Le.iridescenceMapUv),He.push(Le.iridescenceThicknessMapUv),He.push(Le.sheenColorMapUv),He.push(Le.sheenRoughnessMapUv),He.push(Le.specularMapUv),He.push(Le.specularColorMapUv),He.push(Le.specularIntensityMapUv),He.push(Le.transmissionMapUv),He.push(Le.thicknessMapUv),He.push(Le.combine),He.push(Le.fogExp2),He.push(Le.sizeAttenuation),He.push(Le.morphTargetsCount),He.push(Le.morphAttributeCount),He.push(Le.numDirLights),He.push(Le.numPointLights),He.push(Le.numSpotLights),He.push(Le.numSpotLightMaps),He.push(Le.numHemiLights),He.push(Le.numRectAreaLights),He.push(Le.numDirLightShadows),He.push(Le.numPointLightShadows),He.push(Le.numSpotLightShadows),He.push(Le.numSpotLightShadowsWithMaps),He.push(Le.numLightProbes),He.push(Le.shadowMapType),He.push(Le.toneMapping),He.push(Le.numClippingPlanes),He.push(Le.numClipIntersection),He.push(Le.depthPacking)}function Ve(He,Le){Y.disableAll(),Le.supportsVertexTextures&&Y.enable(0),Le.instancing&&Y.enable(1),Le.instancingColor&&Y.enable(2),Le.instancingMorph&&Y.enable(3),Le.matcap&&Y.enable(4),Le.envMap&&Y.enable(5),Le.normalMapObjectSpace&&Y.enable(6),Le.normalMapTangentSpace&&Y.enable(7),Le.clearcoat&&Y.enable(8),Le.iridescence&&Y.enable(9),Le.alphaTest&&Y.enable(10),Le.vertexColors&&Y.enable(11),Le.vertexAlphas&&Y.enable(12),Le.vertexUv1s&&Y.enable(13),Le.vertexUv2s&&Y.enable(14),Le.vertexUv3s&&Y.enable(15),Le.vertexTangents&&Y.enable(16),Le.anisotropy&&Y.enable(17),Le.alphaHash&&Y.enable(18),Le.batching&&Y.enable(19),Le.dispersion&&Y.enable(20),He.push(Y.mask),Y.disableAll(),Le.fog&&Y.enable(0),Le.useFog&&Y.enable(1),Le.flatShading&&Y.enable(2),Le.logarithmicDepthBuffer&&Y.enable(3),Le.skinning&&Y.enable(4),Le.morphTargets&&Y.enable(5),Le.morphNormals&&Y.enable(6),Le.morphColors&&Y.enable(7),Le.premultipliedAlpha&&Y.enable(8),Le.shadowMapEnabled&&Y.enable(9),Le.useLegacyLights&&Y.enable(10),Le.doubleSided&&Y.enable(11),Le.flipSided&&Y.enable(12),Le.useDepthPacking&&Y.enable(13),Le.dithering&&Y.enable(14),Le.transmission&&Y.enable(15),Le.sheen&&Y.enable(16),Le.opaque&&Y.enable(17),Le.pointsUvs&&Y.enable(18),Le.decodeVideoTexture&&Y.enable(19),Le.alphaToCoverage&&Y.enable(20),He.push(Y.mask)}function $e(He){const Le=ye[He.type];let qe;if(Le){const Qe=ShaderLib[Le];qe=UniformsUtils.clone(Qe.uniforms)}else qe=He.uniforms;return qe}function We(He,Le){let qe;for(let Qe=0,Ke=ae.length;Qe<Ke;Qe++){const Je=ae[Qe];if(Je.cacheKey===Le){qe=Je,++qe.usedTimes;break}}return qe===void 0&&(qe=new WebGLProgram(B,Le,He,X),ae.push(qe)),qe}function Ue(He){if(--He.usedTimes===0){const Le=ae.indexOf(He);ae[Le]=ae[ae.length-1],ae.pop(),He.destroy()}}function je(He){te.remove(He)}function ze(){te.dispose()}return{getParameters:Te,getProgramCacheKey:Ae,getUniforms:$e,acquireProgram:We,releaseProgram:Ue,releaseShaderCache:je,programs:ae,dispose:ze}}function WebGLProperties(){let B=new WeakMap;function _(X){let q=B.get(X);return q===void 0&&(q={},B.set(X,q)),q}function T(X){B.delete(X)}function E(X,q,Y){B.get(X)[q]=Y}function W(){B=new WeakMap}return{get:_,remove:T,update:E,dispose:W}}function painterSortStable(B,_){return B.groupOrder!==_.groupOrder?B.groupOrder-_.groupOrder:B.renderOrder!==_.renderOrder?B.renderOrder-_.renderOrder:B.material.id!==_.material.id?B.material.id-_.material.id:B.z!==_.z?B.z-_.z:B.id-_.id}function reversePainterSortStable(B,_){return B.groupOrder!==_.groupOrder?B.groupOrder-_.groupOrder:B.renderOrder!==_.renderOrder?B.renderOrder-_.renderOrder:B.z!==_.z?_.z-B.z:B.id-_.id}function WebGLRenderList(){const B=[];let _=0;const T=[],E=[],W=[];function X(){_=0,T.length=0,E.length=0,W.length=0}function q(le,ue,ge,ye,xe,Te){let Ae=B[_];return Ae===void 0?(Ae={id:le.id,object:le,geometry:ue,material:ge,groupOrder:ye,renderOrder:le.renderOrder,z:xe,group:Te},B[_]=Ae):(Ae.id=le.id,Ae.object=le,Ae.geometry=ue,Ae.material=ge,Ae.groupOrder=ye,Ae.renderOrder=le.renderOrder,Ae.z=xe,Ae.group=Te),_++,Ae}function Y(le,ue,ge,ye,xe,Te){const Ae=q(le,ue,ge,ye,xe,Te);ge.transmission>0?E.push(Ae):ge.transparent===!0?W.push(Ae):T.push(Ae)}function te(le,ue,ge,ye,xe,Te){const Ae=q(le,ue,ge,ye,xe,Te);ge.transmission>0?E.unshift(Ae):ge.transparent===!0?W.unshift(Ae):T.unshift(Ae)}function ne(le,ue){T.length>1&&T.sort(le||painterSortStable),E.length>1&&E.sort(ue||reversePainterSortStable),W.length>1&&W.sort(ue||reversePainterSortStable)}function ae(){for(let le=_,ue=B.length;le<ue;le++){const ge=B[le];if(ge.id===null)break;ge.id=null,ge.object=null,ge.geometry=null,ge.material=null,ge.group=null}}return{opaque:T,transmissive:E,transparent:W,init:X,push:Y,unshift:te,finish:ae,sort:ne}}function WebGLRenderLists(){let B=new WeakMap;function _(E,W){const X=B.get(E);let q;return X===void 0?(q=new WebGLRenderList,B.set(E,[q])):W>=X.length?(q=new WebGLRenderList,X.push(q)):q=X[W],q}function T(){B=new WeakMap}return{get:_,dispose:T}}function UniformsCache(){const B={};return{get:function(_){if(B[_.id]!==void 0)return B[_.id];let T;switch(_.type){case"DirectionalLight":T={direction:new Vector3,color:new Color};break;case"SpotLight":T={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":T={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":T={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":T={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return B[_.id]=T,T}}}function ShadowUniformsCache(){const B={};return{get:function(_){if(B[_.id]!==void 0)return B[_.id];let T;switch(_.type){case"DirectionalLight":T={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":T={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":T={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return B[_.id]=T,T}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(B,_){return(_.castShadow?2:0)-(B.castShadow?2:0)+(_.map?1:0)-(B.map?1:0)}function WebGLLights(B){const _=new UniformsCache,T=ShadowUniformsCache(),E={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let ne=0;ne<9;ne++)E.probe.push(new Vector3);const W=new Vector3,X=new Matrix4,q=new Matrix4;function Y(ne,ae){let le=0,ue=0,ge=0;for(let qe=0;qe<9;qe++)E.probe[qe].set(0,0,0);let ye=0,xe=0,Te=0,Ae=0,Ie=0,Ve=0,$e=0,We=0,Ue=0,je=0,ze=0;ne.sort(shadowCastingAndTexturingLightsFirst);const He=ae===!0?Math.PI:1;for(let qe=0,Qe=ne.length;qe<Qe;qe++){const Ke=ne[qe],Je=Ke.color,pt=Ke.intensity,ut=Ke.distance,lt=Ke.shadow&&Ke.shadow.map?Ke.shadow.map.texture:null;if(Ke.isAmbientLight)le+=Je.r*pt*He,ue+=Je.g*pt*He,ge+=Je.b*pt*He;else if(Ke.isLightProbe){for(let st=0;st<9;st++)E.probe[st].addScaledVector(Ke.sh.coefficients[st],pt);ze++}else if(Ke.isDirectionalLight){const st=_.get(Ke);if(st.color.copy(Ke.color).multiplyScalar(Ke.intensity*He),Ke.castShadow){const sr=Ke.shadow,mt=T.get(Ke);mt.shadowBias=sr.bias,mt.shadowNormalBias=sr.normalBias,mt.shadowRadius=sr.radius,mt.shadowMapSize=sr.mapSize,E.directionalShadow[ye]=mt,E.directionalShadowMap[ye]=lt,E.directionalShadowMatrix[ye]=Ke.shadow.matrix,Ve++}E.directional[ye]=st,ye++}else if(Ke.isSpotLight){const st=_.get(Ke);st.position.setFromMatrixPosition(Ke.matrixWorld),st.color.copy(Je).multiplyScalar(pt*He),st.distance=ut,st.coneCos=Math.cos(Ke.angle),st.penumbraCos=Math.cos(Ke.angle*(1-Ke.penumbra)),st.decay=Ke.decay,E.spot[Te]=st;const sr=Ke.shadow;if(Ke.map&&(E.spotLightMap[Ue]=Ke.map,Ue++,sr.updateMatrices(Ke),Ke.castShadow&&je++),E.spotLightMatrix[Te]=sr.matrix,Ke.castShadow){const mt=T.get(Ke);mt.shadowBias=sr.bias,mt.shadowNormalBias=sr.normalBias,mt.shadowRadius=sr.radius,mt.shadowMapSize=sr.mapSize,E.spotShadow[Te]=mt,E.spotShadowMap[Te]=lt,We++}Te++}else if(Ke.isRectAreaLight){const st=_.get(Ke);st.color.copy(Je).multiplyScalar(pt),st.halfWidth.set(Ke.width*.5,0,0),st.halfHeight.set(0,Ke.height*.5,0),E.rectArea[Ae]=st,Ae++}else if(Ke.isPointLight){const st=_.get(Ke);if(st.color.copy(Ke.color).multiplyScalar(Ke.intensity*He),st.distance=Ke.distance,st.decay=Ke.decay,Ke.castShadow){const sr=Ke.shadow,mt=T.get(Ke);mt.shadowBias=sr.bias,mt.shadowNormalBias=sr.normalBias,mt.shadowRadius=sr.radius,mt.shadowMapSize=sr.mapSize,mt.shadowCameraNear=sr.camera.near,mt.shadowCameraFar=sr.camera.far,E.pointShadow[xe]=mt,E.pointShadowMap[xe]=lt,E.pointShadowMatrix[xe]=Ke.shadow.matrix,$e++}E.point[xe]=st,xe++}else if(Ke.isHemisphereLight){const st=_.get(Ke);st.skyColor.copy(Ke.color).multiplyScalar(pt*He),st.groundColor.copy(Ke.groundColor).multiplyScalar(pt*He),E.hemi[Ie]=st,Ie++}}Ae>0&&(B.has("OES_texture_float_linear")===!0?(E.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,E.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(E.rectAreaLTC1=UniformsLib.LTC_HALF_1,E.rectAreaLTC2=UniformsLib.LTC_HALF_2)),E.ambient[0]=le,E.ambient[1]=ue,E.ambient[2]=ge;const Le=E.hash;(Le.directionalLength!==ye||Le.pointLength!==xe||Le.spotLength!==Te||Le.rectAreaLength!==Ae||Le.hemiLength!==Ie||Le.numDirectionalShadows!==Ve||Le.numPointShadows!==$e||Le.numSpotShadows!==We||Le.numSpotMaps!==Ue||Le.numLightProbes!==ze)&&(E.directional.length=ye,E.spot.length=Te,E.rectArea.length=Ae,E.point.length=xe,E.hemi.length=Ie,E.directionalShadow.length=Ve,E.directionalShadowMap.length=Ve,E.pointShadow.length=$e,E.pointShadowMap.length=$e,E.spotShadow.length=We,E.spotShadowMap.length=We,E.directionalShadowMatrix.length=Ve,E.pointShadowMatrix.length=$e,E.spotLightMatrix.length=We+Ue-je,E.spotLightMap.length=Ue,E.numSpotLightShadowsWithMaps=je,E.numLightProbes=ze,Le.directionalLength=ye,Le.pointLength=xe,Le.spotLength=Te,Le.rectAreaLength=Ae,Le.hemiLength=Ie,Le.numDirectionalShadows=Ve,Le.numPointShadows=$e,Le.numSpotShadows=We,Le.numSpotMaps=Ue,Le.numLightProbes=ze,E.version=nextVersion++)}function te(ne,ae){let le=0,ue=0,ge=0,ye=0,xe=0;const Te=ae.matrixWorldInverse;for(let Ae=0,Ie=ne.length;Ae<Ie;Ae++){const Ve=ne[Ae];if(Ve.isDirectionalLight){const $e=E.directional[le];$e.direction.setFromMatrixPosition(Ve.matrixWorld),W.setFromMatrixPosition(Ve.target.matrixWorld),$e.direction.sub(W),$e.direction.transformDirection(Te),le++}else if(Ve.isSpotLight){const $e=E.spot[ge];$e.position.setFromMatrixPosition(Ve.matrixWorld),$e.position.applyMatrix4(Te),$e.direction.setFromMatrixPosition(Ve.matrixWorld),W.setFromMatrixPosition(Ve.target.matrixWorld),$e.direction.sub(W),$e.direction.transformDirection(Te),ge++}else if(Ve.isRectAreaLight){const $e=E.rectArea[ye];$e.position.setFromMatrixPosition(Ve.matrixWorld),$e.position.applyMatrix4(Te),q.identity(),X.copy(Ve.matrixWorld),X.premultiply(Te),q.extractRotation(X),$e.halfWidth.set(Ve.width*.5,0,0),$e.halfHeight.set(0,Ve.height*.5,0),$e.halfWidth.applyMatrix4(q),$e.halfHeight.applyMatrix4(q),ye++}else if(Ve.isPointLight){const $e=E.point[ue];$e.position.setFromMatrixPosition(Ve.matrixWorld),$e.position.applyMatrix4(Te),ue++}else if(Ve.isHemisphereLight){const $e=E.hemi[xe];$e.direction.setFromMatrixPosition(Ve.matrixWorld),$e.direction.transformDirection(Te),xe++}}}return{setup:Y,setupView:te,state:E}}function WebGLRenderState(B){const _=new WebGLLights(B),T=[],E=[];function W(ae){ne.camera=ae,T.length=0,E.length=0}function X(ae){T.push(ae)}function q(ae){E.push(ae)}function Y(ae){_.setup(T,ae)}function te(ae){_.setupView(T,ae)}const ne={lightsArray:T,shadowsArray:E,camera:null,lights:_,transmissionRenderTarget:{}};return{init:W,state:ne,setupLights:Y,setupLightsView:te,pushLight:X,pushShadow:q}}function WebGLRenderStates(B){let _=new WeakMap;function T(W,X=0){const q=_.get(W);let Y;return q===void 0?(Y=new WebGLRenderState(B),_.set(W,[Y])):X>=q.length?(Y=new WebGLRenderState(B),q.push(Y)):Y=q[X],Y}function E(){_=new WeakMap}return{get:T,dispose:E}}class MeshDepthMaterial extends Material{constructor(_){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_)}copy(_){return super.copy(_),this.depthPacking=_.depthPacking,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(_){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_)}copy(_){return super.copy(_),this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this}}const vertex$i=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment$i=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(B,_,T){let E=new Frustum;const W=new Vector2,X=new Vector2,q=new Vector4,Y=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),te=new MeshDistanceMaterial,ne={},ae=T.maxTextureSize,le={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},ue=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex$i,fragmentShader:fragment$i}),ge=ue.clone();ge.defines.HORIZONTAL_PASS=1;const ye=new BufferGeometry;ye.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const xe=new Mesh(ye,ue),Te=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let Ae=this.type;this.render=function(Ue,je,ze){if(Te.enabled===!1||Te.autoUpdate===!1&&Te.needsUpdate===!1||Ue.length===0)return;const He=B.getRenderTarget(),Le=B.getActiveCubeFace(),qe=B.getActiveMipmapLevel(),Qe=B.state;Qe.setBlending(NoBlending),Qe.buffers.color.setClear(1,1,1,1),Qe.buffers.depth.setTest(!0),Qe.setScissorTest(!1);const Ke=Ae!==VSMShadowMap&&this.type===VSMShadowMap,Je=Ae===VSMShadowMap&&this.type!==VSMShadowMap;for(let pt=0,ut=Ue.length;pt<ut;pt++){const lt=Ue[pt],st=lt.shadow;if(st===void 0){console.warn("THREE.WebGLShadowMap:",lt,"has no shadow.");continue}if(st.autoUpdate===!1&&st.needsUpdate===!1)continue;W.copy(st.mapSize);const sr=st.getFrameExtents();if(W.multiply(sr),X.copy(st.mapSize),(W.x>ae||W.y>ae)&&(W.x>ae&&(X.x=Math.floor(ae/sr.x),W.x=X.x*sr.x,st.mapSize.x=X.x),W.y>ae&&(X.y=Math.floor(ae/sr.y),W.y=X.y*sr.y,st.mapSize.y=X.y)),st.map===null||Ke===!0||Je===!0){const Tr=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};st.map!==null&&st.map.dispose(),st.map=new WebGLRenderTarget(W.x,W.y,Tr),st.map.texture.name=lt.name+".shadowMap",st.camera.updateProjectionMatrix()}B.setRenderTarget(st.map),B.clear();const mt=st.getViewportCount();for(let Tr=0;Tr<mt;Tr++){const di=st.getViewport(Tr);q.set(X.x*di.x,X.y*di.y,X.x*di.z,X.y*di.w),Qe.viewport(q),st.updateMatrices(lt,Tr),E=st.getFrustum(),$e(je,ze,st.camera,lt,this.type)}st.isPointLightShadow!==!0&&this.type===VSMShadowMap&&Ie(st,ze),st.needsUpdate=!1}Ae=this.type,Te.needsUpdate=!1,B.setRenderTarget(He,Le,qe)};function Ie(Ue,je){const ze=_.update(xe);ue.defines.VSM_SAMPLES!==Ue.blurSamples&&(ue.defines.VSM_SAMPLES=Ue.blurSamples,ge.defines.VSM_SAMPLES=Ue.blurSamples,ue.needsUpdate=!0,ge.needsUpdate=!0),Ue.mapPass===null&&(Ue.mapPass=new WebGLRenderTarget(W.x,W.y)),ue.uniforms.shadow_pass.value=Ue.map.texture,ue.uniforms.resolution.value=Ue.mapSize,ue.uniforms.radius.value=Ue.radius,B.setRenderTarget(Ue.mapPass),B.clear(),B.renderBufferDirect(je,null,ze,ue,xe,null),ge.uniforms.shadow_pass.value=Ue.mapPass.texture,ge.uniforms.resolution.value=Ue.mapSize,ge.uniforms.radius.value=Ue.radius,B.setRenderTarget(Ue.map),B.clear(),B.renderBufferDirect(je,null,ze,ge,xe,null)}function Ve(Ue,je,ze,He){let Le=null;const qe=ze.isPointLight===!0?Ue.customDistanceMaterial:Ue.customDepthMaterial;if(qe!==void 0)Le=qe;else if(Le=ze.isPointLight===!0?te:Y,B.localClippingEnabled&&je.clipShadows===!0&&Array.isArray(je.clippingPlanes)&&je.clippingPlanes.length!==0||je.displacementMap&&je.displacementScale!==0||je.alphaMap&&je.alphaTest>0||je.map&&je.alphaTest>0){const Qe=Le.uuid,Ke=je.uuid;let Je=ne[Qe];Je===void 0&&(Je={},ne[Qe]=Je);let pt=Je[Ke];pt===void 0&&(pt=Le.clone(),Je[Ke]=pt,je.addEventListener("dispose",We)),Le=pt}if(Le.visible=je.visible,Le.wireframe=je.wireframe,He===VSMShadowMap?Le.side=je.shadowSide!==null?je.shadowSide:je.side:Le.side=je.shadowSide!==null?je.shadowSide:le[je.side],Le.alphaMap=je.alphaMap,Le.alphaTest=je.alphaTest,Le.map=je.map,Le.clipShadows=je.clipShadows,Le.clippingPlanes=je.clippingPlanes,Le.clipIntersection=je.clipIntersection,Le.displacementMap=je.displacementMap,Le.displacementScale=je.displacementScale,Le.displacementBias=je.displacementBias,Le.wireframeLinewidth=je.wireframeLinewidth,Le.linewidth=je.linewidth,ze.isPointLight===!0&&Le.isMeshDistanceMaterial===!0){const Qe=B.properties.get(Le);Qe.light=ze}return Le}function $e(Ue,je,ze,He,Le){if(Ue.visible===!1)return;if(Ue.layers.test(je.layers)&&(Ue.isMesh||Ue.isLine||Ue.isPoints)&&(Ue.castShadow||Ue.receiveShadow&&Le===VSMShadowMap)&&(!Ue.frustumCulled||E.intersectsObject(Ue))){Ue.modelViewMatrix.multiplyMatrices(ze.matrixWorldInverse,Ue.matrixWorld);const Ke=_.update(Ue),Je=Ue.material;if(Array.isArray(Je)){const pt=Ke.groups;for(let ut=0,lt=pt.length;ut<lt;ut++){const st=pt[ut],sr=Je[st.materialIndex];if(sr&&sr.visible){const mt=Ve(Ue,sr,He,Le);Ue.onBeforeShadow(B,Ue,je,ze,Ke,mt,st),B.renderBufferDirect(ze,null,Ke,mt,Ue,st),Ue.onAfterShadow(B,Ue,je,ze,Ke,mt,st)}}}else if(Je.visible){const pt=Ve(Ue,Je,He,Le);Ue.onBeforeShadow(B,Ue,je,ze,Ke,pt,null),B.renderBufferDirect(ze,null,Ke,pt,Ue,null),Ue.onAfterShadow(B,Ue,je,ze,Ke,pt,null)}}const Qe=Ue.children;for(let Ke=0,Je=Qe.length;Ke<Je;Ke++)$e(Qe[Ke],je,ze,He,Le)}function We(Ue){Ue.target.removeEventListener("dispose",We);for(const ze in ne){const He=ne[ze],Le=Ue.target.uuid;Le in He&&(He[Le].dispose(),delete He[Le])}}}function WebGLState(B){function _(){let Lr=!1;const _i=new Vector4;let xi=null;const Ni=new Vector4(0,0,0,0);return{setMask:function(Ui){xi!==Ui&&!Lr&&(B.colorMask(Ui,Ui,Ui,Ui),xi=Ui)},setLocked:function(Ui){Lr=Ui},setClear:function(Ui,Vn,Dn,Wn,es){es===!0&&(Ui*=Wn,Vn*=Wn,Dn*=Wn),_i.set(Ui,Vn,Dn,Wn),Ni.equals(_i)===!1&&(B.clearColor(Ui,Vn,Dn,Wn),Ni.copy(_i))},reset:function(){Lr=!1,xi=null,Ni.set(-1,0,0,0)}}}function T(){let Lr=!1,_i=null,xi=null,Ni=null;return{setTest:function(Ui){Ui?gi(B.DEPTH_TEST):fi(B.DEPTH_TEST)},setMask:function(Ui){_i!==Ui&&!Lr&&(B.depthMask(Ui),_i=Ui)},setFunc:function(Ui){if(xi!==Ui){switch(Ui){case NeverDepth:B.depthFunc(B.NEVER);break;case AlwaysDepth:B.depthFunc(B.ALWAYS);break;case LessDepth:B.depthFunc(B.LESS);break;case LessEqualDepth:B.depthFunc(B.LEQUAL);break;case EqualDepth:B.depthFunc(B.EQUAL);break;case GreaterEqualDepth:B.depthFunc(B.GEQUAL);break;case GreaterDepth:B.depthFunc(B.GREATER);break;case NotEqualDepth:B.depthFunc(B.NOTEQUAL);break;default:B.depthFunc(B.LEQUAL)}xi=Ui}},setLocked:function(Ui){Lr=Ui},setClear:function(Ui){Ni!==Ui&&(B.clearDepth(Ui),Ni=Ui)},reset:function(){Lr=!1,_i=null,xi=null,Ni=null}}}function E(){let Lr=!1,_i=null,xi=null,Ni=null,Ui=null,Vn=null,Dn=null,Wn=null,es=null;return{setTest:function(Bn){Lr||(Bn?gi(B.STENCIL_TEST):fi(B.STENCIL_TEST))},setMask:function(Bn){_i!==Bn&&!Lr&&(B.stencilMask(Bn),_i=Bn)},setFunc:function(Bn,ps,ns){(xi!==Bn||Ni!==ps||Ui!==ns)&&(B.stencilFunc(Bn,ps,ns),xi=Bn,Ni=ps,Ui=ns)},setOp:function(Bn,ps,ns){(Vn!==Bn||Dn!==ps||Wn!==ns)&&(B.stencilOp(Bn,ps,ns),Vn=Bn,Dn=ps,Wn=ns)},setLocked:function(Bn){Lr=Bn},setClear:function(Bn){es!==Bn&&(B.clearStencil(Bn),es=Bn)},reset:function(){Lr=!1,_i=null,xi=null,Ni=null,Ui=null,Vn=null,Dn=null,Wn=null,es=null}}}const W=new _,X=new T,q=new E,Y=new WeakMap,te=new WeakMap;let ne={},ae={},le=new WeakMap,ue=[],ge=null,ye=!1,xe=null,Te=null,Ae=null,Ie=null,Ve=null,$e=null,We=null,Ue=new Color(0,0,0),je=0,ze=!1,He=null,Le=null,qe=null,Qe=null,Ke=null;const Je=B.getParameter(B.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let pt=!1,ut=0;const lt=B.getParameter(B.VERSION);lt.indexOf("WebGL")!==-1?(ut=parseFloat(/^WebGL (\d)/.exec(lt)[1]),pt=ut>=1):lt.indexOf("OpenGL ES")!==-1&&(ut=parseFloat(/^OpenGL ES (\d)/.exec(lt)[1]),pt=ut>=2);let st=null,sr={};const mt=B.getParameter(B.SCISSOR_BOX),Tr=B.getParameter(B.VIEWPORT),di=new Vector4().fromArray(mt),Mi=new Vector4().fromArray(Tr);function Gr(Lr,_i,xi,Ni){const Ui=new Uint8Array(4),Vn=B.createTexture();B.bindTexture(Lr,Vn),B.texParameteri(Lr,B.TEXTURE_MIN_FILTER,B.NEAREST),B.texParameteri(Lr,B.TEXTURE_MAG_FILTER,B.NEAREST);for(let Dn=0;Dn<xi;Dn++)Lr===B.TEXTURE_3D||Lr===B.TEXTURE_2D_ARRAY?B.texImage3D(_i,0,B.RGBA,1,1,Ni,0,B.RGBA,B.UNSIGNED_BYTE,Ui):B.texImage2D(_i+Dn,0,B.RGBA,1,1,0,B.RGBA,B.UNSIGNED_BYTE,Ui);return Vn}const ci={};ci[B.TEXTURE_2D]=Gr(B.TEXTURE_2D,B.TEXTURE_2D,1),ci[B.TEXTURE_CUBE_MAP]=Gr(B.TEXTURE_CUBE_MAP,B.TEXTURE_CUBE_MAP_POSITIVE_X,6),ci[B.TEXTURE_2D_ARRAY]=Gr(B.TEXTURE_2D_ARRAY,B.TEXTURE_2D_ARRAY,1,1),ci[B.TEXTURE_3D]=Gr(B.TEXTURE_3D,B.TEXTURE_3D,1,1),W.setClear(0,0,0,1),X.setClear(1),q.setClear(0),gi(B.DEPTH_TEST),X.setFunc(LessEqualDepth),Rr(!1),Br(CullFaceBack),gi(B.CULL_FACE),et(NoBlending);function gi(Lr){ne[Lr]!==!0&&(B.enable(Lr),ne[Lr]=!0)}function fi(Lr){ne[Lr]!==!1&&(B.disable(Lr),ne[Lr]=!1)}function ri(Lr,_i){return ae[Lr]!==_i?(B.bindFramebuffer(Lr,_i),ae[Lr]=_i,Lr===B.DRAW_FRAMEBUFFER&&(ae[B.FRAMEBUFFER]=_i),Lr===B.FRAMEBUFFER&&(ae[B.DRAW_FRAMEBUFFER]=_i),!0):!1}function ot(Lr,_i){let xi=ue,Ni=!1;if(Lr){xi=le.get(_i),xi===void 0&&(xi=[],le.set(_i,xi));const Ui=Lr.textures;if(xi.length!==Ui.length||xi[0]!==B.COLOR_ATTACHMENT0){for(let Vn=0,Dn=Ui.length;Vn<Dn;Vn++)xi[Vn]=B.COLOR_ATTACHMENT0+Vn;xi.length=Ui.length,Ni=!0}}else xi[0]!==B.BACK&&(xi[0]=B.BACK,Ni=!0);Ni&&B.drawBuffers(xi)}function rt(Lr){return ge!==Lr?(B.useProgram(Lr),ge=Lr,!0):!1}const gt={[AddEquation]:B.FUNC_ADD,[SubtractEquation]:B.FUNC_SUBTRACT,[ReverseSubtractEquation]:B.FUNC_REVERSE_SUBTRACT};gt[MinEquation]=B.MIN,gt[MaxEquation]=B.MAX;const Or={[ZeroFactor]:B.ZERO,[OneFactor]:B.ONE,[SrcColorFactor]:B.SRC_COLOR,[SrcAlphaFactor]:B.SRC_ALPHA,[SrcAlphaSaturateFactor]:B.SRC_ALPHA_SATURATE,[DstColorFactor]:B.DST_COLOR,[DstAlphaFactor]:B.DST_ALPHA,[OneMinusSrcColorFactor]:B.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:B.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:B.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:B.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:B.CONSTANT_COLOR,[OneMinusConstantColorFactor]:B.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:B.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:B.ONE_MINUS_CONSTANT_ALPHA};function et(Lr,_i,xi,Ni,Ui,Vn,Dn,Wn,es,Bn){if(Lr===NoBlending){ye===!0&&(fi(B.BLEND),ye=!1);return}if(ye===!1&&(gi(B.BLEND),ye=!0),Lr!==CustomBlending){if(Lr!==xe||Bn!==ze){if((Te!==AddEquation||Ve!==AddEquation)&&(B.blendEquation(B.FUNC_ADD),Te=AddEquation,Ve=AddEquation),Bn)switch(Lr){case NormalBlending:B.blendFuncSeparate(B.ONE,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:B.blendFunc(B.ONE,B.ONE);break;case SubtractiveBlending:B.blendFuncSeparate(B.ZERO,B.ONE_MINUS_SRC_COLOR,B.ZERO,B.ONE);break;case MultiplyBlending:B.blendFuncSeparate(B.ZERO,B.SRC_COLOR,B.ZERO,B.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Lr);break}else switch(Lr){case NormalBlending:B.blendFuncSeparate(B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:B.blendFunc(B.SRC_ALPHA,B.ONE);break;case SubtractiveBlending:B.blendFuncSeparate(B.ZERO,B.ONE_MINUS_SRC_COLOR,B.ZERO,B.ONE);break;case MultiplyBlending:B.blendFunc(B.ZERO,B.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Lr);break}Ae=null,Ie=null,$e=null,We=null,Ue.set(0,0,0),je=0,xe=Lr,ze=Bn}return}Ui=Ui||_i,Vn=Vn||xi,Dn=Dn||Ni,(_i!==Te||Ui!==Ve)&&(B.blendEquationSeparate(gt[_i],gt[Ui]),Te=_i,Ve=Ui),(xi!==Ae||Ni!==Ie||Vn!==$e||Dn!==We)&&(B.blendFuncSeparate(Or[xi],Or[Ni],Or[Vn],Or[Dn]),Ae=xi,Ie=Ni,$e=Vn,We=Dn),(Wn.equals(Ue)===!1||es!==je)&&(B.blendColor(Wn.r,Wn.g,Wn.b,es),Ue.copy(Wn),je=es),xe=Lr,ze=!1}function at(Lr,_i){Lr.side===DoubleSide?fi(B.CULL_FACE):gi(B.CULL_FACE);let xi=Lr.side===BackSide;_i&&(xi=!xi),Rr(xi),Lr.blending===NormalBlending&&Lr.transparent===!1?et(NoBlending):et(Lr.blending,Lr.blendEquation,Lr.blendSrc,Lr.blendDst,Lr.blendEquationAlpha,Lr.blendSrcAlpha,Lr.blendDstAlpha,Lr.blendColor,Lr.blendAlpha,Lr.premultipliedAlpha),X.setFunc(Lr.depthFunc),X.setTest(Lr.depthTest),X.setMask(Lr.depthWrite),W.setMask(Lr.colorWrite);const Ni=Lr.stencilWrite;q.setTest(Ni),Ni&&(q.setMask(Lr.stencilWriteMask),q.setFunc(Lr.stencilFunc,Lr.stencilRef,Lr.stencilFuncMask),q.setOp(Lr.stencilFail,Lr.stencilZFail,Lr.stencilZPass)),oi(Lr.polygonOffset,Lr.polygonOffsetFactor,Lr.polygonOffsetUnits),Lr.alphaToCoverage===!0?gi(B.SAMPLE_ALPHA_TO_COVERAGE):fi(B.SAMPLE_ALPHA_TO_COVERAGE)}function Rr(Lr){He!==Lr&&(Lr?B.frontFace(B.CW):B.frontFace(B.CCW),He=Lr)}function Br(Lr){Lr!==CullFaceNone?(gi(B.CULL_FACE),Lr!==Le&&(Lr===CullFaceBack?B.cullFace(B.BACK):Lr===CullFaceFront?B.cullFace(B.FRONT):B.cullFace(B.FRONT_AND_BACK))):fi(B.CULL_FACE),Le=Lr}function Kr(Lr){Lr!==qe&&(pt&&B.lineWidth(Lr),qe=Lr)}function oi(Lr,_i,xi){Lr?(gi(B.POLYGON_OFFSET_FILL),(Qe!==_i||Ke!==xi)&&(B.polygonOffset(_i,xi),Qe=_i,Ke=xi)):fi(B.POLYGON_OFFSET_FILL)}function ct(Lr){Lr?gi(B.SCISSOR_TEST):fi(B.SCISSOR_TEST)}function nt(Lr){Lr===void 0&&(Lr=B.TEXTURE0+Je-1),st!==Lr&&(B.activeTexture(Lr),st=Lr)}function Ir(Lr,_i,xi){xi===void 0&&(st===null?xi=B.TEXTURE0+Je-1:xi=st);let Ni=sr[xi];Ni===void 0&&(Ni={type:void 0,texture:void 0},sr[xi]=Ni),(Ni.type!==Lr||Ni.texture!==_i)&&(st!==xi&&(B.activeTexture(xi),st=xi),B.bindTexture(Lr,_i||ci[Lr]),Ni.type=Lr,Ni.texture=_i)}function Dr(){const Lr=sr[st];Lr!==void 0&&Lr.type!==void 0&&(B.bindTexture(Lr.type,null),Lr.type=void 0,Lr.texture=void 0)}function ti(){try{B.compressedTexImage2D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function si(){try{B.compressedTexImage3D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function Ai(){try{B.texSubImage2D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function Oi(){try{B.texSubImage3D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function Ci(){try{B.compressedTexSubImage2D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function Wi(){try{B.compressedTexSubImage3D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function ki(){try{B.texStorage2D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function Li(){try{B.texStorage3D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function mn(){try{B.texImage2D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function cn(){try{B.texImage3D.apply(B,arguments)}catch(Lr){console.error("THREE.WebGLState:",Lr)}}function qi(Lr){di.equals(Lr)===!1&&(B.scissor(Lr.x,Lr.y,Lr.z,Lr.w),di.copy(Lr))}function wn(Lr){Mi.equals(Lr)===!1&&(B.viewport(Lr.x,Lr.y,Lr.z,Lr.w),Mi.copy(Lr))}function An(Lr,_i){let xi=te.get(_i);xi===void 0&&(xi=new WeakMap,te.set(_i,xi));let Ni=xi.get(Lr);Ni===void 0&&(Ni=B.getUniformBlockIndex(_i,Lr.name),xi.set(Lr,Ni))}function Hr(Lr,_i){const Ni=te.get(_i).get(Lr);Y.get(_i)!==Ni&&(B.uniformBlockBinding(_i,Ni,Lr.__bindingPointIndex),Y.set(_i,Ni))}function vi(){B.disable(B.BLEND),B.disable(B.CULL_FACE),B.disable(B.DEPTH_TEST),B.disable(B.POLYGON_OFFSET_FILL),B.disable(B.SCISSOR_TEST),B.disable(B.STENCIL_TEST),B.disable(B.SAMPLE_ALPHA_TO_COVERAGE),B.blendEquation(B.FUNC_ADD),B.blendFunc(B.ONE,B.ZERO),B.blendFuncSeparate(B.ONE,B.ZERO,B.ONE,B.ZERO),B.blendColor(0,0,0,0),B.colorMask(!0,!0,!0,!0),B.clearColor(0,0,0,0),B.depthMask(!0),B.depthFunc(B.LESS),B.clearDepth(1),B.stencilMask(4294967295),B.stencilFunc(B.ALWAYS,0,4294967295),B.stencilOp(B.KEEP,B.KEEP,B.KEEP),B.clearStencil(0),B.cullFace(B.BACK),B.frontFace(B.CCW),B.polygonOffset(0,0),B.activeTexture(B.TEXTURE0),B.bindFramebuffer(B.FRAMEBUFFER,null),B.bindFramebuffer(B.DRAW_FRAMEBUFFER,null),B.bindFramebuffer(B.READ_FRAMEBUFFER,null),B.useProgram(null),B.lineWidth(1),B.scissor(0,0,B.canvas.width,B.canvas.height),B.viewport(0,0,B.canvas.width,B.canvas.height),ne={},st=null,sr={},ae={},le=new WeakMap,ue=[],ge=null,ye=!1,xe=null,Te=null,Ae=null,Ie=null,Ve=null,$e=null,We=null,Ue=new Color(0,0,0),je=0,ze=!1,He=null,Le=null,qe=null,Qe=null,Ke=null,di.set(0,0,B.canvas.width,B.canvas.height),Mi.set(0,0,B.canvas.width,B.canvas.height),W.reset(),X.reset(),q.reset()}return{buffers:{color:W,depth:X,stencil:q},enable:gi,disable:fi,bindFramebuffer:ri,drawBuffers:ot,useProgram:rt,setBlending:et,setMaterial:at,setFlipSided:Rr,setCullFace:Br,setLineWidth:Kr,setPolygonOffset:oi,setScissorTest:ct,activeTexture:nt,bindTexture:Ir,unbindTexture:Dr,compressedTexImage2D:ti,compressedTexImage3D:si,texImage2D:mn,texImage3D:cn,updateUBOMapping:An,uniformBlockBinding:Hr,texStorage2D:ki,texStorage3D:Li,texSubImage2D:Ai,texSubImage3D:Oi,compressedTexSubImage2D:Ci,compressedTexSubImage3D:Wi,scissor:qi,viewport:wn,reset:vi}}function WebGLTextures(B,_,T,E,W,X,q){const Y=_.has("WEBGL_multisampled_render_to_texture")?_.get("WEBGL_multisampled_render_to_texture"):null,te=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),ne=new Vector2,ae=new WeakMap;let le;const ue=new WeakMap;let ge=!1;try{ge=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ye(ct,nt){return ge?new OffscreenCanvas(ct,nt):createElementNS("canvas")}function xe(ct,nt,Ir){let Dr=1;const ti=oi(ct);if((ti.width>Ir||ti.height>Ir)&&(Dr=Ir/Math.max(ti.width,ti.height)),Dr<1)if(typeof HTMLImageElement<"u"&&ct instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ct instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ct instanceof ImageBitmap||typeof VideoFrame<"u"&&ct instanceof VideoFrame){const si=Math.floor(Dr*ti.width),Ai=Math.floor(Dr*ti.height);le===void 0&&(le=ye(si,Ai));const Oi=nt?ye(si,Ai):le;return Oi.width=si,Oi.height=Ai,Oi.getContext("2d").drawImage(ct,0,0,si,Ai),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ti.width+"x"+ti.height+") to ("+si+"x"+Ai+")."),Oi}else return"data"in ct&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ti.width+"x"+ti.height+")."),ct;return ct}function Te(ct){return ct.generateMipmaps&&ct.minFilter!==NearestFilter&&ct.minFilter!==LinearFilter}function Ae(ct){B.generateMipmap(ct)}function Ie(ct,nt,Ir,Dr,ti=!1){if(ct!==null){if(B[ct]!==void 0)return B[ct];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ct+"'")}let si=nt;if(nt===B.RED&&(Ir===B.FLOAT&&(si=B.R32F),Ir===B.HALF_FLOAT&&(si=B.R16F),Ir===B.UNSIGNED_BYTE&&(si=B.R8)),nt===B.RED_INTEGER&&(Ir===B.UNSIGNED_BYTE&&(si=B.R8UI),Ir===B.UNSIGNED_SHORT&&(si=B.R16UI),Ir===B.UNSIGNED_INT&&(si=B.R32UI),Ir===B.BYTE&&(si=B.R8I),Ir===B.SHORT&&(si=B.R16I),Ir===B.INT&&(si=B.R32I)),nt===B.RG&&(Ir===B.FLOAT&&(si=B.RG32F),Ir===B.HALF_FLOAT&&(si=B.RG16F),Ir===B.UNSIGNED_BYTE&&(si=B.RG8)),nt===B.RG_INTEGER&&(Ir===B.UNSIGNED_BYTE&&(si=B.RG8UI),Ir===B.UNSIGNED_SHORT&&(si=B.RG16UI),Ir===B.UNSIGNED_INT&&(si=B.RG32UI),Ir===B.BYTE&&(si=B.RG8I),Ir===B.SHORT&&(si=B.RG16I),Ir===B.INT&&(si=B.RG32I)),nt===B.RGB&&Ir===B.UNSIGNED_INT_5_9_9_9_REV&&(si=B.RGB9_E5),nt===B.RGBA){const Ai=ti?LinearTransfer:ColorManagement.getTransfer(Dr);Ir===B.FLOAT&&(si=B.RGBA32F),Ir===B.HALF_FLOAT&&(si=B.RGBA16F),Ir===B.UNSIGNED_BYTE&&(si=Ai===SRGBTransfer?B.SRGB8_ALPHA8:B.RGBA8),Ir===B.UNSIGNED_SHORT_4_4_4_4&&(si=B.RGBA4),Ir===B.UNSIGNED_SHORT_5_5_5_1&&(si=B.RGB5_A1)}return(si===B.R16F||si===B.R32F||si===B.RG16F||si===B.RG32F||si===B.RGBA16F||si===B.RGBA32F)&&_.get("EXT_color_buffer_float"),si}function Ve(ct,nt){return Te(ct)===!0||ct.isFramebufferTexture&&ct.minFilter!==NearestFilter&&ct.minFilter!==LinearFilter?Math.log2(Math.max(nt.width,nt.height))+1:ct.mipmaps!==void 0&&ct.mipmaps.length>0?ct.mipmaps.length:ct.isCompressedTexture&&Array.isArray(ct.image)?nt.mipmaps.length:1}function $e(ct){const nt=ct.target;nt.removeEventListener("dispose",$e),Ue(nt),nt.isVideoTexture&&ae.delete(nt)}function We(ct){const nt=ct.target;nt.removeEventListener("dispose",We),ze(nt)}function Ue(ct){const nt=E.get(ct);if(nt.__webglInit===void 0)return;const Ir=ct.source,Dr=ue.get(Ir);if(Dr){const ti=Dr[nt.__cacheKey];ti.usedTimes--,ti.usedTimes===0&&je(ct),Object.keys(Dr).length===0&&ue.delete(Ir)}E.remove(ct)}function je(ct){const nt=E.get(ct);B.deleteTexture(nt.__webglTexture);const Ir=ct.source,Dr=ue.get(Ir);delete Dr[nt.__cacheKey],q.memory.textures--}function ze(ct){const nt=E.get(ct);if(ct.depthTexture&&ct.depthTexture.dispose(),ct.isWebGLCubeRenderTarget)for(let Dr=0;Dr<6;Dr++){if(Array.isArray(nt.__webglFramebuffer[Dr]))for(let ti=0;ti<nt.__webglFramebuffer[Dr].length;ti++)B.deleteFramebuffer(nt.__webglFramebuffer[Dr][ti]);else B.deleteFramebuffer(nt.__webglFramebuffer[Dr]);nt.__webglDepthbuffer&&B.deleteRenderbuffer(nt.__webglDepthbuffer[Dr])}else{if(Array.isArray(nt.__webglFramebuffer))for(let Dr=0;Dr<nt.__webglFramebuffer.length;Dr++)B.deleteFramebuffer(nt.__webglFramebuffer[Dr]);else B.deleteFramebuffer(nt.__webglFramebuffer);if(nt.__webglDepthbuffer&&B.deleteRenderbuffer(nt.__webglDepthbuffer),nt.__webglMultisampledFramebuffer&&B.deleteFramebuffer(nt.__webglMultisampledFramebuffer),nt.__webglColorRenderbuffer)for(let Dr=0;Dr<nt.__webglColorRenderbuffer.length;Dr++)nt.__webglColorRenderbuffer[Dr]&&B.deleteRenderbuffer(nt.__webglColorRenderbuffer[Dr]);nt.__webglDepthRenderbuffer&&B.deleteRenderbuffer(nt.__webglDepthRenderbuffer)}const Ir=ct.textures;for(let Dr=0,ti=Ir.length;Dr<ti;Dr++){const si=E.get(Ir[Dr]);si.__webglTexture&&(B.deleteTexture(si.__webglTexture),q.memory.textures--),E.remove(Ir[Dr])}E.remove(ct)}let He=0;function Le(){He=0}function qe(){const ct=He;return ct>=W.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ct+" texture units while this GPU supports only "+W.maxTextures),He+=1,ct}function Qe(ct){const nt=[];return nt.push(ct.wrapS),nt.push(ct.wrapT),nt.push(ct.wrapR||0),nt.push(ct.magFilter),nt.push(ct.minFilter),nt.push(ct.anisotropy),nt.push(ct.internalFormat),nt.push(ct.format),nt.push(ct.type),nt.push(ct.generateMipmaps),nt.push(ct.premultiplyAlpha),nt.push(ct.flipY),nt.push(ct.unpackAlignment),nt.push(ct.colorSpace),nt.join()}function Ke(ct,nt){const Ir=E.get(ct);if(ct.isVideoTexture&&Br(ct),ct.isRenderTargetTexture===!1&&ct.version>0&&Ir.__version!==ct.version){const Dr=ct.image;if(Dr===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Dr.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{di(Ir,ct,nt);return}}T.bindTexture(B.TEXTURE_2D,Ir.__webglTexture,B.TEXTURE0+nt)}function Je(ct,nt){const Ir=E.get(ct);if(ct.version>0&&Ir.__version!==ct.version){di(Ir,ct,nt);return}T.bindTexture(B.TEXTURE_2D_ARRAY,Ir.__webglTexture,B.TEXTURE0+nt)}function pt(ct,nt){const Ir=E.get(ct);if(ct.version>0&&Ir.__version!==ct.version){di(Ir,ct,nt);return}T.bindTexture(B.TEXTURE_3D,Ir.__webglTexture,B.TEXTURE0+nt)}function ut(ct,nt){const Ir=E.get(ct);if(ct.version>0&&Ir.__version!==ct.version){Mi(Ir,ct,nt);return}T.bindTexture(B.TEXTURE_CUBE_MAP,Ir.__webglTexture,B.TEXTURE0+nt)}const lt={[RepeatWrapping]:B.REPEAT,[ClampToEdgeWrapping]:B.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:B.MIRRORED_REPEAT},st={[NearestFilter]:B.NEAREST,[NearestMipmapNearestFilter]:B.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:B.NEAREST_MIPMAP_LINEAR,[LinearFilter]:B.LINEAR,[LinearMipmapNearestFilter]:B.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:B.LINEAR_MIPMAP_LINEAR},sr={[NeverCompare]:B.NEVER,[AlwaysCompare]:B.ALWAYS,[LessCompare]:B.LESS,[LessEqualCompare]:B.LEQUAL,[EqualCompare]:B.EQUAL,[GreaterEqualCompare]:B.GEQUAL,[GreaterCompare]:B.GREATER,[NotEqualCompare]:B.NOTEQUAL};function mt(ct,nt){if(nt.type===FloatType&&_.has("OES_texture_float_linear")===!1&&(nt.magFilter===LinearFilter||nt.magFilter===LinearMipmapNearestFilter||nt.magFilter===NearestMipmapLinearFilter||nt.magFilter===LinearMipmapLinearFilter||nt.minFilter===LinearFilter||nt.minFilter===LinearMipmapNearestFilter||nt.minFilter===NearestMipmapLinearFilter||nt.minFilter===LinearMipmapLinearFilter)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),B.texParameteri(ct,B.TEXTURE_WRAP_S,lt[nt.wrapS]),B.texParameteri(ct,B.TEXTURE_WRAP_T,lt[nt.wrapT]),(ct===B.TEXTURE_3D||ct===B.TEXTURE_2D_ARRAY)&&B.texParameteri(ct,B.TEXTURE_WRAP_R,lt[nt.wrapR]),B.texParameteri(ct,B.TEXTURE_MAG_FILTER,st[nt.magFilter]),B.texParameteri(ct,B.TEXTURE_MIN_FILTER,st[nt.minFilter]),nt.compareFunction&&(B.texParameteri(ct,B.TEXTURE_COMPARE_MODE,B.COMPARE_REF_TO_TEXTURE),B.texParameteri(ct,B.TEXTURE_COMPARE_FUNC,sr[nt.compareFunction])),_.has("EXT_texture_filter_anisotropic")===!0){if(nt.magFilter===NearestFilter||nt.minFilter!==NearestMipmapLinearFilter&&nt.minFilter!==LinearMipmapLinearFilter||nt.type===FloatType&&_.has("OES_texture_float_linear")===!1)return;if(nt.anisotropy>1||E.get(nt).__currentAnisotropy){const Ir=_.get("EXT_texture_filter_anisotropic");B.texParameterf(ct,Ir.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(nt.anisotropy,W.getMaxAnisotropy())),E.get(nt).__currentAnisotropy=nt.anisotropy}}}function Tr(ct,nt){let Ir=!1;ct.__webglInit===void 0&&(ct.__webglInit=!0,nt.addEventListener("dispose",$e));const Dr=nt.source;let ti=ue.get(Dr);ti===void 0&&(ti={},ue.set(Dr,ti));const si=Qe(nt);if(si!==ct.__cacheKey){ti[si]===void 0&&(ti[si]={texture:B.createTexture(),usedTimes:0},q.memory.textures++,Ir=!0),ti[si].usedTimes++;const Ai=ti[ct.__cacheKey];Ai!==void 0&&(ti[ct.__cacheKey].usedTimes--,Ai.usedTimes===0&&je(nt)),ct.__cacheKey=si,ct.__webglTexture=ti[si].texture}return Ir}function di(ct,nt,Ir){let Dr=B.TEXTURE_2D;(nt.isDataArrayTexture||nt.isCompressedArrayTexture)&&(Dr=B.TEXTURE_2D_ARRAY),nt.isData3DTexture&&(Dr=B.TEXTURE_3D);const ti=Tr(ct,nt),si=nt.source;T.bindTexture(Dr,ct.__webglTexture,B.TEXTURE0+Ir);const Ai=E.get(si);if(si.version!==Ai.__version||ti===!0){T.activeTexture(B.TEXTURE0+Ir);const Oi=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Ci=nt.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(nt.colorSpace),Wi=nt.colorSpace===NoColorSpace||Oi===Ci?B.NONE:B.BROWSER_DEFAULT_WEBGL;B.pixelStorei(B.UNPACK_FLIP_Y_WEBGL,nt.flipY),B.pixelStorei(B.UNPACK_PREMULTIPLY_ALPHA_WEBGL,nt.premultiplyAlpha),B.pixelStorei(B.UNPACK_ALIGNMENT,nt.unpackAlignment),B.pixelStorei(B.UNPACK_COLORSPACE_CONVERSION_WEBGL,Wi);let ki=xe(nt.image,!1,W.maxTextureSize);ki=Kr(nt,ki);const Li=X.convert(nt.format,nt.colorSpace),mn=X.convert(nt.type);let cn=Ie(nt.internalFormat,Li,mn,nt.colorSpace,nt.isVideoTexture);mt(Dr,nt);let qi;const wn=nt.mipmaps,An=nt.isVideoTexture!==!0,Hr=Ai.__version===void 0||ti===!0,vi=si.dataReady,Lr=Ve(nt,ki);if(nt.isDepthTexture)cn=B.DEPTH_COMPONENT16,nt.type===FloatType?cn=B.DEPTH_COMPONENT32F:nt.type===UnsignedIntType?cn=B.DEPTH_COMPONENT24:nt.type===UnsignedInt248Type&&(cn=B.DEPTH24_STENCIL8),Hr&&(An?T.texStorage2D(B.TEXTURE_2D,1,cn,ki.width,ki.height):T.texImage2D(B.TEXTURE_2D,0,cn,ki.width,ki.height,0,Li,mn,null));else if(nt.isDataTexture)if(wn.length>0){An&&Hr&&T.texStorage2D(B.TEXTURE_2D,Lr,cn,wn[0].width,wn[0].height);for(let _i=0,xi=wn.length;_i<xi;_i++)qi=wn[_i],An?vi&&T.texSubImage2D(B.TEXTURE_2D,_i,0,0,qi.width,qi.height,Li,mn,qi.data):T.texImage2D(B.TEXTURE_2D,_i,cn,qi.width,qi.height,0,Li,mn,qi.data);nt.generateMipmaps=!1}else An?(Hr&&T.texStorage2D(B.TEXTURE_2D,Lr,cn,ki.width,ki.height),vi&&T.texSubImage2D(B.TEXTURE_2D,0,0,0,ki.width,ki.height,Li,mn,ki.data)):T.texImage2D(B.TEXTURE_2D,0,cn,ki.width,ki.height,0,Li,mn,ki.data);else if(nt.isCompressedTexture)if(nt.isCompressedArrayTexture){An&&Hr&&T.texStorage3D(B.TEXTURE_2D_ARRAY,Lr,cn,wn[0].width,wn[0].height,ki.depth);for(let _i=0,xi=wn.length;_i<xi;_i++)qi=wn[_i],nt.format!==RGBAFormat?Li!==null?An?vi&&T.compressedTexSubImage3D(B.TEXTURE_2D_ARRAY,_i,0,0,0,qi.width,qi.height,ki.depth,Li,qi.data,0,0):T.compressedTexImage3D(B.TEXTURE_2D_ARRAY,_i,cn,qi.width,qi.height,ki.depth,0,qi.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):An?vi&&T.texSubImage3D(B.TEXTURE_2D_ARRAY,_i,0,0,0,qi.width,qi.height,ki.depth,Li,mn,qi.data):T.texImage3D(B.TEXTURE_2D_ARRAY,_i,cn,qi.width,qi.height,ki.depth,0,Li,mn,qi.data)}else{An&&Hr&&T.texStorage2D(B.TEXTURE_2D,Lr,cn,wn[0].width,wn[0].height);for(let _i=0,xi=wn.length;_i<xi;_i++)qi=wn[_i],nt.format!==RGBAFormat?Li!==null?An?vi&&T.compressedTexSubImage2D(B.TEXTURE_2D,_i,0,0,qi.width,qi.height,Li,qi.data):T.compressedTexImage2D(B.TEXTURE_2D,_i,cn,qi.width,qi.height,0,qi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):An?vi&&T.texSubImage2D(B.TEXTURE_2D,_i,0,0,qi.width,qi.height,Li,mn,qi.data):T.texImage2D(B.TEXTURE_2D,_i,cn,qi.width,qi.height,0,Li,mn,qi.data)}else if(nt.isDataArrayTexture)An?(Hr&&T.texStorage3D(B.TEXTURE_2D_ARRAY,Lr,cn,ki.width,ki.height,ki.depth),vi&&T.texSubImage3D(B.TEXTURE_2D_ARRAY,0,0,0,0,ki.width,ki.height,ki.depth,Li,mn,ki.data)):T.texImage3D(B.TEXTURE_2D_ARRAY,0,cn,ki.width,ki.height,ki.depth,0,Li,mn,ki.data);else if(nt.isData3DTexture)An?(Hr&&T.texStorage3D(B.TEXTURE_3D,Lr,cn,ki.width,ki.height,ki.depth),vi&&T.texSubImage3D(B.TEXTURE_3D,0,0,0,0,ki.width,ki.height,ki.depth,Li,mn,ki.data)):T.texImage3D(B.TEXTURE_3D,0,cn,ki.width,ki.height,ki.depth,0,Li,mn,ki.data);else if(nt.isFramebufferTexture){if(Hr)if(An)T.texStorage2D(B.TEXTURE_2D,Lr,cn,ki.width,ki.height);else{let _i=ki.width,xi=ki.height;for(let Ni=0;Ni<Lr;Ni++)T.texImage2D(B.TEXTURE_2D,Ni,cn,_i,xi,0,Li,mn,null),_i>>=1,xi>>=1}}else if(wn.length>0){if(An&&Hr){const _i=oi(wn[0]);T.texStorage2D(B.TEXTURE_2D,Lr,cn,_i.width,_i.height)}for(let _i=0,xi=wn.length;_i<xi;_i++)qi=wn[_i],An?vi&&T.texSubImage2D(B.TEXTURE_2D,_i,0,0,Li,mn,qi):T.texImage2D(B.TEXTURE_2D,_i,cn,Li,mn,qi);nt.generateMipmaps=!1}else if(An){if(Hr){const _i=oi(ki);T.texStorage2D(B.TEXTURE_2D,Lr,cn,_i.width,_i.height)}vi&&T.texSubImage2D(B.TEXTURE_2D,0,0,0,Li,mn,ki)}else T.texImage2D(B.TEXTURE_2D,0,cn,Li,mn,ki);Te(nt)&&Ae(Dr),Ai.__version=si.version,nt.onUpdate&&nt.onUpdate(nt)}ct.__version=nt.version}function Mi(ct,nt,Ir){if(nt.image.length!==6)return;const Dr=Tr(ct,nt),ti=nt.source;T.bindTexture(B.TEXTURE_CUBE_MAP,ct.__webglTexture,B.TEXTURE0+Ir);const si=E.get(ti);if(ti.version!==si.__version||Dr===!0){T.activeTexture(B.TEXTURE0+Ir);const Ai=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),Oi=nt.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(nt.colorSpace),Ci=nt.colorSpace===NoColorSpace||Ai===Oi?B.NONE:B.BROWSER_DEFAULT_WEBGL;B.pixelStorei(B.UNPACK_FLIP_Y_WEBGL,nt.flipY),B.pixelStorei(B.UNPACK_PREMULTIPLY_ALPHA_WEBGL,nt.premultiplyAlpha),B.pixelStorei(B.UNPACK_ALIGNMENT,nt.unpackAlignment),B.pixelStorei(B.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ci);const Wi=nt.isCompressedTexture||nt.image[0].isCompressedTexture,ki=nt.image[0]&&nt.image[0].isDataTexture,Li=[];for(let xi=0;xi<6;xi++)!Wi&&!ki?Li[xi]=xe(nt.image[xi],!0,W.maxCubemapSize):Li[xi]=ki?nt.image[xi].image:nt.image[xi],Li[xi]=Kr(nt,Li[xi]);const mn=Li[0],cn=X.convert(nt.format,nt.colorSpace),qi=X.convert(nt.type),wn=Ie(nt.internalFormat,cn,qi,nt.colorSpace),An=nt.isVideoTexture!==!0,Hr=si.__version===void 0||Dr===!0,vi=ti.dataReady;let Lr=Ve(nt,mn);mt(B.TEXTURE_CUBE_MAP,nt);let _i;if(Wi){An&&Hr&&T.texStorage2D(B.TEXTURE_CUBE_MAP,Lr,wn,mn.width,mn.height);for(let xi=0;xi<6;xi++){_i=Li[xi].mipmaps;for(let Ni=0;Ni<_i.length;Ni++){const Ui=_i[Ni];nt.format!==RGBAFormat?cn!==null?An?vi&&T.compressedTexSubImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni,0,0,Ui.width,Ui.height,cn,Ui.data):T.compressedTexImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni,wn,Ui.width,Ui.height,0,Ui.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):An?vi&&T.texSubImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni,0,0,Ui.width,Ui.height,cn,qi,Ui.data):T.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni,wn,Ui.width,Ui.height,0,cn,qi,Ui.data)}}}else{if(_i=nt.mipmaps,An&&Hr){_i.length>0&&Lr++;const xi=oi(Li[0]);T.texStorage2D(B.TEXTURE_CUBE_MAP,Lr,wn,xi.width,xi.height)}for(let xi=0;xi<6;xi++)if(ki){An?vi&&T.texSubImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,0,0,0,Li[xi].width,Li[xi].height,cn,qi,Li[xi].data):T.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,0,wn,Li[xi].width,Li[xi].height,0,cn,qi,Li[xi].data);for(let Ni=0;Ni<_i.length;Ni++){const Vn=_i[Ni].image[xi].image;An?vi&&T.texSubImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni+1,0,0,Vn.width,Vn.height,cn,qi,Vn.data):T.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni+1,wn,Vn.width,Vn.height,0,cn,qi,Vn.data)}}else{An?vi&&T.texSubImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,0,0,0,cn,qi,Li[xi]):T.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,0,wn,cn,qi,Li[xi]);for(let Ni=0;Ni<_i.length;Ni++){const Ui=_i[Ni];An?vi&&T.texSubImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni+1,0,0,cn,qi,Ui.image[xi]):T.texImage2D(B.TEXTURE_CUBE_MAP_POSITIVE_X+xi,Ni+1,wn,cn,qi,Ui.image[xi])}}}Te(nt)&&Ae(B.TEXTURE_CUBE_MAP),si.__version=ti.version,nt.onUpdate&&nt.onUpdate(nt)}ct.__version=nt.version}function Gr(ct,nt,Ir,Dr,ti,si){const Ai=X.convert(Ir.format,Ir.colorSpace),Oi=X.convert(Ir.type),Ci=Ie(Ir.internalFormat,Ai,Oi,Ir.colorSpace);if(!E.get(nt).__hasExternalTextures){const ki=Math.max(1,nt.width>>si),Li=Math.max(1,nt.height>>si);ti===B.TEXTURE_3D||ti===B.TEXTURE_2D_ARRAY?T.texImage3D(ti,si,Ci,ki,Li,nt.depth,0,Ai,Oi,null):T.texImage2D(ti,si,Ci,ki,Li,0,Ai,Oi,null)}T.bindFramebuffer(B.FRAMEBUFFER,ct),Rr(nt)?Y.framebufferTexture2DMultisampleEXT(B.FRAMEBUFFER,Dr,ti,E.get(Ir).__webglTexture,0,at(nt)):(ti===B.TEXTURE_2D||ti>=B.TEXTURE_CUBE_MAP_POSITIVE_X&&ti<=B.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&B.framebufferTexture2D(B.FRAMEBUFFER,Dr,ti,E.get(Ir).__webglTexture,si),T.bindFramebuffer(B.FRAMEBUFFER,null)}function ci(ct,nt,Ir){if(B.bindRenderbuffer(B.RENDERBUFFER,ct),nt.depthBuffer&&!nt.stencilBuffer){let Dr=B.DEPTH_COMPONENT24;if(Ir||Rr(nt)){const ti=nt.depthTexture;ti&&ti.isDepthTexture&&(ti.type===FloatType?Dr=B.DEPTH_COMPONENT32F:ti.type===UnsignedIntType&&(Dr=B.DEPTH_COMPONENT24));const si=at(nt);Rr(nt)?Y.renderbufferStorageMultisampleEXT(B.RENDERBUFFER,si,Dr,nt.width,nt.height):B.renderbufferStorageMultisample(B.RENDERBUFFER,si,Dr,nt.width,nt.height)}else B.renderbufferStorage(B.RENDERBUFFER,Dr,nt.width,nt.height);B.framebufferRenderbuffer(B.FRAMEBUFFER,B.DEPTH_ATTACHMENT,B.RENDERBUFFER,ct)}else if(nt.depthBuffer&&nt.stencilBuffer){const Dr=at(nt);Ir&&Rr(nt)===!1?B.renderbufferStorageMultisample(B.RENDERBUFFER,Dr,B.DEPTH24_STENCIL8,nt.width,nt.height):Rr(nt)?Y.renderbufferStorageMultisampleEXT(B.RENDERBUFFER,Dr,B.DEPTH24_STENCIL8,nt.width,nt.height):B.renderbufferStorage(B.RENDERBUFFER,B.DEPTH_STENCIL,nt.width,nt.height),B.framebufferRenderbuffer(B.FRAMEBUFFER,B.DEPTH_STENCIL_ATTACHMENT,B.RENDERBUFFER,ct)}else{const Dr=nt.textures;for(let ti=0;ti<Dr.length;ti++){const si=Dr[ti],Ai=X.convert(si.format,si.colorSpace),Oi=X.convert(si.type),Ci=Ie(si.internalFormat,Ai,Oi,si.colorSpace),Wi=at(nt);Ir&&Rr(nt)===!1?B.renderbufferStorageMultisample(B.RENDERBUFFER,Wi,Ci,nt.width,nt.height):Rr(nt)?Y.renderbufferStorageMultisampleEXT(B.RENDERBUFFER,Wi,Ci,nt.width,nt.height):B.renderbufferStorage(B.RENDERBUFFER,Ci,nt.width,nt.height)}}B.bindRenderbuffer(B.RENDERBUFFER,null)}function gi(ct,nt){if(nt&&nt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(T.bindFramebuffer(B.FRAMEBUFFER,ct),!(nt.depthTexture&&nt.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!E.get(nt.depthTexture).__webglTexture||nt.depthTexture.image.width!==nt.width||nt.depthTexture.image.height!==nt.height)&&(nt.depthTexture.image.width=nt.width,nt.depthTexture.image.height=nt.height,nt.depthTexture.needsUpdate=!0),Ke(nt.depthTexture,0);const Dr=E.get(nt.depthTexture).__webglTexture,ti=at(nt);if(nt.depthTexture.format===DepthFormat)Rr(nt)?Y.framebufferTexture2DMultisampleEXT(B.FRAMEBUFFER,B.DEPTH_ATTACHMENT,B.TEXTURE_2D,Dr,0,ti):B.framebufferTexture2D(B.FRAMEBUFFER,B.DEPTH_ATTACHMENT,B.TEXTURE_2D,Dr,0);else if(nt.depthTexture.format===DepthStencilFormat)Rr(nt)?Y.framebufferTexture2DMultisampleEXT(B.FRAMEBUFFER,B.DEPTH_STENCIL_ATTACHMENT,B.TEXTURE_2D,Dr,0,ti):B.framebufferTexture2D(B.FRAMEBUFFER,B.DEPTH_STENCIL_ATTACHMENT,B.TEXTURE_2D,Dr,0);else throw new Error("Unknown depthTexture format")}function fi(ct){const nt=E.get(ct),Ir=ct.isWebGLCubeRenderTarget===!0;if(ct.depthTexture&&!nt.__autoAllocateDepthBuffer){if(Ir)throw new Error("target.depthTexture not supported in Cube render targets");gi(nt.__webglFramebuffer,ct)}else if(Ir){nt.__webglDepthbuffer=[];for(let Dr=0;Dr<6;Dr++)T.bindFramebuffer(B.FRAMEBUFFER,nt.__webglFramebuffer[Dr]),nt.__webglDepthbuffer[Dr]=B.createRenderbuffer(),ci(nt.__webglDepthbuffer[Dr],ct,!1)}else T.bindFramebuffer(B.FRAMEBUFFER,nt.__webglFramebuffer),nt.__webglDepthbuffer=B.createRenderbuffer(),ci(nt.__webglDepthbuffer,ct,!1);T.bindFramebuffer(B.FRAMEBUFFER,null)}function ri(ct,nt,Ir){const Dr=E.get(ct);nt!==void 0&&Gr(Dr.__webglFramebuffer,ct,ct.texture,B.COLOR_ATTACHMENT0,B.TEXTURE_2D,0),Ir!==void 0&&fi(ct)}function ot(ct){const nt=ct.texture,Ir=E.get(ct),Dr=E.get(nt);ct.addEventListener("dispose",We);const ti=ct.textures,si=ct.isWebGLCubeRenderTarget===!0,Ai=ti.length>1;if(Ai||(Dr.__webglTexture===void 0&&(Dr.__webglTexture=B.createTexture()),Dr.__version=nt.version,q.memory.textures++),si){Ir.__webglFramebuffer=[];for(let Oi=0;Oi<6;Oi++)if(nt.mipmaps&&nt.mipmaps.length>0){Ir.__webglFramebuffer[Oi]=[];for(let Ci=0;Ci<nt.mipmaps.length;Ci++)Ir.__webglFramebuffer[Oi][Ci]=B.createFramebuffer()}else Ir.__webglFramebuffer[Oi]=B.createFramebuffer()}else{if(nt.mipmaps&&nt.mipmaps.length>0){Ir.__webglFramebuffer=[];for(let Oi=0;Oi<nt.mipmaps.length;Oi++)Ir.__webglFramebuffer[Oi]=B.createFramebuffer()}else Ir.__webglFramebuffer=B.createFramebuffer();if(Ai)for(let Oi=0,Ci=ti.length;Oi<Ci;Oi++){const Wi=E.get(ti[Oi]);Wi.__webglTexture===void 0&&(Wi.__webglTexture=B.createTexture(),q.memory.textures++)}if(ct.samples>0&&Rr(ct)===!1){Ir.__webglMultisampledFramebuffer=B.createFramebuffer(),Ir.__webglColorRenderbuffer=[],T.bindFramebuffer(B.FRAMEBUFFER,Ir.__webglMultisampledFramebuffer);for(let Oi=0;Oi<ti.length;Oi++){const Ci=ti[Oi];Ir.__webglColorRenderbuffer[Oi]=B.createRenderbuffer(),B.bindRenderbuffer(B.RENDERBUFFER,Ir.__webglColorRenderbuffer[Oi]);const Wi=X.convert(Ci.format,Ci.colorSpace),ki=X.convert(Ci.type),Li=Ie(Ci.internalFormat,Wi,ki,Ci.colorSpace,ct.isXRRenderTarget===!0),mn=at(ct);B.renderbufferStorageMultisample(B.RENDERBUFFER,mn,Li,ct.width,ct.height),B.framebufferRenderbuffer(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0+Oi,B.RENDERBUFFER,Ir.__webglColorRenderbuffer[Oi])}B.bindRenderbuffer(B.RENDERBUFFER,null),ct.depthBuffer&&(Ir.__webglDepthRenderbuffer=B.createRenderbuffer(),ci(Ir.__webglDepthRenderbuffer,ct,!0)),T.bindFramebuffer(B.FRAMEBUFFER,null)}}if(si){T.bindTexture(B.TEXTURE_CUBE_MAP,Dr.__webglTexture),mt(B.TEXTURE_CUBE_MAP,nt);for(let Oi=0;Oi<6;Oi++)if(nt.mipmaps&&nt.mipmaps.length>0)for(let Ci=0;Ci<nt.mipmaps.length;Ci++)Gr(Ir.__webglFramebuffer[Oi][Ci],ct,nt,B.COLOR_ATTACHMENT0,B.TEXTURE_CUBE_MAP_POSITIVE_X+Oi,Ci);else Gr(Ir.__webglFramebuffer[Oi],ct,nt,B.COLOR_ATTACHMENT0,B.TEXTURE_CUBE_MAP_POSITIVE_X+Oi,0);Te(nt)&&Ae(B.TEXTURE_CUBE_MAP),T.unbindTexture()}else if(Ai){for(let Oi=0,Ci=ti.length;Oi<Ci;Oi++){const Wi=ti[Oi],ki=E.get(Wi);T.bindTexture(B.TEXTURE_2D,ki.__webglTexture),mt(B.TEXTURE_2D,Wi),Gr(Ir.__webglFramebuffer,ct,Wi,B.COLOR_ATTACHMENT0+Oi,B.TEXTURE_2D,0),Te(Wi)&&Ae(B.TEXTURE_2D)}T.unbindTexture()}else{let Oi=B.TEXTURE_2D;if((ct.isWebGL3DRenderTarget||ct.isWebGLArrayRenderTarget)&&(Oi=ct.isWebGL3DRenderTarget?B.TEXTURE_3D:B.TEXTURE_2D_ARRAY),T.bindTexture(Oi,Dr.__webglTexture),mt(Oi,nt),nt.mipmaps&&nt.mipmaps.length>0)for(let Ci=0;Ci<nt.mipmaps.length;Ci++)Gr(Ir.__webglFramebuffer[Ci],ct,nt,B.COLOR_ATTACHMENT0,Oi,Ci);else Gr(Ir.__webglFramebuffer,ct,nt,B.COLOR_ATTACHMENT0,Oi,0);Te(nt)&&Ae(Oi),T.unbindTexture()}ct.depthBuffer&&fi(ct)}function rt(ct){const nt=ct.textures;for(let Ir=0,Dr=nt.length;Ir<Dr;Ir++){const ti=nt[Ir];if(Te(ti)){const si=ct.isWebGLCubeRenderTarget?B.TEXTURE_CUBE_MAP:B.TEXTURE_2D,Ai=E.get(ti).__webglTexture;T.bindTexture(si,Ai),Ae(si),T.unbindTexture()}}}const gt=[],Or=[];function et(ct){if(ct.samples>0){if(Rr(ct)===!1){const nt=ct.textures,Ir=ct.width,Dr=ct.height;let ti=B.COLOR_BUFFER_BIT;const si=ct.stencilBuffer?B.DEPTH_STENCIL_ATTACHMENT:B.DEPTH_ATTACHMENT,Ai=E.get(ct),Oi=nt.length>1;if(Oi)for(let Ci=0;Ci<nt.length;Ci++)T.bindFramebuffer(B.FRAMEBUFFER,Ai.__webglMultisampledFramebuffer),B.framebufferRenderbuffer(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0+Ci,B.RENDERBUFFER,null),T.bindFramebuffer(B.FRAMEBUFFER,Ai.__webglFramebuffer),B.framebufferTexture2D(B.DRAW_FRAMEBUFFER,B.COLOR_ATTACHMENT0+Ci,B.TEXTURE_2D,null,0);T.bindFramebuffer(B.READ_FRAMEBUFFER,Ai.__webglMultisampledFramebuffer),T.bindFramebuffer(B.DRAW_FRAMEBUFFER,Ai.__webglFramebuffer);for(let Ci=0;Ci<nt.length;Ci++){if(ct.resolveDepthBuffer&&(ct.depthBuffer&&(ti|=B.DEPTH_BUFFER_BIT),ct.stencilBuffer&&ct.resolveStencilBuffer&&(ti|=B.STENCIL_BUFFER_BIT)),Oi){B.framebufferRenderbuffer(B.READ_FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.RENDERBUFFER,Ai.__webglColorRenderbuffer[Ci]);const Wi=E.get(nt[Ci]).__webglTexture;B.framebufferTexture2D(B.DRAW_FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_2D,Wi,0)}B.blitFramebuffer(0,0,Ir,Dr,0,0,Ir,Dr,ti,B.NEAREST),te===!0&&(gt.length=0,Or.length=0,gt.push(B.COLOR_ATTACHMENT0+Ci),ct.depthBuffer&&ct.resolveDepthBuffer===!1&&(gt.push(si),Or.push(si),B.invalidateFramebuffer(B.DRAW_FRAMEBUFFER,Or)),B.invalidateFramebuffer(B.READ_FRAMEBUFFER,gt))}if(T.bindFramebuffer(B.READ_FRAMEBUFFER,null),T.bindFramebuffer(B.DRAW_FRAMEBUFFER,null),Oi)for(let Ci=0;Ci<nt.length;Ci++){T.bindFramebuffer(B.FRAMEBUFFER,Ai.__webglMultisampledFramebuffer),B.framebufferRenderbuffer(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0+Ci,B.RENDERBUFFER,Ai.__webglColorRenderbuffer[Ci]);const Wi=E.get(nt[Ci]).__webglTexture;T.bindFramebuffer(B.FRAMEBUFFER,Ai.__webglFramebuffer),B.framebufferTexture2D(B.DRAW_FRAMEBUFFER,B.COLOR_ATTACHMENT0+Ci,B.TEXTURE_2D,Wi,0)}T.bindFramebuffer(B.DRAW_FRAMEBUFFER,Ai.__webglMultisampledFramebuffer)}else if(ct.depthBuffer&&ct.resolveDepthBuffer===!1&&te){const nt=ct.stencilBuffer?B.DEPTH_STENCIL_ATTACHMENT:B.DEPTH_ATTACHMENT;B.invalidateFramebuffer(B.DRAW_FRAMEBUFFER,[nt])}}}function at(ct){return Math.min(W.maxSamples,ct.samples)}function Rr(ct){const nt=E.get(ct);return ct.samples>0&&_.has("WEBGL_multisampled_render_to_texture")===!0&&nt.__useRenderToTexture!==!1}function Br(ct){const nt=q.render.frame;ae.get(ct)!==nt&&(ae.set(ct,nt),ct.update())}function Kr(ct,nt){const Ir=ct.colorSpace,Dr=ct.format,ti=ct.type;return ct.isCompressedTexture===!0||ct.isVideoTexture===!0||Ir!==LinearSRGBColorSpace&&Ir!==NoColorSpace&&(ColorManagement.getTransfer(Ir)===SRGBTransfer?(Dr!==RGBAFormat||ti!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ir)),nt}function oi(ct){return typeof HTMLImageElement<"u"&&ct instanceof HTMLImageElement?(ne.width=ct.naturalWidth||ct.width,ne.height=ct.naturalHeight||ct.height):typeof VideoFrame<"u"&&ct instanceof VideoFrame?(ne.width=ct.displayWidth,ne.height=ct.displayHeight):(ne.width=ct.width,ne.height=ct.height),ne}this.allocateTextureUnit=qe,this.resetTextureUnits=Le,this.setTexture2D=Ke,this.setTexture2DArray=Je,this.setTexture3D=pt,this.setTextureCube=ut,this.rebindTextures=ri,this.setupRenderTarget=ot,this.updateRenderTargetMipmap=rt,this.updateMultisampleRenderTarget=et,this.setupDepthRenderbuffer=fi,this.setupFrameBufferTexture=Gr,this.useMultisampledRTT=Rr}function WebGLUtils(B,_){function T(E,W=NoColorSpace){let X;const q=ColorManagement.getTransfer(W);if(E===UnsignedByteType)return B.UNSIGNED_BYTE;if(E===UnsignedShort4444Type)return B.UNSIGNED_SHORT_4_4_4_4;if(E===UnsignedShort5551Type)return B.UNSIGNED_SHORT_5_5_5_1;if(E===UnsignedInt5999Type)return B.UNSIGNED_INT_5_9_9_9_REV;if(E===ByteType)return B.BYTE;if(E===ShortType)return B.SHORT;if(E===UnsignedShortType)return B.UNSIGNED_SHORT;if(E===IntType)return B.INT;if(E===UnsignedIntType)return B.UNSIGNED_INT;if(E===FloatType)return B.FLOAT;if(E===HalfFloatType)return B.HALF_FLOAT;if(E===AlphaFormat)return B.ALPHA;if(E===RGBFormat)return B.RGB;if(E===RGBAFormat)return B.RGBA;if(E===LuminanceFormat)return B.LUMINANCE;if(E===LuminanceAlphaFormat)return B.LUMINANCE_ALPHA;if(E===DepthFormat)return B.DEPTH_COMPONENT;if(E===DepthStencilFormat)return B.DEPTH_STENCIL;if(E===RedFormat)return B.RED;if(E===RedIntegerFormat)return B.RED_INTEGER;if(E===RGFormat)return B.RG;if(E===RGIntegerFormat)return B.RG_INTEGER;if(E===RGBAIntegerFormat)return B.RGBA_INTEGER;if(E===RGB_S3TC_DXT1_Format||E===RGBA_S3TC_DXT1_Format||E===RGBA_S3TC_DXT3_Format||E===RGBA_S3TC_DXT5_Format)if(q===SRGBTransfer)if(X=_.get("WEBGL_compressed_texture_s3tc_srgb"),X!==null){if(E===RGB_S3TC_DXT1_Format)return X.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(E===RGBA_S3TC_DXT1_Format)return X.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(E===RGBA_S3TC_DXT3_Format)return X.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(E===RGBA_S3TC_DXT5_Format)return X.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(X=_.get("WEBGL_compressed_texture_s3tc"),X!==null){if(E===RGB_S3TC_DXT1_Format)return X.COMPRESSED_RGB_S3TC_DXT1_EXT;if(E===RGBA_S3TC_DXT1_Format)return X.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(E===RGBA_S3TC_DXT3_Format)return X.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(E===RGBA_S3TC_DXT5_Format)return X.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(E===RGB_PVRTC_4BPPV1_Format||E===RGB_PVRTC_2BPPV1_Format||E===RGBA_PVRTC_4BPPV1_Format||E===RGBA_PVRTC_2BPPV1_Format)if(X=_.get("WEBGL_compressed_texture_pvrtc"),X!==null){if(E===RGB_PVRTC_4BPPV1_Format)return X.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(E===RGB_PVRTC_2BPPV1_Format)return X.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(E===RGBA_PVRTC_4BPPV1_Format)return X.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(E===RGBA_PVRTC_2BPPV1_Format)return X.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(E===RGB_ETC1_Format||E===RGB_ETC2_Format||E===RGBA_ETC2_EAC_Format)if(X=_.get("WEBGL_compressed_texture_etc"),X!==null){if(E===RGB_ETC1_Format||E===RGB_ETC2_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ETC2:X.COMPRESSED_RGB8_ETC2;if(E===RGBA_ETC2_EAC_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:X.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(E===RGBA_ASTC_4x4_Format||E===RGBA_ASTC_5x4_Format||E===RGBA_ASTC_5x5_Format||E===RGBA_ASTC_6x5_Format||E===RGBA_ASTC_6x6_Format||E===RGBA_ASTC_8x5_Format||E===RGBA_ASTC_8x6_Format||E===RGBA_ASTC_8x8_Format||E===RGBA_ASTC_10x5_Format||E===RGBA_ASTC_10x6_Format||E===RGBA_ASTC_10x8_Format||E===RGBA_ASTC_10x10_Format||E===RGBA_ASTC_12x10_Format||E===RGBA_ASTC_12x12_Format)if(X=_.get("WEBGL_compressed_texture_astc"),X!==null){if(E===RGBA_ASTC_4x4_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:X.COMPRESSED_RGBA_ASTC_4x4_KHR;if(E===RGBA_ASTC_5x4_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:X.COMPRESSED_RGBA_ASTC_5x4_KHR;if(E===RGBA_ASTC_5x5_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:X.COMPRESSED_RGBA_ASTC_5x5_KHR;if(E===RGBA_ASTC_6x5_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:X.COMPRESSED_RGBA_ASTC_6x5_KHR;if(E===RGBA_ASTC_6x6_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:X.COMPRESSED_RGBA_ASTC_6x6_KHR;if(E===RGBA_ASTC_8x5_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:X.COMPRESSED_RGBA_ASTC_8x5_KHR;if(E===RGBA_ASTC_8x6_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:X.COMPRESSED_RGBA_ASTC_8x6_KHR;if(E===RGBA_ASTC_8x8_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:X.COMPRESSED_RGBA_ASTC_8x8_KHR;if(E===RGBA_ASTC_10x5_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:X.COMPRESSED_RGBA_ASTC_10x5_KHR;if(E===RGBA_ASTC_10x6_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:X.COMPRESSED_RGBA_ASTC_10x6_KHR;if(E===RGBA_ASTC_10x8_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:X.COMPRESSED_RGBA_ASTC_10x8_KHR;if(E===RGBA_ASTC_10x10_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:X.COMPRESSED_RGBA_ASTC_10x10_KHR;if(E===RGBA_ASTC_12x10_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:X.COMPRESSED_RGBA_ASTC_12x10_KHR;if(E===RGBA_ASTC_12x12_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:X.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(E===RGBA_BPTC_Format||E===RGB_BPTC_SIGNED_Format||E===RGB_BPTC_UNSIGNED_Format)if(X=_.get("EXT_texture_compression_bptc"),X!==null){if(E===RGBA_BPTC_Format)return q===SRGBTransfer?X.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:X.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(E===RGB_BPTC_SIGNED_Format)return X.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(E===RGB_BPTC_UNSIGNED_Format)return X.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(E===RED_RGTC1_Format||E===SIGNED_RED_RGTC1_Format||E===RED_GREEN_RGTC2_Format||E===SIGNED_RED_GREEN_RGTC2_Format)if(X=_.get("EXT_texture_compression_rgtc"),X!==null){if(E===RGBA_BPTC_Format)return X.COMPRESSED_RED_RGTC1_EXT;if(E===SIGNED_RED_RGTC1_Format)return X.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(E===RED_GREEN_RGTC2_Format)return X.COMPRESSED_RED_GREEN_RGTC2_EXT;if(E===SIGNED_RED_GREEN_RGTC2_Format)return X.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return E===UnsignedInt248Type?B.UNSIGNED_INT_24_8:B[E]!==void 0?B[E]:null}return{convert:T}}class ArrayCamera extends PerspectiveCamera{constructor(_=[]){super(),this.isArrayCamera=!0,this.cameras=_}}let Group$1=class extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}};const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group$1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group$1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group$1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(_){return this._targetRay!==null&&this._targetRay.dispatchEvent(_),this._grip!==null&&this._grip.dispatchEvent(_),this._hand!==null&&this._hand.dispatchEvent(_),this}connect(_){if(_&&_.hand){const T=this._hand;if(T)for(const E of _.hand.values())this._getHandJoint(T,E)}return this.dispatchEvent({type:"connected",data:_}),this}disconnect(_){return this.dispatchEvent({type:"disconnected",data:_}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_,T,E){let W=null,X=null,q=null;const Y=this._targetRay,te=this._grip,ne=this._hand;if(_&&T.session.visibilityState!=="visible-blurred"){if(ne&&_.hand){q=!0;for(const xe of _.hand.values()){const Te=T.getJointPose(xe,E),Ae=this._getHandJoint(ne,xe);Te!==null&&(Ae.matrix.fromArray(Te.transform.matrix),Ae.matrix.decompose(Ae.position,Ae.rotation,Ae.scale),Ae.matrixWorldNeedsUpdate=!0,Ae.jointRadius=Te.radius),Ae.visible=Te!==null}const ae=ne.joints["index-finger-tip"],le=ne.joints["thumb-tip"],ue=ae.position.distanceTo(le.position),ge=.02,ye=.005;ne.inputState.pinching&&ue>ge+ye?(ne.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_.handedness,target:this})):!ne.inputState.pinching&&ue<=ge-ye&&(ne.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_.handedness,target:this}))}else te!==null&&_.gripSpace&&(X=T.getPose(_.gripSpace,E),X!==null&&(te.matrix.fromArray(X.transform.matrix),te.matrix.decompose(te.position,te.rotation,te.scale),te.matrixWorldNeedsUpdate=!0,X.linearVelocity?(te.hasLinearVelocity=!0,te.linearVelocity.copy(X.linearVelocity)):te.hasLinearVelocity=!1,X.angularVelocity?(te.hasAngularVelocity=!0,te.angularVelocity.copy(X.angularVelocity)):te.hasAngularVelocity=!1));Y!==null&&(W=T.getPose(_.targetRaySpace,E),W===null&&X!==null&&(W=X),W!==null&&(Y.matrix.fromArray(W.transform.matrix),Y.matrix.decompose(Y.position,Y.rotation,Y.scale),Y.matrixWorldNeedsUpdate=!0,W.linearVelocity?(Y.hasLinearVelocity=!0,Y.linearVelocity.copy(W.linearVelocity)):Y.hasLinearVelocity=!1,W.angularVelocity?(Y.hasAngularVelocity=!0,Y.angularVelocity.copy(W.angularVelocity)):Y.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return Y!==null&&(Y.visible=W!==null),te!==null&&(te.visible=X!==null),ne!==null&&(ne.visible=q!==null),this}_getHandJoint(_,T){if(_.joints[T.jointName]===void 0){const E=new Group$1;E.matrixAutoUpdate=!1,E.visible=!1,_.joints[T.jointName]=E,_.add(E)}return _.joints[T.jointName]}}const _occlusion_vertex=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_occlusion_fragment=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class WebXRDepthSensing{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(_,T,E){if(this.texture===null){const W=new Texture,X=_.properties.get(W);X.__webglTexture=T.texture,(T.depthNear!=E.depthNear||T.depthFar!=E.depthFar)&&(this.depthNear=T.depthNear,this.depthFar=T.depthFar),this.texture=W}}render(_,T){if(this.texture!==null){if(this.mesh===null){const E=T.cameras[0].viewport,W=new ShaderMaterial({vertexShader:_occlusion_vertex,fragmentShader:_occlusion_fragment,uniforms:{depthColor:{value:this.texture},depthWidth:{value:E.z},depthHeight:{value:E.w}}});this.mesh=new Mesh(new PlaneGeometry(20,20),W)}_.render(this.mesh,T)}}reset(){this.texture=null,this.mesh=null}}class WebXRManager extends EventDispatcher{constructor(_,T){super();const E=this;let W=null,X=1,q=null,Y="local-floor",te=1,ne=null,ae=null,le=null,ue=null,ge=null,ye=null;const xe=new WebXRDepthSensing,Te=T.getContextAttributes();let Ae=null,Ie=null;const Ve=[],$e=[],We=new Vector2;let Ue=null;const je=new PerspectiveCamera;je.layers.enable(1),je.viewport=new Vector4;const ze=new PerspectiveCamera;ze.layers.enable(2),ze.viewport=new Vector4;const He=[je,ze],Le=new ArrayCamera;Le.layers.enable(1),Le.layers.enable(2);let qe=null,Qe=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Gr){let ci=Ve[Gr];return ci===void 0&&(ci=new WebXRController,Ve[Gr]=ci),ci.getTargetRaySpace()},this.getControllerGrip=function(Gr){let ci=Ve[Gr];return ci===void 0&&(ci=new WebXRController,Ve[Gr]=ci),ci.getGripSpace()},this.getHand=function(Gr){let ci=Ve[Gr];return ci===void 0&&(ci=new WebXRController,Ve[Gr]=ci),ci.getHandSpace()};function Ke(Gr){const ci=$e.indexOf(Gr.inputSource);if(ci===-1)return;const gi=Ve[ci];gi!==void 0&&(gi.update(Gr.inputSource,Gr.frame,ne||q),gi.dispatchEvent({type:Gr.type,data:Gr.inputSource}))}function Je(){W.removeEventListener("select",Ke),W.removeEventListener("selectstart",Ke),W.removeEventListener("selectend",Ke),W.removeEventListener("squeeze",Ke),W.removeEventListener("squeezestart",Ke),W.removeEventListener("squeezeend",Ke),W.removeEventListener("end",Je),W.removeEventListener("inputsourceschange",pt);for(let Gr=0;Gr<Ve.length;Gr++){const ci=$e[Gr];ci!==null&&($e[Gr]=null,Ve[Gr].disconnect(ci))}qe=null,Qe=null,xe.reset(),_.setRenderTarget(Ae),ge=null,ue=null,le=null,W=null,Ie=null,Mi.stop(),E.isPresenting=!1,_.setPixelRatio(Ue),_.setSize(We.width,We.height,!1),E.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Gr){X=Gr,E.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Gr){Y=Gr,E.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return ne||q},this.setReferenceSpace=function(Gr){ne=Gr},this.getBaseLayer=function(){return ue!==null?ue:ge},this.getBinding=function(){return le},this.getFrame=function(){return ye},this.getSession=function(){return W},this.setSession=async function(Gr){if(W=Gr,W!==null){if(Ae=_.getRenderTarget(),W.addEventListener("select",Ke),W.addEventListener("selectstart",Ke),W.addEventListener("selectend",Ke),W.addEventListener("squeeze",Ke),W.addEventListener("squeezestart",Ke),W.addEventListener("squeezeend",Ke),W.addEventListener("end",Je),W.addEventListener("inputsourceschange",pt),Te.xrCompatible!==!0&&await T.makeXRCompatible(),Ue=_.getPixelRatio(),_.getSize(We),W.renderState.layers===void 0){const ci={antialias:Te.antialias,alpha:!0,depth:Te.depth,stencil:Te.stencil,framebufferScaleFactor:X};ge=new XRWebGLLayer(W,T,ci),W.updateRenderState({baseLayer:ge}),_.setPixelRatio(1),_.setSize(ge.framebufferWidth,ge.framebufferHeight,!1),Ie=new WebGLRenderTarget(ge.framebufferWidth,ge.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:_.outputColorSpace,stencilBuffer:Te.stencil})}else{let ci=null,gi=null,fi=null;Te.depth&&(fi=Te.stencil?T.DEPTH24_STENCIL8:T.DEPTH_COMPONENT24,ci=Te.stencil?DepthStencilFormat:DepthFormat,gi=Te.stencil?UnsignedInt248Type:UnsignedIntType);const ri={colorFormat:T.RGBA8,depthFormat:fi,scaleFactor:X};le=new XRWebGLBinding(W,T),ue=le.createProjectionLayer(ri),W.updateRenderState({layers:[ue]}),_.setPixelRatio(1),_.setSize(ue.textureWidth,ue.textureHeight,!1),Ie=new WebGLRenderTarget(ue.textureWidth,ue.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(ue.textureWidth,ue.textureHeight,gi,void 0,void 0,void 0,void 0,void 0,void 0,ci),stencilBuffer:Te.stencil,colorSpace:_.outputColorSpace,samples:Te.antialias?4:0,resolveDepthBuffer:ue.ignoreDepthValues===!1})}Ie.isXRRenderTarget=!0,this.setFoveation(te),ne=null,q=await W.requestReferenceSpace(Y),Mi.setContext(W),Mi.start(),E.isPresenting=!0,E.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(W!==null)return W.environmentBlendMode};function pt(Gr){for(let ci=0;ci<Gr.removed.length;ci++){const gi=Gr.removed[ci],fi=$e.indexOf(gi);fi>=0&&($e[fi]=null,Ve[fi].disconnect(gi))}for(let ci=0;ci<Gr.added.length;ci++){const gi=Gr.added[ci];let fi=$e.indexOf(gi);if(fi===-1){for(let ot=0;ot<Ve.length;ot++)if(ot>=$e.length){$e.push(gi),fi=ot;break}else if($e[ot]===null){$e[ot]=gi,fi=ot;break}if(fi===-1)break}const ri=Ve[fi];ri&&ri.connect(gi)}}const ut=new Vector3,lt=new Vector3;function st(Gr,ci,gi){ut.setFromMatrixPosition(ci.matrixWorld),lt.setFromMatrixPosition(gi.matrixWorld);const fi=ut.distanceTo(lt),ri=ci.projectionMatrix.elements,ot=gi.projectionMatrix.elements,rt=ri[14]/(ri[10]-1),gt=ri[14]/(ri[10]+1),Or=(ri[9]+1)/ri[5],et=(ri[9]-1)/ri[5],at=(ri[8]-1)/ri[0],Rr=(ot[8]+1)/ot[0],Br=rt*at,Kr=rt*Rr,oi=fi/(-at+Rr),ct=oi*-at;ci.matrixWorld.decompose(Gr.position,Gr.quaternion,Gr.scale),Gr.translateX(ct),Gr.translateZ(oi),Gr.matrixWorld.compose(Gr.position,Gr.quaternion,Gr.scale),Gr.matrixWorldInverse.copy(Gr.matrixWorld).invert();const nt=rt+oi,Ir=gt+oi,Dr=Br-ct,ti=Kr+(fi-ct),si=Or*gt/Ir*nt,Ai=et*gt/Ir*nt;Gr.projectionMatrix.makePerspective(Dr,ti,si,Ai,nt,Ir),Gr.projectionMatrixInverse.copy(Gr.projectionMatrix).invert()}function sr(Gr,ci){ci===null?Gr.matrixWorld.copy(Gr.matrix):Gr.matrixWorld.multiplyMatrices(ci.matrixWorld,Gr.matrix),Gr.matrixWorldInverse.copy(Gr.matrixWorld).invert()}this.updateCamera=function(Gr){if(W===null)return;xe.texture!==null&&(Gr.near=xe.depthNear,Gr.far=xe.depthFar),Le.near=ze.near=je.near=Gr.near,Le.far=ze.far=je.far=Gr.far,(qe!==Le.near||Qe!==Le.far)&&(W.updateRenderState({depthNear:Le.near,depthFar:Le.far}),qe=Le.near,Qe=Le.far,je.near=qe,je.far=Qe,ze.near=qe,ze.far=Qe,je.updateProjectionMatrix(),ze.updateProjectionMatrix(),Gr.updateProjectionMatrix());const ci=Gr.parent,gi=Le.cameras;sr(Le,ci);for(let fi=0;fi<gi.length;fi++)sr(gi[fi],ci);gi.length===2?st(Le,je,ze):Le.projectionMatrix.copy(je.projectionMatrix),mt(Gr,Le,ci)};function mt(Gr,ci,gi){gi===null?Gr.matrix.copy(ci.matrixWorld):(Gr.matrix.copy(gi.matrixWorld),Gr.matrix.invert(),Gr.matrix.multiply(ci.matrixWorld)),Gr.matrix.decompose(Gr.position,Gr.quaternion,Gr.scale),Gr.updateMatrixWorld(!0),Gr.projectionMatrix.copy(ci.projectionMatrix),Gr.projectionMatrixInverse.copy(ci.projectionMatrixInverse),Gr.isPerspectiveCamera&&(Gr.fov=RAD2DEG*2*Math.atan(1/Gr.projectionMatrix.elements[5]),Gr.zoom=1)}this.getCamera=function(){return Le},this.getFoveation=function(){if(!(ue===null&&ge===null))return te},this.setFoveation=function(Gr){te=Gr,ue!==null&&(ue.fixedFoveation=Gr),ge!==null&&ge.fixedFoveation!==void 0&&(ge.fixedFoveation=Gr)},this.hasDepthSensing=function(){return xe.texture!==null};let Tr=null;function di(Gr,ci){if(ae=ci.getViewerPose(ne||q),ye=ci,ae!==null){const gi=ae.views;ge!==null&&(_.setRenderTargetFramebuffer(Ie,ge.framebuffer),_.setRenderTarget(Ie));let fi=!1;gi.length!==Le.cameras.length&&(Le.cameras.length=0,fi=!0);for(let ot=0;ot<gi.length;ot++){const rt=gi[ot];let gt=null;if(ge!==null)gt=ge.getViewport(rt);else{const et=le.getViewSubImage(ue,rt);gt=et.viewport,ot===0&&(_.setRenderTargetTextures(Ie,et.colorTexture,ue.ignoreDepthValues?void 0:et.depthStencilTexture),_.setRenderTarget(Ie))}let Or=He[ot];Or===void 0&&(Or=new PerspectiveCamera,Or.layers.enable(ot),Or.viewport=new Vector4,He[ot]=Or),Or.matrix.fromArray(rt.transform.matrix),Or.matrix.decompose(Or.position,Or.quaternion,Or.scale),Or.projectionMatrix.fromArray(rt.projectionMatrix),Or.projectionMatrixInverse.copy(Or.projectionMatrix).invert(),Or.viewport.set(gt.x,gt.y,gt.width,gt.height),ot===0&&(Le.matrix.copy(Or.matrix),Le.matrix.decompose(Le.position,Le.quaternion,Le.scale)),fi===!0&&Le.cameras.push(Or)}const ri=W.enabledFeatures;if(ri&&ri.includes("depth-sensing")){const ot=le.getDepthInformation(gi[0]);ot&&ot.isValid&&ot.texture&&xe.init(_,ot,W.renderState)}}for(let gi=0;gi<Ve.length;gi++){const fi=$e[gi],ri=Ve[gi];fi!==null&&ri!==void 0&&ri.update(fi,ci,ne||q)}xe.render(_,Le),Tr&&Tr(Gr,ci),ci.detectedPlanes&&E.dispatchEvent({type:"planesdetected",data:ci}),ye=null}const Mi=new WebGLAnimation;Mi.setAnimationLoop(di),this.setAnimationLoop=function(Gr){Tr=Gr},this.dispose=function(){}}}const _e1=new Euler,_m1=new Matrix4;function WebGLMaterials(B,_){function T(Te,Ae){Te.matrixAutoUpdate===!0&&Te.updateMatrix(),Ae.value.copy(Te.matrix)}function E(Te,Ae){Ae.color.getRGB(Te.fogColor.value,getUnlitUniformColorSpace(B)),Ae.isFog?(Te.fogNear.value=Ae.near,Te.fogFar.value=Ae.far):Ae.isFogExp2&&(Te.fogDensity.value=Ae.density)}function W(Te,Ae,Ie,Ve,$e){Ae.isMeshBasicMaterial||Ae.isMeshLambertMaterial?X(Te,Ae):Ae.isMeshToonMaterial?(X(Te,Ae),le(Te,Ae)):Ae.isMeshPhongMaterial?(X(Te,Ae),ae(Te,Ae)):Ae.isMeshStandardMaterial?(X(Te,Ae),ue(Te,Ae),Ae.isMeshPhysicalMaterial&&ge(Te,Ae,$e)):Ae.isMeshMatcapMaterial?(X(Te,Ae),ye(Te,Ae)):Ae.isMeshDepthMaterial?X(Te,Ae):Ae.isMeshDistanceMaterial?(X(Te,Ae),xe(Te,Ae)):Ae.isMeshNormalMaterial?X(Te,Ae):Ae.isLineBasicMaterial?(q(Te,Ae),Ae.isLineDashedMaterial&&Y(Te,Ae)):Ae.isPointsMaterial?te(Te,Ae,Ie,Ve):Ae.isSpriteMaterial?ne(Te,Ae):Ae.isShadowMaterial?(Te.color.value.copy(Ae.color),Te.opacity.value=Ae.opacity):Ae.isShaderMaterial&&(Ae.uniformsNeedUpdate=!1)}function X(Te,Ae){Te.opacity.value=Ae.opacity,Ae.color&&Te.diffuse.value.copy(Ae.color),Ae.emissive&&Te.emissive.value.copy(Ae.emissive).multiplyScalar(Ae.emissiveIntensity),Ae.map&&(Te.map.value=Ae.map,T(Ae.map,Te.mapTransform)),Ae.alphaMap&&(Te.alphaMap.value=Ae.alphaMap,T(Ae.alphaMap,Te.alphaMapTransform)),Ae.bumpMap&&(Te.bumpMap.value=Ae.bumpMap,T(Ae.bumpMap,Te.bumpMapTransform),Te.bumpScale.value=Ae.bumpScale,Ae.side===BackSide&&(Te.bumpScale.value*=-1)),Ae.normalMap&&(Te.normalMap.value=Ae.normalMap,T(Ae.normalMap,Te.normalMapTransform),Te.normalScale.value.copy(Ae.normalScale),Ae.side===BackSide&&Te.normalScale.value.negate()),Ae.displacementMap&&(Te.displacementMap.value=Ae.displacementMap,T(Ae.displacementMap,Te.displacementMapTransform),Te.displacementScale.value=Ae.displacementScale,Te.displacementBias.value=Ae.displacementBias),Ae.emissiveMap&&(Te.emissiveMap.value=Ae.emissiveMap,T(Ae.emissiveMap,Te.emissiveMapTransform)),Ae.specularMap&&(Te.specularMap.value=Ae.specularMap,T(Ae.specularMap,Te.specularMapTransform)),Ae.alphaTest>0&&(Te.alphaTest.value=Ae.alphaTest);const Ie=_.get(Ae),Ve=Ie.envMap,$e=Ie.envMapRotation;if(Ve&&(Te.envMap.value=Ve,_e1.copy($e),_e1.x*=-1,_e1.y*=-1,_e1.z*=-1,Ve.isCubeTexture&&Ve.isRenderTargetTexture===!1&&(_e1.y*=-1,_e1.z*=-1),Te.envMapRotation.value.setFromMatrix4(_m1.makeRotationFromEuler(_e1)),Te.flipEnvMap.value=Ve.isCubeTexture&&Ve.isRenderTargetTexture===!1?-1:1,Te.reflectivity.value=Ae.reflectivity,Te.ior.value=Ae.ior,Te.refractionRatio.value=Ae.refractionRatio),Ae.lightMap){Te.lightMap.value=Ae.lightMap;const We=B._useLegacyLights===!0?Math.PI:1;Te.lightMapIntensity.value=Ae.lightMapIntensity*We,T(Ae.lightMap,Te.lightMapTransform)}Ae.aoMap&&(Te.aoMap.value=Ae.aoMap,Te.aoMapIntensity.value=Ae.aoMapIntensity,T(Ae.aoMap,Te.aoMapTransform))}function q(Te,Ae){Te.diffuse.value.copy(Ae.color),Te.opacity.value=Ae.opacity,Ae.map&&(Te.map.value=Ae.map,T(Ae.map,Te.mapTransform))}function Y(Te,Ae){Te.dashSize.value=Ae.dashSize,Te.totalSize.value=Ae.dashSize+Ae.gapSize,Te.scale.value=Ae.scale}function te(Te,Ae,Ie,Ve){Te.diffuse.value.copy(Ae.color),Te.opacity.value=Ae.opacity,Te.size.value=Ae.size*Ie,Te.scale.value=Ve*.5,Ae.map&&(Te.map.value=Ae.map,T(Ae.map,Te.uvTransform)),Ae.alphaMap&&(Te.alphaMap.value=Ae.alphaMap,T(Ae.alphaMap,Te.alphaMapTransform)),Ae.alphaTest>0&&(Te.alphaTest.value=Ae.alphaTest)}function ne(Te,Ae){Te.diffuse.value.copy(Ae.color),Te.opacity.value=Ae.opacity,Te.rotation.value=Ae.rotation,Ae.map&&(Te.map.value=Ae.map,T(Ae.map,Te.mapTransform)),Ae.alphaMap&&(Te.alphaMap.value=Ae.alphaMap,T(Ae.alphaMap,Te.alphaMapTransform)),Ae.alphaTest>0&&(Te.alphaTest.value=Ae.alphaTest)}function ae(Te,Ae){Te.specular.value.copy(Ae.specular),Te.shininess.value=Math.max(Ae.shininess,1e-4)}function le(Te,Ae){Ae.gradientMap&&(Te.gradientMap.value=Ae.gradientMap)}function ue(Te,Ae){Te.metalness.value=Ae.metalness,Ae.metalnessMap&&(Te.metalnessMap.value=Ae.metalnessMap,T(Ae.metalnessMap,Te.metalnessMapTransform)),Te.roughness.value=Ae.roughness,Ae.roughnessMap&&(Te.roughnessMap.value=Ae.roughnessMap,T(Ae.roughnessMap,Te.roughnessMapTransform)),Ae.envMap&&(Te.envMapIntensity.value=Ae.envMapIntensity)}function ge(Te,Ae,Ie){Te.ior.value=Ae.ior,Ae.sheen>0&&(Te.sheenColor.value.copy(Ae.sheenColor).multiplyScalar(Ae.sheen),Te.sheenRoughness.value=Ae.sheenRoughness,Ae.sheenColorMap&&(Te.sheenColorMap.value=Ae.sheenColorMap,T(Ae.sheenColorMap,Te.sheenColorMapTransform)),Ae.sheenRoughnessMap&&(Te.sheenRoughnessMap.value=Ae.sheenRoughnessMap,T(Ae.sheenRoughnessMap,Te.sheenRoughnessMapTransform))),Ae.clearcoat>0&&(Te.clearcoat.value=Ae.clearcoat,Te.clearcoatRoughness.value=Ae.clearcoatRoughness,Ae.clearcoatMap&&(Te.clearcoatMap.value=Ae.clearcoatMap,T(Ae.clearcoatMap,Te.clearcoatMapTransform)),Ae.clearcoatRoughnessMap&&(Te.clearcoatRoughnessMap.value=Ae.clearcoatRoughnessMap,T(Ae.clearcoatRoughnessMap,Te.clearcoatRoughnessMapTransform)),Ae.clearcoatNormalMap&&(Te.clearcoatNormalMap.value=Ae.clearcoatNormalMap,T(Ae.clearcoatNormalMap,Te.clearcoatNormalMapTransform),Te.clearcoatNormalScale.value.copy(Ae.clearcoatNormalScale),Ae.side===BackSide&&Te.clearcoatNormalScale.value.negate())),Ae.dispersion>0&&(Te.dispersion.value=Ae.dispersion),Ae.iridescence>0&&(Te.iridescence.value=Ae.iridescence,Te.iridescenceIOR.value=Ae.iridescenceIOR,Te.iridescenceThicknessMinimum.value=Ae.iridescenceThicknessRange[0],Te.iridescenceThicknessMaximum.value=Ae.iridescenceThicknessRange[1],Ae.iridescenceMap&&(Te.iridescenceMap.value=Ae.iridescenceMap,T(Ae.iridescenceMap,Te.iridescenceMapTransform)),Ae.iridescenceThicknessMap&&(Te.iridescenceThicknessMap.value=Ae.iridescenceThicknessMap,T(Ae.iridescenceThicknessMap,Te.iridescenceThicknessMapTransform))),Ae.transmission>0&&(Te.transmission.value=Ae.transmission,Te.transmissionSamplerMap.value=Ie.texture,Te.transmissionSamplerSize.value.set(Ie.width,Ie.height),Ae.transmissionMap&&(Te.transmissionMap.value=Ae.transmissionMap,T(Ae.transmissionMap,Te.transmissionMapTransform)),Te.thickness.value=Ae.thickness,Ae.thicknessMap&&(Te.thicknessMap.value=Ae.thicknessMap,T(Ae.thicknessMap,Te.thicknessMapTransform)),Te.attenuationDistance.value=Ae.attenuationDistance,Te.attenuationColor.value.copy(Ae.attenuationColor)),Ae.anisotropy>0&&(Te.anisotropyVector.value.set(Ae.anisotropy*Math.cos(Ae.anisotropyRotation),Ae.anisotropy*Math.sin(Ae.anisotropyRotation)),Ae.anisotropyMap&&(Te.anisotropyMap.value=Ae.anisotropyMap,T(Ae.anisotropyMap,Te.anisotropyMapTransform))),Te.specularIntensity.value=Ae.specularIntensity,Te.specularColor.value.copy(Ae.specularColor),Ae.specularColorMap&&(Te.specularColorMap.value=Ae.specularColorMap,T(Ae.specularColorMap,Te.specularColorMapTransform)),Ae.specularIntensityMap&&(Te.specularIntensityMap.value=Ae.specularIntensityMap,T(Ae.specularIntensityMap,Te.specularIntensityMapTransform))}function ye(Te,Ae){Ae.matcap&&(Te.matcap.value=Ae.matcap)}function xe(Te,Ae){const Ie=_.get(Ae).light;Te.referencePosition.value.setFromMatrixPosition(Ie.matrixWorld),Te.nearDistance.value=Ie.shadow.camera.near,Te.farDistance.value=Ie.shadow.camera.far}return{refreshFogUniforms:E,refreshMaterialUniforms:W}}function WebGLUniformsGroups(B,_,T,E){let W={},X={},q=[];const Y=B.getParameter(B.MAX_UNIFORM_BUFFER_BINDINGS);function te(Ie,Ve){const $e=Ve.program;E.uniformBlockBinding(Ie,$e)}function ne(Ie,Ve){let $e=W[Ie.id];$e===void 0&&(ye(Ie),$e=ae(Ie),W[Ie.id]=$e,Ie.addEventListener("dispose",Te));const We=Ve.program;E.updateUBOMapping(Ie,We);const Ue=_.render.frame;X[Ie.id]!==Ue&&(ue(Ie),X[Ie.id]=Ue)}function ae(Ie){const Ve=le();Ie.__bindingPointIndex=Ve;const $e=B.createBuffer(),We=Ie.__size,Ue=Ie.usage;return B.bindBuffer(B.UNIFORM_BUFFER,$e),B.bufferData(B.UNIFORM_BUFFER,We,Ue),B.bindBuffer(B.UNIFORM_BUFFER,null),B.bindBufferBase(B.UNIFORM_BUFFER,Ve,$e),$e}function le(){for(let Ie=0;Ie<Y;Ie++)if(q.indexOf(Ie)===-1)return q.push(Ie),Ie;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function ue(Ie){const Ve=W[Ie.id],$e=Ie.uniforms,We=Ie.__cache;B.bindBuffer(B.UNIFORM_BUFFER,Ve);for(let Ue=0,je=$e.length;Ue<je;Ue++){const ze=Array.isArray($e[Ue])?$e[Ue]:[$e[Ue]];for(let He=0,Le=ze.length;He<Le;He++){const qe=ze[He];if(ge(qe,Ue,He,We)===!0){const Qe=qe.__offset,Ke=Array.isArray(qe.value)?qe.value:[qe.value];let Je=0;for(let pt=0;pt<Ke.length;pt++){const ut=Ke[pt],lt=xe(ut);typeof ut=="number"||typeof ut=="boolean"?(qe.__data[0]=ut,B.bufferSubData(B.UNIFORM_BUFFER,Qe+Je,qe.__data)):ut.isMatrix3?(qe.__data[0]=ut.elements[0],qe.__data[1]=ut.elements[1],qe.__data[2]=ut.elements[2],qe.__data[3]=0,qe.__data[4]=ut.elements[3],qe.__data[5]=ut.elements[4],qe.__data[6]=ut.elements[5],qe.__data[7]=0,qe.__data[8]=ut.elements[6],qe.__data[9]=ut.elements[7],qe.__data[10]=ut.elements[8],qe.__data[11]=0):(ut.toArray(qe.__data,Je),Je+=lt.storage/Float32Array.BYTES_PER_ELEMENT)}B.bufferSubData(B.UNIFORM_BUFFER,Qe,qe.__data)}}}B.bindBuffer(B.UNIFORM_BUFFER,null)}function ge(Ie,Ve,$e,We){const Ue=Ie.value,je=Ve+"_"+$e;if(We[je]===void 0)return typeof Ue=="number"||typeof Ue=="boolean"?We[je]=Ue:We[je]=Ue.clone(),!0;{const ze=We[je];if(typeof Ue=="number"||typeof Ue=="boolean"){if(ze!==Ue)return We[je]=Ue,!0}else if(ze.equals(Ue)===!1)return ze.copy(Ue),!0}return!1}function ye(Ie){const Ve=Ie.uniforms;let $e=0;const We=16;for(let je=0,ze=Ve.length;je<ze;je++){const He=Array.isArray(Ve[je])?Ve[je]:[Ve[je]];for(let Le=0,qe=He.length;Le<qe;Le++){const Qe=He[Le],Ke=Array.isArray(Qe.value)?Qe.value:[Qe.value];for(let Je=0,pt=Ke.length;Je<pt;Je++){const ut=Ke[Je],lt=xe(ut),st=$e%We;st!==0&&We-st<lt.boundary&&($e+=We-st),Qe.__data=new Float32Array(lt.storage/Float32Array.BYTES_PER_ELEMENT),Qe.__offset=$e,$e+=lt.storage}}}const Ue=$e%We;return Ue>0&&($e+=We-Ue),Ie.__size=$e,Ie.__cache={},this}function xe(Ie){const Ve={boundary:0,storage:0};return typeof Ie=="number"||typeof Ie=="boolean"?(Ve.boundary=4,Ve.storage=4):Ie.isVector2?(Ve.boundary=8,Ve.storage=8):Ie.isVector3||Ie.isColor?(Ve.boundary=16,Ve.storage=12):Ie.isVector4?(Ve.boundary=16,Ve.storage=16):Ie.isMatrix3?(Ve.boundary=48,Ve.storage=48):Ie.isMatrix4?(Ve.boundary=64,Ve.storage=64):Ie.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",Ie),Ve}function Te(Ie){const Ve=Ie.target;Ve.removeEventListener("dispose",Te);const $e=q.indexOf(Ve.__bindingPointIndex);q.splice($e,1),B.deleteBuffer(W[Ve.id]),delete W[Ve.id],delete X[Ve.id]}function Ae(){for(const Ie in W)B.deleteBuffer(W[Ie]);q=[],W={},X={}}return{bind:te,update:ne,dispose:Ae}}class WebGLRenderer{constructor(_={}){const{canvas:T=createCanvasElement(),context:E=null,depth:W=!0,stencil:X=!1,alpha:q=!1,antialias:Y=!1,premultipliedAlpha:te=!0,preserveDrawingBuffer:ne=!1,powerPreference:ae="default",failIfMajorPerformanceCaveat:le=!1}=_;this.isWebGLRenderer=!0;let ue;if(E!==null){if(typeof WebGLRenderingContext<"u"&&E instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");ue=E.getContextAttributes().alpha}else ue=q;const ge=new Uint32Array(4),ye=new Int32Array(4);let xe=null,Te=null;const Ae=[],Ie=[];this.domElement=T,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace,this._useLegacyLights=!1,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const Ve=this;let $e=!1,We=0,Ue=0,je=null,ze=-1,He=null;const Le=new Vector4,qe=new Vector4;let Qe=null;const Ke=new Color(0);let Je=0,pt=T.width,ut=T.height,lt=1,st=null,sr=null;const mt=new Vector4(0,0,pt,ut),Tr=new Vector4(0,0,pt,ut);let di=!1;const Mi=new Frustum;let Gr=!1,ci=!1;const gi=new Matrix4,fi=new Vector3,ri={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ot(){return je===null?lt:1}let rt=E;function gt(wt,ii){return T.getContext(wt,ii)}try{const wt={alpha:!0,depth:W,stencil:X,antialias:Y,premultipliedAlpha:te,preserveDrawingBuffer:ne,powerPreference:ae,failIfMajorPerformanceCaveat:le};if("setAttribute"in T&&T.setAttribute("data-engine",`three.js r${REVISION}`),T.addEventListener("webglcontextlost",Lr,!1),T.addEventListener("webglcontextrestored",_i,!1),T.addEventListener("webglcontextcreationerror",xi,!1),rt===null){const ii="webgl2";if(rt=gt(ii,wt),rt===null)throw gt(ii)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(wt){throw console.error("THREE.WebGLRenderer: "+wt.message),wt}let Or,et,at,Rr,Br,Kr,oi,ct,nt,Ir,Dr,ti,si,Ai,Oi,Ci,Wi,ki,Li,mn,cn,qi,wn,An;function Hr(){Or=new WebGLExtensions(rt),Or.init(),qi=new WebGLUtils(rt,Or),et=new WebGLCapabilities(rt,Or,_,qi),at=new WebGLState(rt),Rr=new WebGLInfo(rt),Br=new WebGLProperties,Kr=new WebGLTextures(rt,Or,at,Br,et,qi,Rr),oi=new WebGLCubeMaps(Ve),ct=new WebGLCubeUVMaps(Ve),nt=new WebGLAttributes(rt),wn=new WebGLBindingStates(rt,nt),Ir=new WebGLGeometries(rt,nt,Rr,wn),Dr=new WebGLObjects(rt,Ir,nt,Rr),Li=new WebGLMorphtargets(rt,et,Kr),Ci=new WebGLClipping(Br),ti=new WebGLPrograms(Ve,oi,ct,Or,et,wn,Ci),si=new WebGLMaterials(Ve,Br),Ai=new WebGLRenderLists,Oi=new WebGLRenderStates(Or),ki=new WebGLBackground(Ve,oi,ct,at,Dr,ue,te),Wi=new WebGLShadowMap(Ve,Dr,et),An=new WebGLUniformsGroups(rt,Rr,et,at),mn=new WebGLBufferRenderer(rt,Or,Rr),cn=new WebGLIndexedBufferRenderer(rt,Or,Rr),Rr.programs=ti.programs,Ve.capabilities=et,Ve.extensions=Or,Ve.properties=Br,Ve.renderLists=Ai,Ve.shadowMap=Wi,Ve.state=at,Ve.info=Rr}Hr();const vi=new WebXRManager(Ve,rt);this.xr=vi,this.getContext=function(){return rt},this.getContextAttributes=function(){return rt.getContextAttributes()},this.forceContextLoss=function(){const wt=Or.get("WEBGL_lose_context");wt&&wt.loseContext()},this.forceContextRestore=function(){const wt=Or.get("WEBGL_lose_context");wt&&wt.restoreContext()},this.getPixelRatio=function(){return lt},this.setPixelRatio=function(wt){wt!==void 0&&(lt=wt,this.setSize(pt,ut,!1))},this.getSize=function(wt){return wt.set(pt,ut)},this.setSize=function(wt,ii,yi=!0){if(vi.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}pt=wt,ut=ii,T.width=Math.floor(wt*lt),T.height=Math.floor(ii*lt),yi===!0&&(T.style.width=wt+"px",T.style.height=ii+"px"),this.setViewport(0,0,wt,ii)},this.getDrawingBufferSize=function(wt){return wt.set(pt*lt,ut*lt).floor()},this.setDrawingBufferSize=function(wt,ii,yi){pt=wt,ut=ii,lt=yi,T.width=Math.floor(wt*yi),T.height=Math.floor(ii*yi),this.setViewport(0,0,wt,ii)},this.getCurrentViewport=function(wt){return wt.copy(Le)},this.getViewport=function(wt){return wt.copy(mt)},this.setViewport=function(wt,ii,yi,hi){wt.isVector4?mt.set(wt.x,wt.y,wt.z,wt.w):mt.set(wt,ii,yi,hi),at.viewport(Le.copy(mt).multiplyScalar(lt).round())},this.getScissor=function(wt){return wt.copy(Tr)},this.setScissor=function(wt,ii,yi,hi){wt.isVector4?Tr.set(wt.x,wt.y,wt.z,wt.w):Tr.set(wt,ii,yi,hi),at.scissor(qe.copy(Tr).multiplyScalar(lt).round())},this.getScissorTest=function(){return di},this.setScissorTest=function(wt){at.setScissorTest(di=wt)},this.setOpaqueSort=function(wt){st=wt},this.setTransparentSort=function(wt){sr=wt},this.getClearColor=function(wt){return wt.copy(ki.getClearColor())},this.setClearColor=function(){ki.setClearColor.apply(ki,arguments)},this.getClearAlpha=function(){return ki.getClearAlpha()},this.setClearAlpha=function(){ki.setClearAlpha.apply(ki,arguments)},this.clear=function(wt=!0,ii=!0,yi=!0){let hi=0;if(wt){let ui=!1;if(je!==null){const zi=je.texture.format;ui=zi===RGBAIntegerFormat||zi===RGIntegerFormat||zi===RedIntegerFormat}if(ui){const zi=je.texture.type,nn=zi===UnsignedByteType||zi===UnsignedIntType||zi===UnsignedShortType||zi===UnsignedInt248Type||zi===UnsignedShort4444Type||zi===UnsignedShort5551Type,un=ki.getClearColor(),bn=ki.getClearAlpha(),Tn=un.r,Pn=un.g,Rn=un.b;nn?(ge[0]=Tn,ge[1]=Pn,ge[2]=Rn,ge[3]=bn,rt.clearBufferuiv(rt.COLOR,0,ge)):(ye[0]=Tn,ye[1]=Pn,ye[2]=Rn,ye[3]=bn,rt.clearBufferiv(rt.COLOR,0,ye))}else hi|=rt.COLOR_BUFFER_BIT}ii&&(hi|=rt.DEPTH_BUFFER_BIT),yi&&(hi|=rt.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),rt.clear(hi)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){T.removeEventListener("webglcontextlost",Lr,!1),T.removeEventListener("webglcontextrestored",_i,!1),T.removeEventListener("webglcontextcreationerror",xi,!1),Ai.dispose(),Oi.dispose(),Br.dispose(),oi.dispose(),ct.dispose(),Dr.dispose(),wn.dispose(),An.dispose(),ti.dispose(),vi.dispose(),vi.removeEventListener("sessionstart",Bn),vi.removeEventListener("sessionend",ps),ns.stop()};function Lr(wt){wt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),$e=!0}function _i(){console.log("THREE.WebGLRenderer: Context Restored."),$e=!1;const wt=Rr.autoReset,ii=Wi.enabled,yi=Wi.autoUpdate,hi=Wi.needsUpdate,ui=Wi.type;Hr(),Rr.autoReset=wt,Wi.enabled=ii,Wi.autoUpdate=yi,Wi.needsUpdate=hi,Wi.type=ui}function xi(wt){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",wt.statusMessage)}function Ni(wt){const ii=wt.target;ii.removeEventListener("dispose",Ni),Ui(ii)}function Ui(wt){Vn(wt),Br.remove(wt)}function Vn(wt){const ii=Br.get(wt).programs;ii!==void 0&&(ii.forEach(function(yi){ti.releaseProgram(yi)}),wt.isShaderMaterial&&ti.releaseShaderCache(wt))}this.renderBufferDirect=function(wt,ii,yi,hi,ui,zi){ii===null&&(ii=ri);const nn=ui.isMesh&&ui.matrixWorld.determinant()<0,un=Su(wt,ii,yi,hi,ui);at.setMaterial(hi,nn);let bn=yi.index,Tn=1;if(hi.wireframe===!0){if(bn=Ir.getWireframeAttribute(yi),bn===void 0)return;Tn=2}const Pn=yi.drawRange,Rn=yi.attributes.position;let In=Pn.start*Tn,Qn=(Pn.start+Pn.count)*Tn;zi!==null&&(In=Math.max(In,zi.start*Tn),Qn=Math.min(Qn,(zi.start+zi.count)*Tn)),bn!==null?(In=Math.max(In,0),Qn=Math.min(Qn,bn.count)):Rn!=null&&(In=Math.max(In,0),Qn=Math.min(Qn,Rn.count));const Cs=Qn-In;if(Cs<0||Cs===1/0)return;wn.setup(ui,hi,un,yi,bn);let Zs,jn=mn;if(bn!==null&&(Zs=nt.get(bn),jn=cn,jn.setIndex(Zs)),ui.isMesh)hi.wireframe===!0?(at.setLineWidth(hi.wireframeLinewidth*ot()),jn.setMode(rt.LINES)):jn.setMode(rt.TRIANGLES);else if(ui.isLine){let Mn=hi.linewidth;Mn===void 0&&(Mn=1),at.setLineWidth(Mn*ot()),ui.isLineSegments?jn.setMode(rt.LINES):ui.isLineLoop?jn.setMode(rt.LINE_LOOP):jn.setMode(rt.LINE_STRIP)}else ui.isPoints?jn.setMode(rt.POINTS):ui.isSprite&&jn.setMode(rt.TRIANGLES);if(ui.isBatchedMesh)ui._multiDrawInstances!==null?jn.renderMultiDrawInstances(ui._multiDrawStarts,ui._multiDrawCounts,ui._multiDrawCount,ui._multiDrawInstances):jn.renderMultiDraw(ui._multiDrawStarts,ui._multiDrawCounts,ui._multiDrawCount);else if(ui.isInstancedMesh)jn.renderInstances(In,Cs,ui.count);else if(yi.isInstancedBufferGeometry){const Mn=yi._maxInstanceCount!==void 0?yi._maxInstanceCount:1/0,ia=Math.min(yi.instanceCount,Mn);jn.renderInstances(In,Cs,ia)}else jn.render(In,Cs)};function Dn(wt,ii,yi){wt.transparent===!0&&wt.side===DoubleSide&&wt.forceSinglePass===!1?(wt.side=BackSide,wt.needsUpdate=!0,Xn(wt,ii,yi),wt.side=FrontSide,wt.needsUpdate=!0,Xn(wt,ii,yi),wt.side=DoubleSide):Xn(wt,ii,yi)}this.compile=function(wt,ii,yi=null){yi===null&&(yi=wt),Te=Oi.get(yi),Te.init(ii),Ie.push(Te),yi.traverseVisible(function(ui){ui.isLight&&ui.layers.test(ii.layers)&&(Te.pushLight(ui),ui.castShadow&&Te.pushShadow(ui))}),wt!==yi&&wt.traverseVisible(function(ui){ui.isLight&&ui.layers.test(ii.layers)&&(Te.pushLight(ui),ui.castShadow&&Te.pushShadow(ui))}),Te.setupLights(Ve._useLegacyLights);const hi=new Set;return wt.traverse(function(ui){const zi=ui.material;if(zi)if(Array.isArray(zi))for(let nn=0;nn<zi.length;nn++){const un=zi[nn];Dn(un,yi,ui),hi.add(un)}else Dn(zi,yi,ui),hi.add(zi)}),Ie.pop(),Te=null,hi},this.compileAsync=function(wt,ii,yi=null){const hi=this.compile(wt,ii,yi);return new Promise(ui=>{function zi(){if(hi.forEach(function(nn){Br.get(nn).currentProgram.isReady()&&hi.delete(nn)}),hi.size===0){ui(wt);return}setTimeout(zi,10)}Or.get("KHR_parallel_shader_compile")!==null?zi():setTimeout(zi,10)})};let Wn=null;function es(wt){Wn&&Wn(wt)}function Bn(){ns.stop()}function ps(){ns.start()}const ns=new WebGLAnimation;ns.setAnimationLoop(es),typeof self<"u"&&ns.setContext(self),this.setAnimationLoop=function(wt){Wn=wt,vi.setAnimationLoop(wt),wt===null?ns.stop():ns.start()},vi.addEventListener("sessionstart",Bn),vi.addEventListener("sessionend",ps),this.render=function(wt,ii){if(ii!==void 0&&ii.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if($e===!0)return;wt.matrixWorldAutoUpdate===!0&&wt.updateMatrixWorld(),ii.parent===null&&ii.matrixWorldAutoUpdate===!0&&ii.updateMatrixWorld(),vi.enabled===!0&&vi.isPresenting===!0&&(vi.cameraAutoUpdate===!0&&vi.updateCamera(ii),ii=vi.getCamera()),wt.isScene===!0&&wt.onBeforeRender(Ve,wt,ii,je),Te=Oi.get(wt,Ie.length),Te.init(ii),Ie.push(Te),gi.multiplyMatrices(ii.projectionMatrix,ii.matrixWorldInverse),Mi.setFromProjectionMatrix(gi),ci=this.localClippingEnabled,Gr=Ci.init(this.clippingPlanes,ci),xe=Ai.get(wt,Ae.length),xe.init(),Ae.push(xe),Ja(wt,ii,0,Ve.sortObjects),xe.finish(),Ve.sortObjects===!0&&xe.sort(st,sr);const yi=vi.enabled===!1||vi.isPresenting===!1||vi.hasDepthSensing()===!1;yi&&ki.addToRenderList(xe,wt),this.info.render.frame++,Gr===!0&&Ci.beginShadows();const hi=Te.state.shadowsArray;Wi.render(hi,wt,ii),Gr===!0&&Ci.endShadows(),this.info.autoReset===!0&&this.info.reset();const ui=xe.opaque,zi=xe.transmissive;if(Te.setupLights(Ve._useLegacyLights),ii.isArrayCamera){const nn=ii.cameras;if(zi.length>0)for(let un=0,bn=nn.length;un<bn;un++){const Tn=nn[un];Xl(ui,zi,wt,Tn)}yi&&ki.render(wt);for(let un=0,bn=nn.length;un<bn;un++){const Tn=nn[un];us(xe,wt,Tn,Tn.viewport)}}else zi.length>0&&Xl(ui,zi,wt,ii),yi&&ki.render(wt),us(xe,wt,ii);je!==null&&(Kr.updateMultisampleRenderTarget(je),Kr.updateRenderTargetMipmap(je)),wt.isScene===!0&&wt.onAfterRender(Ve,wt,ii),wn.resetDefaultState(),ze=-1,He=null,Ie.pop(),Ie.length>0?(Te=Ie[Ie.length-1],Gr===!0&&Ci.setGlobalState(Ve.clippingPlanes,Te.state.camera)):Te=null,Ae.pop(),Ae.length>0?xe=Ae[Ae.length-1]:xe=null};function Ja(wt,ii,yi,hi){if(wt.visible===!1)return;if(wt.layers.test(ii.layers)){if(wt.isGroup)yi=wt.renderOrder;else if(wt.isLOD)wt.autoUpdate===!0&&wt.update(ii);else if(wt.isLight)Te.pushLight(wt),wt.castShadow&&Te.pushShadow(wt);else if(wt.isSprite){if(!wt.frustumCulled||Mi.intersectsSprite(wt)){hi&&fi.setFromMatrixPosition(wt.matrixWorld).applyMatrix4(gi);const nn=Dr.update(wt),un=wt.material;un.visible&&xe.push(wt,nn,un,yi,fi.z,null)}}else if((wt.isMesh||wt.isLine||wt.isPoints)&&(!wt.frustumCulled||Mi.intersectsObject(wt))){const nn=Dr.update(wt),un=wt.material;if(hi&&(wt.boundingSphere!==void 0?(wt.boundingSphere===null&&wt.computeBoundingSphere(),fi.copy(wt.boundingSphere.center)):(nn.boundingSphere===null&&nn.computeBoundingSphere(),fi.copy(nn.boundingSphere.center)),fi.applyMatrix4(wt.matrixWorld).applyMatrix4(gi)),Array.isArray(un)){const bn=nn.groups;for(let Tn=0,Pn=bn.length;Tn<Pn;Tn++){const Rn=bn[Tn],In=un[Rn.materialIndex];In&&In.visible&&xe.push(wt,nn,In,yi,fi.z,Rn)}}else un.visible&&xe.push(wt,nn,un,yi,fi.z,null)}}const zi=wt.children;for(let nn=0,un=zi.length;nn<un;nn++)Ja(zi[nn],ii,yi,hi)}function us(wt,ii,yi,hi){const ui=wt.opaque,zi=wt.transmissive,nn=wt.transparent;Te.setupLightsView(yi),Gr===!0&&Ci.setGlobalState(Ve.clippingPlanes,yi),hi&&at.viewport(Le.copy(hi)),ui.length>0&&ra(ui,ii,yi),zi.length>0&&ra(zi,ii,yi),nn.length>0&&ra(nn,ii,yi),at.buffers.depth.setTest(!0),at.buffers.depth.setMask(!0),at.buffers.color.setMask(!0),at.setPolygonOffset(!1)}function Xl(wt,ii,yi,hi){if((yi.isScene===!0?yi.overrideMaterial:null)!==null)return;Te.state.transmissionRenderTarget[hi.id]===void 0&&(Te.state.transmissionRenderTarget[hi.id]=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:Or.has("EXT_color_buffer_half_float")||Or.has("EXT_color_buffer_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:4,stencilBuffer:X,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const zi=Te.state.transmissionRenderTarget[hi.id],nn=hi.viewport||Le;zi.setSize(nn.z,nn.w);const un=Ve.getRenderTarget();Ve.setRenderTarget(zi),Ve.getClearColor(Ke),Je=Ve.getClearAlpha(),Je<1&&Ve.setClearColor(16777215,.5),Ve.clear();const bn=Ve.toneMapping;Ve.toneMapping=NoToneMapping;const Tn=hi.viewport;if(hi.viewport!==void 0&&(hi.viewport=void 0),Te.setupLightsView(hi),Gr===!0&&Ci.setGlobalState(Ve.clippingPlanes,hi),ra(wt,yi,hi),Kr.updateMultisampleRenderTarget(zi),Kr.updateRenderTargetMipmap(zi),Or.has("WEBGL_multisampled_render_to_texture")===!1){let Pn=!1;for(let Rn=0,In=ii.length;Rn<In;Rn++){const Qn=ii[Rn],Cs=Qn.object,Zs=Qn.geometry,jn=Qn.material,Mn=Qn.group;if(jn.side===DoubleSide&&Cs.layers.test(hi.layers)){const ia=jn.side;jn.side=BackSide,jn.needsUpdate=!0,Do(Cs,yi,hi,Zs,jn,Mn),jn.side=ia,jn.needsUpdate=!0,Pn=!0}}Pn===!0&&(Kr.updateMultisampleRenderTarget(zi),Kr.updateRenderTargetMipmap(zi))}Ve.setRenderTarget(un),Ve.setClearColor(Ke,Je),Tn!==void 0&&(hi.viewport=Tn),Ve.toneMapping=bn}function ra(wt,ii,yi){const hi=ii.isScene===!0?ii.overrideMaterial:null;for(let ui=0,zi=wt.length;ui<zi;ui++){const nn=wt[ui],un=nn.object,bn=nn.geometry,Tn=hi===null?nn.material:hi,Pn=nn.group;un.layers.test(yi.layers)&&Do(un,ii,yi,bn,Tn,Pn)}}function Do(wt,ii,yi,hi,ui,zi){wt.onBeforeRender(Ve,ii,yi,hi,ui,zi),wt.modelViewMatrix.multiplyMatrices(yi.matrixWorldInverse,wt.matrixWorld),wt.normalMatrix.getNormalMatrix(wt.modelViewMatrix),ui.onBeforeRender(Ve,ii,yi,hi,wt,zi),ui.transparent===!0&&ui.side===DoubleSide&&ui.forceSinglePass===!1?(ui.side=BackSide,ui.needsUpdate=!0,Ve.renderBufferDirect(yi,ii,hi,ui,wt,zi),ui.side=FrontSide,ui.needsUpdate=!0,Ve.renderBufferDirect(yi,ii,hi,ui,wt,zi),ui.side=DoubleSide):Ve.renderBufferDirect(yi,ii,hi,ui,wt,zi),wt.onAfterRender(Ve,ii,yi,hi,ui,zi)}function Xn(wt,ii,yi){ii.isScene!==!0&&(ii=ri);const hi=Br.get(wt),ui=Te.state.lights,zi=Te.state.shadowsArray,nn=ui.state.version,un=ti.getParameters(wt,ui.state,zi,ii,yi),bn=ti.getProgramCacheKey(un);let Tn=hi.programs;hi.environment=wt.isMeshStandardMaterial?ii.environment:null,hi.fog=ii.fog,hi.envMap=(wt.isMeshStandardMaterial?ct:oi).get(wt.envMap||hi.environment),hi.envMapRotation=hi.environment!==null&&wt.envMap===null?ii.environmentRotation:wt.envMapRotation,Tn===void 0&&(wt.addEventListener("dispose",Ni),Tn=new Map,hi.programs=Tn);let Pn=Tn.get(bn);if(Pn!==void 0){if(hi.currentProgram===Pn&&hi.lightsStateVersion===nn)return No(wt,un),Pn}else un.uniforms=ti.getUniforms(wt),wt.onBuild(yi,un,Ve),wt.onBeforeCompile(un,Ve),Pn=ti.acquireProgram(un,bn),Tn.set(bn,Pn),hi.uniforms=un.uniforms;const Rn=hi.uniforms;return(!wt.isShaderMaterial&&!wt.isRawShaderMaterial||wt.clipping===!0)&&(Rn.clippingPlanes=Ci.uniform),No(wt,un),hi.needsLights=Ou(wt),hi.lightsStateVersion=nn,hi.needsLights&&(Rn.ambientLightColor.value=ui.state.ambient,Rn.lightProbe.value=ui.state.probe,Rn.directionalLights.value=ui.state.directional,Rn.directionalLightShadows.value=ui.state.directionalShadow,Rn.spotLights.value=ui.state.spot,Rn.spotLightShadows.value=ui.state.spotShadow,Rn.rectAreaLights.value=ui.state.rectArea,Rn.ltc_1.value=ui.state.rectAreaLTC1,Rn.ltc_2.value=ui.state.rectAreaLTC2,Rn.pointLights.value=ui.state.point,Rn.pointLightShadows.value=ui.state.pointShadow,Rn.hemisphereLights.value=ui.state.hemi,Rn.directionalShadowMap.value=ui.state.directionalShadowMap,Rn.directionalShadowMatrix.value=ui.state.directionalShadowMatrix,Rn.spotShadowMap.value=ui.state.spotShadowMap,Rn.spotLightMatrix.value=ui.state.spotLightMatrix,Rn.spotLightMap.value=ui.state.spotLightMap,Rn.pointShadowMap.value=ui.state.pointShadowMap,Rn.pointShadowMatrix.value=ui.state.pointShadowMatrix),hi.currentProgram=Pn,hi.uniformsList=null,Pn}function io(wt){if(wt.uniformsList===null){const ii=wt.currentProgram.getUniforms();wt.uniformsList=WebGLUniforms.seqWithValue(ii.seq,wt.uniforms)}return wt.uniformsList}function No(wt,ii){const yi=Br.get(wt);yi.outputColorSpace=ii.outputColorSpace,yi.batching=ii.batching,yi.instancing=ii.instancing,yi.instancingColor=ii.instancingColor,yi.instancingMorph=ii.instancingMorph,yi.skinning=ii.skinning,yi.morphTargets=ii.morphTargets,yi.morphNormals=ii.morphNormals,yi.morphColors=ii.morphColors,yi.morphTargetsCount=ii.morphTargetsCount,yi.numClippingPlanes=ii.numClippingPlanes,yi.numIntersection=ii.numClipIntersection,yi.vertexAlphas=ii.vertexAlphas,yi.vertexTangents=ii.vertexTangents,yi.toneMapping=ii.toneMapping}function Su(wt,ii,yi,hi,ui){ii.isScene!==!0&&(ii=ri),Kr.resetTextureUnits();const zi=ii.fog,nn=hi.isMeshStandardMaterial?ii.environment:null,un=je===null?Ve.outputColorSpace:je.isXRRenderTarget===!0?je.texture.colorSpace:LinearSRGBColorSpace,bn=(hi.isMeshStandardMaterial?ct:oi).get(hi.envMap||nn),Tn=hi.vertexColors===!0&&!!yi.attributes.color&&yi.attributes.color.itemSize===4,Pn=!!yi.attributes.tangent&&(!!hi.normalMap||hi.anisotropy>0),Rn=!!yi.morphAttributes.position,In=!!yi.morphAttributes.normal,Qn=!!yi.morphAttributes.color;let Cs=NoToneMapping;hi.toneMapped&&(je===null||je.isXRRenderTarget===!0)&&(Cs=Ve.toneMapping);const Zs=yi.morphAttributes.position||yi.morphAttributes.normal||yi.morphAttributes.color,jn=Zs!==void 0?Zs.length:0,Mn=Br.get(hi),ia=Te.state.lights;if(Gr===!0&&(ci===!0||wt!==He)){const xs=wt===He&&hi.id===ze;Ci.setState(hi,wt,xs)}let Kn=!1;hi.version===Mn.__version?(Mn.needsLights&&Mn.lightsStateVersion!==ia.state.version||Mn.outputColorSpace!==un||ui.isBatchedMesh&&Mn.batching===!1||!ui.isBatchedMesh&&Mn.batching===!0||ui.isInstancedMesh&&Mn.instancing===!1||!ui.isInstancedMesh&&Mn.instancing===!0||ui.isSkinnedMesh&&Mn.skinning===!1||!ui.isSkinnedMesh&&Mn.skinning===!0||ui.isInstancedMesh&&Mn.instancingColor===!0&&ui.instanceColor===null||ui.isInstancedMesh&&Mn.instancingColor===!1&&ui.instanceColor!==null||ui.isInstancedMesh&&Mn.instancingMorph===!0&&ui.morphTexture===null||ui.isInstancedMesh&&Mn.instancingMorph===!1&&ui.morphTexture!==null||Mn.envMap!==bn||hi.fog===!0&&Mn.fog!==zi||Mn.numClippingPlanes!==void 0&&(Mn.numClippingPlanes!==Ci.numPlanes||Mn.numIntersection!==Ci.numIntersection)||Mn.vertexAlphas!==Tn||Mn.vertexTangents!==Pn||Mn.morphTargets!==Rn||Mn.morphNormals!==In||Mn.morphColors!==Qn||Mn.toneMapping!==Cs||Mn.morphTargetsCount!==jn)&&(Kn=!0):(Kn=!0,Mn.__version=hi.version);let Es=Mn.currentProgram;Kn===!0&&(Es=Xn(hi,ii,ui));let na=!1,sa=!1,el=!1;const ss=Es.getUniforms(),yo=Mn.uniforms;if(at.useProgram(Es.program)&&(na=!0,sa=!0,el=!0),hi.id!==ze&&(ze=hi.id,sa=!0),na||He!==wt){ss.setValue(rt,"projectionMatrix",wt.projectionMatrix),ss.setValue(rt,"viewMatrix",wt.matrixWorldInverse);const xs=ss.map.cameraPosition;xs!==void 0&&xs.setValue(rt,fi.setFromMatrixPosition(wt.matrixWorld)),et.logarithmicDepthBuffer&&ss.setValue(rt,"logDepthBufFC",2/(Math.log(wt.far+1)/Math.LN2)),(hi.isMeshPhongMaterial||hi.isMeshToonMaterial||hi.isMeshLambertMaterial||hi.isMeshBasicMaterial||hi.isMeshStandardMaterial||hi.isShaderMaterial)&&ss.setValue(rt,"isOrthographic",wt.isOrthographicCamera===!0),He!==wt&&(He=wt,sa=!0,el=!0)}if(ui.isSkinnedMesh){ss.setOptional(rt,ui,"bindMatrix"),ss.setOptional(rt,ui,"bindMatrixInverse");const xs=ui.skeleton;xs&&(xs.boneTexture===null&&xs.computeBoneTexture(),ss.setValue(rt,"boneTexture",xs.boneTexture,Kr))}ui.isBatchedMesh&&(ss.setOptional(rt,ui,"batchingTexture"),ss.setValue(rt,"batchingTexture",ui._matricesTexture,Kr));const tl=yi.morphAttributes;if((tl.position!==void 0||tl.normal!==void 0||tl.color!==void 0)&&Li.update(ui,yi,Es),(sa||Mn.receiveShadow!==ui.receiveShadow)&&(Mn.receiveShadow=ui.receiveShadow,ss.setValue(rt,"receiveShadow",ui.receiveShadow)),hi.isMeshGouraudMaterial&&hi.envMap!==null&&(yo.envMap.value=bn,yo.flipEnvMap.value=bn.isCubeTexture&&bn.isRenderTargetTexture===!1?-1:1),hi.isMeshStandardMaterial&&hi.envMap===null&&ii.environment!==null&&(yo.envMapIntensity.value=ii.environmentIntensity),sa&&(ss.setValue(rt,"toneMappingExposure",Ve.toneMappingExposure),Mn.needsLights&&wu(yo,el),zi&&hi.fog===!0&&si.refreshFogUniforms(yo,zi),si.refreshMaterialUniforms(yo,hi,lt,ut,Te.state.transmissionRenderTarget[wt.id]),WebGLUniforms.upload(rt,io(Mn),yo,Kr)),hi.isShaderMaterial&&hi.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(rt,io(Mn),yo,Kr),hi.uniformsNeedUpdate=!1),hi.isSpriteMaterial&&ss.setValue(rt,"center",ui.center),ss.setValue(rt,"modelViewMatrix",ui.modelViewMatrix),ss.setValue(rt,"normalMatrix",ui.normalMatrix),ss.setValue(rt,"modelMatrix",ui.matrixWorld),hi.isShaderMaterial||hi.isRawShaderMaterial){const xs=hi.uniformsGroups;for(let Vs=0,Cu=xs.length;Vs<Cu;Vs++){const ql=xs[Vs];An.update(ql,Es),An.bind(ql,Es)}}return Es}function wu(wt,ii){wt.ambientLightColor.needsUpdate=ii,wt.lightProbe.needsUpdate=ii,wt.directionalLights.needsUpdate=ii,wt.directionalLightShadows.needsUpdate=ii,wt.pointLights.needsUpdate=ii,wt.pointLightShadows.needsUpdate=ii,wt.spotLights.needsUpdate=ii,wt.spotLightShadows.needsUpdate=ii,wt.rectAreaLights.needsUpdate=ii,wt.hemisphereLights.needsUpdate=ii}function Ou(wt){return wt.isMeshLambertMaterial||wt.isMeshToonMaterial||wt.isMeshPhongMaterial||wt.isMeshStandardMaterial||wt.isShadowMaterial||wt.isShaderMaterial&&wt.lights===!0}this.getActiveCubeFace=function(){return We},this.getActiveMipmapLevel=function(){return Ue},this.getRenderTarget=function(){return je},this.setRenderTargetTextures=function(wt,ii,yi){Br.get(wt.texture).__webglTexture=ii,Br.get(wt.depthTexture).__webglTexture=yi;const hi=Br.get(wt);hi.__hasExternalTextures=!0,hi.__autoAllocateDepthBuffer=yi===void 0,hi.__autoAllocateDepthBuffer||Or.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),hi.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(wt,ii){const yi=Br.get(wt);yi.__webglFramebuffer=ii,yi.__useDefaultFramebuffer=ii===void 0},this.setRenderTarget=function(wt,ii=0,yi=0){je=wt,We=ii,Ue=yi;let hi=!0,ui=null,zi=!1,nn=!1;if(wt){const bn=Br.get(wt);bn.__useDefaultFramebuffer!==void 0?(at.bindFramebuffer(rt.FRAMEBUFFER,null),hi=!1):bn.__webglFramebuffer===void 0?Kr.setupRenderTarget(wt):bn.__hasExternalTextures&&Kr.rebindTextures(wt,Br.get(wt.texture).__webglTexture,Br.get(wt.depthTexture).__webglTexture);const Tn=wt.texture;(Tn.isData3DTexture||Tn.isDataArrayTexture||Tn.isCompressedArrayTexture)&&(nn=!0);const Pn=Br.get(wt).__webglFramebuffer;wt.isWebGLCubeRenderTarget?(Array.isArray(Pn[ii])?ui=Pn[ii][yi]:ui=Pn[ii],zi=!0):wt.samples>0&&Kr.useMultisampledRTT(wt)===!1?ui=Br.get(wt).__webglMultisampledFramebuffer:Array.isArray(Pn)?ui=Pn[yi]:ui=Pn,Le.copy(wt.viewport),qe.copy(wt.scissor),Qe=wt.scissorTest}else Le.copy(mt).multiplyScalar(lt).floor(),qe.copy(Tr).multiplyScalar(lt).floor(),Qe=di;if(at.bindFramebuffer(rt.FRAMEBUFFER,ui)&&hi&&at.drawBuffers(wt,ui),at.viewport(Le),at.scissor(qe),at.setScissorTest(Qe),zi){const bn=Br.get(wt.texture);rt.framebufferTexture2D(rt.FRAMEBUFFER,rt.COLOR_ATTACHMENT0,rt.TEXTURE_CUBE_MAP_POSITIVE_X+ii,bn.__webglTexture,yi)}else if(nn){const bn=Br.get(wt.texture),Tn=ii||0;rt.framebufferTextureLayer(rt.FRAMEBUFFER,rt.COLOR_ATTACHMENT0,bn.__webglTexture,yi||0,Tn)}ze=-1},this.readRenderTargetPixels=function(wt,ii,yi,hi,ui,zi,nn){if(!(wt&&wt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let un=Br.get(wt).__webglFramebuffer;if(wt.isWebGLCubeRenderTarget&&nn!==void 0&&(un=un[nn]),un){at.bindFramebuffer(rt.FRAMEBUFFER,un);try{const bn=wt.texture,Tn=bn.format,Pn=bn.type;if(!et.textureFormatReadable(Tn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!et.textureTypeReadable(Pn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ii>=0&&ii<=wt.width-hi&&yi>=0&&yi<=wt.height-ui&&rt.readPixels(ii,yi,hi,ui,qi.convert(Tn),qi.convert(Pn),zi)}finally{const bn=je!==null?Br.get(je).__webglFramebuffer:null;at.bindFramebuffer(rt.FRAMEBUFFER,bn)}}},this.copyFramebufferToTexture=function(wt,ii,yi=0){const hi=Math.pow(2,-yi),ui=Math.floor(ii.image.width*hi),zi=Math.floor(ii.image.height*hi);Kr.setTexture2D(ii,0),rt.copyTexSubImage2D(rt.TEXTURE_2D,yi,0,0,wt.x,wt.y,ui,zi),at.unbindTexture()},this.copyTextureToTexture=function(wt,ii,yi,hi=0){const ui=ii.image.width,zi=ii.image.height,nn=qi.convert(yi.format),un=qi.convert(yi.type);Kr.setTexture2D(yi,0),rt.pixelStorei(rt.UNPACK_FLIP_Y_WEBGL,yi.flipY),rt.pixelStorei(rt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,yi.premultiplyAlpha),rt.pixelStorei(rt.UNPACK_ALIGNMENT,yi.unpackAlignment),ii.isDataTexture?rt.texSubImage2D(rt.TEXTURE_2D,hi,wt.x,wt.y,ui,zi,nn,un,ii.image.data):ii.isCompressedTexture?rt.compressedTexSubImage2D(rt.TEXTURE_2D,hi,wt.x,wt.y,ii.mipmaps[0].width,ii.mipmaps[0].height,nn,ii.mipmaps[0].data):rt.texSubImage2D(rt.TEXTURE_2D,hi,wt.x,wt.y,nn,un,ii.image),hi===0&&yi.generateMipmaps&&rt.generateMipmap(rt.TEXTURE_2D),at.unbindTexture()},this.copyTextureToTexture3D=function(wt,ii,yi,hi,ui=0){const zi=wt.max.x-wt.min.x,nn=wt.max.y-wt.min.y,un=wt.max.z-wt.min.z,bn=qi.convert(hi.format),Tn=qi.convert(hi.type);let Pn;if(hi.isData3DTexture)Kr.setTexture3D(hi,0),Pn=rt.TEXTURE_3D;else if(hi.isDataArrayTexture||hi.isCompressedArrayTexture)Kr.setTexture2DArray(hi,0),Pn=rt.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}rt.pixelStorei(rt.UNPACK_FLIP_Y_WEBGL,hi.flipY),rt.pixelStorei(rt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,hi.premultiplyAlpha),rt.pixelStorei(rt.UNPACK_ALIGNMENT,hi.unpackAlignment);const Rn=rt.getParameter(rt.UNPACK_ROW_LENGTH),In=rt.getParameter(rt.UNPACK_IMAGE_HEIGHT),Qn=rt.getParameter(rt.UNPACK_SKIP_PIXELS),Cs=rt.getParameter(rt.UNPACK_SKIP_ROWS),Zs=rt.getParameter(rt.UNPACK_SKIP_IMAGES),jn=yi.isCompressedTexture?yi.mipmaps[ui]:yi.image;rt.pixelStorei(rt.UNPACK_ROW_LENGTH,jn.width),rt.pixelStorei(rt.UNPACK_IMAGE_HEIGHT,jn.height),rt.pixelStorei(rt.UNPACK_SKIP_PIXELS,wt.min.x),rt.pixelStorei(rt.UNPACK_SKIP_ROWS,wt.min.y),rt.pixelStorei(rt.UNPACK_SKIP_IMAGES,wt.min.z),yi.isDataTexture||yi.isData3DTexture?rt.texSubImage3D(Pn,ui,ii.x,ii.y,ii.z,zi,nn,un,bn,Tn,jn.data):hi.isCompressedArrayTexture?rt.compressedTexSubImage3D(Pn,ui,ii.x,ii.y,ii.z,zi,nn,un,bn,jn.data):rt.texSubImage3D(Pn,ui,ii.x,ii.y,ii.z,zi,nn,un,bn,Tn,jn),rt.pixelStorei(rt.UNPACK_ROW_LENGTH,Rn),rt.pixelStorei(rt.UNPACK_IMAGE_HEIGHT,In),rt.pixelStorei(rt.UNPACK_SKIP_PIXELS,Qn),rt.pixelStorei(rt.UNPACK_SKIP_ROWS,Cs),rt.pixelStorei(rt.UNPACK_SKIP_IMAGES,Zs),ui===0&&hi.generateMipmaps&&rt.generateMipmap(Pn),at.unbindTexture()},this.initTexture=function(wt){wt.isCubeTexture?Kr.setTextureCube(wt,0):wt.isData3DTexture?Kr.setTexture3D(wt,0):wt.isDataArrayTexture||wt.isCompressedArrayTexture?Kr.setTexture2DArray(wt,0):Kr.setTexture2D(wt,0),at.unbindTexture()},this.resetState=function(){We=0,Ue=0,je=null,at.reset(),wn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(_){this._outputColorSpace=_;const T=this.getContext();T.drawingBufferColorSpace=_===DisplayP3ColorSpace?"display-p3":"srgb",T.unpackColorSpace=ColorManagement.workingColorSpace===LinearDisplayP3ColorSpace?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(_){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=_}}class FogExp2{constructor(_,T=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color(_),this.density=T}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fog{constructor(_,T=1,E=1e3){this.isFog=!0,this.name="",this.color=new Color(_),this.near=T,this.far=E}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Euler,this.environmentIntensity=1,this.environmentRotation=new Euler,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_,T){return super.copy(_,T),_.background!==null&&(this.background=_.background.clone()),_.environment!==null&&(this.environment=_.environment.clone()),_.fog!==null&&(this.fog=_.fog.clone()),this.backgroundBlurriness=_.backgroundBlurriness,this.backgroundIntensity=_.backgroundIntensity,this.backgroundRotation.copy(_.backgroundRotation),this.environmentIntensity=_.environmentIntensity,this.environmentRotation.copy(_.environmentRotation),_.overrideMaterial!==null&&(this.overrideMaterial=_.overrideMaterial.clone()),this.matrixAutoUpdate=_.matrixAutoUpdate,this}toJSON(_){const T=super.toJSON(_);return this.fog!==null&&(T.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(T.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(T.object.backgroundIntensity=this.backgroundIntensity),T.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(T.object.environmentIntensity=this.environmentIntensity),T.object.environmentRotation=this.environmentRotation.toArray(),T}}class InterleavedBuffer{constructor(_,T){this.isInterleavedBuffer=!0,this.array=_,this.stride=T,this.count=_!==void 0?_.length/T:0,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=generateUUID()}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}get updateRange(){return warnOnce("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(_){return this.usage=_,this}addUpdateRange(_,T){this.updateRanges.push({start:_,count:T})}clearUpdateRanges(){this.updateRanges.length=0}copy(_){return this.array=new _.array.constructor(_.array),this.count=_.count,this.stride=_.stride,this.usage=_.usage,this}copyAt(_,T,E){_*=this.stride,E*=T.stride;for(let W=0,X=this.stride;W<X;W++)this.array[_+W]=T.array[E+W];return this}set(_,T=0){return this.array.set(_,T),this}clone(_){_.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const T=new this.array.constructor(_.arrayBuffers[this.array.buffer._uuid]),E=new this.constructor(T,this.stride);return E.setUsage(this.usage),E}onUpload(_){return this.onUploadCallback=_,this}toJSON(_){return _.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$6=new Vector3;class InterleavedBufferAttribute{constructor(_,T,E,W=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_,this.itemSize=T,this.offset=E,this.normalized=W}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_){this.data.needsUpdate=_}applyMatrix4(_){for(let T=0,E=this.data.count;T<E;T++)_vector$6.fromBufferAttribute(this,T),_vector$6.applyMatrix4(_),this.setXYZ(T,_vector$6.x,_vector$6.y,_vector$6.z);return this}applyNormalMatrix(_){for(let T=0,E=this.count;T<E;T++)_vector$6.fromBufferAttribute(this,T),_vector$6.applyNormalMatrix(_),this.setXYZ(T,_vector$6.x,_vector$6.y,_vector$6.z);return this}transformDirection(_){for(let T=0,E=this.count;T<E;T++)_vector$6.fromBufferAttribute(this,T),_vector$6.transformDirection(_),this.setXYZ(T,_vector$6.x,_vector$6.y,_vector$6.z);return this}getComponent(_,T){let E=this.array[_*this.data.stride+this.offset+T];return this.normalized&&(E=denormalize(E,this.array)),E}setComponent(_,T,E){return this.normalized&&(E=normalize(E,this.array)),this.data.array[_*this.data.stride+this.offset+T]=E,this}setX(_,T){return this.normalized&&(T=normalize(T,this.array)),this.data.array[_*this.data.stride+this.offset]=T,this}setY(_,T){return this.normalized&&(T=normalize(T,this.array)),this.data.array[_*this.data.stride+this.offset+1]=T,this}setZ(_,T){return this.normalized&&(T=normalize(T,this.array)),this.data.array[_*this.data.stride+this.offset+2]=T,this}setW(_,T){return this.normalized&&(T=normalize(T,this.array)),this.data.array[_*this.data.stride+this.offset+3]=T,this}getX(_){let T=this.data.array[_*this.data.stride+this.offset];return this.normalized&&(T=denormalize(T,this.array)),T}getY(_){let T=this.data.array[_*this.data.stride+this.offset+1];return this.normalized&&(T=denormalize(T,this.array)),T}getZ(_){let T=this.data.array[_*this.data.stride+this.offset+2];return this.normalized&&(T=denormalize(T,this.array)),T}getW(_){let T=this.data.array[_*this.data.stride+this.offset+3];return this.normalized&&(T=denormalize(T,this.array)),T}setXY(_,T,E){return _=_*this.data.stride+this.offset,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array)),this.data.array[_+0]=T,this.data.array[_+1]=E,this}setXYZ(_,T,E,W){return _=_*this.data.stride+this.offset,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array),W=normalize(W,this.array)),this.data.array[_+0]=T,this.data.array[_+1]=E,this.data.array[_+2]=W,this}setXYZW(_,T,E,W,X){return _=_*this.data.stride+this.offset,this.normalized&&(T=normalize(T,this.array),E=normalize(E,this.array),W=normalize(W,this.array),X=normalize(X,this.array)),this.data.array[_+0]=T,this.data.array[_+1]=E,this.data.array[_+2]=W,this.data.array[_+3]=X,this}clone(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const T=[];for(let E=0;E<this.count;E++){const W=E*this.data.stride+this.offset;for(let X=0;X<this.itemSize;X++)T.push(this.data.array[W+X])}return new BufferAttribute(new this.array.constructor(T),this.itemSize,this.normalized)}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.clone(_)),new InterleavedBufferAttribute(_.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const T=[];for(let E=0;E<this.count;E++){const W=E*this.data.stride+this.offset;for(let X=0;X<this.itemSize;X++)T.push(this.data.array[W+X])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:T,normalized:this.normalized}}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.toJSON(_)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.rotation=_.rotation,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;class Sprite extends Object3D{constructor(_=new SpriteMaterial){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const T=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),E=new InterleavedBuffer(T,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(E,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(E,2,3,!1))}this.geometry=_geometry,this.material=_,this.center=new Vector2(.5,.5)}raycast(_,T){_.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const E=this.material.rotation;let W,X;E!==0&&(X=Math.cos(E),W=Math.sin(E));const q=this.center;transformVertex(_vA.set(-.5,-.5,0),_mvPosition,q,_worldScale,W,X),transformVertex(_vB.set(.5,-.5,0),_mvPosition,q,_worldScale,W,X),transformVertex(_vC.set(.5,.5,0),_mvPosition,q,_worldScale,W,X),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let Y=_.ray.intersectTriangle(_vA,_vB,_vC,!1,_intersectPoint);if(Y===null&&(transformVertex(_vB.set(-.5,.5,0),_mvPosition,q,_worldScale,W,X),_uvB.set(0,1),Y=_.ray.intersectTriangle(_vA,_vC,_vB,!1,_intersectPoint),Y===null))return;const te=_.ray.origin.distanceTo(_intersectPoint);te<_.near||te>_.far||T.push({distance:te,point:_intersectPoint.clone(),uv:Triangle.getInterpolation(_intersectPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(_,T){return super.copy(_,T),_.center!==void 0&&this.center.copy(_.center),this.material=_.material,this}}function transformVertex(B,_,T,E,W,X){_alignedPosition.subVectors(B,T).addScalar(.5).multiply(E),W!==void 0?(_rotatedPosition.x=X*_alignedPosition.x-W*_alignedPosition.y,_rotatedPosition.y=W*_alignedPosition.x+X*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),B.copy(_),B.x+=_rotatedPosition.x,B.y+=_rotatedPosition.y,B.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_){super.copy(_,!1);const T=_.levels;for(let E=0,W=T.length;E<W;E++){const X=T[E];this.addLevel(X.object.clone(),X.distance,X.hysteresis)}return this.autoUpdate=_.autoUpdate,this}addLevel(_,T=0,E=0){T=Math.abs(T);const W=this.levels;let X;for(X=0;X<W.length&&!(T<W[X].distance);X++);return W.splice(X,0,{distance:T,hysteresis:E,object:_}),this.add(_),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_){const T=this.levels;if(T.length>0){let E,W;for(E=1,W=T.length;E<W;E++){let X=T[E].distance;if(T[E].object.visible&&(X-=X*T[E].hysteresis),_<X)break}return T[E-1].object}return null}raycast(_,T){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const W=_.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(W).raycast(_,T)}}update(_){const T=this.levels;if(T.length>1){_v1$2.setFromMatrixPosition(_.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const E=_v1$2.distanceTo(_v2$1)/_.zoom;T[0].object.visible=!0;let W,X;for(W=1,X=T.length;W<X;W++){let q=T[W].distance;if(T[W].object.visible&&(q-=q*T[W].hysteresis),E>=q)T[W-1].object.visible=!1,T[W].object.visible=!0;else break}for(this._currentLevel=W-1;W<X;W++)T[W].object.visible=!1}}toJSON(_){const T=super.toJSON(_);this.autoUpdate===!1&&(T.object.autoUpdate=!1),T.object.levels=[];const E=this.levels;for(let W=0,X=E.length;W<X;W++){const q=E[W];T.object.levels.push({object:q.object.uuid,distance:q.distance,hysteresis:q.hysteresis})}return T}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector3=new Vector3,_matrix4=new Matrix4,_vertex=new Vector3,_sphere$4=new Sphere,_inverseMatrix$2=new Matrix4,_ray$2=new Ray;class SkinnedMesh extends Mesh{constructor(_,T){super(_,T),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=AttachedBindMode,this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const _=this.geometry;this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.makeEmpty();const T=_.getAttribute("position");for(let E=0;E<T.count;E++)this.getVertexPosition(E,_vertex),this.boundingBox.expandByPoint(_vertex)}computeBoundingSphere(){const _=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sphere),this.boundingSphere.makeEmpty();const T=_.getAttribute("position");for(let E=0;E<T.count;E++)this.getVertexPosition(E,_vertex),this.boundingSphere.expandByPoint(_vertex)}copy(_,T){return super.copy(_,T),this.bindMode=_.bindMode,this.bindMatrix.copy(_.bindMatrix),this.bindMatrixInverse.copy(_.bindMatrixInverse),this.skeleton=_.skeleton,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}raycast(_,T){const E=this.material,W=this.matrixWorld;E!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$4.copy(this.boundingSphere),_sphere$4.applyMatrix4(W),_.ray.intersectsSphere(_sphere$4)!==!1&&(_inverseMatrix$2.copy(W).invert(),_ray$2.copy(_.ray).applyMatrix4(_inverseMatrix$2),!(this.boundingBox!==null&&_ray$2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(_,T,_ray$2)))}getVertexPosition(_,T){return super.getVertexPosition(_,T),this.applyBoneTransform(_,T),T}bind(_,T){this.skeleton=_,T===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),T=this.matrixWorld),this.bindMatrix.copy(T),this.bindMatrixInverse.copy(T).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _=new Vector4,T=this.geometry.attributes.skinWeight;for(let E=0,W=T.count;E<W;E++){_.fromBufferAttribute(T,E);const X=1/_.manhattanLength();X!==1/0?_.multiplyScalar(X):_.set(1,0,0,0),T.setXYZW(E,_.x,_.y,_.z,_.w)}}updateMatrixWorld(_){super.updateMatrixWorld(_),this.bindMode===AttachedBindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===DetachedBindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(_,T){const E=this.skeleton,W=this.geometry;_skinIndex.fromBufferAttribute(W.attributes.skinIndex,_),_skinWeight.fromBufferAttribute(W.attributes.skinWeight,_),_basePosition.copy(T).applyMatrix4(this.bindMatrix),T.set(0,0,0);for(let X=0;X<4;X++){const q=_skinWeight.getComponent(X);if(q!==0){const Y=_skinIndex.getComponent(X);_matrix4.multiplyMatrices(E.bones[Y].matrixWorld,E.boneInverses[Y]),T.addScaledVector(_vector3.copy(_basePosition).applyMatrix4(_matrix4),q)}}return T.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(_=null,T=1,E=1,W,X,q,Y,te,ne=NearestFilter,ae=NearestFilter,le,ue){super(null,q,Y,te,ne,ae,W,X,le,ue),this.isDataTexture=!0,this.image={data:_,width:T,height:E},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(_=[],T=[]){this.uuid=generateUUID(),this.bones=_.slice(0),this.boneInverses=T,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const _=this.bones,T=this.boneInverses;if(this.boneMatrices=new Float32Array(_.length*16),T.length===0)this.calculateInverses();else if(_.length!==T.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let E=0,W=this.bones.length;E<W;E++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _=0,T=this.bones.length;_<T;_++){const E=new Matrix4;this.bones[_]&&E.copy(this.bones[_].matrixWorld).invert(),this.boneInverses.push(E)}}pose(){for(let _=0,T=this.bones.length;_<T;_++){const E=this.bones[_];E&&E.matrixWorld.copy(this.boneInverses[_]).invert()}for(let _=0,T=this.bones.length;_<T;_++){const E=this.bones[_];E&&(E.parent&&E.parent.isBone?(E.matrix.copy(E.parent.matrixWorld).invert(),E.matrix.multiply(E.matrixWorld)):E.matrix.copy(E.matrixWorld),E.matrix.decompose(E.position,E.quaternion,E.scale))}}update(){const _=this.bones,T=this.boneInverses,E=this.boneMatrices,W=this.boneTexture;for(let X=0,q=_.length;X<q;X++){const Y=_[X]?_[X].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(Y,T[X]),_offsetMatrix.toArray(E,X*16)}W!==null&&(W.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _=Math.sqrt(this.bones.length*4);_=Math.ceil(_/4)*4,_=Math.max(_,4);const T=new Float32Array(_*_*4);T.set(this.boneMatrices);const E=new DataTexture(T,_,_,RGBAFormat,FloatType);return E.needsUpdate=!0,this.boneMatrices=T,this.boneTexture=E,this}getBoneByName(_){for(let T=0,E=this.bones.length;T<E;T++){const W=this.bones[T];if(W.name===_)return W}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_,T){this.uuid=_.uuid;for(let E=0,W=_.bones.length;E<W;E++){const X=_.bones[E];let q=T[X];q===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",X),q=new Bone),this.bones.push(q),this.boneInverses.push(new Matrix4().fromArray(_.boneInverses[E]))}return this.init(),this}toJSON(){const _={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_.uuid=this.uuid;const T=this.bones,E=this.boneInverses;for(let W=0,X=T.length;W<X;W++){const q=T[W];_.bones.push(q.uuid);const Y=E[W];_.boneInverses.push(Y.toArray())}return _}}class InstancedBufferAttribute extends BufferAttribute{constructor(_,T,E,W=1){super(_,T,E),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=W}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}toJSON(){const _=super.toJSON();return _.meshPerAttribute=this.meshPerAttribute,_.isInstancedBufferAttribute=!0,_}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_box3=new Box3,_identity=new Matrix4,_mesh$1=new Mesh,_sphere$3=new Sphere;class InstancedMesh extends Mesh{constructor(_,T,E){super(_,T),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(E*16),16),this.instanceColor=null,this.morphTexture=null,this.count=E,this.boundingBox=null,this.boundingSphere=null;for(let W=0;W<E;W++)this.setMatrixAt(W,_identity)}computeBoundingBox(){const _=this.geometry,T=this.count;this.boundingBox===null&&(this.boundingBox=new Box3),_.boundingBox===null&&_.computeBoundingBox(),this.boundingBox.makeEmpty();for(let E=0;E<T;E++)this.getMatrixAt(E,_instanceLocalMatrix),_box3.copy(_.boundingBox).applyMatrix4(_instanceLocalMatrix),this.boundingBox.union(_box3)}computeBoundingSphere(){const _=this.geometry,T=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sphere),_.boundingSphere===null&&_.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let E=0;E<T;E++)this.getMatrixAt(E,_instanceLocalMatrix),_sphere$3.copy(_.boundingSphere).applyMatrix4(_instanceLocalMatrix),this.boundingSphere.union(_sphere$3)}copy(_,T){return super.copy(_,T),this.instanceMatrix.copy(_.instanceMatrix),_.morphTexture!==null&&(this.morphTexture=_.morphTexture.clone()),_.instanceColor!==null&&(this.instanceColor=_.instanceColor.clone()),this.count=_.count,_.boundingBox!==null&&(this.boundingBox=_.boundingBox.clone()),_.boundingSphere!==null&&(this.boundingSphere=_.boundingSphere.clone()),this}getColorAt(_,T){T.fromArray(this.instanceColor.array,_*3)}getMatrixAt(_,T){T.fromArray(this.instanceMatrix.array,_*16)}getMorphAt(_,T){const E=T.morphTargetInfluences,W=this.morphTexture.source.data.data,X=E.length+1,q=_*X+1;for(let Y=0;Y<E.length;Y++)E[Y]=W[q+Y]}raycast(_,T){const E=this.matrixWorld,W=this.count;if(_mesh$1.geometry=this.geometry,_mesh$1.material=this.material,_mesh$1.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_sphere$3.copy(this.boundingSphere),_sphere$3.applyMatrix4(E),_.ray.intersectsSphere(_sphere$3)!==!1))for(let X=0;X<W;X++){this.getMatrixAt(X,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(E,_instanceLocalMatrix),_mesh$1.matrixWorld=_instanceWorldMatrix,_mesh$1.raycast(_,_instanceIntersects);for(let q=0,Y=_instanceIntersects.length;q<Y;q++){const te=_instanceIntersects[q];te.instanceId=X,te.object=this,T.push(te)}_instanceIntersects.length=0}}setColorAt(_,T){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3),3)),T.toArray(this.instanceColor.array,_*3)}setMatrixAt(_,T){T.toArray(this.instanceMatrix.array,_*16)}setMorphAt(_,T){const E=T.morphTargetInfluences,W=E.length+1;this.morphTexture===null&&(this.morphTexture=new DataTexture(new Float32Array(W*this.count),W,this.count,RedFormat,FloatType));const X=this.morphTexture.source.data.data;let q=0;for(let ne=0;ne<E.length;ne++)q+=E[ne];const Y=this.geometry.morphTargetsRelative?1:1-q,te=W*_;X[te]=Y,X.set(E,te+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function sortOpaque(B,_){return B.z-_.z}function sortTransparent(B,_){return _.z-B.z}class MultiDrawRenderList{constructor(){this.index=0,this.pool=[],this.list=[]}push(_,T){const E=this.pool,W=this.list;this.index>=E.length&&E.push({start:-1,count:-1,z:-1});const X=E[this.index];W.push(X),this.index++,X.start=_.start,X.count=_.count,X.z=T}reset(){this.list.length=0,this.index=0}}const ID_ATTR_NAME="batchId",_matrix$1=new Matrix4,_invMatrixWorld=new Matrix4,_identityMatrix=new Matrix4,_projScreenMatrix$2=new Matrix4,_frustum=new Frustum,_box$1=new Box3,_sphere$2=new Sphere,_vector$5=new Vector3,_renderList=new MultiDrawRenderList,_mesh=new Mesh,_batchIntersects=[];function copyAttributeData(B,_,T=0){const E=_.itemSize;if(B.isInterleavedBufferAttribute||B.array.constructor!==_.array.constructor){const W=B.count;for(let X=0;X<W;X++)for(let q=0;q<E;q++)_.setComponent(X+T,q,B.getComponent(X,q))}else _.array.set(B.array,T*E);_.needsUpdate=!0}class BatchedMesh extends Mesh{get maxGeometryCount(){return this._maxGeometryCount}constructor(_,T,E=T*2,W){super(new BufferGeometry,W),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=_,this._maxVertexCount=T,this._maxIndexCount=E,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(_),this._multiDrawStarts=new Int32Array(_),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let _=Math.sqrt(this._maxGeometryCount*4);_=Math.ceil(_/4)*4,_=Math.max(_,4);const T=new Float32Array(_*_*4),E=new DataTexture(T,_,_,RGBAFormat,FloatType);this._matricesTexture=E}_initializeGeometry(_){const T=this.geometry,E=this._maxVertexCount,W=this._maxGeometryCount,X=this._maxIndexCount;if(this._geometryInitialized===!1){for(const Y in _.attributes){const te=_.getAttribute(Y),{array:ne,itemSize:ae,normalized:le}=te,ue=new ne.constructor(E*ae),ge=new BufferAttribute(ue,ae,le);T.setAttribute(Y,ge)}if(_.getIndex()!==null){const Y=E>65536?new Uint32Array(X):new Uint16Array(X);T.setIndex(new BufferAttribute(Y,1))}const q=W>65536?new Uint32Array(E):new Uint16Array(E);T.setAttribute(ID_ATTR_NAME,new BufferAttribute(q,1)),this._geometryInitialized=!0}}_validateGeometry(_){if(_.getAttribute(ID_ATTR_NAME))throw new Error(`BatchedMesh: Geometry cannot use attribute "${ID_ATTR_NAME}"`);const T=this.geometry;if(!!_.getIndex()!=!!T.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const E in T.attributes){if(E===ID_ATTR_NAME)continue;if(!_.hasAttribute(E))throw new Error(`BatchedMesh: Added geometry missing "${E}". All geometries must have consistent attributes.`);const W=_.getAttribute(E),X=T.getAttribute(E);if(W.itemSize!==X.itemSize||W.normalized!==X.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(_){return this.customSort=_,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this._geometryCount,T=this.boundingBox,E=this._active;T.makeEmpty();for(let W=0;W<_;W++)E[W]!==!1&&(this.getMatrixAt(W,_matrix$1),this.getBoundingBoxAt(W,_box$1).applyMatrix4(_matrix$1),T.union(_box$1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const _=this._geometryCount,T=this.boundingSphere,E=this._active;T.makeEmpty();for(let W=0;W<_;W++)E[W]!==!1&&(this.getMatrixAt(W,_matrix$1),this.getBoundingSphereAt(W,_sphere$2).applyMatrix4(_matrix$1),T.union(_sphere$2))}addGeometry(_,T=-1,E=-1){if(this._initializeGeometry(_),this._validateGeometry(_),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const W={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let X=null;const q=this._reservedRanges,Y=this._drawRanges,te=this._bounds;this._geometryCount!==0&&(X=q[q.length-1]),T===-1?W.vertexCount=_.getAttribute("position").count:W.vertexCount=T,X===null?W.vertexStart=0:W.vertexStart=X.vertexStart+X.vertexCount;const ne=_.getIndex(),ae=ne!==null;if(ae&&(E===-1?W.indexCount=ne.count:W.indexCount=E,X===null?W.indexStart=0:W.indexStart=X.indexStart+X.indexCount),W.indexStart!==-1&&W.indexStart+W.indexCount>this._maxIndexCount||W.vertexStart+W.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const le=this._visibility,ue=this._active,ge=this._matricesTexture,ye=this._matricesTexture.image.data;le.push(!0),ue.push(!0);const xe=this._geometryCount;this._geometryCount++,_identityMatrix.toArray(ye,xe*16),ge.needsUpdate=!0,q.push(W),Y.push({start:ae?W.indexStart:W.vertexStart,count:-1}),te.push({boxInitialized:!1,box:new Box3,sphereInitialized:!1,sphere:new Sphere});const Te=this.geometry.getAttribute(ID_ATTR_NAME);for(let Ae=0;Ae<W.vertexCount;Ae++)Te.setX(W.vertexStart+Ae,xe);return Te.needsUpdate=!0,this.setGeometryAt(xe,_),xe}setGeometryAt(_,T){if(_>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(T);const E=this.geometry,W=E.getIndex()!==null,X=E.getIndex(),q=T.getIndex(),Y=this._reservedRanges[_];if(W&&q.count>Y.indexCount||T.attributes.position.count>Y.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const te=Y.vertexStart,ne=Y.vertexCount;for(const ge in E.attributes){if(ge===ID_ATTR_NAME)continue;const ye=T.getAttribute(ge),xe=E.getAttribute(ge);copyAttributeData(ye,xe,te);const Te=ye.itemSize;for(let Ae=ye.count,Ie=ne;Ae<Ie;Ae++){const Ve=te+Ae;for(let $e=0;$e<Te;$e++)xe.setComponent(Ve,$e,0)}xe.needsUpdate=!0,xe.addUpdateRange(te*Te,ne*Te)}if(W){const ge=Y.indexStart;for(let ye=0;ye<q.count;ye++)X.setX(ge+ye,te+q.getX(ye));for(let ye=q.count,xe=Y.indexCount;ye<xe;ye++)X.setX(ge+ye,te);X.needsUpdate=!0,X.addUpdateRange(ge,Y.indexCount)}const ae=this._bounds[_];T.boundingBox!==null?(ae.box.copy(T.boundingBox),ae.boxInitialized=!0):ae.boxInitialized=!1,T.boundingSphere!==null?(ae.sphere.copy(T.boundingSphere),ae.sphereInitialized=!0):ae.sphereInitialized=!1;const le=this._drawRanges[_],ue=T.getAttribute("position");return le.count=W?q.count:ue.count,this._visibilityChanged=!0,_}deleteGeometry(_){const T=this._active;return _>=T.length||T[_]===!1?this:(T[_]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(_){return this._multiDrawInstances===null?null:this._multiDrawInstances[_]}setInstanceCountAt(_,T){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[_]=T,_}getBoundingBoxAt(_,T){if(this._active[_]===!1)return null;const W=this._bounds[_],X=W.box,q=this.geometry;if(W.boxInitialized===!1){X.makeEmpty();const Y=q.index,te=q.attributes.position,ne=this._drawRanges[_];for(let ae=ne.start,le=ne.start+ne.count;ae<le;ae++){let ue=ae;Y&&(ue=Y.getX(ue)),X.expandByPoint(_vector$5.fromBufferAttribute(te,ue))}W.boxInitialized=!0}return T.copy(X),T}getBoundingSphereAt(_,T){if(this._active[_]===!1)return null;const W=this._bounds[_],X=W.sphere,q=this.geometry;if(W.sphereInitialized===!1){X.makeEmpty(),this.getBoundingBoxAt(_,_box$1),_box$1.getCenter(X.center);const Y=q.index,te=q.attributes.position,ne=this._drawRanges[_];let ae=0;for(let le=ne.start,ue=ne.start+ne.count;le<ue;le++){let ge=le;Y&&(ge=Y.getX(ge)),_vector$5.fromBufferAttribute(te,ge),ae=Math.max(ae,X.center.distanceToSquared(_vector$5))}X.radius=Math.sqrt(ae),W.sphereInitialized=!0}return T.copy(X),T}setMatrixAt(_,T){const E=this._active,W=this._matricesTexture,X=this._matricesTexture.image.data,q=this._geometryCount;return _>=q||E[_]===!1?this:(T.toArray(X,_*16),W.needsUpdate=!0,this)}getMatrixAt(_,T){const E=this._active,W=this._matricesTexture.image.data,X=this._geometryCount;return _>=X||E[_]===!1?null:T.fromArray(W,_*16)}setVisibleAt(_,T){const E=this._visibility,W=this._active,X=this._geometryCount;return _>=X||W[_]===!1||E[_]===T?this:(E[_]=T,this._visibilityChanged=!0,this)}getVisibleAt(_){const T=this._visibility,E=this._active,W=this._geometryCount;return _>=W||E[_]===!1?!1:T[_]}raycast(_,T){const E=this._visibility,W=this._active,X=this._drawRanges,q=this._geometryCount,Y=this.matrixWorld,te=this.geometry;_mesh.material=this.material,_mesh.geometry.index=te.index,_mesh.geometry.attributes=te.attributes,_mesh.geometry.boundingBox===null&&(_mesh.geometry.boundingBox=new Box3),_mesh.geometry.boundingSphere===null&&(_mesh.geometry.boundingSphere=new Sphere);for(let ne=0;ne<q;ne++){if(!E[ne]||!W[ne])continue;const ae=X[ne];_mesh.geometry.setDrawRange(ae.start,ae.count),this.getMatrixAt(ne,_mesh.matrixWorld).premultiply(Y),this.getBoundingBoxAt(ne,_mesh.geometry.boundingBox),this.getBoundingSphereAt(ne,_mesh.geometry.boundingSphere),_mesh.raycast(_,_batchIntersects);for(let le=0,ue=_batchIntersects.length;le<ue;le++){const ge=_batchIntersects[le];ge.object=this,ge.batchId=ne,T.push(ge)}_batchIntersects.length=0}_mesh.material=null,_mesh.geometry.index=null,_mesh.geometry.attributes={},_mesh.geometry.setDrawRange(0,1/0)}copy(_){return super.copy(_),this.geometry=_.geometry.clone(),this.perObjectFrustumCulled=_.perObjectFrustumCulled,this.sortObjects=_.sortObjects,this.boundingBox=_.boundingBox!==null?_.boundingBox.clone():null,this.boundingSphere=_.boundingSphere!==null?_.boundingSphere.clone():null,this._drawRanges=_._drawRanges.map(T=>({...T})),this._reservedRanges=_._reservedRanges.map(T=>({...T})),this._visibility=_._visibility.slice(),this._active=_._active.slice(),this._bounds=_._bounds.map(T=>({boxInitialized:T.boxInitialized,box:T.box.clone(),sphereInitialized:T.sphereInitialized,sphere:T.sphere.clone()})),this._maxGeometryCount=_._maxGeometryCount,this._maxVertexCount=_._maxVertexCount,this._maxIndexCount=_._maxIndexCount,this._geometryInitialized=_._geometryInitialized,this._geometryCount=_._geometryCount,this._multiDrawCounts=_._multiDrawCounts.slice(),this._multiDrawStarts=_._multiDrawStarts.slice(),this._matricesTexture=_._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(_,T,E,W,X){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const q=W.getIndex(),Y=q===null?1:q.array.BYTES_PER_ELEMENT,te=this._active,ne=this._visibility,ae=this._multiDrawStarts,le=this._multiDrawCounts,ue=this._drawRanges,ge=this.perObjectFrustumCulled;ge&&(_projScreenMatrix$2.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse).multiply(this.matrixWorld),_frustum.setFromProjectionMatrix(_projScreenMatrix$2,_.coordinateSystem));let ye=0;if(this.sortObjects){_invMatrixWorld.copy(this.matrixWorld).invert(),_vector$5.setFromMatrixPosition(E.matrixWorld).applyMatrix4(_invMatrixWorld);for(let Ae=0,Ie=ne.length;Ae<Ie;Ae++)if(ne[Ae]&&te[Ae]){this.getMatrixAt(Ae,_matrix$1),this.getBoundingSphereAt(Ae,_sphere$2).applyMatrix4(_matrix$1);let Ve=!1;if(ge&&(Ve=!_frustum.intersectsSphere(_sphere$2)),!Ve){const $e=_vector$5.distanceTo(_sphere$2.center);_renderList.push(ue[Ae],$e)}}const xe=_renderList.list,Te=this.customSort;Te===null?xe.sort(X.transparent?sortTransparent:sortOpaque):Te.call(this,xe,E);for(let Ae=0,Ie=xe.length;Ae<Ie;Ae++){const Ve=xe[Ae];ae[ye]=Ve.start*Y,le[ye]=Ve.count,ye++}_renderList.reset()}else for(let xe=0,Te=ne.length;xe<Te;xe++)if(ne[xe]&&te[xe]){let Ae=!1;if(ge&&(this.getMatrixAt(xe,_matrix$1),this.getBoundingSphereAt(xe,_sphere$2).applyMatrix4(_matrix$1),Ae=!_frustum.intersectsSphere(_sphere$2)),!Ae){const Ie=ue[xe];ae[ye]=Ie.start*Y,le[ye]=Ie.count,ye++}}this._multiDrawCount=ye,this._visibilityChanged=!1}onBeforeShadow(_,T,E,W,X,q){this.onBeforeRender(_,null,W,X,q)}}class LineBasicMaterial extends Material{constructor(_){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.linewidth=_.linewidth,this.linecap=_.linecap,this.linejoin=_.linejoin,this.fog=_.fog,this}}const _vStart=new Vector3,_vEnd=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere,_intersectPointOnRay=new Vector3,_intersectPointOnSegment=new Vector3;let Line$1=class extends Object3D{constructor(_=new BufferGeometry,T=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_,this.material=T,this.updateMorphTargets()}copy(_,T){return super.copy(_,T),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}computeLineDistances(){const _=this.geometry;if(_.index===null){const T=_.attributes.position,E=[0];for(let W=1,X=T.count;W<X;W++)_vStart.fromBufferAttribute(T,W-1),_vEnd.fromBufferAttribute(T,W),E[W]=E[W-1],E[W]+=_vStart.distanceTo(_vEnd);_.setAttribute("lineDistance",new Float32BufferAttribute(E,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_,T){const E=this.geometry,W=this.matrixWorld,X=_.params.Line.threshold,q=E.drawRange;if(E.boundingSphere===null&&E.computeBoundingSphere(),_sphere$1.copy(E.boundingSphere),_sphere$1.applyMatrix4(W),_sphere$1.radius+=X,_.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(W).invert(),_ray$1.copy(_.ray).applyMatrix4(_inverseMatrix$1);const Y=X/((this.scale.x+this.scale.y+this.scale.z)/3),te=Y*Y,ne=this.isLineSegments?2:1,ae=E.index,ue=E.attributes.position;if(ae!==null){const ge=Math.max(0,q.start),ye=Math.min(ae.count,q.start+q.count);for(let xe=ge,Te=ye-1;xe<Te;xe+=ne){const Ae=ae.getX(xe),Ie=ae.getX(xe+1),Ve=checkIntersection(this,_,_ray$1,te,Ae,Ie);Ve&&T.push(Ve)}if(this.isLineLoop){const xe=ae.getX(ye-1),Te=ae.getX(ge),Ae=checkIntersection(this,_,_ray$1,te,xe,Te);Ae&&T.push(Ae)}}else{const ge=Math.max(0,q.start),ye=Math.min(ue.count,q.start+q.count);for(let xe=ge,Te=ye-1;xe<Te;xe+=ne){const Ae=checkIntersection(this,_,_ray$1,te,xe,xe+1);Ae&&T.push(Ae)}if(this.isLineLoop){const xe=checkIntersection(this,_,_ray$1,te,ye-1,ge);xe&&T.push(xe)}}}updateMorphTargets(){const T=this.geometry.morphAttributes,E=Object.keys(T);if(E.length>0){const W=T[E[0]];if(W!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let X=0,q=W.length;X<q;X++){const Y=W[X].name||String(X);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Y]=X}}}}};function checkIntersection(B,_,T,E,W,X){const q=B.geometry.attributes.position;if(_vStart.fromBufferAttribute(q,W),_vEnd.fromBufferAttribute(q,X),T.distanceSqToSegment(_vStart,_vEnd,_intersectPointOnRay,_intersectPointOnSegment)>E)return;_intersectPointOnRay.applyMatrix4(B.matrixWorld);const te=_.ray.origin.distanceTo(_intersectPointOnRay);if(!(te<_.near||te>_.far))return{distance:te,point:_intersectPointOnSegment.clone().applyMatrix4(B.matrixWorld),index:W,face:null,faceIndex:null,object:B}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line$1{constructor(_,T){super(_,T),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _=this.geometry;if(_.index===null){const T=_.attributes.position,E=[];for(let W=0,X=T.count;W<X;W+=2)_start.fromBufferAttribute(T,W),_end.fromBufferAttribute(T,W+1),E[W]=W===0?0:E[W-1],E[W+1]=E[W]+_start.distanceTo(_end);_.setAttribute("lineDistance",new Float32BufferAttribute(E,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line$1{constructor(_,T){super(_,T),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.size=_.size,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}const _inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere,_position$2=new Vector3;class Points extends Object3D{constructor(_=new BufferGeometry,T=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_,this.material=T,this.updateMorphTargets()}copy(_,T){return super.copy(_,T),this.material=Array.isArray(_.material)?_.material.slice():_.material,this.geometry=_.geometry,this}raycast(_,T){const E=this.geometry,W=this.matrixWorld,X=_.params.Points.threshold,q=E.drawRange;if(E.boundingSphere===null&&E.computeBoundingSphere(),_sphere.copy(E.boundingSphere),_sphere.applyMatrix4(W),_sphere.radius+=X,_.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(W).invert(),_ray.copy(_.ray).applyMatrix4(_inverseMatrix);const Y=X/((this.scale.x+this.scale.y+this.scale.z)/3),te=Y*Y,ne=E.index,le=E.attributes.position;if(ne!==null){const ue=Math.max(0,q.start),ge=Math.min(ne.count,q.start+q.count);for(let ye=ue,xe=ge;ye<xe;ye++){const Te=ne.getX(ye);_position$2.fromBufferAttribute(le,Te),testPoint(_position$2,Te,te,W,_,T,this)}}else{const ue=Math.max(0,q.start),ge=Math.min(le.count,q.start+q.count);for(let ye=ue,xe=ge;ye<xe;ye++)_position$2.fromBufferAttribute(le,ye),testPoint(_position$2,ye,te,W,_,T,this)}}updateMorphTargets(){const T=this.geometry.morphAttributes,E=Object.keys(T);if(E.length>0){const W=T[E[0]];if(W!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let X=0,q=W.length;X<q;X++){const Y=W[X].name||String(X);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Y]=X}}}}}function testPoint(B,_,T,E,W,X,q){const Y=_ray.distanceSqToPoint(B);if(Y<T){const te=new Vector3;_ray.closestPointToPoint(B,te),te.applyMatrix4(E);const ne=W.ray.origin.distanceTo(te);if(ne<W.near||ne>W.far)return;X.push({distance:ne,distanceToRay:Math.sqrt(Y),point:te,index:_,face:null,object:q})}}class VideoTexture extends Texture{constructor(_,T,E,W,X,q,Y,te,ne){super(_,T,E,W,X,q,Y,te,ne),this.isVideoTexture=!0,this.minFilter=q!==void 0?q:LinearFilter,this.magFilter=X!==void 0?X:LinearFilter,this.generateMipmaps=!1;const ae=this;function le(){ae.needsUpdate=!0,_.requestVideoFrameCallback(le)}"requestVideoFrameCallback"in _&&_.requestVideoFrameCallback(le)}clone(){return new this.constructor(this.image).copy(this)}update(){const _=this.image;"requestVideoFrameCallback"in _===!1&&_.readyState>=_.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture{constructor(_,T){super({width:_,height:T}),this.isFramebufferTexture=!0,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture{constructor(_,T,E,W,X,q,Y,te,ne,ae,le,ue){super(null,q,Y,te,ne,ae,W,X,le,ue),this.isCompressedTexture=!0,this.image={width:T,height:E},this.mipmaps=_,this.flipY=!1,this.generateMipmaps=!1}}class CompressedArrayTexture extends CompressedTexture{constructor(_,T,E,W,X,q){super(_,T,E,X,q),this.isCompressedArrayTexture=!0,this.image.depth=W,this.wrapR=ClampToEdgeWrapping}}class CompressedCubeTexture extends CompressedTexture{constructor(_,T,E){super(void 0,_[0].width,_[0].height,T,E,CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=_}}class CanvasTexture extends Texture{constructor(_,T,E,W,X,q,Y,te,ne){super(_,T,E,W,X,q,Y,te,ne),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_,T){const E=this.getUtoTmapping(_);return this.getPoint(E,T)}getPoints(_=5){const T=[];for(let E=0;E<=_;E++)T.push(this.getPoint(E/_));return T}getSpacedPoints(_=5){const T=[];for(let E=0;E<=_;E++)T.push(this.getPointAt(E/_));return T}getLength(){const _=this.getLengths();return _[_.length-1]}getLengths(_=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const T=[];let E,W=this.getPoint(0),X=0;T.push(0);for(let q=1;q<=_;q++)E=this.getPoint(q/_),X+=E.distanceTo(W),T.push(X),W=E;return this.cacheArcLengths=T,T}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_,T){const E=this.getLengths();let W=0;const X=E.length;let q;T?q=T:q=_*E[X-1];let Y=0,te=X-1,ne;for(;Y<=te;)if(W=Math.floor(Y+(te-Y)/2),ne=E[W]-q,ne<0)Y=W+1;else if(ne>0)te=W-1;else{te=W;break}if(W=te,E[W]===q)return W/(X-1);const ae=E[W],ue=E[W+1]-ae,ge=(q-ae)/ue;return(W+ge)/(X-1)}getTangent(_,T){let W=_-1e-4,X=_+1e-4;W<0&&(W=0),X>1&&(X=1);const q=this.getPoint(W),Y=this.getPoint(X),te=T||(q.isVector2?new Vector2:new Vector3);return te.copy(Y).sub(q).normalize(),te}getTangentAt(_,T){const E=this.getUtoTmapping(_);return this.getTangent(E,T)}computeFrenetFrames(_,T){const E=new Vector3,W=[],X=[],q=[],Y=new Vector3,te=new Matrix4;for(let ge=0;ge<=_;ge++){const ye=ge/_;W[ge]=this.getTangentAt(ye,new Vector3)}X[0]=new Vector3,q[0]=new Vector3;let ne=Number.MAX_VALUE;const ae=Math.abs(W[0].x),le=Math.abs(W[0].y),ue=Math.abs(W[0].z);ae<=ne&&(ne=ae,E.set(1,0,0)),le<=ne&&(ne=le,E.set(0,1,0)),ue<=ne&&E.set(0,0,1),Y.crossVectors(W[0],E).normalize(),X[0].crossVectors(W[0],Y),q[0].crossVectors(W[0],X[0]);for(let ge=1;ge<=_;ge++){if(X[ge]=X[ge-1].clone(),q[ge]=q[ge-1].clone(),Y.crossVectors(W[ge-1],W[ge]),Y.length()>Number.EPSILON){Y.normalize();const ye=Math.acos(clamp$1(W[ge-1].dot(W[ge]),-1,1));X[ge].applyMatrix4(te.makeRotationAxis(Y,ye))}q[ge].crossVectors(W[ge],X[ge])}if(T===!0){let ge=Math.acos(clamp$1(X[0].dot(X[_]),-1,1));ge/=_,W[0].dot(Y.crossVectors(X[0],X[_]))>0&&(ge=-ge);for(let ye=1;ye<=_;ye++)X[ye].applyMatrix4(te.makeRotationAxis(W[ye],ge*ye)),q[ye].crossVectors(W[ye],X[ye])}return{tangents:W,normals:X,binormals:q}}clone(){return new this.constructor().copy(this)}copy(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}toJSON(){const _={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return _.arcLengthDivisions=this.arcLengthDivisions,_.type=this.type,_}fromJSON(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_=0,T=0,E=1,W=1,X=0,q=Math.PI*2,Y=!1,te=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_,this.aY=T,this.xRadius=E,this.yRadius=W,this.aStartAngle=X,this.aEndAngle=q,this.aClockwise=Y,this.aRotation=te}getPoint(_,T=new Vector2){const E=T,W=Math.PI*2;let X=this.aEndAngle-this.aStartAngle;const q=Math.abs(X)<Number.EPSILON;for(;X<0;)X+=W;for(;X>W;)X-=W;X<Number.EPSILON&&(q?X=0:X=W),this.aClockwise===!0&&!q&&(X===W?X=-W:X=X-W);const Y=this.aStartAngle+_*X;let te=this.aX+this.xRadius*Math.cos(Y),ne=this.aY+this.yRadius*Math.sin(Y);if(this.aRotation!==0){const ae=Math.cos(this.aRotation),le=Math.sin(this.aRotation),ue=te-this.aX,ge=ne-this.aY;te=ue*ae-ge*le+this.aX,ne=ue*le+ge*ae+this.aY}return E.set(te,ne)}copy(_){return super.copy(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}toJSON(){const _=super.toJSON();return _.aX=this.aX,_.aY=this.aY,_.xRadius=this.xRadius,_.yRadius=this.yRadius,_.aStartAngle=this.aStartAngle,_.aEndAngle=this.aEndAngle,_.aClockwise=this.aClockwise,_.aRotation=this.aRotation,_}fromJSON(_){return super.fromJSON(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_,T,E,W,X,q){super(_,T,E,E,W,X,q),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let B=0,_=0,T=0,E=0;function W(X,q,Y,te){B=X,_=Y,T=-3*X+3*q-2*Y-te,E=2*X-2*q+Y+te}return{initCatmullRom:function(X,q,Y,te,ne){W(q,Y,ne*(Y-X),ne*(te-q))},initNonuniformCatmullRom:function(X,q,Y,te,ne,ae,le){let ue=(q-X)/ne-(Y-X)/(ne+ae)+(Y-q)/ae,ge=(Y-q)/ae-(te-q)/(ae+le)+(te-Y)/le;ue*=ae,ge*=ae,W(q,Y,ue,ge)},calc:function(X){const q=X*X,Y=q*X;return B+_*X+T*q+E*Y}}}const tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_=[],T=!1,E="centripetal",W=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_,this.closed=T,this.curveType=E,this.tension=W}getPoint(_,T=new Vector3){const E=T,W=this.points,X=W.length,q=(X-(this.closed?0:1))*_;let Y=Math.floor(q),te=q-Y;this.closed?Y+=Y>0?0:(Math.floor(Math.abs(Y)/X)+1)*X:te===0&&Y===X-1&&(Y=X-2,te=1);let ne,ae;this.closed||Y>0?ne=W[(Y-1)%X]:(tmp.subVectors(W[0],W[1]).add(W[0]),ne=tmp);const le=W[Y%X],ue=W[(Y+1)%X];if(this.closed||Y+2<X?ae=W[(Y+2)%X]:(tmp.subVectors(W[X-1],W[X-2]).add(W[X-1]),ae=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const ge=this.curveType==="chordal"?.5:.25;let ye=Math.pow(ne.distanceToSquared(le),ge),xe=Math.pow(le.distanceToSquared(ue),ge),Te=Math.pow(ue.distanceToSquared(ae),ge);xe<1e-4&&(xe=1),ye<1e-4&&(ye=xe),Te<1e-4&&(Te=xe),px.initNonuniformCatmullRom(ne.x,le.x,ue.x,ae.x,ye,xe,Te),py.initNonuniformCatmullRom(ne.y,le.y,ue.y,ae.y,ye,xe,Te),pz.initNonuniformCatmullRom(ne.z,le.z,ue.z,ae.z,ye,xe,Te)}else this.curveType==="catmullrom"&&(px.initCatmullRom(ne.x,le.x,ue.x,ae.x,this.tension),py.initCatmullRom(ne.y,le.y,ue.y,ae.y,this.tension),pz.initCatmullRom(ne.z,le.z,ue.z,ae.z,this.tension));return E.set(px.calc(te),py.calc(te),pz.calc(te)),E}copy(_){super.copy(_),this.points=[];for(let T=0,E=_.points.length;T<E;T++){const W=_.points[T];this.points.push(W.clone())}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}toJSON(){const _=super.toJSON();_.points=[];for(let T=0,E=this.points.length;T<E;T++){const W=this.points[T];_.points.push(W.toArray())}return _.closed=this.closed,_.curveType=this.curveType,_.tension=this.tension,_}fromJSON(_){super.fromJSON(_),this.points=[];for(let T=0,E=_.points.length;T<E;T++){const W=_.points[T];this.points.push(new Vector3().fromArray(W))}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}}function CatmullRom(B,_,T,E,W){const X=(E-_)*.5,q=(W-T)*.5,Y=B*B,te=B*Y;return(2*T-2*E+X+q)*te+(-3*T+3*E-2*X-q)*Y+X*B+T}function QuadraticBezierP0(B,_){const T=1-B;return T*T*_}function QuadraticBezierP1(B,_){return 2*(1-B)*B*_}function QuadraticBezierP2(B,_){return B*B*_}function QuadraticBezier(B,_,T,E){return QuadraticBezierP0(B,_)+QuadraticBezierP1(B,T)+QuadraticBezierP2(B,E)}function CubicBezierP0(B,_){const T=1-B;return T*T*T*_}function CubicBezierP1(B,_){const T=1-B;return 3*T*T*B*_}function CubicBezierP2(B,_){return 3*(1-B)*B*B*_}function CubicBezierP3(B,_){return B*B*B*_}function CubicBezier(B,_,T,E,W){return CubicBezierP0(B,_)+CubicBezierP1(B,T)+CubicBezierP2(B,E)+CubicBezierP3(B,W)}class CubicBezierCurve extends Curve{constructor(_=new Vector2,T=new Vector2,E=new Vector2,W=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_,this.v1=T,this.v2=E,this.v3=W}getPoint(_,T=new Vector2){const E=T,W=this.v0,X=this.v1,q=this.v2,Y=this.v3;return E.set(CubicBezier(_,W.x,X.x,q.x,Y.x),CubicBezier(_,W.y,X.y,q.y,Y.y)),E}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_=new Vector3,T=new Vector3,E=new Vector3,W=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_,this.v1=T,this.v2=E,this.v3=W}getPoint(_,T=new Vector3){const E=T,W=this.v0,X=this.v1,q=this.v2,Y=this.v3;return E.set(CubicBezier(_,W.x,X.x,q.x,Y.x),CubicBezier(_,W.y,X.y,q.y,Y.y),CubicBezier(_,W.z,X.z,q.z,Y.z)),E}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class LineCurve extends Curve{constructor(_=new Vector2,T=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_,this.v2=T}getPoint(_,T=new Vector2){const E=T;return _===1?E.copy(this.v2):(E.copy(this.v2).sub(this.v1),E.multiplyScalar(_).add(this.v1)),E}getPointAt(_,T){return this.getPoint(_,T)}getTangent(_,T=new Vector2){return T.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,T){return this.getTangent(_,T)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class LineCurve3 extends Curve{constructor(_=new Vector3,T=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_,this.v2=T}getPoint(_,T=new Vector3){const E=T;return _===1?E.copy(this.v2):(E.copy(this.v2).sub(this.v1),E.multiplyScalar(_).add(this.v1)),E}getPointAt(_,T){return this.getPoint(_,T)}getTangent(_,T=new Vector3){return T.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,T){return this.getTangent(_,T)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_=new Vector2,T=new Vector2,E=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_,this.v1=T,this.v2=E}getPoint(_,T=new Vector2){const E=T,W=this.v0,X=this.v1,q=this.v2;return E.set(QuadraticBezier(_,W.x,X.x,q.x),QuadraticBezier(_,W.y,X.y,q.y)),E}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_=new Vector3,T=new Vector3,E=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_,this.v1=T,this.v2=E}getPoint(_,T=new Vector3){const E=T,W=this.v0,X=this.v1,q=this.v2;return E.set(QuadraticBezier(_,W.x,X.x,q.x),QuadraticBezier(_,W.y,X.y,q.y),QuadraticBezier(_,W.z,X.z,q.z)),E}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class SplineCurve extends Curve{constructor(_=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_}getPoint(_,T=new Vector2){const E=T,W=this.points,X=(W.length-1)*_,q=Math.floor(X),Y=X-q,te=W[q===0?q:q-1],ne=W[q],ae=W[q>W.length-2?W.length-1:q+1],le=W[q>W.length-3?W.length-1:q+2];return E.set(CatmullRom(Y,te.x,ne.x,ae.x,le.x),CatmullRom(Y,te.y,ne.y,ae.y,le.y)),E}copy(_){super.copy(_),this.points=[];for(let T=0,E=_.points.length;T<E;T++){const W=_.points[T];this.points.push(W.clone())}return this}toJSON(){const _=super.toJSON();_.points=[];for(let T=0,E=this.points.length;T<E;T++){const W=this.points[T];_.points.push(W.toArray())}return _}fromJSON(_){super.fromJSON(_),this.points=[];for(let T=0,E=_.points.length;T<E;T++){const W=_.points[T];this.points.push(new Vector2().fromArray(W))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_){this.curves.push(_)}closePath(){const _=this.curves[0].getPoint(0),T=this.curves[this.curves.length-1].getPoint(1);if(!_.equals(T)){const E=_.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Curves[E](T,_))}return this}getPoint(_,T){const E=_*this.getLength(),W=this.getCurveLengths();let X=0;for(;X<W.length;){if(W[X]>=E){const q=W[X]-E,Y=this.curves[X],te=Y.getLength(),ne=te===0?0:1-q/te;return Y.getPointAt(ne,T)}X++}return null}getLength(){const _=this.getCurveLengths();return _[_.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _=[];let T=0;for(let E=0,W=this.curves.length;E<W;E++)T+=this.curves[E].getLength(),_.push(T);return this.cacheLengths=_,_}getSpacedPoints(_=40){const T=[];for(let E=0;E<=_;E++)T.push(this.getPoint(E/_));return this.autoClose&&T.push(T[0]),T}getPoints(_=12){const T=[];let E;for(let W=0,X=this.curves;W<X.length;W++){const q=X[W],Y=q.isEllipseCurve?_*2:q.isLineCurve||q.isLineCurve3?1:q.isSplineCurve?_*q.points.length:_,te=q.getPoints(Y);for(let ne=0;ne<te.length;ne++){const ae=te[ne];E&&E.equals(ae)||(T.push(ae),E=ae)}}return this.autoClose&&T.length>1&&!T[T.length-1].equals(T[0])&&T.push(T[0]),T}copy(_){super.copy(_),this.curves=[];for(let T=0,E=_.curves.length;T<E;T++){const W=_.curves[T];this.curves.push(W.clone())}return this.autoClose=_.autoClose,this}toJSON(){const _=super.toJSON();_.autoClose=this.autoClose,_.curves=[];for(let T=0,E=this.curves.length;T<E;T++){const W=this.curves[T];_.curves.push(W.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.autoClose=_.autoClose,this.curves=[];for(let T=0,E=_.curves.length;T<E;T++){const W=_.curves[T];this.curves.push(new Curves[W.type]().fromJSON(W))}return this}}class Path extends CurvePath{constructor(_){super(),this.type="Path",this.currentPoint=new Vector2,_&&this.setFromPoints(_)}setFromPoints(_){this.moveTo(_[0].x,_[0].y);for(let T=1,E=_.length;T<E;T++)this.lineTo(_[T].x,_[T].y);return this}moveTo(_,T){return this.currentPoint.set(_,T),this}lineTo(_,T){const E=new LineCurve(this.currentPoint.clone(),new Vector2(_,T));return this.curves.push(E),this.currentPoint.set(_,T),this}quadraticCurveTo(_,T,E,W){const X=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(_,T),new Vector2(E,W));return this.curves.push(X),this.currentPoint.set(E,W),this}bezierCurveTo(_,T,E,W,X,q){const Y=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(_,T),new Vector2(E,W),new Vector2(X,q));return this.curves.push(Y),this.currentPoint.set(X,q),this}splineThru(_){const T=[this.currentPoint.clone()].concat(_),E=new SplineCurve(T);return this.curves.push(E),this.currentPoint.copy(_[_.length-1]),this}arc(_,T,E,W,X,q){const Y=this.currentPoint.x,te=this.currentPoint.y;return this.absarc(_+Y,T+te,E,W,X,q),this}absarc(_,T,E,W,X,q){return this.absellipse(_,T,E,E,W,X,q),this}ellipse(_,T,E,W,X,q,Y,te){const ne=this.currentPoint.x,ae=this.currentPoint.y;return this.absellipse(_+ne,T+ae,E,W,X,q,Y,te),this}absellipse(_,T,E,W,X,q,Y,te){const ne=new EllipseCurve(_,T,E,W,X,q,Y,te);if(this.curves.length>0){const le=ne.getPoint(0);le.equals(this.currentPoint)||this.lineTo(le.x,le.y)}this.curves.push(ne);const ae=ne.getPoint(1);return this.currentPoint.copy(ae),this}copy(_){return super.copy(_),this.currentPoint.copy(_.currentPoint),this}toJSON(){const _=super.toJSON();return _.currentPoint=this.currentPoint.toArray(),_}fromJSON(_){return super.fromJSON(_),this.currentPoint.fromArray(_.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(_=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],T=12,E=0,W=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_,segments:T,phiStart:E,phiLength:W},T=Math.floor(T),W=clamp$1(W,0,Math.PI*2);const X=[],q=[],Y=[],te=[],ne=[],ae=1/T,le=new Vector3,ue=new Vector2,ge=new Vector3,ye=new Vector3,xe=new Vector3;let Te=0,Ae=0;for(let Ie=0;Ie<=_.length-1;Ie++)switch(Ie){case 0:Te=_[Ie+1].x-_[Ie].x,Ae=_[Ie+1].y-_[Ie].y,ge.x=Ae*1,ge.y=-Te,ge.z=Ae*0,xe.copy(ge),ge.normalize(),te.push(ge.x,ge.y,ge.z);break;case _.length-1:te.push(xe.x,xe.y,xe.z);break;default:Te=_[Ie+1].x-_[Ie].x,Ae=_[Ie+1].y-_[Ie].y,ge.x=Ae*1,ge.y=-Te,ge.z=Ae*0,ye.copy(ge),ge.x+=xe.x,ge.y+=xe.y,ge.z+=xe.z,ge.normalize(),te.push(ge.x,ge.y,ge.z),xe.copy(ye)}for(let Ie=0;Ie<=T;Ie++){const Ve=E+Ie*ae*W,$e=Math.sin(Ve),We=Math.cos(Ve);for(let Ue=0;Ue<=_.length-1;Ue++){le.x=_[Ue].x*$e,le.y=_[Ue].y,le.z=_[Ue].x*We,q.push(le.x,le.y,le.z),ue.x=Ie/T,ue.y=Ue/(_.length-1),Y.push(ue.x,ue.y);const je=te[3*Ue+0]*$e,ze=te[3*Ue+1],He=te[3*Ue+0]*We;ne.push(je,ze,He)}}for(let Ie=0;Ie<T;Ie++)for(let Ve=0;Ve<_.length-1;Ve++){const $e=Ve+Ie*_.length,We=$e,Ue=$e+_.length,je=$e+_.length+1,ze=$e+1;X.push(We,Ue,ze),X.push(je,ze,Ue)}this.setIndex(X),this.setAttribute("position",new Float32BufferAttribute(q,3)),this.setAttribute("uv",new Float32BufferAttribute(Y,2)),this.setAttribute("normal",new Float32BufferAttribute(ne,3))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new LatheGeometry(_.points,_.segments,_.phiStart,_.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_=1,T=1,E=4,W=8){const X=new Path;X.absarc(0,-T/2,_,Math.PI*1.5,0),X.absarc(0,T/2,_,0,Math.PI*.5),super(X.getPoints(E),W),this.type="CapsuleGeometry",this.parameters={radius:_,length:T,capSegments:E,radialSegments:W}}static fromJSON(_){return new CapsuleGeometry(_.radius,_.length,_.capSegments,_.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(_=1,T=32,E=0,W=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_,segments:T,thetaStart:E,thetaLength:W},T=Math.max(3,T);const X=[],q=[],Y=[],te=[],ne=new Vector3,ae=new Vector2;q.push(0,0,0),Y.push(0,0,1),te.push(.5,.5);for(let le=0,ue=3;le<=T;le++,ue+=3){const ge=E+le/T*W;ne.x=_*Math.cos(ge),ne.y=_*Math.sin(ge),q.push(ne.x,ne.y,ne.z),Y.push(0,0,1),ae.x=(q[ue]/_+1)/2,ae.y=(q[ue+1]/_+1)/2,te.push(ae.x,ae.y)}for(let le=1;le<=T;le++)X.push(le,le+1,0);this.setIndex(X),this.setAttribute("position",new Float32BufferAttribute(q,3)),this.setAttribute("normal",new Float32BufferAttribute(Y,3)),this.setAttribute("uv",new Float32BufferAttribute(te,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CircleGeometry(_.radius,_.segments,_.thetaStart,_.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(_=1,T=1,E=1,W=32,X=1,q=!1,Y=0,te=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_,radiusBottom:T,height:E,radialSegments:W,heightSegments:X,openEnded:q,thetaStart:Y,thetaLength:te};const ne=this;W=Math.floor(W),X=Math.floor(X);const ae=[],le=[],ue=[],ge=[];let ye=0;const xe=[],Te=E/2;let Ae=0;Ie(),q===!1&&(_>0&&Ve(!0),T>0&&Ve(!1)),this.setIndex(ae),this.setAttribute("position",new Float32BufferAttribute(le,3)),this.setAttribute("normal",new Float32BufferAttribute(ue,3)),this.setAttribute("uv",new Float32BufferAttribute(ge,2));function Ie(){const $e=new Vector3,We=new Vector3;let Ue=0;const je=(T-_)/E;for(let ze=0;ze<=X;ze++){const He=[],Le=ze/X,qe=Le*(T-_)+_;for(let Qe=0;Qe<=W;Qe++){const Ke=Qe/W,Je=Ke*te+Y,pt=Math.sin(Je),ut=Math.cos(Je);We.x=qe*pt,We.y=-Le*E+Te,We.z=qe*ut,le.push(We.x,We.y,We.z),$e.set(pt,je,ut).normalize(),ue.push($e.x,$e.y,$e.z),ge.push(Ke,1-Le),He.push(ye++)}xe.push(He)}for(let ze=0;ze<W;ze++)for(let He=0;He<X;He++){const Le=xe[He][ze],qe=xe[He+1][ze],Qe=xe[He+1][ze+1],Ke=xe[He][ze+1];ae.push(Le,qe,Ke),ae.push(qe,Qe,Ke),Ue+=6}ne.addGroup(Ae,Ue,0),Ae+=Ue}function Ve($e){const We=ye,Ue=new Vector2,je=new Vector3;let ze=0;const He=$e===!0?_:T,Le=$e===!0?1:-1;for(let Qe=1;Qe<=W;Qe++)le.push(0,Te*Le,0),ue.push(0,Le,0),ge.push(.5,.5),ye++;const qe=ye;for(let Qe=0;Qe<=W;Qe++){const Je=Qe/W*te+Y,pt=Math.cos(Je),ut=Math.sin(Je);je.x=He*ut,je.y=Te*Le,je.z=He*pt,le.push(je.x,je.y,je.z),ue.push(0,Le,0),Ue.x=pt*.5+.5,Ue.y=ut*.5*Le+.5,ge.push(Ue.x,Ue.y),ye++}for(let Qe=0;Qe<W;Qe++){const Ke=We+Qe,Je=qe+Qe;$e===!0?ae.push(Je,Je+1,Ke):ae.push(Je+1,Je,Ke),ze+=3}ne.addGroup(Ae,ze,$e===!0?1:2),Ae+=ze}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CylinderGeometry(_.radiusTop,_.radiusBottom,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_=1,T=1,E=32,W=1,X=!1,q=0,Y=Math.PI*2){super(0,_,T,E,W,X,q,Y),this.type="ConeGeometry",this.parameters={radius:_,height:T,radialSegments:E,heightSegments:W,openEnded:X,thetaStart:q,thetaLength:Y}}static fromJSON(_){return new ConeGeometry(_.radius,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(_=[],T=[],E=1,W=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_,indices:T,radius:E,detail:W};const X=[],q=[];Y(W),ne(E),ae(),this.setAttribute("position",new Float32BufferAttribute(X,3)),this.setAttribute("normal",new Float32BufferAttribute(X.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(q,2)),W===0?this.computeVertexNormals():this.normalizeNormals();function Y(Ie){const Ve=new Vector3,$e=new Vector3,We=new Vector3;for(let Ue=0;Ue<T.length;Ue+=3)ge(T[Ue+0],Ve),ge(T[Ue+1],$e),ge(T[Ue+2],We),te(Ve,$e,We,Ie)}function te(Ie,Ve,$e,We){const Ue=We+1,je=[];for(let ze=0;ze<=Ue;ze++){je[ze]=[];const He=Ie.clone().lerp($e,ze/Ue),Le=Ve.clone().lerp($e,ze/Ue),qe=Ue-ze;for(let Qe=0;Qe<=qe;Qe++)Qe===0&&ze===Ue?je[ze][Qe]=He:je[ze][Qe]=He.clone().lerp(Le,Qe/qe)}for(let ze=0;ze<Ue;ze++)for(let He=0;He<2*(Ue-ze)-1;He++){const Le=Math.floor(He/2);He%2===0?(ue(je[ze][Le+1]),ue(je[ze+1][Le]),ue(je[ze][Le])):(ue(je[ze][Le+1]),ue(je[ze+1][Le+1]),ue(je[ze+1][Le]))}}function ne(Ie){const Ve=new Vector3;for(let $e=0;$e<X.length;$e+=3)Ve.x=X[$e+0],Ve.y=X[$e+1],Ve.z=X[$e+2],Ve.normalize().multiplyScalar(Ie),X[$e+0]=Ve.x,X[$e+1]=Ve.y,X[$e+2]=Ve.z}function ae(){const Ie=new Vector3;for(let Ve=0;Ve<X.length;Ve+=3){Ie.x=X[Ve+0],Ie.y=X[Ve+1],Ie.z=X[Ve+2];const $e=Te(Ie)/2/Math.PI+.5,We=Ae(Ie)/Math.PI+.5;q.push($e,1-We)}ye(),le()}function le(){for(let Ie=0;Ie<q.length;Ie+=6){const Ve=q[Ie+0],$e=q[Ie+2],We=q[Ie+4],Ue=Math.max(Ve,$e,We),je=Math.min(Ve,$e,We);Ue>.9&&je<.1&&(Ve<.2&&(q[Ie+0]+=1),$e<.2&&(q[Ie+2]+=1),We<.2&&(q[Ie+4]+=1))}}function ue(Ie){X.push(Ie.x,Ie.y,Ie.z)}function ge(Ie,Ve){const $e=Ie*3;Ve.x=_[$e+0],Ve.y=_[$e+1],Ve.z=_[$e+2]}function ye(){const Ie=new Vector3,Ve=new Vector3,$e=new Vector3,We=new Vector3,Ue=new Vector2,je=new Vector2,ze=new Vector2;for(let He=0,Le=0;He<X.length;He+=9,Le+=6){Ie.set(X[He+0],X[He+1],X[He+2]),Ve.set(X[He+3],X[He+4],X[He+5]),$e.set(X[He+6],X[He+7],X[He+8]),Ue.set(q[Le+0],q[Le+1]),je.set(q[Le+2],q[Le+3]),ze.set(q[Le+4],q[Le+5]),We.copy(Ie).add(Ve).add($e).divideScalar(3);const qe=Te(We);xe(Ue,Le+0,Ie,qe),xe(je,Le+2,Ve,qe),xe(ze,Le+4,$e,qe)}}function xe(Ie,Ve,$e,We){We<0&&Ie.x===1&&(q[Ve]=Ie.x-1),$e.x===0&&$e.z===0&&(q[Ve]=We/2/Math.PI+.5)}function Te(Ie){return Math.atan2(Ie.z,-Ie.x)}function Ae(Ie){return Math.atan2(-Ie.y,Math.sqrt(Ie.x*Ie.x+Ie.z*Ie.z))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PolyhedronGeometry(_.vertices,_.indices,_.radius,_.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_=1,T=0){const E=(1+Math.sqrt(5))/2,W=1/E,X=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-W,-E,0,-W,E,0,W,-E,0,W,E,-W,-E,0,-W,E,0,W,-E,0,W,E,0,-E,0,-W,E,0,-W,-E,0,W,E,0,W],q=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(X,q,_,T),this.type="DodecahedronGeometry",this.parameters={radius:_,detail:T}}static fromJSON(_){return new DodecahedronGeometry(_.radius,_.detail)}}const _v0=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(_=null,T=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_,thresholdAngle:T},_!==null){const W=Math.pow(10,4),X=Math.cos(DEG2RAD*T),q=_.getIndex(),Y=_.getAttribute("position"),te=q?q.count:Y.count,ne=[0,0,0],ae=["a","b","c"],le=new Array(3),ue={},ge=[];for(let ye=0;ye<te;ye+=3){q?(ne[0]=q.getX(ye),ne[1]=q.getX(ye+1),ne[2]=q.getX(ye+2)):(ne[0]=ye,ne[1]=ye+1,ne[2]=ye+2);const{a:xe,b:Te,c:Ae}=_triangle;if(xe.fromBufferAttribute(Y,ne[0]),Te.fromBufferAttribute(Y,ne[1]),Ae.fromBufferAttribute(Y,ne[2]),_triangle.getNormal(_normal),le[0]=`${Math.round(xe.x*W)},${Math.round(xe.y*W)},${Math.round(xe.z*W)}`,le[1]=`${Math.round(Te.x*W)},${Math.round(Te.y*W)},${Math.round(Te.z*W)}`,le[2]=`${Math.round(Ae.x*W)},${Math.round(Ae.y*W)},${Math.round(Ae.z*W)}`,!(le[0]===le[1]||le[1]===le[2]||le[2]===le[0]))for(let Ie=0;Ie<3;Ie++){const Ve=(Ie+1)%3,$e=le[Ie],We=le[Ve],Ue=_triangle[ae[Ie]],je=_triangle[ae[Ve]],ze=`${$e}_${We}`,He=`${We}_${$e}`;He in ue&&ue[He]?(_normal.dot(ue[He].normal)<=X&&(ge.push(Ue.x,Ue.y,Ue.z),ge.push(je.x,je.y,je.z)),ue[He]=null):ze in ue||(ue[ze]={index0:ne[Ie],index1:ne[Ve],normal:_normal.clone()})}}for(const ye in ue)if(ue[ye]){const{index0:xe,index1:Te}=ue[ye];_v0.fromBufferAttribute(Y,xe),_v1$1.fromBufferAttribute(Y,Te),ge.push(_v0.x,_v0.y,_v0.z),ge.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(ge,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}let Shape$1=class extends Path{constructor(_){super(_),this.uuid=generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(_){const T=[];for(let E=0,W=this.holes.length;E<W;E++)T[E]=this.holes[E].getPoints(_);return T}extractPoints(_){return{shape:this.getPoints(_),holes:this.getPointsHoles(_)}}copy(_){super.copy(_),this.holes=[];for(let T=0,E=_.holes.length;T<E;T++){const W=_.holes[T];this.holes.push(W.clone())}return this}toJSON(){const _=super.toJSON();_.uuid=this.uuid,_.holes=[];for(let T=0,E=this.holes.length;T<E;T++){const W=this.holes[T];_.holes.push(W.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.uuid=_.uuid,this.holes=[];for(let T=0,E=_.holes.length;T<E;T++){const W=_.holes[T];this.holes.push(new Path().fromJSON(W))}return this}};const Earcut={triangulate:function(B,_,T=2){const E=_&&_.length,W=E?_[0]*T:B.length;let X=linkedList(B,0,W,T,!0);const q=[];if(!X||X.next===X.prev)return q;let Y,te,ne,ae,le,ue,ge;if(E&&(X=eliminateHoles(B,_,X,T)),B.length>80*T){Y=ne=B[0],te=ae=B[1];for(let ye=T;ye<W;ye+=T)le=B[ye],ue=B[ye+1],le<Y&&(Y=le),ue<te&&(te=ue),le>ne&&(ne=le),ue>ae&&(ae=ue);ge=Math.max(ne-Y,ae-te),ge=ge!==0?32767/ge:0}return earcutLinked(X,q,T,Y,te,ge,0),q}};function linkedList(B,_,T,E,W){let X,q;if(W===signedArea(B,_,T,E)>0)for(X=_;X<T;X+=E)q=insertNode(X,B[X],B[X+1],q);else for(X=T-E;X>=_;X-=E)q=insertNode(X,B[X],B[X+1],q);return q&&equals(q,q.next)&&(removeNode(q),q=q.next),q}function filterPoints(B,_){if(!B)return B;_||(_=B);let T=B,E;do if(E=!1,!T.steiner&&(equals(T,T.next)||area(T.prev,T,T.next)===0)){if(removeNode(T),T=_=T.prev,T===T.next)break;E=!0}else T=T.next;while(E||T!==_);return _}function earcutLinked(B,_,T,E,W,X,q){if(!B)return;!q&&X&&indexCurve(B,E,W,X);let Y=B,te,ne;for(;B.prev!==B.next;){if(te=B.prev,ne=B.next,X?isEarHashed(B,E,W,X):isEar(B)){_.push(te.i/T|0),_.push(B.i/T|0),_.push(ne.i/T|0),removeNode(B),B=ne.next,Y=ne.next;continue}if(B=ne,B===Y){q?q===1?(B=cureLocalIntersections(filterPoints(B),_,T),earcutLinked(B,_,T,E,W,X,2)):q===2&&splitEarcut(B,_,T,E,W,X):earcutLinked(filterPoints(B),_,T,E,W,X,1);break}}}function isEar(B){const _=B.prev,T=B,E=B.next;if(area(_,T,E)>=0)return!1;const W=_.x,X=T.x,q=E.x,Y=_.y,te=T.y,ne=E.y,ae=W<X?W<q?W:q:X<q?X:q,le=Y<te?Y<ne?Y:ne:te<ne?te:ne,ue=W>X?W>q?W:q:X>q?X:q,ge=Y>te?Y>ne?Y:ne:te>ne?te:ne;let ye=E.next;for(;ye!==_;){if(ye.x>=ae&&ye.x<=ue&&ye.y>=le&&ye.y<=ge&&pointInTriangle(W,Y,X,te,q,ne,ye.x,ye.y)&&area(ye.prev,ye,ye.next)>=0)return!1;ye=ye.next}return!0}function isEarHashed(B,_,T,E){const W=B.prev,X=B,q=B.next;if(area(W,X,q)>=0)return!1;const Y=W.x,te=X.x,ne=q.x,ae=W.y,le=X.y,ue=q.y,ge=Y<te?Y<ne?Y:ne:te<ne?te:ne,ye=ae<le?ae<ue?ae:ue:le<ue?le:ue,xe=Y>te?Y>ne?Y:ne:te>ne?te:ne,Te=ae>le?ae>ue?ae:ue:le>ue?le:ue,Ae=zOrder(ge,ye,_,T,E),Ie=zOrder(xe,Te,_,T,E);let Ve=B.prevZ,$e=B.nextZ;for(;Ve&&Ve.z>=Ae&&$e&&$e.z<=Ie;){if(Ve.x>=ge&&Ve.x<=xe&&Ve.y>=ye&&Ve.y<=Te&&Ve!==W&&Ve!==q&&pointInTriangle(Y,ae,te,le,ne,ue,Ve.x,Ve.y)&&area(Ve.prev,Ve,Ve.next)>=0||(Ve=Ve.prevZ,$e.x>=ge&&$e.x<=xe&&$e.y>=ye&&$e.y<=Te&&$e!==W&&$e!==q&&pointInTriangle(Y,ae,te,le,ne,ue,$e.x,$e.y)&&area($e.prev,$e,$e.next)>=0))return!1;$e=$e.nextZ}for(;Ve&&Ve.z>=Ae;){if(Ve.x>=ge&&Ve.x<=xe&&Ve.y>=ye&&Ve.y<=Te&&Ve!==W&&Ve!==q&&pointInTriangle(Y,ae,te,le,ne,ue,Ve.x,Ve.y)&&area(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.prevZ}for(;$e&&$e.z<=Ie;){if($e.x>=ge&&$e.x<=xe&&$e.y>=ye&&$e.y<=Te&&$e!==W&&$e!==q&&pointInTriangle(Y,ae,te,le,ne,ue,$e.x,$e.y)&&area($e.prev,$e,$e.next)>=0)return!1;$e=$e.nextZ}return!0}function cureLocalIntersections(B,_,T){let E=B;do{const W=E.prev,X=E.next.next;!equals(W,X)&&intersects$1(W,E,E.next,X)&&locallyInside(W,X)&&locallyInside(X,W)&&(_.push(W.i/T|0),_.push(E.i/T|0),_.push(X.i/T|0),removeNode(E),removeNode(E.next),E=B=X),E=E.next}while(E!==B);return filterPoints(E)}function splitEarcut(B,_,T,E,W,X){let q=B;do{let Y=q.next.next;for(;Y!==q.prev;){if(q.i!==Y.i&&isValidDiagonal(q,Y)){let te=splitPolygon(q,Y);q=filterPoints(q,q.next),te=filterPoints(te,te.next),earcutLinked(q,_,T,E,W,X,0),earcutLinked(te,_,T,E,W,X,0);return}Y=Y.next}q=q.next}while(q!==B)}function eliminateHoles(B,_,T,E){const W=[];let X,q,Y,te,ne;for(X=0,q=_.length;X<q;X++)Y=_[X]*E,te=X<q-1?_[X+1]*E:B.length,ne=linkedList(B,Y,te,E,!1),ne===ne.next&&(ne.steiner=!0),W.push(getLeftmost(ne));for(W.sort(compareX),X=0;X<W.length;X++)T=eliminateHole(W[X],T);return T}function compareX(B,_){return B.x-_.x}function eliminateHole(B,_){const T=findHoleBridge(B,_);if(!T)return _;const E=splitPolygon(T,B);return filterPoints(E,E.next),filterPoints(T,T.next)}function findHoleBridge(B,_){let T=_,E=-1/0,W;const X=B.x,q=B.y;do{if(q<=T.y&&q>=T.next.y&&T.next.y!==T.y){const ue=T.x+(q-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(ue<=X&&ue>E&&(E=ue,W=T.x<T.next.x?T:T.next,ue===X))return W}T=T.next}while(T!==_);if(!W)return null;const Y=W,te=W.x,ne=W.y;let ae=1/0,le;T=W;do X>=T.x&&T.x>=te&&X!==T.x&&pointInTriangle(q<ne?X:E,q,te,ne,q<ne?E:X,q,T.x,T.y)&&(le=Math.abs(q-T.y)/(X-T.x),locallyInside(T,B)&&(le<ae||le===ae&&(T.x>W.x||T.x===W.x&&sectorContainsSector(W,T)))&&(W=T,ae=le)),T=T.next;while(T!==Y);return W}function sectorContainsSector(B,_){return area(B.prev,B,_.prev)<0&&area(_.next,B,B.next)<0}function indexCurve(B,_,T,E){let W=B;do W.z===0&&(W.z=zOrder(W.x,W.y,_,T,E)),W.prevZ=W.prev,W.nextZ=W.next,W=W.next;while(W!==B);W.prevZ.nextZ=null,W.prevZ=null,sortLinked(W)}function sortLinked(B){let _,T,E,W,X,q,Y,te,ne=1;do{for(T=B,B=null,X=null,q=0;T;){for(q++,E=T,Y=0,_=0;_<ne&&(Y++,E=E.nextZ,!!E);_++);for(te=ne;Y>0||te>0&&E;)Y!==0&&(te===0||!E||T.z<=E.z)?(W=T,T=T.nextZ,Y--):(W=E,E=E.nextZ,te--),X?X.nextZ=W:B=W,W.prevZ=X,X=W;T=E}X.nextZ=null,ne*=2}while(q>1);return B}function zOrder(B,_,T,E,W){return B=(B-T)*W|0,_=(_-E)*W|0,B=(B|B<<8)&16711935,B=(B|B<<4)&252645135,B=(B|B<<2)&858993459,B=(B|B<<1)&1431655765,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,B|_<<1}function getLeftmost(B){let _=B,T=B;do(_.x<T.x||_.x===T.x&&_.y<T.y)&&(T=_),_=_.next;while(_!==B);return T}function pointInTriangle(B,_,T,E,W,X,q,Y){return(W-q)*(_-Y)>=(B-q)*(X-Y)&&(B-q)*(E-Y)>=(T-q)*(_-Y)&&(T-q)*(X-Y)>=(W-q)*(E-Y)}function isValidDiagonal(B,_){return B.next.i!==_.i&&B.prev.i!==_.i&&!intersectsPolygon(B,_)&&(locallyInside(B,_)&&locallyInside(_,B)&&middleInside(B,_)&&(area(B.prev,B,_.prev)||area(B,_.prev,_))||equals(B,_)&&area(B.prev,B,B.next)>0&&area(_.prev,_,_.next)>0)}function area(B,_,T){return(_.y-B.y)*(T.x-_.x)-(_.x-B.x)*(T.y-_.y)}function equals(B,_){return B.x===_.x&&B.y===_.y}function intersects$1(B,_,T,E){const W=sign(area(B,_,T)),X=sign(area(B,_,E)),q=sign(area(T,E,B)),Y=sign(area(T,E,_));return!!(W!==X&&q!==Y||W===0&&onSegment(B,T,_)||X===0&&onSegment(B,E,_)||q===0&&onSegment(T,B,E)||Y===0&&onSegment(T,_,E))}function onSegment(B,_,T){return _.x<=Math.max(B.x,T.x)&&_.x>=Math.min(B.x,T.x)&&_.y<=Math.max(B.y,T.y)&&_.y>=Math.min(B.y,T.y)}function sign(B){return B>0?1:B<0?-1:0}function intersectsPolygon(B,_){let T=B;do{if(T.i!==B.i&&T.next.i!==B.i&&T.i!==_.i&&T.next.i!==_.i&&intersects$1(T,T.next,B,_))return!0;T=T.next}while(T!==B);return!1}function locallyInside(B,_){return area(B.prev,B,B.next)<0?area(B,_,B.next)>=0&&area(B,B.prev,_)>=0:area(B,_,B.prev)<0||area(B,B.next,_)<0}function middleInside(B,_){let T=B,E=!1;const W=(B.x+_.x)/2,X=(B.y+_.y)/2;do T.y>X!=T.next.y>X&&T.next.y!==T.y&&W<(T.next.x-T.x)*(X-T.y)/(T.next.y-T.y)+T.x&&(E=!E),T=T.next;while(T!==B);return E}function splitPolygon(B,_){const T=new Node$1(B.i,B.x,B.y),E=new Node$1(_.i,_.x,_.y),W=B.next,X=_.prev;return B.next=_,_.prev=B,T.next=W,W.prev=T,E.next=T,T.prev=E,X.next=E,E.prev=X,E}function insertNode(B,_,T,E){const W=new Node$1(B,_,T);return E?(W.next=E.next,W.prev=E,E.next.prev=W,E.next=W):(W.prev=W,W.next=W),W}function removeNode(B){B.next.prev=B.prev,B.prev.next=B.next,B.prevZ&&(B.prevZ.nextZ=B.nextZ),B.nextZ&&(B.nextZ.prevZ=B.prevZ)}function Node$1(B,_,T){this.i=B,this.x=_,this.y=T,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(B,_,T,E){let W=0;for(let X=_,q=T-E;X<T;X+=E)W+=(B[q]-B[X])*(B[X+1]+B[q+1]),q=X;return W}class ShapeUtils{static area(_){const T=_.length;let E=0;for(let W=T-1,X=0;X<T;W=X++)E+=_[W].x*_[X].y-_[X].x*_[W].y;return E*.5}static isClockWise(_){return ShapeUtils.area(_)<0}static triangulateShape(_,T){const E=[],W=[],X=[];removeDupEndPts(_),addContour(E,_);let q=_.length;T.forEach(removeDupEndPts);for(let te=0;te<T.length;te++)W.push(q),q+=T[te].length,addContour(E,T[te]);const Y=Earcut.triangulate(E,W);for(let te=0;te<Y.length;te+=3)X.push(Y.slice(te,te+3));return X}}function removeDupEndPts(B){const _=B.length;_>2&&B[_-1].equals(B[0])&&B.pop()}function addContour(B,_){for(let T=0;T<_.length;T++)B.push(_[T].x),B.push(_[T].y)}class ExtrudeGeometry extends BufferGeometry{constructor(_=new Shape$1([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),T={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_,options:T},_=Array.isArray(_)?_:[_];const E=this,W=[],X=[];for(let Y=0,te=_.length;Y<te;Y++){const ne=_[Y];q(ne)}this.setAttribute("position",new Float32BufferAttribute(W,3)),this.setAttribute("uv",new Float32BufferAttribute(X,2)),this.computeVertexNormals();function q(Y){const te=[],ne=T.curveSegments!==void 0?T.curveSegments:12,ae=T.steps!==void 0?T.steps:1,le=T.depth!==void 0?T.depth:1;let ue=T.bevelEnabled!==void 0?T.bevelEnabled:!0,ge=T.bevelThickness!==void 0?T.bevelThickness:.2,ye=T.bevelSize!==void 0?T.bevelSize:ge-.1,xe=T.bevelOffset!==void 0?T.bevelOffset:0,Te=T.bevelSegments!==void 0?T.bevelSegments:3;const Ae=T.extrudePath,Ie=T.UVGenerator!==void 0?T.UVGenerator:WorldUVGenerator;let Ve,$e=!1,We,Ue,je,ze;Ae&&(Ve=Ae.getSpacedPoints(ae),$e=!0,ue=!1,We=Ae.computeFrenetFrames(ae,!1),Ue=new Vector3,je=new Vector3,ze=new Vector3),ue||(Te=0,ge=0,ye=0,xe=0);const He=Y.extractPoints(ne);let Le=He.shape;const qe=He.holes;if(!ShapeUtils.isClockWise(Le)){Le=Le.reverse();for(let Or=0,et=qe.length;Or<et;Or++){const at=qe[Or];ShapeUtils.isClockWise(at)&&(qe[Or]=at.reverse())}}const Ke=ShapeUtils.triangulateShape(Le,qe),Je=Le;for(let Or=0,et=qe.length;Or<et;Or++){const at=qe[Or];Le=Le.concat(at)}function pt(Or,et,at){return et||console.error("THREE.ExtrudeGeometry: vec does not exist"),Or.clone().addScaledVector(et,at)}const ut=Le.length,lt=Ke.length;function st(Or,et,at){let Rr,Br,Kr;const oi=Or.x-et.x,ct=Or.y-et.y,nt=at.x-Or.x,Ir=at.y-Or.y,Dr=oi*oi+ct*ct,ti=oi*Ir-ct*nt;if(Math.abs(ti)>Number.EPSILON){const si=Math.sqrt(Dr),Ai=Math.sqrt(nt*nt+Ir*Ir),Oi=et.x-ct/si,Ci=et.y+oi/si,Wi=at.x-Ir/Ai,ki=at.y+nt/Ai,Li=((Wi-Oi)*Ir-(ki-Ci)*nt)/(oi*Ir-ct*nt);Rr=Oi+oi*Li-Or.x,Br=Ci+ct*Li-Or.y;const mn=Rr*Rr+Br*Br;if(mn<=2)return new Vector2(Rr,Br);Kr=Math.sqrt(mn/2)}else{let si=!1;oi>Number.EPSILON?nt>Number.EPSILON&&(si=!0):oi<-Number.EPSILON?nt<-Number.EPSILON&&(si=!0):Math.sign(ct)===Math.sign(Ir)&&(si=!0),si?(Rr=-ct,Br=oi,Kr=Math.sqrt(Dr)):(Rr=oi,Br=ct,Kr=Math.sqrt(Dr/2))}return new Vector2(Rr/Kr,Br/Kr)}const sr=[];for(let Or=0,et=Je.length,at=et-1,Rr=Or+1;Or<et;Or++,at++,Rr++)at===et&&(at=0),Rr===et&&(Rr=0),sr[Or]=st(Je[Or],Je[at],Je[Rr]);const mt=[];let Tr,di=sr.concat();for(let Or=0,et=qe.length;Or<et;Or++){const at=qe[Or];Tr=[];for(let Rr=0,Br=at.length,Kr=Br-1,oi=Rr+1;Rr<Br;Rr++,Kr++,oi++)Kr===Br&&(Kr=0),oi===Br&&(oi=0),Tr[Rr]=st(at[Rr],at[Kr],at[oi]);mt.push(Tr),di=di.concat(Tr)}for(let Or=0;Or<Te;Or++){const et=Or/Te,at=ge*Math.cos(et*Math.PI/2),Rr=ye*Math.sin(et*Math.PI/2)+xe;for(let Br=0,Kr=Je.length;Br<Kr;Br++){const oi=pt(Je[Br],sr[Br],Rr);fi(oi.x,oi.y,-at)}for(let Br=0,Kr=qe.length;Br<Kr;Br++){const oi=qe[Br];Tr=mt[Br];for(let ct=0,nt=oi.length;ct<nt;ct++){const Ir=pt(oi[ct],Tr[ct],Rr);fi(Ir.x,Ir.y,-at)}}}const Mi=ye+xe;for(let Or=0;Or<ut;Or++){const et=ue?pt(Le[Or],di[Or],Mi):Le[Or];$e?(je.copy(We.normals[0]).multiplyScalar(et.x),Ue.copy(We.binormals[0]).multiplyScalar(et.y),ze.copy(Ve[0]).add(je).add(Ue),fi(ze.x,ze.y,ze.z)):fi(et.x,et.y,0)}for(let Or=1;Or<=ae;Or++)for(let et=0;et<ut;et++){const at=ue?pt(Le[et],di[et],Mi):Le[et];$e?(je.copy(We.normals[Or]).multiplyScalar(at.x),Ue.copy(We.binormals[Or]).multiplyScalar(at.y),ze.copy(Ve[Or]).add(je).add(Ue),fi(ze.x,ze.y,ze.z)):fi(at.x,at.y,le/ae*Or)}for(let Or=Te-1;Or>=0;Or--){const et=Or/Te,at=ge*Math.cos(et*Math.PI/2),Rr=ye*Math.sin(et*Math.PI/2)+xe;for(let Br=0,Kr=Je.length;Br<Kr;Br++){const oi=pt(Je[Br],sr[Br],Rr);fi(oi.x,oi.y,le+at)}for(let Br=0,Kr=qe.length;Br<Kr;Br++){const oi=qe[Br];Tr=mt[Br];for(let ct=0,nt=oi.length;ct<nt;ct++){const Ir=pt(oi[ct],Tr[ct],Rr);$e?fi(Ir.x,Ir.y+Ve[ae-1].y,Ve[ae-1].x+at):fi(Ir.x,Ir.y,le+at)}}}Gr(),ci();function Gr(){const Or=W.length/3;if(ue){let et=0,at=ut*et;for(let Rr=0;Rr<lt;Rr++){const Br=Ke[Rr];ri(Br[2]+at,Br[1]+at,Br[0]+at)}et=ae+Te*2,at=ut*et;for(let Rr=0;Rr<lt;Rr++){const Br=Ke[Rr];ri(Br[0]+at,Br[1]+at,Br[2]+at)}}else{for(let et=0;et<lt;et++){const at=Ke[et];ri(at[2],at[1],at[0])}for(let et=0;et<lt;et++){const at=Ke[et];ri(at[0]+ut*ae,at[1]+ut*ae,at[2]+ut*ae)}}E.addGroup(Or,W.length/3-Or,0)}function ci(){const Or=W.length/3;let et=0;gi(Je,et),et+=Je.length;for(let at=0,Rr=qe.length;at<Rr;at++){const Br=qe[at];gi(Br,et),et+=Br.length}E.addGroup(Or,W.length/3-Or,1)}function gi(Or,et){let at=Or.length;for(;--at>=0;){const Rr=at;let Br=at-1;Br<0&&(Br=Or.length-1);for(let Kr=0,oi=ae+Te*2;Kr<oi;Kr++){const ct=ut*Kr,nt=ut*(Kr+1),Ir=et+Rr+ct,Dr=et+Br+ct,ti=et+Br+nt,si=et+Rr+nt;ot(Ir,Dr,ti,si)}}}function fi(Or,et,at){te.push(Or),te.push(et),te.push(at)}function ri(Or,et,at){rt(Or),rt(et),rt(at);const Rr=W.length/3,Br=Ie.generateTopUV(E,W,Rr-3,Rr-2,Rr-1);gt(Br[0]),gt(Br[1]),gt(Br[2])}function ot(Or,et,at,Rr){rt(Or),rt(et),rt(Rr),rt(et),rt(at),rt(Rr);const Br=W.length/3,Kr=Ie.generateSideWallUV(E,W,Br-6,Br-3,Br-2,Br-1);gt(Kr[0]),gt(Kr[1]),gt(Kr[3]),gt(Kr[1]),gt(Kr[2]),gt(Kr[3])}function rt(Or){W.push(te[Or*3+0]),W.push(te[Or*3+1]),W.push(te[Or*3+2])}function gt(Or){X.push(Or.x),X.push(Or.y)}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),T=this.parameters.shapes,E=this.parameters.options;return toJSON$1(T,E,_)}static fromJSON(_,T){const E=[];for(let X=0,q=_.shapes.length;X<q;X++){const Y=T[_.shapes[X]];E.push(Y)}const W=_.options.extrudePath;return W!==void 0&&(_.options.extrudePath=new Curves[W.type]().fromJSON(W)),new ExtrudeGeometry(E,_.options)}}const WorldUVGenerator={generateTopUV:function(B,_,T,E,W){const X=_[T*3],q=_[T*3+1],Y=_[E*3],te=_[E*3+1],ne=_[W*3],ae=_[W*3+1];return[new Vector2(X,q),new Vector2(Y,te),new Vector2(ne,ae)]},generateSideWallUV:function(B,_,T,E,W,X){const q=_[T*3],Y=_[T*3+1],te=_[T*3+2],ne=_[E*3],ae=_[E*3+1],le=_[E*3+2],ue=_[W*3],ge=_[W*3+1],ye=_[W*3+2],xe=_[X*3],Te=_[X*3+1],Ae=_[X*3+2];return Math.abs(Y-ae)<Math.abs(q-ne)?[new Vector2(q,1-te),new Vector2(ne,1-le),new Vector2(ue,1-ye),new Vector2(xe,1-Ae)]:[new Vector2(Y,1-te),new Vector2(ae,1-le),new Vector2(ge,1-ye),new Vector2(Te,1-Ae)]}};function toJSON$1(B,_,T){if(T.shapes=[],Array.isArray(B))for(let E=0,W=B.length;E<W;E++){const X=B[E];T.shapes.push(X.uuid)}else T.shapes.push(B.uuid);return T.options=Object.assign({},_),_.extrudePath!==void 0&&(T.options.extrudePath=_.extrudePath.toJSON()),T}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_=1,T=0){const E=(1+Math.sqrt(5))/2,W=[-1,E,0,1,E,0,-1,-E,0,1,-E,0,0,-1,E,0,1,E,0,-1,-E,0,1,-E,E,0,-1,E,0,1,-E,0,-1,-E,0,1],X=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(W,X,_,T),this.type="IcosahedronGeometry",this.parameters={radius:_,detail:T}}static fromJSON(_){return new IcosahedronGeometry(_.radius,_.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_=1,T=0){const E=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],W=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(E,W,_,T),this.type="OctahedronGeometry",this.parameters={radius:_,detail:T}}static fromJSON(_){return new OctahedronGeometry(_.radius,_.detail)}}class RingGeometry extends BufferGeometry{constructor(_=.5,T=1,E=32,W=1,X=0,q=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_,outerRadius:T,thetaSegments:E,phiSegments:W,thetaStart:X,thetaLength:q},E=Math.max(3,E),W=Math.max(1,W);const Y=[],te=[],ne=[],ae=[];let le=_;const ue=(T-_)/W,ge=new Vector3,ye=new Vector2;for(let xe=0;xe<=W;xe++){for(let Te=0;Te<=E;Te++){const Ae=X+Te/E*q;ge.x=le*Math.cos(Ae),ge.y=le*Math.sin(Ae),te.push(ge.x,ge.y,ge.z),ne.push(0,0,1),ye.x=(ge.x/T+1)/2,ye.y=(ge.y/T+1)/2,ae.push(ye.x,ye.y)}le+=ue}for(let xe=0;xe<W;xe++){const Te=xe*(E+1);for(let Ae=0;Ae<E;Ae++){const Ie=Ae+Te,Ve=Ie,$e=Ie+E+1,We=Ie+E+2,Ue=Ie+1;Y.push(Ve,$e,Ue),Y.push($e,We,Ue)}}this.setIndex(Y),this.setAttribute("position",new Float32BufferAttribute(te,3)),this.setAttribute("normal",new Float32BufferAttribute(ne,3)),this.setAttribute("uv",new Float32BufferAttribute(ae,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new RingGeometry(_.innerRadius,_.outerRadius,_.thetaSegments,_.phiSegments,_.thetaStart,_.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(_=new Shape$1([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),T=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_,curveSegments:T};const E=[],W=[],X=[],q=[];let Y=0,te=0;if(Array.isArray(_)===!1)ne(_);else for(let ae=0;ae<_.length;ae++)ne(_[ae]),this.addGroup(Y,te,ae),Y+=te,te=0;this.setIndex(E),this.setAttribute("position",new Float32BufferAttribute(W,3)),this.setAttribute("normal",new Float32BufferAttribute(X,3)),this.setAttribute("uv",new Float32BufferAttribute(q,2));function ne(ae){const le=W.length/3,ue=ae.extractPoints(T);let ge=ue.shape;const ye=ue.holes;ShapeUtils.isClockWise(ge)===!1&&(ge=ge.reverse());for(let Te=0,Ae=ye.length;Te<Ae;Te++){const Ie=ye[Te];ShapeUtils.isClockWise(Ie)===!0&&(ye[Te]=Ie.reverse())}const xe=ShapeUtils.triangulateShape(ge,ye);for(let Te=0,Ae=ye.length;Te<Ae;Te++){const Ie=ye[Te];ge=ge.concat(Ie)}for(let Te=0,Ae=ge.length;Te<Ae;Te++){const Ie=ge[Te];W.push(Ie.x,Ie.y,0),X.push(0,0,1),q.push(Ie.x,Ie.y)}for(let Te=0,Ae=xe.length;Te<Ae;Te++){const Ie=xe[Te],Ve=Ie[0]+le,$e=Ie[1]+le,We=Ie[2]+le;E.push(Ve,$e,We),te+=3}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),T=this.parameters.shapes;return toJSON(T,_)}static fromJSON(_,T){const E=[];for(let W=0,X=_.shapes.length;W<X;W++){const q=T[_.shapes[W]];E.push(q)}return new ShapeGeometry(E,_.curveSegments)}}function toJSON(B,_){if(_.shapes=[],Array.isArray(B))for(let T=0,E=B.length;T<E;T++){const W=B[T];_.shapes.push(W.uuid)}else _.shapes.push(B.uuid);return _}class SphereGeometry extends BufferGeometry{constructor(_=1,T=32,E=16,W=0,X=Math.PI*2,q=0,Y=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_,widthSegments:T,heightSegments:E,phiStart:W,phiLength:X,thetaStart:q,thetaLength:Y},T=Math.max(3,Math.floor(T)),E=Math.max(2,Math.floor(E));const te=Math.min(q+Y,Math.PI);let ne=0;const ae=[],le=new Vector3,ue=new Vector3,ge=[],ye=[],xe=[],Te=[];for(let Ae=0;Ae<=E;Ae++){const Ie=[],Ve=Ae/E;let $e=0;Ae===0&&q===0?$e=.5/T:Ae===E&&te===Math.PI&&($e=-.5/T);for(let We=0;We<=T;We++){const Ue=We/T;le.x=-_*Math.cos(W+Ue*X)*Math.sin(q+Ve*Y),le.y=_*Math.cos(q+Ve*Y),le.z=_*Math.sin(W+Ue*X)*Math.sin(q+Ve*Y),ye.push(le.x,le.y,le.z),ue.copy(le).normalize(),xe.push(ue.x,ue.y,ue.z),Te.push(Ue+$e,1-Ve),Ie.push(ne++)}ae.push(Ie)}for(let Ae=0;Ae<E;Ae++)for(let Ie=0;Ie<T;Ie++){const Ve=ae[Ae][Ie+1],$e=ae[Ae][Ie],We=ae[Ae+1][Ie],Ue=ae[Ae+1][Ie+1];(Ae!==0||q>0)&&ge.push(Ve,$e,Ue),(Ae!==E-1||te<Math.PI)&&ge.push($e,We,Ue)}this.setIndex(ge),this.setAttribute("position",new Float32BufferAttribute(ye,3)),this.setAttribute("normal",new Float32BufferAttribute(xe,3)),this.setAttribute("uv",new Float32BufferAttribute(Te,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new SphereGeometry(_.radius,_.widthSegments,_.heightSegments,_.phiStart,_.phiLength,_.thetaStart,_.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(_=1,T=0){const E=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],W=[2,1,0,0,3,2,1,3,0,2,3,1];super(E,W,_,T),this.type="TetrahedronGeometry",this.parameters={radius:_,detail:T}}static fromJSON(_){return new TetrahedronGeometry(_.radius,_.detail)}}class TorusGeometry extends BufferGeometry{constructor(_=1,T=.4,E=12,W=48,X=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_,tube:T,radialSegments:E,tubularSegments:W,arc:X},E=Math.floor(E),W=Math.floor(W);const q=[],Y=[],te=[],ne=[],ae=new Vector3,le=new Vector3,ue=new Vector3;for(let ge=0;ge<=E;ge++)for(let ye=0;ye<=W;ye++){const xe=ye/W*X,Te=ge/E*Math.PI*2;le.x=(_+T*Math.cos(Te))*Math.cos(xe),le.y=(_+T*Math.cos(Te))*Math.sin(xe),le.z=T*Math.sin(Te),Y.push(le.x,le.y,le.z),ae.x=_*Math.cos(xe),ae.y=_*Math.sin(xe),ue.subVectors(le,ae).normalize(),te.push(ue.x,ue.y,ue.z),ne.push(ye/W),ne.push(ge/E)}for(let ge=1;ge<=E;ge++)for(let ye=1;ye<=W;ye++){const xe=(W+1)*ge+ye-1,Te=(W+1)*(ge-1)+ye-1,Ae=(W+1)*(ge-1)+ye,Ie=(W+1)*ge+ye;q.push(xe,Te,Ie),q.push(Te,Ae,Ie)}this.setIndex(q),this.setAttribute("position",new Float32BufferAttribute(Y,3)),this.setAttribute("normal",new Float32BufferAttribute(te,3)),this.setAttribute("uv",new Float32BufferAttribute(ne,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusGeometry(_.radius,_.tube,_.radialSegments,_.tubularSegments,_.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(_=1,T=.4,E=64,W=8,X=2,q=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_,tube:T,tubularSegments:E,radialSegments:W,p:X,q},E=Math.floor(E),W=Math.floor(W);const Y=[],te=[],ne=[],ae=[],le=new Vector3,ue=new Vector3,ge=new Vector3,ye=new Vector3,xe=new Vector3,Te=new Vector3,Ae=new Vector3;for(let Ve=0;Ve<=E;++Ve){const $e=Ve/E*X*Math.PI*2;Ie($e,X,q,_,ge),Ie($e+.01,X,q,_,ye),Te.subVectors(ye,ge),Ae.addVectors(ye,ge),xe.crossVectors(Te,Ae),Ae.crossVectors(xe,Te),xe.normalize(),Ae.normalize();for(let We=0;We<=W;++We){const Ue=We/W*Math.PI*2,je=-T*Math.cos(Ue),ze=T*Math.sin(Ue);le.x=ge.x+(je*Ae.x+ze*xe.x),le.y=ge.y+(je*Ae.y+ze*xe.y),le.z=ge.z+(je*Ae.z+ze*xe.z),te.push(le.x,le.y,le.z),ue.subVectors(le,ge).normalize(),ne.push(ue.x,ue.y,ue.z),ae.push(Ve/E),ae.push(We/W)}}for(let Ve=1;Ve<=E;Ve++)for(let $e=1;$e<=W;$e++){const We=(W+1)*(Ve-1)+($e-1),Ue=(W+1)*Ve+($e-1),je=(W+1)*Ve+$e,ze=(W+1)*(Ve-1)+$e;Y.push(We,Ue,ze),Y.push(Ue,je,ze)}this.setIndex(Y),this.setAttribute("position",new Float32BufferAttribute(te,3)),this.setAttribute("normal",new Float32BufferAttribute(ne,3)),this.setAttribute("uv",new Float32BufferAttribute(ae,2));function Ie(Ve,$e,We,Ue,je){const ze=Math.cos(Ve),He=Math.sin(Ve),Le=We/$e*Ve,qe=Math.cos(Le);je.x=Ue*(2+qe)*.5*ze,je.y=Ue*(2+qe)*He*.5,je.z=Ue*Math.sin(Le)*.5}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusKnotGeometry(_.radius,_.tube,_.tubularSegments,_.radialSegments,_.p,_.q)}}class TubeGeometry extends BufferGeometry{constructor(_=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),T=64,E=1,W=8,X=!1){super(),this.type="TubeGeometry",this.parameters={path:_,tubularSegments:T,radius:E,radialSegments:W,closed:X};const q=_.computeFrenetFrames(T,X);this.tangents=q.tangents,this.normals=q.normals,this.binormals=q.binormals;const Y=new Vector3,te=new Vector3,ne=new Vector2;let ae=new Vector3;const le=[],ue=[],ge=[],ye=[];xe(),this.setIndex(ye),this.setAttribute("position",new Float32BufferAttribute(le,3)),this.setAttribute("normal",new Float32BufferAttribute(ue,3)),this.setAttribute("uv",new Float32BufferAttribute(ge,2));function xe(){for(let Ve=0;Ve<T;Ve++)Te(Ve);Te(X===!1?T:0),Ie(),Ae()}function Te(Ve){ae=_.getPointAt(Ve/T,ae);const $e=q.normals[Ve],We=q.binormals[Ve];for(let Ue=0;Ue<=W;Ue++){const je=Ue/W*Math.PI*2,ze=Math.sin(je),He=-Math.cos(je);te.x=He*$e.x+ze*We.x,te.y=He*$e.y+ze*We.y,te.z=He*$e.z+ze*We.z,te.normalize(),ue.push(te.x,te.y,te.z),Y.x=ae.x+E*te.x,Y.y=ae.y+E*te.y,Y.z=ae.z+E*te.z,le.push(Y.x,Y.y,Y.z)}}function Ae(){for(let Ve=1;Ve<=T;Ve++)for(let $e=1;$e<=W;$e++){const We=(W+1)*(Ve-1)+($e-1),Ue=(W+1)*Ve+($e-1),je=(W+1)*Ve+$e,ze=(W+1)*(Ve-1)+$e;ye.push(We,Ue,ze),ye.push(Ue,je,ze)}}function Ie(){for(let Ve=0;Ve<=T;Ve++)for(let $e=0;$e<=W;$e++)ne.x=Ve/T,ne.y=$e/W,ge.push(ne.x,ne.y)}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON();return _.path=this.parameters.path.toJSON(),_}static fromJSON(_){return new TubeGeometry(new Curves[_.path.type]().fromJSON(_.path),_.tubularSegments,_.radius,_.radialSegments,_.closed)}}class WireframeGeometry extends BufferGeometry{constructor(_=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_},_!==null){const T=[],E=new Set,W=new Vector3,X=new Vector3;if(_.index!==null){const q=_.attributes.position,Y=_.index;let te=_.groups;te.length===0&&(te=[{start:0,count:Y.count,materialIndex:0}]);for(let ne=0,ae=te.length;ne<ae;++ne){const le=te[ne],ue=le.start,ge=le.count;for(let ye=ue,xe=ue+ge;ye<xe;ye+=3)for(let Te=0;Te<3;Te++){const Ae=Y.getX(ye+Te),Ie=Y.getX(ye+(Te+1)%3);W.fromBufferAttribute(q,Ae),X.fromBufferAttribute(q,Ie),isUniqueEdge(W,X,E)===!0&&(T.push(W.x,W.y,W.z),T.push(X.x,X.y,X.z))}}}else{const q=_.attributes.position;for(let Y=0,te=q.count/3;Y<te;Y++)for(let ne=0;ne<3;ne++){const ae=3*Y+ne,le=3*Y+(ne+1)%3;W.fromBufferAttribute(q,ae),X.fromBufferAttribute(q,le),isUniqueEdge(W,X,E)===!0&&(T.push(W.x,W.y,W.z),T.push(X.x,X.y,X.z))}}this.setAttribute("position",new Float32BufferAttribute(T,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}function isUniqueEdge(B,_,T){const E=`${B.x},${B.y},${B.z}-${_.x},${_.y},${_.z}`,W=`${_.x},${_.y},${_.z}-${B.x},${B.y},${B.z}`;return T.has(E)===!0||T.has(W)===!0?!1:(T.add(E),T.add(W),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(_){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.fog=_.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(_){super(_),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(_){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={STANDARD:""},this.color.copy(_.color),this.roughness=_.roughness,this.metalness=_.metalness,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.roughnessMap=_.roughnessMap,this.metalnessMap=_.metalnessMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.envMapIntensity=_.envMapIntensity,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$1(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(T){this.ior=(1+.4*T)/(1-.4*T)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(_)}get anisotropy(){return this._anisotropy}set anisotropy(_){this._anisotropy>0!=_>0&&this.version++,this._anisotropy=_}get clearcoat(){return this._clearcoat}set clearcoat(_){this._clearcoat>0!=_>0&&this.version++,this._clearcoat=_}get iridescence(){return this._iridescence}set iridescence(_){this._iridescence>0!=_>0&&this.version++,this._iridescence=_}get dispersion(){return this._dispersion}set dispersion(_){this._dispersion>0!=_>0&&this.version++,this._dispersion=_}get sheen(){return this._sheen}set sheen(_){this._sheen>0!=_>0&&this.version++,this._sheen=_}get transmission(){return this._transmission}set transmission(_){this._transmission>0!=_>0&&this.version++,this._transmission=_}copy(_){return super.copy(_),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=_.anisotropy,this.anisotropyRotation=_.anisotropyRotation,this.anisotropyMap=_.anisotropyMap,this.clearcoat=_.clearcoat,this.clearcoatMap=_.clearcoatMap,this.clearcoatRoughness=_.clearcoatRoughness,this.clearcoatRoughnessMap=_.clearcoatRoughnessMap,this.clearcoatNormalMap=_.clearcoatNormalMap,this.clearcoatNormalScale.copy(_.clearcoatNormalScale),this.dispersion=_.dispersion,this.ior=_.ior,this.iridescence=_.iridescence,this.iridescenceMap=_.iridescenceMap,this.iridescenceIOR=_.iridescenceIOR,this.iridescenceThicknessRange=[..._.iridescenceThicknessRange],this.iridescenceThicknessMap=_.iridescenceThicknessMap,this.sheen=_.sheen,this.sheenColor.copy(_.sheenColor),this.sheenColorMap=_.sheenColorMap,this.sheenRoughness=_.sheenRoughness,this.sheenRoughnessMap=_.sheenRoughnessMap,this.transmission=_.transmission,this.transmissionMap=_.transmissionMap,this.thickness=_.thickness,this.thicknessMap=_.thicknessMap,this.attenuationDistance=_.attenuationDistance,this.attenuationColor.copy(_.attenuationColor),this.specularIntensity=_.specularIntensity,this.specularIntensityMap=_.specularIntensityMap,this.specularColor.copy(_.specularColor),this.specularColorMap=_.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.specular.copy(_.specular),this.shininess=_.shininess,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshToonMaterial extends Material{constructor(_){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.gradientMap=_.gradientMap,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}class MeshNormalMaterial extends Material{constructor(_){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_)}copy(_){return super.copy(_),this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.flatShading=_.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Euler,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapRotation.copy(_.envMapRotation),this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshMatcapMaterial extends Material{constructor(_){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={MATCAP:""},this.color.copy(_.color),this.matcap=_.matcap,this.map=_.map,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.flatShading=_.flatShading,this.fog=_.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_)}copy(_){return super.copy(_),this.scale=_.scale,this.dashSize=_.dashSize,this.gapSize=_.gapSize,this}}function convertArray(B,_,T){return!B||!T&&B.constructor===_?B:typeof _.BYTES_PER_ELEMENT=="number"?new _(B):Array.prototype.slice.call(B)}function isTypedArray(B){return ArrayBuffer.isView(B)&&!(B instanceof DataView)}function getKeyframeOrder(B){function _(W,X){return B[W]-B[X]}const T=B.length,E=new Array(T);for(let W=0;W!==T;++W)E[W]=W;return E.sort(_),E}function sortedArray(B,_,T){const E=B.length,W=new B.constructor(E);for(let X=0,q=0;q!==E;++X){const Y=T[X]*_;for(let te=0;te!==_;++te)W[q++]=B[Y+te]}return W}function flattenJSON(B,_,T,E){let W=1,X=B[0];for(;X!==void 0&&X[E]===void 0;)X=B[W++];if(X===void 0)return;let q=X[E];if(q!==void 0)if(Array.isArray(q))do q=X[E],q!==void 0&&(_.push(X.time),T.push.apply(T,q)),X=B[W++];while(X!==void 0);else if(q.toArray!==void 0)do q=X[E],q!==void 0&&(_.push(X.time),q.toArray(T,T.length)),X=B[W++];while(X!==void 0);else do q=X[E],q!==void 0&&(_.push(X.time),T.push(q)),X=B[W++];while(X!==void 0)}function subclip(B,_,T,E,W=30){const X=B.clone();X.name=_;const q=[];for(let te=0;te<X.tracks.length;++te){const ne=X.tracks[te],ae=ne.getValueSize(),le=[],ue=[];for(let ge=0;ge<ne.times.length;++ge){const ye=ne.times[ge]*W;if(!(ye<T||ye>=E)){le.push(ne.times[ge]);for(let xe=0;xe<ae;++xe)ue.push(ne.values[ge*ae+xe])}}le.length!==0&&(ne.times=convertArray(le,ne.times.constructor),ne.values=convertArray(ue,ne.values.constructor),q.push(ne))}X.tracks=q;let Y=1/0;for(let te=0;te<X.tracks.length;++te)Y>X.tracks[te].times[0]&&(Y=X.tracks[te].times[0]);for(let te=0;te<X.tracks.length;++te)X.tracks[te].shift(-1*Y);return X.resetDuration(),X}function makeClipAdditive(B,_=0,T=B,E=30){E<=0&&(E=30);const W=T.tracks.length,X=_/E;for(let q=0;q<W;++q){const Y=T.tracks[q],te=Y.ValueTypeName;if(te==="bool"||te==="string")continue;const ne=B.tracks.find(function(Ae){return Ae.name===Y.name&&Ae.ValueTypeName===te});if(ne===void 0)continue;let ae=0;const le=Y.getValueSize();Y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ae=le/3);let ue=0;const ge=ne.getValueSize();ne.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ue=ge/3);const ye=Y.times.length-1;let xe;if(X<=Y.times[0]){const Ae=ae,Ie=le-ae;xe=Y.values.slice(Ae,Ie)}else if(X>=Y.times[ye]){const Ae=ye*le+ae,Ie=Ae+le-ae;xe=Y.values.slice(Ae,Ie)}else{const Ae=Y.createInterpolant(),Ie=ae,Ve=le-ae;Ae.evaluate(X),xe=Ae.resultBuffer.slice(Ie,Ve)}te==="quaternion"&&new Quaternion().fromArray(xe).normalize().conjugate().toArray(xe);const Te=ne.times.length;for(let Ae=0;Ae<Te;++Ae){const Ie=Ae*ge+ue;if(te==="quaternion")Quaternion.multiplyQuaternionsFlat(ne.values,Ie,xe,0,ne.values,Ie);else{const Ve=ge-ue*2;for(let $e=0;$e<Ve;++$e)ne.values[Ie+$e]-=xe[$e]}}}return B.blendMode=AdditiveAnimationBlendMode,B}const AnimationUtils={convertArray,isTypedArray,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(_,T,E,W){this.parameterPositions=_,this._cachedIndex=0,this.resultBuffer=W!==void 0?W:new T.constructor(E),this.sampleValues=T,this.valueSize=E,this.settings=null,this.DefaultSettings_={}}evaluate(_){const T=this.parameterPositions;let E=this._cachedIndex,W=T[E],X=T[E-1];e:{t:{let q;r:{i:if(!(_<W)){for(let Y=E+2;;){if(W===void 0){if(_<X)break i;return E=T.length,this._cachedIndex=E,this.copySampleValue_(E-1)}if(E===Y)break;if(X=W,W=T[++E],_<W)break t}q=T.length;break r}if(!(_>=X)){const Y=T[1];_<Y&&(E=2,X=Y);for(let te=E-2;;){if(X===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(E===te)break;if(W=X,X=T[--E-1],_>=X)break t}q=E,E=0;break r}break e}for(;E<q;){const Y=E+q>>>1;_<T[Y]?q=Y:E=Y+1}if(W=T[E],X=T[E-1],X===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(W===void 0)return E=T.length,this._cachedIndex=E,this.copySampleValue_(E-1)}this._cachedIndex=E,this.intervalChanged_(E,X,W)}return this.interpolate_(E,X,_,W)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_){const T=this.resultBuffer,E=this.sampleValues,W=this.valueSize,X=_*W;for(let q=0;q!==W;++q)T[q]=E[X+q];return T}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_,T,E,W){super(_,T,E,W),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_,T,E){const W=this.parameterPositions;let X=_-2,q=_+1,Y=W[X],te=W[q];if(Y===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:X=_,Y=2*T-E;break;case WrapAroundEnding:X=W.length-2,Y=T+W[X]-W[X+1];break;default:X=_,Y=E}if(te===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:q=_,te=2*E-T;break;case WrapAroundEnding:q=1,te=E+W[1]-W[0];break;default:q=_-1,te=T}const ne=(E-T)*.5,ae=this.valueSize;this._weightPrev=ne/(T-Y),this._weightNext=ne/(te-E),this._offsetPrev=X*ae,this._offsetNext=q*ae}interpolate_(_,T,E,W){const X=this.resultBuffer,q=this.sampleValues,Y=this.valueSize,te=_*Y,ne=te-Y,ae=this._offsetPrev,le=this._offsetNext,ue=this._weightPrev,ge=this._weightNext,ye=(E-T)/(W-T),xe=ye*ye,Te=xe*ye,Ae=-ue*Te+2*ue*xe-ue*ye,Ie=(1+ue)*Te+(-1.5-2*ue)*xe+(-.5+ue)*ye+1,Ve=(-1-ge)*Te+(1.5+ge)*xe+.5*ye,$e=ge*Te-ge*xe;for(let We=0;We!==Y;++We)X[We]=Ae*q[ae+We]+Ie*q[ne+We]+Ve*q[te+We]+$e*q[le+We];return X}}class LinearInterpolant extends Interpolant{constructor(_,T,E,W){super(_,T,E,W)}interpolate_(_,T,E,W){const X=this.resultBuffer,q=this.sampleValues,Y=this.valueSize,te=_*Y,ne=te-Y,ae=(E-T)/(W-T),le=1-ae;for(let ue=0;ue!==Y;++ue)X[ue]=q[ne+ue]*le+q[te+ue]*ae;return X}}class DiscreteInterpolant extends Interpolant{constructor(_,T,E,W){super(_,T,E,W)}interpolate_(_){return this.copySampleValue_(_-1)}}class KeyframeTrack{constructor(_,T,E,W){if(_===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(T===void 0||T.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_);this.name=_,this.times=convertArray(T,this.TimeBufferType),this.values=convertArray(E,this.ValueBufferType),this.setInterpolation(W||this.DefaultInterpolation)}static toJSON(_){const T=_.constructor;let E;if(T.toJSON!==this.toJSON)E=T.toJSON(_);else{E={name:_.name,times:convertArray(_.times,Array),values:convertArray(_.values,Array)};const W=_.getInterpolation();W!==_.DefaultInterpolation&&(E.interpolation=W)}return E.type=_.ValueTypeName,E}InterpolantFactoryMethodDiscrete(_){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodLinear(_){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodSmooth(_){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_)}setInterpolation(_){let T;switch(_){case InterpolateDiscrete:T=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:T=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:T=this.InterpolantFactoryMethodSmooth;break}if(T===void 0){const E="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(E);return console.warn("THREE.KeyframeTrack:",E),this}return this.createInterpolant=T,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_){if(_!==0){const T=this.times;for(let E=0,W=T.length;E!==W;++E)T[E]+=_}return this}scale(_){if(_!==1){const T=this.times;for(let E=0,W=T.length;E!==W;++E)T[E]*=_}return this}trim(_,T){const E=this.times,W=E.length;let X=0,q=W-1;for(;X!==W&&E[X]<_;)++X;for(;q!==-1&&E[q]>T;)--q;if(++q,X!==0||q!==W){X>=q&&(q=Math.max(q,1),X=q-1);const Y=this.getValueSize();this.times=E.slice(X,q),this.values=this.values.slice(X*Y,q*Y)}return this}validate(){let _=!0;const T=this.getValueSize();T-Math.floor(T)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_=!1);const E=this.times,W=this.values,X=E.length;X===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_=!1);let q=null;for(let Y=0;Y!==X;Y++){const te=E[Y];if(typeof te=="number"&&isNaN(te)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,Y,te),_=!1;break}if(q!==null&&q>te){console.error("THREE.KeyframeTrack: Out of order keys.",this,Y,te,q),_=!1;break}q=te}if(W!==void 0&&isTypedArray(W))for(let Y=0,te=W.length;Y!==te;++Y){const ne=W[Y];if(isNaN(ne)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,Y,ne),_=!1;break}}return _}optimize(){const _=this.times.slice(),T=this.values.slice(),E=this.getValueSize(),W=this.getInterpolation()===InterpolateSmooth,X=_.length-1;let q=1;for(let Y=1;Y<X;++Y){let te=!1;const ne=_[Y],ae=_[Y+1];if(ne!==ae&&(Y!==1||ne!==_[0]))if(W)te=!0;else{const le=Y*E,ue=le-E,ge=le+E;for(let ye=0;ye!==E;++ye){const xe=T[le+ye];if(xe!==T[ue+ye]||xe!==T[ge+ye]){te=!0;break}}}if(te){if(Y!==q){_[q]=_[Y];const le=Y*E,ue=q*E;for(let ge=0;ge!==E;++ge)T[ue+ge]=T[le+ge]}++q}}if(X>0){_[q]=_[X];for(let Y=X*E,te=q*E,ne=0;ne!==E;++ne)T[te+ne]=T[Y+ne];++q}return q!==_.length?(this.times=_.slice(0,q),this.values=T.slice(0,q*E)):(this.times=_,this.values=T),this}clone(){const _=this.times.slice(),T=this.values.slice(),E=this.constructor,W=new E(this.name,_,T);return W.createInterpolant=this.createInterpolant,W}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_,T,E,W){super(_,T,E,W)}interpolate_(_,T,E,W){const X=this.resultBuffer,q=this.sampleValues,Y=this.valueSize,te=(E-T)/(W-T);let ne=_*Y;for(let ae=ne+Y;ne!==ae;ne+=4)Quaternion.slerpFlat(X,0,q,ne-Y,q,ne,te);return X}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_="",T=-1,E=[],W=NormalAnimationBlendMode){this.name=_,this.tracks=E,this.duration=T,this.blendMode=W,this.uuid=generateUUID(),this.duration<0&&this.resetDuration()}static parse(_){const T=[],E=_.tracks,W=1/(_.fps||1);for(let q=0,Y=E.length;q!==Y;++q)T.push(parseKeyframeTrack(E[q]).scale(W));const X=new this(_.name,_.duration,T,_.blendMode);return X.uuid=_.uuid,X}static toJSON(_){const T=[],E=_.tracks,W={name:_.name,duration:_.duration,tracks:T,uuid:_.uuid,blendMode:_.blendMode};for(let X=0,q=E.length;X!==q;++X)T.push(KeyframeTrack.toJSON(E[X]));return W}static CreateFromMorphTargetSequence(_,T,E,W){const X=T.length,q=[];for(let Y=0;Y<X;Y++){let te=[],ne=[];te.push((Y+X-1)%X,Y,(Y+1)%X),ne.push(0,1,0);const ae=getKeyframeOrder(te);te=sortedArray(te,1,ae),ne=sortedArray(ne,1,ae),!W&&te[0]===0&&(te.push(X),ne.push(ne[0])),q.push(new NumberKeyframeTrack(".morphTargetInfluences["+T[Y].name+"]",te,ne).scale(1/E))}return new this(_,-1,q)}static findByName(_,T){let E=_;if(!Array.isArray(_)){const W=_;E=W.geometry&&W.geometry.animations||W.animations}for(let W=0;W<E.length;W++)if(E[W].name===T)return E[W];return null}static CreateClipsFromMorphTargetSequences(_,T,E){const W={},X=/^([\w-]*?)([\d]+)$/;for(let Y=0,te=_.length;Y<te;Y++){const ne=_[Y],ae=ne.name.match(X);if(ae&&ae.length>1){const le=ae[1];let ue=W[le];ue||(W[le]=ue=[]),ue.push(ne)}}const q=[];for(const Y in W)q.push(this.CreateFromMorphTargetSequence(Y,W[Y],T,E));return q}static parseAnimation(_,T){if(!_)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const E=function(le,ue,ge,ye,xe){if(ge.length!==0){const Te=[],Ae=[];flattenJSON(ge,Te,Ae,ye),Te.length!==0&&xe.push(new le(ue,Te,Ae))}},W=[],X=_.name||"default",q=_.fps||30,Y=_.blendMode;let te=_.length||-1;const ne=_.hierarchy||[];for(let le=0;le<ne.length;le++){const ue=ne[le].keys;if(!(!ue||ue.length===0))if(ue[0].morphTargets){const ge={};let ye;for(ye=0;ye<ue.length;ye++)if(ue[ye].morphTargets)for(let xe=0;xe<ue[ye].morphTargets.length;xe++)ge[ue[ye].morphTargets[xe]]=-1;for(const xe in ge){const Te=[],Ae=[];for(let Ie=0;Ie!==ue[ye].morphTargets.length;++Ie){const Ve=ue[ye];Te.push(Ve.time),Ae.push(Ve.morphTarget===xe?1:0)}W.push(new NumberKeyframeTrack(".morphTargetInfluence["+xe+"]",Te,Ae))}te=ge.length*q}else{const ge=".bones["+T[le].name+"]";E(VectorKeyframeTrack,ge+".position",ue,"pos",W),E(QuaternionKeyframeTrack,ge+".quaternion",ue,"rot",W),E(VectorKeyframeTrack,ge+".scale",ue,"scl",W)}}return W.length===0?null:new this(X,te,W,Y)}resetDuration(){const _=this.tracks;let T=0;for(let E=0,W=_.length;E!==W;++E){const X=this.tracks[E];T=Math.max(T,X.times[X.times.length-1])}return this.duration=T,this}trim(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].trim(0,this.duration);return this}validate(){let _=!0;for(let T=0;T<this.tracks.length;T++)_=_&&this.tracks[T].validate();return _}optimize(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].optimize();return this}clone(){const _=[];for(let T=0;T<this.tracks.length;T++)_.push(this.tracks[T].clone());return new this.constructor(this.name,this.duration,_,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(B){switch(B.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+B)}function parseKeyframeTrack(B){if(B.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _=getTrackTypeForValueTypeName(B.type);if(B.times===void 0){const T=[],E=[];flattenJSON(B.keys,T,E,"value"),B.times=T,B.values=E}return _.parse!==void 0?_.parse(B):new _(B.name,B.times,B.values,B.interpolation)}const Cache={enabled:!1,files:{},add:function(B,_){this.enabled!==!1&&(this.files[B]=_)},get:function(B){if(this.enabled!==!1)return this.files[B]},remove:function(B){delete this.files[B]},clear:function(){this.files={}}};class LoadingManager{constructor(_,T,E){const W=this;let X=!1,q=0,Y=0,te;const ne=[];this.onStart=void 0,this.onLoad=_,this.onProgress=T,this.onError=E,this.itemStart=function(ae){Y++,X===!1&&W.onStart!==void 0&&W.onStart(ae,q,Y),X=!0},this.itemEnd=function(ae){q++,W.onProgress!==void 0&&W.onProgress(ae,q,Y),q===Y&&(X=!1,W.onLoad!==void 0&&W.onLoad())},this.itemError=function(ae){W.onError!==void 0&&W.onError(ae)},this.resolveURL=function(ae){return te?te(ae):ae},this.setURLModifier=function(ae){return te=ae,this},this.addHandler=function(ae,le){return ne.push(ae,le),this},this.removeHandler=function(ae){const le=ne.indexOf(ae);return le!==-1&&ne.splice(le,2),this},this.getHandler=function(ae){for(let le=0,ue=ne.length;le<ue;le+=2){const ge=ne[le],ye=ne[le+1];if(ge.global&&(ge.lastIndex=0),ge.test(ae))return ye}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_){this.manager=_!==void 0?_:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_,T){const E=this;return new Promise(function(W,X){E.load(_,W,T,X)})}parse(){}setCrossOrigin(_){return this.crossOrigin=_,this}setWithCredentials(_){return this.withCredentials=_,this}setPath(_){return this.path=_,this}setResourcePath(_){return this.resourcePath=_,this}setRequestHeader(_){return this.requestHeader=_,this}}Loader.DEFAULT_MATERIAL_NAME="__DEFAULT";const loading={};class HttpError extends Error{constructor(_,T){super(_),this.response=T}}class FileLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const X=Cache.get(_);if(X!==void 0)return this.manager.itemStart(_),setTimeout(()=>{T&&T(X),this.manager.itemEnd(_)},0),X;if(loading[_]!==void 0){loading[_].push({onLoad:T,onProgress:E,onError:W});return}loading[_]=[],loading[_].push({onLoad:T,onProgress:E,onError:W});const q=new Request(_,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),Y=this.mimeType,te=this.responseType;fetch(q).then(ne=>{if(ne.status===200||ne.status===0){if(ne.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||ne.body===void 0||ne.body.getReader===void 0)return ne;const ae=loading[_],le=ne.body.getReader(),ue=ne.headers.get("X-File-Size")||ne.headers.get("Content-Length"),ge=ue?parseInt(ue):0,ye=ge!==0;let xe=0;const Te=new ReadableStream({start(Ae){Ie();function Ie(){le.read().then(({done:Ve,value:$e})=>{if(Ve)Ae.close();else{xe+=$e.byteLength;const We=new ProgressEvent("progress",{lengthComputable:ye,loaded:xe,total:ge});for(let Ue=0,je=ae.length;Ue<je;Ue++){const ze=ae[Ue];ze.onProgress&&ze.onProgress(We)}Ae.enqueue($e),Ie()}})}}});return new Response(Te)}else throw new HttpError(`fetch for "${ne.url}" responded with ${ne.status}: ${ne.statusText}`,ne)}).then(ne=>{switch(te){case"arraybuffer":return ne.arrayBuffer();case"blob":return ne.blob();case"document":return ne.text().then(ae=>new DOMParser().parseFromString(ae,Y));case"json":return ne.json();default:if(Y===void 0)return ne.text();{const le=/charset="?([^;"\s]*)"?/i.exec(Y),ue=le&&le[1]?le[1].toLowerCase():void 0,ge=new TextDecoder(ue);return ne.arrayBuffer().then(ye=>ge.decode(ye))}}}).then(ne=>{Cache.add(_,ne);const ae=loading[_];delete loading[_];for(let le=0,ue=ae.length;le<ue;le++){const ge=ae[le];ge.onLoad&&ge.onLoad(ne)}}).catch(ne=>{const ae=loading[_];if(ae===void 0)throw this.manager.itemError(_),ne;delete loading[_];for(let le=0,ue=ae.length;le<ue;le++){const ge=ae[le];ge.onError&&ge.onError(ne)}this.manager.itemError(_)}).finally(()=>{this.manager.itemEnd(_)}),this.manager.itemStart(_)}setResponseType(_){return this.responseType=_,this}setMimeType(_){return this.mimeType=_,this}}class AnimationLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=this,q=new FileLoader(this.manager);q.setPath(this.path),q.setRequestHeader(this.requestHeader),q.setWithCredentials(this.withCredentials),q.load(_,function(Y){try{T(X.parse(JSON.parse(Y)))}catch(te){W?W(te):console.error(te),X.manager.itemError(_)}},E,W)}parse(_){const T=[];for(let E=0;E<_.length;E++){const W=AnimationClip.parse(_[E]);T.push(W)}return T}}class CompressedTextureLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=this,q=[],Y=new CompressedTexture,te=new FileLoader(this.manager);te.setPath(this.path),te.setResponseType("arraybuffer"),te.setRequestHeader(this.requestHeader),te.setWithCredentials(X.withCredentials);let ne=0;function ae(le){te.load(_[le],function(ue){const ge=X.parse(ue,!0);q[le]={width:ge.width,height:ge.height,format:ge.format,mipmaps:ge.mipmaps},ne+=1,ne===6&&(ge.mipmapCount===1&&(Y.minFilter=LinearFilter),Y.image=q,Y.format=ge.format,Y.needsUpdate=!0,T&&T(Y))},E,W)}if(Array.isArray(_))for(let le=0,ue=_.length;le<ue;++le)ae(le);else te.load(_,function(le){const ue=X.parse(le,!0);if(ue.isCubemap){const ge=ue.mipmaps.length/ue.mipmapCount;for(let ye=0;ye<ge;ye++){q[ye]={mipmaps:[]};for(let xe=0;xe<ue.mipmapCount;xe++)q[ye].mipmaps.push(ue.mipmaps[ye*ue.mipmapCount+xe]),q[ye].format=ue.format,q[ye].width=ue.width,q[ye].height=ue.height}Y.image=q}else Y.image.width=ue.width,Y.image.height=ue.height,Y.mipmaps=ue.mipmaps;ue.mipmapCount===1&&(Y.minFilter=LinearFilter),Y.format=ue.format,Y.needsUpdate=!0,T&&T(Y)},E,W);return Y}}class ImageLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const X=this,q=Cache.get(_);if(q!==void 0)return X.manager.itemStart(_),setTimeout(function(){T&&T(q),X.manager.itemEnd(_)},0),q;const Y=createElementNS("img");function te(){ae(),Cache.add(_,this),T&&T(this),X.manager.itemEnd(_)}function ne(le){ae(),W&&W(le),X.manager.itemError(_),X.manager.itemEnd(_)}function ae(){Y.removeEventListener("load",te,!1),Y.removeEventListener("error",ne,!1)}return Y.addEventListener("load",te,!1),Y.addEventListener("error",ne,!1),_.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(Y.crossOrigin=this.crossOrigin),X.manager.itemStart(_),Y.src=_,Y}}class CubeTextureLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=new CubeTexture;X.colorSpace=SRGBColorSpace;const q=new ImageLoader(this.manager);q.setCrossOrigin(this.crossOrigin),q.setPath(this.path);let Y=0;function te(ne){q.load(_[ne],function(ae){X.images[ne]=ae,Y++,Y===6&&(X.needsUpdate=!0,T&&T(X))},void 0,W)}for(let ne=0;ne<_.length;++ne)te(ne);return X}}class DataTextureLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=this,q=new DataTexture,Y=new FileLoader(this.manager);return Y.setResponseType("arraybuffer"),Y.setRequestHeader(this.requestHeader),Y.setPath(this.path),Y.setWithCredentials(X.withCredentials),Y.load(_,function(te){let ne;try{ne=X.parse(te)}catch(ae){if(W!==void 0)W(ae);else{console.error(ae);return}}ne.image!==void 0?q.image=ne.image:ne.data!==void 0&&(q.image.width=ne.width,q.image.height=ne.height,q.image.data=ne.data),q.wrapS=ne.wrapS!==void 0?ne.wrapS:ClampToEdgeWrapping,q.wrapT=ne.wrapT!==void 0?ne.wrapT:ClampToEdgeWrapping,q.magFilter=ne.magFilter!==void 0?ne.magFilter:LinearFilter,q.minFilter=ne.minFilter!==void 0?ne.minFilter:LinearFilter,q.anisotropy=ne.anisotropy!==void 0?ne.anisotropy:1,ne.colorSpace!==void 0&&(q.colorSpace=ne.colorSpace),ne.flipY!==void 0&&(q.flipY=ne.flipY),ne.format!==void 0&&(q.format=ne.format),ne.type!==void 0&&(q.type=ne.type),ne.mipmaps!==void 0&&(q.mipmaps=ne.mipmaps,q.minFilter=LinearMipmapLinearFilter),ne.mipmapCount===1&&(q.minFilter=LinearFilter),ne.generateMipmaps!==void 0&&(q.generateMipmaps=ne.generateMipmaps),q.needsUpdate=!0,T&&T(q,ne)},E,W),q}}class TextureLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=new Texture,q=new ImageLoader(this.manager);return q.setCrossOrigin(this.crossOrigin),q.setPath(this.path),q.load(_,function(Y){X.image=Y,X.needsUpdate=!0,T!==void 0&&T(X)},E,W),X}}class Light extends Object3D{constructor(_,T=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(_),this.intensity=T}dispose(){}copy(_,T){return super.copy(_,T),this.color.copy(_.color),this.intensity=_.intensity,this}toJSON(_){const T=super.toJSON(_);return T.object.color=this.color.getHex(),T.object.intensity=this.intensity,this.groundColor!==void 0&&(T.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(T.object.distance=this.distance),this.angle!==void 0&&(T.object.angle=this.angle),this.decay!==void 0&&(T.object.decay=this.decay),this.penumbra!==void 0&&(T.object.penumbra=this.penumbra),this.shadow!==void 0&&(T.object.shadow=this.shadow.toJSON()),T}}class HemisphereLight extends Light{constructor(_,T,E){super(_,E),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color(T)}copy(_,T){return super.copy(_,T),this.groundColor.copy(_.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_){this.camera=_,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_){const T=this.camera,E=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_.matrixWorld),T.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_.target.matrixWorld),T.lookAt(_lookTarget$1),T.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(T.projectionMatrix,T.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(_projScreenMatrix$1)}getViewport(_){return this._viewports[_]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_){return this.camera=_.camera.clone(),this.bias=_.bias,this.radius=_.radius,this.mapSize.copy(_.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _={};return this.bias!==0&&(_.bias=this.bias),this.normalBias!==0&&(_.normalBias=this.normalBias),this.radius!==1&&(_.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_.mapSize=this.mapSize.toArray()),_.camera=this.camera.toJSON(!1).object,delete _.camera.matrix,_}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_){const T=this.camera,E=RAD2DEG*2*_.angle*this.focus,W=this.mapSize.width/this.mapSize.height,X=_.distance||T.far;(E!==T.fov||W!==T.aspect||X!==T.far)&&(T.fov=E,T.aspect=W,T.far=X,T.updateProjectionMatrix()),super.updateMatrices(_)}copy(_){return super.copy(_),this.focus=_.focus,this}}class SpotLight extends Light{constructor(_,T,E=0,W=Math.PI/3,X=0,q=2){super(_,T),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=E,this.angle=W,this.penumbra=X,this.decay=q,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_){this.intensity=_/Math.PI}dispose(){this.shadow.dispose()}copy(_,T){return super.copy(_,T),this.distance=_.distance,this.angle=_.angle,this.penumbra=_.penumbra,this.decay=_.decay,this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_,T=0){const E=this.camera,W=this.matrix,X=_.distance||E.far;X!==E.far&&(E.far=X,E.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_.matrixWorld),E.position.copy(_lightPositionWorld),_lookTarget.copy(E.position),_lookTarget.add(this._cubeDirections[T]),E.up.copy(this._cubeUps[T]),E.lookAt(_lookTarget),E.updateMatrixWorld(),W.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(_,T,E=0,W=2){super(_,T),this.isPointLight=!0,this.type="PointLight",this.distance=E,this.decay=W,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_){this.intensity=_/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_,T){return super.copy(_,T),this.distance=_.distance,this.decay=_.decay,this.shadow=_.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_,T){super(_,T),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_){return super.copy(_),this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}class AmbientLight extends Light{constructor(_,T){super(_,T),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(_,T,E=10,W=10){super(_,T),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=E,this.height=W}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_){this.intensity=_/(this.width*this.height*Math.PI)}copy(_){return super.copy(_),this.width=_.width,this.height=_.height,this}toJSON(_){const T=super.toJSON(_);return T.object.width=this.width,T.object.height=this.height,T}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _=0;_<9;_++)this.coefficients.push(new Vector3)}set(_){for(let T=0;T<9;T++)this.coefficients[T].copy(_[T]);return this}zero(){for(let _=0;_<9;_++)this.coefficients[_].set(0,0,0);return this}getAt(_,T){const E=_.x,W=_.y,X=_.z,q=this.coefficients;return T.copy(q[0]).multiplyScalar(.282095),T.addScaledVector(q[1],.488603*W),T.addScaledVector(q[2],.488603*X),T.addScaledVector(q[3],.488603*E),T.addScaledVector(q[4],1.092548*(E*W)),T.addScaledVector(q[5],1.092548*(W*X)),T.addScaledVector(q[6],.315392*(3*X*X-1)),T.addScaledVector(q[7],1.092548*(E*X)),T.addScaledVector(q[8],.546274*(E*E-W*W)),T}getIrradianceAt(_,T){const E=_.x,W=_.y,X=_.z,q=this.coefficients;return T.copy(q[0]).multiplyScalar(.886227),T.addScaledVector(q[1],2*.511664*W),T.addScaledVector(q[2],2*.511664*X),T.addScaledVector(q[3],2*.511664*E),T.addScaledVector(q[4],2*.429043*E*W),T.addScaledVector(q[5],2*.429043*W*X),T.addScaledVector(q[6],.743125*X*X-.247708),T.addScaledVector(q[7],2*.429043*E*X),T.addScaledVector(q[8],.429043*(E*E-W*W)),T}add(_){for(let T=0;T<9;T++)this.coefficients[T].add(_.coefficients[T]);return this}addScaledSH(_,T){for(let E=0;E<9;E++)this.coefficients[E].addScaledVector(_.coefficients[E],T);return this}scale(_){for(let T=0;T<9;T++)this.coefficients[T].multiplyScalar(_);return this}lerp(_,T){for(let E=0;E<9;E++)this.coefficients[E].lerp(_.coefficients[E],T);return this}equals(_){for(let T=0;T<9;T++)if(!this.coefficients[T].equals(_.coefficients[T]))return!1;return!0}copy(_){return this.set(_.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_,T=0){const E=this.coefficients;for(let W=0;W<9;W++)E[W].fromArray(_,T+W*3);return this}toArray(_=[],T=0){const E=this.coefficients;for(let W=0;W<9;W++)E[W].toArray(_,T+W*3);return _}static getBasisAt(_,T){const E=_.x,W=_.y,X=_.z;T[0]=.282095,T[1]=.488603*W,T[2]=.488603*X,T[3]=.488603*E,T[4]=1.092548*E*W,T[5]=1.092548*W*X,T[6]=.315392*(3*X*X-1),T[7]=1.092548*E*X,T[8]=.546274*(E*E-W*W)}}class LightProbe extends Light{constructor(_=new SphericalHarmonics3,T=1){super(void 0,T),this.isLightProbe=!0,this.sh=_}copy(_){return super.copy(_),this.sh.copy(_.sh),this}fromJSON(_){return this.intensity=_.intensity,this.sh.fromArray(_.sh),this}toJSON(_){const T=super.toJSON(_);return T.object.sh=this.sh.toArray(),T}}class MaterialLoader extends Loader{constructor(_){super(_),this.textures={}}load(_,T,E,W){const X=this,q=new FileLoader(X.manager);q.setPath(X.path),q.setRequestHeader(X.requestHeader),q.setWithCredentials(X.withCredentials),q.load(_,function(Y){try{T(X.parse(JSON.parse(Y)))}catch(te){W?W(te):console.error(te),X.manager.itemError(_)}},E,W)}parse(_){const T=this.textures;function E(X){return T[X]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",X),T[X]}const W=MaterialLoader.createMaterialFromType(_.type);if(_.uuid!==void 0&&(W.uuid=_.uuid),_.name!==void 0&&(W.name=_.name),_.color!==void 0&&W.color!==void 0&&W.color.setHex(_.color),_.roughness!==void 0&&(W.roughness=_.roughness),_.metalness!==void 0&&(W.metalness=_.metalness),_.sheen!==void 0&&(W.sheen=_.sheen),_.sheenColor!==void 0&&(W.sheenColor=new Color().setHex(_.sheenColor)),_.sheenRoughness!==void 0&&(W.sheenRoughness=_.sheenRoughness),_.emissive!==void 0&&W.emissive!==void 0&&W.emissive.setHex(_.emissive),_.specular!==void 0&&W.specular!==void 0&&W.specular.setHex(_.specular),_.specularIntensity!==void 0&&(W.specularIntensity=_.specularIntensity),_.specularColor!==void 0&&W.specularColor!==void 0&&W.specularColor.setHex(_.specularColor),_.shininess!==void 0&&(W.shininess=_.shininess),_.clearcoat!==void 0&&(W.clearcoat=_.clearcoat),_.clearcoatRoughness!==void 0&&(W.clearcoatRoughness=_.clearcoatRoughness),_.dispersion!==void 0&&(W.dispersion=_.dispersion),_.iridescence!==void 0&&(W.iridescence=_.iridescence),_.iridescenceIOR!==void 0&&(W.iridescenceIOR=_.iridescenceIOR),_.iridescenceThicknessRange!==void 0&&(W.iridescenceThicknessRange=_.iridescenceThicknessRange),_.transmission!==void 0&&(W.transmission=_.transmission),_.thickness!==void 0&&(W.thickness=_.thickness),_.attenuationDistance!==void 0&&(W.attenuationDistance=_.attenuationDistance),_.attenuationColor!==void 0&&W.attenuationColor!==void 0&&W.attenuationColor.setHex(_.attenuationColor),_.anisotropy!==void 0&&(W.anisotropy=_.anisotropy),_.anisotropyRotation!==void 0&&(W.anisotropyRotation=_.anisotropyRotation),_.fog!==void 0&&(W.fog=_.fog),_.flatShading!==void 0&&(W.flatShading=_.flatShading),_.blending!==void 0&&(W.blending=_.blending),_.combine!==void 0&&(W.combine=_.combine),_.side!==void 0&&(W.side=_.side),_.shadowSide!==void 0&&(W.shadowSide=_.shadowSide),_.opacity!==void 0&&(W.opacity=_.opacity),_.transparent!==void 0&&(W.transparent=_.transparent),_.alphaTest!==void 0&&(W.alphaTest=_.alphaTest),_.alphaHash!==void 0&&(W.alphaHash=_.alphaHash),_.depthFunc!==void 0&&(W.depthFunc=_.depthFunc),_.depthTest!==void 0&&(W.depthTest=_.depthTest),_.depthWrite!==void 0&&(W.depthWrite=_.depthWrite),_.colorWrite!==void 0&&(W.colorWrite=_.colorWrite),_.blendSrc!==void 0&&(W.blendSrc=_.blendSrc),_.blendDst!==void 0&&(W.blendDst=_.blendDst),_.blendEquation!==void 0&&(W.blendEquation=_.blendEquation),_.blendSrcAlpha!==void 0&&(W.blendSrcAlpha=_.blendSrcAlpha),_.blendDstAlpha!==void 0&&(W.blendDstAlpha=_.blendDstAlpha),_.blendEquationAlpha!==void 0&&(W.blendEquationAlpha=_.blendEquationAlpha),_.blendColor!==void 0&&W.blendColor!==void 0&&W.blendColor.setHex(_.blendColor),_.blendAlpha!==void 0&&(W.blendAlpha=_.blendAlpha),_.stencilWriteMask!==void 0&&(W.stencilWriteMask=_.stencilWriteMask),_.stencilFunc!==void 0&&(W.stencilFunc=_.stencilFunc),_.stencilRef!==void 0&&(W.stencilRef=_.stencilRef),_.stencilFuncMask!==void 0&&(W.stencilFuncMask=_.stencilFuncMask),_.stencilFail!==void 0&&(W.stencilFail=_.stencilFail),_.stencilZFail!==void 0&&(W.stencilZFail=_.stencilZFail),_.stencilZPass!==void 0&&(W.stencilZPass=_.stencilZPass),_.stencilWrite!==void 0&&(W.stencilWrite=_.stencilWrite),_.wireframe!==void 0&&(W.wireframe=_.wireframe),_.wireframeLinewidth!==void 0&&(W.wireframeLinewidth=_.wireframeLinewidth),_.wireframeLinecap!==void 0&&(W.wireframeLinecap=_.wireframeLinecap),_.wireframeLinejoin!==void 0&&(W.wireframeLinejoin=_.wireframeLinejoin),_.rotation!==void 0&&(W.rotation=_.rotation),_.linewidth!==void 0&&(W.linewidth=_.linewidth),_.dashSize!==void 0&&(W.dashSize=_.dashSize),_.gapSize!==void 0&&(W.gapSize=_.gapSize),_.scale!==void 0&&(W.scale=_.scale),_.polygonOffset!==void 0&&(W.polygonOffset=_.polygonOffset),_.polygonOffsetFactor!==void 0&&(W.polygonOffsetFactor=_.polygonOffsetFactor),_.polygonOffsetUnits!==void 0&&(W.polygonOffsetUnits=_.polygonOffsetUnits),_.dithering!==void 0&&(W.dithering=_.dithering),_.alphaToCoverage!==void 0&&(W.alphaToCoverage=_.alphaToCoverage),_.premultipliedAlpha!==void 0&&(W.premultipliedAlpha=_.premultipliedAlpha),_.forceSinglePass!==void 0&&(W.forceSinglePass=_.forceSinglePass),_.visible!==void 0&&(W.visible=_.visible),_.toneMapped!==void 0&&(W.toneMapped=_.toneMapped),_.userData!==void 0&&(W.userData=_.userData),_.vertexColors!==void 0&&(typeof _.vertexColors=="number"?W.vertexColors=_.vertexColors>0:W.vertexColors=_.vertexColors),_.uniforms!==void 0)for(const X in _.uniforms){const q=_.uniforms[X];switch(W.uniforms[X]={},q.type){case"t":W.uniforms[X].value=E(q.value);break;case"c":W.uniforms[X].value=new Color().setHex(q.value);break;case"v2":W.uniforms[X].value=new Vector2().fromArray(q.value);break;case"v3":W.uniforms[X].value=new Vector3().fromArray(q.value);break;case"v4":W.uniforms[X].value=new Vector4().fromArray(q.value);break;case"m3":W.uniforms[X].value=new Matrix3().fromArray(q.value);break;case"m4":W.uniforms[X].value=new Matrix4().fromArray(q.value);break;default:W.uniforms[X].value=q.value}}if(_.defines!==void 0&&(W.defines=_.defines),_.vertexShader!==void 0&&(W.vertexShader=_.vertexShader),_.fragmentShader!==void 0&&(W.fragmentShader=_.fragmentShader),_.glslVersion!==void 0&&(W.glslVersion=_.glslVersion),_.extensions!==void 0)for(const X in _.extensions)W.extensions[X]=_.extensions[X];if(_.lights!==void 0&&(W.lights=_.lights),_.clipping!==void 0&&(W.clipping=_.clipping),_.size!==void 0&&(W.size=_.size),_.sizeAttenuation!==void 0&&(W.sizeAttenuation=_.sizeAttenuation),_.map!==void 0&&(W.map=E(_.map)),_.matcap!==void 0&&(W.matcap=E(_.matcap)),_.alphaMap!==void 0&&(W.alphaMap=E(_.alphaMap)),_.bumpMap!==void 0&&(W.bumpMap=E(_.bumpMap)),_.bumpScale!==void 0&&(W.bumpScale=_.bumpScale),_.normalMap!==void 0&&(W.normalMap=E(_.normalMap)),_.normalMapType!==void 0&&(W.normalMapType=_.normalMapType),_.normalScale!==void 0){let X=_.normalScale;Array.isArray(X)===!1&&(X=[X,X]),W.normalScale=new Vector2().fromArray(X)}return _.displacementMap!==void 0&&(W.displacementMap=E(_.displacementMap)),_.displacementScale!==void 0&&(W.displacementScale=_.displacementScale),_.displacementBias!==void 0&&(W.displacementBias=_.displacementBias),_.roughnessMap!==void 0&&(W.roughnessMap=E(_.roughnessMap)),_.metalnessMap!==void 0&&(W.metalnessMap=E(_.metalnessMap)),_.emissiveMap!==void 0&&(W.emissiveMap=E(_.emissiveMap)),_.emissiveIntensity!==void 0&&(W.emissiveIntensity=_.emissiveIntensity),_.specularMap!==void 0&&(W.specularMap=E(_.specularMap)),_.specularIntensityMap!==void 0&&(W.specularIntensityMap=E(_.specularIntensityMap)),_.specularColorMap!==void 0&&(W.specularColorMap=E(_.specularColorMap)),_.envMap!==void 0&&(W.envMap=E(_.envMap)),_.envMapRotation!==void 0&&W.envMapRotation.fromArray(_.envMapRotation),_.envMapIntensity!==void 0&&(W.envMapIntensity=_.envMapIntensity),_.reflectivity!==void 0&&(W.reflectivity=_.reflectivity),_.refractionRatio!==void 0&&(W.refractionRatio=_.refractionRatio),_.lightMap!==void 0&&(W.lightMap=E(_.lightMap)),_.lightMapIntensity!==void 0&&(W.lightMapIntensity=_.lightMapIntensity),_.aoMap!==void 0&&(W.aoMap=E(_.aoMap)),_.aoMapIntensity!==void 0&&(W.aoMapIntensity=_.aoMapIntensity),_.gradientMap!==void 0&&(W.gradientMap=E(_.gradientMap)),_.clearcoatMap!==void 0&&(W.clearcoatMap=E(_.clearcoatMap)),_.clearcoatRoughnessMap!==void 0&&(W.clearcoatRoughnessMap=E(_.clearcoatRoughnessMap)),_.clearcoatNormalMap!==void 0&&(W.clearcoatNormalMap=E(_.clearcoatNormalMap)),_.clearcoatNormalScale!==void 0&&(W.clearcoatNormalScale=new Vector2().fromArray(_.clearcoatNormalScale)),_.iridescenceMap!==void 0&&(W.iridescenceMap=E(_.iridescenceMap)),_.iridescenceThicknessMap!==void 0&&(W.iridescenceThicknessMap=E(_.iridescenceThicknessMap)),_.transmissionMap!==void 0&&(W.transmissionMap=E(_.transmissionMap)),_.thicknessMap!==void 0&&(W.thicknessMap=E(_.thicknessMap)),_.anisotropyMap!==void 0&&(W.anisotropyMap=E(_.anisotropyMap)),_.sheenColorMap!==void 0&&(W.sheenColorMap=E(_.sheenColorMap)),_.sheenRoughnessMap!==void 0&&(W.sheenRoughnessMap=E(_.sheenRoughnessMap)),W}setTextures(_){return this.textures=_,this}static createMaterialFromType(_){const T={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new T[_]}}class LoaderUtils{static decodeText(_){if(typeof TextDecoder<"u")return new TextDecoder().decode(_);let T="";for(let E=0,W=_.length;E<W;E++)T+=String.fromCharCode(_[E]);try{return decodeURIComponent(escape(T))}catch{return T}}static extractUrlBase(_){const T=_.lastIndexOf("/");return T===-1?"./":_.slice(0,T+1)}static resolveURL(_,T){return typeof _!="string"||_===""?"":(/^https?:\/\//i.test(T)&&/^\//.test(_)&&(T=T.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_)||/^data:.*,.*$/i.test(_)||/^blob:.*$/i.test(_)?_:T+_)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_){return super.copy(_),this.instanceCount=_.instanceCount,this}toJSON(){const _=super.toJSON();return _.instanceCount=this.instanceCount,_.isInstancedBufferGeometry=!0,_}}class BufferGeometryLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=this,q=new FileLoader(X.manager);q.setPath(X.path),q.setRequestHeader(X.requestHeader),q.setWithCredentials(X.withCredentials),q.load(_,function(Y){try{T(X.parse(JSON.parse(Y)))}catch(te){W?W(te):console.error(te),X.manager.itemError(_)}},E,W)}parse(_){const T={},E={};function W(ge,ye){if(T[ye]!==void 0)return T[ye];const Te=ge.interleavedBuffers[ye],Ae=X(ge,Te.buffer),Ie=getTypedArray(Te.type,Ae),Ve=new InterleavedBuffer(Ie,Te.stride);return Ve.uuid=Te.uuid,T[ye]=Ve,Ve}function X(ge,ye){if(E[ye]!==void 0)return E[ye];const Te=ge.arrayBuffers[ye],Ae=new Uint32Array(Te).buffer;return E[ye]=Ae,Ae}const q=_.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,Y=_.data.index;if(Y!==void 0){const ge=getTypedArray(Y.type,Y.array);q.setIndex(new BufferAttribute(ge,1))}const te=_.data.attributes;for(const ge in te){const ye=te[ge];let xe;if(ye.isInterleavedBufferAttribute){const Te=W(_.data,ye.data);xe=new InterleavedBufferAttribute(Te,ye.itemSize,ye.offset,ye.normalized)}else{const Te=getTypedArray(ye.type,ye.array),Ae=ye.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;xe=new Ae(Te,ye.itemSize,ye.normalized)}ye.name!==void 0&&(xe.name=ye.name),ye.usage!==void 0&&xe.setUsage(ye.usage),q.setAttribute(ge,xe)}const ne=_.data.morphAttributes;if(ne)for(const ge in ne){const ye=ne[ge],xe=[];for(let Te=0,Ae=ye.length;Te<Ae;Te++){const Ie=ye[Te];let Ve;if(Ie.isInterleavedBufferAttribute){const $e=W(_.data,Ie.data);Ve=new InterleavedBufferAttribute($e,Ie.itemSize,Ie.offset,Ie.normalized)}else{const $e=getTypedArray(Ie.type,Ie.array);Ve=new BufferAttribute($e,Ie.itemSize,Ie.normalized)}Ie.name!==void 0&&(Ve.name=Ie.name),xe.push(Ve)}q.morphAttributes[ge]=xe}_.data.morphTargetsRelative&&(q.morphTargetsRelative=!0);const le=_.data.groups||_.data.drawcalls||_.data.offsets;if(le!==void 0)for(let ge=0,ye=le.length;ge!==ye;++ge){const xe=le[ge];q.addGroup(xe.start,xe.count,xe.materialIndex)}const ue=_.data.boundingSphere;if(ue!==void 0){const ge=new Vector3;ue.center!==void 0&&ge.fromArray(ue.center),q.boundingSphere=new Sphere(ge,ue.radius)}return _.name&&(q.name=_.name),_.userData&&(q.userData=_.userData),q}}class ObjectLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=this,q=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||q;const Y=new FileLoader(this.manager);Y.setPath(this.path),Y.setRequestHeader(this.requestHeader),Y.setWithCredentials(this.withCredentials),Y.load(_,function(te){let ne=null;try{ne=JSON.parse(te)}catch(le){W!==void 0&&W(le),console.error("THREE:ObjectLoader: Can't parse "+_+".",le.message);return}const ae=ne.metadata;if(ae===void 0||ae.type===void 0||ae.type.toLowerCase()==="geometry"){W!==void 0&&W(new Error("THREE.ObjectLoader: Can't load "+_)),console.error("THREE.ObjectLoader: Can't load "+_);return}X.parse(ne,T)},E,W)}async loadAsync(_,T){const E=this,W=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||W;const X=new FileLoader(this.manager);X.setPath(this.path),X.setRequestHeader(this.requestHeader),X.setWithCredentials(this.withCredentials);const q=await X.loadAsync(_,T),Y=JSON.parse(q),te=Y.metadata;if(te===void 0||te.type===void 0||te.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_);return await E.parseAsync(Y)}parse(_,T){const E=this.parseAnimations(_.animations),W=this.parseShapes(_.shapes),X=this.parseGeometries(_.geometries,W),q=this.parseImages(_.images,function(){T!==void 0&&T(ne)}),Y=this.parseTextures(_.textures,q),te=this.parseMaterials(_.materials,Y),ne=this.parseObject(_.object,X,te,Y,E),ae=this.parseSkeletons(_.skeletons,ne);if(this.bindSkeletons(ne,ae),T!==void 0){let le=!1;for(const ue in q)if(q[ue].data instanceof HTMLImageElement){le=!0;break}le===!1&&T(ne)}return ne}async parseAsync(_){const T=this.parseAnimations(_.animations),E=this.parseShapes(_.shapes),W=this.parseGeometries(_.geometries,E),X=await this.parseImagesAsync(_.images),q=this.parseTextures(_.textures,X),Y=this.parseMaterials(_.materials,q),te=this.parseObject(_.object,W,Y,q,T),ne=this.parseSkeletons(_.skeletons,te);return this.bindSkeletons(te,ne),te}parseShapes(_){const T={};if(_!==void 0)for(let E=0,W=_.length;E<W;E++){const X=new Shape$1().fromJSON(_[E]);T[X.uuid]=X}return T}parseSkeletons(_,T){const E={},W={};if(T.traverse(function(X){X.isBone&&(W[X.uuid]=X)}),_!==void 0)for(let X=0,q=_.length;X<q;X++){const Y=new Skeleton().fromJSON(_[X],W);E[Y.uuid]=Y}return E}parseGeometries(_,T){const E={};if(_!==void 0){const W=new BufferGeometryLoader;for(let X=0,q=_.length;X<q;X++){let Y;const te=_[X];switch(te.type){case"BufferGeometry":case"InstancedBufferGeometry":Y=W.parse(te);break;default:te.type in Geometries?Y=Geometries[te.type].fromJSON(te,T):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${te.type}"`)}Y.uuid=te.uuid,te.name!==void 0&&(Y.name=te.name),te.userData!==void 0&&(Y.userData=te.userData),E[te.uuid]=Y}}return E}parseMaterials(_,T){const E={},W={};if(_!==void 0){const X=new MaterialLoader;X.setTextures(T);for(let q=0,Y=_.length;q<Y;q++){const te=_[q];E[te.uuid]===void 0&&(E[te.uuid]=X.parse(te)),W[te.uuid]=E[te.uuid]}}return W}parseAnimations(_){const T={};if(_!==void 0)for(let E=0;E<_.length;E++){const W=_[E],X=AnimationClip.parse(W);T[X.uuid]=X}return T}parseImages(_,T){const E=this,W={};let X;function q(te){return E.manager.itemStart(te),X.load(te,function(){E.manager.itemEnd(te)},void 0,function(){E.manager.itemError(te),E.manager.itemEnd(te)})}function Y(te){if(typeof te=="string"){const ne=te,ae=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ne)?ne:E.resourcePath+ne;return q(ae)}else return te.data?{data:getTypedArray(te.type,te.data),width:te.width,height:te.height}:null}if(_!==void 0&&_.length>0){const te=new LoadingManager(T);X=new ImageLoader(te),X.setCrossOrigin(this.crossOrigin);for(let ne=0,ae=_.length;ne<ae;ne++){const le=_[ne],ue=le.url;if(Array.isArray(ue)){const ge=[];for(let ye=0,xe=ue.length;ye<xe;ye++){const Te=ue[ye],Ae=Y(Te);Ae!==null&&(Ae instanceof HTMLImageElement?ge.push(Ae):ge.push(new DataTexture(Ae.data,Ae.width,Ae.height)))}W[le.uuid]=new Source(ge)}else{const ge=Y(le.url);W[le.uuid]=new Source(ge)}}}return W}async parseImagesAsync(_){const T=this,E={};let W;async function X(q){if(typeof q=="string"){const Y=q,te=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Y)?Y:T.resourcePath+Y;return await W.loadAsync(te)}else return q.data?{data:getTypedArray(q.type,q.data),width:q.width,height:q.height}:null}if(_!==void 0&&_.length>0){W=new ImageLoader(this.manager),W.setCrossOrigin(this.crossOrigin);for(let q=0,Y=_.length;q<Y;q++){const te=_[q],ne=te.url;if(Array.isArray(ne)){const ae=[];for(let le=0,ue=ne.length;le<ue;le++){const ge=ne[le],ye=await X(ge);ye!==null&&(ye instanceof HTMLImageElement?ae.push(ye):ae.push(new DataTexture(ye.data,ye.width,ye.height)))}E[te.uuid]=new Source(ae)}else{const ae=await X(te.url);E[te.uuid]=new Source(ae)}}}return E}parseTextures(_,T){function E(X,q){return typeof X=="number"?X:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",X),q[X])}const W={};if(_!==void 0)for(let X=0,q=_.length;X<q;X++){const Y=_[X];Y.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',Y.uuid),T[Y.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",Y.image);const te=T[Y.image],ne=te.data;let ae;Array.isArray(ne)?(ae=new CubeTexture,ne.length===6&&(ae.needsUpdate=!0)):(ne&&ne.data?ae=new DataTexture:ae=new Texture,ne&&(ae.needsUpdate=!0)),ae.source=te,ae.uuid=Y.uuid,Y.name!==void 0&&(ae.name=Y.name),Y.mapping!==void 0&&(ae.mapping=E(Y.mapping,TEXTURE_MAPPING)),Y.channel!==void 0&&(ae.channel=Y.channel),Y.offset!==void 0&&ae.offset.fromArray(Y.offset),Y.repeat!==void 0&&ae.repeat.fromArray(Y.repeat),Y.center!==void 0&&ae.center.fromArray(Y.center),Y.rotation!==void 0&&(ae.rotation=Y.rotation),Y.wrap!==void 0&&(ae.wrapS=E(Y.wrap[0],TEXTURE_WRAPPING),ae.wrapT=E(Y.wrap[1],TEXTURE_WRAPPING)),Y.format!==void 0&&(ae.format=Y.format),Y.internalFormat!==void 0&&(ae.internalFormat=Y.internalFormat),Y.type!==void 0&&(ae.type=Y.type),Y.colorSpace!==void 0&&(ae.colorSpace=Y.colorSpace),Y.minFilter!==void 0&&(ae.minFilter=E(Y.minFilter,TEXTURE_FILTER)),Y.magFilter!==void 0&&(ae.magFilter=E(Y.magFilter,TEXTURE_FILTER)),Y.anisotropy!==void 0&&(ae.anisotropy=Y.anisotropy),Y.flipY!==void 0&&(ae.flipY=Y.flipY),Y.generateMipmaps!==void 0&&(ae.generateMipmaps=Y.generateMipmaps),Y.premultiplyAlpha!==void 0&&(ae.premultiplyAlpha=Y.premultiplyAlpha),Y.unpackAlignment!==void 0&&(ae.unpackAlignment=Y.unpackAlignment),Y.compareFunction!==void 0&&(ae.compareFunction=Y.compareFunction),Y.userData!==void 0&&(ae.userData=Y.userData),W[Y.uuid]=ae}return W}parseObject(_,T,E,W,X){let q;function Y(ue){return T[ue]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",ue),T[ue]}function te(ue){if(ue!==void 0){if(Array.isArray(ue)){const ge=[];for(let ye=0,xe=ue.length;ye<xe;ye++){const Te=ue[ye];E[Te]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Te),ge.push(E[Te])}return ge}return E[ue]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",ue),E[ue]}}function ne(ue){return W[ue]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",ue),W[ue]}let ae,le;switch(_.type){case"Scene":q=new Scene,_.background!==void 0&&(Number.isInteger(_.background)?q.background=new Color(_.background):q.background=ne(_.background)),_.environment!==void 0&&(q.environment=ne(_.environment)),_.fog!==void 0&&(_.fog.type==="Fog"?q.fog=new Fog(_.fog.color,_.fog.near,_.fog.far):_.fog.type==="FogExp2"&&(q.fog=new FogExp2(_.fog.color,_.fog.density)),_.fog.name!==""&&(q.fog.name=_.fog.name)),_.backgroundBlurriness!==void 0&&(q.backgroundBlurriness=_.backgroundBlurriness),_.backgroundIntensity!==void 0&&(q.backgroundIntensity=_.backgroundIntensity),_.backgroundRotation!==void 0&&q.backgroundRotation.fromArray(_.backgroundRotation),_.environmentIntensity!==void 0&&(q.environmentIntensity=_.environmentIntensity),_.environmentRotation!==void 0&&q.environmentRotation.fromArray(_.environmentRotation);break;case"PerspectiveCamera":q=new PerspectiveCamera(_.fov,_.aspect,_.near,_.far),_.focus!==void 0&&(q.focus=_.focus),_.zoom!==void 0&&(q.zoom=_.zoom),_.filmGauge!==void 0&&(q.filmGauge=_.filmGauge),_.filmOffset!==void 0&&(q.filmOffset=_.filmOffset),_.view!==void 0&&(q.view=Object.assign({},_.view));break;case"OrthographicCamera":q=new OrthographicCamera(_.left,_.right,_.top,_.bottom,_.near,_.far),_.zoom!==void 0&&(q.zoom=_.zoom),_.view!==void 0&&(q.view=Object.assign({},_.view));break;case"AmbientLight":q=new AmbientLight(_.color,_.intensity);break;case"DirectionalLight":q=new DirectionalLight(_.color,_.intensity);break;case"PointLight":q=new PointLight(_.color,_.intensity,_.distance,_.decay);break;case"RectAreaLight":q=new RectAreaLight(_.color,_.intensity,_.width,_.height);break;case"SpotLight":q=new SpotLight(_.color,_.intensity,_.distance,_.angle,_.penumbra,_.decay);break;case"HemisphereLight":q=new HemisphereLight(_.color,_.groundColor,_.intensity);break;case"LightProbe":q=new LightProbe().fromJSON(_);break;case"SkinnedMesh":ae=Y(_.geometry),le=te(_.material),q=new SkinnedMesh(ae,le),_.bindMode!==void 0&&(q.bindMode=_.bindMode),_.bindMatrix!==void 0&&q.bindMatrix.fromArray(_.bindMatrix),_.skeleton!==void 0&&(q.skeleton=_.skeleton);break;case"Mesh":ae=Y(_.geometry),le=te(_.material),q=new Mesh(ae,le);break;case"InstancedMesh":ae=Y(_.geometry),le=te(_.material);const ue=_.count,ge=_.instanceMatrix,ye=_.instanceColor;q=new InstancedMesh(ae,le,ue),q.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ge.array),16),ye!==void 0&&(q.instanceColor=new InstancedBufferAttribute(new Float32Array(ye.array),ye.itemSize));break;case"BatchedMesh":ae=Y(_.geometry),le=te(_.material),q=new BatchedMesh(_.maxGeometryCount,_.maxVertexCount,_.maxIndexCount,le),q.geometry=ae,q.perObjectFrustumCulled=_.perObjectFrustumCulled,q.sortObjects=_.sortObjects,q._drawRanges=_.drawRanges,q._reservedRanges=_.reservedRanges,q._visibility=_.visibility,q._active=_.active,q._bounds=_.bounds.map(xe=>{const Te=new Box3;Te.min.fromArray(xe.boxMin),Te.max.fromArray(xe.boxMax);const Ae=new Sphere;return Ae.radius=xe.sphereRadius,Ae.center.fromArray(xe.sphereCenter),{boxInitialized:xe.boxInitialized,box:Te,sphereInitialized:xe.sphereInitialized,sphere:Ae}}),q._maxGeometryCount=_.maxGeometryCount,q._maxVertexCount=_.maxVertexCount,q._maxIndexCount=_.maxIndexCount,q._geometryInitialized=_.geometryInitialized,q._geometryCount=_.geometryCount,q._matricesTexture=ne(_.matricesTexture.uuid);break;case"LOD":q=new LOD;break;case"Line":q=new Line$1(Y(_.geometry),te(_.material));break;case"LineLoop":q=new LineLoop(Y(_.geometry),te(_.material));break;case"LineSegments":q=new LineSegments(Y(_.geometry),te(_.material));break;case"PointCloud":case"Points":q=new Points(Y(_.geometry),te(_.material));break;case"Sprite":q=new Sprite(te(_.material));break;case"Group":q=new Group$1;break;case"Bone":q=new Bone;break;default:q=new Object3D}if(q.uuid=_.uuid,_.name!==void 0&&(q.name=_.name),_.matrix!==void 0?(q.matrix.fromArray(_.matrix),_.matrixAutoUpdate!==void 0&&(q.matrixAutoUpdate=_.matrixAutoUpdate),q.matrixAutoUpdate&&q.matrix.decompose(q.position,q.quaternion,q.scale)):(_.position!==void 0&&q.position.fromArray(_.position),_.rotation!==void 0&&q.rotation.fromArray(_.rotation),_.quaternion!==void 0&&q.quaternion.fromArray(_.quaternion),_.scale!==void 0&&q.scale.fromArray(_.scale)),_.up!==void 0&&q.up.fromArray(_.up),_.castShadow!==void 0&&(q.castShadow=_.castShadow),_.receiveShadow!==void 0&&(q.receiveShadow=_.receiveShadow),_.shadow&&(_.shadow.bias!==void 0&&(q.shadow.bias=_.shadow.bias),_.shadow.normalBias!==void 0&&(q.shadow.normalBias=_.shadow.normalBias),_.shadow.radius!==void 0&&(q.shadow.radius=_.shadow.radius),_.shadow.mapSize!==void 0&&q.shadow.mapSize.fromArray(_.shadow.mapSize),_.shadow.camera!==void 0&&(q.shadow.camera=this.parseObject(_.shadow.camera))),_.visible!==void 0&&(q.visible=_.visible),_.frustumCulled!==void 0&&(q.frustumCulled=_.frustumCulled),_.renderOrder!==void 0&&(q.renderOrder=_.renderOrder),_.userData!==void 0&&(q.userData=_.userData),_.layers!==void 0&&(q.layers.mask=_.layers),_.children!==void 0){const ue=_.children;for(let ge=0;ge<ue.length;ge++)q.add(this.parseObject(ue[ge],T,E,W,X))}if(_.animations!==void 0){const ue=_.animations;for(let ge=0;ge<ue.length;ge++){const ye=ue[ge];q.animations.push(X[ye])}}if(_.type==="LOD"){_.autoUpdate!==void 0&&(q.autoUpdate=_.autoUpdate);const ue=_.levels;for(let ge=0;ge<ue.length;ge++){const ye=ue[ge],xe=q.getObjectByProperty("uuid",ye.object);xe!==void 0&&q.addLevel(xe,ye.distance,ye.hysteresis)}}return q}bindSkeletons(_,T){Object.keys(T).length!==0&&_.traverse(function(E){if(E.isSkinnedMesh===!0&&E.skeleton!==void 0){const W=T[E.skeleton];W===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",E.skeleton):E.bind(W,E.bindMatrix)}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(_){super(_),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_){return this.options=_,this}load(_,T,E,W){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const X=this,q=Cache.get(_);if(q!==void 0){if(X.manager.itemStart(_),q.then){q.then(ne=>{T&&T(ne),X.manager.itemEnd(_)}).catch(ne=>{W&&W(ne)});return}return setTimeout(function(){T&&T(q),X.manager.itemEnd(_)},0),q}const Y={};Y.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",Y.headers=this.requestHeader;const te=fetch(_,Y).then(function(ne){return ne.blob()}).then(function(ne){return createImageBitmap(ne,Object.assign(X.options,{colorSpaceConversion:"none"}))}).then(function(ne){return Cache.add(_,ne),T&&T(ne),X.manager.itemEnd(_),ne}).catch(function(ne){W&&W(ne),Cache.remove(_),X.manager.itemError(_),X.manager.itemEnd(_)});Cache.add(_,te),X.manager.itemStart(_)}}let _context;class AudioContext{static getContext(){return _context===void 0&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context}static setContext(_){_context=_}}class AudioLoader extends Loader{constructor(_){super(_)}load(_,T,E,W){const X=this,q=new FileLoader(this.manager);q.setResponseType("arraybuffer"),q.setPath(this.path),q.setRequestHeader(this.requestHeader),q.setWithCredentials(this.withCredentials),q.load(_,function(te){try{const ne=te.slice(0);AudioContext.getContext().decodeAudioData(ne,function(le){T(le)}).catch(Y)}catch(ne){Y(ne)}},E,W);function Y(te){W?W(te):console.error(te),X.manager.itemError(_)}}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_){const T=this._cache;if(T.focus!==_.focus||T.fov!==_.fov||T.aspect!==_.aspect*this.aspect||T.near!==_.near||T.far!==_.far||T.zoom!==_.zoom||T.eyeSep!==this.eyeSep){T.focus=_.focus,T.fov=_.fov,T.aspect=_.aspect*this.aspect,T.near=_.near,T.far=_.far,T.zoom=_.zoom,T.eyeSep=this.eyeSep,_projectionMatrix.copy(_.projectionMatrix);const W=T.eyeSep/2,X=W*T.near/T.focus,q=T.near*Math.tan(DEG2RAD*T.fov*.5)/T.zoom;let Y,te;_eyeLeft.elements[12]=-W,_eyeRight.elements[12]=W,Y=-q*T.aspect+X,te=q*T.aspect+X,_projectionMatrix.elements[0]=2*T.near/(te-Y),_projectionMatrix.elements[8]=(te+Y)/(te-Y),this.cameraL.projectionMatrix.copy(_projectionMatrix),Y=-q*T.aspect-X,te=q*T.aspect-X,_projectionMatrix.elements[0]=2*T.near/(te-Y),_projectionMatrix.elements[8]=(te+Y)/(te-Y),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_.matrixWorld).multiply(_eyeRight)}}class Clock{constructor(_=!0){this.autoStart=_,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now$2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const T=now$2();_=(T-this.oldTime)/1e3,this.oldTime=T,this.elapsedTime+=_}return _}}function now$2(){return(typeof performance>"u"?Date:performance).now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}updateMatrixWorld(_){super.updateMatrixWorld(_);const T=this.context.listener,E=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),T.positionX){const W=this.context.currentTime+this.timeDelta;T.positionX.linearRampToValueAtTime(_position$1.x,W),T.positionY.linearRampToValueAtTime(_position$1.y,W),T.positionZ.linearRampToValueAtTime(_position$1.z,W),T.forwardX.linearRampToValueAtTime(_orientation$1.x,W),T.forwardY.linearRampToValueAtTime(_orientation$1.y,W),T.forwardZ.linearRampToValueAtTime(_orientation$1.z,W),T.upX.linearRampToValueAtTime(E.x,W),T.upY.linearRampToValueAtTime(E.y,W),T.upZ.linearRampToValueAtTime(E.z,W)}else T.setPosition(_position$1.x,_position$1.y,_position$1.z),T.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,E.x,E.y,E.z)}}class Audio extends Object3D{constructor(_){super(),this.type="Audio",this.listener=_,this.context=_.context,this.gain=this.context.createGain(),this.gain.connect(_.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_,this.connect(),this}setMediaElementSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_),this.connect(),this}setMediaStreamSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_),this.connect(),this}setBuffer(_){return this.buffer=_,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_;const T=this.context.createBufferSource();return T.buffer=this.buffer,T.loop=this.loop,T.loopStart=this.loopStart,T.loopEnd=this.loopEnd,T.onended=this.onEnded.bind(this),T.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=T,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _=1,T=this.filters.length;_<T;_++)this.filters[_-1].connect(this.filters[_]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _=1,T=this.filters.length;_<T;_++)this.filters[_-1].disconnect(this.filters[_]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(_){return _||(_=[]),this._connected===!0?(this.disconnect(),this.filters=_.slice(),this.connect()):this.filters=_.slice(),this}setDetune(_){return this.detune=_,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_){return this.setFilters(_?[_]:[])}setPlaybackRate(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_){return this.loopStart=_,this}setLoopEnd(_){return this.loopEnd=_,this}getVolume(){return this.gain.gain.value}setVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}}const _position=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio{constructor(_){super(_),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_){return this.panner.refDistance=_,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_){return this.panner.rolloffFactor=_,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_){return this.panner.distanceModel=_,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_){return this.panner.maxDistance=_,this}setDirectionalCone(_,T,E){return this.panner.coneInnerAngle=_,this.panner.coneOuterAngle=T,this.panner.coneOuterGain=E,this}updateMatrixWorld(_){if(super.updateMatrixWorld(_),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const T=this.panner;if(T.positionX){const E=this.context.currentTime+this.listener.timeDelta;T.positionX.linearRampToValueAtTime(_position.x,E),T.positionY.linearRampToValueAtTime(_position.y,E),T.positionZ.linearRampToValueAtTime(_position.z,E),T.orientationX.linearRampToValueAtTime(_orientation.x,E),T.orientationY.linearRampToValueAtTime(_orientation.y,E),T.orientationZ.linearRampToValueAtTime(_orientation.z,E)}else T.setPosition(_position.x,_position.y,_position.z),T.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(_,T=2048){this.analyser=_.context.createAnalyser(),this.analyser.fftSize=T,this.data=new Uint8Array(this.analyser.frequencyBinCount),_.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _=0;const T=this.getFrequencyData();for(let E=0;E<T.length;E++)_+=T[E];return _/T.length}}class PropertyMixer{constructor(_,T,E){this.binding=_,this.valueSize=E;let W,X,q;switch(T){case"quaternion":W=this._slerp,X=this._slerpAdditive,q=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(E*6),this._workIndex=5;break;case"string":case"bool":W=this._select,X=this._select,q=this._setAdditiveIdentityOther,this.buffer=new Array(E*5);break;default:W=this._lerp,X=this._lerpAdditive,q=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(E*5)}this._mixBufferRegion=W,this._mixBufferRegionAdditive=X,this._setIdentity=q,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_,T){const E=this.buffer,W=this.valueSize,X=_*W+W;let q=this.cumulativeWeight;if(q===0){for(let Y=0;Y!==W;++Y)E[X+Y]=E[Y];q=T}else{q+=T;const Y=T/q;this._mixBufferRegion(E,X,0,Y,W)}this.cumulativeWeight=q}accumulateAdditive(_){const T=this.buffer,E=this.valueSize,W=E*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(T,W,0,_,E),this.cumulativeWeightAdditive+=_}apply(_){const T=this.valueSize,E=this.buffer,W=_*T+T,X=this.cumulativeWeight,q=this.cumulativeWeightAdditive,Y=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,X<1){const te=T*this._origIndex;this._mixBufferRegion(E,W,te,1-X,T)}q>0&&this._mixBufferRegionAdditive(E,W,this._addIndex*T,1,T);for(let te=T,ne=T+T;te!==ne;++te)if(E[te]!==E[te+T]){Y.setValue(E,W);break}}saveOriginalState(){const _=this.binding,T=this.buffer,E=this.valueSize,W=E*this._origIndex;_.getValue(T,W);for(let X=E,q=W;X!==q;++X)T[X]=T[W+X%E];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _=this.valueSize*3;this.binding.setValue(this.buffer,_)}_setAdditiveIdentityNumeric(){const _=this._addIndex*this.valueSize,T=_+this.valueSize;for(let E=_;E<T;E++)this.buffer[E]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _=this._origIndex*this.valueSize,T=this._addIndex*this.valueSize;for(let E=0;E<this.valueSize;E++)this.buffer[T+E]=this.buffer[_+E]}_select(_,T,E,W,X){if(W>=.5)for(let q=0;q!==X;++q)_[T+q]=_[E+q]}_slerp(_,T,E,W){Quaternion.slerpFlat(_,T,_,T,_,E,W)}_slerpAdditive(_,T,E,W,X){const q=this._workIndex*X;Quaternion.multiplyQuaternionsFlat(_,q,_,T,_,E),Quaternion.slerpFlat(_,T,_,T,_,q,W)}_lerp(_,T,E,W,X){const q=1-W;for(let Y=0;Y!==X;++Y){const te=T+Y;_[te]=_[te]*q+_[E+Y]*W}}_lerpAdditive(_,T,E,W,X){for(let q=0;q!==X;++q){const Y=T+q;_[Y]=_[Y]+_[E+q]*W}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_,T,E){const W=E||PropertyBinding.parseTrackName(T);this._targetGroup=_,this._bindings=_.subscribe_(T,W)}getValue(_,T){this.bind();const E=this._targetGroup.nCachedObjects_,W=this._bindings[E];W!==void 0&&W.getValue(_,T)}setValue(_,T){const E=this._bindings;for(let W=this._targetGroup.nCachedObjects_,X=E.length;W!==X;++W)E[W].setValue(_,T)}bind(){const _=this._bindings;for(let T=this._targetGroup.nCachedObjects_,E=_.length;T!==E;++T)_[T].bind()}unbind(){const _=this._bindings;for(let T=this._targetGroup.nCachedObjects_,E=_.length;T!==E;++T)_[T].unbind()}}class PropertyBinding{constructor(_,T,E){this.path=T,this.parsedPath=E||PropertyBinding.parseTrackName(T),this.node=PropertyBinding.findNode(_,this.parsedPath.nodeName),this.rootNode=_,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_,T,E){return _&&_.isAnimationObjectGroup?new PropertyBinding.Composite(_,T,E):new PropertyBinding(_,T,E)}static sanitizeNodeName(_){return _.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_){const T=_trackRe.exec(_);if(T===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_);const E={nodeName:T[2],objectName:T[3],objectIndex:T[4],propertyName:T[5],propertyIndex:T[6]},W=E.nodeName&&E.nodeName.lastIndexOf(".");if(W!==void 0&&W!==-1){const X=E.nodeName.substring(W+1);_supportedObjectNames.indexOf(X)!==-1&&(E.nodeName=E.nodeName.substring(0,W),E.objectName=X)}if(E.propertyName===null||E.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_);return E}static findNode(_,T){if(T===void 0||T===""||T==="."||T===-1||T===_.name||T===_.uuid)return _;if(_.skeleton){const E=_.skeleton.getBoneByName(T);if(E!==void 0)return E}if(_.children){const E=function(X){for(let q=0;q<X.length;q++){const Y=X[q];if(Y.name===T||Y.uuid===T)return Y;const te=E(Y.children);if(te)return te}return null},W=E(_.children);if(W)return W}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_,T){_[T]=this.targetObject[this.propertyName]}_getValue_array(_,T){const E=this.resolvedProperty;for(let W=0,X=E.length;W!==X;++W)_[T++]=E[W]}_getValue_arrayElement(_,T){_[T]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_,T){this.resolvedProperty.toArray(_,T)}_setValue_direct(_,T){this.targetObject[this.propertyName]=_[T]}_setValue_direct_setNeedsUpdate(_,T){this.targetObject[this.propertyName]=_[T],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_,T){this.targetObject[this.propertyName]=_[T],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_,T){const E=this.resolvedProperty;for(let W=0,X=E.length;W!==X;++W)E[W]=_[T++]}_setValue_array_setNeedsUpdate(_,T){const E=this.resolvedProperty;for(let W=0,X=E.length;W!==X;++W)E[W]=_[T++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_,T){const E=this.resolvedProperty;for(let W=0,X=E.length;W!==X;++W)E[W]=_[T++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_,T){this.resolvedProperty[this.propertyIndex]=_[T]}_setValue_arrayElement_setNeedsUpdate(_,T){this.resolvedProperty[this.propertyIndex]=_[T],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_,T){this.resolvedProperty[this.propertyIndex]=_[T],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_,T){this.resolvedProperty.fromArray(_,T)}_setValue_fromArray_setNeedsUpdate(_,T){this.resolvedProperty.fromArray(_,T),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_,T){this.resolvedProperty.fromArray(_,T),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_,T){this.bind(),this.getValue(_,T)}_setValue_unbound(_,T){this.bind(),this.setValue(_,T)}bind(){let _=this.node;const T=this.parsedPath,E=T.objectName,W=T.propertyName;let X=T.propertyIndex;if(_||(_=PropertyBinding.findNode(this.rootNode,T.nodeName),this.node=_),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(E){let ne=T.objectIndex;switch(E){case"materials":if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_=_.material.materials;break;case"bones":if(!_.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_=_.skeleton.bones;for(let ae=0;ae<_.length;ae++)if(_[ae].name===ne){ne=ae;break}break;case"map":if("map"in _){_=_.map;break}if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_=_.material.map;break;default:if(_[E]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_=_[E]}if(ne!==void 0){if(_[ne]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_);return}_=_[ne]}}const q=_[W];if(q===void 0){const ne=T.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+ne+"."+W+" but it wasn't found.",_);return}let Y=this.Versioning.None;this.targetObject=_,_.needsUpdate!==void 0?Y=this.Versioning.NeedsUpdate:_.matrixWorldNeedsUpdate!==void 0&&(Y=this.Versioning.MatrixWorldNeedsUpdate);let te=this.BindingType.Direct;if(X!==void 0){if(W==="morphTargetInfluences"){if(!_.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_.morphTargetDictionary[X]!==void 0&&(X=_.morphTargetDictionary[X])}te=this.BindingType.ArrayElement,this.resolvedProperty=q,this.propertyIndex=X}else q.fromArray!==void 0&&q.toArray!==void 0?(te=this.BindingType.HasFromToArray,this.resolvedProperty=q):Array.isArray(q)?(te=this.BindingType.EntireArray,this.resolvedProperty=q):this.propertyName=W;this.getValue=this.GetterByBindingType[te],this.setValue=this.SetterByBindingTypeAndVersioning[te][Y]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _={};this._indicesByUUID=_;for(let E=0,W=arguments.length;E!==W;++E)_[arguments[E].uuid]=E;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const T=this;this.stats={objects:{get total(){return T._objects.length},get inUse(){return this.total-T.nCachedObjects_}},get bindingsPerObject(){return T._bindings.length}}}add(){const _=this._objects,T=this._indicesByUUID,E=this._paths,W=this._parsedPaths,X=this._bindings,q=X.length;let Y,te=_.length,ne=this.nCachedObjects_;for(let ae=0,le=arguments.length;ae!==le;++ae){const ue=arguments[ae],ge=ue.uuid;let ye=T[ge];if(ye===void 0){ye=te++,T[ge]=ye,_.push(ue);for(let xe=0,Te=q;xe!==Te;++xe)X[xe].push(new PropertyBinding(ue,E[xe],W[xe]))}else if(ye<ne){Y=_[ye];const xe=--ne,Te=_[xe];T[Te.uuid]=ye,_[ye]=Te,T[ge]=xe,_[xe]=ue;for(let Ae=0,Ie=q;Ae!==Ie;++Ae){const Ve=X[Ae],$e=Ve[xe];let We=Ve[ye];Ve[ye]=$e,We===void 0&&(We=new PropertyBinding(ue,E[Ae],W[Ae])),Ve[xe]=We}}else _[ye]!==Y&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=ne}remove(){const _=this._objects,T=this._indicesByUUID,E=this._bindings,W=E.length;let X=this.nCachedObjects_;for(let q=0,Y=arguments.length;q!==Y;++q){const te=arguments[q],ne=te.uuid,ae=T[ne];if(ae!==void 0&&ae>=X){const le=X++,ue=_[le];T[ue.uuid]=ae,_[ae]=ue,T[ne]=le,_[le]=te;for(let ge=0,ye=W;ge!==ye;++ge){const xe=E[ge],Te=xe[le],Ae=xe[ae];xe[ae]=Te,xe[le]=Ae}}}this.nCachedObjects_=X}uncache(){const _=this._objects,T=this._indicesByUUID,E=this._bindings,W=E.length;let X=this.nCachedObjects_,q=_.length;for(let Y=0,te=arguments.length;Y!==te;++Y){const ne=arguments[Y],ae=ne.uuid,le=T[ae];if(le!==void 0)if(delete T[ae],le<X){const ue=--X,ge=_[ue],ye=--q,xe=_[ye];T[ge.uuid]=le,_[le]=ge,T[xe.uuid]=ue,_[ue]=xe,_.pop();for(let Te=0,Ae=W;Te!==Ae;++Te){const Ie=E[Te],Ve=Ie[ue],$e=Ie[ye];Ie[le]=Ve,Ie[ue]=$e,Ie.pop()}}else{const ue=--q,ge=_[ue];ue>0&&(T[ge.uuid]=le),_[le]=ge,_.pop();for(let ye=0,xe=W;ye!==xe;++ye){const Te=E[ye];Te[le]=Te[ue],Te.pop()}}}this.nCachedObjects_=X}subscribe_(_,T){const E=this._bindingsIndicesByPath;let W=E[_];const X=this._bindings;if(W!==void 0)return X[W];const q=this._paths,Y=this._parsedPaths,te=this._objects,ne=te.length,ae=this.nCachedObjects_,le=new Array(ne);W=X.length,E[_]=W,q.push(_),Y.push(T),X.push(le);for(let ue=ae,ge=te.length;ue!==ge;++ue){const ye=te[ue];le[ue]=new PropertyBinding(ye,_,T)}return le}unsubscribe_(_){const T=this._bindingsIndicesByPath,E=T[_];if(E!==void 0){const W=this._paths,X=this._parsedPaths,q=this._bindings,Y=q.length-1,te=q[Y],ne=_[Y];T[ne]=E,q[E]=te,q.pop(),X[E]=X[Y],X.pop(),W[E]=W[Y],W.pop()}}}class AnimationAction{constructor(_,T,E=null,W=T.blendMode){this._mixer=_,this._clip=T,this._localRoot=E,this.blendMode=W;const X=T.tracks,q=X.length,Y=new Array(q),te={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let ne=0;ne!==q;++ne){const ae=X[ne].createInterpolant(null);Y[ne]=ae,ae.settings=te}this._interpolantSettings=te,this._interpolants=Y,this._propertyBindings=new Array(q),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_){return this._startTime=_,this}setLoop(_,T){return this.loop=_,this.repetitions=T,this}setEffectiveWeight(_){return this.weight=_,this._effectiveWeight=this.enabled?_:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_){return this._scheduleFading(_,0,1)}fadeOut(_){return this._scheduleFading(_,1,0)}crossFadeFrom(_,T,E){if(_.fadeOut(T),this.fadeIn(T),E){const W=this._clip.duration,X=_._clip.duration,q=X/W,Y=W/X;_.warp(1,q,T),this.warp(Y,1,T)}return this}crossFadeTo(_,T,E){return _.crossFadeFrom(this,T,E)}stopFading(){const _=this._weightInterpolant;return _!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}setEffectiveTimeScale(_){return this.timeScale=_,this._effectiveTimeScale=this.paused?0:_,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_){return this.timeScale=this._clip.duration/_,this.stopWarping()}syncWith(_){return this.time=_.time,this.timeScale=_.timeScale,this.stopWarping()}halt(_){return this.warp(this._effectiveTimeScale,0,_)}warp(_,T,E){const W=this._mixer,X=W.time,q=this.timeScale;let Y=this._timeScaleInterpolant;Y===null&&(Y=W._lendControlInterpolant(),this._timeScaleInterpolant=Y);const te=Y.parameterPositions,ne=Y.sampleValues;return te[0]=X,te[1]=X+E,ne[0]=_/q,ne[1]=T/q,this}stopWarping(){const _=this._timeScaleInterpolant;return _!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_,T,E,W){if(!this.enabled){this._updateWeight(_);return}const X=this._startTime;if(X!==null){const te=(_-X)*E;te<0||E===0?T=0:(this._startTime=null,T=E*te)}T*=this._updateTimeScale(_);const q=this._updateTime(T),Y=this._updateWeight(_);if(Y>0){const te=this._interpolants,ne=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let ae=0,le=te.length;ae!==le;++ae)te[ae].evaluate(q),ne[ae].accumulateAdditive(Y);break;case NormalAnimationBlendMode:default:for(let ae=0,le=te.length;ae!==le;++ae)te[ae].evaluate(q),ne[ae].accumulate(W,Y)}}}_updateWeight(_){let T=0;if(this.enabled){T=this.weight;const E=this._weightInterpolant;if(E!==null){const W=E.evaluate(_)[0];T*=W,_>E.parameterPositions[1]&&(this.stopFading(),W===0&&(this.enabled=!1))}}return this._effectiveWeight=T,T}_updateTimeScale(_){let T=0;if(!this.paused){T=this.timeScale;const E=this._timeScaleInterpolant;if(E!==null){const W=E.evaluate(_)[0];T*=W,_>E.parameterPositions[1]&&(this.stopWarping(),T===0?this.paused=!0:this.timeScale=T)}}return this._effectiveTimeScale=T,T}_updateTime(_){const T=this._clip.duration,E=this.loop;let W=this.time+_,X=this._loopCount;const q=E===LoopPingPong;if(_===0)return X===-1?W:q&&(X&1)===1?T-W:W;if(E===LoopOnce){X===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(W>=T)W=T;else if(W<0)W=0;else{this.time=W;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=W,this._mixer.dispatchEvent({type:"finished",action:this,direction:_<0?-1:1})}}else{if(X===-1&&(_>=0?(X=0,this._setEndings(!0,this.repetitions===0,q)):this._setEndings(this.repetitions===0,!0,q)),W>=T||W<0){const Y=Math.floor(W/T);W-=T*Y,X+=Math.abs(Y);const te=this.repetitions-X;if(te<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,W=_>0?T:0,this.time=W,this._mixer.dispatchEvent({type:"finished",action:this,direction:_>0?1:-1});else{if(te===1){const ne=_<0;this._setEndings(ne,!ne,q)}else this._setEndings(!1,!1,q);this._loopCount=X,this.time=W,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:Y})}}else this.time=W;if(q&&(X&1)===1)return T-W}return W}_setEndings(_,T,E){const W=this._interpolantSettings;E?(W.endingStart=ZeroSlopeEnding,W.endingEnd=ZeroSlopeEnding):(_?W.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:W.endingStart=WrapAroundEnding,T?W.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:W.endingEnd=WrapAroundEnding)}_scheduleFading(_,T,E){const W=this._mixer,X=W.time;let q=this._weightInterpolant;q===null&&(q=W._lendControlInterpolant(),this._weightInterpolant=q);const Y=q.parameterPositions,te=q.sampleValues;return Y[0]=X,te[0]=T,Y[1]=X+_,te[1]=E,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(_){super(),this._root=_,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_,T){const E=_._localRoot||this._root,W=_._clip.tracks,X=W.length,q=_._propertyBindings,Y=_._interpolants,te=E.uuid,ne=this._bindingsByRootAndName;let ae=ne[te];ae===void 0&&(ae={},ne[te]=ae);for(let le=0;le!==X;++le){const ue=W[le],ge=ue.name;let ye=ae[ge];if(ye!==void 0)++ye.referenceCount,q[le]=ye;else{if(ye=q[le],ye!==void 0){ye._cacheIndex===null&&(++ye.referenceCount,this._addInactiveBinding(ye,te,ge));continue}const xe=T&&T._propertyBindings[le].binding.parsedPath;ye=new PropertyMixer(PropertyBinding.create(E,ge,xe),ue.ValueTypeName,ue.getValueSize()),++ye.referenceCount,this._addInactiveBinding(ye,te,ge),q[le]=ye}Y[le].resultBuffer=ye.buffer}}_activateAction(_){if(!this._isActiveAction(_)){if(_._cacheIndex===null){const E=(_._localRoot||this._root).uuid,W=_._clip.uuid,X=this._actionsByClip[W];this._bindAction(_,X&&X.knownActions[0]),this._addInactiveAction(_,W,E)}const T=_._propertyBindings;for(let E=0,W=T.length;E!==W;++E){const X=T[E];X.useCount++===0&&(this._lendBinding(X),X.saveOriginalState())}this._lendAction(_)}}_deactivateAction(_){if(this._isActiveAction(_)){const T=_._propertyBindings;for(let E=0,W=T.length;E!==W;++E){const X=T[E];--X.useCount===0&&(X.restoreOriginalState(),this._takeBackBinding(X))}this._takeBackAction(_)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _=this;this.stats={actions:{get total(){return _._actions.length},get inUse(){return _._nActiveActions}},bindings:{get total(){return _._bindings.length},get inUse(){return _._nActiveBindings}},controlInterpolants:{get total(){return _._controlInterpolants.length},get inUse(){return _._nActiveControlInterpolants}}}}_isActiveAction(_){const T=_._cacheIndex;return T!==null&&T<this._nActiveActions}_addInactiveAction(_,T,E){const W=this._actions,X=this._actionsByClip;let q=X[T];if(q===void 0)q={knownActions:[_],actionByRoot:{}},_._byClipCacheIndex=0,X[T]=q;else{const Y=q.knownActions;_._byClipCacheIndex=Y.length,Y.push(_)}_._cacheIndex=W.length,W.push(_),q.actionByRoot[E]=_}_removeInactiveAction(_){const T=this._actions,E=T[T.length-1],W=_._cacheIndex;E._cacheIndex=W,T[W]=E,T.pop(),_._cacheIndex=null;const X=_._clip.uuid,q=this._actionsByClip,Y=q[X],te=Y.knownActions,ne=te[te.length-1],ae=_._byClipCacheIndex;ne._byClipCacheIndex=ae,te[ae]=ne,te.pop(),_._byClipCacheIndex=null;const le=Y.actionByRoot,ue=(_._localRoot||this._root).uuid;delete le[ue],te.length===0&&delete q[X],this._removeInactiveBindingsForAction(_)}_removeInactiveBindingsForAction(_){const T=_._propertyBindings;for(let E=0,W=T.length;E!==W;++E){const X=T[E];--X.referenceCount===0&&this._removeInactiveBinding(X)}}_lendAction(_){const T=this._actions,E=_._cacheIndex,W=this._nActiveActions++,X=T[W];_._cacheIndex=W,T[W]=_,X._cacheIndex=E,T[E]=X}_takeBackAction(_){const T=this._actions,E=_._cacheIndex,W=--this._nActiveActions,X=T[W];_._cacheIndex=W,T[W]=_,X._cacheIndex=E,T[E]=X}_addInactiveBinding(_,T,E){const W=this._bindingsByRootAndName,X=this._bindings;let q=W[T];q===void 0&&(q={},W[T]=q),q[E]=_,_._cacheIndex=X.length,X.push(_)}_removeInactiveBinding(_){const T=this._bindings,E=_.binding,W=E.rootNode.uuid,X=E.path,q=this._bindingsByRootAndName,Y=q[W],te=T[T.length-1],ne=_._cacheIndex;te._cacheIndex=ne,T[ne]=te,T.pop(),delete Y[X],Object.keys(Y).length===0&&delete q[W]}_lendBinding(_){const T=this._bindings,E=_._cacheIndex,W=this._nActiveBindings++,X=T[W];_._cacheIndex=W,T[W]=_,X._cacheIndex=E,T[E]=X}_takeBackBinding(_){const T=this._bindings,E=_._cacheIndex,W=--this._nActiveBindings,X=T[W];_._cacheIndex=W,T[W]=_,X._cacheIndex=E,T[E]=X}_lendControlInterpolant(){const _=this._controlInterpolants,T=this._nActiveControlInterpolants++;let E=_[T];return E===void 0&&(E=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),E.__cacheIndex=T,_[T]=E),E}_takeBackControlInterpolant(_){const T=this._controlInterpolants,E=_.__cacheIndex,W=--this._nActiveControlInterpolants,X=T[W];_.__cacheIndex=W,T[W]=_,X.__cacheIndex=E,T[E]=X}clipAction(_,T,E){const W=T||this._root,X=W.uuid;let q=typeof _=="string"?AnimationClip.findByName(W,_):_;const Y=q!==null?q.uuid:_,te=this._actionsByClip[Y];let ne=null;if(E===void 0&&(q!==null?E=q.blendMode:E=NormalAnimationBlendMode),te!==void 0){const le=te.actionByRoot[X];if(le!==void 0&&le.blendMode===E)return le;ne=te.knownActions[0],q===null&&(q=ne._clip)}if(q===null)return null;const ae=new AnimationAction(this,q,T,E);return this._bindAction(ae,ne),this._addInactiveAction(ae,Y,X),ae}existingAction(_,T){const E=T||this._root,W=E.uuid,X=typeof _=="string"?AnimationClip.findByName(E,_):_,q=X?X.uuid:_,Y=this._actionsByClip[q];return Y!==void 0&&Y.actionByRoot[W]||null}stopAllAction(){const _=this._actions,T=this._nActiveActions;for(let E=T-1;E>=0;--E)_[E].stop();return this}update(_){_*=this.timeScale;const T=this._actions,E=this._nActiveActions,W=this.time+=_,X=Math.sign(_),q=this._accuIndex^=1;for(let ne=0;ne!==E;++ne)T[ne]._update(W,_,X,q);const Y=this._bindings,te=this._nActiveBindings;for(let ne=0;ne!==te;++ne)Y[ne].apply(q);return this}setTime(_){this.time=0;for(let T=0;T<this._actions.length;T++)this._actions[T].time=0;return this.update(_)}getRoot(){return this._root}uncacheClip(_){const T=this._actions,E=_.uuid,W=this._actionsByClip,X=W[E];if(X!==void 0){const q=X.knownActions;for(let Y=0,te=q.length;Y!==te;++Y){const ne=q[Y];this._deactivateAction(ne);const ae=ne._cacheIndex,le=T[T.length-1];ne._cacheIndex=null,ne._byClipCacheIndex=null,le._cacheIndex=ae,T[ae]=le,T.pop(),this._removeInactiveBindingsForAction(ne)}delete W[E]}}uncacheRoot(_){const T=_.uuid,E=this._actionsByClip;for(const q in E){const Y=E[q].actionByRoot,te=Y[T];te!==void 0&&(this._deactivateAction(te),this._removeInactiveAction(te))}const W=this._bindingsByRootAndName,X=W[T];if(X!==void 0)for(const q in X){const Y=X[q];Y.restoreOriginalState(),this._removeInactiveBinding(Y)}}uncacheAction(_,T){const E=this.existingAction(_,T);E!==null&&(this._deactivateAction(E),this._removeInactiveAction(E))}}class Uniform{constructor(_){this.value=_}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let _id=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:_id++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(_){return this.uniforms.push(_),this}remove(_){const T=this.uniforms.indexOf(_);return T!==-1&&this.uniforms.splice(T,1),this}setName(_){return this.name=_,this}setUsage(_){return this.usage=_,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_){this.name=_.name,this.usage=_.usage;const T=_.uniforms;this.uniforms.length=0;for(let E=0,W=T.length;E<W;E++){const X=Array.isArray(T[E])?T[E]:[T[E]];for(let q=0;q<X.length;q++)this.uniforms.push(X[q].clone())}return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_,T,E=1){super(_,T),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=E}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}clone(_){const T=super.clone(_);return T.meshPerAttribute=this.meshPerAttribute,T}toJSON(_){const T=super.toJSON(_);return T.isInstancedInterleavedBuffer=!0,T.meshPerAttribute=this.meshPerAttribute,T}}class GLBufferAttribute{constructor(_,T,E,W,X){this.isGLBufferAttribute=!0,this.name="",this.buffer=_,this.type=T,this.itemSize=E,this.elementSize=W,this.count=X,this.version=0}set needsUpdate(_){_===!0&&this.version++}setBuffer(_){return this.buffer=_,this}setType(_,T){return this.type=_,this.elementSize=T,this}setItemSize(_){return this.itemSize=_,this}setCount(_){return this.count=_,this}}const _matrix=new Matrix4;class Raycaster{constructor(_,T,E=0,W=1/0){this.ray=new Ray(_,T),this.near=E,this.far=W,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_,T){this.ray.set(_,T)}setFromCamera(_,T){T.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(T.matrixWorld),this.ray.direction.set(_.x,_.y,.5).unproject(T).sub(this.ray.origin).normalize(),this.camera=T):T.isOrthographicCamera?(this.ray.origin.set(_.x,_.y,(T.near+T.far)/(T.near-T.far)).unproject(T),this.ray.direction.set(0,0,-1).transformDirection(T.matrixWorld),this.camera=T):console.error("THREE.Raycaster: Unsupported camera type: "+T.type)}setFromXRController(_){return _matrix.identity().extractRotation(_.matrixWorld),this.ray.origin.setFromMatrixPosition(_.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(_matrix),this}intersectObject(_,T=!0,E=[]){return intersect(_,this,E,T),E.sort(ascSort),E}intersectObjects(_,T=!0,E=[]){for(let W=0,X=_.length;W<X;W++)intersect(_[W],this,E,T);return E.sort(ascSort),E}}function ascSort(B,_){return B.distance-_.distance}function intersect(B,_,T,E){if(B.layers.test(_.layers)&&B.raycast(_,T),E===!0){const W=B.children;for(let X=0,q=W.length;X<q;X++)intersect(W[X],_,T,!0)}}class Spherical{constructor(_=1,T=0,E=0){return this.radius=_,this.phi=T,this.theta=E,this}set(_,T,E){return this.radius=_,this.phi=T,this.theta=E,this}copy(_){return this.radius=_.radius,this.phi=_.phi,this.theta=_.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,T,E){return this.radius=Math.sqrt(_*_+T*T+E*E),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_,E),this.phi=Math.acos(clamp$1(T/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_=1,T=0,E=0){return this.radius=_,this.theta=T,this.y=E,this}set(_,T,E){return this.radius=_,this.theta=T,this.y=E,this}copy(_){return this.radius=_.radius,this.theta=_.theta,this.y=_.y,this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,T,E){return this.radius=Math.sqrt(_*_+E*E),this.theta=Math.atan2(_,E),this.y=T,this}clone(){return new this.constructor().copy(this)}}const _vector$4=new Vector2;class Box2{constructor(_=new Vector2(1/0,1/0),T=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=_,this.max=T}set(_,T){return this.min.copy(_),this.max.copy(T),this}setFromPoints(_){this.makeEmpty();for(let T=0,E=_.length;T<E;T++)this.expandByPoint(_[T]);return this}setFromCenterAndSize(_,T){const E=_vector$4.copy(T).multiplyScalar(.5);return this.min.copy(_).sub(E),this.max.copy(_).add(E),this}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_){return this.isEmpty()?_.set(0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y}getParameter(_,T){return T.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y)}clampPoint(_,T){return T.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$4).distanceTo(_)}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_=new Vector3,T=new Vector3){this.start=_,this.end=T}set(_,T){return this.start.copy(_),this.end.copy(T),this}copy(_){return this.start.copy(_.start),this.end.copy(_.end),this}getCenter(_){return _.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_){return _.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_,T){return this.delta(T).multiplyScalar(_).add(this.start)}closestPointToPointParameter(_,T){_startP.subVectors(_,this.start),_startEnd.subVectors(this.end,this.start);const E=_startEnd.dot(_startEnd);let X=_startEnd.dot(_startP)/E;return T&&(X=clamp$1(X,0,1)),X}closestPointToPoint(_,T,E){const W=this.closestPointToPointParameter(_,T);return this.delta(E).multiplyScalar(W).add(this.start)}applyMatrix4(_){return this.start.applyMatrix4(_),this.end.applyMatrix4(_),this}equals(_){return _.start.equals(this.start)&&_.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(_,T){super(),this.light=_,this.matrixAutoUpdate=!1,this.color=T,this.type="SpotLightHelper";const E=new BufferGeometry,W=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let q=0,Y=1,te=32;q<te;q++,Y++){const ne=q/te*Math.PI*2,ae=Y/te*Math.PI*2;W.push(Math.cos(ne),Math.sin(ne),1,Math.cos(ae),Math.sin(ae),1)}E.setAttribute("position",new Float32BufferAttribute(W,3));const X=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(E,X),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const _=this.light.distance?this.light.distance:1e3,T=_*Math.tan(this.light.angle);this.cone.scale.set(T,T,_),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(_){const T=getBoneList(_),E=new BufferGeometry,W=[],X=[],q=new Color(0,0,1),Y=new Color(0,1,0);for(let ne=0;ne<T.length;ne++){const ae=T[ne];ae.parent&&ae.parent.isBone&&(W.push(0,0,0),W.push(0,0,0),X.push(q.r,q.g,q.b),X.push(Y.r,Y.g,Y.b))}E.setAttribute("position",new Float32BufferAttribute(W,3)),E.setAttribute("color",new Float32BufferAttribute(X,3));const te=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(E,te),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_,this.bones=T,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_){const T=this.bones,E=this.geometry,W=E.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let X=0,q=0;X<T.length;X++){const Y=T[X];Y.parent&&Y.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,Y.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),W.setXYZ(q,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,Y.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),W.setXYZ(q+1,_vector$2.x,_vector$2.y,_vector$2.z),q+=2)}E.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(B){const _=[];B.isBone===!0&&_.push(B);for(let T=0;T<B.children.length;T++)_.push.apply(_,getBoneList(B.children[T]));return _}class PointLightHelper extends Mesh{constructor(_,T,E){const W=new SphereGeometry(T,4,2),X=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(W,X),this.light=_,this.color=E,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color,_color2=new Color;class HemisphereLightHelper extends Object3D{constructor(_,T,E){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=E,this.type="HemisphereLightHelper";const W=new OctahedronGeometry(T);W.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const X=W.getAttribute("position"),q=new Float32Array(X.count*3);W.setAttribute("color",new BufferAttribute(q,3)),this.add(new Mesh(W,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const T=_.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let E=0,W=T.count;E<W;E++){const X=E<W/2?_color1:_color2;T.setXYZ(E,X.r,X.g,X.b)}T.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_=10,T=10,E=4473924,W=8947848){E=new Color(E),W=new Color(W);const X=T/2,q=_/T,Y=_/2,te=[],ne=[];for(let ue=0,ge=0,ye=-Y;ue<=T;ue++,ye+=q){te.push(-Y,0,ye,Y,0,ye),te.push(ye,0,-Y,ye,0,Y);const xe=ue===X?E:W;xe.toArray(ne,ge),ge+=3,xe.toArray(ne,ge),ge+=3,xe.toArray(ne,ge),ge+=3,xe.toArray(ne,ge),ge+=3}const ae=new BufferGeometry;ae.setAttribute("position",new Float32BufferAttribute(te,3)),ae.setAttribute("color",new Float32BufferAttribute(ne,3));const le=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ae,le),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_=10,T=16,E=8,W=64,X=4473924,q=8947848){X=new Color(X),q=new Color(q);const Y=[],te=[];if(T>1)for(let le=0;le<T;le++){const ue=le/T*(Math.PI*2),ge=Math.sin(ue)*_,ye=Math.cos(ue)*_;Y.push(0,0,0),Y.push(ge,0,ye);const xe=le&1?X:q;te.push(xe.r,xe.g,xe.b),te.push(xe.r,xe.g,xe.b)}for(let le=0;le<E;le++){const ue=le&1?X:q,ge=_-_/E*le;for(let ye=0;ye<W;ye++){let xe=ye/W*(Math.PI*2),Te=Math.sin(xe)*ge,Ae=Math.cos(xe)*ge;Y.push(Te,0,Ae),te.push(ue.r,ue.g,ue.b),xe=(ye+1)/W*(Math.PI*2),Te=Math.sin(xe)*ge,Ae=Math.cos(xe)*ge,Y.push(Te,0,Ae),te.push(ue.r,ue.g,ue.b)}}const ne=new BufferGeometry;ne.setAttribute("position",new Float32BufferAttribute(Y,3)),ne.setAttribute("color",new Float32BufferAttribute(te,3));const ae=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(ne,ae),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(_,T,E){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=E,this.type="DirectionalLightHelper",T===void 0&&(T=1);let W=new BufferGeometry;W.setAttribute("position",new Float32BufferAttribute([-T,T,0,T,T,0,T,-T,0,-T,-T,0,-T,T,0],3));const X=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line$1(W,X),this.add(this.lightPlane),W=new BufferGeometry,W.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line$1(W,X),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(_){const T=new BufferGeometry,E=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),W=[],X=[],q={};Y("n1","n2"),Y("n2","n4"),Y("n4","n3"),Y("n3","n1"),Y("f1","f2"),Y("f2","f4"),Y("f4","f3"),Y("f3","f1"),Y("n1","f1"),Y("n2","f2"),Y("n3","f3"),Y("n4","f4"),Y("p","n1"),Y("p","n2"),Y("p","n3"),Y("p","n4"),Y("u1","u2"),Y("u2","u3"),Y("u3","u1"),Y("c","t"),Y("p","c"),Y("cn1","cn2"),Y("cn3","cn4"),Y("cf1","cf2"),Y("cf3","cf4");function Y(ye,xe){te(ye),te(xe)}function te(ye){W.push(0,0,0),X.push(0,0,0),q[ye]===void 0&&(q[ye]=[]),q[ye].push(W.length/3-1)}T.setAttribute("position",new Float32BufferAttribute(W,3)),T.setAttribute("color",new Float32BufferAttribute(X,3)),super(T,E),this.type="CameraHelper",this.camera=_,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=q,this.update();const ne=new Color(16755200),ae=new Color(16711680),le=new Color(43775),ue=new Color(16777215),ge=new Color(3355443);this.setColors(ne,ae,le,ue,ge)}setColors(_,T,E,W,X){const Y=this.geometry.getAttribute("color");Y.setXYZ(0,_.r,_.g,_.b),Y.setXYZ(1,_.r,_.g,_.b),Y.setXYZ(2,_.r,_.g,_.b),Y.setXYZ(3,_.r,_.g,_.b),Y.setXYZ(4,_.r,_.g,_.b),Y.setXYZ(5,_.r,_.g,_.b),Y.setXYZ(6,_.r,_.g,_.b),Y.setXYZ(7,_.r,_.g,_.b),Y.setXYZ(8,_.r,_.g,_.b),Y.setXYZ(9,_.r,_.g,_.b),Y.setXYZ(10,_.r,_.g,_.b),Y.setXYZ(11,_.r,_.g,_.b),Y.setXYZ(12,_.r,_.g,_.b),Y.setXYZ(13,_.r,_.g,_.b),Y.setXYZ(14,_.r,_.g,_.b),Y.setXYZ(15,_.r,_.g,_.b),Y.setXYZ(16,_.r,_.g,_.b),Y.setXYZ(17,_.r,_.g,_.b),Y.setXYZ(18,_.r,_.g,_.b),Y.setXYZ(19,_.r,_.g,_.b),Y.setXYZ(20,_.r,_.g,_.b),Y.setXYZ(21,_.r,_.g,_.b),Y.setXYZ(22,_.r,_.g,_.b),Y.setXYZ(23,_.r,_.g,_.b),Y.setXYZ(24,T.r,T.g,T.b),Y.setXYZ(25,T.r,T.g,T.b),Y.setXYZ(26,T.r,T.g,T.b),Y.setXYZ(27,T.r,T.g,T.b),Y.setXYZ(28,T.r,T.g,T.b),Y.setXYZ(29,T.r,T.g,T.b),Y.setXYZ(30,T.r,T.g,T.b),Y.setXYZ(31,T.r,T.g,T.b),Y.setXYZ(32,E.r,E.g,E.b),Y.setXYZ(33,E.r,E.g,E.b),Y.setXYZ(34,E.r,E.g,E.b),Y.setXYZ(35,E.r,E.g,E.b),Y.setXYZ(36,E.r,E.g,E.b),Y.setXYZ(37,E.r,E.g,E.b),Y.setXYZ(38,W.r,W.g,W.b),Y.setXYZ(39,W.r,W.g,W.b),Y.setXYZ(40,X.r,X.g,X.b),Y.setXYZ(41,X.r,X.g,X.b),Y.setXYZ(42,X.r,X.g,X.b),Y.setXYZ(43,X.r,X.g,X.b),Y.setXYZ(44,X.r,X.g,X.b),Y.setXYZ(45,X.r,X.g,X.b),Y.setXYZ(46,X.r,X.g,X.b),Y.setXYZ(47,X.r,X.g,X.b),Y.setXYZ(48,X.r,X.g,X.b),Y.setXYZ(49,X.r,X.g,X.b),Y.needsUpdate=!0}update(){const _=this.geometry,T=this.pointMap,E=1,W=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",T,_,_camera,0,0,-1),setPoint("t",T,_,_camera,0,0,1),setPoint("n1",T,_,_camera,-E,-W,-1),setPoint("n2",T,_,_camera,E,-W,-1),setPoint("n3",T,_,_camera,-E,W,-1),setPoint("n4",T,_,_camera,E,W,-1),setPoint("f1",T,_,_camera,-E,-W,1),setPoint("f2",T,_,_camera,E,-W,1),setPoint("f3",T,_,_camera,-E,W,1),setPoint("f4",T,_,_camera,E,W,1),setPoint("u1",T,_,_camera,E*.7,W*1.1,-1),setPoint("u2",T,_,_camera,-E*.7,W*1.1,-1),setPoint("u3",T,_,_camera,0,W*2,-1),setPoint("cf1",T,_,_camera,-E,0,1),setPoint("cf2",T,_,_camera,E,0,1),setPoint("cf3",T,_,_camera,0,-W,1),setPoint("cf4",T,_,_camera,0,W,1),setPoint("cn1",T,_,_camera,-E,0,-1),setPoint("cn2",T,_,_camera,E,0,-1),setPoint("cn3",T,_,_camera,0,-W,-1),setPoint("cn4",T,_,_camera,0,W,-1),_.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(B,_,T,E,W,X,q){_vector.set(W,X,q).unproject(E);const Y=_[B];if(Y!==void 0){const te=T.getAttribute("position");for(let ne=0,ae=Y.length;ne<ae;ne++)te.setXYZ(Y[ne],_vector.x,_vector.y,_vector.z)}}const _box=new Box3;class BoxHelper extends LineSegments{constructor(_,T=16776960){const E=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),W=new Float32Array(8*3),X=new BufferGeometry;X.setIndex(new BufferAttribute(E,1)),X.setAttribute("position",new BufferAttribute(W,3)),super(X,new LineBasicMaterial({color:T,toneMapped:!1})),this.object=_,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_){if(_!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box.setFromObject(this.object),_box.isEmpty())return;const T=_box.min,E=_box.max,W=this.geometry.attributes.position,X=W.array;X[0]=E.x,X[1]=E.y,X[2]=E.z,X[3]=T.x,X[4]=E.y,X[5]=E.z,X[6]=T.x,X[7]=T.y,X[8]=E.z,X[9]=E.x,X[10]=T.y,X[11]=E.z,X[12]=E.x,X[13]=E.y,X[14]=T.z,X[15]=T.x,X[16]=E.y,X[17]=T.z,X[18]=T.x,X[19]=T.y,X[20]=T.z,X[21]=E.x,X[22]=T.y,X[23]=T.z,W.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_){return this.object=_,this.update(),this}copy(_,T){return super.copy(_,T),this.object=_.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_,T=16776960){const E=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),W=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],X=new BufferGeometry;X.setIndex(new BufferAttribute(E,1)),X.setAttribute("position",new Float32BufferAttribute(W,3)),super(X,new LineBasicMaterial({color:T,toneMapped:!1})),this.box=_,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_){const T=this.box;T.isEmpty()||(T.getCenter(this.position),T.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line$1{constructor(_,T=1,E=16776960){const W=E,X=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],q=new BufferGeometry;q.setAttribute("position",new Float32BufferAttribute(X,3)),q.computeBoundingSphere(),super(q,new LineBasicMaterial({color:W,toneMapped:!1})),this.type="PlaneHelper",this.plane=_,this.size=T;const Y=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],te=new BufferGeometry;te.setAttribute("position",new Float32BufferAttribute(Y,3)),te.computeBoundingSphere(),this.add(new Mesh(te,new MeshBasicMaterial({color:W,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(_=new Vector3(0,0,1),T=new Vector3(0,0,0),E=1,W=16776960,X=E*.2,q=X*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(T),this.line=new Line$1(_lineGeometry,new LineBasicMaterial({color:W,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:W,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_),this.setLength(E,X,q)}setDirection(_){if(_.y>.99999)this.quaternion.set(0,0,0,1);else if(_.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(_.z,0,-_.x).normalize();const T=Math.acos(_.y);this.quaternion.setFromAxisAngle(_axis,T)}}setLength(_,T=_*.2,E=T*.2){this.line.scale.set(1,Math.max(1e-4,_-T),1),this.line.updateMatrix(),this.cone.scale.set(E,T,E),this.cone.position.y=_,this.cone.updateMatrix()}setColor(_){this.line.material.color.set(_),this.cone.material.color.set(_)}copy(_){return super.copy(_,!1),this.line.copy(_.line),this.cone.copy(_.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_=1){const T=[0,0,0,_,0,0,0,0,0,0,_,0,0,0,0,0,0,_],E=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],W=new BufferGeometry;W.setAttribute("position",new Float32BufferAttribute(T,3)),W.setAttribute("color",new Float32BufferAttribute(E,3));const X=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(W,X),this.type="AxesHelper"}setColors(_,T,E){const W=new Color,X=this.geometry.attributes.color.array;return W.set(_),W.toArray(X,0),W.toArray(X,3),W.set(T),W.toArray(X,6),W.toArray(X,9),W.set(E),W.toArray(X,12),W.toArray(X,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}moveTo(_,T){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_,T),this}lineTo(_,T){return this.currentPath.lineTo(_,T),this}quadraticCurveTo(_,T,E,W){return this.currentPath.quadraticCurveTo(_,T,E,W),this}bezierCurveTo(_,T,E,W,X,q){return this.currentPath.bezierCurveTo(_,T,E,W,X,q),this}splineThru(_){return this.currentPath.splineThru(_),this}toShapes(_){function T(Ae){const Ie=[];for(let Ve=0,$e=Ae.length;Ve<$e;Ve++){const We=Ae[Ve],Ue=new Shape$1;Ue.curves=We.curves,Ie.push(Ue)}return Ie}function E(Ae,Ie){const Ve=Ie.length;let $e=!1;for(let We=Ve-1,Ue=0;Ue<Ve;We=Ue++){let je=Ie[We],ze=Ie[Ue],He=ze.x-je.x,Le=ze.y-je.y;if(Math.abs(Le)>Number.EPSILON){if(Le<0&&(je=Ie[Ue],He=-He,ze=Ie[We],Le=-Le),Ae.y<je.y||Ae.y>ze.y)continue;if(Ae.y===je.y){if(Ae.x===je.x)return!0}else{const qe=Le*(Ae.x-je.x)-He*(Ae.y-je.y);if(qe===0)return!0;if(qe<0)continue;$e=!$e}}else{if(Ae.y!==je.y)continue;if(ze.x<=Ae.x&&Ae.x<=je.x||je.x<=Ae.x&&Ae.x<=ze.x)return!0}}return $e}const W=ShapeUtils.isClockWise,X=this.subPaths;if(X.length===0)return[];let q,Y,te;const ne=[];if(X.length===1)return Y=X[0],te=new Shape$1,te.curves=Y.curves,ne.push(te),ne;let ae=!W(X[0].getPoints());ae=_?!ae:ae;const le=[],ue=[];let ge=[],ye=0,xe;ue[ye]=void 0,ge[ye]=[];for(let Ae=0,Ie=X.length;Ae<Ie;Ae++)Y=X[Ae],xe=Y.getPoints(),q=W(xe),q=_?!q:q,q?(!ae&&ue[ye]&&ye++,ue[ye]={s:new Shape$1,p:xe},ue[ye].s.curves=Y.curves,ae&&ye++,ge[ye]=[]):ge[ye].push({h:Y,p:xe[0]});if(!ue[0])return T(X);if(ue.length>1){let Ae=!1,Ie=0;for(let Ve=0,$e=ue.length;Ve<$e;Ve++)le[Ve]=[];for(let Ve=0,$e=ue.length;Ve<$e;Ve++){const We=ge[Ve];for(let Ue=0;Ue<We.length;Ue++){const je=We[Ue];let ze=!0;for(let He=0;He<ue.length;He++)E(je.p,ue[He].p)&&(Ve!==He&&Ie++,ze?(ze=!1,le[He].push(je)):Ae=!0);ze&&le[Ve].push(je)}}Ie>0&&Ae===!1&&(ge=le)}let Te;for(let Ae=0,Ie=ue.length;Ae<Ie;Ae++){te=ue[Ae].s,ne.push(te),Te=ge[Ae];for(let Ve=0,$e=Te.length;Ve<$e;Ve++)te.holes.push(Te[Ve].h)}return ne}}class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(_=1,T=1,E=1,W={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(_,T,{...W,count:E}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const he=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AgXToneMapping,AlphaFormat,AlwaysCompare,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AnimationAction,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,AttachedBindMode,Audio,AudioAnalyser,AudioContext,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,BatchedMesh,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera,CameraHelper,CanvasTexture,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleGeometry,ClampToEdgeWrapping,Clock,Color,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture,CompressedCubeTexture,CompressedTexture,CompressedTextureLoader,ConeGeometry,ConstantAlphaFactor,ConstantColorFactor,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderGeometry,Cylindrical,Data3DTexture,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DetachedBindMode,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualCompare,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterCompare,GreaterDepth,GreaterEqualCompare,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group:Group$1,HalfFloatType,HemisphereLight,HemisphereLightHelper,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheGeometry,Layers,LessCompare,LessDepth,LessEqualCompare,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line:Line$1,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearDisplayP3ColorSpace,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace,LinearToneMapping,LinearTransfer,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeutralToneMapping,NeverCompare,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualCompare,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronGeometry,OneFactor,OneMinusConstantAlphaFactor,OneMinusConstantColorFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera,P3Primaries,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path,PerspectiveCamera,Plane,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGBFormat,RGB_BPTC_SIGNED_Format,RGB_BPTC_UNSIGNED_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray,Raycaster,Rec709Primaries,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RenderTarget,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace,SRGBTransfer,Scene,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape:Shape$1,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronGeometry,Texture,TextureLoader,TorusGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeGeometry,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedInt5999Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCoordinateSystem,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WebGPUCoordinateSystem,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,createCanvasElement},Symbol.toStringTag,{value:"Module"}));function tryOnScopeDispose(B){return getCurrentScope()?(onScopeDispose(B),!0):!1}function createEventHook(){const B=new Set,_=W=>{B.delete(W)};return{on:W=>{B.add(W);const X=()=>_(W);return tryOnScopeDispose(X),{off:X}},off:_,trigger:(...W)=>Promise.all(Array.from(B).map(X=>X(...W)))}}function toValue(B){return typeof B=="function"?B():unref(B)}const isClient=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const notNullish=B=>B!=null,toString=Object.prototype.toString,isObject$2=B=>toString.call(B)==="[object Object]",noop=()=>{};function createFilterWrapper(B,_){function T(...E){return new Promise((W,X)=>{Promise.resolve(B(()=>_.apply(this,E),{fn:_,thisArg:this,args:E})).then(W).catch(X)})}return T}function debounceFilter(B,_={}){let T,E,W=noop;const X=Y=>{clearTimeout(Y),W(),W=noop};return Y=>{const te=toValue(B),ne=toValue(_.maxWait);return T&&X(T),te<=0||ne!==void 0&&ne<=0?(E&&(X(E),E=null),Promise.resolve(Y())):new Promise((ae,le)=>{W=_.rejectOnCancel?le:ae,ne&&!E&&(E=setTimeout(()=>{T&&X(T),E=null,ae(Y())},ne)),T=setTimeout(()=>{E&&X(E),E=null,ae(Y())},te)})}}function objectPick(B,_,T=!1){return _.reduce((E,W)=>(W in B&&(!T||B[W]!==void 0)&&(E[W]=B[W]),E),{})}function getLifeCycleTarget(B){return getCurrentInstance()}function useDebounceFn(B,_=200,T={}){return createFilterWrapper(debounceFilter(_,T),B)}function refDebounced(B,_=200,T={}){const E=ref$1(B.value),W=useDebounceFn(()=>{E.value=B.value},_,T);return watch(B,()=>W()),E}function toRefs(B,_={}){if(!isRef(B))return toRefs$1(B);const T=Array.isArray(B.value)?Array.from({length:B.value.length}):{};for(const E in B.value)T[E]=customRef(()=>({get(){return B.value[E]},set(W){var X;if((X=toValue(_.replaceRef))!=null?X:!0)if(Array.isArray(B.value)){const Y=[...B.value];Y[E]=W,B.value=Y}else{const Y={...B.value,[E]:W};Object.setPrototypeOf(Y,Object.getPrototypeOf(B.value)),B.value=Y}else B.value[E]=W}}));return T}function tryOnMounted(B,_=!0,T){getLifeCycleTarget()?onMounted(B,T):_?B():nextTick(B)}function useIntervalFn(B,_=1e3,T={}){const{immediate:E=!0,immediateCallback:W=!1}=T;let X=null;const q=ref$1(!1);function Y(){X&&(clearInterval(X),X=null)}function te(){q.value=!1,Y()}function ne(){const ae=toValue(_);ae<=0||(q.value=!0,W&&B(),Y(),X=setInterval(B,ae))}if(E&&isClient&&ne(),isRef(_)||typeof _=="function"){const ae=watch(_,()=>{q.value&&isClient&&ne()});tryOnScopeDispose(ae)}return tryOnScopeDispose(te),{isActive:q,pause:te,resume:ne}}function unrefElement(B){var _;const T=toValue(B);return(_=T==null?void 0:T.$el)!=null?_:T}const defaultWindow=isClient?window:void 0;function useEventListener(...B){let _,T,E,W;if(typeof B[0]=="string"||Array.isArray(B[0])?([T,E,W]=B,_=defaultWindow):[_,T,E,W]=B,!_)return noop;Array.isArray(T)||(T=[T]),Array.isArray(E)||(E=[E]);const X=[],q=()=>{X.forEach(ae=>ae()),X.length=0},Y=(ae,le,ue,ge)=>(ae.addEventListener(le,ue,ge),()=>ae.removeEventListener(le,ue,ge)),te=watch(()=>[unrefElement(_),toValue(W)],([ae,le])=>{if(q(),!ae)return;const ue=isObject$2(le)?{...le}:le;X.push(...T.flatMap(ge=>E.map(ye=>Y(ae,ge,ye,ue))))},{immediate:!0,flush:"post"}),ne=()=>{te(),q()};return tryOnScopeDispose(ne),ne}function useMounted(){const B=ref$1(!1),_=getCurrentInstance();return _&&onMounted(()=>{B.value=!0},_),B}function useSupported(B){const _=useMounted();return computed(()=>(_.value,!!B()))}function useMutationObserver(B,_,T={}){const{window:E=defaultWindow,...W}=T;let X;const q=useSupported(()=>E&&"MutationObserver"in E),Y=()=>{X&&(X.disconnect(),X=void 0)},te=computed(()=>{const ue=toValue(B),ge=(Array.isArray(ue)?ue:[ue]).map(unrefElement).filter(notNullish);return new Set(ge)}),ne=watch(()=>te.value,ue=>{Y(),q.value&&ue.size&&(X=new MutationObserver(_),ue.forEach(ge=>X.observe(ge,W)))},{immediate:!0,flush:"post"}),ae=()=>X==null?void 0:X.takeRecords(),le=()=>{Y(),ne()};return tryOnScopeDispose(le),{isSupported:q,stop:le,takeRecords:ae}}function useRafFn(B,_={}){const{immediate:T=!0,fpsLimit:E=void 0,window:W=defaultWindow}=_,X=ref$1(!1),q=E?1e3/E:null;let Y=0,te=null;function ne(ue){if(!X.value||!W)return;Y||(Y=ue);const ge=ue-Y;if(q&&ge<q){te=W.requestAnimationFrame(ne);return}Y=ue,B({delta:ge,timestamp:ue}),te=W.requestAnimationFrame(ne)}function ae(){!X.value&&W&&(X.value=!0,Y=0,te=W.requestAnimationFrame(ne))}function le(){X.value=!1,te!=null&&W&&(W.cancelAnimationFrame(te),te=null)}return T&&ae(),tryOnScopeDispose(le),{isActive:readonly(X),pause:le,resume:ae}}function useMediaQuery(B,_={}){const{window:T=defaultWindow}=_,E=useSupported(()=>T&&"matchMedia"in T&&typeof T.matchMedia=="function");let W;const X=ref$1(!1),q=ne=>{X.value=ne.matches},Y=()=>{W&&("removeEventListener"in W?W.removeEventListener("change",q):W.removeListener(q))},te=watchEffect(()=>{E.value&&(Y(),W=T.matchMedia(toValue(B)),"addEventListener"in W?W.addEventListener("change",q):W.addListener(q),X.value=W.matches)});return tryOnScopeDispose(()=>{te(),Y(),W=void 0}),X}function useDevicePixelRatio(B={}){const{window:_=defaultWindow}=B,T=ref$1(1);if(_){let E=function(){T.value=_.devicePixelRatio,W(),X=_.matchMedia(`(resolution: ${T.value}dppx)`),X.addEventListener("change",E,{once:!0})},W=function(){X==null||X.removeEventListener("change",E)},X;E(),tryOnScopeDispose(W)}return{pixelRatio:T}}function useResizeObserver(B,_,T={}){const{window:E=defaultWindow,...W}=T;let X;const q=useSupported(()=>E&&"ResizeObserver"in E),Y=()=>{X&&(X.disconnect(),X=void 0)},te=computed(()=>Array.isArray(B)?B.map(le=>unrefElement(le)):[unrefElement(B)]),ne=watch(te,le=>{if(Y(),q.value&&E){X=new ResizeObserver(_);for(const ue of le)ue&&X.observe(ue,W)}},{immediate:!0,flush:"post"}),ae=()=>{Y(),ne()};return tryOnScopeDispose(ae),{isSupported:q,stop:ae}}function useElementBounding(B,_={}){const{reset:T=!0,windowResize:E=!0,windowScroll:W=!0,immediate:X=!0}=_,q=ref$1(0),Y=ref$1(0),te=ref$1(0),ne=ref$1(0),ae=ref$1(0),le=ref$1(0),ue=ref$1(0),ge=ref$1(0);function ye(){const xe=unrefElement(B);if(!xe){T&&(q.value=0,Y.value=0,te.value=0,ne.value=0,ae.value=0,le.value=0,ue.value=0,ge.value=0);return}const Te=xe.getBoundingClientRect();q.value=Te.height,Y.value=Te.bottom,te.value=Te.left,ne.value=Te.right,ae.value=Te.top,le.value=Te.width,ue.value=Te.x,ge.value=Te.y}return useResizeObserver(B,ye),watch(()=>unrefElement(B),xe=>!xe&&ye()),useMutationObserver(B,ye,{attributeFilter:["style","class"]}),W&&useEventListener("scroll",ye,{capture:!0,passive:!0}),E&&useEventListener("resize",ye,{passive:!0}),tryOnMounted(()=>{X&&ye()}),{height:q,bottom:Y,left:te,right:ne,top:ae,width:le,x:ue,y:ge,update:ye}}function useElementSize(B,_={width:0,height:0},T={}){const{window:E=defaultWindow,box:W="content-box"}=T,X=computed(()=>{var le,ue;return(ue=(le=unrefElement(B))==null?void 0:le.namespaceURI)==null?void 0:ue.includes("svg")}),q=ref$1(_.width),Y=ref$1(_.height),{stop:te}=useResizeObserver(B,([le])=>{const ue=W==="border-box"?le.borderBoxSize:W==="content-box"?le.contentBoxSize:le.devicePixelContentBoxSize;if(E&&X.value){const ge=unrefElement(B);if(ge){const ye=ge.getBoundingClientRect();q.value=ye.width,Y.value=ye.height}}else if(ue){const ge=Array.isArray(ue)?ue:[ue];q.value=ge.reduce((ye,{inlineSize:xe})=>ye+xe,0),Y.value=ge.reduce((ye,{blockSize:xe})=>ye+xe,0)}else q.value=le.contentRect.width,Y.value=le.contentRect.height},T);tryOnMounted(()=>{const le=unrefElement(B);le&&(q.value="offsetWidth"in le?le.offsetWidth:_.width,Y.value="offsetHeight"in le?le.offsetHeight:_.height)});const ne=watch(()=>unrefElement(B),le=>{q.value=le?_.width:0,Y.value=le?_.height:0});function ae(){te(),ne()}return{width:q,height:Y,stop:ae}}function useFps(B){var _;const T=ref$1(0);if(typeof performance>"u")return T;const E=(_=B==null?void 0:B.every)!=null?_:10;let W=performance.now(),X=0;return useRafFn(()=>{if(X+=1,X>=E){const q=performance.now(),Y=q-W;T.value=Math.round(1e3/(Y/X)),W=q,X=0}}),T}function useMemory(B={}){const _=ref$1(),T=useSupported(()=>typeof performance<"u"&&"memory"in performance);if(T.value){const{interval:E=1e3}=B;useIntervalFn(()=>{_.value=performance.memory},E,{immediate:B.immediate,immediateCallback:B.immediateCallback})}return{isSupported:T,memory:_}}const defaultState={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},keys$1=Object.keys(defaultState);function usePointer(B={}){const{target:_=defaultWindow}=B,T=ref$1(!1),E=ref$1(B.initialValue||{});Object.assign(E.value,defaultState,E.value);const W=X=>{T.value=!0,!(B.pointerTypes&&!B.pointerTypes.includes(X.pointerType))&&(E.value=objectPick(X,keys$1,!1))};if(_){const X={passive:!0};useEventListener(_,["pointerdown","pointermove","pointerup"],W,X),useEventListener(_,"pointerleave",()=>T.value=!1,X)}return{...toRefs(E),isInside:T}}function useWindowSize(B={}){const{window:_=defaultWindow,initialWidth:T=Number.POSITIVE_INFINITY,initialHeight:E=Number.POSITIVE_INFINITY,listenOrientation:W=!0,includeScrollbar:X=!0}=B,q=ref$1(T),Y=ref$1(E),te=()=>{_&&(X?(q.value=_.innerWidth,Y.value=_.innerHeight):(q.value=_.document.documentElement.clientWidth,Y.value=_.document.documentElement.clientHeight))};if(te(),tryOnMounted(te),useEventListener("resize",te,{passive:!0}),W){const ne=useMediaQuery("(orientation: portrait)");watch(ne,()=>te())}return{width:q,height:Y}}var Oe=Object.defineProperty,De=(B,_,T)=>_ in B?Oe(B,_,{enumerable:!0,configurable:!0,writable:!0,value:T}):B[_]=T,Q$1=(B,_,T)=>(De(B,typeof _!="symbol"?_+"":_,T),T);const bt="@tresjs/core",Et$1="module",Ct="3.9.0",xt="pnpm@8.15.6",Mt="Declarative ThreeJS using Vue Components",St="Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",kt="MIT",Pt=["vue","3d","threejs","three","threejs-vue"],Tt=!1,At={".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},Lt="./dist/tres.js",Ot="./dist/tres.js",Dt="./dist/index.d.ts",Bt=["*.d.ts","dist"],jt={access:"public"},Ht={dev:"cd playground && npm run dev",build:"vite build",playground:"cd playground && npm run dev",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts",prepare:"node .husky/install.mjs"},Rt={three:">=0.133",vue:">=3.3"},It={"@alvarosabu/utils":"^3.1.1","@vue/devtools-api":"^6.6.1","@vueuse/core":"^10.7.0"},$t={"@release-it/conventional-changelog":"^8.0.1","@stackblitz/sdk":"^1.9.0","@tresjs/cientos":"3.8.0","@tresjs/eslint-config":"^1.0.0","@tresjs/eslint-config-vue":"^0.2.1","@types/three":"^0.163.0","@typescript-eslint/eslint-plugin":"^7.7.1","@typescript-eslint/parser":"^7.7.1","@vitejs/plugin-vue":"^5.0.4","@vitest/coverage-c8":"^0.33.0","@vitest/ui":"^1.5.0","@vue/test-utils":"^2.4.3",eslint:"^9.1.1","eslint-plugin-vue":"^9.25.0",esno:"^4.0.0",gsap:"^3.12.3",husky:"^9.0.11",jsdom:"^24.0.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.1","release-it":"^17.2.0","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.11.0",three:"^0.163.0",unocss:"^0.59.4",unplugin:"^1.10.1","unplugin-vue-components":"^0.26.0",vite:"^5.2.10","vite-plugin-banner":"^0.7.1","vite-plugin-dts":"3.9.0","vite-plugin-inspect":"^0.8.4","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.1.3",vitest:"^1.5.0",vue:"^3.4.24","vue-demi":"^0.14.6"},zt={name:bt,type:Et$1,version:Ct,packageManager:xt,description:Mt,author:St,license:kt,keywords:Pt,sideEffects:Tt,exports:At,main:Lt,module:Ot,types:Dt,files:Bt,publishConfig:jt,scripts:Ht,peerDependencies:Rt,dependencies:It,devDependencies:$t},Nt=({sizes:B,scene:_})=>{const T=ref$1([]),E=computed(()=>T.value[0]),W=Y=>{const te=Y instanceof Camera?Y:T.value.find(ae=>ae.uuid===Y);if(!te)return;const ne=T.value.filter(({uuid:ae})=>ae!==te.uuid);T.value=[te,...ne]},X=(Y,te=!1)=>{T.value.some(({uuid:ne})=>ne===Y.uuid)||(te?W(Y):T.value.push(Y))},q=Y=>{T.value=T.value.filter(({uuid:te})=>te!==Y.uuid)};return watchEffect(()=>{B.aspectRatio.value&&T.value.forEach(Y=>{Y instanceof PerspectiveCamera&&(Y.aspect=B.aspectRatio.value),(Y instanceof PerspectiveCamera||Y instanceof OrthographicCamera)&&Y.updateProjectionMatrix()})}),_.userData.tres__registerCamera=X,_.userData.tres__deregisterCamera=q,onUnmounted(()=>{T.value=[]}),{camera:E,cameras:T,registerCamera:X,deregisterCamera:q,setCameraActive:W}},_e=createEventHook(),be$1=createEventHook(),re=createEventHook(),j=new Clock;let V=0,F=0;const{pause:Wt,resume:Vt,isActive:Ft}=useRafFn(()=>{_e.trigger({delta:V,elapsed:F,clock:j}),be$1.trigger({delta:V,elapsed:F,clock:j}),re.trigger({delta:V,elapsed:F,clock:j})},{immediate:!1});re.on(()=>{V=j.getDelta(),F=j.getElapsedTime()});const G=()=>({onBeforeLoop:_e.on,onLoop:be$1.on,onAfterLoop:re.on,pause:Wt,resume:Vt,isActive:Ft}),I="[TresJS   ] ";function P$2(){function B(...E){typeof E[0]=="string"?E[0]=I+E[0]:E.unshift(I),console.error(...E)}function _(...E){typeof E[0]=="string"?E[0]=I+E[0]:E.unshift(I),console.warn(...E)}function T(E,W){}return{logError:B,logWarning:_,logMessage:T}}function Ut(B){return B instanceof Color?B:Array.isArray(B)?new Color(...B):new Color(B)}class Gt extends Mesh{constructor(..._){super(..._),Q$1(this,"type","HightlightMesh"),Q$1(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const _=(Date.now()-this.createTime)/1e3,T=1+.07*Math.sin(2.5*_);this.scale.set(T,T,T)}}const Ee=(B,_)=>{for(const T of Object.keys(_))_[T]instanceof Object&&Object.assign(_[T],Ee(B[T],_[T]));return Object.assign(B||{},_),B},Qt="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",qt=Jt(Qt);function ce(B){return B&&B.nodeType===1}function $(B){return B.replace(/-([a-z])/g,(_,T)=>T.toUpperCase())}function Jt(B,_){const T=Object.create(null),E=B.split(",");for(let W=0;W<E.length;W++)T[E[W]]=!0;return W=>!!T[W]}const Yt=(B,_)=>{const T=new Set,E=[];for(const W of B){const X=_(W);T.has(X)||(T.add(X),E.push(W))}return E},de=(B,_)=>{if(!_)return;const T=Array.isArray(_)?_:_.match(/([^[.\]])+/g);return T==null?void 0:T.reduce((E,W)=>E&&E[W],B)},Kt=(B,_,T)=>{const E=Array.isArray(_)?_:_.match(/([^[.\]])+/g);E&&E.reduce((W,X,q)=>(W[X]===void 0&&(W[X]={}),q===E.length-1&&(W[X]=T),W[X]),B)};function Ce$1(B,_){if(ce(B)&&ce(_)){const W=B.attributes,X=_.attributes;return W.length!==X.length?!1:Array.from(W).every(({name:q,value:Y})=>_.getAttribute(q)===Y)}if(B===_)return!0;if(B===null||typeof B!="object"||_===null||typeof _!="object")return!1;const T=Object.keys(B),E=Object.keys(_);if(T.length!==E.length)return!1;for(const W of T)if(!E.includes(W)||!Ce$1(B[W],_[W]))return!1;return!0}function Xt(B,_){if(!Array.isArray(B)||!Array.isArray(_)||B.length!==_.length)return!1;for(let T=0;T<B.length;T++)if(!Ce$1(B[T],_[T]))return!1;return!0}const Zt=Array.isArray;function er(B,_,T,E){const W=te=>{if(te.uuid===_)return te;for(const ne of te.children){const ae=W(ne);if(ae)return ae}},X=W(B);if(!X){console.warn("Object with UUID not found in the scene.");return}let q=X;for(let te=0;te<T.length-1;te++)if(q[T[te]]!==void 0)q=q[T[te]];else{console.warn(`Property path is not valid: ${T.join(".")}`);return}const Y=T[T.length-1];q[Y]!==void 0?q[Y]=E:console.warn(`Property path is not valid: ${T.join(".")}`)}function tr(B){const _=new MeshBasicMaterial({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:DoubleSide});return new Gt(B.geometry.clone(),_)}const rr=Number.parseInt(REVISION.replace("dev","")),z$1={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:SRGBColorSpace,toneMapping:ACESFilmicToneMapping,toneMappingExposure:3,shadowMap:{enabled:!0,type:PCFSoftShadowMap}}};function or({scene:B,canvas:_,options:T,disableRender:E,contextParts:{sizes:W,camera:X}}){const q=computed(()=>({alpha:toValue(T.alpha),depth:toValue(T.depth),canvas:unrefElement(_),context:toValue(T.context),stencil:toValue(T.stencil),antialias:toValue(T.antialias)===void 0?!0:toValue(T.antialias),precision:toValue(T.precision),powerPreference:toValue(T.powerPreference),premultipliedAlpha:toValue(T.premultipliedAlpha),preserveDrawingBuffer:toValue(T.preserveDrawingBuffer),logarithmicDepthBuffer:toValue(T.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:toValue(T.failIfMajorPerformanceCaveat)})),Y=shallowRef(new WebGLRenderer(q.value));watch(q,()=>{Y.value.dispose(),Y.value=new WebGLRenderer(q.value)}),watchEffect(()=>{Y.value.setSize(W.width.value,W.height.value)});const{pixelRatio:te}=useDevicePixelRatio();watchEffect(()=>{Y.value.setPixelRatio(te.value)});const{logError:ne}=P$2(),ae=(()=>{const ye=new WebGLRenderer,xe={shadowMap:{enabled:ye.shadowMap.enabled,type:ye.shadowMap.type},toneMapping:ye.toneMapping,toneMappingExposure:ye.toneMappingExposure,outputColorSpace:ye.outputColorSpace};return ye.dispose(),xe})();watchEffect(()=>{const ye=toValue(T.preset);ye&&(ye in z$1||ne(`Renderer Preset must be one of these: ${Object.keys(z$1).join(", ")}`),Ee(Y.value,z$1[ye]));const xe=(Ie,Ve)=>{const $e=toValue(Ie),We=()=>{if(ye)return de(z$1[ye],Ve)};if($e!==void 0)return $e;const Ue=We();return Ue!==void 0?Ue:de(ae,Ve)},Te=(Ie,Ve)=>Kt(Y.value,Ve,xe(Ie,Ve));Te(T.shadows,"shadowMap.enabled"),Te(T.toneMapping,"toneMapping"),Te(T.shadowMapType,"shadowMap.type"),rr<150&&Te(!T.useLegacyLights,"physicallyCorrectLights"),Te(T.outputColorSpace,"outputColorSpace"),Te(T.toneMappingExposure,"toneMappingExposure");const Ae=xe(T.clearColor,"clearColor");Ae&&Y.value.setClearColor(Ae?Ut(Ae):new Color(0))});const{pause:le,resume:ue,onLoop:ge}=G();return ge(()=>{X.value&&!toValue(E)&&Y.value.render(B,X.value)}),ue(),onUnmounted(()=>{le(),Y.value.dispose(),Y.value.forceContextLoss()}),{renderer:Y}}const fe=B=>typeof B=="function";async function Nr$1(B,_){const T=new TextureLoader(_),E=W=>new Promise((X,q)=>{T.load(W,Y=>X(Y),()=>null,()=>{q(new Error("[useTextures] - Failed to load texture"))})});if(Zt(B)){const W=await Promise.all(B.map(X=>E(X)));return B.length>1?W:W[0]}else{const{map:W,displacementMap:X,normalMap:q,roughnessMap:Y,metalnessMap:te,aoMap:ne,alphaMap:ae,matcap:le}=B;return{map:W?await E(W):null,displacementMap:X?await E(X):null,normalMap:q?await E(q):null,roughnessMap:Y?await E(Y):null,metalnessMap:te?await E(te):null,aoMap:ne?await E(ne):null,alphaMap:ae?await E(ae):null,matcap:le?await E(le):null}}}const ir=(B,{renderer:_,camera:T,raycaster:E})=>{const W=computed(()=>_.value.domElement),{x:X,y:q}=usePointer({target:W}),{width:Y,height:te,top:ne,left:ae}=useElementBounding(W),le=({x:je,y:ze})=>{if(W.value)return{x:(je-ae.value)/Y.value*2-1,y:-((ze-ne.value)/te.value)*2+1}},ue=({x:je,y:ze})=>{if(T.value)return E.value.setFromCamera(new Vector2(je,ze),T.value),E.value.intersectObjects(B.value,!1)},ge=je=>{const ze=le({x:(je==null?void 0:je.clientX)??X.value,y:(je==null?void 0:je.clientY)??q.value});return ze?ue(ze)||[]:[]},ye=computed(()=>ge()),xe=createEventHook(),Te=createEventHook(),Ae=(je,ze)=>{je.trigger({event:ze,intersects:ge(ze)})},Ie=je=>{Ae(Te,je)};let Ve;const $e=je=>{var ze;Ve=(ze=ge(je)[0])==null?void 0:ze.object},We=je=>{var ze;je instanceof PointerEvent&&Ve===((ze=ge(je)[0])==null?void 0:ze.object)&&Ae(xe,je)},Ue=je=>Te.trigger({event:je,intersects:[]});return W.value.addEventListener("pointerup",We),W.value.addEventListener("pointerdown",$e),W.value.addEventListener("pointermove",Ie),W.value.addEventListener("pointerleave",Ue),onUnmounted(()=>{W!=null&&W.value&&(W.value.removeEventListener("pointerup",We),W.value.removeEventListener("pointerdown",$e),W.value.removeEventListener("pointermove",Ie),W.value.removeEventListener("pointerleave",Ue))}),{intersects:ye,onClick:je=>xe.on(je).off,onPointerMove:je=>Te.on(je).off}},ar$1=({scene:B,contextParts:_})=>{const T=reactive({click:new Map,pointerMove:new Map,pointerEnter:new Map,pointerLeave:new Map}),E=ref$1(new Set),W=ue=>{E.value.add(ue)},X=ue=>{E.value.delete(ue)},q=ue=>{Object.values(T).forEach(ge=>ge.delete(ue)),X(ue)},Y=ue=>{const{onClick:ge,onPointerMove:ye,onPointerEnter:xe,onPointerLeave:Te}=ue;ge&&T.click.set(ue,ge),ye&&T.pointerMove.set(ue,ye),xe&&T.pointerEnter.set(ue,xe),Te&&T.pointerLeave.set(ue,Te)};B.userData.tres__registerAtPointerEventHandler=Y,B.userData.tres__deregisterAtPointerEventHandler=q,B.userData.tres__registerBlockingObjectAtPointerEventHandler=W,B.userData.tres__deregisterBlockingObjectAtPointerEventHandler=X;const te=computed(()=>Yt([...Array.from(E.value),...Object.values(T).map(ue=>Array.from(ue.keys())).flat()],({uuid:ue})=>ue)),{onClick:ne,onPointerMove:ae}=ir(te,_);ne(({intersects:ue,event:ge})=>{var ye;ue.length&&((ye=T.click.get(ue[0].object))==null||ye(ue[0],ge))});let le;return ae(({intersects:ue,event:ge})=>{var ye,xe,Te,Ae;const Ie=(ye=ue==null?void 0:ue[0])==null?void 0:ye.object,{pointerLeave:Ve,pointerEnter:$e,pointerMove:We}=T;le&&le!==Ie&&((xe=Ve.get(le))==null||xe(le,ge)),Ie&&(le!==Ie&&((Te=$e.get(Ie))==null||Te(ue[0],ge)),(Ae=We.get(Ie))==null||Ae(ue[0],ge)),le=Ie||null}),{registerObject:Y,deregisterObject:q}};function Me(B){let _=0;return B.traverse(T=>{if(T.isMesh&&T.geometry){const E=T.geometry,W=E.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,X=E.index?E.index.count*Uint32Array.BYTES_PER_ELEMENT:0,q=E.attributes.normal?E.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,Y=E.attributes.uv?E.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,te=W+X+q+Y;_+=te}}),_}function lr$1(B){return(B/1024).toFixed(2)}const Z$1=ref$1({}),oe=B=>Object.assign(Z$1.value,B);function ur(B,_,T=10){const E=toValue(B)?useWindowSize():useElementSize(computed(()=>toValue(_).parentElement)),W=readonly(refDebounced(E.width,T)),X=readonly(refDebounced(E.height,T)),q=computed(()=>W.value/X.value);return{height:X,width:W,aspectRatio:q}}function cr({scene:B,canvas:_,windowSize:T,disableRender:E,rendererOptions:W}){const X=ur(T,_),q=shallowRef(B),{camera:Y,cameras:te,registerCamera:ne,deregisterCamera:ae,setCameraActive:le}=Nt({sizes:X,scene:B}),{renderer:ue}=or({scene:B,canvas:_,options:W,contextParts:{sizes:X,camera:Y},disableRender:E}),ge={sizes:X,scene:q,camera:Y,cameras:readonly(te),renderer:ue,raycaster:shallowRef(new Raycaster),controls:ref$1(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},extend:oe,registerCamera:ne,setCameraActive:le,deregisterCamera:ae};provide("useTres",ge);const ye=100,xe=useFps({every:ye}),{isSupported:Te,memory:Ae}=useMemory({interval:ye}),Ie=160;let Ve=performance.now();const $e=({timestamp:ze})=>{ge.scene.value&&(ge.perf.memory.allocatedMem=Me(ge.scene.value)),ze-Ve>=ye&&(Ve=ze,ge.perf.fps.accumulator.push(xe.value),ge.perf.fps.accumulator.length>Ie&&ge.perf.fps.accumulator.shift(),ge.perf.fps.value=xe.value,Te.value&&Ae.value&&(ge.perf.memory.accumulator.push(Ae.value.usedJSHeapSize/1024/1024),ge.perf.memory.accumulator.length>Ie&&ge.perf.memory.accumulator.shift(),ge.perf.memory.currentMem=ge.perf.memory.accumulator.reduce((He,Le)=>He+Le,0)/ge.perf.memory.accumulator.length))};let We=0;const Ue=1,{pause:je}=useRafFn(({delta:ze})=>{window.__TRES__DEVTOOLS__&&($e({timestamp:performance.now()}),We+=ze,We>=Ue&&(window.__TRES__DEVTOOLS__.cb(ge),We=0))},{immediate:!0});return onUnmounted(()=>{je()}),ge}function dr(){const B=inject("useTres");if(!B)throw new Error("useTresContext must be used together with useTresContextProvider");return B}let g=null;const{logError:pe}=P$2(),J=["onClick","onPointerMove","onPointerEnter","onPointerLeave"],fr={createElement(B,_,T,E){var W,X;if(E||(E={}),E.args||(E.args=[]),B==="template"||qt(B))return null;let q=B.replace("Tres",""),Y;if(B==="primitive"){(E==null?void 0:E.object)===void 0&&pe("Tres primitives need a prop 'object'");const te=E.object;q=te.type,Y=Object.assign(te,{type:q,attach:E.attach,primitive:!0})}else{const te=Z$1.value[q];te||pe(`${q} is not defined on the THREE namespace. Use extend to add it to the catalog.`),Y=new te(...E.args)}return Y.isCamera&&(E!=null&&E.position||Y.position.set(3,3,3),E!=null&&E.lookAt||Y.lookAt(0,0,0)),(E==null?void 0:E.attach)===void 0&&(Y.isMaterial?Y.attach="material":Y.isBufferGeometry&&(Y.attach="geometry")),Y.isObject3D&&((W=E==null?void 0:E.material)!=null&&W.isMaterial&&(Y.userData.tres__materialViaProp=!0),(X=E==null?void 0:E.geometry)!=null&&X.isBufferGeometry&&(Y.userData.tres__geometryViaProp=!0)),Y.userData={...Y.userData,tres__name:q},Y},insert(B,_){var T,E,W,X;_&&_.isScene&&(g=_);const q=_||g;if(B!=null&&B.isObject3D){if(B!=null&&B.isCamera){if(!(g!=null&&g.userData.tres__registerCamera))throw new Error("could not find tres__registerCamera on scene's userData");(E=g==null?void 0:(T=g.userData).tres__registerCamera)==null||E.call(T,B)}if(B&&J.some(Y=>B[Y])){if(!(g!=null&&g.userData.tres__registerAtPointerEventHandler))throw new Error("could not find tres__registerAtPointerEventHandler on scene's userData");(X=g==null?void 0:(W=g.userData).tres__registerAtPointerEventHandler)==null||X.call(W,B)}}B!=null&&B.isObject3D&&q!=null&&q.isObject3D?(q.add(B),B.dispatchEvent({type:"added"})):B!=null&&B.isFog?q.fog=B:typeof(B==null?void 0:B.attach)=="string"&&(B.__previousAttach=B[q==null?void 0:q.attach],q&&(q[B.attach]=B))},remove(B){var _,T;if(B){if(B.isObject3D){const E=B,W=ne=>{var ae,le;const ue=ne;ne.userData.tres__materialViaProp||((ae=ue.material)==null||ae.dispose(),ue.material=void 0),ne.userData.tres__geometryViaProp||((le=ue.geometry)==null||le.dispose(),ue.geometry=void 0)},X=g==null?void 0:g.userData.tres__deregisterAtPointerEventHandler,q=g==null?void 0:g.userData.tres__deregisterBlockingObjectAtPointerEventHandler,Y=ne=>{var ae,le;if(!q)throw new Error("could not find tres__deregisterBlockingObjectAtPointerEventHandler on scene's userData");if((le=g==null?void 0:(ae=g.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||le.call(ae,ne),!X)throw new Error("could not find tres__deregisterAtPointerEventHandler on scene's userData");ne&&J.some(ue=>ne[ue])&&(X==null||X(ne))},te=ne=>{const ae=g==null?void 0:g.userData.tres__deregisterCamera;if(!ae)throw new Error("could not find tres__deregisterCamera on scene's userData");ne.isCamera&&(ae==null||ae(ne))};(_=B.removeFromParent)==null||_.call(B),E.traverse(ne=>{W(ne),te(ne),Y==null||Y(ne)}),W(E),te(E),Y==null||Y(E)}(T=B.dispose)==null||T.call(B)}},patchProp(B,_,T,E){var W,X,q,Y;if(B){let te=B,ne=_;if(B.isObject3D&&ne==="blocks-pointer-events"){E||E===""?(X=g==null?void 0:(W=g.userData).tres__registerBlockingObjectAtPointerEventHandler)==null||X.call(W,B):(Y=g==null?void 0:(q=g.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||Y.call(q,B);return}let ae=$(ne),le=te==null?void 0:te[ae];if(ne==="args"){const ge=B,ye=T??[],xe=E??[],Te=B.userData.tres__name||B.type;Te&&ye.length&&!Xt(ye,xe)&&(te=Object.assign(ge,new Z$1.value[Te](...E)));return}if(te.type==="BufferGeometry"){if(ne==="args")return;te.setAttribute($(ne),new BufferAttribute(...E));return}if(ne.includes("-")&&le===void 0){const ge=ne.split("-");le=ge.reduce((ye,xe)=>ye[$(xe)],te),ne=ge.pop(),ae=ne.toLowerCase(),le!=null&&le.set||(te=ge.reduce((ye,xe)=>ye[$(xe)],te))}let ue=E;if(ue===""&&(ue=!0),fe(le)){J.includes(_)||(Array.isArray(ue)?B[ae](...ue):B[ae](ue));return}!(le!=null&&le.set)&&!fe(le)?te[ae]=ue:le.constructor===ue.constructor&&le!=null&&le.copy?le==null||le.copy(ue):Array.isArray(ue)?le.set(...ue):!le.isColor&&le.setScalar?le.setScalar(ue):le.set(ue)}},parentNode(B){return(B==null?void 0:B.parent)||null},createText:()=>{},createComment:()=>{},setText:()=>{},setElementText:()=>{},nextSibling:()=>{},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}},{render:pr$1}=createRenderer(fr);oe(he);function mr(){return Se().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Se(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const gr$1=typeof Proxy=="function",vr="devtools-plugin:setup",hr="plugin:settings:set";let O,ee;function yr(){var B;return O!==void 0||(typeof window<"u"&&window.performance?(O=!0,ee=window.performance):typeof globalThis<"u"&&!((B=globalThis.perf_hooks)===null||B===void 0)&&B.performance?(O=!0,ee=globalThis.perf_hooks.performance):O=!1),O}function wr(){return yr()?ee.now():Date.now()}class _r{constructor(_,T){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=_,this.hook=T;const E={};if(_.settings)for(const q in _.settings){const Y=_.settings[q];E[q]=Y.defaultValue}const W=`__vue-devtools-plugin-settings__${_.id}`;let X=Object.assign({},E);try{const q=localStorage.getItem(W),Y=JSON.parse(q);Object.assign(X,Y)}catch{}this.fallbacks={getSettings(){return X},setSettings(q){try{localStorage.setItem(W,JSON.stringify(q))}catch{}X=q},now(){return wr()}},T&&T.on(hr,(q,Y)=>{q===this.plugin.id&&this.fallbacks.setSettings(Y)}),this.proxiedOn=new Proxy({},{get:(q,Y)=>this.target?this.target.on[Y]:(...te)=>{this.onQueue.push({method:Y,args:te})}}),this.proxiedTarget=new Proxy({},{get:(q,Y)=>this.target?this.target[Y]:Y==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(Y)?(...te)=>(this.targetQueue.push({method:Y,args:te,resolve:()=>{}}),this.fallbacks[Y](...te)):(...te)=>new Promise(ne=>{this.targetQueue.push({method:Y,args:te,resolve:ne})})})}async setRealTarget(_){this.target=_;for(const T of this.onQueue)this.target.on[T.method](...T.args);for(const T of this.targetQueue)T.resolve(await this.target[T.method](...T.args))}}function br(B,_){const T=B,E=Se(),W=mr(),X=gr$1&&T.enableEarlyProxy;if(W&&(E.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!X))W.emit(vr,B,_);else{const q=X?new _r(T,W):null;(E.__VUE_DEVTOOLS_PLUGINS__=E.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:T,setupFn:_,proxy:q}),q&&_(q.proxiedTarget)}}function Er(B,_){const T=`  ${B}`;typeof __VUE_DEVTOOLS_TOAST__=="function"?__VUE_DEVTOOLS_TOAST__(T,_):console.log(T)}const ke=B=>{const _={id:B.uuid,label:B.type,children:[],tags:[]};B.name!==""&&_.tags.push({label:B.name,textColor:5750629,backgroundColor:15793395});const T=Me(B);return T>0&&_.tags.push({label:`${lr$1(T)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),B.type.includes("Light")&&(_.tags.push({label:`${B.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),_.tags.push({label:`#${B.color.getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),B.type.includes("Camera")&&(_.tags.push({label:`${B.fov}`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),_.tags.push({label:`x: ${Math.round(B.position.x)} y: ${Math.round(B.position.y)} z: ${Math.round(B.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),_};function Pe(B,_){B.children.forEach(T=>{if(T.type==="HightlightMesh")return;const E=ke(T);_.children.push(E),Pe(T,E)})}const Cr$1=[],D="tres:inspector",xr=reactive({sceneGraph:null});function Mr$1(B,_){br({id:"dev.esm.tres",label:"TresJS ",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:Cr$1,app:B},T=>{typeof T.now!="function"&&Er("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),T.addInspector({id:D,label:"TresJS ",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{T.sendInspectorTree(D)},1e3),setInterval(()=>{T.notifyComponentUpdate()},5e3),T.on.getInspectorTree(X=>{if(X.inspectorId===D){const q=ke(_.scene.value);Pe(_.scene.value,q),xr.sceneGraph=q,X.rootNodes=[q]}});let E=null,W=null;T.on.getInspectorState(X=>{if(X.inspectorId===D){const[q]=_.scene.value.getObjectsByProperty("uuid",X.nodeId);if(!q)return;if(W&&E&&E.parent&&W.remove(E),q.isMesh){const Y=tr(q);q.add(Y),E=Y,W=q}X.state={object:[{key:"uuid",editable:!0,value:q.uuid},{key:"name",editable:!0,value:q.name},{key:"type",editable:!0,value:q.type},{key:"position",editable:!0,value:q.position},{key:"rotation",editable:!0,value:q.rotation},{key:"scale",editable:!0,value:q.scale},{key:"geometry",value:q.geometry},{key:"material",value:q.material},{key:"color",editable:!0,value:q.color},{key:"intensity",editable:!0,value:q.intensity},{key:"castShadow",editable:!0,value:q.castShadow},{key:"receiveShadow",editable:!0,value:q.receiveShadow},{key:"frustumCulled",editable:!0,value:q.frustumCulled},{key:"matrixAutoUpdate",editable:!0,value:q.matrixAutoUpdate},{key:"matrixWorldNeedsUpdate",editable:!0,value:q.matrixWorldNeedsUpdate},{key:"matrixWorld",value:q.matrixWorld},{key:"visible",editable:!0,value:q.visible}]}}}),T.on.editInspectorState(X=>{X.inspectorId===D&&er(_.scene.value,X.nodeId,X.path,X.state.value)})})}const Sr=["data-scene","data-tres"],kr=defineComponent({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},setup(B,{expose:_}){var T;const E=B,W=useSlots(),{logWarning:X}=P$2(),q=ref$1(),Y=shallowRef(new Scene),{resume:te}=G(),ne=(T=getCurrentInstance())==null?void 0:T.appContext.app,ae=xe=>defineComponent({setup(){var Te;const Ae=(Te=getCurrentInstance())==null?void 0:Te.appContext;return Ae&&(Ae.app=ne),provide("useTres",xe),provide("extend",oe),typeof window<"u"&&Mr$1(Ae.app,xe),()=>h$1(Fragment,null,W!=null&&W.default?W.default():[])}}),le=xe=>{const Te=ae(xe);pr$1(h$1(Te),Y.value)},ue=(xe,Te=!1)=>{Y.value.children=[],Te&&(xe.renderer.value.dispose(),xe.renderer.value.renderLists.dispose(),xe.renderer.value.forceContextLoss()),le(xe),te()},ge=computed(()=>E.disableRender),ye=shallowRef(null);return _({context:ye,dispose:()=>ue(ye.value,!0)}),onMounted(()=>{const xe=q;ye.value=cr({scene:Y.value,canvas:xe,windowSize:E.windowSize,disableRender:ge,rendererOptions:E}),ar$1({scene:Y.value,contextParts:ye.value});const{registerCamera:Te,camera:Ae,cameras:Ie,deregisterCamera:Ve}=ye.value;le(ye.value);const $e=()=>{const We=new PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3);We.position.set(3,3,3),We.lookAt(0,0,0),Te(We);const Ue=watchEffect(()=>{Ie.value.length>=2&&(We.removeFromParent(),Ve(We),Ue==null||Ue())})};watch(()=>E.camera,(We,Ue)=>{We&&Te(We),Ue&&(Ue.removeFromParent(),Ve(Ue))},{immediate:!0}),Ae.value||(X("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),$e())}),(xe,Te)=>(openBlock(),createElementBlock("canvas",{ref_key:"canvas",ref:q,"data-scene":Y.value.uuid,class:normalizeClass(xe.$attrs.class),"data-tres":`tresjs ${unref(zt).version}`,style:normalizeStyle({display:"block",width:"100%",height:"100%",position:xe.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...xe.$attrs.style})},null,14,Sr))}}),Yr$1={install(B){B.component("TresCanvas",kr)}};/*! Tweakpane 4.0.3 (c) 2016 cocopon, licensed under the MIT license. */function forceCast(B){return B}function isEmpty(B){return B==null}function isObject$1(B){return B!==null&&typeof B=="object"}function isRecord(B){return B!==null&&typeof B=="object"}function deepEqualsArray(B,_){if(B.length!==_.length)return!1;for(let T=0;T<B.length;T++)if(B[T]!==_[T])return!1;return!0}function deepMerge(B,_){return Array.from(new Set([...Object.keys(B),...Object.keys(_)])).reduce((E,W)=>{const X=B[W],q=_[W];return isRecord(X)&&isRecord(q)?Object.assign(Object.assign({},E),{[W]:deepMerge(X,q)}):Object.assign(Object.assign({},E),{[W]:W in _?q:X})},{})}function isBinding(B){return isObject$1(B)?"target"in B:!1}const CREATE_MESSAGE_MAP={alreadydisposed:()=>"View has been already disposed",invalidparams:B=>`Invalid parameters for '${B.name}'`,nomatchingcontroller:B=>`No matching controller for '${B.key}'`,nomatchingview:B=>`No matching view for '${JSON.stringify(B.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:B=>`Not compatible with  plugin '${B.id}'`,propertynotfound:B=>`Property '${B.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class TpError{static alreadyDisposed(){return new TpError({type:"alreadydisposed"})}static notBindable(){return new TpError({type:"notbindable"})}static notCompatible(_,T){return new TpError({type:"notcompatible",context:{id:`${_}.${T}`}})}static propertyNotFound(_){return new TpError({type:"propertynotfound",context:{name:_}})}static shouldNeverHappen(){return new TpError({type:"shouldneverhappen"})}constructor(_){var T;this.message=(T=CREATE_MESSAGE_MAP[_.type](_.context))!==null&&T!==void 0?T:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=_.type}toString(){return this.message}}class BindingTarget{constructor(_,T){this.obj_=_,this.key=T}static isBindable(_){return!(_===null||typeof _!="object"&&typeof _!="function")}read(){return this.obj_[this.key]}write(_){this.obj_[this.key]=_}writeProperty(_,T){const E=this.read();if(!BindingTarget.isBindable(E))throw TpError.notBindable();if(!(_ in E))throw TpError.propertyNotFound(_);E[_]=T}}class Emitter{constructor(){this.observers_={}}on(_,T,E){var W;let X=this.observers_[_];return X||(X=this.observers_[_]=[]),X.push({handler:T,key:(W=E==null?void 0:E.key)!==null&&W!==void 0?W:T}),this}off(_,T){const E=this.observers_[_];return E&&(this.observers_[_]=E.filter(W=>W.key!==T)),this}emit(_,T){const E=this.observers_[_];E&&E.forEach(W=>{W.handler(T)})}}class ComplexValue{constructor(_,T){var E;this.constraint_=T==null?void 0:T.constraint,this.equals_=(E=T==null?void 0:T.equals)!==null&&E!==void 0?E:(W,X)=>W===X,this.emitter=new Emitter,this.rawValue_=_}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(_){this.setRawValue(_,{forceEmit:!1,last:!0})}setRawValue(_,T){const E=T??{forceEmit:!1,last:!0},W=this.constraint_?this.constraint_.constrain(_):_,X=this.rawValue_;this.equals_(X,W)&&!E.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=W,this.emitter.emit("change",{options:E,previousRawValue:X,rawValue:W,sender:this}))}}class PrimitiveValue{constructor(_){this.emitter=new Emitter,this.value_=_}get rawValue(){return this.value_}set rawValue(_){this.setRawValue(_,{forceEmit:!1,last:!0})}setRawValue(_,T){const E=T??{forceEmit:!1,last:!0},W=this.value_;W===_&&!E.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=_,this.emitter.emit("change",{options:E,previousRawValue:W,rawValue:this.value_,sender:this}))}}class ReadonlyPrimitiveValue{constructor(_){this.emitter=new Emitter,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=_,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(_){this.emitter.emit("beforechange",Object.assign(Object.assign({},_),{sender:this}))}onValueChange_(_){this.emitter.emit("change",Object.assign(Object.assign({},_),{sender:this}))}}function createValue(B,_){const T=_==null?void 0:_.constraint,E=_==null?void 0:_.equals;return!T&&!E?new PrimitiveValue(B):new ComplexValue(B,_)}function createReadonlyValue(B){return[new ReadonlyPrimitiveValue(B),(_,T)=>{B.setRawValue(_,T)}]}class ValueMap{constructor(_){this.emitter=new Emitter,this.valMap_=_;for(const T in this.valMap_)this.valMap_[T].emitter.on("change",()=>{this.emitter.emit("change",{key:T,sender:this})})}static createCore(_){return Object.keys(_).reduce((E,W)=>Object.assign(E,{[W]:createValue(_[W])}),{})}static fromObject(_){const T=this.createCore(_);return new ValueMap(T)}get(_){return this.valMap_[_].rawValue}set(_,T){this.valMap_[_].rawValue=T}value(_){return this.valMap_[_]}}class DefiniteRangeConstraint{constructor(_){this.values=ValueMap.fromObject({max:_.max,min:_.min})}constrain(_){const T=this.values.get("max"),E=this.values.get("min");return Math.min(Math.max(_,E),T)}}class RangeConstraint{constructor(_){this.values=ValueMap.fromObject({max:_.max,min:_.min})}constrain(_){const T=this.values.get("max"),E=this.values.get("min");let W=_;return isEmpty(E)||(W=Math.max(W,E)),isEmpty(T)||(W=Math.min(W,T)),W}}class StepConstraint{constructor(_,T=0){this.step=_,this.origin=T}constrain(_){const T=this.origin%this.step,E=Math.round((_-T)/this.step);return T+E*this.step}}class NumberLiteralNode{constructor(_){this.text=_}evaluate(){return Number(this.text)}toString(){return this.text}}const BINARY_OPERATION_MAP={"**":(B,_)=>Math.pow(B,_),"*":(B,_)=>B*_,"/":(B,_)=>B/_,"%":(B,_)=>B%_,"+":(B,_)=>B+_,"-":(B,_)=>B-_,"<<":(B,_)=>B<<_,">>":(B,_)=>B>>_,">>>":(B,_)=>B>>>_,"&":(B,_)=>B&_,"^":(B,_)=>B^_,"|":(B,_)=>B|_};class BinaryOperationNode{constructor(_,T,E){this.left=T,this.operator=_,this.right=E}evaluate(){const _=BINARY_OPERATION_MAP[this.operator];if(!_)throw new Error(`unexpected binary operator: '${this.operator}`);return _(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const UNARY_OPERATION_MAP={"+":B=>B,"-":B=>-B,"~":B=>~B};class UnaryOperationNode{constructor(_,T){this.operator=_,this.expression=T}evaluate(){const _=UNARY_OPERATION_MAP[this.operator];if(!_)throw new Error(`unexpected unary operator: '${this.operator}`);return _(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function combineReader(B){return(_,T)=>{for(let E=0;E<B.length;E++){const W=B[E](_,T);if(W!=="")return W}return""}}function readWhitespace(B,_){var T;const E=B.substr(_).match(/^\s+/);return(T=E&&E[0])!==null&&T!==void 0?T:""}function readNonZeroDigit(B,_){const T=B.substr(_,1);return T.match(/^[1-9]$/)?T:""}function readDecimalDigits(B,_){var T;const E=B.substr(_).match(/^[0-9]+/);return(T=E&&E[0])!==null&&T!==void 0?T:""}function readSignedInteger(B,_){const T=readDecimalDigits(B,_);if(T!=="")return T;const E=B.substr(_,1);if(_+=1,E!=="-"&&E!=="+")return"";const W=readDecimalDigits(B,_);return W===""?"":E+W}function readExponentPart(B,_){const T=B.substr(_,1);if(_+=1,T.toLowerCase()!=="e")return"";const E=readSignedInteger(B,_);return E===""?"":T+E}function readDecimalIntegerLiteral(B,_){const T=B.substr(_,1);if(T==="0")return T;const E=readNonZeroDigit(B,_);return _+=E.length,E===""?"":E+readDecimalDigits(B,_)}function readDecimalLiteral1(B,_){const T=readDecimalIntegerLiteral(B,_);if(_+=T.length,T==="")return"";const E=B.substr(_,1);if(_+=E.length,E!==".")return"";const W=readDecimalDigits(B,_);return _+=W.length,T+E+W+readExponentPart(B,_)}function readDecimalLiteral2(B,_){const T=B.substr(_,1);if(_+=T.length,T!==".")return"";const E=readDecimalDigits(B,_);return _+=E.length,E===""?"":T+E+readExponentPart(B,_)}function readDecimalLiteral3(B,_){const T=readDecimalIntegerLiteral(B,_);return _+=T.length,T===""?"":T+readExponentPart(B,_)}const readDecimalLiteral=combineReader([readDecimalLiteral1,readDecimalLiteral2,readDecimalLiteral3]);function parseBinaryDigits(B,_){var T;const E=B.substr(_).match(/^[01]+/);return(T=E&&E[0])!==null&&T!==void 0?T:""}function readBinaryIntegerLiteral(B,_){const T=B.substr(_,2);if(_+=T.length,T.toLowerCase()!=="0b")return"";const E=parseBinaryDigits(B,_);return E===""?"":T+E}function readOctalDigits(B,_){var T;const E=B.substr(_).match(/^[0-7]+/);return(T=E&&E[0])!==null&&T!==void 0?T:""}function readOctalIntegerLiteral(B,_){const T=B.substr(_,2);if(_+=T.length,T.toLowerCase()!=="0o")return"";const E=readOctalDigits(B,_);return E===""?"":T+E}function readHexDigits(B,_){var T;const E=B.substr(_).match(/^[0-9a-f]+/i);return(T=E&&E[0])!==null&&T!==void 0?T:""}function readHexIntegerLiteral(B,_){const T=B.substr(_,2);if(_+=T.length,T.toLowerCase()!=="0x")return"";const E=readHexDigits(B,_);return E===""?"":T+E}const readNonDecimalIntegerLiteral=combineReader([readBinaryIntegerLiteral,readOctalIntegerLiteral,readHexIntegerLiteral]),readNumericLiteral=combineReader([readNonDecimalIntegerLiteral,readDecimalLiteral]);function parseLiteral(B,_){const T=readNumericLiteral(B,_);return _+=T.length,T===""?null:{evaluable:new NumberLiteralNode(T),cursor:_}}function parseParenthesizedExpression(B,_){const T=B.substr(_,1);if(_+=T.length,T!=="(")return null;const E=parseExpression(B,_);if(!E)return null;_=E.cursor,_+=readWhitespace(B,_).length;const W=B.substr(_,1);return _+=W.length,W!==")"?null:{evaluable:E.evaluable,cursor:_}}function parsePrimaryExpression(B,_){var T;return(T=parseLiteral(B,_))!==null&&T!==void 0?T:parseParenthesizedExpression(B,_)}function parseUnaryExpression(B,_){const T=parsePrimaryExpression(B,_);if(T)return T;const E=B.substr(_,1);if(_+=E.length,E!=="+"&&E!=="-"&&E!=="~")return null;const W=parseUnaryExpression(B,_);return W?(_=W.cursor,{cursor:_,evaluable:new UnaryOperationNode(E,W.evaluable)}):null}function readBinaryOperator(B,_,T){T+=readWhitespace(_,T).length;const E=B.filter(W=>_.startsWith(W,T))[0];return E?(T+=E.length,T+=readWhitespace(_,T).length,{cursor:T,operator:E}):null}function createBinaryOperationExpressionParser(B,_){return(T,E)=>{const W=B(T,E);if(!W)return null;E=W.cursor;let X=W.evaluable;for(;;){const q=readBinaryOperator(_,T,E);if(!q)break;E=q.cursor;const Y=B(T,E);if(!Y)return null;E=Y.cursor,X=new BinaryOperationNode(q.operator,X,Y.evaluable)}return X?{cursor:E,evaluable:X}:null}}const parseBinaryOperationExpression=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((B,_)=>createBinaryOperationExpressionParser(B,_),parseUnaryExpression);function parseExpression(B,_){return _+=readWhitespace(B,_).length,parseBinaryOperationExpression(B,_)}function parseEcmaNumberExpression(B){const _=parseExpression(B,0);return!_||_.cursor+readWhitespace(B,_.cursor).length!==B.length?null:_.evaluable}function parseNumber(B){var _;const T=parseEcmaNumberExpression(B);return(_=T==null?void 0:T.evaluate())!==null&&_!==void 0?_:null}function numberFromUnknown(B){if(typeof B=="number")return B;if(typeof B=="string"){const _=parseNumber(B);if(!isEmpty(_))return _}return 0}function createNumberFormatter(B){return _=>_.toFixed(Math.max(Math.min(B,20),0))}function mapRange$1(B,_,T,E,W){const X=(B-_)/(T-_);return E+X*(W-E)}function getDecimalDigits(B){return String(B.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function constrainRange(B,_,T){return Math.min(Math.max(B,_),T)}function loopRange(B,_){return(B%_+_)%_}function getSuitableDecimalDigits(B,_){return isEmpty(B.step)?Math.max(getDecimalDigits(_),2):getDecimalDigits(B.step)}function getSuitableKeyScale(B){var _;return(_=B.step)!==null&&_!==void 0?_:1}function getSuitablePointerScale(B,_){var T;const E=Math.abs((T=B.step)!==null&&T!==void 0?T:_);return E===0?.1:Math.pow(10,Math.floor(Math.log10(E))-1)}function createStepConstraint(B,_){return isEmpty(B.step)?null:new StepConstraint(B.step,_)}function createRangeConstraint(B){return!isEmpty(B.max)&&!isEmpty(B.min)?new DefiniteRangeConstraint({max:B.max,min:B.min}):!isEmpty(B.max)||!isEmpty(B.min)?new RangeConstraint({max:B.max,min:B.min}):null}function createNumberTextPropsObject(B,_){var T,E,W;return{formatter:(T=B.format)!==null&&T!==void 0?T:createNumberFormatter(getSuitableDecimalDigits(B,_)),keyScale:(E=B.keyScale)!==null&&E!==void 0?E:getSuitableKeyScale(B),pointerScale:(W=B.pointerScale)!==null&&W!==void 0?W:getSuitablePointerScale(B,_)}}function createNumberTextInputParamsParser(B){return{format:B.optional.function,keyScale:B.optional.number,max:B.optional.number,min:B.optional.number,pointerScale:B.optional.number,step:B.optional.number}}function createPointAxis(B){return{constraint:B.constraint,textProps:ValueMap.fromObject(createNumberTextPropsObject(B.params,B.initialValue))}}class BladeApi{constructor(_){this.controller=_}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(_){this.controller.viewProps.set("disabled",_)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(_){this.controller.viewProps.set("hidden",_)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(_){return this.controller.importState(_)}exportState(){return this.controller.exportState()}}class TpEvent{constructor(_){this.target=_}}class TpChangeEvent extends TpEvent{constructor(_,T,E){super(_),this.value=T,this.last=E??!0}}class TpFoldEvent extends TpEvent{constructor(_,T){super(_),this.expanded=T}}class TpTabSelectEvent extends TpEvent{constructor(_,T){super(_),this.index=T}}class TpMouseEvent extends TpEvent{constructor(_,T){super(_),this.native=T}}class BindingApi extends BladeApi{constructor(_){super(_),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Emitter,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(_){this.controller.labelController.props.set("label",_)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(_){this.controller.tag=_}on(_,T){const E=T.bind(this);return this.emitter_.on(_,W=>{E(W)},{key:T}),this}off(_,T){return this.emitter_.off(_,T),this}refresh(){this.controller.value.fetch()}onValueChange_(_){const T=this.controller.value;this.emitter_.emit("change",new TpChangeEvent(this,T.binding.target.read(),_.options.last))}}function parseObject(B,_){const E=Object.keys(_).reduce((W,X)=>{if(W===void 0)return;const q=_[X],Y=q(B[X]);return Y.succeeded?Object.assign(Object.assign({},W),{[X]:Y.value}):void 0},{});return E}function parseArray(B,_){return B.reduce((T,E)=>{if(T===void 0)return;const W=_(E);if(!(!W.succeeded||W.value===void 0))return[...T,W.value]},[])}function isObject(B){return B===null?!1:typeof B=="object"}function createMicroParserBuilder(B){return _=>T=>{if(!_&&T===void 0)return{succeeded:!1,value:void 0};if(_&&T===void 0)return{succeeded:!0,value:void 0};const E=B(T);return E!==void 0?{succeeded:!0,value:E}:{succeeded:!1,value:void 0}}}function createMicroParserBuilders(B){return{custom:_=>createMicroParserBuilder(_)(B),boolean:createMicroParserBuilder(_=>typeof _=="boolean"?_:void 0)(B),number:createMicroParserBuilder(_=>typeof _=="number"?_:void 0)(B),string:createMicroParserBuilder(_=>typeof _=="string"?_:void 0)(B),function:createMicroParserBuilder(_=>typeof _=="function"?_:void 0)(B),constant:_=>createMicroParserBuilder(T=>T===_?_:void 0)(B),raw:createMicroParserBuilder(_=>_)(B),object:_=>createMicroParserBuilder(T=>{if(isObject(T))return parseObject(T,_)})(B),array:_=>createMicroParserBuilder(T=>{if(Array.isArray(T))return parseArray(T,_)})(B)}}const MicroParsers={optional:createMicroParserBuilders(!0),required:createMicroParserBuilders(!1)};function parseRecord(B,_){const T=_(MicroParsers),E=MicroParsers.required.object(T)(B);return E.succeeded?E.value:void 0}function importBladeState(B,_,T,E){if(_&&!_(B))return!1;const W=parseRecord(B,T);return W?E(W):!1}function exportBladeState(B,_){var T;return deepMerge((T=B==null?void 0:B())!==null&&T!==void 0?T:{},_)}function isValueBladeController(B){return"value"in B}function isBindingValue(B){if(!isObject$1(B)||!("binding"in B))return!1;const _=B.binding;return isBinding(_)}const SVG_NS="http://www.w3.org/2000/svg";function forceReflow(B){B.offsetHeight}function disableTransitionTemporarily(B,_){const T=B.style.transition;B.style.transition="none",_(),B.style.transition=T}function supportsTouch(B){return B.ontouchstart!==void 0}function getCanvasContext(B){const _=B.ownerDocument.defaultView;return _&&"document"in _?B.getContext("2d",{willReadFrequently:!0}):null}const ICON_ID_TO_INNER_HTML_MAP={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function createSvgIconElement(B,_){const T=B.createElementNS(SVG_NS,"svg");return T.innerHTML=ICON_ID_TO_INNER_HTML_MAP[_],T}function insertElementAt(B,_,T){B.insertBefore(_,B.children[T])}function removeElement(B){B.parentElement&&B.parentElement.removeChild(B)}function removeChildElements(B){for(;B.children.length>0;)B.removeChild(B.children[0])}function removeChildNodes(B){for(;B.childNodes.length>0;)B.removeChild(B.childNodes[0])}function findNextTarget(B){return B.relatedTarget?B.relatedTarget:"explicitOriginalTarget"in B?B.explicitOriginalTarget:null}function bindValue(B,_){B.emitter.on("change",T=>{_(T.rawValue)}),_(B.rawValue)}function bindValueMap(B,_,T){bindValue(B.value(_),T)}const PREFIX="tp";function ClassName(B){return(T,E)=>[PREFIX,"-",B,"v",T?`_${T}`:"",E?`-${E}`:""].join("")}const cn$r=ClassName("lbl");function createLabelNode(B,_){const T=B.createDocumentFragment();return _.split(`
`).map(W=>B.createTextNode(W)).forEach((W,X)=>{X>0&&T.appendChild(B.createElement("br")),T.appendChild(W)}),T}class LabelView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$r()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("div");E.classList.add(cn$r("l")),bindValueMap(T.props,"label",X=>{isEmpty(X)?this.element.classList.add(cn$r(void 0,"nol")):(this.element.classList.remove(cn$r(void 0,"nol")),removeChildNodes(E),E.appendChild(createLabelNode(_,X)))}),this.element.appendChild(E),this.labelElement=E;const W=_.createElement("div");W.classList.add(cn$r("v")),this.element.appendChild(W),this.valueElement=W}}class LabelController{constructor(_,T){this.props=T.props,this.valueController=T.valueController,this.viewProps=T.valueController.viewProps,this.view=new LabelView(_,{props:T.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(_){return importBladeState(_,null,T=>({label:T.optional.string}),T=>(this.props.set("label",T.label),!0))}exportProps(){return exportBladeState(null,{label:this.props.get("label")})}}function getAllBladePositions(){return["veryfirst","first","last","verylast"]}const cn$q=ClassName(""),POS_TO_CLASS_NAME_MAP={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class BladeController{constructor(_){this.parent_=null,this.blade=_.blade,this.view=_.view,this.viewProps=_.viewProps;const T=this.view.element;this.blade.value("positions").emitter.on("change",()=>{getAllBladePositions().forEach(E=>{T.classList.remove(cn$q(void 0,POS_TO_CLASS_NAME_MAP[E]))}),this.blade.get("positions").forEach(E=>{T.classList.add(cn$q(void 0,POS_TO_CLASS_NAME_MAP[E]))})}),this.viewProps.handleDispose(()=>{removeElement(T)})}get parent(){return this.parent_}set parent(_){this.parent_=_,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(_){return importBladeState(_,null,T=>({disabled:T.required.boolean,hidden:T.required.boolean}),T=>(this.viewProps.importState(T),!0))}exportState(){return exportBladeState(null,Object.assign({},this.viewProps.exportState()))}}class ButtonApi extends BladeApi{get label(){return this.controller.labelController.props.get("label")}set label(_){this.controller.labelController.props.set("label",_)}get title(){var _;return(_=this.controller.buttonController.props.get("title"))!==null&&_!==void 0?_:""}set title(_){this.controller.buttonController.props.set("title",_)}on(_,T){const E=T.bind(this);return this.controller.buttonController.emitter.on(_,X=>{E(new TpMouseEvent(this,X.nativeEvent))}),this}off(_,T){return this.controller.buttonController.emitter.off(_,T),this}}function applyClass(B,_,T){T?B.classList.add(_):B.classList.remove(_)}function valueToClassName(B,_){return T=>{applyClass(B,_,T)}}function bindValueToTextContent(B,_){bindValue(B,T=>{_.textContent=T??""})}const cn$p=ClassName("btn");class ButtonView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$p()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("button");E.classList.add(cn$p("b")),T.viewProps.bindDisabled(E),this.element.appendChild(E),this.buttonElement=E;const W=_.createElement("div");W.classList.add(cn$p("t")),bindValueToTextContent(T.props.value("title"),W),this.buttonElement.appendChild(W)}}class ButtonController{constructor(_,T){this.emitter=new Emitter,this.onClick_=this.onClick_.bind(this),this.props=T.props,this.viewProps=T.viewProps,this.view=new ButtonView(_,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(_){return importBladeState(_,null,T=>({title:T.optional.string}),T=>(this.props.set("title",T.title),!0))}exportProps(){return exportBladeState(null,{title:this.props.get("title")})}onClick_(_){this.emitter.emit("click",{nativeEvent:_,sender:this})}}class ButtonBladeController extends BladeController{constructor(_,T){const E=new ButtonController(_,{props:T.buttonProps,viewProps:T.viewProps}),W=new LabelController(_,{blade:T.blade,props:T.labelProps,valueController:E});super({blade:T.blade,view:W.view,viewProps:T.viewProps}),this.buttonController=E,this.labelController=W}importState(_){return importBladeState(_,T=>super.importState(T)&&this.buttonController.importProps(T)&&this.labelController.importProps(T),()=>({}),()=>!0)}exportState(){return exportBladeState(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class Semver{constructor(_){const[T,E]=_.split("-"),W=T.split(".");this.major=parseInt(W[0],10),this.minor=parseInt(W[1],10),this.patch=parseInt(W[2],10),this.prerelease=E??null}toString(){const _=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[_,this.prerelease].join("-"):_}}const VERSION$1=new Semver("2.0.3");function createPlugin(B){return Object.assign({core:VERSION$1},B)}createPlugin({id:"button",type:"blade",accept(B){const _=parseRecord(B,T=>({title:T.required.string,view:T.required.constant("button"),label:T.optional.string}));return _?{params:_}:null},controller(B){return new ButtonBladeController(B.document,{blade:B.blade,buttonProps:ValueMap.fromObject({title:B.params.title}),labelProps:ValueMap.fromObject({label:B.params.label}),viewProps:B.viewProps})},api(B){return B.controller instanceof ButtonBladeController?new ButtonApi(B.controller):null}});function addButtonAsBlade(B,_){return B.addBlade(Object.assign(Object.assign({},_),{view:"button"}))}function addFolderAsBlade(B,_){return B.addBlade(Object.assign(Object.assign({},_),{view:"folder"}))}function addTabAsBlade(B,_){return B.addBlade(Object.assign(Object.assign({},_),{view:"tab"}))}function isRefreshable(B){return isObject$1(B)?"refresh"in B&&typeof B.refresh=="function":!1}function createBindingTarget(B,_){if(!BindingTarget.isBindable(B))throw TpError.notBindable();return new BindingTarget(B,_)}class RackApi{constructor(_,T){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=_,this.emitter_=new Emitter,this.pool_=T,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(_=>this.pool_.createApi(_))}addBinding(_,T,E){const W=E??{},X=this.controller_.element.ownerDocument,q=this.pool_.createBinding(X,createBindingTarget(_,T),W),Y=this.pool_.createBindingApi(q);return this.add(Y,W.index)}addFolder(_){return addFolderAsBlade(this,_)}addButton(_){return addButtonAsBlade(this,_)}addTab(_){return addTabAsBlade(this,_)}add(_,T){const E=_.controller;return this.controller_.rack.add(E,T),_}remove(_){this.controller_.rack.remove(_.controller)}addBlade(_){const T=this.controller_.element.ownerDocument,E=this.pool_.createBlade(T,_),W=this.pool_.createApi(E);return this.add(W,_.index)}on(_,T){const E=T.bind(this);return this.emitter_.on(_,W=>{E(W)},{key:T}),this}off(_,T){return this.emitter_.off(_,T),this}refresh(){this.children.forEach(_=>{isRefreshable(_)&&_.refresh()})}onRackValueChange_(_){const T=_.bladeController,E=this.pool_.createApi(T),W=isBindingValue(T.value)?T.value.binding:null;this.emitter_.emit("change",new TpChangeEvent(E,W?W.target.read():T.value.rawValue,_.options.last))}}class ContainerBladeApi extends BladeApi{constructor(_,T){super(_),this.rackApi_=new RackApi(_.rackController,T)}refresh(){this.rackApi_.refresh()}}class ContainerBladeController extends BladeController{constructor(_){super({blade:_.blade,view:_.view,viewProps:_.rackController.viewProps}),this.rackController=_.rackController}importState(_){return importBladeState(_,T=>super.importState(T),T=>({children:T.required.array(T.required.raw)}),T=>this.rackController.rack.children.every((E,W)=>E.importState(T.children[W])))}exportState(){return exportBladeState(()=>super.exportState(),{children:this.rackController.rack.children.map(_=>_.exportState())})}}function isContainerBladeController(B){return"rackController"in B}class NestedOrderedSet{constructor(_){this.emitter=new Emitter,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=_}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(_){for(const T of this.allItems())if(_(T))return T;return null}includes(_){return this.cache_.has(_)}add(_,T){if(this.includes(_))throw TpError.shouldNeverHappen();const E=T!==void 0?T:this.items_.length;this.items_.splice(E,0,_),this.cache_.add(_);const W=this.extract_(_);W&&(W.emitter.on("add",this.onSubListAdd_),W.emitter.on("remove",this.onSubListRemove_),W.allItems().forEach(X=>{this.cache_.add(X)})),this.emitter.emit("add",{index:E,item:_,root:this,target:this})}remove(_){const T=this.items_.indexOf(_);if(T<0)return;this.items_.splice(T,1),this.cache_.delete(_);const E=this.extract_(_);E&&(E.allItems().forEach(W=>{this.cache_.delete(W)}),E.emitter.off("add",this.onSubListAdd_),E.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:T,item:_,root:this,target:this})}onSubListAdd_(_){this.cache_.add(_.item),this.emitter.emit("add",{index:_.index,item:_.item,root:this,target:_.target})}onSubListRemove_(_){this.cache_.delete(_.item),this.emitter.emit("remove",{index:_.index,item:_.item,root:this,target:_.target})}}function findValueBladeController(B,_){for(let T=0;T<B.length;T++){const E=B[T];if(isValueBladeController(E)&&E.value===_)return E}return null}function findSubBladeControllerSet(B){return isContainerBladeController(B)?B.rackController.rack.bcSet_:null}class Rack{constructor(_){var T,E;this.emitter=new Emitter,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(T=_.blade)!==null&&T!==void 0?T:null,(E=this.blade_)===null||E===void 0||E.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=_.viewProps,this.bcSet_=new NestedOrderedSet(findSubBladeControllerSet),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(_,T){var E;(E=_.parent)===null||E===void 0||E.remove(_),_.parent=this,this.bcSet_.add(_,T)}remove(_){_.parent=null,this.bcSet_.remove(_)}find(_){return this.bcSet_.allItems().filter(_)}onSetAdd_(_){this.updatePositions_();const T=_.target===_.root;if(this.emitter.emit("add",{bladeController:_.item,index:_.index,root:T,sender:this}),!T)return;const E=_.item;if(E.viewProps.emitter.on("change",this.onChildViewPropsChange_),E.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),E.viewProps.handleDispose(this.onChildDispose_),isValueBladeController(E))E.value.emitter.on("change",this.onChildValueChange_);else if(isContainerBladeController(E)){const W=E.rackController.rack;if(W){const X=W.emitter;X.on("layout",this.onRackLayout_),X.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(_){this.updatePositions_();const T=_.target===_.root;if(this.emitter.emit("remove",{bladeController:_.item,root:T,sender:this}),!T)return;const E=_.item;if(isValueBladeController(E))E.value.emitter.off("change",this.onChildValueChange_);else if(isContainerBladeController(E)){const W=E.rackController.rack;if(W){const X=W.emitter;X.off("layout",this.onRackLayout_),X.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const _=this.bcSet_.items.filter(W=>!W.viewProps.get("hidden")),T=_[0],E=_[_.length-1];this.bcSet_.items.forEach(W=>{const X=[];W===T&&(X.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&X.push("veryfirst")),W===E&&(X.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&X.push("verylast")),W.blade.set("positions",X)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(_){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(T=>T.viewProps.get("disposed")).forEach(T=>{this.bcSet_.remove(T)})}onChildValueChange_(_){const T=findValueBladeController(this.find(isValueBladeController),_.sender);if(!T)throw TpError.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:T,options:_.options,sender:this})}onRackLayout_(_){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(_){this.emitter.emit("valuechange",{bladeController:_.bladeController,options:_.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class RackController{constructor(_){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=_.element,this.viewProps=_.viewProps;const T=new Rack({blade:_.root?void 0:_.blade,viewProps:_.viewProps});T.emitter.on("add",this.onRackAdd_),T.emitter.on("remove",this.onRackRemove_),this.rack=T,this.viewProps.handleDispose(()=>{for(let E=this.rack.children.length-1;E>=0;E--)this.rack.children[E].viewProps.set("disposed",!0)})}onRackAdd_(_){_.root&&insertElementAt(this.element,_.bladeController.view.element,_.index)}onRackRemove_(_){_.root&&removeElement(_.bladeController.view.element)}}function createBlade(){return new ValueMap({positions:createValue([],{equals:deepEqualsArray})})}class Foldable extends ValueMap{constructor(_){super(_)}static create(_){const T={completed:!0,expanded:_,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},E=ValueMap.createCore(T);return new Foldable(E)}get styleExpanded(){var _;return(_=this.get("temporaryExpanded"))!==null&&_!==void 0?_:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const _=this.get("expandedHeight");return this.get("shouldFixHeight")&&!isEmpty(_)?`${_}px`:"auto"}bindExpandedClass(_,T){const E=()=>{this.styleExpanded?_.classList.add(T):_.classList.remove(T)};bindValueMap(this,"expanded",E),bindValueMap(this,"temporaryExpanded",E)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function computeExpandedFolderHeight(B,_){let T=0;return disableTransitionTemporarily(_,()=>{B.set("expandedHeight",null),B.set("temporaryExpanded",!0),forceReflow(_),T=_.clientHeight,B.set("temporaryExpanded",null),forceReflow(_)}),T}function applyHeight(B,_){_.style.height=B.styleHeight}function bindFoldable(B,_){B.value("expanded").emitter.on("beforechange",()=>{if(B.set("completed",!1),isEmpty(B.get("expandedHeight"))){const T=computeExpandedFolderHeight(B,_);T>0&&B.set("expandedHeight",T)}B.set("shouldFixHeight",!0),forceReflow(_)}),B.emitter.on("change",()=>{applyHeight(B,_)}),applyHeight(B,_),_.addEventListener("transitionend",T=>{T.propertyName==="height"&&B.cleanUpTransition()})}class FolderApi extends ContainerBladeApi{constructor(_,T){super(_,T),this.emitter_=new Emitter,this.controller.foldable.value("expanded").emitter.on("change",E=>{this.emitter_.emit("fold",new TpFoldEvent(this,E.sender.rawValue))}),this.rackApi_.on("change",E=>{this.emitter_.emit("change",E)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(_){this.controller.foldable.set("expanded",_)}get title(){return this.controller.props.get("title")}set title(_){this.controller.props.set("title",_)}get children(){return this.rackApi_.children}addBinding(_,T,E){return this.rackApi_.addBinding(_,T,E)}addFolder(_){return this.rackApi_.addFolder(_)}addButton(_){return this.rackApi_.addButton(_)}addTab(_){return this.rackApi_.addTab(_)}add(_,T){return this.rackApi_.add(_,T)}remove(_){this.rackApi_.remove(_)}addBlade(_){return this.rackApi_.addBlade(_)}on(_,T){const E=T.bind(this);return this.emitter_.on(_,W=>{E(W)},{key:T}),this}off(_,T){return this.emitter_.off(_,T),this}}const bladeContainerClassName=ClassName("cnt");class FolderView{constructor(_,T){var E;this.className_=ClassName((E=T.viewName)!==null&&E!==void 0?E:"fld"),this.element=_.createElement("div"),this.element.classList.add(this.className_(),bladeContainerClassName()),T.viewProps.bindClassModifiers(this.element),this.foldable_=T.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),bindValueMap(this.foldable_,"completed",valueToClassName(this.element,this.className_(void 0,"cpl")));const W=_.createElement("button");W.classList.add(this.className_("b")),bindValueMap(T.props,"title",ne=>{isEmpty(ne)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),T.viewProps.bindDisabled(W),this.element.appendChild(W),this.buttonElement=W;const X=_.createElement("div");X.classList.add(this.className_("i")),this.element.appendChild(X);const q=_.createElement("div");q.classList.add(this.className_("t")),bindValueToTextContent(T.props.value("title"),q),this.buttonElement.appendChild(q),this.titleElement=q;const Y=_.createElement("div");Y.classList.add(this.className_("m")),this.buttonElement.appendChild(Y);const te=_.createElement("div");te.classList.add(this.className_("c")),this.element.appendChild(te),this.containerElement=te}}class FolderController extends ContainerBladeController{constructor(_,T){var E;const W=Foldable.create((E=T.expanded)!==null&&E!==void 0?E:!0),X=new FolderView(_,{foldable:W,props:T.props,viewName:T.root?"rot":void 0,viewProps:T.viewProps});super(Object.assign(Object.assign({},T),{rackController:new RackController({blade:T.blade,element:X.containerElement,root:T.root,viewProps:T.viewProps}),view:X})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=T.props,this.foldable=W,bindFoldable(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(_){return importBladeState(_,T=>super.importState(T),T=>({expanded:T.required.boolean,title:T.optional.string}),T=>(this.foldable.set("expanded",T.expanded),this.props.set("title",T.title),!0))}exportState(){return exportBladeState(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}createPlugin({id:"folder",type:"blade",accept(B){const _=parseRecord(B,T=>({title:T.required.string,view:T.required.constant("folder"),expanded:T.optional.boolean}));return _?{params:_}:null},controller(B){return new FolderController(B.document,{blade:B.blade,expanded:B.params.expanded,props:ValueMap.fromObject({title:B.params.title}),viewProps:B.viewProps})},api(B){return B.controller instanceof FolderController?new FolderApi(B.controller,B.pool):null}});const cn$o=ClassName("");function valueToModifier(B,_){return valueToClassName(B,cn$o(void 0,_))}class ViewProps extends ValueMap{constructor(_){var T;super(_),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=createReadonlyValue(createValue(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(T=this.get("parent"))===null||T===void 0||T.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(_){var T,E,W;const X=_??{};return new ViewProps(ValueMap.createCore({disabled:(T=X.disabled)!==null&&T!==void 0?T:!1,disposed:!1,hidden:(E=X.hidden)!==null&&E!==void 0?E:!1,parent:(W=X.parent)!==null&&W!==void 0?W:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(_){bindValue(this.globalDisabled_,valueToModifier(_,"disabled")),bindValueMap(this,"hidden",valueToModifier(_,"hidden"))}bindDisabled(_){bindValue(this.globalDisabled_,T=>{_.disabled=T})}bindTabIndex(_){bindValue(this.globalDisabled_,T=>{_.tabIndex=T?-1:0})}handleDispose(_){this.value("disposed").emitter.on("change",T=>{T&&_()})}importState(_){this.set("disabled",_.disabled),this.set("hidden",_.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const _=this.get("parent");return(_?_.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(_){var T;const E=_.previousRawValue;E==null||E.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(T=this.get("parent"))===null||T===void 0||T.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const cn$n=ClassName("tbp");class TabPageView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$n()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("div");E.classList.add(cn$n("c")),this.element.appendChild(E),this.containerElement=E}}const cn$m=ClassName("tbi");class TabItemView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$m()),T.viewProps.bindClassModifiers(this.element),bindValueMap(T.props,"selected",X=>{X?this.element.classList.add(cn$m(void 0,"sel")):this.element.classList.remove(cn$m(void 0,"sel"))});const E=_.createElement("button");E.classList.add(cn$m("b")),T.viewProps.bindDisabled(E),this.element.appendChild(E),this.buttonElement=E;const W=_.createElement("div");W.classList.add(cn$m("t")),bindValueToTextContent(T.props.value("title"),W),this.buttonElement.appendChild(W),this.titleElement=W}}class TabItemController{constructor(_,T){this.emitter=new Emitter,this.onClick_=this.onClick_.bind(this),this.props=T.props,this.viewProps=T.viewProps,this.view=new TabItemView(_,{props:T.props,viewProps:T.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class TabPageController extends ContainerBladeController{constructor(_,T){const E=new TabPageView(_,{viewProps:T.viewProps});super(Object.assign(Object.assign({},T),{rackController:new RackController({blade:T.blade,element:E.containerElement,viewProps:T.viewProps}),view:E})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new TabItemController(_,{props:T.itemProps,viewProps:ViewProps.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=T.props,bindValueMap(this.props,"selected",W=>{this.itemController.props.set("selected",W),this.viewProps.set("hidden",!W)})}get itemController(){return this.ic_}importState(_){return importBladeState(_,T=>super.importState(T),T=>({selected:T.required.boolean,title:T.required.string}),T=>(this.ic_.props.set("selected",T.selected),this.ic_.props.set("title",T.title),!0))}exportState(){return exportBladeState(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class TabApi extends ContainerBladeApi{constructor(_,T){super(_,T),this.emitter_=new Emitter,this.onSelect_=this.onSelect_.bind(this),this.pool_=T,this.rackApi_.on("change",E=>{this.emitter_.emit("change",E)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(_){const T=this.controller.view.element.ownerDocument,E=new TabPageController(T,{blade:createBlade(),itemProps:ValueMap.fromObject({selected:!1,title:_.title}),props:ValueMap.fromObject({selected:!1}),viewProps:ViewProps.create()}),W=this.pool_.createApi(E);return this.rackApi_.add(W,_.index)}removePage(_){this.rackApi_.remove(this.rackApi_.children[_])}on(_,T){const E=T.bind(this);return this.emitter_.on(_,W=>{E(W)},{key:T}),this}off(_,T){return this.emitter_.off(_,T),this}onSelect_(_){this.emitter_.emit("select",new TpTabSelectEvent(this,_.rawValue))}}class TabPageApi extends ContainerBladeApi{get title(){var _;return(_=this.controller.itemController.props.get("title"))!==null&&_!==void 0?_:""}set title(_){this.controller.itemController.props.set("title",_)}get selected(){return this.controller.props.get("selected")}set selected(_){this.controller.props.set("selected",_)}get children(){return this.rackApi_.children}addButton(_){return this.rackApi_.addButton(_)}addFolder(_){return this.rackApi_.addFolder(_)}addTab(_){return this.rackApi_.addTab(_)}add(_,T){this.rackApi_.add(_,T)}remove(_){this.rackApi_.remove(_)}addBinding(_,T,E){return this.rackApi_.addBinding(_,T,E)}addBlade(_){return this.rackApi_.addBlade(_)}}const INDEX_NOT_SELECTED=-1;class Tab{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=createValue(!0),this.selectedIndex=createValue(INDEX_NOT_SELECTED),this.items_=[]}add(_,T){const E=T??this.items_.length;this.items_.splice(E,0,_),_.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(_){const T=this.items_.indexOf(_);T<0||(this.items_.splice(T,1),_.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=INDEX_NOT_SELECTED,this.empty.rawValue=!0;return}const _=this.items_.findIndex(T=>T.rawValue);_<0?(this.items_.forEach((T,E)=>{T.rawValue=E===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((T,E)=>{T.rawValue=E===_}),this.selectedIndex.rawValue=_),this.empty.rawValue=!1}onItemSelectedChange_(_){if(_.rawValue){const T=this.items_.findIndex(E=>E===_.sender);this.items_.forEach((E,W)=>{E.rawValue=W===T}),this.selectedIndex.rawValue=T}else this.keepSelection_()}}const cn$l=ClassName("tab");class TabView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$l(),bladeContainerClassName()),T.viewProps.bindClassModifiers(this.element),bindValue(T.empty,valueToClassName(this.element,cn$l(void 0,"nop")));const E=_.createElement("div");E.classList.add(cn$l("t")),this.element.appendChild(E),this.itemsElement=E;const W=_.createElement("div");W.classList.add(cn$l("i")),this.element.appendChild(W);const X=_.createElement("div");X.classList.add(cn$l("c")),this.element.appendChild(X),this.contentsElement=X}}class TabController extends ContainerBladeController{constructor(_,T){const E=new Tab,W=new TabView(_,{empty:E.empty,viewProps:T.viewProps});super({blade:T.blade,rackController:new RackController({blade:T.blade,element:W.contentsElement,viewProps:T.viewProps}),view:W}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const X=this.rackController.rack;X.emitter.on("add",this.onRackAdd_),X.emitter.on("remove",this.onRackRemove_),this.tab=E}add(_,T){this.rackController.rack.add(_,T)}remove(_){this.rackController.rack.remove(this.rackController.rack.children[_])}onRackAdd_(_){if(!_.root)return;const T=_.bladeController;insertElementAt(this.view.itemsElement,T.itemController.view.element,_.index),T.itemController.viewProps.set("parent",this.viewProps),this.tab.add(T.props.value("selected"))}onRackRemove_(_){if(!_.root)return;const T=_.bladeController;removeElement(T.itemController.view.element),T.itemController.viewProps.set("parent",null),this.tab.remove(T.props.value("selected"))}}createPlugin({id:"tab",type:"blade",accept(B){const _=parseRecord(B,T=>({pages:T.required.array(T.required.object({title:T.required.string})),view:T.required.constant("tab")}));return!_||_.pages.length===0?null:{params:_}},controller(B){const _=new TabController(B.document,{blade:B.blade,viewProps:B.viewProps});return B.params.pages.forEach(T=>{const E=new TabPageController(B.document,{blade:createBlade(),itemProps:ValueMap.fromObject({selected:!1,title:T.title}),props:ValueMap.fromObject({selected:!1}),viewProps:ViewProps.create()});_.add(E)}),_},api(B){return B.controller instanceof TabController?new TabApi(B.controller,B.pool):B.controller instanceof TabPageController?new TabPageApi(B.controller,B.pool):null}});class ListInputBindingApi extends BindingApi{get options(){return this.controller.valueController.props.get("options")}set options(_){this.controller.valueController.props.set("options",_)}}class CompositeConstraint{constructor(_){this.constraints=_}constrain(_){return this.constraints.reduce((T,E)=>E.constrain(T),_)}}function findConstraint(B,_){if(B instanceof _)return B;if(B instanceof CompositeConstraint){const T=B.constraints.reduce((E,W)=>E||(W instanceof _?W:null),null);if(T)return T}return null}class ListConstraint{constructor(_){this.values=ValueMap.fromObject({options:_})}constrain(_){const T=this.values.get("options");return T.length===0||T.filter(W=>W.value===_).length>0?_:T[0].value}}function parseListOptions(B){var _;const T=MicroParsers;if(Array.isArray(B))return(_=parseRecord({items:B},E=>({items:E.required.array(E.required.object({text:E.required.string,value:E.required.raw}))})))===null||_===void 0?void 0:_.items;if(typeof B=="object")return T.required.raw(B).value}function normalizeListOptions(B){if(Array.isArray(B))return B;const _=[];return Object.keys(B).forEach(T=>{_.push({text:T,value:B[T]})}),_}function createListConstraint(B){return isEmpty(B)?null:new ListConstraint(normalizeListOptions(B))}const cn$k=ClassName("lst");class ListView{constructor(_,T){this.onValueChange_=this.onValueChange_.bind(this),this.props_=T.props,this.element=_.createElement("div"),this.element.classList.add(cn$k()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("select");E.classList.add(cn$k("s")),T.viewProps.bindDisabled(E),this.element.appendChild(E),this.selectElement=E;const W=_.createElement("div");W.classList.add(cn$k("m")),W.appendChild(createSvgIconElement(_,"dropdown")),this.element.appendChild(W),T.value.emitter.on("change",this.onValueChange_),this.value_=T.value,bindValueMap(this.props_,"options",X=>{removeChildElements(this.selectElement),X.forEach(q=>{const Y=_.createElement("option");Y.textContent=q.text,this.selectElement.appendChild(Y)}),this.update_()})}update_(){const _=this.props_.get("options").map(T=>T.value);this.selectElement.selectedIndex=_.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class ListController{constructor(_,T){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=T.props,this.value=T.value,this.viewProps=T.viewProps,this.view=new ListView(_,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(_){const T=_.currentTarget;this.value.rawValue=this.props.get("options")[T.selectedIndex].value}importProps(_){return importBladeState(_,null,T=>({options:T.required.custom(parseListOptions)}),T=>(this.props.set("options",normalizeListOptions(T.options)),!0))}exportProps(){return exportBladeState(null,{options:this.props.get("options")})}}const cn$j=ClassName("pop");class PopupView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$j()),T.viewProps.bindClassModifiers(this.element),bindValue(T.shows,valueToClassName(this.element,cn$j(void 0,"v")))}}class PopupController{constructor(_,T){this.shows=createValue(!1),this.viewProps=T.viewProps,this.view=new PopupView(_,{shows:this.shows,viewProps:this.viewProps})}}const cn$i=ClassName("txt");let TextView$1=class{constructor(_,T){this.onChange_=this.onChange_.bind(this),this.element=_.createElement("div"),this.element.classList.add(cn$i()),T.viewProps.bindClassModifiers(this.element),this.props_=T.props,this.props_.emitter.on("change",this.onChange_);const E=_.createElement("input");E.classList.add(cn$i("i")),E.type="text",T.viewProps.bindDisabled(E),this.element.appendChild(E),this.inputElement=E,T.value.emitter.on("change",this.onChange_),this.value_=T.value,this.refresh()}refresh(){const _=this.props_.get("formatter");this.inputElement.value=_(this.value_.rawValue)}onChange_(){this.refresh()}};class TextController{constructor(_,T){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=T.parser,this.props=T.props,this.value=T.value,this.viewProps=T.viewProps,this.view=new TextView$1(_,{props:T.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(_){const E=_.currentTarget.value,W=this.parser_(E);isEmpty(W)||(this.value.rawValue=W),this.view.refresh()}}function boolToString(B){return String(B)}function boolFromUnknown(B){return B==="false"?!1:!!B}function BooleanFormatter(B){return boolToString(B)}function composeParsers(B){return _=>B.reduce((T,E)=>T!==null?T:E(_),null)}const innerFormatter=createNumberFormatter(0);function formatPercentage(B){return innerFormatter(B)+"%"}function stringFromUnknown(B){return String(B)}function formatString(B){return B}function connectValues({primary:B,secondary:_,forward:T,backward:E}){let W=!1;function X(q){W||(W=!0,q(),W=!1)}B.emitter.on("change",q=>{X(()=>{_.setRawValue(T(B.rawValue,_.rawValue),q.options)})}),_.emitter.on("change",q=>{X(()=>{B.setRawValue(E(B.rawValue,_.rawValue),q.options)}),X(()=>{_.setRawValue(T(B.rawValue,_.rawValue),q.options)})}),X(()=>{_.setRawValue(T(B.rawValue,_.rawValue),{forceEmit:!1,last:!0})})}function getStepForKey(B,_){const T=B*(_.altKey?.1:1)*(_.shiftKey?10:1);return _.upKey?+T:_.downKey?-T:0}function getVerticalStepKeys(B){return{altKey:B.altKey,downKey:B.key==="ArrowDown",shiftKey:B.shiftKey,upKey:B.key==="ArrowUp"}}function getHorizontalStepKeys(B){return{altKey:B.altKey,downKey:B.key==="ArrowLeft",shiftKey:B.shiftKey,upKey:B.key==="ArrowRight"}}function isVerticalArrowKey(B){return B==="ArrowUp"||B==="ArrowDown"}function isArrowKey(B){return isVerticalArrowKey(B)||B==="ArrowLeft"||B==="ArrowRight"}function computeOffset$1(B,_){var T,E;const W=_.ownerDocument.defaultView,X=_.getBoundingClientRect();return{x:B.pageX-(((T=W&&W.scrollX)!==null&&T!==void 0?T:0)+X.left),y:B.pageY-(((E=W&&W.scrollY)!==null&&E!==void 0?E:0)+X.top)}}class PointerHandler{constructor(_){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=_,this.emitter=new Emitter,_.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),_.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),_.addEventListener("touchend",this.onTouchEnd_),_.addEventListener("mousedown",this.onMouseDown_)}computePosition_(_){const T=this.elem_.getBoundingClientRect();return{bounds:{width:T.width,height:T.height},point:_?{x:_.x,y:_.y}:null}}onMouseDown_(_){var T;_.preventDefault(),(T=_.currentTarget)===null||T===void 0||T.focus();const E=this.elem_.ownerDocument;E.addEventListener("mousemove",this.onDocumentMouseMove_),E.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:_.altKey,data:this.computePosition_(computeOffset$1(_,this.elem_)),sender:this,shiftKey:_.shiftKey})}onDocumentMouseMove_(_){this.emitter.emit("move",{altKey:_.altKey,data:this.computePosition_(computeOffset$1(_,this.elem_)),sender:this,shiftKey:_.shiftKey})}onDocumentMouseUp_(_){const T=this.elem_.ownerDocument;T.removeEventListener("mousemove",this.onDocumentMouseMove_),T.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:_.altKey,data:this.computePosition_(computeOffset$1(_,this.elem_)),sender:this,shiftKey:_.shiftKey})}onTouchStart_(_){_.preventDefault();const T=_.targetTouches.item(0),E=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:_.altKey,data:this.computePosition_(T?{x:T.clientX-E.left,y:T.clientY-E.top}:void 0),sender:this,shiftKey:_.shiftKey}),this.lastTouch_=T}onTouchMove_(_){const T=_.targetTouches.item(0),E=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:_.altKey,data:this.computePosition_(T?{x:T.clientX-E.left,y:T.clientY-E.top}:void 0),sender:this,shiftKey:_.shiftKey}),this.lastTouch_=T}onTouchEnd_(_){var T;const E=(T=_.targetTouches.item(0))!==null&&T!==void 0?T:this.lastTouch_,W=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:_.altKey,data:this.computePosition_(E?{x:E.clientX-W.left,y:E.clientY-W.top}:void 0),sender:this,shiftKey:_.shiftKey})}}const cn$h=ClassName("txt");class NumberTextView{constructor(_,T){this.onChange_=this.onChange_.bind(this),this.props_=T.props,this.props_.emitter.on("change",this.onChange_),this.element=_.createElement("div"),this.element.classList.add(cn$h(),cn$h(void 0,"num")),T.arrayPosition&&this.element.classList.add(cn$h(void 0,T.arrayPosition)),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("input");E.classList.add(cn$h("i")),E.type="text",T.viewProps.bindDisabled(E),this.element.appendChild(E),this.inputElement=E,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=T.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(cn$h()),this.inputElement.classList.add(cn$h("i"));const W=_.createElement("div");W.classList.add(cn$h("k")),this.element.appendChild(W),this.knobElement=W;const X=_.createElementNS(SVG_NS,"svg");X.classList.add(cn$h("g")),this.knobElement.appendChild(X);const q=_.createElementNS(SVG_NS,"path");q.classList.add(cn$h("gb")),X.appendChild(q),this.guideBodyElem_=q;const Y=_.createElementNS(SVG_NS,"path");Y.classList.add(cn$h("gh")),X.appendChild(Y),this.guideHeadElem_=Y;const te=_.createElement("div");te.classList.add(ClassName("tt")()),this.knobElement.appendChild(te),this.tooltipElem_=te,T.value.emitter.on("change",this.onChange_),this.value=T.value,this.refresh()}onDraggingChange_(_){if(_.rawValue===null){this.element.classList.remove(cn$h(void 0,"drg"));return}this.element.classList.add(cn$h(void 0,"drg"));const T=_.rawValue/this.props_.get("pointerScale"),E=T+(T>0?-1:T<0?1:0),W=constrainRange(-E,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${E+W},0 L${E},4 L${E+W},8`,`M ${T},-1 L${T},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${T},4`);const X=this.props_.get("formatter");this.tooltipElem_.textContent=X(this.value.rawValue),this.tooltipElem_.style.left=`${T}px`}refresh(){const _=this.props_.get("formatter");this.inputElement.value=_(this.value.rawValue)}onChange_(){this.refresh()}}class NumberTextController{constructor(_,T){var E;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=T.parser,this.props=T.props,this.sliderProps_=(E=T.sliderProps)!==null&&E!==void 0?E:null,this.value=T.value,this.viewProps=T.viewProps,this.dragging_=createValue(null),this.view=new NumberTextView(_,{arrayPosition:T.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const W=new PointerHandler(this.view.knobElement);W.emitter.on("down",this.onPointerDown_),W.emitter.on("move",this.onPointerMove_),W.emitter.on("up",this.onPointerUp_)}constrainValue_(_){var T,E;const W=(T=this.sliderProps_)===null||T===void 0?void 0:T.get("min"),X=(E=this.sliderProps_)===null||E===void 0?void 0:E.get("max");let q=_;return W!==void 0&&(q=Math.max(q,W)),X!==void 0&&(q=Math.min(q,X)),q}onInputChange_(_){const E=_.currentTarget.value,W=this.parser_(E);isEmpty(W)||(this.value.rawValue=this.constrainValue_(W)),this.view.refresh()}onInputKeyDown_(_){const T=getStepForKey(this.props.get("keyScale"),getVerticalStepKeys(_));T!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+T),{forceEmit:!1,last:!1})}onInputKeyUp_(_){getStepForKey(this.props.get("keyScale"),getVerticalStepKeys(_))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(_){if(!_.point)return null;const T=_.point.x-_.bounds.width/2;return this.constrainValue_(this.originRawValue_+T*this.props.get("pointerScale"))}onPointerMove_(_){const T=this.computeDraggingValue_(_.data);T!==null&&(this.value.setRawValue(T,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(_){const T=this.computeDraggingValue_(_.data);T!==null&&(this.value.setRawValue(T,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const cn$g=ClassName("sld");class SliderView{constructor(_,T){this.onChange_=this.onChange_.bind(this),this.props_=T.props,this.props_.emitter.on("change",this.onChange_),this.element=_.createElement("div"),this.element.classList.add(cn$g()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("div");E.classList.add(cn$g("t")),T.viewProps.bindTabIndex(E),this.element.appendChild(E),this.trackElement=E;const W=_.createElement("div");W.classList.add(cn$g("k")),this.trackElement.appendChild(W),this.knobElement=W,T.value.emitter.on("change",this.onChange_),this.value=T.value,this.update_()}update_(){const _=constrainRange(mapRange$1(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${_}%`}onChange_(){this.update_()}}class SliderController{constructor(_,T){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=T.value,this.viewProps=T.viewProps,this.props=T.props,this.view=new SliderView(_,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new PointerHandler(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(_,T){_.point&&this.value.setRawValue(mapRange$1(constrainRange(_.point.x,0,_.bounds.width),0,_.bounds.width,this.props.get("min"),this.props.get("max")),T)}onPointerDownOrMove_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerUp_(_){this.handlePointerEvent_(_.data,{forceEmit:!0,last:!0})}onKeyDown_(_){const T=getStepForKey(this.props.get("keyScale"),getHorizontalStepKeys(_));T!==0&&this.value.setRawValue(this.value.rawValue+T,{forceEmit:!1,last:!1})}onKeyUp_(_){getStepForKey(this.props.get("keyScale"),getHorizontalStepKeys(_))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const cn$f=ClassName("sldtxt");class SliderTextView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$f());const E=_.createElement("div");E.classList.add(cn$f("s")),this.sliderView_=T.sliderView,E.appendChild(this.sliderView_.element),this.element.appendChild(E);const W=_.createElement("div");W.classList.add(cn$f("t")),this.textView_=T.textView,W.appendChild(this.textView_.element),this.element.appendChild(W)}}class SliderTextController{constructor(_,T){this.value=T.value,this.viewProps=T.viewProps,this.sliderC_=new SliderController(_,{props:T.sliderProps,value:T.value,viewProps:this.viewProps}),this.textC_=new NumberTextController(_,{parser:T.parser,props:T.textProps,sliderProps:T.sliderProps,value:T.value,viewProps:T.viewProps}),this.view=new SliderTextView(_,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(_){return importBladeState(_,null,T=>({max:T.required.number,min:T.required.number}),T=>{const E=this.sliderC_.props;return E.set("max",T.max),E.set("min",T.min),!0})}exportProps(){const _=this.sliderC_.props;return exportBladeState(null,{max:_.get("max"),min:_.get("min")})}}function createSliderTextProps(B){return{sliderProps:new ValueMap({keyScale:B.keyScale,max:B.max,min:B.min}),textProps:new ValueMap({formatter:createValue(B.formatter),keyScale:B.keyScale,pointerScale:createValue(B.pointerScale)})}}const CSS_VAR_MAP={containerUnitSize:"cnt-usz"};function getCssVar(B){return`--${CSS_VAR_MAP[B]}`}function createPointDimensionParser(B){return createNumberTextInputParamsParser(B)}function parsePointDimensionParams(B){if(isRecord(B))return parseRecord(B,createPointDimensionParser)}function createDimensionConstraint(B,_){if(!B)return;const T=[],E=createStepConstraint(B,_);E&&T.push(E);const W=createRangeConstraint(B);return W&&T.push(W),new CompositeConstraint(T)}function parsePickerLayout(B){if(B==="inline"||B==="popup")return B}function writePrimitive(B,_){B.write(_)}const cn$e=ClassName("ckb");class CheckboxView{constructor(_,T){this.onValueChange_=this.onValueChange_.bind(this),this.element=_.createElement("div"),this.element.classList.add(cn$e()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("label");E.classList.add(cn$e("l")),this.element.appendChild(E),this.labelElement=E;const W=_.createElement("input");W.classList.add(cn$e("i")),W.type="checkbox",this.labelElement.appendChild(W),this.inputElement=W,T.viewProps.bindDisabled(this.inputElement);const X=_.createElement("div");X.classList.add(cn$e("w")),this.labelElement.appendChild(X);const q=createSvgIconElement(_,"check");X.appendChild(q),T.value.emitter.on("change",this.onValueChange_),this.value=T.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class CheckboxController{constructor(_,T){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=T.value,this.viewProps=T.viewProps,this.view=new CheckboxView(_,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(_){const T=_.currentTarget;this.value.rawValue=T.checked,_.preventDefault(),_.stopPropagation()}onLabelMouseDown_(_){_.preventDefault()}}function createConstraint$6(B){const _=[],T=createListConstraint(B.options);return T&&_.push(T),new CompositeConstraint(_)}createPlugin({id:"input-bool",type:"input",accept:(B,_)=>{if(typeof B!="boolean")return null;const T=parseRecord(_,E=>({options:E.optional.custom(parseListOptions),readonly:E.optional.constant(!1)}));return T?{initialValue:B,params:T}:null},binding:{reader:B=>boolFromUnknown,constraint:B=>createConstraint$6(B.params),writer:B=>writePrimitive},controller:B=>{const _=B.document,T=B.value,E=B.constraint,W=E&&findConstraint(E,ListConstraint);return W?new ListController(_,{props:new ValueMap({options:W.values.value("options")}),value:T,viewProps:B.viewProps}):new CheckboxController(_,{value:T,viewProps:B.viewProps})},api(B){return typeof B.controller.value.rawValue!="boolean"?null:B.controller.valueController instanceof ListController?new ListInputBindingApi(B.controller):null}});const cn$d=ClassName("col");class ColorView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$d()),T.foldable.bindExpandedClass(this.element,cn$d(void 0,"expanded")),bindValueMap(T.foldable,"completed",valueToClassName(this.element,cn$d(void 0,"cpl")));const E=_.createElement("div");E.classList.add(cn$d("h")),this.element.appendChild(E);const W=_.createElement("div");W.classList.add(cn$d("s")),E.appendChild(W),this.swatchElement=W;const X=_.createElement("div");if(X.classList.add(cn$d("t")),E.appendChild(X),this.textElement=X,T.pickerLayout==="inline"){const q=_.createElement("div");q.classList.add(cn$d("p")),this.element.appendChild(q),this.pickerElement=q}else this.pickerElement=null}}function rgbToHslInt(B,_,T){const E=constrainRange(B/255,0,1),W=constrainRange(_/255,0,1),X=constrainRange(T/255,0,1),q=Math.max(E,W,X),Y=Math.min(E,W,X),te=q-Y;let ne=0,ae=0;const le=(Y+q)/2;return te!==0&&(ae=te/(1-Math.abs(q+Y-1)),E===q?ne=(W-X)/te:W===q?ne=2+(X-E)/te:ne=4+(E-W)/te,ne=ne/6+(ne<0?1:0)),[ne*360,ae*100,le*100]}function hslToRgbInt(B,_,T){const E=(B%360+360)%360,W=constrainRange(_/100,0,1),X=constrainRange(T/100,0,1),q=(1-Math.abs(2*X-1))*W,Y=q*(1-Math.abs(E/60%2-1)),te=X-q/2;let ne,ae,le;return E>=0&&E<60?[ne,ae,le]=[q,Y,0]:E>=60&&E<120?[ne,ae,le]=[Y,q,0]:E>=120&&E<180?[ne,ae,le]=[0,q,Y]:E>=180&&E<240?[ne,ae,le]=[0,Y,q]:E>=240&&E<300?[ne,ae,le]=[Y,0,q]:[ne,ae,le]=[q,0,Y],[(ne+te)*255,(ae+te)*255,(le+te)*255]}function rgbToHsvInt(B,_,T){const E=constrainRange(B/255,0,1),W=constrainRange(_/255,0,1),X=constrainRange(T/255,0,1),q=Math.max(E,W,X),Y=Math.min(E,W,X),te=q-Y;let ne;te===0?ne=0:q===E?ne=60*(((W-X)/te%6+6)%6):q===W?ne=60*((X-E)/te+2):ne=60*((E-W)/te+4);const ae=q===0?0:te/q,le=q;return[ne,ae*100,le*100]}function hsvToRgbInt(B,_,T){const E=loopRange(B,360),W=constrainRange(_/100,0,1),X=constrainRange(T/100,0,1),q=X*W,Y=q*(1-Math.abs(E/60%2-1)),te=X-q;let ne,ae,le;return E>=0&&E<60?[ne,ae,le]=[q,Y,0]:E>=60&&E<120?[ne,ae,le]=[Y,q,0]:E>=120&&E<180?[ne,ae,le]=[0,q,Y]:E>=180&&E<240?[ne,ae,le]=[0,Y,q]:E>=240&&E<300?[ne,ae,le]=[Y,0,q]:[ne,ae,le]=[q,0,Y],[(ne+te)*255,(ae+te)*255,(le+te)*255]}function hslToHsvInt(B,_,T){const E=T+_*(100-Math.abs(2*T-100))/200;return[B,E!==0?_*(100-Math.abs(2*T-100))/E:0,T+_*(100-Math.abs(2*T-100))/(2*100)]}function hsvToHslInt(B,_,T){const E=100-Math.abs(T*(200-_)/100-100);return[B,E!==0?_*T/E:0,T*(200-_)/(2*100)]}function removeAlphaComponent(B){return[B[0],B[1],B[2]]}function appendAlphaComponent(B,_){return[B[0],B[1],B[2],_]}const MODE_CONVERTER_MAP={hsl:{hsl:(B,_,T)=>[B,_,T],hsv:hslToHsvInt,rgb:hslToRgbInt},hsv:{hsl:hsvToHslInt,hsv:(B,_,T)=>[B,_,T],rgb:hsvToRgbInt},rgb:{hsl:rgbToHslInt,hsv:rgbToHsvInt,rgb:(B,_,T)=>[B,_,T]}};function getColorMaxComponents(B,_){return[_==="float"?1:B==="rgb"?255:360,_==="float"?1:B==="rgb"?255:100,_==="float"?1:B==="rgb"?255:100]}function loopHueRange(B,_){return B===_?_:loopRange(B,_)}function constrainColorComponents(B,_,T){var E;const W=getColorMaxComponents(_,T);return[_==="rgb"?constrainRange(B[0],0,W[0]):loopHueRange(B[0],W[0]),constrainRange(B[1],0,W[1]),constrainRange(B[2],0,W[2]),constrainRange((E=B[3])!==null&&E!==void 0?E:1,0,1)]}function convertColorType(B,_,T,E){const W=getColorMaxComponents(_,T),X=getColorMaxComponents(_,E);return B.map((q,Y)=>q/W[Y]*X[Y])}function convertColor(B,_,T){const E=convertColorType(B,_.mode,_.type,"int"),W=MODE_CONVERTER_MAP[_.mode][T.mode](...E);return convertColorType(W,T.mode,"int",T.type)}class IntColor{static black(){return new IntColor([0,0,0],"rgb")}constructor(_,T){this.type="int",this.mode=T,this.comps_=constrainColorComponents(_,T,this.type)}getComponents(_){return appendAlphaComponent(convertColor(removeAlphaComponent(this.comps_),{mode:this.mode,type:this.type},{mode:_??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const _=this.getComponents("rgb");return{r:_[0],g:_[1],b:_[2],a:_[3]}}}const cn$c=ClassName("colp");class ColorPickerView{constructor(_,T){this.alphaViews_=null,this.element=_.createElement("div"),this.element.classList.add(cn$c()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("div");E.classList.add(cn$c("hsv"));const W=_.createElement("div");W.classList.add(cn$c("sv")),this.svPaletteView_=T.svPaletteView,W.appendChild(this.svPaletteView_.element),E.appendChild(W);const X=_.createElement("div");X.classList.add(cn$c("h")),this.hPaletteView_=T.hPaletteView,X.appendChild(this.hPaletteView_.element),E.appendChild(X),this.element.appendChild(E);const q=_.createElement("div");if(q.classList.add(cn$c("rgb")),this.textsView_=T.textsView,q.appendChild(this.textsView_.element),this.element.appendChild(q),T.alphaViews){this.alphaViews_={palette:T.alphaViews.palette,text:T.alphaViews.text};const Y=_.createElement("div");Y.classList.add(cn$c("a"));const te=_.createElement("div");te.classList.add(cn$c("ap")),te.appendChild(this.alphaViews_.palette.element),Y.appendChild(te);const ne=_.createElement("div");ne.classList.add(cn$c("at")),ne.appendChild(this.alphaViews_.text.element),Y.appendChild(ne),this.element.appendChild(Y)}}get allFocusableElements(){const _=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(T=>T.inputElement)];return this.alphaViews_&&_.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),_}}function parseColorType(B){return B==="int"?"int":B==="float"?"float":void 0}function parseColorInputParams(B){return parseRecord(B,_=>({color:_.optional.object({alpha:_.optional.boolean,type:_.optional.custom(parseColorType)}),expanded:_.optional.boolean,picker:_.optional.custom(parsePickerLayout),readonly:_.optional.constant(!1)}))}function getKeyScaleForColor(B){return B?.1:1}function extractColorType(B){var _;return(_=B.color)===null||_===void 0?void 0:_.type}class FloatColor{constructor(_,T){this.type="float",this.mode=T,this.comps_=constrainColorComponents(_,T,this.type)}getComponents(_){return appendAlphaComponent(convertColor(removeAlphaComponent(this.comps_),{mode:this.mode,type:this.type},{mode:_??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const _=this.getComponents("rgb");return{r:_[0],g:_[1],b:_[2],a:_[3]}}}const TYPE_TO_CONSTRUCTOR_MAP={int:(B,_)=>new IntColor(B,_),float:(B,_)=>new FloatColor(B,_)};function createColor(B,_,T){return TYPE_TO_CONSTRUCTOR_MAP[T](B,_)}function isFloatColor(B){return B.type==="float"}function isIntColor(B){return B.type==="int"}function convertFloatToInt(B){const _=B.getComponents(),T=getColorMaxComponents(B.mode,"int");return new IntColor([Math.round(mapRange$1(_[0],0,1,0,T[0])),Math.round(mapRange$1(_[1],0,1,0,T[1])),Math.round(mapRange$1(_[2],0,1,0,T[2])),_[3]],B.mode)}function convertIntToFloat(B){const _=B.getComponents(),T=getColorMaxComponents(B.mode,"int");return new FloatColor([mapRange$1(_[0],0,T[0],0,1),mapRange$1(_[1],0,T[1],0,1),mapRange$1(_[2],0,T[2],0,1),_[3]],B.mode)}function mapColorType(B,_){if(B.type===_)return B;if(isIntColor(B)&&_==="float")return convertIntToFloat(B);if(isFloatColor(B)&&_==="int")return convertFloatToInt(B);throw TpError.shouldNeverHappen()}function equalsStringColorFormat(B,_){return B.alpha===_.alpha&&B.mode===_.mode&&B.notation===_.notation&&B.type===_.type}function parseCssNumberOrPercentage(B,_){const T=B.match(/^(.+)%$/);return Math.min(T?parseFloat(T[1])*.01*_:parseFloat(B),_)}const ANGLE_TO_DEG_MAP={deg:B=>B,grad:B=>B*360/400,rad:B=>B*360/(2*Math.PI),turn:B=>B*360};function parseCssNumberOrAngle(B){const _=B.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!_)return parseFloat(B);const T=parseFloat(_[1]),E=_[2];return ANGLE_TO_DEG_MAP[E](T)}function parseFunctionalRgbColorComponents(B){const _=B.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!_)return null;const T=[parseCssNumberOrPercentage(_[1],255),parseCssNumberOrPercentage(_[2],255),parseCssNumberOrPercentage(_[3],255)];return isNaN(T[0])||isNaN(T[1])||isNaN(T[2])?null:T}function parseFunctionalRgbColor(B){const _=parseFunctionalRgbColorComponents(B);return _?new IntColor(_,"rgb"):null}function parseFunctionalRgbaColorComponents(B){const _=B.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!_)return null;const T=[parseCssNumberOrPercentage(_[1],255),parseCssNumberOrPercentage(_[2],255),parseCssNumberOrPercentage(_[3],255),parseCssNumberOrPercentage(_[4],1)];return isNaN(T[0])||isNaN(T[1])||isNaN(T[2])||isNaN(T[3])?null:T}function parseFunctionalRgbaColor(B){const _=parseFunctionalRgbaColorComponents(B);return _?new IntColor(_,"rgb"):null}function parseFunctionalHslColorComponents(B){const _=B.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!_)return null;const T=[parseCssNumberOrAngle(_[1]),parseCssNumberOrPercentage(_[2],100),parseCssNumberOrPercentage(_[3],100)];return isNaN(T[0])||isNaN(T[1])||isNaN(T[2])?null:T}function parseFunctionalHslColor(B){const _=parseFunctionalHslColorComponents(B);return _?new IntColor(_,"hsl"):null}function parseHslaColorComponents(B){const _=B.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!_)return null;const T=[parseCssNumberOrAngle(_[1]),parseCssNumberOrPercentage(_[2],100),parseCssNumberOrPercentage(_[3],100),parseCssNumberOrPercentage(_[4],1)];return isNaN(T[0])||isNaN(T[1])||isNaN(T[2])||isNaN(T[3])?null:T}function parseFunctionalHslaColor(B){const _=parseHslaColorComponents(B);return _?new IntColor(_,"hsl"):null}function parseHexRgbColorComponents(B){const _=B.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(_)return[parseInt(_[1]+_[1],16),parseInt(_[2]+_[2],16),parseInt(_[3]+_[3],16)];const T=B.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return T?[parseInt(T[1],16),parseInt(T[2],16),parseInt(T[3],16)]:null}function parseHexRgbColor(B){const _=parseHexRgbColorComponents(B);return _?new IntColor(_,"rgb"):null}function parseHexRgbaColorComponents(B){const _=B.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(_)return[parseInt(_[1]+_[1],16),parseInt(_[2]+_[2],16),parseInt(_[3]+_[3],16),mapRange$1(parseInt(_[4]+_[4],16),0,255,0,1)];const T=B.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return T?[parseInt(T[1],16),parseInt(T[2],16),parseInt(T[3],16),mapRange$1(parseInt(T[4],16),0,255,0,1)]:null}function parseHexRgbaColor(B){const _=parseHexRgbaColorComponents(B);return _?new IntColor(_,"rgb"):null}function parseObjectRgbColorComponents(B){const _=B.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!_)return null;const T=[parseFloat(_[1]),parseFloat(_[2]),parseFloat(_[3])];return isNaN(T[0])||isNaN(T[1])||isNaN(T[2])?null:T}function createObjectRgbColorParser(B){return _=>{const T=parseObjectRgbColorComponents(_);return T?createColor(T,"rgb",B):null}}function parseObjectRgbaColorComponents(B){const _=B.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!_)return null;const T=[parseFloat(_[1]),parseFloat(_[2]),parseFloat(_[3]),parseFloat(_[4])];return isNaN(T[0])||isNaN(T[1])||isNaN(T[2])||isNaN(T[3])?null:T}function createObjectRgbaColorParser(B){return _=>{const T=parseObjectRgbaColorComponents(_);return T?createColor(T,"rgb",B):null}}const PARSER_AND_RESULT=[{parser:parseHexRgbColorComponents,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:parseHexRgbaColorComponents,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:parseFunctionalRgbColorComponents,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:parseFunctionalRgbaColorComponents,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:parseFunctionalHslColorComponents,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:parseHslaColorComponents,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:parseObjectRgbColorComponents,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:parseObjectRgbaColorComponents,result:{alpha:!0,mode:"rgb",notation:"object"}}];function detectStringColor(B){return PARSER_AND_RESULT.reduce((_,{parser:T,result:E})=>_||(T(B)?E:null),null)}function detectStringColorFormat(B,_="int"){const T=detectStringColor(B);return T?T.notation==="hex"&&_!=="float"?Object.assign(Object.assign({},T),{type:"int"}):T.notation==="func"?Object.assign(Object.assign({},T),{type:_}):null:null}function createColorStringParser(B){const _=[parseHexRgbColor,parseHexRgbaColor,parseFunctionalRgbColor,parseFunctionalRgbaColor,parseFunctionalHslColor,parseFunctionalHslaColor];_.push(createObjectRgbColorParser("int"),createObjectRgbaColorParser("int"));const T=composeParsers(_);return E=>{const W=T(E);return W?mapColorType(W,B):null}}function readIntColorString(B){const _=createColorStringParser("int");if(typeof B!="string")return IntColor.black();const T=_(B);return T??IntColor.black()}function zerofill(B){const _=constrainRange(Math.floor(B),0,255).toString(16);return _.length===1?`0${_}`:_}function colorToHexRgbString(B,_="#"){const T=removeAlphaComponent(B.getComponents("rgb")).map(zerofill).join("");return`${_}${T}`}function colorToHexRgbaString(B,_="#"){const T=B.getComponents("rgb"),E=[T[0],T[1],T[2],T[3]*255].map(zerofill).join("");return`${_}${E}`}function colorToFunctionalRgbString(B){const _=createNumberFormatter(0),T=mapColorType(B,"int");return`rgb(${removeAlphaComponent(T.getComponents("rgb")).map(W=>_(W)).join(", ")})`}function colorToFunctionalRgbaString(B){const _=createNumberFormatter(2),T=createNumberFormatter(0);return`rgba(${mapColorType(B,"int").getComponents("rgb").map((X,q)=>(q===3?_:T)(X)).join(", ")})`}function colorToFunctionalHslString(B){const _=[createNumberFormatter(0),formatPercentage,formatPercentage],T=mapColorType(B,"int");return`hsl(${removeAlphaComponent(T.getComponents("hsl")).map((W,X)=>_[X](W)).join(", ")})`}function colorToFunctionalHslaString(B){const _=[createNumberFormatter(0),formatPercentage,formatPercentage,createNumberFormatter(2)];return`hsla(${mapColorType(B,"int").getComponents("hsl").map((W,X)=>_[X](W)).join(", ")})`}function colorToObjectRgbString(B,_){const T=createNumberFormatter(_==="float"?2:0),E=["r","g","b"],W=mapColorType(B,_);return`{${removeAlphaComponent(W.getComponents("rgb")).map((q,Y)=>`${E[Y]}: ${T(q)}`).join(", ")}}`}function createObjectRgbColorFormatter(B){return _=>colorToObjectRgbString(_,B)}function colorToObjectRgbaString(B,_){const T=createNumberFormatter(2),E=createNumberFormatter(_==="float"?2:0),W=["r","g","b","a"];return`{${mapColorType(B,_).getComponents("rgb").map((Y,te)=>{const ne=te===3?T:E;return`${W[te]}: ${ne(Y)}`}).join(", ")}}`}function createObjectRgbaColorFormatter(B){return _=>colorToObjectRgbaString(_,B)}const FORMAT_AND_STRINGIFIERS=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:colorToHexRgbString},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:colorToHexRgbaString},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:colorToFunctionalRgbString},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:colorToFunctionalRgbaString},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:colorToFunctionalHslString},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:colorToFunctionalHslaString},...["int","float"].reduce((B,_)=>[...B,{format:{alpha:!1,mode:"rgb",notation:"object",type:_},stringifier:createObjectRgbColorFormatter(_)},{format:{alpha:!0,mode:"rgb",notation:"object",type:_},stringifier:createObjectRgbaColorFormatter(_)}],[])];function findColorStringifier(B){return FORMAT_AND_STRINGIFIERS.reduce((_,T)=>_||(equalsStringColorFormat(T.format,B)?T.stringifier:null),null)}const cn$b=ClassName("apl");class APaletteView{constructor(_,T){this.onValueChange_=this.onValueChange_.bind(this),this.value=T.value,this.value.emitter.on("change",this.onValueChange_),this.element=_.createElement("div"),this.element.classList.add(cn$b()),T.viewProps.bindClassModifiers(this.element),T.viewProps.bindTabIndex(this.element);const E=_.createElement("div");E.classList.add(cn$b("b")),this.element.appendChild(E);const W=_.createElement("div");W.classList.add(cn$b("c")),E.appendChild(W),this.colorElem_=W;const X=_.createElement("div");X.classList.add(cn$b("m")),this.element.appendChild(X),this.markerElem_=X;const q=_.createElement("div");q.classList.add(cn$b("p")),this.markerElem_.appendChild(q),this.previewElem_=q,this.update_()}update_(){const _=this.value.rawValue,T=_.getComponents("rgb"),E=new IntColor([T[0],T[1],T[2],0],"rgb"),W=new IntColor([T[0],T[1],T[2],255],"rgb"),X=["to right",colorToFunctionalRgbaString(E),colorToFunctionalRgbaString(W)];this.colorElem_.style.background=`linear-gradient(${X.join(",")})`,this.previewElem_.style.backgroundColor=colorToFunctionalRgbaString(_);const q=mapRange$1(T[3],0,1,0,100);this.markerElem_.style.left=`${q}%`}onValueChange_(){this.update_()}}class APaletteController{constructor(_,T){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=T.value,this.viewProps=T.viewProps,this.view=new APaletteView(_,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(_,T){if(!_.point)return;const E=_.point.x/_.bounds.width,W=this.value.rawValue,[X,q,Y]=W.getComponents("hsv");this.value.setRawValue(new IntColor([X,q,Y,E],"hsv"),T)}onPointerDown_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerMove_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerUp_(_){this.handlePointerEvent_(_.data,{forceEmit:!0,last:!0})}onKeyDown_(_){const T=getStepForKey(getKeyScaleForColor(!0),getHorizontalStepKeys(_));if(T===0)return;const E=this.value.rawValue,[W,X,q,Y]=E.getComponents("hsv");this.value.setRawValue(new IntColor([W,X,q,Y+T],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(_){getStepForKey(getKeyScaleForColor(!0),getHorizontalStepKeys(_))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const cn$a=ClassName("coltxt");function createModeSelectElement(B){const _=B.createElement("select"),T=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return _.appendChild(T.reduce((E,W)=>{const X=B.createElement("option");return X.textContent=W.text,X.value=W.value,E.appendChild(X),E},B.createDocumentFragment())),_}class ColorTextsView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$a()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("div");E.classList.add(cn$a("m")),this.modeElem_=createModeSelectElement(_),this.modeElem_.classList.add(cn$a("ms")),E.appendChild(this.modeSelectElement),T.viewProps.bindDisabled(this.modeElem_);const W=_.createElement("div");W.classList.add(cn$a("mm")),W.appendChild(createSvgIconElement(_,"dropdown")),E.appendChild(W),this.element.appendChild(E);const X=_.createElement("div");X.classList.add(cn$a("w")),this.element.appendChild(X),this.inputsElem_=X,this.inputViews_=T.inputViews,this.applyInputViews_(),bindValue(T.mode,q=>{this.modeElem_.value=q})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(_){this.inputViews_=_,this.applyInputViews_()}applyInputViews_(){removeChildElements(this.inputsElem_);const _=this.element.ownerDocument;this.inputViews_.forEach(T=>{const E=_.createElement("div");E.classList.add(cn$a("c")),E.appendChild(T.element),this.inputsElem_.appendChild(E)})}}function createFormatter$2(B){return createNumberFormatter(B==="float"?2:0)}function createConstraint$5(B,_,T){const E=getColorMaxComponents(B,_)[T];return new DefiniteRangeConstraint({min:0,max:E})}function createComponentController(B,_,T){return new NumberTextController(B,{arrayPosition:T===0?"fst":T===2?"lst":"mid",parser:_.parser,props:ValueMap.fromObject({formatter:createFormatter$2(_.colorType),keyScale:getKeyScaleForColor(!1),pointerScale:_.colorType==="float"?.01:1}),value:createValue(0,{constraint:createConstraint$5(_.colorMode,_.colorType,T)}),viewProps:_.viewProps})}function createComponentControllers(B,_){const T={colorMode:_.colorMode,colorType:_.colorType,parser:parseNumber,viewProps:_.viewProps};return[0,1,2].map(E=>{const W=createComponentController(B,T,E);return connectValues({primary:_.value,secondary:W.value,forward(X){return mapColorType(X,_.colorType).getComponents(_.colorMode)[E]},backward(X,q){const Y=_.colorMode,ne=mapColorType(X,_.colorType).getComponents(Y);ne[E]=q;const ae=createColor(appendAlphaComponent(removeAlphaComponent(ne),ne[3]),Y,_.colorType);return mapColorType(ae,"int")}}),W})}function createHexController(B,_){const T=new TextController(B,{parser:createColorStringParser("int"),props:ValueMap.fromObject({formatter:colorToHexRgbString}),value:createValue(IntColor.black()),viewProps:_.viewProps});return connectValues({primary:_.value,secondary:T.value,forward:E=>new IntColor(removeAlphaComponent(E.getComponents()),E.mode),backward:(E,W)=>new IntColor(appendAlphaComponent(removeAlphaComponent(W.getComponents(E.mode)),E.getComponents()[3]),E.mode)}),[T]}function isColorMode(B){return B!=="hex"}class ColorTextsController{constructor(_,T){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=T.colorType,this.value=T.value,this.viewProps=T.viewProps,this.colorMode=createValue(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(_),this.view=new ColorTextsView(_,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(_){const T=this.colorMode.rawValue;return isColorMode(T)?createComponentControllers(_,{colorMode:T,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):createHexController(_,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(_){const T=_.currentTarget;this.colorMode.rawValue=T.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(E=>E.view)}}const cn$9=ClassName("hpl");class HPaletteView{constructor(_,T){this.onValueChange_=this.onValueChange_.bind(this),this.value=T.value,this.value.emitter.on("change",this.onValueChange_),this.element=_.createElement("div"),this.element.classList.add(cn$9()),T.viewProps.bindClassModifiers(this.element),T.viewProps.bindTabIndex(this.element);const E=_.createElement("div");E.classList.add(cn$9("c")),this.element.appendChild(E);const W=_.createElement("div");W.classList.add(cn$9("m")),this.element.appendChild(W),this.markerElem_=W,this.update_()}update_(){const _=this.value.rawValue,[T]=_.getComponents("hsv");this.markerElem_.style.backgroundColor=colorToFunctionalRgbString(new IntColor([T,100,100],"hsv"));const E=mapRange$1(T,0,360,0,100);this.markerElem_.style.left=`${E}%`}onValueChange_(){this.update_()}}class HPaletteController{constructor(_,T){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=T.value,this.viewProps=T.viewProps,this.view=new HPaletteView(_,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(_,T){if(!_.point)return;const E=mapRange$1(constrainRange(_.point.x,0,_.bounds.width),0,_.bounds.width,0,360),W=this.value.rawValue,[,X,q,Y]=W.getComponents("hsv");this.value.setRawValue(new IntColor([E,X,q,Y],"hsv"),T)}onPointerDown_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerMove_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerUp_(_){this.handlePointerEvent_(_.data,{forceEmit:!0,last:!0})}onKeyDown_(_){const T=getStepForKey(getKeyScaleForColor(!1),getHorizontalStepKeys(_));if(T===0)return;const E=this.value.rawValue,[W,X,q,Y]=E.getComponents("hsv");this.value.setRawValue(new IntColor([W+T,X,q,Y],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(_){getStepForKey(getKeyScaleForColor(!1),getHorizontalStepKeys(_))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const cn$8=ClassName("svp"),CANVAS_RESOL=64;class SvPaletteView{constructor(_,T){this.onValueChange_=this.onValueChange_.bind(this),this.value=T.value,this.value.emitter.on("change",this.onValueChange_),this.element=_.createElement("div"),this.element.classList.add(cn$8()),T.viewProps.bindClassModifiers(this.element),T.viewProps.bindTabIndex(this.element);const E=_.createElement("canvas");E.height=CANVAS_RESOL,E.width=CANVAS_RESOL,E.classList.add(cn$8("c")),this.element.appendChild(E),this.canvasElement=E;const W=_.createElement("div");W.classList.add(cn$8("m")),this.element.appendChild(W),this.markerElem_=W,this.update_()}update_(){const _=getCanvasContext(this.canvasElement);if(!_)return;const E=this.value.rawValue.getComponents("hsv"),W=this.canvasElement.width,X=this.canvasElement.height,q=_.getImageData(0,0,W,X),Y=q.data;for(let ae=0;ae<X;ae++)for(let le=0;le<W;le++){const ue=mapRange$1(le,0,W,0,100),ge=mapRange$1(ae,0,X,100,0),ye=hsvToRgbInt(E[0],ue,ge),xe=(ae*W+le)*4;Y[xe]=ye[0],Y[xe+1]=ye[1],Y[xe+2]=ye[2],Y[xe+3]=255}_.putImageData(q,0,0);const te=mapRange$1(E[1],0,100,0,100);this.markerElem_.style.left=`${te}%`;const ne=mapRange$1(E[2],0,100,100,0);this.markerElem_.style.top=`${ne}%`}onValueChange_(){this.update_()}}class SvPaletteController{constructor(_,T){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=T.value,this.viewProps=T.viewProps,this.view=new SvPaletteView(_,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new PointerHandler(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(_,T){if(!_.point)return;const E=mapRange$1(_.point.x,0,_.bounds.width,0,100),W=mapRange$1(_.point.y,0,_.bounds.height,100,0),[X,,,q]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new IntColor([X,E,W,q],"hsv"),T)}onPointerDown_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerMove_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerUp_(_){this.handlePointerEvent_(_.data,{forceEmit:!0,last:!0})}onKeyDown_(_){isArrowKey(_.key)&&_.preventDefault();const[T,E,W,X]=this.value.rawValue.getComponents("hsv"),q=getKeyScaleForColor(!1),Y=getStepForKey(q,getHorizontalStepKeys(_)),te=getStepForKey(q,getVerticalStepKeys(_));Y===0&&te===0||this.value.setRawValue(new IntColor([T,E+Y,W+te,X],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(_){const T=getKeyScaleForColor(!1),E=getStepForKey(T,getHorizontalStepKeys(_)),W=getStepForKey(T,getVerticalStepKeys(_));E===0&&W===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class ColorPickerController{constructor(_,T){this.value=T.value,this.viewProps=T.viewProps,this.hPaletteC_=new HPaletteController(_,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new SvPaletteController(_,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=T.supportsAlpha?{palette:new APaletteController(_,{value:this.value,viewProps:this.viewProps}),text:new NumberTextController(_,{parser:parseNumber,props:ValueMap.fromObject({pointerScale:.01,keyScale:.1,formatter:createNumberFormatter(2)}),value:createValue(0,{constraint:new DefiniteRangeConstraint({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&connectValues({primary:this.value,secondary:this.alphaIcs_.text.value,forward:E=>E.getComponents()[3],backward:(E,W)=>{const X=E.getComponents();return X[3]=W,new IntColor(X,E.mode)}}),this.textsC_=new ColorTextsController(_,{colorType:T.colorType,value:this.value,viewProps:this.viewProps}),this.view=new ColorPickerView(_,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:T.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const cn$7=ClassName("colsw");class ColorSwatchView{constructor(_,T){this.onValueChange_=this.onValueChange_.bind(this),T.value.emitter.on("change",this.onValueChange_),this.value=T.value,this.element=_.createElement("div"),this.element.classList.add(cn$7()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("div");E.classList.add(cn$7("sw")),this.element.appendChild(E),this.swatchElem_=E;const W=_.createElement("button");W.classList.add(cn$7("b")),T.viewProps.bindDisabled(W),this.element.appendChild(W),this.buttonElement=W,this.update_()}update_(){const _=this.value.rawValue;this.swatchElem_.style.backgroundColor=colorToHexRgbaString(_)}onValueChange_(){this.update_()}}class ColorSwatchController{constructor(_,T){this.value=T.value,this.viewProps=T.viewProps,this.view=new ColorSwatchView(_,{value:this.value,viewProps:this.viewProps})}}class ColorController{constructor(_,T){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=T.value,this.viewProps=T.viewProps,this.foldable_=Foldable.create(T.expanded),this.swatchC_=new ColorSwatchController(_,{value:this.value,viewProps:this.viewProps});const E=this.swatchC_.view.buttonElement;E.addEventListener("blur",this.onButtonBlur_),E.addEventListener("click",this.onButtonClick_),this.textC_=new TextController(_,{parser:T.parser,props:ValueMap.fromObject({formatter:T.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new ColorView(_,{foldable:this.foldable_,pickerLayout:T.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=T.pickerLayout==="popup"?new PopupController(_,{viewProps:this.viewProps}):null;const W=new ColorPickerController(_,{colorType:T.colorType,supportsAlpha:T.supportsAlpha,value:this.value,viewProps:this.viewProps});W.view.allFocusableElements.forEach(X=>{X.addEventListener("blur",this.onPopupChildBlur_),X.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=W,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(W.view.element),connectValues({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:X=>X,backward:(X,q)=>q})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),bindFoldable(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(_){if(!this.popC_)return;const T=this.view.element,E=_.relatedTarget;(!E||!T.contains(E))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(_){if(!this.popC_)return;const T=this.popC_.view.element,E=findNextTarget(_);E&&T.contains(E)||E&&E===this.swatchC_.view.buttonElement&&!supportsTouch(T.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(_){this.popC_?_.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&_.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function colorToRgbNumber(B){return removeAlphaComponent(B.getComponents("rgb")).reduce((_,T)=>_<<8|Math.floor(T)&255,0)}function colorToRgbaNumber(B){return B.getComponents("rgb").reduce((_,T,E)=>{const W=Math.floor(E===3?T*255:T)&255;return _<<8|W},0)>>>0}function numberToRgbColor(B){return new IntColor([B>>16&255,B>>8&255,B&255],"rgb")}function numberToRgbaColor(B){return new IntColor([B>>24&255,B>>16&255,B>>8&255,mapRange$1(B&255,0,255,0,1)],"rgb")}function colorFromRgbNumber(B){return typeof B!="number"?IntColor.black():numberToRgbColor(B)}function colorFromRgbaNumber(B){return typeof B!="number"?IntColor.black():numberToRgbaColor(B)}function isRgbColorComponent(B,_){return typeof B!="object"||isEmpty(B)?!1:_ in B&&typeof B[_]=="number"}function isRgbColorObject(B){return isRgbColorComponent(B,"r")&&isRgbColorComponent(B,"g")&&isRgbColorComponent(B,"b")}function isRgbaColorObject(B){return isRgbColorObject(B)&&isRgbColorComponent(B,"a")}function isColorObject(B){return isRgbColorObject(B)}function equalsColor(B,_){if(B.mode!==_.mode||B.type!==_.type)return!1;const T=B.getComponents(),E=_.getComponents();for(let W=0;W<T.length;W++)if(T[W]!==E[W])return!1;return!0}function createColorComponentsFromRgbObject(B){return"a"in B?[B.r,B.g,B.b,B.a]:[B.r,B.g,B.b]}function createColorStringWriter(B){const _=findColorStringifier(B);return _?(T,E)=>{writePrimitive(T,_(E))}:null}function createColorNumberWriter(B){const _=B?colorToRgbaNumber:colorToRgbNumber;return(T,E)=>{writePrimitive(T,_(E))}}function writeRgbaColorObject(B,_,T){const W=mapColorType(_,T).toRgbaObject();B.writeProperty("r",W.r),B.writeProperty("g",W.g),B.writeProperty("b",W.b),B.writeProperty("a",W.a)}function writeRgbColorObject(B,_,T){const W=mapColorType(_,T).toRgbaObject();B.writeProperty("r",W.r),B.writeProperty("g",W.g),B.writeProperty("b",W.b)}function createColorObjectWriter(B,_){return(T,E)=>{B?writeRgbaColorObject(T,E,_):writeRgbColorObject(T,E,_)}}function shouldSupportAlpha$1(B){var _;return!!(!((_=B==null?void 0:B.color)===null||_===void 0)&&_.alpha)}function createFormatter$1(B){return B?_=>colorToHexRgbaString(_,"0x"):_=>colorToHexRgbString(_,"0x")}function isForColor(B){return"color"in B||B.view==="color"}createPlugin({id:"input-color-number",type:"input",accept:(B,_)=>{if(typeof B!="number"||!isForColor(_))return null;const T=parseColorInputParams(_);return T?{initialValue:B,params:Object.assign(Object.assign({},T),{supportsAlpha:shouldSupportAlpha$1(_)})}:null},binding:{reader:B=>B.params.supportsAlpha?colorFromRgbaNumber:colorFromRgbNumber,equals:equalsColor,writer:B=>createColorNumberWriter(B.params.supportsAlpha)},controller:B=>{var _,T;return new ColorController(B.document,{colorType:"int",expanded:(_=B.params.expanded)!==null&&_!==void 0?_:!1,formatter:createFormatter$1(B.params.supportsAlpha),parser:createColorStringParser("int"),pickerLayout:(T=B.params.picker)!==null&&T!==void 0?T:"popup",supportsAlpha:B.params.supportsAlpha,value:B.value,viewProps:B.viewProps})}});function colorFromObject(B,_){if(!isColorObject(B))return mapColorType(IntColor.black(),_);if(_==="int"){const T=createColorComponentsFromRgbObject(B);return new IntColor(T,"rgb")}if(_==="float"){const T=createColorComponentsFromRgbObject(B);return new FloatColor(T,"rgb")}return mapColorType(IntColor.black(),"int")}function shouldSupportAlpha(B){return isRgbaColorObject(B)}function createColorObjectBindingReader(B){return _=>{const T=colorFromObject(_,B);return mapColorType(T,"int")}}function createColorObjectFormatter(B,_){return T=>B?colorToObjectRgbaString(T,_):colorToObjectRgbString(T,_)}createPlugin({id:"input-color-object",type:"input",accept:(B,_)=>{var T;if(!isColorObject(B))return null;const E=parseColorInputParams(_);return E?{initialValue:B,params:Object.assign(Object.assign({},E),{colorType:(T=extractColorType(_))!==null&&T!==void 0?T:"int"})}:null},binding:{reader:B=>createColorObjectBindingReader(B.params.colorType),equals:equalsColor,writer:B=>createColorObjectWriter(shouldSupportAlpha(B.initialValue),B.params.colorType)},controller:B=>{var _,T;const E=isRgbaColorObject(B.initialValue);return new ColorController(B.document,{colorType:B.params.colorType,expanded:(_=B.params.expanded)!==null&&_!==void 0?_:!1,formatter:createColorObjectFormatter(E,B.params.colorType),parser:createColorStringParser("int"),pickerLayout:(T=B.params.picker)!==null&&T!==void 0?T:"popup",supportsAlpha:E,value:B.value,viewProps:B.viewProps})}});createPlugin({id:"input-color-string",type:"input",accept:(B,_)=>{if(typeof B!="string"||_.view==="text")return null;const T=detectStringColorFormat(B,extractColorType(_));if(!T)return null;const E=findColorStringifier(T);if(!E)return null;const W=parseColorInputParams(_);return W?{initialValue:B,params:Object.assign(Object.assign({},W),{format:T,stringifier:E})}:null},binding:{reader:()=>readIntColorString,equals:equalsColor,writer:B=>{const _=createColorStringWriter(B.params.format);if(!_)throw TpError.notBindable();return _}},controller:B=>{var _,T;return new ColorController(B.document,{colorType:B.params.format.type,expanded:(_=B.params.expanded)!==null&&_!==void 0?_:!1,formatter:B.params.stringifier,parser:createColorStringParser("int"),pickerLayout:(T=B.params.picker)!==null&&T!==void 0?T:"popup",supportsAlpha:B.params.format.alpha,value:B.value,viewProps:B.viewProps})}});class PointNdConstraint{constructor(_){this.components=_.components,this.asm_=_.assembly}constrain(_){const T=this.asm_.toComponents(_).map((E,W)=>{var X,q;return(q=(X=this.components[W])===null||X===void 0?void 0:X.constrain(E))!==null&&q!==void 0?q:E});return this.asm_.fromComponents(T)}}const cn$6=ClassName("pndtxt");class PointNdTextView{constructor(_,T){this.textViews=T.textViews,this.element=_.createElement("div"),this.element.classList.add(cn$6()),this.textViews.forEach(E=>{const W=_.createElement("div");W.classList.add(cn$6("a")),W.appendChild(E.element),this.element.appendChild(W)})}}function createAxisController(B,_,T){return new NumberTextController(B,{arrayPosition:T===0?"fst":T===_.axes.length-1?"lst":"mid",parser:_.parser,props:_.axes[T].textProps,value:createValue(0,{constraint:_.axes[T].constraint}),viewProps:_.viewProps})}class PointNdTextController{constructor(_,T){this.value=T.value,this.viewProps=T.viewProps,this.acs_=T.axes.map((E,W)=>createAxisController(_,T,W)),this.acs_.forEach((E,W)=>{connectValues({primary:this.value,secondary:E.value,forward:X=>T.assembly.toComponents(X)[W],backward:(X,q)=>{const Y=T.assembly.toComponents(X);return Y[W]=q,T.assembly.fromComponents(Y)}})}),this.view=new PointNdTextView(_,{textViews:this.acs_.map(E=>E.view)})}get textControllers(){return this.acs_}}class SliderInputBindingApi extends BindingApi{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(_){this.controller.valueController.sliderController.props.set("max",_)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(_){this.controller.valueController.sliderController.props.set("min",_)}}function createConstraint$4(B,_){const T=[],E=createStepConstraint(B,_);E&&T.push(E);const W=createRangeConstraint(B);W&&T.push(W);const X=createListConstraint(B.options);return X&&T.push(X),new CompositeConstraint(T)}createPlugin({id:"input-number",type:"input",accept:(B,_)=>{if(typeof B!="number")return null;const T=parseRecord(_,E=>Object.assign(Object.assign({},createNumberTextInputParamsParser(E)),{options:E.optional.custom(parseListOptions),readonly:E.optional.constant(!1)}));return T?{initialValue:B,params:T}:null},binding:{reader:B=>numberFromUnknown,constraint:B=>createConstraint$4(B.params,B.initialValue),writer:B=>writePrimitive},controller:B=>{const _=B.value,T=B.constraint,E=T&&findConstraint(T,ListConstraint);if(E)return new ListController(B.document,{props:new ValueMap({options:E.values.value("options")}),value:_,viewProps:B.viewProps});const W=createNumberTextPropsObject(B.params,_.rawValue),X=T&&findConstraint(T,DefiniteRangeConstraint);return X?new SliderTextController(B.document,Object.assign(Object.assign({},createSliderTextProps(Object.assign(Object.assign({},W),{keyScale:createValue(W.keyScale),max:X.values.value("max"),min:X.values.value("min")}))),{parser:parseNumber,value:_,viewProps:B.viewProps})):new NumberTextController(B.document,{parser:parseNumber,props:ValueMap.fromObject(W),value:_,viewProps:B.viewProps})},api(B){return typeof B.controller.value.rawValue!="number"?null:B.controller.valueController instanceof SliderTextController?new SliderInputBindingApi(B.controller):B.controller.valueController instanceof ListController?new ListInputBindingApi(B.controller):null}});class Point2d{constructor(_=0,T=0){this.x=_,this.y=T}getComponents(){return[this.x,this.y]}static isObject(_){if(isEmpty(_))return!1;const T=_.x,E=_.y;return!(typeof T!="number"||typeof E!="number")}static equals(_,T){return _.x===T.x&&_.y===T.y}toObject(){return{x:this.x,y:this.y}}}const Point2dAssembly={toComponents:B=>B.getComponents(),fromComponents:B=>new Point2d(...B)},cn$5=ClassName("p2d");class Point2dView{constructor(_,T){this.element=_.createElement("div"),this.element.classList.add(cn$5()),T.viewProps.bindClassModifiers(this.element),bindValue(T.expanded,valueToClassName(this.element,cn$5(void 0,"expanded")));const E=_.createElement("div");E.classList.add(cn$5("h")),this.element.appendChild(E);const W=_.createElement("button");W.classList.add(cn$5("b")),W.appendChild(createSvgIconElement(_,"p2dpad")),T.viewProps.bindDisabled(W),E.appendChild(W),this.buttonElement=W;const X=_.createElement("div");if(X.classList.add(cn$5("t")),E.appendChild(X),this.textElement=X,T.pickerLayout==="inline"){const q=_.createElement("div");q.classList.add(cn$5("p")),this.element.appendChild(q),this.pickerElement=q}else this.pickerElement=null}}const cn$4=ClassName("p2dp");class Point2dPickerView{constructor(_,T){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=T.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=_.createElement("div"),this.element.classList.add(cn$4()),T.layout==="popup"&&this.element.classList.add(cn$4(void 0,"p")),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("div");E.classList.add(cn$4("p")),T.viewProps.bindTabIndex(E),this.element.appendChild(E),this.padElement=E;const W=_.createElementNS(SVG_NS,"svg");W.classList.add(cn$4("g")),this.padElement.appendChild(W),this.svgElem_=W;const X=_.createElementNS(SVG_NS,"line");X.classList.add(cn$4("ax")),X.setAttributeNS(null,"x1","0"),X.setAttributeNS(null,"y1","50%"),X.setAttributeNS(null,"x2","100%"),X.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(X);const q=_.createElementNS(SVG_NS,"line");q.classList.add(cn$4("ax")),q.setAttributeNS(null,"x1","50%"),q.setAttributeNS(null,"y1","0"),q.setAttributeNS(null,"x2","50%"),q.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(q);const Y=_.createElementNS(SVG_NS,"line");Y.classList.add(cn$4("l")),Y.setAttributeNS(null,"x1","50%"),Y.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(Y),this.lineElem_=Y;const te=_.createElement("div");te.classList.add(cn$4("m")),this.padElement.appendChild(te),this.markerElem_=te,T.value.emitter.on("change",this.onValueChange_),this.value=T.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[_,T]=this.value.rawValue.getComponents(),E=this.props_.get("max"),W=mapRange$1(_,-E,+E,0,100),X=mapRange$1(T,-E,+E,0,100),q=this.props_.get("invertsY")?100-X:X;this.lineElem_.setAttributeNS(null,"x2",`${W}%`),this.lineElem_.setAttributeNS(null,"y2",`${q}%`),this.markerElem_.style.left=`${W}%`,this.markerElem_.style.top=`${q}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function computeOffset(B,_,T){return[getStepForKey(_[0],getHorizontalStepKeys(B)),getStepForKey(_[1],getVerticalStepKeys(B))*(T?1:-1)]}class Point2dPickerController{constructor(_,T){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=T.props,this.value=T.value,this.viewProps=T.viewProps,this.view=new Point2dPickerView(_,{layout:T.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new PointerHandler(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(_,T){if(!_.point)return;const E=this.props.get("max"),W=mapRange$1(_.point.x,0,_.bounds.width,-E,+E),X=mapRange$1(this.props.get("invertsY")?_.bounds.height-_.point.y:_.point.y,0,_.bounds.height,-E,+E);this.value.setRawValue(new Point2d(W,X),T)}onPointerDown_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerMove_(_){this.handlePointerEvent_(_.data,{forceEmit:!1,last:!1})}onPointerUp_(_){this.handlePointerEvent_(_.data,{forceEmit:!0,last:!0})}onPadKeyDown_(_){isArrowKey(_.key)&&_.preventDefault();const[T,E]=computeOffset(_,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));T===0&&E===0||this.value.setRawValue(new Point2d(this.value.rawValue.x+T,this.value.rawValue.y+E),{forceEmit:!1,last:!1})}onPadKeyUp_(_){const[T,E]=computeOffset(_,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));T===0&&E===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Point2dController{constructor(_,T){var E,W;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=T.value,this.viewProps=T.viewProps,this.foldable_=Foldable.create(T.expanded),this.popC_=T.pickerLayout==="popup"?new PopupController(_,{viewProps:this.viewProps}):null;const X=new Point2dPickerController(_,{layout:T.pickerLayout,props:new ValueMap({invertsY:createValue(T.invertsY),max:createValue(T.max),xKeyScale:T.axes[0].textProps.value("keyScale"),yKeyScale:T.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});X.view.allFocusableElements.forEach(q=>{q.addEventListener("blur",this.onPopupChildBlur_),q.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=X,this.textC_=new PointNdTextController(_,{assembly:Point2dAssembly,axes:T.axes,parser:T.parser,value:this.value,viewProps:this.viewProps}),this.view=new Point2dView(_,{expanded:this.foldable_.value("expanded"),pickerLayout:T.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(E=this.view.buttonElement)===null||E===void 0||E.addEventListener("blur",this.onPadButtonBlur_),(W=this.view.buttonElement)===null||W===void 0||W.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),connectValues({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:q=>q,backward:(q,Y)=>Y})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),bindFoldable(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(_){if(!this.popC_)return;const T=this.view.element,E=_.relatedTarget;(!E||!T.contains(E))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(_){if(!this.popC_)return;const T=this.popC_.view.element,E=findNextTarget(_);E&&T.contains(E)||E&&E===this.view.buttonElement&&!supportsTouch(T.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(_){this.popC_?_.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&_.key==="Escape"&&this.view.buttonElement.focus()}}function point2dFromUnknown(B){return Point2d.isObject(B)?new Point2d(B.x,B.y):new Point2d}function writePoint2d(B,_){B.writeProperty("x",_.x),B.writeProperty("y",_.y)}function createConstraint$3(B,_){return new PointNdConstraint({assembly:Point2dAssembly,components:[createDimensionConstraint(Object.assign(Object.assign({},B),B.x),_.x),createDimensionConstraint(Object.assign(Object.assign({},B),B.y),_.y)]})}function getSuitableMaxDimensionValue(B,_){var T,E;if(!isEmpty(B.min)||!isEmpty(B.max))return Math.max(Math.abs((T=B.min)!==null&&T!==void 0?T:0),Math.abs((E=B.max)!==null&&E!==void 0?E:0));const W=getSuitableKeyScale(B);return Math.max(Math.abs(W)*10,Math.abs(_)*10)}function getSuitableMax(B,_){var T,E;const W=getSuitableMaxDimensionValue(deepMerge(B,(T=B.x)!==null&&T!==void 0?T:{}),_.x),X=getSuitableMaxDimensionValue(deepMerge(B,(E=B.y)!==null&&E!==void 0?E:{}),_.y);return Math.max(W,X)}function shouldInvertY(B){if(!("y"in B))return!1;const _=B.y;return _&&"inverted"in _?!!_.inverted:!1}createPlugin({id:"input-point2d",type:"input",accept:(B,_)=>{if(!Point2d.isObject(B))return null;const T=parseRecord(_,E=>Object.assign(Object.assign({},createPointDimensionParser(E)),{expanded:E.optional.boolean,picker:E.optional.custom(parsePickerLayout),readonly:E.optional.constant(!1),x:E.optional.custom(parsePointDimensionParams),y:E.optional.object(Object.assign(Object.assign({},createPointDimensionParser(E)),{inverted:E.optional.boolean}))}));return T?{initialValue:B,params:T}:null},binding:{reader:()=>point2dFromUnknown,constraint:B=>createConstraint$3(B.params,B.initialValue),equals:Point2d.equals,writer:()=>writePoint2d},controller:B=>{var _,T;const E=B.document,W=B.value,X=B.constraint,q=[B.params.x,B.params.y];return new Point2dController(E,{axes:W.rawValue.getComponents().map((Y,te)=>{var ne;return createPointAxis({constraint:X.components[te],initialValue:Y,params:deepMerge(B.params,(ne=q[te])!==null&&ne!==void 0?ne:{})})}),expanded:(_=B.params.expanded)!==null&&_!==void 0?_:!1,invertsY:shouldInvertY(B.params),max:getSuitableMax(B.params,W.rawValue),parser:parseNumber,pickerLayout:(T=B.params.picker)!==null&&T!==void 0?T:"popup",value:W,viewProps:B.viewProps})}});class Point3d{constructor(_=0,T=0,E=0){this.x=_,this.y=T,this.z=E}getComponents(){return[this.x,this.y,this.z]}static isObject(_){if(isEmpty(_))return!1;const T=_.x,E=_.y,W=_.z;return!(typeof T!="number"||typeof E!="number"||typeof W!="number")}static equals(_,T){return _.x===T.x&&_.y===T.y&&_.z===T.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const Point3dAssembly={toComponents:B=>B.getComponents(),fromComponents:B=>new Point3d(...B)};function point3dFromUnknown(B){return Point3d.isObject(B)?new Point3d(B.x,B.y,B.z):new Point3d}function writePoint3d(B,_){B.writeProperty("x",_.x),B.writeProperty("y",_.y),B.writeProperty("z",_.z)}function createConstraint$2(B,_){return new PointNdConstraint({assembly:Point3dAssembly,components:[createDimensionConstraint(Object.assign(Object.assign({},B),B.x),_.x),createDimensionConstraint(Object.assign(Object.assign({},B),B.y),_.y),createDimensionConstraint(Object.assign(Object.assign({},B),B.z),_.z)]})}createPlugin({id:"input-point3d",type:"input",accept:(B,_)=>{if(!Point3d.isObject(B))return null;const T=parseRecord(_,E=>Object.assign(Object.assign({},createPointDimensionParser(E)),{readonly:E.optional.constant(!1),x:E.optional.custom(parsePointDimensionParams),y:E.optional.custom(parsePointDimensionParams),z:E.optional.custom(parsePointDimensionParams)}));return T?{initialValue:B,params:T}:null},binding:{reader:B=>point3dFromUnknown,constraint:B=>createConstraint$2(B.params,B.initialValue),equals:Point3d.equals,writer:B=>writePoint3d},controller:B=>{const _=B.value,T=B.constraint,E=[B.params.x,B.params.y,B.params.z];return new PointNdTextController(B.document,{assembly:Point3dAssembly,axes:_.rawValue.getComponents().map((W,X)=>{var q;return createPointAxis({constraint:T.components[X],initialValue:W,params:deepMerge(B.params,(q=E[X])!==null&&q!==void 0?q:{})})}),parser:parseNumber,value:_,viewProps:B.viewProps})}});class Point4d{constructor(_=0,T=0,E=0,W=0){this.x=_,this.y=T,this.z=E,this.w=W}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(_){if(isEmpty(_))return!1;const T=_.x,E=_.y,W=_.z,X=_.w;return!(typeof T!="number"||typeof E!="number"||typeof W!="number"||typeof X!="number")}static equals(_,T){return _.x===T.x&&_.y===T.y&&_.z===T.z&&_.w===T.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const Point4dAssembly={toComponents:B=>B.getComponents(),fromComponents:B=>new Point4d(...B)};function point4dFromUnknown(B){return Point4d.isObject(B)?new Point4d(B.x,B.y,B.z,B.w):new Point4d}function writePoint4d(B,_){B.writeProperty("x",_.x),B.writeProperty("y",_.y),B.writeProperty("z",_.z),B.writeProperty("w",_.w)}function createConstraint$1(B,_){return new PointNdConstraint({assembly:Point4dAssembly,components:[createDimensionConstraint(Object.assign(Object.assign({},B),B.x),_.x),createDimensionConstraint(Object.assign(Object.assign({},B),B.y),_.y),createDimensionConstraint(Object.assign(Object.assign({},B),B.z),_.z),createDimensionConstraint(Object.assign(Object.assign({},B),B.w),_.w)]})}createPlugin({id:"input-point4d",type:"input",accept:(B,_)=>{if(!Point4d.isObject(B))return null;const T=parseRecord(_,E=>Object.assign(Object.assign({},createPointDimensionParser(E)),{readonly:E.optional.constant(!1),w:E.optional.custom(parsePointDimensionParams),x:E.optional.custom(parsePointDimensionParams),y:E.optional.custom(parsePointDimensionParams),z:E.optional.custom(parsePointDimensionParams)}));return T?{initialValue:B,params:T}:null},binding:{reader:B=>point4dFromUnknown,constraint:B=>createConstraint$1(B.params,B.initialValue),equals:Point4d.equals,writer:B=>writePoint4d},controller:B=>{const _=B.value,T=B.constraint,E=[B.params.x,B.params.y,B.params.z,B.params.w];return new PointNdTextController(B.document,{assembly:Point4dAssembly,axes:_.rawValue.getComponents().map((W,X)=>{var q;return createPointAxis({constraint:T.components[X],initialValue:W,params:deepMerge(B.params,(q=E[X])!==null&&q!==void 0?q:{})})}),parser:parseNumber,value:_,viewProps:B.viewProps})}});function createConstraint(B){const _=[],T=createListConstraint(B.options);return T&&_.push(T),new CompositeConstraint(_)}createPlugin({id:"input-string",type:"input",accept:(B,_)=>{if(typeof B!="string")return null;const T=parseRecord(_,E=>({readonly:E.optional.constant(!1),options:E.optional.custom(parseListOptions)}));return T?{initialValue:B,params:T}:null},binding:{reader:B=>stringFromUnknown,constraint:B=>createConstraint(B.params),writer:B=>writePrimitive},controller:B=>{const _=B.document,T=B.value,E=B.constraint,W=E&&findConstraint(E,ListConstraint);return W?new ListController(_,{props:new ValueMap({options:W.values.value("options")}),value:T,viewProps:B.viewProps}):new TextController(_,{parser:X=>X,props:ValueMap.fromObject({formatter:formatString}),value:T,viewProps:B.viewProps})},api(B){return typeof B.controller.value.rawValue!="string"?null:B.controller.valueController instanceof ListController?new ListInputBindingApi(B.controller):null}});const Constants={monitor:{defaultInterval:200,defaultRows:3}},cn$3=ClassName("mll");class MultiLogView{constructor(_,T){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=T.formatter,this.element=_.createElement("div"),this.element.classList.add(cn$3()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("textarea");E.classList.add(cn$3("i")),E.style.height=`calc(var(${getCssVar("containerUnitSize")}) * ${T.rows})`,E.readOnly=!0,T.viewProps.bindDisabled(E),this.element.appendChild(E),this.textareaElem_=E,T.value.emitter.on("change",this.onValueUpdate_),this.value=T.value,this.update_()}update_(){const _=this.textareaElem_,T=_.scrollTop===_.scrollHeight-_.clientHeight,E=[];this.value.rawValue.forEach(W=>{W!==void 0&&E.push(this.formatter_(W))}),_.textContent=E.join(`
`),T&&(_.scrollTop=_.scrollHeight)}onValueUpdate_(){this.update_()}}class MultiLogController{constructor(_,T){this.value=T.value,this.viewProps=T.viewProps,this.view=new MultiLogView(_,{formatter:T.formatter,rows:T.rows,value:this.value,viewProps:this.viewProps})}}const cn$2=ClassName("sgl");class SingleLogView{constructor(_,T){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=T.formatter,this.element=_.createElement("div"),this.element.classList.add(cn$2()),T.viewProps.bindClassModifiers(this.element);const E=_.createElement("input");E.classList.add(cn$2("i")),E.readOnly=!0,E.type="text",T.viewProps.bindDisabled(E),this.element.appendChild(E),this.inputElement=E,T.value.emitter.on("change",this.onValueUpdate_),this.value=T.value,this.update_()}update_(){const _=this.value.rawValue,T=_[_.length-1];this.inputElement.value=T!==void 0?this.formatter_(T):""}onValueUpdate_(){this.update_()}}class SingleLogController{constructor(_,T){this.value=T.value,this.viewProps=T.viewProps,this.view=new SingleLogView(_,{formatter:T.formatter,value:this.value,viewProps:this.viewProps})}}createPlugin({id:"monitor-bool",type:"monitor",accept:(B,_)=>{if(typeof B!="boolean")return null;const T=parseRecord(_,E=>({readonly:E.required.constant(!0),rows:E.optional.number}));return T?{initialValue:B,params:T}:null},binding:{reader:B=>boolFromUnknown},controller:B=>{var _;return B.value.rawValue.length===1?new SingleLogController(B.document,{formatter:BooleanFormatter,value:B.value,viewProps:B.viewProps}):new MultiLogController(B.document,{formatter:BooleanFormatter,rows:(_=B.params.rows)!==null&&_!==void 0?_:Constants.monitor.defaultRows,value:B.value,viewProps:B.viewProps})}});class GraphLogMonitorBindingApi extends BindingApi{get max(){return this.controller.valueController.props.get("max")}set max(_){this.controller.valueController.props.set("max",_)}get min(){return this.controller.valueController.props.get("min")}set min(_){this.controller.valueController.props.set("min",_)}}const cn$1=ClassName("grl");class GraphLogView{constructor(_,T){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=_.createElement("div"),this.element.classList.add(cn$1()),T.viewProps.bindClassModifiers(this.element),this.formatter_=T.formatter,this.props_=T.props,this.cursor_=T.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const E=_.createElementNS(SVG_NS,"svg");E.classList.add(cn$1("g")),E.style.height=`calc(var(${getCssVar("containerUnitSize")}) * ${T.rows})`,this.element.appendChild(E),this.svgElem_=E;const W=_.createElementNS(SVG_NS,"polyline");this.svgElem_.appendChild(W),this.lineElem_=W;const X=_.createElement("div");X.classList.add(cn$1("t"),ClassName("tt")()),this.element.appendChild(X),this.tooltipElem_=X,T.value.emitter.on("change",this.onValueUpdate_),this.value=T.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:_,clientHeight:T}=this.element,E=this.value.rawValue.length-1,W=this.props_.get("min"),X=this.props_.get("max"),q=[];this.value.rawValue.forEach((le,ue)=>{if(le===void 0)return;const ge=mapRange$1(ue,0,E,0,_),ye=mapRange$1(le,W,X,T,0);q.push([ge,ye].join(","))}),this.lineElem_.setAttributeNS(null,"points",q.join(" "));const Y=this.tooltipElem_,te=this.value.rawValue[this.cursor_.rawValue];if(te===void 0){Y.classList.remove(cn$1("t","a"));return}const ne=mapRange$1(this.cursor_.rawValue,0,E,0,_),ae=mapRange$1(te,W,X,T,0);Y.style.left=`${ne}px`,Y.style.top=`${ae}px`,Y.textContent=`${this.formatter_(te)}`,Y.classList.contains(cn$1("t","a"))||(Y.classList.add(cn$1("t","a"),cn$1("t","in")),forceReflow(Y),Y.classList.remove(cn$1("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class GraphLogController{constructor(_,T){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=T.props,this.value=T.value,this.viewProps=T.viewProps,this.cursor_=createValue(-1),this.view=new GraphLogView(_,{cursor:this.cursor_,formatter:T.formatter,rows:T.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!supportsTouch(_))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const E=new PointerHandler(this.view.element);E.emitter.on("down",this.onGraphPointerDown_),E.emitter.on("move",this.onGraphPointerMove_),E.emitter.on("up",this.onGraphPointerUp_)}}importProps(_){return importBladeState(_,null,T=>({max:T.required.number,min:T.required.number}),T=>(this.props.set("max",T.max),this.props.set("min",T.min),!0))}exportProps(){return exportBladeState(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(_){const{clientWidth:T}=this.view.element;this.cursor_.rawValue=Math.floor(mapRange$1(_.offsetX,0,T,0,this.value.rawValue.length))}onGraphPointerDown_(_){this.onGraphPointerMove_(_)}onGraphPointerMove_(_){if(!_.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(mapRange$1(_.data.point.x,0,_.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function createFormatter(B){return isEmpty(B.format)?createNumberFormatter(2):B.format}function createTextMonitor(B){var _;return B.value.rawValue.length===1?new SingleLogController(B.document,{formatter:createFormatter(B.params),value:B.value,viewProps:B.viewProps}):new MultiLogController(B.document,{formatter:createFormatter(B.params),rows:(_=B.params.rows)!==null&&_!==void 0?_:Constants.monitor.defaultRows,value:B.value,viewProps:B.viewProps})}function createGraphMonitor(B){var _,T,E;return new GraphLogController(B.document,{formatter:createFormatter(B.params),rows:(_=B.params.rows)!==null&&_!==void 0?_:Constants.monitor.defaultRows,props:ValueMap.fromObject({max:(T=B.params.max)!==null&&T!==void 0?T:100,min:(E=B.params.min)!==null&&E!==void 0?E:0}),value:B.value,viewProps:B.viewProps})}function shouldShowGraph(B){return B.view==="graph"}createPlugin({id:"monitor-number",type:"monitor",accept:(B,_)=>{if(typeof B!="number")return null;const T=parseRecord(_,E=>({format:E.optional.function,max:E.optional.number,min:E.optional.number,readonly:E.required.constant(!0),rows:E.optional.number,view:E.optional.string}));return T?{initialValue:B,params:T}:null},binding:{defaultBufferSize:B=>shouldShowGraph(B)?64:1,reader:B=>numberFromUnknown},controller:B=>shouldShowGraph(B.params)?createGraphMonitor(B):createTextMonitor(B),api:B=>B.controller.valueController instanceof GraphLogController?new GraphLogMonitorBindingApi(B.controller):null});createPlugin({id:"monitor-string",type:"monitor",accept:(B,_)=>{if(typeof B!="string")return null;const T=parseRecord(_,E=>({multiline:E.optional.boolean,readonly:E.required.constant(!0),rows:E.optional.number}));return T?{initialValue:B,params:T}:null},binding:{reader:B=>stringFromUnknown},controller:B=>{var _;const T=B.value;return T.rawValue.length>1||B.params.multiline?new MultiLogController(B.document,{formatter:formatString,rows:(_=B.params.rows)!==null&&_!==void 0?_:Constants.monitor.defaultRows,value:T,viewProps:B.viewProps}):new SingleLogController(B.document,{formatter:formatString,value:T,viewProps:B.viewProps})}});new Semver("4.0.3");const Pa=parseInt(REVISION.replace(/\D+/g,""));var xc=Object.defineProperty,wc=(B,_,T)=>_ in B?xc(B,_,{enumerable:!0,configurable:!0,writable:!0,value:T}):B[_]=T,Tc=(B,_,T)=>(wc(B,_+"",T),T);async function Vr(B){const _=await B.arrayBuffer(),T=btoa(String.fromCharCode(...new Uint8Array(_)));return`data:${B.type||""};base64,${T}`}let zs,Ti,Nn,Hs;function bi(B,_=1/0,T=null){Ti||(Ti=new PlaneGeometry(2,2,1,1)),Nn||(Nn=new ShaderMaterial({uniforms:{blitTexture:new Uniform(B)},vertexShader:`
        varying vec2 vUv;
        void main(){
            vUv = uv;
            gl_Position = vec4(position.xy * 1.0,0.,.999999);
        }
      `,fragmentShader:`
          uniform sampler2D blitTexture; 
          varying vec2 vUv;

          void main(){ 
              gl_FragColor = vec4(vUv.xy, 0, 1);
              
              #ifdef IS_SRGB
              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
              #else
              gl_FragColor = texture2D( blitTexture, vUv);
              #endif
          }
      `})),Nn.uniforms.blitTexture.value=B,Nn.defines.IS_SRGB="colorSpace"in B?B.colorSpace==="srgb":B.encoding===3001,Nn.needsUpdate=!0,Hs||(Hs=new Mesh(Ti,Nn),Hs.frustrumCulled=!1);const E=new PerspectiveCamera,W=new Scene;W.add(Hs),T||(T=zs=new WebGLRenderer({antialias:!1})),T.setSize(Math.min(B.image.width,_),Math.min(B.image.height,_)),T.clear(),T.render(W,E);const X=new Texture(T.domElement);return X.minFilter=B.minFilter,X.magFilter=B.magFilter,X.wrapS=B.wrapS,X.wrapT=B.wrapT,X.name=B.name,zs&&(zs.dispose(),zs=null),X}const Yr={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Mr{constructor(){this.pluginCallbacks=[],this.register(function(_){return new Dc(_)}),this.register(function(_){return new Oc(_)}),this.register(function(_){return new kc(_)}),this.register(function(_){return new Bc(_)}),this.register(function(_){return new Uc(_)}),this.register(function(_){return new Nc(_)}),this.register(function(_){return new Lc(_)}),this.register(function(_){return new Fc(_)}),this.register(function(_){return new zc(_)}),this.register(function(_){return new Hc(_)}),this.register(function(_){return new jc(_)})}register(_){return this.pluginCallbacks.indexOf(_)===-1&&this.pluginCallbacks.push(_),this}unregister(_){return this.pluginCallbacks.indexOf(_)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_),1),this}parse(_,T,E,W){const X=new Rc,q=[];for(let Y=0,te=this.pluginCallbacks.length;Y<te;Y++)q.push(this.pluginCallbacks[Y](X));X.setPlugins(q),X.write(_,T,W).catch(E)}parseAsync(_,T){const E=this;return new Promise(function(W,X){E.parse(_,W,X,T)})}}Tc(Mr,"Utils",{insertKeyframe:function(B,_){const T=B.getValueSize(),E=new B.TimeBufferType(B.times.length+1),W=new B.ValueBufferType(B.values.length+T),X=B.createInterpolant(new B.ValueBufferType(T));let q;if(B.times.length===0){E[0]=_;for(let Y=0;Y<T;Y++)W[Y]=0;q=0}else if(_<B.times[0]){if(Math.abs(B.times[0]-_)<.001)return 0;E[0]=_,E.set(B.times,1),W.set(X.evaluate(_),0),W.set(B.values,T),q=0}else if(_>B.times[B.times.length-1]){if(Math.abs(B.times[B.times.length-1]-_)<.001)return B.times.length-1;E[E.length-1]=_,E.set(B.times,0),W.set(B.values,0),W.set(X.evaluate(_),B.values.length),q=E.length-1}else for(let Y=0;Y<B.times.length;Y++){if(Math.abs(B.times[Y]-_)<.001)return Y;if(B.times[Y]<_&&B.times[Y+1]>_){E.set(B.times.slice(0,Y+1),0),E[Y+1]=_,E.set(B.times.slice(Y+1),Y+2),W.set(B.values.slice(0,(Y+1)*T),0),W.set(X.evaluate(_),(Y+1)*T),W.set(B.values.slice((Y+1)*T),(Y+2)*T),q=Y+1;break}}return B.times=E,B.values=W,q},mergeMorphTargetTracks:function(B,_){const T=[],E={},W=B.tracks;for(let X=0;X<W.length;++X){let q=W[X];const Y=PropertyBinding.parseTrackName(q.name),te=PropertyBinding.findNode(_,Y.nodeName);if(Y.propertyName!=="morphTargetInfluences"||Y.propertyIndex===void 0){T.push(q);continue}if(q.createInterpolant!==q.InterpolantFactoryMethodDiscrete&&q.createInterpolant!==q.InterpolantFactoryMethodLinear){if(q.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),q=q.clone(),q.setInterpolation(InterpolateLinear)}const ne=te.morphTargetInfluences.length,ae=te.morphTargetDictionary[Y.propertyIndex];if(ae===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+Y.propertyIndex);let le;if(E[te.uuid]===void 0){le=q.clone();const ge=new le.ValueBufferType(ne*le.times.length);for(let ye=0;ye<le.times.length;ye++)ge[ye*ne+ae]=le.values[ye];le.name=(Y.nodeName||"")+".morphTargetInfluences",le.values=ge,E[te.uuid]=le,T.push(le);continue}const ue=q.createInterpolant(new q.ValueBufferType(1));le=E[te.uuid];for(let ge=0;ge<le.times.length;ge++)le.values[ge*ne+ae]=ue.evaluate(le.times[ge]);for(let ge=0;ge<q.times.length;ge++){const ye=this.insertKeyframe(le,q.times[ge]);le.values[ye*ne+ae]=q.values[ge]}}return B.tracks=T,B}});const Ce={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},Ei="KHR_mesh_quantization",yt={};yt[NearestFilter]=Ce.NEAREST;yt[NearestMipmapNearestFilter]=Ce.NEAREST_MIPMAP_NEAREST;yt[NearestMipmapLinearFilter]=Ce.NEAREST_MIPMAP_LINEAR;yt[LinearFilter]=Ce.LINEAR;yt[LinearMipmapNearestFilter]=Ce.LINEAR_MIPMAP_NEAREST;yt[LinearMipmapLinearFilter]=Ce.LINEAR_MIPMAP_LINEAR;yt[ClampToEdgeWrapping]=Ce.CLAMP_TO_EDGE;yt[RepeatWrapping]=Ce.REPEAT;yt[MirroredRepeatWrapping]=Ce.MIRRORED_REPEAT;const Wr={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},bc=new Color,Xr=12,Ec=1179937895,Sc=2,$r=8,Mc=1313821514,Ac=5130562;function ys(B,_){return B.length===_.length&&B.every(function(T,E){return T===_[E]})}function Pc(B){return new TextEncoder().encode(B).buffer}function Cc(B){return ys(B.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function Ic(B,_,T){const E={min:new Array(B.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(B.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let W=_;W<_+T;W++)for(let X=0;X<B.itemSize;X++){let q;B.itemSize>4?q=B.array[W*B.itemSize+X]:(X===0?q=B.getX(W):X===1?q=B.getY(W):X===2?q=B.getZ(W):X===3&&(q=B.getW(W)),B.normalized===!0&&(q=MathUtils.normalize(q,B.array))),E.min[X]=Math.min(E.min[X],q),E.max[X]=Math.max(E.max[X],q)}return E}function Ca(B){return Math.ceil(B/4)*4}function Si(B,_=0){const T=Ca(B.byteLength);if(T!==B.byteLength){const E=new Uint8Array(T);if(E.set(new Uint8Array(B)),_!==0)for(let W=B.byteLength;W<T;W++)E[W]=_;return E.buffer}return B}function Zr(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function qr(B,_){if(B.toBlob!==void 0)return new Promise(E=>B.toBlob(E,_));let T;return _==="image/jpeg"?T=.92:_==="image/webp"&&(T=.8),B.convertToBlob({type:_,quality:T})}class Rc{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(_){this.plugins=_}async write(_,T,E={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},E),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(_),await Promise.all(this.pending);const W=this,X=W.buffers,q=W.json;E=W.options;const Y=W.extensionsUsed,te=W.extensionsRequired,ne=new Blob(X,{type:"application/octet-stream"}),ae=Object.keys(Y),le=Object.keys(te);ae.length>0&&(q.extensionsUsed=ae),le.length>0&&(q.extensionsRequired=le),q.buffers&&q.buffers.length>0&&(q.buffers[0].byteLength=ne.size),E.binary===!0?ne.arrayBuffer().then(ue=>{const ge=Si(ue),ye=new DataView(new ArrayBuffer($r));ye.setUint32(0,ge.byteLength,!0),ye.setUint32(4,Ac,!0);const xe=Si(Pc(JSON.stringify(q)),32),Te=new DataView(new ArrayBuffer($r));Te.setUint32(0,xe.byteLength,!0),Te.setUint32(4,Mc,!0);const Ae=new ArrayBuffer(Xr),Ie=new DataView(Ae);Ie.setUint32(0,Ec,!0),Ie.setUint32(4,Sc,!0);const Ve=Xr+Te.byteLength+xe.byteLength+ye.byteLength+ge.byteLength;Ie.setUint32(8,Ve,!0),new Blob([Ae,Te,xe,ye,ge],{type:"application/octet-stream"}).arrayBuffer().then(T)}):q.buffers&&q.buffers.length>0?Vr(ne).then(ue=>{q.buffers[0].uri=ue,T(q)}):T(q)}serializeUserData(_,T){if(Object.keys(_.userData).length===0)return;const E=this.options,W=this.extensionsUsed;try{const X=JSON.parse(JSON.stringify(_.userData));if(E.includeCustomExtensions&&X.gltfExtensions){T.extensions===void 0&&(T.extensions={});for(const q in X.gltfExtensions)T.extensions[q]=X.gltfExtensions[q],W[q]=!0;delete X.gltfExtensions}Object.keys(X).length>0&&(T.extras=X)}catch(X){console.warn("THREE.GLTFExporter: userData of '"+_.name+"' won't be serialized because of JSON.stringify error - "+X.message)}}getUID(_,T=!1){if(this.uids.has(_)===!1){const E=new Map;E.set(!0,this.uid++),E.set(!1,this.uid++),this.uids.set(_,E)}return this.uids.get(_).get(T)}isNormalizedNormalAttribute(_){if(this.cache.attributesNormalized.has(_))return!1;const T=new Vector3;for(let E=0,W=_.count;E<W;E++)if(Math.abs(T.fromBufferAttribute(_,E).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(_){const T=this.cache;if(T.attributesNormalized.has(_))return T.attributesNormalized.get(_);const E=_.clone(),W=new Vector3;for(let X=0,q=E.count;X<q;X++)W.fromBufferAttribute(E,X),W.x===0&&W.y===0&&W.z===0?W.setX(1):W.normalize(),E.setXYZ(X,W.x,W.y,W.z);return T.attributesNormalized.set(_,E),E}applyTextureTransform(_,T){let E=!1;const W={};(T.offset.x!==0||T.offset.y!==0)&&(W.offset=T.offset.toArray(),E=!0),T.rotation!==0&&(W.rotation=T.rotation,E=!0),(T.repeat.x!==1||T.repeat.y!==1)&&(W.scale=T.repeat.toArray(),E=!0),E&&(_.extensions=_.extensions||{},_.extensions.KHR_texture_transform=W,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(_,T){if(_===T)return _;function E(ue){return("colorSpace"in ue?ue.colorSpace==="srgb":ue.encoding===3001)?function(ge){return ge<.04045?ge*.0773993808:Math.pow(ge*.9478672986+.0521327014,2.4)}:function(ge){return ge}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),_ instanceof CompressedTexture&&(_=bi(_)),T instanceof CompressedTexture&&(T=bi(T));const W=_?_.image:null,X=T?T.image:null,q=Math.max(W?W.width:0,X?X.width:0),Y=Math.max(W?W.height:0,X?X.height:0),te=Zr();te.width=q,te.height=Y;const ne=te.getContext("2d");ne.fillStyle="#00ffff",ne.fillRect(0,0,q,Y);const ae=ne.getImageData(0,0,q,Y);if(W){ne.drawImage(W,0,0,q,Y);const ue=E(_),ge=ne.getImageData(0,0,q,Y).data;for(let ye=2;ye<ge.length;ye+=4)ae.data[ye]=ue(ge[ye]/256)*256}if(X){ne.drawImage(X,0,0,q,Y);const ue=E(T),ge=ne.getImageData(0,0,q,Y).data;for(let ye=1;ye<ge.length;ye+=4)ae.data[ye]=ue(ge[ye]/256)*256}ne.putImageData(ae,0,0);const le=(_||T).clone();return le.source=new Texture(te).source,"colorSpace"in le?le.colorSpace="":le.encoding=3e3,le.channel=(_||T).channel,_&&T&&_.channel!==T.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),le}processBuffer(_){const T=this.json,E=this.buffers;return T.buffers||(T.buffers=[{byteLength:0}]),E.push(_),0}processBufferView(_,T,E,W,X){const q=this.json;q.bufferViews||(q.bufferViews=[]);let Y;switch(T){case Ce.BYTE:case Ce.UNSIGNED_BYTE:Y=1;break;case Ce.SHORT:case Ce.UNSIGNED_SHORT:Y=2;break;default:Y=4}const te=Ca(W*_.itemSize*Y),ne=new DataView(new ArrayBuffer(te));let ae=0;for(let ue=E;ue<E+W;ue++)for(let ge=0;ge<_.itemSize;ge++){let ye;_.itemSize>4?ye=_.array[ue*_.itemSize+ge]:(ge===0?ye=_.getX(ue):ge===1?ye=_.getY(ue):ge===2?ye=_.getZ(ue):ge===3&&(ye=_.getW(ue)),_.normalized===!0&&(ye=MathUtils.normalize(ye,_.array))),T===Ce.FLOAT?ne.setFloat32(ae,ye,!0):T===Ce.INT?ne.setInt32(ae,ye,!0):T===Ce.UNSIGNED_INT?ne.setUint32(ae,ye,!0):T===Ce.SHORT?ne.setInt16(ae,ye,!0):T===Ce.UNSIGNED_SHORT?ne.setUint16(ae,ye,!0):T===Ce.BYTE?ne.setInt8(ae,ye):T===Ce.UNSIGNED_BYTE&&ne.setUint8(ae,ye),ae+=Y}const le={buffer:this.processBuffer(ne.buffer),byteOffset:this.byteOffset,byteLength:te};return X!==void 0&&(le.target=X),X===Ce.ARRAY_BUFFER&&(le.byteStride=_.itemSize*Y),this.byteOffset+=te,q.bufferViews.push(le),{id:q.bufferViews.length-1,byteLength:0}}processBufferViewImage(_){const T=this,E=T.json;return E.bufferViews||(E.bufferViews=[]),_.arrayBuffer().then(W=>{const X=Si(W),q={buffer:T.processBuffer(X),byteOffset:T.byteOffset,byteLength:X.byteLength};return T.byteOffset+=X.byteLength,E.bufferViews.push(q)-1})}processAccessor(_,T,E,W){const X=this.json,q={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let Y;if(_.array.constructor===Float32Array)Y=Ce.FLOAT;else if(_.array.constructor===Int32Array)Y=Ce.INT;else if(_.array.constructor===Uint32Array)Y=Ce.UNSIGNED_INT;else if(_.array.constructor===Int16Array)Y=Ce.SHORT;else if(_.array.constructor===Uint16Array)Y=Ce.UNSIGNED_SHORT;else if(_.array.constructor===Int8Array)Y=Ce.BYTE;else if(_.array.constructor===Uint8Array)Y=Ce.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+_.array.constructor.name);if(E===void 0&&(E=0),W===void 0&&(W=_.count),W===0)return null;const te=Ic(_,E,W);let ne;T!==void 0&&(ne=_===T.index?Ce.ELEMENT_ARRAY_BUFFER:Ce.ARRAY_BUFFER);const ae=this.processBufferView(_,Y,E,W,ne),le={bufferView:ae.id,byteOffset:ae.byteOffset,componentType:Y,count:W,max:te.max,min:te.min,type:q[_.itemSize]};return _.normalized===!0&&(le.normalized=!0),X.accessors||(X.accessors=[]),X.accessors.push(le)-1}processImage(_,T,E,W="image/png"){if(_!==null){const X=this,q=X.cache,Y=X.json,te=X.options,ne=X.pending;q.images.has(_)||q.images.set(_,{});const ae=q.images.get(_),le=W+":flipY/"+E.toString();if(ae[le]!==void 0)return ae[le];Y.images||(Y.images=[]);const ue={mimeType:W},ge=Zr();ge.width=Math.min(_.width,te.maxTextureSize),ge.height=Math.min(_.height,te.maxTextureSize);const ye=ge.getContext("2d");if(E===!0&&(ye.translate(0,ge.height),ye.scale(1,-1)),_.data!==void 0){T!==RGBAFormat&&console.error("GLTFExporter: Only RGBAFormat is supported.",T),(_.width>te.maxTextureSize||_.height>te.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",_);const Te=new Uint8ClampedArray(_.height*_.width*4);for(let Ae=0;Ae<Te.length;Ae+=4)Te[Ae+0]=_.data[Ae+0],Te[Ae+1]=_.data[Ae+1],Te[Ae+2]=_.data[Ae+2],Te[Ae+3]=_.data[Ae+3];ye.putImageData(new ImageData(Te,_.width,_.height),0,0)}else ye.drawImage(_,0,0,ge.width,ge.height);te.binary===!0?ne.push(qr(ge,W).then(Te=>X.processBufferViewImage(Te)).then(Te=>{ue.bufferView=Te})):ge.toDataURL!==void 0?ue.uri=ge.toDataURL(W):ne.push(qr(ge,W).then(Vr).then(Te=>{ue.uri=Te}));const xe=Y.images.push(ue)-1;return ae[le]=xe,xe}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(_){const T=this.json;T.samplers||(T.samplers=[]);const E={magFilter:yt[_.magFilter],minFilter:yt[_.minFilter],wrapS:yt[_.wrapS],wrapT:yt[_.wrapT]};return T.samplers.push(E)-1}processTexture(_){const T=this.options,E=this.cache,W=this.json;if(E.textures.has(_))return E.textures.get(_);W.textures||(W.textures=[]),_ instanceof CompressedTexture&&(_=bi(_,T.maxTextureSize));let X=_.userData.mimeType;X==="image/webp"&&(X="image/png");const q={sampler:this.processSampler(_),source:this.processImage(_.image,_.format,_.flipY,X)};_.name&&(q.name=_.name),this._invokeAll(function(te){te.writeTexture&&te.writeTexture(_,q)});const Y=W.textures.push(q)-1;return E.textures.set(_,Y),Y}processMaterial(_){const T=this.cache,E=this.json;if(T.materials.has(_))return T.materials.get(_);if(_.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;E.materials||(E.materials=[]);const W={pbrMetallicRoughness:{}};_.isMeshStandardMaterial!==!0&&_.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const X=_.color.toArray().concat([_.opacity]);if(ys(X,[1,1,1,1])||(W.pbrMetallicRoughness.baseColorFactor=X),_.isMeshStandardMaterial?(W.pbrMetallicRoughness.metallicFactor=_.metalness,W.pbrMetallicRoughness.roughnessFactor=_.roughness):(W.pbrMetallicRoughness.metallicFactor=.5,W.pbrMetallicRoughness.roughnessFactor=.5),_.metalnessMap||_.roughnessMap){const Y=this.buildMetalRoughTexture(_.metalnessMap,_.roughnessMap),te={index:this.processTexture(Y),channel:Y.channel};this.applyTextureTransform(te,Y),W.pbrMetallicRoughness.metallicRoughnessTexture=te}if(_.map){const Y={index:this.processTexture(_.map),texCoord:_.map.channel};this.applyTextureTransform(Y,_.map),W.pbrMetallicRoughness.baseColorTexture=Y}if(_.emissive){const Y=_.emissive;if(Math.max(Y.r,Y.g,Y.b)>0&&(W.emissiveFactor=_.emissive.toArray()),_.emissiveMap){const te={index:this.processTexture(_.emissiveMap),texCoord:_.emissiveMap.channel};this.applyTextureTransform(te,_.emissiveMap),W.emissiveTexture=te}}if(_.normalMap){const Y={index:this.processTexture(_.normalMap),texCoord:_.normalMap.channel};_.normalScale&&_.normalScale.x!==1&&(Y.scale=_.normalScale.x),this.applyTextureTransform(Y,_.normalMap),W.normalTexture=Y}if(_.aoMap){const Y={index:this.processTexture(_.aoMap),texCoord:_.aoMap.channel};_.aoMapIntensity!==1&&(Y.strength=_.aoMapIntensity),this.applyTextureTransform(Y,_.aoMap),W.occlusionTexture=Y}_.transparent?W.alphaMode="BLEND":_.alphaTest>0&&(W.alphaMode="MASK",W.alphaCutoff=_.alphaTest),_.side===DoubleSide&&(W.doubleSided=!0),_.name!==""&&(W.name=_.name),this.serializeUserData(_,W),this._invokeAll(function(Y){Y.writeMaterial&&Y.writeMaterial(_,W)});const q=E.materials.push(W)-1;return T.materials.set(_,q),q}processMesh(_){const T=this.cache,E=this.json,W=[_.geometry.uuid];if(Array.isArray(_.material))for(let Ve=0,$e=_.material.length;Ve<$e;Ve++)W.push(_.material[Ve].uuid);else W.push(_.material.uuid);const X=W.join(":");if(T.meshes.has(X))return T.meshes.get(X);const q=_.geometry;let Y;_.isLineSegments?Y=Ce.LINES:_.isLineLoop?Y=Ce.LINE_LOOP:_.isLine?Y=Ce.LINE_STRIP:_.isPoints?Y=Ce.POINTS:Y=_.material.wireframe?Ce.LINES:Ce.TRIANGLES;const te={},ne={},ae=[],le=[],ue={...Pa>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},ge=q.getAttribute("normal");ge!==void 0&&!this.isNormalizedNormalAttribute(ge)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),q.setAttribute("normal",this.createNormalizedNormalAttribute(ge)));let ye=null;for(let Ve in q.attributes){if(Ve.slice(0,5)==="morph")continue;const $e=q.attributes[Ve];if(Ve=ue[Ve]||Ve.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(Ve)||(Ve="_"+Ve),T.attributes.has(this.getUID($e))){ne[Ve]=T.attributes.get(this.getUID($e));continue}ye=null;const We=$e.array;Ve==="JOINTS_0"&&!(We instanceof Uint16Array)&&!(We instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),ye=new BufferAttribute(new Uint16Array(We),$e.itemSize,$e.normalized));const Ue=this.processAccessor(ye||$e,q);Ue!==null&&(Ve.startsWith("_")||this.detectMeshQuantization(Ve,$e),ne[Ve]=Ue,T.attributes.set(this.getUID($e),Ue))}if(ge!==void 0&&q.setAttribute("normal",ge),Object.keys(ne).length===0)return null;if(_.morphTargetInfluences!==void 0&&_.morphTargetInfluences.length>0){const Ve=[],$e=[],We={};if(_.morphTargetDictionary!==void 0)for(const Ue in _.morphTargetDictionary)We[_.morphTargetDictionary[Ue]]=Ue;for(let Ue=0;Ue<_.morphTargetInfluences.length;++Ue){const je={};let ze=!1;for(const He in q.morphAttributes){if(He!=="position"&&He!=="normal"){ze||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),ze=!0);continue}const Le=q.morphAttributes[He][Ue],qe=He.toUpperCase(),Qe=q.attributes[He];if(T.attributes.has(this.getUID(Le,!0))){je[qe]=T.attributes.get(this.getUID(Le,!0));continue}const Ke=Le.clone();if(!q.morphTargetsRelative)for(let Je=0,pt=Le.count;Je<pt;Je++)for(let ut=0;ut<Le.itemSize;ut++)ut===0&&Ke.setX(Je,Le.getX(Je)-Qe.getX(Je)),ut===1&&Ke.setY(Je,Le.getY(Je)-Qe.getY(Je)),ut===2&&Ke.setZ(Je,Le.getZ(Je)-Qe.getZ(Je)),ut===3&&Ke.setW(Je,Le.getW(Je)-Qe.getW(Je));je[qe]=this.processAccessor(Ke,q),T.attributes.set(this.getUID(Qe,!0),je[qe])}le.push(je),Ve.push(_.morphTargetInfluences[Ue]),_.morphTargetDictionary!==void 0&&$e.push(We[Ue])}te.weights=Ve,$e.length>0&&(te.extras={},te.extras.targetNames=$e)}const xe=Array.isArray(_.material);if(xe&&q.groups.length===0)return null;const Te=xe?_.material:[_.material],Ae=xe?q.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let Ve=0,$e=Ae.length;Ve<$e;Ve++){const We={mode:Y,attributes:ne};if(this.serializeUserData(q,We),le.length>0&&(We.targets=le),q.index!==null){let je=this.getUID(q.index);(Ae[Ve].start!==void 0||Ae[Ve].count!==void 0)&&(je+=":"+Ae[Ve].start+":"+Ae[Ve].count),T.attributes.has(je)?We.indices=T.attributes.get(je):(We.indices=this.processAccessor(q.index,q,Ae[Ve].start,Ae[Ve].count),T.attributes.set(je,We.indices)),We.indices===null&&delete We.indices}const Ue=this.processMaterial(Te[Ae[Ve].materialIndex]);Ue!==null&&(We.material=Ue),ae.push(We)}te.primitives=ae,E.meshes||(E.meshes=[]),this._invokeAll(function(Ve){Ve.writeMesh&&Ve.writeMesh(_,te)});const Ie=E.meshes.push(te)-1;return T.meshes.set(X,Ie),Ie}detectMeshQuantization(_,T){if(this.extensionsUsed[Ei])return;let E;switch(T.array.constructor){case Int8Array:E="byte";break;case Uint8Array:E="unsigned byte";break;case Int16Array:E="short";break;case Uint16Array:E="unsigned short";break;default:return}T.normalized&&(E+=" normalized");const W=_.split("_",1)[0];Yr[W]&&Yr[W].includes(E)&&(this.extensionsUsed[Ei]=!0,this.extensionsRequired[Ei]=!0)}processCamera(_){const T=this.json;T.cameras||(T.cameras=[]);const E=_.isOrthographicCamera,W={type:E?"orthographic":"perspective"};return E?W.orthographic={xmag:_.right*2,ymag:_.top*2,zfar:_.far<=0?.001:_.far,znear:_.near<0?0:_.near}:W.perspective={aspectRatio:_.aspect,yfov:MathUtils.degToRad(_.fov),zfar:_.far<=0?.001:_.far,znear:_.near<0?0:_.near},_.name!==""&&(W.name=_.type),T.cameras.push(W)-1}processAnimation(_,T){const E=this.json,W=this.nodeMap;E.animations||(E.animations=[]),_=Mr.Utils.mergeMorphTargetTracks(_.clone(),T);const X=_.tracks,q=[],Y=[];for(let te=0;te<X.length;++te){const ne=X[te],ae=PropertyBinding.parseTrackName(ne.name);let le=PropertyBinding.findNode(T,ae.nodeName);const ue=Wr[ae.propertyName];if(ae.objectName==="bones"&&(le.isSkinnedMesh===!0?le=le.skeleton.getBoneByName(ae.objectIndex):le=void 0),!le||!ue)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',ne.name),null;const ge=1;let ye=ne.values.length/ne.times.length;ue===Wr.morphTargetInfluences&&(ye/=le.morphTargetInfluences.length);let xe;ne.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(xe="CUBICSPLINE",ye/=3):ne.getInterpolation()===InterpolateDiscrete?xe="STEP":xe="LINEAR",Y.push({input:this.processAccessor(new BufferAttribute(ne.times,ge)),output:this.processAccessor(new BufferAttribute(ne.values,ye)),interpolation:xe}),q.push({sampler:Y.length-1,target:{node:W.get(le),path:ue}})}return E.animations.push({name:_.name||"clip_"+E.animations.length,samplers:Y,channels:q}),E.animations.length-1}processSkin(_){const T=this.json,E=this.nodeMap,W=T.nodes[E.get(_)],X=_.skeleton;if(X===void 0)return null;const q=_.skeleton.bones[0];if(q===void 0)return null;const Y=[],te=new Float32Array(X.bones.length*16),ne=new Matrix4;for(let ae=0;ae<X.bones.length;++ae)Y.push(E.get(X.bones[ae])),ne.copy(X.boneInverses[ae]),ne.multiply(_.bindMatrix).toArray(te,ae*16);return T.skins===void 0&&(T.skins=[]),T.skins.push({inverseBindMatrices:this.processAccessor(new BufferAttribute(te,16)),joints:Y,skeleton:E.get(q)}),W.skin=T.skins.length-1}processNode(_){const T=this.json,E=this.options,W=this.nodeMap;T.nodes||(T.nodes=[]);const X={};if(E.trs){const Y=_.quaternion.toArray(),te=_.position.toArray(),ne=_.scale.toArray();ys(Y,[0,0,0,1])||(X.rotation=Y),ys(te,[0,0,0])||(X.translation=te),ys(ne,[1,1,1])||(X.scale=ne)}else _.matrixAutoUpdate&&_.updateMatrix(),Cc(_.matrix)===!1&&(X.matrix=_.matrix.elements);if(_.name!==""&&(X.name=String(_.name)),this.serializeUserData(_,X),_.isMesh||_.isLine||_.isPoints){const Y=this.processMesh(_);Y!==null&&(X.mesh=Y)}else _.isCamera&&(X.camera=this.processCamera(_));if(_.isSkinnedMesh&&this.skins.push(_),_.children.length>0){const Y=[];for(let te=0,ne=_.children.length;te<ne;te++){const ae=_.children[te];if(ae.visible||E.onlyVisible===!1){const le=this.processNode(ae);le!==null&&Y.push(le)}}Y.length>0&&(X.children=Y)}this._invokeAll(function(Y){Y.writeNode&&Y.writeNode(_,X)});const q=T.nodes.push(X)-1;return W.set(_,q),q}processScene(_){const T=this.json,E=this.options;T.scenes||(T.scenes=[],T.scene=0);const W={};_.name!==""&&(W.name=_.name),T.scenes.push(W);const X=[];for(let q=0,Y=_.children.length;q<Y;q++){const te=_.children[q];if(te.visible||E.onlyVisible===!1){const ne=this.processNode(te);ne!==null&&X.push(ne)}}X.length>0&&(W.nodes=X),this.serializeUserData(_,W)}processObjects(_){const T=new Scene;T.name="AuxScene";for(let E=0;E<_.length;E++)T.children.push(_[E]);this.processScene(T)}processInput(_){const T=this.options;_=_ instanceof Array?_:[_],this._invokeAll(function(W){W.beforeParse&&W.beforeParse(_)});const E=[];for(let W=0;W<_.length;W++)_[W]instanceof Scene?this.processScene(_[W]):E.push(_[W]);E.length>0&&this.processObjects(E);for(let W=0;W<this.skins.length;++W)this.processSkin(this.skins[W]);for(let W=0;W<T.animations.length;++W)this.processAnimation(T.animations[W],_[0]);this._invokeAll(function(W){W.afterParse&&W.afterParse(_)})}_invokeAll(_){for(let T=0,E=this.plugins.length;T<E;T++)_(this.plugins[T])}}class Dc{constructor(_){this.writer=_,this.name="KHR_lights_punctual"}writeNode(_,T){if(!_.isLight)return;if(!_.isDirectionalLight&&!_.isPointLight&&!_.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",_);return}const E=this.writer,W=E.json,X=E.extensionsUsed,q={};_.name&&(q.name=_.name),q.color=_.color.toArray(),q.intensity=_.intensity,_.isDirectionalLight?q.type="directional":_.isPointLight?(q.type="point",_.distance>0&&(q.range=_.distance)):_.isSpotLight&&(q.type="spot",_.distance>0&&(q.range=_.distance),q.spot={},q.spot.innerConeAngle=(_.penumbra-1)*_.angle*-1,q.spot.outerConeAngle=_.angle),_.decay!==void 0&&_.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),_.target&&(_.target.parent!==_||_.target.position.x!==0||_.target.position.y!==0||_.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),X[this.name]||(W.extensions=W.extensions||{},W.extensions[this.name]={lights:[]},X[this.name]=!0);const Y=W.extensions[this.name].lights;Y.push(q),T.extensions=T.extensions||{},T.extensions[this.name]={light:Y.length-1}}}let Oc=class{constructor(B){this.writer=B,this.name="KHR_materials_unlit"}writeMaterial(B,_){if(!B.isMeshBasicMaterial)return;const T=this.writer.extensionsUsed;_.extensions=_.extensions||{},_.extensions[this.name]={},T[this.name]=!0,_.pbrMetallicRoughness.metallicFactor=0,_.pbrMetallicRoughness.roughnessFactor=.9}},Lc=class{constructor(B){this.writer=B,this.name="KHR_materials_clearcoat"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.clearcoat===0)return;const T=this.writer,E=T.extensionsUsed,W={};if(W.clearcoatFactor=B.clearcoat,B.clearcoatMap){const X={index:T.processTexture(B.clearcoatMap),texCoord:B.clearcoatMap.channel};T.applyTextureTransform(X,B.clearcoatMap),W.clearcoatTexture=X}if(W.clearcoatRoughnessFactor=B.clearcoatRoughness,B.clearcoatRoughnessMap){const X={index:T.processTexture(B.clearcoatRoughnessMap),texCoord:B.clearcoatRoughnessMap.channel};T.applyTextureTransform(X,B.clearcoatRoughnessMap),W.clearcoatRoughnessTexture=X}if(B.clearcoatNormalMap){const X={index:T.processTexture(B.clearcoatNormalMap),texCoord:B.clearcoatNormalMap.channel};T.applyTextureTransform(X,B.clearcoatNormalMap),W.clearcoatNormalTexture=X}_.extensions=_.extensions||{},_.extensions[this.name]=W,E[this.name]=!0}},Fc=class{constructor(B){this.writer=B,this.name="KHR_materials_iridescence"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.iridescence===0)return;const T=this.writer,E=T.extensionsUsed,W={};if(W.iridescenceFactor=B.iridescence,B.iridescenceMap){const X={index:T.processTexture(B.iridescenceMap),texCoord:B.iridescenceMap.channel};T.applyTextureTransform(X,B.iridescenceMap),W.iridescenceTexture=X}if(W.iridescenceIor=B.iridescenceIOR,W.iridescenceThicknessMinimum=B.iridescenceThicknessRange[0],W.iridescenceThicknessMaximum=B.iridescenceThicknessRange[1],B.iridescenceThicknessMap){const X={index:T.processTexture(B.iridescenceThicknessMap),texCoord:B.iridescenceThicknessMap.channel};T.applyTextureTransform(X,B.iridescenceThicknessMap),W.iridescenceThicknessTexture=X}_.extensions=_.extensions||{},_.extensions[this.name]=W,E[this.name]=!0}},kc=class{constructor(B){this.writer=B,this.name="KHR_materials_transmission"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.transmission===0)return;const T=this.writer,E=T.extensionsUsed,W={};if(W.transmissionFactor=B.transmission,B.transmissionMap){const X={index:T.processTexture(B.transmissionMap),texCoord:B.transmissionMap.channel};T.applyTextureTransform(X,B.transmissionMap),W.transmissionTexture=X}_.extensions=_.extensions||{},_.extensions[this.name]=W,E[this.name]=!0}},Bc=class{constructor(B){this.writer=B,this.name="KHR_materials_volume"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.transmission===0)return;const T=this.writer,E=T.extensionsUsed,W={};if(W.thicknessFactor=B.thickness,B.thicknessMap){const X={index:T.processTexture(B.thicknessMap),texCoord:B.thicknessMap.channel};T.applyTextureTransform(X,B.thicknessMap),W.thicknessTexture=X}W.attenuationDistance=B.attenuationDistance,W.attenuationColor=B.attenuationColor.toArray(),_.extensions=_.extensions||{},_.extensions[this.name]=W,E[this.name]=!0}},Uc=class{constructor(B){this.writer=B,this.name="KHR_materials_ior"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.ior===1.5)return;const T=this.writer.extensionsUsed,E={};E.ior=B.ior,_.extensions=_.extensions||{},_.extensions[this.name]=E,T[this.name]=!0}},Nc=class{constructor(B){this.writer=B,this.name="KHR_materials_specular"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.specularIntensity===1&&B.specularColor.equals(bc)&&!B.specularIntensityMap&&!B.specularColorTexture)return;const T=this.writer,E=T.extensionsUsed,W={};if(B.specularIntensityMap){const X={index:T.processTexture(B.specularIntensityMap),texCoord:B.specularIntensityMap.channel};T.applyTextureTransform(X,B.specularIntensityMap),W.specularTexture=X}if(B.specularColorMap){const X={index:T.processTexture(B.specularColorMap),texCoord:B.specularColorMap.channel};T.applyTextureTransform(X,B.specularColorMap),W.specularColorTexture=X}W.specularFactor=B.specularIntensity,W.specularColorFactor=B.specularColor.toArray(),_.extensions=_.extensions||{},_.extensions[this.name]=W,E[this.name]=!0}},zc=class{constructor(B){this.writer=B,this.name="KHR_materials_sheen"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.sheen==0)return;const T=this.writer,E=T.extensionsUsed,W={};if(B.sheenRoughnessMap){const X={index:T.processTexture(B.sheenRoughnessMap),texCoord:B.sheenRoughnessMap.channel};T.applyTextureTransform(X,B.sheenRoughnessMap),W.sheenRoughnessTexture=X}if(B.sheenColorMap){const X={index:T.processTexture(B.sheenColorMap),texCoord:B.sheenColorMap.channel};T.applyTextureTransform(X,B.sheenColorMap),W.sheenColorTexture=X}W.sheenRoughnessFactor=B.sheenRoughness,W.sheenColorFactor=B.sheenColor.toArray(),_.extensions=_.extensions||{},_.extensions[this.name]=W,E[this.name]=!0}},Hc=class{constructor(B){this.writer=B,this.name="KHR_materials_anisotropy"}writeMaterial(B,_){if(!B.isMeshPhysicalMaterial||B.anisotropy==0)return;const T=this.writer,E=T.extensionsUsed,W={};if(B.anisotropyMap){const X={index:T.processTexture(B.anisotropyMap)};T.applyTextureTransform(X,B.anisotropyMap),W.anisotropyTexture=X}W.anisotropyStrength=B.anisotropy,W.anisotropyRotation=B.anisotropyRotation,_.extensions=_.extensions||{},_.extensions[this.name]=W,E[this.name]=!0}},jc=class{constructor(B){this.writer=B,this.name="KHR_materials_emissive_strength"}writeMaterial(B,_){if(!B.isMeshStandardMaterial||B.emissiveIntensity===1)return;const T=this.writer.extensionsUsed,E={};E.emissiveStrength=B.emissiveIntensity,_.extensions=_.extensions||{},_.extensions[this.name]=E,T[this.name]=!0}};var Et=Uint8Array,yn=Uint16Array,ar=Uint32Array,Ia=new Et([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ra=new Et([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Da=function(B,_){for(var T=new yn(31),E=0;E<31;++E)T[E]=_+=1<<B[E-1];for(var W=new ar(T[30]),E=1;E<30;++E)for(var X=T[E];X<T[E+1];++X)W[X]=X-T[E]<<5|E;return[T,W]},Oa=Da(Ia,2),La=Oa[0],Vc=Oa[1];La[28]=258,Vc[258]=28;Da(Ra,0);var lr=new yn(32768);for(var Ge=0;Ge<32768;++Ge){var an=(Ge&43690)>>>1|(Ge&21845)<<1;an=(an&52428)>>>2|(an&13107)<<2,an=(an&61680)>>>4|(an&3855)<<4,lr[Ge]=((an&65280)>>>8|(an&255)<<8)>>>1}var Ps=new Et(288);for(var Ge=0;Ge<144;++Ge)Ps[Ge]=8;for(var Ge=144;Ge<256;++Ge)Ps[Ge]=9;for(var Ge=256;Ge<280;++Ge)Ps[Ge]=7;for(var Ge=280;Ge<288;++Ge)Ps[Ge]=8;var Fa=new Et(32);for(var Ge=0;Ge<32;++Ge)Fa[Ge]=5;var Qc=new Et(0),tu=typeof TextDecoder<"u"&&new TextDecoder,nu=0;try{tu.decode(Qc,{stream:!0}),nu=1}catch{}new Triangle;new Vector3;new Euler(0,0,0,"YXZ");new Vector3;var pu=Object.defineProperty,mu=(B,_,T)=>_ in B?pu(B,_,{enumerable:!0,configurable:!0,writable:!0,value:T}):B[_]=T,we=(B,_,T)=>(mu(B,typeof _!="symbol"?_+"":_,T),T);const Gs=new Ray,Qr=new Plane,gu=Math.cos(70*(Math.PI/180)),Jr=(B,_)=>(B%_+_)%_;class ka extends EventDispatcher{constructor(_,T){super(),we(this,"object"),we(this,"domElement"),we(this,"enabled",!0),we(this,"target",new Vector3),we(this,"minDistance",0),we(this,"maxDistance",1/0),we(this,"minZoom",0),we(this,"maxZoom",1/0),we(this,"minPolarAngle",0),we(this,"maxPolarAngle",Math.PI),we(this,"minAzimuthAngle",-1/0),we(this,"maxAzimuthAngle",1/0),we(this,"enableDamping",!1),we(this,"dampingFactor",.05),we(this,"enableZoom",!0),we(this,"zoomSpeed",1),we(this,"enableRotate",!0),we(this,"rotateSpeed",1),we(this,"enablePan",!0),we(this,"panSpeed",1),we(this,"screenSpacePanning",!0),we(this,"keyPanSpeed",7),we(this,"zoomToCursor",!1),we(this,"autoRotate",!1),we(this,"autoRotateSpeed",2),we(this,"reverseOrbit",!1),we(this,"reverseHorizontalOrbit",!1),we(this,"reverseVerticalOrbit",!1),we(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),we(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),we(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),we(this,"target0"),we(this,"position0"),we(this,"zoom0"),we(this,"_domElementKeyEvents",null),we(this,"getPolarAngle"),we(this,"getAzimuthalAngle"),we(this,"setPolarAngle"),we(this,"setAzimuthalAngle"),we(this,"getDistance"),we(this,"listenToKeyEvents"),we(this,"stopListenToKeyEvents"),we(this,"saveState"),we(this,"reset"),we(this,"update"),we(this,"connect"),we(this,"dispose"),this.object=_,this.domElement=T,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>ae.phi,this.getAzimuthalAngle=()=>ae.theta,this.setPolarAngle=Hr=>{let vi=Jr(Hr,2*Math.PI),Lr=ae.phi;Lr<0&&(Lr+=2*Math.PI),vi<0&&(vi+=2*Math.PI);let _i=Math.abs(vi-Lr);2*Math.PI-_i<_i&&(vi<Lr?vi+=2*Math.PI:Lr+=2*Math.PI),le.phi=vi-Lr,E.update()},this.setAzimuthalAngle=Hr=>{let vi=Jr(Hr,2*Math.PI),Lr=ae.theta;Lr<0&&(Lr+=2*Math.PI),vi<0&&(vi+=2*Math.PI);let _i=Math.abs(vi-Lr);2*Math.PI-_i<_i&&(vi<Lr?vi+=2*Math.PI:Lr+=2*Math.PI),le.theta=vi-Lr,E.update()},this.getDistance=()=>E.object.position.distanceTo(E.target),this.listenToKeyEvents=Hr=>{Hr.addEventListener("keydown",Wi),this._domElementKeyEvents=Hr},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Wi),this._domElementKeyEvents=null},this.saveState=()=>{E.target0.copy(E.target),E.position0.copy(E.object.position),E.zoom0=E.object.zoom},this.reset=()=>{E.target.copy(E.target0),E.object.position.copy(E.position0),E.object.zoom=E.zoom0,E.object.updateProjectionMatrix(),E.dispatchEvent(W),E.update(),te=Y.NONE},this.update=(()=>{const Hr=new Vector3,vi=new Vector3(0,1,0),Lr=new Quaternion().setFromUnitVectors(_.up,vi),_i=Lr.clone().invert(),xi=new Vector3,Ni=new Quaternion,Ui=2*Math.PI;return function(){const Vn=E.object.position;Lr.setFromUnitVectors(_.up,vi),_i.copy(Lr).invert(),Hr.copy(Vn).sub(E.target),Hr.applyQuaternion(Lr),ae.setFromVector3(Hr),E.autoRotate&&te===Y.NONE&&Je(Qe()),E.enableDamping?(ae.theta+=le.theta*E.dampingFactor,ae.phi+=le.phi*E.dampingFactor):(ae.theta+=le.theta,ae.phi+=le.phi);let Dn=E.minAzimuthAngle,Wn=E.maxAzimuthAngle;isFinite(Dn)&&isFinite(Wn)&&(Dn<-Math.PI?Dn+=Ui:Dn>Math.PI&&(Dn-=Ui),Wn<-Math.PI?Wn+=Ui:Wn>Math.PI&&(Wn-=Ui),Dn<=Wn?ae.theta=Math.max(Dn,Math.min(Wn,ae.theta)):ae.theta=ae.theta>(Dn+Wn)/2?Math.max(Dn,ae.theta):Math.min(Wn,ae.theta)),ae.phi=Math.max(E.minPolarAngle,Math.min(E.maxPolarAngle,ae.phi)),ae.makeSafe(),E.enableDamping===!0?E.target.addScaledVector(ge,E.dampingFactor):E.target.add(ge),E.zoomToCursor&&He||E.object.isOrthographicCamera?ae.radius=di(ae.radius):ae.radius=di(ae.radius*ue),Hr.setFromSpherical(ae),Hr.applyQuaternion(_i),Vn.copy(E.target).add(Hr),E.object.matrixAutoUpdate||E.object.updateMatrix(),E.object.lookAt(E.target),E.enableDamping===!0?(le.theta*=1-E.dampingFactor,le.phi*=1-E.dampingFactor,ge.multiplyScalar(1-E.dampingFactor)):(le.set(0,0,0),ge.set(0,0,0));let es=!1;if(E.zoomToCursor&&He){let Bn=null;if(E.object instanceof PerspectiveCamera&&E.object.isPerspectiveCamera){const ps=Hr.length();Bn=di(ps*ue);const ns=ps-Bn;E.object.position.addScaledVector(je,ns),E.object.updateMatrixWorld()}else if(E.object.isOrthographicCamera){const ps=new Vector3(ze.x,ze.y,0);ps.unproject(E.object),E.object.zoom=Math.max(E.minZoom,Math.min(E.maxZoom,E.object.zoom/ue)),E.object.updateProjectionMatrix(),es=!0;const ns=new Vector3(ze.x,ze.y,0);ns.unproject(E.object),E.object.position.sub(ns).add(ps),E.object.updateMatrixWorld(),Bn=Hr.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),E.zoomToCursor=!1;Bn!==null&&(E.screenSpacePanning?E.target.set(0,0,-1).transformDirection(E.object.matrix).multiplyScalar(Bn).add(E.object.position):(Gs.origin.copy(E.object.position),Gs.direction.set(0,0,-1).transformDirection(E.object.matrix),Math.abs(E.object.up.dot(Gs.direction))<gu?_.lookAt(E.target):(Qr.setFromNormalAndCoplanarPoint(E.object.up,E.target),Gs.intersectPlane(Qr,E.target))))}else E.object instanceof OrthographicCamera&&E.object.isOrthographicCamera&&(es=ue!==1,es&&(E.object.zoom=Math.max(E.minZoom,Math.min(E.maxZoom,E.object.zoom/ue)),E.object.updateProjectionMatrix()));return ue=1,He=!1,es||xi.distanceToSquared(E.object.position)>ne||8*(1-Ni.dot(E.object.quaternion))>ne?(E.dispatchEvent(W),xi.copy(E.object.position),Ni.copy(E.object.quaternion),es=!1,!0):!1}})(),this.connect=Hr=>{Hr===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),E.domElement=Hr,E.domElement.style.touchAction="none",E.domElement.addEventListener("contextmenu",mn),E.domElement.addEventListener("pointerdown",Ir),E.domElement.addEventListener("pointercancel",si),E.domElement.addEventListener("wheel",Ci,{passive:!0})},this.dispose=()=>{var Hr,vi,Lr,_i,xi,Ni;E.domElement&&(E.domElement.style.touchAction="auto"),(Hr=E.domElement)==null||Hr.removeEventListener("contextmenu",mn),(vi=E.domElement)==null||vi.removeEventListener("pointerdown",Ir),(Lr=E.domElement)==null||Lr.removeEventListener("pointercancel",si),(_i=E.domElement)==null||_i.removeEventListener("wheel",Ci),(xi=E.domElement)==null||xi.ownerDocument.removeEventListener("pointermove",Dr),(Ni=E.domElement)==null||Ni.ownerDocument.removeEventListener("pointerup",ti),E._domElementKeyEvents!==null&&E._domElementKeyEvents.removeEventListener("keydown",Wi)};const E=this,W={type:"change"},X={type:"start"},q={type:"end"},Y={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let te=Y.NONE;const ne=1e-6,ae=new Spherical,le=new Spherical;let ue=1;const ge=new Vector3,ye=new Vector2,xe=new Vector2,Te=new Vector2,Ae=new Vector2,Ie=new Vector2,Ve=new Vector2,$e=new Vector2,We=new Vector2,Ue=new Vector2,je=new Vector3,ze=new Vector2;let He=!1;const Le=[],qe={};function Qe(){return 2*Math.PI/60/60*E.autoRotateSpeed}function Ke(){return Math.pow(.95,E.zoomSpeed)}function Je(Hr){E.reverseOrbit||E.reverseHorizontalOrbit?le.theta+=Hr:le.theta-=Hr}function pt(Hr){E.reverseOrbit||E.reverseVerticalOrbit?le.phi+=Hr:le.phi-=Hr}const ut=(()=>{const Hr=new Vector3;return function(vi,Lr){Hr.setFromMatrixColumn(Lr,0),Hr.multiplyScalar(-vi),ge.add(Hr)}})(),lt=(()=>{const Hr=new Vector3;return function(vi,Lr){E.screenSpacePanning===!0?Hr.setFromMatrixColumn(Lr,1):(Hr.setFromMatrixColumn(Lr,0),Hr.crossVectors(E.object.up,Hr)),Hr.multiplyScalar(vi),ge.add(Hr)}})(),st=(()=>{const Hr=new Vector3;return function(vi,Lr){const _i=E.domElement;if(_i&&E.object instanceof PerspectiveCamera&&E.object.isPerspectiveCamera){const xi=E.object.position;Hr.copy(xi).sub(E.target);let Ni=Hr.length();Ni*=Math.tan(E.object.fov/2*Math.PI/180),ut(2*vi*Ni/_i.clientHeight,E.object.matrix),lt(2*Lr*Ni/_i.clientHeight,E.object.matrix)}else _i&&E.object instanceof OrthographicCamera&&E.object.isOrthographicCamera?(ut(vi*(E.object.right-E.object.left)/E.object.zoom/_i.clientWidth,E.object.matrix),lt(Lr*(E.object.top-E.object.bottom)/E.object.zoom/_i.clientHeight,E.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),E.enablePan=!1)}})();function sr(Hr){E.object instanceof PerspectiveCamera&&E.object.isPerspectiveCamera||E.object instanceof OrthographicCamera&&E.object.isOrthographicCamera?ue/=Hr:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),E.enableZoom=!1)}function mt(Hr){E.object instanceof PerspectiveCamera&&E.object.isPerspectiveCamera||E.object instanceof OrthographicCamera&&E.object.isOrthographicCamera?ue*=Hr:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),E.enableZoom=!1)}function Tr(Hr){if(!E.zoomToCursor||!E.domElement)return;He=!0;const vi=E.domElement.getBoundingClientRect(),Lr=Hr.clientX-vi.left,_i=Hr.clientY-vi.top,xi=vi.width,Ni=vi.height;ze.x=Lr/xi*2-1,ze.y=-(_i/Ni)*2+1,je.set(ze.x,ze.y,1).unproject(E.object).sub(E.object.position).normalize()}function di(Hr){return Math.max(E.minDistance,Math.min(E.maxDistance,Hr))}function Mi(Hr){ye.set(Hr.clientX,Hr.clientY)}function Gr(Hr){Tr(Hr),$e.set(Hr.clientX,Hr.clientY)}function ci(Hr){Ae.set(Hr.clientX,Hr.clientY)}function gi(Hr){xe.set(Hr.clientX,Hr.clientY),Te.subVectors(xe,ye).multiplyScalar(E.rotateSpeed);const vi=E.domElement;vi&&(Je(2*Math.PI*Te.x/vi.clientHeight),pt(2*Math.PI*Te.y/vi.clientHeight)),ye.copy(xe),E.update()}function fi(Hr){We.set(Hr.clientX,Hr.clientY),Ue.subVectors(We,$e),Ue.y>0?sr(Ke()):Ue.y<0&&mt(Ke()),$e.copy(We),E.update()}function ri(Hr){Ie.set(Hr.clientX,Hr.clientY),Ve.subVectors(Ie,Ae).multiplyScalar(E.panSpeed),st(Ve.x,Ve.y),Ae.copy(Ie),E.update()}function ot(Hr){Tr(Hr),Hr.deltaY<0?mt(Ke()):Hr.deltaY>0&&sr(Ke()),E.update()}function rt(Hr){let vi=!1;switch(Hr.code){case E.keys.UP:st(0,E.keyPanSpeed),vi=!0;break;case E.keys.BOTTOM:st(0,-E.keyPanSpeed),vi=!0;break;case E.keys.LEFT:st(E.keyPanSpeed,0),vi=!0;break;case E.keys.RIGHT:st(-E.keyPanSpeed,0),vi=!0;break}vi&&(Hr.preventDefault(),E.update())}function gt(){if(Le.length==1)ye.set(Le[0].pageX,Le[0].pageY);else{const Hr=.5*(Le[0].pageX+Le[1].pageX),vi=.5*(Le[0].pageY+Le[1].pageY);ye.set(Hr,vi)}}function Or(){if(Le.length==1)Ae.set(Le[0].pageX,Le[0].pageY);else{const Hr=.5*(Le[0].pageX+Le[1].pageX),vi=.5*(Le[0].pageY+Le[1].pageY);Ae.set(Hr,vi)}}function et(){const Hr=Le[0].pageX-Le[1].pageX,vi=Le[0].pageY-Le[1].pageY,Lr=Math.sqrt(Hr*Hr+vi*vi);$e.set(0,Lr)}function at(){E.enableZoom&&et(),E.enablePan&&Or()}function Rr(){E.enableZoom&&et(),E.enableRotate&&gt()}function Br(Hr){if(Le.length==1)xe.set(Hr.pageX,Hr.pageY);else{const Lr=An(Hr),_i=.5*(Hr.pageX+Lr.x),xi=.5*(Hr.pageY+Lr.y);xe.set(_i,xi)}Te.subVectors(xe,ye).multiplyScalar(E.rotateSpeed);const vi=E.domElement;vi&&(Je(2*Math.PI*Te.x/vi.clientHeight),pt(2*Math.PI*Te.y/vi.clientHeight)),ye.copy(xe)}function Kr(Hr){if(Le.length==1)Ie.set(Hr.pageX,Hr.pageY);else{const vi=An(Hr),Lr=.5*(Hr.pageX+vi.x),_i=.5*(Hr.pageY+vi.y);Ie.set(Lr,_i)}Ve.subVectors(Ie,Ae).multiplyScalar(E.panSpeed),st(Ve.x,Ve.y),Ae.copy(Ie)}function oi(Hr){const vi=An(Hr),Lr=Hr.pageX-vi.x,_i=Hr.pageY-vi.y,xi=Math.sqrt(Lr*Lr+_i*_i);We.set(0,xi),Ue.set(0,Math.pow(We.y/$e.y,E.zoomSpeed)),sr(Ue.y),$e.copy(We)}function ct(Hr){E.enableZoom&&oi(Hr),E.enablePan&&Kr(Hr)}function nt(Hr){E.enableZoom&&oi(Hr),E.enableRotate&&Br(Hr)}function Ir(Hr){var vi,Lr;E.enabled!==!1&&(Le.length===0&&((vi=E.domElement)==null||vi.ownerDocument.addEventListener("pointermove",Dr),(Lr=E.domElement)==null||Lr.ownerDocument.addEventListener("pointerup",ti)),cn(Hr),Hr.pointerType==="touch"?ki(Hr):Ai(Hr))}function Dr(Hr){E.enabled!==!1&&(Hr.pointerType==="touch"?Li(Hr):Oi(Hr))}function ti(Hr){var vi,Lr,_i;qi(Hr),Le.length===0&&((vi=E.domElement)==null||vi.releasePointerCapture(Hr.pointerId),(Lr=E.domElement)==null||Lr.ownerDocument.removeEventListener("pointermove",Dr),(_i=E.domElement)==null||_i.ownerDocument.removeEventListener("pointerup",ti)),E.dispatchEvent(q),te=Y.NONE}function si(Hr){qi(Hr)}function Ai(Hr){let vi;switch(Hr.button){case 0:vi=E.mouseButtons.LEFT;break;case 1:vi=E.mouseButtons.MIDDLE;break;case 2:vi=E.mouseButtons.RIGHT;break;default:vi=-1}switch(vi){case MOUSE.DOLLY:if(E.enableZoom===!1)return;Gr(Hr),te=Y.DOLLY;break;case MOUSE.ROTATE:if(Hr.ctrlKey||Hr.metaKey||Hr.shiftKey){if(E.enablePan===!1)return;ci(Hr),te=Y.PAN}else{if(E.enableRotate===!1)return;Mi(Hr),te=Y.ROTATE}break;case MOUSE.PAN:if(Hr.ctrlKey||Hr.metaKey||Hr.shiftKey){if(E.enableRotate===!1)return;Mi(Hr),te=Y.ROTATE}else{if(E.enablePan===!1)return;ci(Hr),te=Y.PAN}break;default:te=Y.NONE}te!==Y.NONE&&E.dispatchEvent(X)}function Oi(Hr){if(E.enabled!==!1)switch(te){case Y.ROTATE:if(E.enableRotate===!1)return;gi(Hr);break;case Y.DOLLY:if(E.enableZoom===!1)return;fi(Hr);break;case Y.PAN:if(E.enablePan===!1)return;ri(Hr);break}}function Ci(Hr){E.enabled===!1||E.enableZoom===!1||te!==Y.NONE&&te!==Y.ROTATE||(E.dispatchEvent(X),ot(Hr),E.dispatchEvent(q))}function Wi(Hr){E.enabled===!1||E.enablePan===!1||rt(Hr)}function ki(Hr){switch(wn(Hr),Le.length){case 1:switch(E.touches.ONE){case TOUCH.ROTATE:if(E.enableRotate===!1)return;gt(),te=Y.TOUCH_ROTATE;break;case TOUCH.PAN:if(E.enablePan===!1)return;Or(),te=Y.TOUCH_PAN;break;default:te=Y.NONE}break;case 2:switch(E.touches.TWO){case TOUCH.DOLLY_PAN:if(E.enableZoom===!1&&E.enablePan===!1)return;at(),te=Y.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(E.enableZoom===!1&&E.enableRotate===!1)return;Rr(),te=Y.TOUCH_DOLLY_ROTATE;break;default:te=Y.NONE}break;default:te=Y.NONE}te!==Y.NONE&&E.dispatchEvent(X)}function Li(Hr){switch(wn(Hr),te){case Y.TOUCH_ROTATE:if(E.enableRotate===!1)return;Br(Hr),E.update();break;case Y.TOUCH_PAN:if(E.enablePan===!1)return;Kr(Hr),E.update();break;case Y.TOUCH_DOLLY_PAN:if(E.enableZoom===!1&&E.enablePan===!1)return;ct(Hr),E.update();break;case Y.TOUCH_DOLLY_ROTATE:if(E.enableZoom===!1&&E.enableRotate===!1)return;nt(Hr),E.update();break;default:te=Y.NONE}}function mn(Hr){E.enabled!==!1&&Hr.preventDefault()}function cn(Hr){Le.push(Hr)}function qi(Hr){delete qe[Hr.pointerId];for(let vi=0;vi<Le.length;vi++)if(Le[vi].pointerId==Hr.pointerId){Le.splice(vi,1);return}}function wn(Hr){let vi=qe[Hr.pointerId];vi===void 0&&(vi=new Vector2,qe[Hr.pointerId]=vi),vi.set(Hr.pageX,Hr.pageY)}function An(Hr){const vi=Hr.pointerId===Le[0].pointerId?Le[1]:Le[0];return qe[vi.pointerId]}T!==void 0&&this.connect(T),this.update()}}new Matrix4;new Vector3;new Euler;new Vector3;var _h=Object.defineProperty,xh=(B,_,T)=>_ in B?_h(B,_,{enumerable:!0,configurable:!0,writable:!0,value:T}):B[_]=T,Ar=(B,_,T)=>(xh(B,typeof _!="symbol"?_+"":_,T),T);class Pr{constructor(_){Ar(this,"data"),this.data=_}generateShapes(_,T=100,E){const W=[],X={letterSpacing:0,lineHeight:1,...E},q=Th(_,T,this.data,X);for(let Y=0,te=q.length;Y<te;Y++)Array.prototype.push.apply(W,q[Y].toShapes(!1));return W}}Ar(Pr,"isFont");Ar(Pr,"type");function Th(B,_,T,E){const W=Array.from(B),X=_/T.resolution,q=(T.boundingBox.yMax-T.boundingBox.yMin+T.underlineThickness)*X,Y=[];let te=0,ne=0;for(let ae=0;ae<W.length;ae++){const le=W[ae];if(le===`
`)te=0,ne-=q*E.lineHeight;else{const ue=bh(le,X,te,ne,T);ue&&(te+=ue.offsetX+E.letterSpacing,Y.push(ue.path))}}return Y}function bh(B,_,T,E,W){const X=W.glyphs[B]||W.glyphs["?"];if(!X){console.error('THREE.Font: character "'+B+'" does not exists in font family '+W.familyName+".");return}const q=new ShapePath;let Y,te,ne,ae,le,ue,ge,ye;if(X.o){const xe=X._cachedOutline||(X._cachedOutline=X.o.split(" "));for(let Te=0,Ae=xe.length;Te<Ae;)switch(xe[Te++]){case"m":Y=parseInt(xe[Te++])*_+T,te=parseInt(xe[Te++])*_+E,q.moveTo(Y,te);break;case"l":Y=parseInt(xe[Te++])*_+T,te=parseInt(xe[Te++])*_+E,q.lineTo(Y,te);break;case"q":ne=parseInt(xe[Te++])*_+T,ae=parseInt(xe[Te++])*_+E,le=parseInt(xe[Te++])*_+T,ue=parseInt(xe[Te++])*_+E,q.quadraticCurveTo(le,ue,ne,ae);break;case"b":ne=parseInt(xe[Te++])*_+T,ae=parseInt(xe[Te++])*_+E,le=parseInt(xe[Te++])*_+T,ue=parseInt(xe[Te++])*_+E,ge=parseInt(xe[Te++])*_+T,ye=parseInt(xe[Te++])*_+E,q.bezierCurveTo(le,ue,ge,ye,ne,ae);break}}return{offsetX:X.ha*_,path:q}}class Ts extends Mesh{constructor(_,T={}){super(_),this.isReflector=!0,this.type="Reflector",this.camera=new PerspectiveCamera;const E=this,W=T.color!==void 0?new Color(T.color):new Color(8355711),X=T.textureWidth||512,q=T.textureHeight||512,Y=T.clipBias||0,te=T.shader||Ts.ReflectorShader,ne=T.multisample!==void 0?T.multisample:4,ae=new Plane,le=new Vector3,ue=new Vector3,ge=new Vector3,ye=new Matrix4,xe=new Vector3(0,0,-1),Te=new Vector4,Ae=new Vector3,Ie=new Vector3,Ve=new Vector4,$e=new Matrix4,We=this.camera,Ue=new WebGLRenderTarget(X,q,{samples:ne,type:HalfFloatType}),je=new ShaderMaterial({name:te.name!==void 0?te.name:"unspecified",uniforms:UniformsUtils.clone(te.uniforms),fragmentShader:te.fragmentShader,vertexShader:te.vertexShader});je.uniforms.tDiffuse.value=Ue.texture,je.uniforms.color.value=W,je.uniforms.textureMatrix.value=$e,this.material=je,this.onBeforeRender=function(ze,He,Le){if(ue.setFromMatrixPosition(E.matrixWorld),ge.setFromMatrixPosition(Le.matrixWorld),ye.extractRotation(E.matrixWorld),le.set(0,0,1),le.applyMatrix4(ye),Ae.subVectors(ue,ge),Ae.dot(le)>0)return;Ae.reflect(le).negate(),Ae.add(ue),ye.extractRotation(Le.matrixWorld),xe.set(0,0,-1),xe.applyMatrix4(ye),xe.add(ge),Ie.subVectors(ue,xe),Ie.reflect(le).negate(),Ie.add(ue),We.position.copy(Ae),We.up.set(0,1,0),We.up.applyMatrix4(ye),We.up.reflect(le),We.lookAt(Ie),We.far=Le.far,We.updateMatrixWorld(),We.projectionMatrix.copy(Le.projectionMatrix),$e.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),$e.multiply(We.projectionMatrix),$e.multiply(We.matrixWorldInverse),$e.multiply(E.matrixWorld),ae.setFromNormalAndCoplanarPoint(le,ue),ae.applyMatrix4(We.matrixWorldInverse),Te.set(ae.normal.x,ae.normal.y,ae.normal.z,ae.constant);const qe=We.projectionMatrix;Ve.x=(Math.sign(Te.x)+qe.elements[8])/qe.elements[0],Ve.y=(Math.sign(Te.y)+qe.elements[9])/qe.elements[5],Ve.z=-1,Ve.w=(1+qe.elements[10])/qe.elements[14],Te.multiplyScalar(2/Te.dot(Ve)),qe.elements[2]=Te.x,qe.elements[6]=Te.y,qe.elements[10]=Te.z+1-Y,qe.elements[14]=Te.w,E.visible=!1;const Qe=ze.getRenderTarget(),Ke=ze.xr.enabled,Je=ze.shadowMap.autoUpdate;ze.xr.enabled=!1,ze.shadowMap.autoUpdate=!1,ze.setRenderTarget(Ue),ze.state.buffers.depth.setMask(!0),ze.autoClear===!1&&ze.clear(),ze.render(He,We),ze.xr.enabled=Ke,ze.shadowMap.autoUpdate=Je,ze.setRenderTarget(Qe);const pt=Le.viewport;pt!==void 0&&ze.state.viewport(pt),E.visible=!0},this.getRenderTarget=function(){return Ue},this.dispose=function(){Ue.dispose(),E.material.dispose()}}}Ts.ReflectorShader={name:"ReflectorShader",uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};const Ph=["args","material-uniforms-color-value"],Ch=createBaseVNode("TresPlaneGeometry",{args:[5,5]},null,-1);Ts.ReflectorShader;function Cr(B){return getCurrentScope()?(onScopeDispose(B),!0):!1}function vt(B){return typeof B=="function"?B():unref(B)}const Ih=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Rh=Object.prototype.toString,Dh=B=>Rh.call(B)==="[object Object]",kn=()=>{};function _n(B){var _;const T=vt(B);return(_=T==null?void 0:T.$el)!=null?_:T}const en=Ih?window:void 0;function Ye(...B){let _,T,E,W;if(typeof B[0]=="string"||Array.isArray(B[0])?([T,E,W]=B,_=en):[_,T,E,W]=B,!_)return kn;Array.isArray(T)||(T=[T]),Array.isArray(E)||(E=[E]);const X=[],q=()=>{X.forEach(ae=>ae()),X.length=0},Y=(ae,le,ue,ge)=>(ae.addEventListener(le,ue,ge),()=>ae.removeEventListener(le,ue,ge)),te=watch(()=>[_n(_),vt(W)],([ae,le])=>{if(q(),!ae)return;const ue=Dh(le)?{...le}:le;X.push(...T.flatMap(ge=>E.map(ye=>Y(ae,ge,ye,ue))))},{immediate:!0,flush:"post"}),ne=()=>{te(),q()};return Cr(ne),ne}class bs extends Mesh{constructor(){super(bs.Geometry,new MeshBasicMaterial({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const _=new Vector3,T=new Vector3,E=new FramebufferTexture(16,16),W=new FramebufferTexture(16,16);let X=UnsignedByteType;const q=bs.Geometry,Y=new RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),te=new RawShaderMaterial({uniforms:{map:{value:E},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),ne=new Mesh(q,Y),ae=[],le=$a.Shader,ue=new RawShaderMaterial({name:le.name,uniforms:{map:{value:null},occlusionMap:{value:W},color:{value:new Color(16777215)},scale:{value:new Vector2},screenPosition:{value:new Vector3}},vertexShader:le.vertexShader,fragmentShader:le.fragmentShader,blending:AdditiveBlending,transparent:!0,depthWrite:!1}),ge=new Mesh(q,ue);this.addElement=function(Ie){ae.push(Ie)};const ye=new Vector2,xe=new Vector2,Te=new Box2,Ae=new Vector4;this.onBeforeRender=function(Ie,Ve,$e){Ie.getCurrentViewport(Ae);const We=Ie.getRenderTarget(),Ue=We!==null?We.texture.type:UnsignedByteType;X!==Ue&&(E.dispose(),W.dispose(),E.type=W.type=Ue,X=Ue);const je=Ae.w/Ae.z,ze=Ae.z/2,He=Ae.w/2;let Le=16/Ae.w;if(ye.set(Le*je,Le),Te.min.set(Ae.x,Ae.y),Te.max.set(Ae.x+(Ae.z-16),Ae.y+(Ae.w-16)),T.setFromMatrixPosition(this.matrixWorld),T.applyMatrix4($e.matrixWorldInverse),!(T.z>0)&&(_.copy(T).applyMatrix4($e.projectionMatrix),xe.x=Ae.x+_.x*ze+ze-8,xe.y=Ae.y+_.y*He+He-8,Te.containsPoint(xe))){Ie.copyFramebufferToTexture(xe,E);let qe=Y.uniforms;qe.scale.value=ye,qe.screenPosition.value=_,Ie.renderBufferDirect($e,null,q,Y,ne,null),Ie.copyFramebufferToTexture(xe,W),qe=te.uniforms,qe.scale.value=ye,qe.screenPosition.value=_,Ie.renderBufferDirect($e,null,q,te,ne,null);const Qe=-_.x*2,Ke=-_.y*2;for(let Je=0,pt=ae.length;Je<pt;Je++){const ut=ae[Je],lt=ue.uniforms;lt.color.value.copy(ut.color),lt.map.value=ut.texture,lt.screenPosition.value.x=_.x+Qe*ut.distance,lt.screenPosition.value.y=_.y+Ke*ut.distance,Le=ut.size/Ae.w;const st=Ae.w/Ae.z;lt.scale.value.set(Le*st,Le),ue.uniformsNeedUpdate=!0,Ie.renderBufferDirect($e,null,q,ue,ge,null)}}},this.dispose=function(){Y.dispose(),te.dispose(),ue.dispose(),E.dispose(),W.dispose();for(let Ie=0,Ve=ae.length;Ie<Ve;Ie++)ae[Ie].texture.dispose()}}}class $a{constructor(_,T=1,E=0,W=new Color(16777215)){this.texture=_,this.size=T,this.distance=E,this.color=W}}$a.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`};bs.Geometry=function(){const B=new BufferGeometry,_=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),T=new InterleavedBuffer(_,5);return B.setIndex([0,1,2,0,2,3]),B.setAttribute("position",new InterleavedBufferAttribute(T,3,0,!1)),B.setAttribute("uv",new InterleavedBufferAttribute(T,2,3,!1)),B}();MathUtils.clamp;MathUtils.lerp;const Mf=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],xg=defineComponent({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(B,{expose:_,emit:T}){const E=B,W=T,{makeDefault:X,autoRotate:q,autoRotateSpeed:Y,enableDamping:te,dampingFactor:ne,enablePan:ae,keyPanSpeed:le,maxAzimuthAngle:ue,minAzimuthAngle:ge,maxPolarAngle:ye,minPolarAngle:xe,minDistance:Te,maxDistance:Ae,minZoom:Ie,maxZoom:Ve,enableZoom:$e,zoomSpeed:We,enableRotate:Ue,touches:je,rotateSpeed:ze,target:He}=toRefs$1(E),{camera:Le,renderer:qe,extend:Qe,controls:Ke}=dr(),Je=ref$1(null);Qe({OrbitControls:ka}),watch(Je,lt=>{pt(),lt&&X.value?Ke.value=lt:Ke.value=null});function pt(){Ye(Je.value,"change",()=>W("change",Je.value)),Ye(Je.value,"start",()=>W("start",Je.value)),Ye(Je.value,"end",()=>W("end",Je.value))}const{onLoop:ut}=G();return ut(()=>{Je.value&&(te.value||q.value)&&Je.value.update()}),onUnmounted(()=>{Je.value&&Je.value.dispose()}),_({value:Je}),(lt,st)=>(lt.camera||unref(Le))&&(lt.domElement||unref(qe))?(openBlock(),createElementBlock("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:Je,target:unref(He),"auto-rotate":unref(q),"auto-rotate-speed":unref(Y),"enable-damping":unref(te),"damping-factor":unref(ne),"enable-pan":unref(ae),"key-pan-speed":unref(le),keys:lt.keys,"max-azimuth-angle":unref(ue),"min-azimuth-angle":unref(ge),"max-polar-angle":unref(ye),"min-polar-angle":unref(xe),"min-distance":unref(Te),"max-distance":unref(Ae),"min-zoom":unref(Ie),"max-zoom":unref(Ve),touches:unref(je),"enable-zoom":unref($e),"zoom-speed":unref(We),"enable-rotate":unref(Ue),"rotate-speed":unref(ze),args:[lt.camera||unref(Le),lt.domElement||unref(qe).domElement]},null,8,Mf)):createCommentVNode("",!0)}});var Bi;/Mac/.test((Bi=globalThis==null?void 0:globalThis.navigator)===null||Bi===void 0?void 0:Bi.platform);var Yf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qs(B){throw new Error('Could not dynamically require "'+B+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var il={exports:{}};(function(B,_){(function(T){B.exports=T()})(function(){return function T(E,W,X){function q(ne,ae){if(!W[ne]){if(!E[ne]){var le=typeof Qs=="function"&&Qs;if(!ae&&le)return le(ne,!0);if(Y)return Y(ne,!0);throw new Error("Cannot find module '"+ne+"'")}ae=W[ne]={exports:{}},E[ne][0].call(ae.exports,function(ue){var ge=E[ne][1][ue];return q(ge||ue)},ae,ae.exports,T,E,W,X)}return W[ne].exports}for(var Y=typeof Qs=="function"&&Qs,te=0;te<X.length;te++)q(X[te]);return q}({1:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){var ye=T("crypto");function xe(Ue,je){je=Ie(Ue,je);var ze;return(ze=je.algorithm!=="passthrough"?ye.createHash(je.algorithm):new We).write===void 0&&(ze.write=ze.update,ze.end=ze.update),$e(je,ze).dispatch(Ue),ze.update||ze.end(""),ze.digest?ze.digest(je.encoding==="buffer"?void 0:je.encoding):(Ue=ze.read(),je.encoding!=="buffer"?Ue.toString(je.encoding):Ue)}(W=E.exports=xe).sha1=function(Ue){return xe(Ue)},W.keys=function(Ue){return xe(Ue,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},W.MD5=function(Ue){return xe(Ue,{algorithm:"md5",encoding:"hex"})},W.keysMD5=function(Ue){return xe(Ue,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var Te=ye.getHashes?ye.getHashes().slice():["sha1","md5"],Ae=(Te.push("passthrough"),["buffer","hex","binary","base64"]);function Ie(Ue,je){var ze={};if(ze.algorithm=(je=je||{}).algorithm||"sha1",ze.encoding=je.encoding||"hex",ze.excludeValues=!!je.excludeValues,ze.algorithm=ze.algorithm.toLowerCase(),ze.encoding=ze.encoding.toLowerCase(),ze.ignoreUnknown=je.ignoreUnknown===!0,ze.respectType=je.respectType!==!1,ze.respectFunctionNames=je.respectFunctionNames!==!1,ze.respectFunctionProperties=je.respectFunctionProperties!==!1,ze.unorderedArrays=je.unorderedArrays===!0,ze.unorderedSets=je.unorderedSets!==!1,ze.unorderedObjects=je.unorderedObjects!==!1,ze.replacer=je.replacer||void 0,ze.excludeKeys=je.excludeKeys||void 0,Ue===void 0)throw new Error("Object argument required.");for(var He=0;He<Te.length;++He)Te[He].toLowerCase()===ze.algorithm.toLowerCase()&&(ze.algorithm=Te[He]);if(Te.indexOf(ze.algorithm)===-1)throw new Error('Algorithm "'+ze.algorithm+'"  not supported. supported values: '+Te.join(", "));if(Ae.indexOf(ze.encoding)===-1&&ze.algorithm!=="passthrough")throw new Error('Encoding "'+ze.encoding+'"  not supported. supported values: '+Ae.join(", "));return ze}function Ve(Ue){if(typeof Ue=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(Ue))!=null}function $e(Ue,je,ze){ze=ze||[];function He(Le){return je.update?je.update(Le,"utf8"):je.write(Le,"utf8")}return{dispatch:function(Le){return this["_"+((Le=Ue.replacer?Ue.replacer(Le):Le)===null?"null":typeof Le)](Le)},_object:function(Le){var qe,Qe=Object.prototype.toString.call(Le),Ke=/\[object (.*)\]/i.exec(Qe);if(Ke=(Ke=Ke?Ke[1]:"unknown:["+Qe+"]").toLowerCase(),0<=(Qe=ze.indexOf(Le)))return this.dispatch("[CIRCULAR:"+Qe+"]");if(ze.push(Le),Y!==void 0&&Y.isBuffer&&Y.isBuffer(Le))return He("buffer:"),He(Le);if(Ke==="object"||Ke==="function"||Ke==="asyncfunction")return Qe=Object.keys(Le),Ue.unorderedObjects&&(Qe=Qe.sort()),Ue.respectType===!1||Ve(Le)||Qe.splice(0,0,"prototype","__proto__","constructor"),Ue.excludeKeys&&(Qe=Qe.filter(function(Je){return!Ue.excludeKeys(Je)})),He("object:"+Qe.length+":"),qe=this,Qe.forEach(function(Je){qe.dispatch(Je),He(":"),Ue.excludeValues||qe.dispatch(Le[Je]),He(",")});if(!this["_"+Ke]){if(Ue.ignoreUnknown)return He("["+Ke+"]");throw new Error('Unknown object type "'+Ke+'"')}this["_"+Ke](Le)},_array:function(Le,Je){Je=Je!==void 0?Je:Ue.unorderedArrays!==!1;var Qe=this;if(He("array:"+Le.length+":"),!Je||Le.length<=1)return Le.forEach(function(pt){return Qe.dispatch(pt)});var Ke=[],Je=Le.map(function(pt){var ut=new We,lt=ze.slice();return $e(Ue,ut,lt).dispatch(pt),Ke=Ke.concat(lt.slice(ze.length)),ut.read().toString()});return ze=ze.concat(Ke),Je.sort(),this._array(Je,!1)},_date:function(Le){return He("date:"+Le.toJSON())},_symbol:function(Le){return He("symbol:"+Le.toString())},_error:function(Le){return He("error:"+Le.toString())},_boolean:function(Le){return He("bool:"+Le.toString())},_string:function(Le){He("string:"+Le.length+":"),He(Le.toString())},_function:function(Le){He("fn:"),Ve(Le)?this.dispatch("[native]"):this.dispatch(Le.toString()),Ue.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(Le.name)),Ue.respectFunctionProperties&&this._object(Le)},_number:function(Le){return He("number:"+Le.toString())},_xml:function(Le){return He("xml:"+Le.toString())},_null:function(){return He("Null")},_undefined:function(){return He("Undefined")},_regexp:function(Le){return He("regex:"+Le.toString())},_uint8array:function(Le){return He("uint8array:"),this.dispatch(Array.prototype.slice.call(Le))},_uint8clampedarray:function(Le){return He("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(Le))},_int8array:function(Le){return He("int8array:"),this.dispatch(Array.prototype.slice.call(Le))},_uint16array:function(Le){return He("uint16array:"),this.dispatch(Array.prototype.slice.call(Le))},_int16array:function(Le){return He("int16array:"),this.dispatch(Array.prototype.slice.call(Le))},_uint32array:function(Le){return He("uint32array:"),this.dispatch(Array.prototype.slice.call(Le))},_int32array:function(Le){return He("int32array:"),this.dispatch(Array.prototype.slice.call(Le))},_float32array:function(Le){return He("float32array:"),this.dispatch(Array.prototype.slice.call(Le))},_float64array:function(Le){return He("float64array:"),this.dispatch(Array.prototype.slice.call(Le))},_arraybuffer:function(Le){return He("arraybuffer:"),this.dispatch(new Uint8Array(Le))},_url:function(Le){return He("url:"+Le.toString())},_map:function(Le){return He("map:"),Le=Array.from(Le),this._array(Le,Ue.unorderedSets!==!1)},_set:function(Le){return He("set:"),Le=Array.from(Le),this._array(Le,Ue.unorderedSets!==!1)},_file:function(Le){return He("file:"),this.dispatch([Le.name,Le.size,Le.type,Le.lastModfied])},_blob:function(){if(Ue.ignoreUnknown)return He("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return He("domwindow")},_bigint:function(Le){return He("bigint:"+Le.toString())},_process:function(){return He("process")},_timer:function(){return He("timer")},_pipe:function(){return He("pipe")},_tcp:function(){return He("tcp")},_udp:function(){return He("udp")},_tty:function(){return He("tty")},_statwatcher:function(){return He("statwatcher")},_securecontext:function(){return He("securecontext")},_connection:function(){return He("connection")},_zlib:function(){return He("zlib")},_context:function(){return He("context")},_nodescript:function(){return He("nodescript")},_httpparser:function(){return He("httpparser")},_dataview:function(){return He("dataview")},_signal:function(){return He("signal")},_fsevent:function(){return He("fsevent")},_tlswrap:function(){return He("tlswrap")}}}function We(){return{buf:"",write:function(Ue){this.buf+=Ue},end:function(Ue){this.buf+=Ue},read:function(){return this.buf}}}W.writeToStream=function(Ue,je,ze){return ze===void 0&&(ze=je,je={}),$e(je=Ie(Ue,je),ze).dispatch(Ue)}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){(function(ye){var xe=typeof Uint8Array<"u"?Uint8Array:Array,Te=43,Ae=47,Ie=48,Ve=97,$e=65,We=45,Ue=95;function je(ze){return ze=ze.charCodeAt(0),ze===Te||ze===We?62:ze===Ae||ze===Ue?63:ze<Ie?-1:ze<Ie+10?ze-Ie+26+26:ze<$e+26?ze-$e:ze<Ve+26?ze-Ve+26:void 0}ye.toByteArray=function(ze){var He,Le;if(0<ze.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var qe=ze.length,qe=ze.charAt(qe-2)==="="?2:ze.charAt(qe-1)==="="?1:0,Qe=new xe(3*ze.length/4-qe),Ke=0<qe?ze.length-4:ze.length,Je=0;function pt(ut){Qe[Je++]=ut}for(He=0;He<Ke;He+=4,0)pt((16711680&(Le=je(ze.charAt(He))<<18|je(ze.charAt(He+1))<<12|je(ze.charAt(He+2))<<6|je(ze.charAt(He+3))))>>16),pt((65280&Le)>>8),pt(255&Le);return qe==2?pt(255&(Le=je(ze.charAt(He))<<2|je(ze.charAt(He+1))>>4)):qe==1&&(pt((Le=je(ze.charAt(He))<<10|je(ze.charAt(He+1))<<4|je(ze.charAt(He+2))>>2)>>8&255),pt(255&Le)),Qe},ye.fromByteArray=function(ze){var He,Le,qe,Qe,Ke=ze.length%3,Je="";function pt(ut){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(ut)}for(He=0,qe=ze.length-Ke;He<qe;He+=3)Le=(ze[He]<<16)+(ze[He+1]<<8)+ze[He+2],Je+=pt((Qe=Le)>>18&63)+pt(Qe>>12&63)+pt(Qe>>6&63)+pt(63&Qe);switch(Ke){case 1:Je=(Je+=pt((Le=ze[ze.length-1])>>2))+pt(Le<<4&63)+"==";break;case 2:Je=(Je=(Je+=pt((Le=(ze[ze.length-2]<<8)+ze[ze.length-1])>>10))+pt(Le>>4&63))+pt(Le<<2&63)+"="}return Je}})(W===void 0?this.base64js={}:W)}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(T,E,W){(function(X,q,Te,te,ne,ae,le,ue,ge){var ye=T("base64-js"),xe=T("ieee754");function Te(ot,rt,gt){if(!(this instanceof Te))return new Te(ot,rt,gt);var Or,et,at,Rr,Br=typeof ot;if(rt==="base64"&&Br=="string")for(ot=(Rr=ot).trim?Rr.trim():Rr.replace(/^\s+|\s+$/g,"");ot.length%4!=0;)ot+="=";if(Br=="number")Or=st(ot);else if(Br=="string")Or=Te.byteLength(ot,rt);else{if(Br!="object")throw new Error("First argument needs to be a number, array or string.");Or=st(ot.length)}if(Te._useTypedArrays?et=Te._augment(new Uint8Array(Or)):((et=this).length=Or,et._isBuffer=!0),Te._useTypedArrays&&typeof ot.byteLength=="number")et._set(ot);else if(sr(Rr=ot)||Te.isBuffer(Rr)||Rr&&typeof Rr=="object"&&typeof Rr.length=="number")for(at=0;at<Or;at++)Te.isBuffer(ot)?et[at]=ot.readUInt8(at):et[at]=ot[at];else if(Br=="string")et.write(ot,0,rt);else if(Br=="number"&&!Te._useTypedArrays&&!gt)for(at=0;at<Or;at++)et[at]=0;return et}function Ae(ot,rt,gt,Or){return Te._charsWritten=Mi(function(et){for(var at=[],Rr=0;Rr<et.length;Rr++)at.push(255&et.charCodeAt(Rr));return at}(rt),ot,gt,Or)}function Ie(ot,rt,gt,Or){return Te._charsWritten=Mi(function(et){for(var at,Rr,Br=[],Kr=0;Kr<et.length;Kr++)Rr=et.charCodeAt(Kr),at=Rr>>8,Rr=Rr%256,Br.push(Rr),Br.push(at);return Br}(rt),ot,gt,Or)}function Ve(ot,rt,gt){var Or="";gt=Math.min(ot.length,gt);for(var et=rt;et<gt;et++)Or+=String.fromCharCode(ot[et]);return Or}function $e(ot,rt,gt,at){at||(ri(typeof gt=="boolean","missing or invalid endian"),ri(rt!=null,"missing offset"),ri(rt+1<ot.length,"Trying to read beyond buffer length"));var et,at=ot.length;if(!(at<=rt))return gt?(et=ot[rt],rt+1<at&&(et|=ot[rt+1]<<8)):(et=ot[rt]<<8,rt+1<at&&(et|=ot[rt+1])),et}function We(ot,rt,gt,at){at||(ri(typeof gt=="boolean","missing or invalid endian"),ri(rt!=null,"missing offset"),ri(rt+3<ot.length,"Trying to read beyond buffer length"));var et,at=ot.length;if(!(at<=rt))return gt?(rt+2<at&&(et=ot[rt+2]<<16),rt+1<at&&(et|=ot[rt+1]<<8),et|=ot[rt],rt+3<at&&(et+=ot[rt+3]<<24>>>0)):(rt+1<at&&(et=ot[rt+1]<<16),rt+2<at&&(et|=ot[rt+2]<<8),rt+3<at&&(et|=ot[rt+3]),et+=ot[rt]<<24>>>0),et}function Ue(ot,rt,gt,Or){if(Or||(ri(typeof gt=="boolean","missing or invalid endian"),ri(rt!=null,"missing offset"),ri(rt+1<ot.length,"Trying to read beyond buffer length")),!(ot.length<=rt))return Or=$e(ot,rt,gt,!0),32768&Or?-1*(65535-Or+1):Or}function je(ot,rt,gt,Or){if(Or||(ri(typeof gt=="boolean","missing or invalid endian"),ri(rt!=null,"missing offset"),ri(rt+3<ot.length,"Trying to read beyond buffer length")),!(ot.length<=rt))return Or=We(ot,rt,gt,!0),2147483648&Or?-1*(4294967295-Or+1):Or}function ze(ot,rt,gt,Or){return Or||(ri(typeof gt=="boolean","missing or invalid endian"),ri(rt+3<ot.length,"Trying to read beyond buffer length")),xe.read(ot,rt,gt,23,4)}function He(ot,rt,gt,Or){return Or||(ri(typeof gt=="boolean","missing or invalid endian"),ri(rt+7<ot.length,"Trying to read beyond buffer length")),xe.read(ot,rt,gt,52,8)}function Le(ot,rt,gt,Or,et){if(et||(ri(rt!=null,"missing value"),ri(typeof Or=="boolean","missing or invalid endian"),ri(gt!=null,"missing offset"),ri(gt+1<ot.length,"trying to write beyond buffer length"),ci(rt,65535)),et=ot.length,!(et<=gt))for(var at=0,Rr=Math.min(et-gt,2);at<Rr;at++)ot[gt+at]=(rt&255<<8*(Or?at:1-at))>>>8*(Or?at:1-at)}function qe(ot,rt,gt,Or,et){if(et||(ri(rt!=null,"missing value"),ri(typeof Or=="boolean","missing or invalid endian"),ri(gt!=null,"missing offset"),ri(gt+3<ot.length,"trying to write beyond buffer length"),ci(rt,4294967295)),et=ot.length,!(et<=gt))for(var at=0,Rr=Math.min(et-gt,4);at<Rr;at++)ot[gt+at]=rt>>>8*(Or?at:3-at)&255}function Qe(ot,rt,gt,Or,et){et||(ri(rt!=null,"missing value"),ri(typeof Or=="boolean","missing or invalid endian"),ri(gt!=null,"missing offset"),ri(gt+1<ot.length,"Trying to write beyond buffer length"),gi(rt,32767,-32768)),ot.length<=gt||Le(ot,0<=rt?rt:65535+rt+1,gt,Or,et)}function Ke(ot,rt,gt,Or,et){et||(ri(rt!=null,"missing value"),ri(typeof Or=="boolean","missing or invalid endian"),ri(gt!=null,"missing offset"),ri(gt+3<ot.length,"Trying to write beyond buffer length"),gi(rt,2147483647,-2147483648)),ot.length<=gt||qe(ot,0<=rt?rt:4294967295+rt+1,gt,Or,et)}function Je(ot,rt,gt,Or,et){et||(ri(rt!=null,"missing value"),ri(typeof Or=="boolean","missing or invalid endian"),ri(gt!=null,"missing offset"),ri(gt+3<ot.length,"Trying to write beyond buffer length"),fi(rt,34028234663852886e22,-34028234663852886e22)),ot.length<=gt||xe.write(ot,rt,gt,Or,23,4)}function pt(ot,rt,gt,Or,et){et||(ri(rt!=null,"missing value"),ri(typeof Or=="boolean","missing or invalid endian"),ri(gt!=null,"missing offset"),ri(gt+7<ot.length,"Trying to write beyond buffer length"),fi(rt,17976931348623157e292,-17976931348623157e292)),ot.length<=gt||xe.write(ot,rt,gt,Or,52,8)}W.Buffer=Te,W.SlowBuffer=Te,W.INSPECT_MAX_BYTES=50,Te.poolSize=8192,Te._useTypedArrays=function(){try{var ot=new ArrayBuffer(0),rt=new Uint8Array(ot);return rt.foo=function(){return 42},rt.foo()===42&&typeof rt.subarray=="function"}catch{return!1}}(),Te.isEncoding=function(ot){switch(String(ot).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Te.isBuffer=function(ot){return!(ot==null||!ot._isBuffer)},Te.byteLength=function(ot,rt){var gt;switch(ot+="",rt||"utf8"){case"hex":gt=ot.length/2;break;case"utf8":case"utf-8":gt=Tr(ot).length;break;case"ascii":case"binary":case"raw":gt=ot.length;break;case"base64":gt=di(ot).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":gt=2*ot.length;break;default:throw new Error("Unknown encoding")}return gt},Te.concat=function(ot,rt){if(ri(sr(ot),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),ot.length===0)return new Te(0);if(ot.length===1)return ot[0];if(typeof rt!="number")for(et=rt=0;et<ot.length;et++)rt+=ot[et].length;for(var gt=new Te(rt),Or=0,et=0;et<ot.length;et++){var at=ot[et];at.copy(gt,Or),Or+=at.length}return gt},Te.prototype.write=function(ot,rt,gt,Or){isFinite(rt)?isFinite(gt)||(Or=gt,gt=void 0):(Kr=Or,Or=rt,rt=gt,gt=Kr),rt=Number(rt)||0;var et,at,Rr,Br,Kr=this.length-rt;switch((!gt||Kr<(gt=Number(gt)))&&(gt=Kr),Or=String(Or||"utf8").toLowerCase()){case"hex":et=function(oi,ct,nt,Ir){nt=Number(nt)||0;var Dr=oi.length-nt;(!Ir||Dr<(Ir=Number(Ir)))&&(Ir=Dr),ri((Dr=ct.length)%2==0,"Invalid hex string"),Dr/2<Ir&&(Ir=Dr/2);for(var ti=0;ti<Ir;ti++){var si=parseInt(ct.substr(2*ti,2),16);ri(!isNaN(si),"Invalid hex string"),oi[nt+ti]=si}return Te._charsWritten=2*ti,ti}(this,ot,rt,gt);break;case"utf8":case"utf-8":at=this,Rr=rt,Br=gt,et=Te._charsWritten=Mi(Tr(ot),at,Rr,Br);break;case"ascii":case"binary":et=Ae(this,ot,rt,gt);break;case"base64":at=this,Rr=rt,Br=gt,et=Te._charsWritten=Mi(di(ot),at,Rr,Br);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":et=Ie(this,ot,rt,gt);break;default:throw new Error("Unknown encoding")}return et},Te.prototype.toString=function(ot,rt,gt){var Or,et,at,Rr,Br=this;if(ot=String(ot||"utf8").toLowerCase(),rt=Number(rt)||0,(gt=gt!==void 0?Number(gt):Br.length)===rt)return"";switch(ot){case"hex":Or=function(Kr,oi,ct){var nt=Kr.length;(!oi||oi<0)&&(oi=0),(!ct||ct<0||nt<ct)&&(ct=nt);for(var Ir="",Dr=oi;Dr<ct;Dr++)Ir+=mt(Kr[Dr]);return Ir}(Br,rt,gt);break;case"utf8":case"utf-8":Or=function(Kr,oi,ct){var nt="",Ir="";ct=Math.min(Kr.length,ct);for(var Dr=oi;Dr<ct;Dr++)Kr[Dr]<=127?(nt+=Gr(Ir)+String.fromCharCode(Kr[Dr]),Ir=""):Ir+="%"+Kr[Dr].toString(16);return nt+Gr(Ir)}(Br,rt,gt);break;case"ascii":case"binary":Or=Ve(Br,rt,gt);break;case"base64":et=Br,Rr=gt,Or=(at=rt)===0&&Rr===et.length?ye.fromByteArray(et):ye.fromByteArray(et.slice(at,Rr));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":Or=function(Kr,oi,ct){for(var nt=Kr.slice(oi,ct),Ir="",Dr=0;Dr<nt.length;Dr+=2)Ir+=String.fromCharCode(nt[Dr]+256*nt[Dr+1]);return Ir}(Br,rt,gt);break;default:throw new Error("Unknown encoding")}return Or},Te.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Te.prototype.copy=function(ot,rt,gt,Or){if(rt=rt||0,(Or=Or||Or===0?Or:this.length)!==(gt=gt||0)&&ot.length!==0&&this.length!==0){ri(gt<=Or,"sourceEnd < sourceStart"),ri(0<=rt&&rt<ot.length,"targetStart out of bounds"),ri(0<=gt&&gt<this.length,"sourceStart out of bounds"),ri(0<=Or&&Or<=this.length,"sourceEnd out of bounds"),Or>this.length&&(Or=this.length);var et=(Or=ot.length-rt<Or-gt?ot.length-rt+gt:Or)-gt;if(et<100||!Te._useTypedArrays)for(var at=0;at<et;at++)ot[at+rt]=this[at+gt];else ot._set(this.subarray(gt,gt+et),rt)}},Te.prototype.slice=function(ot,rt){var gt=this.length;if(ot=lt(ot,gt,0),rt=lt(rt,gt,gt),Te._useTypedArrays)return Te._augment(this.subarray(ot,rt));for(var Or=rt-ot,et=new Te(Or,void 0,!0),at=0;at<Or;at++)et[at]=this[at+ot];return et},Te.prototype.get=function(ot){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(ot)},Te.prototype.set=function(ot,rt){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(ot,rt)},Te.prototype.readUInt8=function(ot,rt){if(rt||(ri(ot!=null,"missing offset"),ri(ot<this.length,"Trying to read beyond buffer length")),!(ot>=this.length))return this[ot]},Te.prototype.readUInt16LE=function(ot,rt){return $e(this,ot,!0,rt)},Te.prototype.readUInt16BE=function(ot,rt){return $e(this,ot,!1,rt)},Te.prototype.readUInt32LE=function(ot,rt){return We(this,ot,!0,rt)},Te.prototype.readUInt32BE=function(ot,rt){return We(this,ot,!1,rt)},Te.prototype.readInt8=function(ot,rt){if(rt||(ri(ot!=null,"missing offset"),ri(ot<this.length,"Trying to read beyond buffer length")),!(ot>=this.length))return 128&this[ot]?-1*(255-this[ot]+1):this[ot]},Te.prototype.readInt16LE=function(ot,rt){return Ue(this,ot,!0,rt)},Te.prototype.readInt16BE=function(ot,rt){return Ue(this,ot,!1,rt)},Te.prototype.readInt32LE=function(ot,rt){return je(this,ot,!0,rt)},Te.prototype.readInt32BE=function(ot,rt){return je(this,ot,!1,rt)},Te.prototype.readFloatLE=function(ot,rt){return ze(this,ot,!0,rt)},Te.prototype.readFloatBE=function(ot,rt){return ze(this,ot,!1,rt)},Te.prototype.readDoubleLE=function(ot,rt){return He(this,ot,!0,rt)},Te.prototype.readDoubleBE=function(ot,rt){return He(this,ot,!1,rt)},Te.prototype.writeUInt8=function(ot,rt,gt){gt||(ri(ot!=null,"missing value"),ri(rt!=null,"missing offset"),ri(rt<this.length,"trying to write beyond buffer length"),ci(ot,255)),rt>=this.length||(this[rt]=ot)},Te.prototype.writeUInt16LE=function(ot,rt,gt){Le(this,ot,rt,!0,gt)},Te.prototype.writeUInt16BE=function(ot,rt,gt){Le(this,ot,rt,!1,gt)},Te.prototype.writeUInt32LE=function(ot,rt,gt){qe(this,ot,rt,!0,gt)},Te.prototype.writeUInt32BE=function(ot,rt,gt){qe(this,ot,rt,!1,gt)},Te.prototype.writeInt8=function(ot,rt,gt){gt||(ri(ot!=null,"missing value"),ri(rt!=null,"missing offset"),ri(rt<this.length,"Trying to write beyond buffer length"),gi(ot,127,-128)),rt>=this.length||(0<=ot?this.writeUInt8(ot,rt,gt):this.writeUInt8(255+ot+1,rt,gt))},Te.prototype.writeInt16LE=function(ot,rt,gt){Qe(this,ot,rt,!0,gt)},Te.prototype.writeInt16BE=function(ot,rt,gt){Qe(this,ot,rt,!1,gt)},Te.prototype.writeInt32LE=function(ot,rt,gt){Ke(this,ot,rt,!0,gt)},Te.prototype.writeInt32BE=function(ot,rt,gt){Ke(this,ot,rt,!1,gt)},Te.prototype.writeFloatLE=function(ot,rt,gt){Je(this,ot,rt,!0,gt)},Te.prototype.writeFloatBE=function(ot,rt,gt){Je(this,ot,rt,!1,gt)},Te.prototype.writeDoubleLE=function(ot,rt,gt){pt(this,ot,rt,!0,gt)},Te.prototype.writeDoubleBE=function(ot,rt,gt){pt(this,ot,rt,!1,gt)},Te.prototype.fill=function(ot,rt,gt){if(rt=rt||0,gt=gt||this.length,ri(typeof(ot=typeof(ot=ot||0)=="string"?ot.charCodeAt(0):ot)=="number"&&!isNaN(ot),"value is not a number"),ri(rt<=gt,"end < start"),gt!==rt&&this.length!==0){ri(0<=rt&&rt<this.length,"start out of bounds"),ri(0<=gt&&gt<=this.length,"end out of bounds");for(var Or=rt;Or<gt;Or++)this[Or]=ot}},Te.prototype.inspect=function(){for(var ot=[],rt=this.length,gt=0;gt<rt;gt++)if(ot[gt]=mt(this[gt]),gt===W.INSPECT_MAX_BYTES){ot[gt+1]="...";break}return"<Buffer "+ot.join(" ")+">"},Te.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(Te._useTypedArrays)return new Te(this).buffer;for(var ot=new Uint8Array(this.length),rt=0,gt=ot.length;rt<gt;rt+=1)ot[rt]=this[rt];return ot.buffer};var ut=Te.prototype;function lt(ot,rt,gt){return typeof ot!="number"?gt:rt<=(ot=~~ot)?rt:0<=ot||0<=(ot+=rt)?ot:0}function st(ot){return(ot=~~Math.ceil(+ot))<0?0:ot}function sr(ot){return(Array.isArray||function(rt){return Object.prototype.toString.call(rt)==="[object Array]"})(ot)}function mt(ot){return ot<16?"0"+ot.toString(16):ot.toString(16)}function Tr(ot){for(var rt=[],gt=0;gt<ot.length;gt++){var Or=ot.charCodeAt(gt);if(Or<=127)rt.push(ot.charCodeAt(gt));else for(var et=gt,at=(55296<=Or&&Or<=57343&&gt++,encodeURIComponent(ot.slice(et,gt+1)).substr(1).split("%")),Rr=0;Rr<at.length;Rr++)rt.push(parseInt(at[Rr],16))}return rt}function di(ot){return ye.toByteArray(ot)}function Mi(ot,rt,gt,Or){for(var et=0;et<Or&&!(et+gt>=rt.length||et>=ot.length);et++)rt[et+gt]=ot[et];return et}function Gr(ot){try{return decodeURIComponent(ot)}catch{return""}}function ci(ot,rt){ri(typeof ot=="number","cannot write a non-number as a number"),ri(0<=ot,"specified a negative value for writing an unsigned value"),ri(ot<=rt,"value is larger than maximum value for type"),ri(Math.floor(ot)===ot,"value has a fractional component")}function gi(ot,rt,gt){ri(typeof ot=="number","cannot write a non-number as a number"),ri(ot<=rt,"value larger than maximum allowed value"),ri(gt<=ot,"value smaller than minimum allowed value"),ri(Math.floor(ot)===ot,"value has a fractional component")}function fi(ot,rt,gt){ri(typeof ot=="number","cannot write a non-number as a number"),ri(ot<=rt,"value larger than maximum allowed value"),ri(gt<=ot,"value smaller than minimum allowed value")}function ri(ot,rt){if(!ot)throw new Error(rt||"Failed assertion")}Te._augment=function(ot){return ot._isBuffer=!0,ot._get=ot.get,ot._set=ot.set,ot.get=ut.get,ot.set=ut.set,ot.write=ut.write,ot.toString=ut.toString,ot.toLocaleString=ut.toString,ot.toJSON=ut.toJSON,ot.copy=ut.copy,ot.slice=ut.slice,ot.readUInt8=ut.readUInt8,ot.readUInt16LE=ut.readUInt16LE,ot.readUInt16BE=ut.readUInt16BE,ot.readUInt32LE=ut.readUInt32LE,ot.readUInt32BE=ut.readUInt32BE,ot.readInt8=ut.readInt8,ot.readInt16LE=ut.readInt16LE,ot.readInt16BE=ut.readInt16BE,ot.readInt32LE=ut.readInt32LE,ot.readInt32BE=ut.readInt32BE,ot.readFloatLE=ut.readFloatLE,ot.readFloatBE=ut.readFloatBE,ot.readDoubleLE=ut.readDoubleLE,ot.readDoubleBE=ut.readDoubleBE,ot.writeUInt8=ut.writeUInt8,ot.writeUInt16LE=ut.writeUInt16LE,ot.writeUInt16BE=ut.writeUInt16BE,ot.writeUInt32LE=ut.writeUInt32LE,ot.writeUInt32BE=ut.writeUInt32BE,ot.writeInt8=ut.writeInt8,ot.writeInt16LE=ut.writeInt16LE,ot.writeInt16BE=ut.writeInt16BE,ot.writeInt32LE=ut.writeInt32LE,ot.writeInt32BE=ut.writeInt32BE,ot.writeFloatLE=ut.writeFloatLE,ot.writeFloatBE=ut.writeFloatBE,ot.writeDoubleLE=ut.writeDoubleLE,ot.writeDoubleBE=ut.writeDoubleBE,ot.fill=ut.fill,ot.inspect=ut.inspect,ot.toArrayBuffer=ut.toArrayBuffer,ot}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(T,E,W){(function(X,q,ye,te,ne,ae,le,ue,ge){var ye=T("buffer").Buffer,xe=4,Te=new ye(xe);Te.fill(0),E.exports={hash:function(Ae,Ie,Ve,$e){for(var We=Ie(function(Le,qe){Le.length%xe!=0&&(Qe=Le.length+(xe-Le.length%xe),Le=ye.concat([Le,Te],Qe));for(var Qe,Ke=[],Je=qe?Le.readInt32BE:Le.readInt32LE,pt=0;pt<Le.length;pt+=xe)Ke.push(Je.call(Le,pt));return Ke}(Ae=ye.isBuffer(Ae)?Ae:new ye(Ae),$e),8*Ae.length),Ie=$e,Ue=new ye(Ve),je=Ie?Ue.writeInt32BE:Ue.writeInt32LE,ze=0;ze<We.length;ze++)je.call(Ue,We[ze],4*ze,!0);return Ue}}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(T,E,W){(function(X,q,ye,te,ne,ae,le,ue,ge){var ye=T("buffer").Buffer,xe=T("./sha"),Te=T("./sha256"),Ae=T("./rng"),Ie={sha1:xe,sha256:Te,md5:T("./md5")},Ve=64,$e=new ye(Ve);function We(Le,qe){var Qe=Ie[Le=Le||"sha1"],Ke=[];return Qe||Ue("algorithm:",Le,"is not yet supported"),{update:function(Je){return ye.isBuffer(Je)||(Je=new ye(Je)),Ke.push(Je),Je.length,this},digest:function(Je){var pt=ye.concat(Ke),pt=qe?function(ut,lt,st){ye.isBuffer(lt)||(lt=new ye(lt)),ye.isBuffer(st)||(st=new ye(st)),lt.length>Ve?lt=ut(lt):lt.length<Ve&&(lt=ye.concat([lt,$e],Ve));for(var sr=new ye(Ve),mt=new ye(Ve),Tr=0;Tr<Ve;Tr++)sr[Tr]=54^lt[Tr],mt[Tr]=92^lt[Tr];return st=ut(ye.concat([sr,st])),ut(ye.concat([mt,st]))}(Qe,qe,pt):Qe(pt);return Ke=null,Je?pt.toString(Je):pt}}}function Ue(){var Le=[].slice.call(arguments).join(" ");throw new Error([Le,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}$e.fill(0),W.createHash=function(Le){return We(Le)},W.createHmac=We,W.randomBytes=function(Le,qe){if(!qe||!qe.call)return new ye(Ae(Le));try{qe.call(this,void 0,new ye(Ae(Le)))}catch(Qe){qe(Qe)}};var je,ze=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],He=function(Le){W[Le]=function(){Ue("sorry,",Le,"is not implemented yet")}};for(je in ze)He(ze[je])}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){var ye=T("./helpers");function xe(Ue,je){Ue[je>>5]|=128<<je%32,Ue[14+(je+64>>>9<<4)]=je;for(var ze=1732584193,He=-271733879,Le=-1732584194,qe=271733878,Qe=0;Qe<Ue.length;Qe+=16){var Ke=ze,Je=He,pt=Le,ut=qe,ze=Ae(ze,He,Le,qe,Ue[Qe+0],7,-680876936),qe=Ae(qe,ze,He,Le,Ue[Qe+1],12,-389564586),Le=Ae(Le,qe,ze,He,Ue[Qe+2],17,606105819),He=Ae(He,Le,qe,ze,Ue[Qe+3],22,-1044525330);ze=Ae(ze,He,Le,qe,Ue[Qe+4],7,-176418897),qe=Ae(qe,ze,He,Le,Ue[Qe+5],12,1200080426),Le=Ae(Le,qe,ze,He,Ue[Qe+6],17,-1473231341),He=Ae(He,Le,qe,ze,Ue[Qe+7],22,-45705983),ze=Ae(ze,He,Le,qe,Ue[Qe+8],7,1770035416),qe=Ae(qe,ze,He,Le,Ue[Qe+9],12,-1958414417),Le=Ae(Le,qe,ze,He,Ue[Qe+10],17,-42063),He=Ae(He,Le,qe,ze,Ue[Qe+11],22,-1990404162),ze=Ae(ze,He,Le,qe,Ue[Qe+12],7,1804603682),qe=Ae(qe,ze,He,Le,Ue[Qe+13],12,-40341101),Le=Ae(Le,qe,ze,He,Ue[Qe+14],17,-1502002290),ze=Ie(ze,He=Ae(He,Le,qe,ze,Ue[Qe+15],22,1236535329),Le,qe,Ue[Qe+1],5,-165796510),qe=Ie(qe,ze,He,Le,Ue[Qe+6],9,-1069501632),Le=Ie(Le,qe,ze,He,Ue[Qe+11],14,643717713),He=Ie(He,Le,qe,ze,Ue[Qe+0],20,-373897302),ze=Ie(ze,He,Le,qe,Ue[Qe+5],5,-701558691),qe=Ie(qe,ze,He,Le,Ue[Qe+10],9,38016083),Le=Ie(Le,qe,ze,He,Ue[Qe+15],14,-660478335),He=Ie(He,Le,qe,ze,Ue[Qe+4],20,-405537848),ze=Ie(ze,He,Le,qe,Ue[Qe+9],5,568446438),qe=Ie(qe,ze,He,Le,Ue[Qe+14],9,-1019803690),Le=Ie(Le,qe,ze,He,Ue[Qe+3],14,-187363961),He=Ie(He,Le,qe,ze,Ue[Qe+8],20,1163531501),ze=Ie(ze,He,Le,qe,Ue[Qe+13],5,-1444681467),qe=Ie(qe,ze,He,Le,Ue[Qe+2],9,-51403784),Le=Ie(Le,qe,ze,He,Ue[Qe+7],14,1735328473),ze=Ve(ze,He=Ie(He,Le,qe,ze,Ue[Qe+12],20,-1926607734),Le,qe,Ue[Qe+5],4,-378558),qe=Ve(qe,ze,He,Le,Ue[Qe+8],11,-2022574463),Le=Ve(Le,qe,ze,He,Ue[Qe+11],16,1839030562),He=Ve(He,Le,qe,ze,Ue[Qe+14],23,-35309556),ze=Ve(ze,He,Le,qe,Ue[Qe+1],4,-1530992060),qe=Ve(qe,ze,He,Le,Ue[Qe+4],11,1272893353),Le=Ve(Le,qe,ze,He,Ue[Qe+7],16,-155497632),He=Ve(He,Le,qe,ze,Ue[Qe+10],23,-1094730640),ze=Ve(ze,He,Le,qe,Ue[Qe+13],4,681279174),qe=Ve(qe,ze,He,Le,Ue[Qe+0],11,-358537222),Le=Ve(Le,qe,ze,He,Ue[Qe+3],16,-722521979),He=Ve(He,Le,qe,ze,Ue[Qe+6],23,76029189),ze=Ve(ze,He,Le,qe,Ue[Qe+9],4,-640364487),qe=Ve(qe,ze,He,Le,Ue[Qe+12],11,-421815835),Le=Ve(Le,qe,ze,He,Ue[Qe+15],16,530742520),ze=$e(ze,He=Ve(He,Le,qe,ze,Ue[Qe+2],23,-995338651),Le,qe,Ue[Qe+0],6,-198630844),qe=$e(qe,ze,He,Le,Ue[Qe+7],10,1126891415),Le=$e(Le,qe,ze,He,Ue[Qe+14],15,-1416354905),He=$e(He,Le,qe,ze,Ue[Qe+5],21,-57434055),ze=$e(ze,He,Le,qe,Ue[Qe+12],6,1700485571),qe=$e(qe,ze,He,Le,Ue[Qe+3],10,-1894986606),Le=$e(Le,qe,ze,He,Ue[Qe+10],15,-1051523),He=$e(He,Le,qe,ze,Ue[Qe+1],21,-2054922799),ze=$e(ze,He,Le,qe,Ue[Qe+8],6,1873313359),qe=$e(qe,ze,He,Le,Ue[Qe+15],10,-30611744),Le=$e(Le,qe,ze,He,Ue[Qe+6],15,-1560198380),He=$e(He,Le,qe,ze,Ue[Qe+13],21,1309151649),ze=$e(ze,He,Le,qe,Ue[Qe+4],6,-145523070),qe=$e(qe,ze,He,Le,Ue[Qe+11],10,-1120210379),Le=$e(Le,qe,ze,He,Ue[Qe+2],15,718787259),He=$e(He,Le,qe,ze,Ue[Qe+9],21,-343485551),ze=We(ze,Ke),He=We(He,Je),Le=We(Le,pt),qe=We(qe,ut)}return Array(ze,He,Le,qe)}function Te(Ue,je,ze,He,Le,qe){return We((je=We(We(je,Ue),We(He,qe)))<<Le|je>>>32-Le,ze)}function Ae(Ue,je,ze,He,Le,qe,Qe){return Te(je&ze|~je&He,Ue,je,Le,qe,Qe)}function Ie(Ue,je,ze,He,Le,qe,Qe){return Te(je&He|ze&~He,Ue,je,Le,qe,Qe)}function Ve(Ue,je,ze,He,Le,qe,Qe){return Te(je^ze^He,Ue,je,Le,qe,Qe)}function $e(Ue,je,ze,He,Le,qe,Qe){return Te(ze^(je|~He),Ue,je,Le,qe,Qe)}function We(Ue,je){var ze=(65535&Ue)+(65535&je);return(Ue>>16)+(je>>16)+(ze>>16)<<16|65535&ze}E.exports=function(Ue){return ye.hash(Ue,xe,16)}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){E.exports=function(ye){for(var xe,Te=new Array(ye),Ae=0;Ae<ye;Ae++)!(3&Ae)&&(xe=4294967296*Math.random()),Te[Ae]=xe>>>((3&Ae)<<3)&255;return Te}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){var ye=T("./helpers");function xe(Ie,Ve){Ie[Ve>>5]|=128<<24-Ve%32,Ie[15+(Ve+64>>9<<4)]=Ve;for(var $e,We,Ue,je=Array(80),ze=1732584193,He=-271733879,Le=-1732584194,qe=271733878,Qe=-1009589776,Ke=0;Ke<Ie.length;Ke+=16){for(var Je=ze,pt=He,ut=Le,lt=qe,st=Qe,sr=0;sr<80;sr++){je[sr]=sr<16?Ie[Ke+sr]:Ae(je[sr-3]^je[sr-8]^je[sr-14]^je[sr-16],1);var mt=Te(Te(Ae(ze,5),(mt=He,We=Le,Ue=qe,($e=sr)<20?mt&We|~mt&Ue:!($e<40)&&$e<60?mt&We|mt&Ue|We&Ue:mt^We^Ue)),Te(Te(Qe,je[sr]),($e=sr)<20?1518500249:$e<40?1859775393:$e<60?-1894007588:-899497514)),Qe=qe,qe=Le,Le=Ae(He,30),He=ze,ze=mt}ze=Te(ze,Je),He=Te(He,pt),Le=Te(Le,ut),qe=Te(qe,lt),Qe=Te(Qe,st)}return Array(ze,He,Le,qe,Qe)}function Te(Ie,Ve){var $e=(65535&Ie)+(65535&Ve);return(Ie>>16)+(Ve>>16)+($e>>16)<<16|65535&$e}function Ae(Ie,Ve){return Ie<<Ve|Ie>>>32-Ve}E.exports=function(Ie){return ye.hash(Ie,xe,20,!0)}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){function ye(Ve,$e){var We=(65535&Ve)+(65535&$e);return(Ve>>16)+($e>>16)+(We>>16)<<16|65535&We}function xe(Ve,$e){var We,Ue=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),je=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),ze=new Array(64);Ve[$e>>5]|=128<<24-$e%32,Ve[15+($e+64>>9<<4)]=$e;for(var He,Le,qe=0;qe<Ve.length;qe+=16){for(var Qe=je[0],Ke=je[1],Je=je[2],pt=je[3],ut=je[4],lt=je[5],st=je[6],sr=je[7],mt=0;mt<64;mt++)ze[mt]=mt<16?Ve[mt+qe]:ye(ye(ye((Le=ze[mt-2],Ae(Le,17)^Ae(Le,19)^Ie(Le,10)),ze[mt-7]),(Le=ze[mt-15],Ae(Le,7)^Ae(Le,18)^Ie(Le,3))),ze[mt-16]),We=ye(ye(ye(ye(sr,Ae(Le=ut,6)^Ae(Le,11)^Ae(Le,25)),ut&lt^~ut&st),Ue[mt]),ze[mt]),He=ye(Ae(He=Qe,2)^Ae(He,13)^Ae(He,22),Qe&Ke^Qe&Je^Ke&Je),sr=st,st=lt,lt=ut,ut=ye(pt,We),pt=Je,Je=Ke,Ke=Qe,Qe=ye(We,He);je[0]=ye(Qe,je[0]),je[1]=ye(Ke,je[1]),je[2]=ye(Je,je[2]),je[3]=ye(pt,je[3]),je[4]=ye(ut,je[4]),je[5]=ye(lt,je[5]),je[6]=ye(st,je[6]),je[7]=ye(sr,je[7])}return je}var Te=T("./helpers"),Ae=function(Ve,$e){return Ve>>>$e|Ve<<32-$e},Ie=function(Ve,$e){return Ve>>>$e};E.exports=function(Ve){return Te.hash(Ve,xe,32,!0)}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){W.read=function(ye,xe,Te,Ae,qe){var Ve,$e,We=8*qe-Ae-1,Ue=(1<<We)-1,je=Ue>>1,ze=-7,He=Te?qe-1:0,Le=Te?-1:1,qe=ye[xe+He];for(He+=Le,Ve=qe&(1<<-ze)-1,qe>>=-ze,ze+=We;0<ze;Ve=256*Ve+ye[xe+He],He+=Le,ze-=8);for($e=Ve&(1<<-ze)-1,Ve>>=-ze,ze+=Ae;0<ze;$e=256*$e+ye[xe+He],He+=Le,ze-=8);if(Ve===0)Ve=1-je;else{if(Ve===Ue)return $e?NaN:1/0*(qe?-1:1);$e+=Math.pow(2,Ae),Ve-=je}return(qe?-1:1)*$e*Math.pow(2,Ve-Ae)},W.write=function(ye,xe,Te,Ae,Ie,Qe){var $e,We,Ue=8*Qe-Ie-1,je=(1<<Ue)-1,ze=je>>1,He=Ie===23?Math.pow(2,-24)-Math.pow(2,-77):0,Le=Ae?0:Qe-1,qe=Ae?1:-1,Qe=xe<0||xe===0&&1/xe<0?1:0;for(xe=Math.abs(xe),isNaN(xe)||xe===1/0?(We=isNaN(xe)?1:0,$e=je):($e=Math.floor(Math.log(xe)/Math.LN2),xe*(Ae=Math.pow(2,-$e))<1&&($e--,Ae*=2),2<=(xe+=1<=$e+ze?He/Ae:He*Math.pow(2,1-ze))*Ae&&($e++,Ae/=2),je<=$e+ze?(We=0,$e=je):1<=$e+ze?(We=(xe*Ae-1)*Math.pow(2,Ie),$e+=ze):(We=xe*Math.pow(2,ze-1)*Math.pow(2,Ie),$e=0));8<=Ie;ye[Te+Le]=255&We,Le+=qe,We/=256,Ie-=8);for($e=$e<<Ie|We,Ue+=Ie;0<Ue;ye[Te+Le]=255&$e,Le+=qe,$e/=256,Ue-=8);ye[Te+Le-qe]|=128*Qe}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(T,E,W){(function(X,q,Y,te,ne,ae,le,ue,ge){var ye,xe,Te;function Ae(){}(X=E.exports={}).nextTick=(xe=typeof window<"u"&&window.setImmediate,Te=typeof window<"u"&&window.postMessage&&window.addEventListener,xe?function(Ie){return window.setImmediate(Ie)}:Te?(ye=[],window.addEventListener("message",function(Ie){var Ve=Ie.source;Ve!==window&&Ve!==null||Ie.data!=="process-tick"||(Ie.stopPropagation(),0<ye.length&&ye.shift()())},!0),function(Ie){ye.push(Ie),window.postMessage("process-tick","*")}):function(Ie){setTimeout(Ie,0)}),X.title="browser",X.browser=!0,X.env={},X.argv=[],X.on=Ae,X.addListener=Ae,X.once=Ae,X.off=Ae,X.removeListener=Ae,X.removeAllListeners=Ae,X.emit=Ae,X.binding=function(Ie){throw new Error("process.binding is not supported")},X.cwd=function(){return"/"},X.chdir=function(Ie){throw new Error("process.chdir is not supported")}}).call(this,T("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},T("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(il);var ol=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],pr=ol;pr=pr.slice().filter(function(B){return!/^(gl\_|texture)/.test(B)});pr.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]);function yd(B,_){if(typeof B!="object"||B===null)return B;var T=B[Symbol.toPrimitive];if(T!==void 0){var E=T.call(B,_||"default");if(typeof E!="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(B)}function al(B){var _=yd(B,"string");return typeof _=="symbol"?_:String(_)}function Ne(B,_,T){return _=al(_),_ in B?Object.defineProperty(B,_,{value:T,enumerable:!0,configurable:!0,writable:!0}):B[_]=T,B}var be={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},ft,$n;ft={},Ne(ft,"".concat(be.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(be.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),Ne(ft,"".concat(be.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(be.position,`;
  `)}),Ne(ft,"".concat(be.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(be.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),Ne(ft,"".concat(be.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(be.pointSize,`;
    `)}),Ne(ft,"".concat(be.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(be.diffuseColor,`;
  `)}),Ne(ft,"".concat(be.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(be.fragColor,`;
  `)}),Ne(ft,"".concat(be.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(be.emissive,`;
    `)}),Ne(ft,"".concat(be.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(be.roughness,`;
    `)}),Ne(ft,"".concat(be.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(be.metalness,`;
    `)}),Ne(ft,"".concat(be.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(be.ao,`;
    `)}),Ne(ft,"".concat(be.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(be.bump," - (dot(").concat(be.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),Ne(ft,"".concat(be.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(be.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(be.depthAlpha,`;
    `)});$n={},Ne($n,"".concat(be.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(be.position,`, 1.0 );
  `)}),Ne($n,"".concat(be.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(be.position,`;
  `)}),Ne($n,"".concat(be.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(be.diffuseColor,`;
  `)}),Ne($n,"".concat(be.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(be.fragColor,`;
  `)});var dt;dt={},Ne(dt,"".concat(be.position),"*"),Ne(dt,"".concat(be.positionRaw),"*"),Ne(dt,"".concat(be.normal),"*"),Ne(dt,"".concat(be.pointSize),["PointsMaterial"]),Ne(dt,"".concat(be.diffuseColor),"*"),Ne(dt,"".concat(be.fragColor),"*"),Ne(dt,"".concat(be.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ne(dt,"".concat(be.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ne(dt,"".concat(be.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ne(dt,"".concat(be.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),Ne(dt,"".concat(be.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),Ne(dt,"".concat(be.depthAlpha),"*");new Box3;new Vector3;UniformsLib.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};ShaderLib.line={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,UniformsLib.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new Vector3;new Vector3;new Vector4;new Vector4;new Vector4;new Vector3;new Matrix4;new Line3;new Vector3;new Box3;new Sphere;new Vector4;const Up={key:0,args:[0,1,64]},Np={key:1,args:[.5,1,64]},zp={key:2},Hp=["tone-mapped","map","side","color"];new Color(16777215);class mi extends Mesh{constructor(){const _=mi.SkyShader,T=new ShaderMaterial({name:_.name,uniforms:UniformsUtils.clone(_.uniforms),vertexShader:_.vertexShader,fragmentShader:_.fragmentShader,side:BackSide,depthWrite:!1});super(new BoxGeometry(1,1,1),T),this.isSky=!0}}mi.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};var fl={exports:{}};(function(B,_){(function(T,E){B.exports=E()})(Yf,function(){var T=function(){function E(ge){return q.appendChild(ge.dom),ge}function W(ge){for(var ye=0;ye<q.children.length;ye++)q.children[ye].style.display=ye===ge?"block":"none";X=ge}var X=0,q=document.createElement("div");q.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",q.addEventListener("click",function(ge){ge.preventDefault(),W(++X%q.children.length)},!1);var Y=(performance||Date).now(),te=Y,ne=0,ae=E(new T.Panel("FPS","#0ff","#002")),le=E(new T.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var ue=E(new T.Panel("MB","#f08","#201"));return W(0),{REVISION:16,dom:q,addPanel:E,showPanel:W,begin:function(){Y=(performance||Date).now()},end:function(){ne++;var ge=(performance||Date).now();if(le.update(ge-Y,200),ge>te+1e3&&(ae.update(1e3*ne/(ge-te),100),te=ge,ne=0,ue)){var ye=performance.memory;ue.update(ye.usedJSHeapSize/1048576,ye.jsHeapSizeLimit/1048576)}return ge},update:function(){Y=this.end()},domElement:q,setMode:W}};return T.Panel=function(E,W,X){var q=1/0,Y=0,te=Math.round,ne=te(window.devicePixelRatio||1),ae=80*ne,le=48*ne,ue=3*ne,ge=2*ne,ye=3*ne,xe=15*ne,Te=74*ne,Ae=30*ne,Ie=document.createElement("canvas");Ie.width=ae,Ie.height=le,Ie.style.cssText="width:80px;height:48px";var Ve=Ie.getContext("2d");return Ve.font="bold "+9*ne+"px Helvetica,Arial,sans-serif",Ve.textBaseline="top",Ve.fillStyle=X,Ve.fillRect(0,0,ae,le),Ve.fillStyle=W,Ve.fillText(E,ue,ge),Ve.fillRect(ye,xe,Te,Ae),Ve.fillStyle=X,Ve.globalAlpha=.9,Ve.fillRect(ye,xe,Te,Ae),{dom:Ie,update:function($e,We){q=Math.min(q,$e),Y=Math.max(Y,$e),Ve.fillStyle=X,Ve.globalAlpha=1,Ve.fillRect(0,0,ae,xe),Ve.fillStyle=W,Ve.fillText(te($e)+" "+E+" ("+te(q)+"-"+te(Y)+")",ue,ge),Ve.drawImage(Ie,ye+ne,xe,Te-ne,Ae,ye,xe,Te-ne,Ae),Ve.fillRect(ye+Te-ne,xe,ne,Ae),Ve.fillStyle=X,Ve.globalAlpha=.9,Ve.fillRect(ye+Te-ne,xe,ne,te((1-$e/We)*Ae))}}},T})})(fl);var Am=`#include <common>

void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;

  
  
  float size = 0.03;

  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;

  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;

  gl_Position = projectionMatrix * mvPosition;
}`,Pm=`void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}`;const Rs=new Vector3(0,0,0),Nr=new Vector3(0,0,0),Cm=new Vector3(0,0,0);function qo(B,_,T){const E=Rs.setFromMatrixPosition(B.matrixWorld);E.project(_);const W=T.width/2,X=T.height/2;return[(Number.isNaN(E.x)?0:E.x)*W+W,-(E.y*X)+X]}function Im(B,_){const T=Rs.setFromMatrixPosition(B.matrixWorld),E=Nr.setFromMatrixPosition(_.matrixWorld),W=T.sub(E),X=_.getWorldDirection(Cm);return W.angleTo(X)>Math.PI/2}function Rm(B,_,T,E){const W=Rs.setFromMatrixPosition(B.matrixWorld),X=W.clone();X.project(_),T.setFromCamera(new Vector2(X.x,X.y),_);const q=T.intersectObjects(E,!0);if(q.length>0){const Y=q[0].distance;return W.distanceTo(T.ray.origin)<Y}return!0}function Dm(B,_){if(_ instanceof OrthographicCamera)return _.zoom;if(_ instanceof PerspectiveCamera){const T=Rs.setFromMatrixPosition(B.matrixWorld),E=Nr.setFromMatrixPosition(_.matrixWorld),W=_.fov*Math.PI/180,X=T.distanceTo(E);return 1/(2*Math.tan(W/2)*X)}else return 1}function Om(B,_,T){if(_ instanceof PerspectiveCamera||_ instanceof OrthographicCamera){const E=Rs.setFromMatrixPosition(B.matrixWorld),W=Nr.setFromMatrixPosition(_.matrixWorld),X=E.distanceTo(W),q=(T[1]-T[0])/(_.far-_.near),Y=T[1]-q*_.far;return Math.round(q*X+Y)}}const gr=B=>Math.abs(B)<1e-10?0:B;function pl(B,_,T=""){let E="matrix3d(";for(let W=0;W!==16;W++)E+=gr(_[W]*B.elements[W])+(W!==15?",":")");return T+E}const Lm=(B=>_=>pl(_,B))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Fm=(B=>(_,T)=>pl(_,B(T),"translate(-50%,-50%)"))(B=>[1/B,1/B,1/B,1,-1/B,-1/B,-1/B,-1,1/B,1/B,1/B,1,1,1,1,1]),km=["geometry","material"];new PlaneGeometry;class Text{lineAt(_){if(_<0||_>this.length)throw new RangeError(`Invalid position ${_} in document of length ${this.length}`);return this.lineInner(_,!1,1,0)}line(_){if(_<1||_>this.lines)throw new RangeError(`Invalid line number ${_} in ${this.lines}-line document`);return this.lineInner(_,!0,1,0)}replace(_,T,E){[_,T]=clip(this,_,T);let W=[];return this.decompose(0,_,W,2),E.length&&E.decompose(0,E.length,W,3),this.decompose(T,this.length,W,1),TextNode.from(W,this.length-(T-_)+E.length)}append(_){return this.replace(this.length,this.length,_)}slice(_,T=this.length){[_,T]=clip(this,_,T);let E=[];return this.decompose(_,T,E,0),TextNode.from(E,T-_)}eq(_){if(_==this)return!0;if(_.length!=this.length||_.lines!=this.lines)return!1;let T=this.scanIdentical(_,1),E=this.length-this.scanIdentical(_,-1),W=new RawTextCursor(this),X=new RawTextCursor(_);for(let q=T,Y=T;;){if(W.next(q),X.next(q),q=0,W.lineBreak!=X.lineBreak||W.done!=X.done||W.value!=X.value)return!1;if(Y+=W.value.length,W.done||Y>=E)return!0}}iter(_=1){return new RawTextCursor(this,_)}iterRange(_,T=this.length){return new PartialTextCursor(this,_,T)}iterLines(_,T){let E;if(_==null)E=this.iter();else{T==null&&(T=this.lines+1);let W=this.line(_).from;E=this.iterRange(W,Math.max(W,T==this.lines+1?this.length:T<=1?0:this.line(T-1).to))}return new LineCursor(E)}toString(){return this.sliceString(0)}toJSON(){let _=[];return this.flatten(_),_}constructor(){}static of(_){if(_.length==0)throw new RangeError("A document must have at least one line");return _.length==1&&!_[0]?Text.empty:_.length<=32?new TextLeaf(_):TextNode.from(TextLeaf.split(_,[]))}}class TextLeaf extends Text{constructor(_,T=textLength(_)){super(),this.text=_,this.length=T}get lines(){return this.text.length}get children(){return null}lineInner(_,T,E,W){for(let X=0;;X++){let q=this.text[X],Y=W+q.length;if((T?E:Y)>=_)return new Line(W,Y,E,q);W=Y+1,E++}}decompose(_,T,E,W){let X=_<=0&&T>=this.length?this:new TextLeaf(sliceText(this.text,_,T),Math.min(T,this.length)-Math.max(0,_));if(W&1){let q=E.pop(),Y=appendText(X.text,q.text.slice(),0,X.length);if(Y.length<=32)E.push(new TextLeaf(Y,q.length+X.length));else{let te=Y.length>>1;E.push(new TextLeaf(Y.slice(0,te)),new TextLeaf(Y.slice(te)))}}else E.push(X)}replace(_,T,E){if(!(E instanceof TextLeaf))return super.replace(_,T,E);[_,T]=clip(this,_,T);let W=appendText(this.text,appendText(E.text,sliceText(this.text,0,_)),T),X=this.length+E.length-(T-_);return W.length<=32?new TextLeaf(W,X):TextNode.from(TextLeaf.split(W,[]),X)}sliceString(_,T=this.length,E=`
`){[_,T]=clip(this,_,T);let W="";for(let X=0,q=0;X<=T&&q<this.text.length;q++){let Y=this.text[q],te=X+Y.length;X>_&&q&&(W+=E),_<te&&T>X&&(W+=Y.slice(Math.max(0,_-X),T-X)),X=te+1}return W}flatten(_){for(let T of this.text)_.push(T)}scanIdentical(){return 0}static split(_,T){let E=[],W=-1;for(let X of _)E.push(X),W+=X.length+1,E.length==32&&(T.push(new TextLeaf(E,W)),E=[],W=-1);return W>-1&&T.push(new TextLeaf(E,W)),T}}class TextNode extends Text{constructor(_,T){super(),this.children=_,this.length=T,this.lines=0;for(let E of _)this.lines+=E.lines}lineInner(_,T,E,W){for(let X=0;;X++){let q=this.children[X],Y=W+q.length,te=E+q.lines-1;if((T?te:Y)>=_)return q.lineInner(_,T,E,W);W=Y+1,E=te+1}}decompose(_,T,E,W){for(let X=0,q=0;q<=T&&X<this.children.length;X++){let Y=this.children[X],te=q+Y.length;if(_<=te&&T>=q){let ne=W&((q<=_?1:0)|(te>=T?2:0));q>=_&&te<=T&&!ne?E.push(Y):Y.decompose(_-q,T-q,E,ne)}q=te+1}}replace(_,T,E){if([_,T]=clip(this,_,T),E.lines<this.lines)for(let W=0,X=0;W<this.children.length;W++){let q=this.children[W],Y=X+q.length;if(_>=X&&T<=Y){let te=q.replace(_-X,T-X,E),ne=this.lines-q.lines+te.lines;if(te.lines<ne>>4&&te.lines>ne>>6){let ae=this.children.slice();return ae[W]=te,new TextNode(ae,this.length-(T-_)+E.length)}return super.replace(X,Y,te)}X=Y+1}return super.replace(_,T,E)}sliceString(_,T=this.length,E=`
`){[_,T]=clip(this,_,T);let W="";for(let X=0,q=0;X<this.children.length&&q<=T;X++){let Y=this.children[X],te=q+Y.length;q>_&&X&&(W+=E),_<te&&T>q&&(W+=Y.sliceString(_-q,T-q,E)),q=te+1}return W}flatten(_){for(let T of this.children)T.flatten(_)}scanIdentical(_,T){if(!(_ instanceof TextNode))return 0;let E=0,[W,X,q,Y]=T>0?[0,0,this.children.length,_.children.length]:[this.children.length-1,_.children.length-1,-1,-1];for(;;W+=T,X+=T){if(W==q||X==Y)return E;let te=this.children[W],ne=_.children[X];if(te!=ne)return E+te.scanIdentical(ne,T);E+=te.length+1}}static from(_,T=_.reduce((E,W)=>E+W.length+1,-1)){let E=0;for(let ge of _)E+=ge.lines;if(E<32){let ge=[];for(let ye of _)ye.flatten(ge);return new TextLeaf(ge,T)}let W=Math.max(32,E>>5),X=W<<1,q=W>>1,Y=[],te=0,ne=-1,ae=[];function le(ge){let ye;if(ge.lines>X&&ge instanceof TextNode)for(let xe of ge.children)le(xe);else ge.lines>q&&(te>q||!te)?(ue(),Y.push(ge)):ge instanceof TextLeaf&&te&&(ye=ae[ae.length-1])instanceof TextLeaf&&ge.lines+ye.lines<=32?(te+=ge.lines,ne+=ge.length+1,ae[ae.length-1]=new TextLeaf(ye.text.concat(ge.text),ye.length+1+ge.length)):(te+ge.lines>W&&ue(),te+=ge.lines,ne+=ge.length+1,ae.push(ge))}function ue(){te!=0&&(Y.push(ae.length==1?ae[0]:TextNode.from(ae,ne)),ne=-1,te=ae.length=0)}for(let ge of _)le(ge);return ue(),Y.length==1?Y[0]:new TextNode(Y,T)}}Text.empty=new TextLeaf([""],0);function textLength(B){let _=-1;for(let T of B)_+=T.length+1;return _}function appendText(B,_,T=0,E=1e9){for(let W=0,X=0,q=!0;X<B.length&&W<=E;X++){let Y=B[X],te=W+Y.length;te>=T&&(te>E&&(Y=Y.slice(0,E-W)),W<T&&(Y=Y.slice(T-W)),q?(_[_.length-1]+=Y,q=!1):_.push(Y)),W=te+1}return _}function sliceText(B,_,T){return appendText(B,[""],_,T)}class RawTextCursor{constructor(_,T=1){this.dir=T,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[_],this.offsets=[T>0?1:(_ instanceof TextLeaf?_.text.length:_.children.length)<<1]}nextInner(_,T){for(this.done=this.lineBreak=!1;;){let E=this.nodes.length-1,W=this.nodes[E],X=this.offsets[E],q=X>>1,Y=W instanceof TextLeaf?W.text.length:W.children.length;if(q==(T>0?Y:0)){if(E==0)return this.done=!0,this.value="",this;T>0&&this.offsets[E-1]++,this.nodes.pop(),this.offsets.pop()}else if((X&1)==(T>0?0:1)){if(this.offsets[E]+=T,_==0)return this.lineBreak=!0,this.value=`
`,this;_--}else if(W instanceof TextLeaf){let te=W.text[q+(T<0?-1:0)];if(this.offsets[E]+=T,te.length>Math.max(0,_))return this.value=_==0?te:T>0?te.slice(_):te.slice(0,te.length-_),this;_-=te.length}else{let te=W.children[q+(T<0?-1:0)];_>te.length?(_-=te.length,this.offsets[E]+=T):(T<0&&this.offsets[E]--,this.nodes.push(te),this.offsets.push(T>0?1:(te instanceof TextLeaf?te.text.length:te.children.length)<<1))}}}next(_=0){return _<0&&(this.nextInner(-_,-this.dir),_=this.value.length),this.nextInner(_,this.dir)}}class PartialTextCursor{constructor(_,T,E){this.value="",this.done=!1,this.cursor=new RawTextCursor(_,T>E?-1:1),this.pos=T>E?_.length:0,this.from=Math.min(T,E),this.to=Math.max(T,E)}nextInner(_,T){if(T<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;_+=Math.max(0,T<0?this.pos-this.to:this.from-this.pos);let E=T<0?this.pos-this.from:this.to-this.pos;_>E&&(_=E),E-=_;let{value:W}=this.cursor.next(_);return this.pos+=(W.length+_)*T,this.value=W.length<=E?W:T<0?W.slice(W.length-E):W.slice(0,E),this.done=!this.value,this}next(_=0){return _<0?_=Math.max(_,this.from-this.pos):_>0&&(_=Math.min(_,this.to-this.pos)),this.nextInner(_,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class LineCursor{constructor(_){this.inner=_,this.afterBreak=!0,this.value="",this.done=!1}next(_=0){let{done:T,lineBreak:E,value:W}=this.inner.next(_);return T&&this.afterBreak?(this.value="",this.afterBreak=!1):T?(this.done=!0,this.value=""):E?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=W,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});class Line{constructor(_,T,E,W){this.from=_,this.to=T,this.number=E,this.text=W}get length(){return this.to-this.from}}function clip(B,_,T){return _=Math.max(0,Math.min(B.length,_)),[_,Math.max(_,Math.min(B.length,T))]}let extend="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(B=>B?parseInt(B,36):1);for(let B=1;B<extend.length;B++)extend[B]+=extend[B-1];function isExtendingChar(B){for(let _=1;_<extend.length;_+=2)if(extend[_]>B)return extend[_-1]<=B;return!1}function isRegionalIndicator(B){return B>=127462&&B<=127487}const ZWJ=8205;function findClusterBreak(B,_,T=!0,E=!0){return(T?nextClusterBreak:prevClusterBreak)(B,_,E)}function nextClusterBreak(B,_,T){if(_==B.length)return _;_&&surrogateLow(B.charCodeAt(_))&&surrogateHigh(B.charCodeAt(_-1))&&_--;let E=codePointAt(B,_);for(_+=codePointSize(E);_<B.length;){let W=codePointAt(B,_);if(E==ZWJ||W==ZWJ||T&&isExtendingChar(W))_+=codePointSize(W),E=W;else if(isRegionalIndicator(W)){let X=0,q=_-2;for(;q>=0&&isRegionalIndicator(codePointAt(B,q));)X++,q-=2;if(X%2==0)break;_+=2}else break}return _}function prevClusterBreak(B,_,T){for(;_>0;){let E=nextClusterBreak(B,_-2,T);if(E<_)return E;_--}return 0}function surrogateLow(B){return B>=56320&&B<57344}function surrogateHigh(B){return B>=55296&&B<56320}function codePointAt(B,_){let T=B.charCodeAt(_);if(!surrogateHigh(T)||_+1==B.length)return T;let E=B.charCodeAt(_+1);return surrogateLow(E)?(T-55296<<10)+(E-56320)+65536:T}function fromCodePoint(B){return B<=65535?String.fromCharCode(B):(B-=65536,String.fromCharCode((B>>10)+55296,(B&1023)+56320))}function codePointSize(B){return B<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=function(B){return B[B.Simple=0]="Simple",B[B.TrackDel=1]="TrackDel",B[B.TrackBefore=2]="TrackBefore",B[B.TrackAfter=3]="TrackAfter",B}(MapMode||(MapMode={}));class ChangeDesc{constructor(_){this.sections=_}get length(){let _=0;for(let T=0;T<this.sections.length;T+=2)_+=this.sections[T];return _}get newLength(){let _=0;for(let T=0;T<this.sections.length;T+=2){let E=this.sections[T+1];_+=E<0?this.sections[T]:E}return _}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(_){for(let T=0,E=0,W=0;T<this.sections.length;){let X=this.sections[T++],q=this.sections[T++];q<0?(_(E,W,X),W+=X):W+=q,E+=X}}iterChangedRanges(_,T=!1){iterChanges(this,_,T)}get invertedDesc(){let _=[];for(let T=0;T<this.sections.length;){let E=this.sections[T++],W=this.sections[T++];W<0?_.push(E,W):_.push(W,E)}return new ChangeDesc(_)}composeDesc(_){return this.empty?_:_.empty?this:composeSets(this,_)}mapDesc(_,T=!1){return _.empty?this:mapSet(this,_,T)}mapPos(_,T=-1,E=MapMode.Simple){let W=0,X=0;for(let q=0;q<this.sections.length;){let Y=this.sections[q++],te=this.sections[q++],ne=W+Y;if(te<0){if(ne>_)return X+(_-W);X+=Y}else{if(E!=MapMode.Simple&&ne>=_&&(E==MapMode.TrackDel&&W<_&&ne>_||E==MapMode.TrackBefore&&W<_||E==MapMode.TrackAfter&&ne>_))return null;if(ne>_||ne==_&&T<0&&!Y)return _==W||T<0?X:X+te;X+=te}W=ne}if(_>W)throw new RangeError(`Position ${_} is out of range for changeset of length ${W}`);return X}touchesRange(_,T=_){for(let E=0,W=0;E<this.sections.length&&W<=T;){let X=this.sections[E++],q=this.sections[E++],Y=W+X;if(q>=0&&W<=T&&Y>=_)return W<_&&Y>T?"cover":!0;W=Y}return!1}toString(){let _="";for(let T=0;T<this.sections.length;){let E=this.sections[T++],W=this.sections[T++];_+=(_?" ":"")+E+(W>=0?":"+W:"")}return _}toJSON(){return this.sections}static fromJSON(_){if(!Array.isArray(_)||_.length%2||_.some(T=>typeof T!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(_)}static create(_){return new ChangeDesc(_)}}class ChangeSet extends ChangeDesc{constructor(_,T){super(_),this.inserted=T}apply(_){if(this.length!=_.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,(T,E,W,X,q)=>_=_.replace(W,W+(E-T),q),!1),_}mapDesc(_,T=!1){return mapSet(this,_,T,!0)}invert(_){let T=this.sections.slice(),E=[];for(let W=0,X=0;W<T.length;W+=2){let q=T[W],Y=T[W+1];if(Y>=0){T[W]=Y,T[W+1]=q;let te=W>>1;for(;E.length<te;)E.push(Text.empty);E.push(q?_.slice(X,X+q):Text.empty)}X+=q}return new ChangeSet(T,E)}compose(_){return this.empty?_:_.empty?this:composeSets(this,_,!0)}map(_,T=!1){return _.empty?this:mapSet(this,_,T,!0)}iterChanges(_,T=!1){iterChanges(this,_,T)}get desc(){return ChangeDesc.create(this.sections)}filter(_){let T=[],E=[],W=[],X=new SectionIter(this);e:for(let q=0,Y=0;;){let te=q==_.length?1e9:_[q++];for(;Y<te||Y==te&&X.len==0;){if(X.done)break e;let ae=Math.min(X.len,te-Y);addSection(W,ae,-1);let le=X.ins==-1?-1:X.off==0?X.ins:0;addSection(T,ae,le),le>0&&addInsert(E,T,X.text),X.forward(ae),Y+=ae}let ne=_[q++];for(;Y<ne;){if(X.done)break e;let ae=Math.min(X.len,ne-Y);addSection(T,ae,-1),addSection(W,ae,X.ins==-1?-1:X.off==0?X.ins:0),X.forward(ae),Y+=ae}}return{changes:new ChangeSet(T,E),filtered:ChangeDesc.create(W)}}toJSON(){let _=[];for(let T=0;T<this.sections.length;T+=2){let E=this.sections[T],W=this.sections[T+1];W<0?_.push(E):W==0?_.push([E]):_.push([E].concat(this.inserted[T>>1].toJSON()))}return _}static of(_,T,E){let W=[],X=[],q=0,Y=null;function te(ae=!1){if(!ae&&!W.length)return;q<T&&addSection(W,T-q,-1);let le=new ChangeSet(W,X);Y=Y?Y.compose(le.map(Y)):le,W=[],X=[],q=0}function ne(ae){if(Array.isArray(ae))for(let le of ae)ne(le);else if(ae instanceof ChangeSet){if(ae.length!=T)throw new RangeError(`Mismatched change set length (got ${ae.length}, expected ${T})`);te(),Y=Y?Y.compose(ae.map(Y)):ae}else{let{from:le,to:ue=le,insert:ge}=ae;if(le>ue||le<0||ue>T)throw new RangeError(`Invalid change range ${le} to ${ue} (in doc of length ${T})`);let ye=ge?typeof ge=="string"?Text.of(ge.split(E||DefaultSplit)):ge:Text.empty,xe=ye.length;if(le==ue&&xe==0)return;le<q&&te(),le>q&&addSection(W,le-q,-1),addSection(W,ue-le,xe),addInsert(X,W,ye),q=ue}}return ne(_),te(!Y),Y}static empty(_){return new ChangeSet(_?[_,-1]:[],[])}static fromJSON(_){if(!Array.isArray(_))throw new RangeError("Invalid JSON representation of ChangeSet");let T=[],E=[];for(let W=0;W<_.length;W++){let X=_[W];if(typeof X=="number")T.push(X,-1);else{if(!Array.isArray(X)||typeof X[0]!="number"||X.some((q,Y)=>Y&&typeof q!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(X.length==1)T.push(X[0],0);else{for(;E.length<W;)E.push(Text.empty);E[W]=Text.of(X.slice(1)),T.push(X[0],E[W].length)}}}return new ChangeSet(T,E)}static createSet(_,T){return new ChangeSet(_,T)}}function addSection(B,_,T,E=!1){if(_==0&&T<=0)return;let W=B.length-2;W>=0&&T<=0&&T==B[W+1]?B[W]+=_:_==0&&B[W]==0?B[W+1]+=T:E?(B[W]+=_,B[W+1]+=T):B.push(_,T)}function addInsert(B,_,T){if(T.length==0)return;let E=_.length-2>>1;if(E<B.length)B[B.length-1]=B[B.length-1].append(T);else{for(;B.length<E;)B.push(Text.empty);B.push(T)}}function iterChanges(B,_,T){let E=B.inserted;for(let W=0,X=0,q=0;q<B.sections.length;){let Y=B.sections[q++],te=B.sections[q++];if(te<0)W+=Y,X+=Y;else{let ne=W,ae=X,le=Text.empty;for(;ne+=Y,ae+=te,te&&E&&(le=le.append(E[q-2>>1])),!(T||q==B.sections.length||B.sections[q+1]<0);)Y=B.sections[q++],te=B.sections[q++];_(W,ne,X,ae,le),W=ne,X=ae}}}function mapSet(B,_,T,E=!1){let W=[],X=E?[]:null,q=new SectionIter(B),Y=new SectionIter(_);for(let te=-1;;)if(q.ins==-1&&Y.ins==-1){let ne=Math.min(q.len,Y.len);addSection(W,ne,-1),q.forward(ne),Y.forward(ne)}else if(Y.ins>=0&&(q.ins<0||te==q.i||q.off==0&&(Y.len<q.len||Y.len==q.len&&!T))){let ne=Y.len;for(addSection(W,Y.ins,-1);ne;){let ae=Math.min(q.len,ne);q.ins>=0&&te<q.i&&q.len<=ae&&(addSection(W,0,q.ins),X&&addInsert(X,W,q.text),te=q.i),q.forward(ae),ne-=ae}Y.next()}else if(q.ins>=0){let ne=0,ae=q.len;for(;ae;)if(Y.ins==-1){let le=Math.min(ae,Y.len);ne+=le,ae-=le,Y.forward(le)}else if(Y.ins==0&&Y.len<ae)ae-=Y.len,Y.next();else break;addSection(W,ne,te<q.i?q.ins:0),X&&te<q.i&&addInsert(X,W,q.text),te=q.i,q.forward(q.len-ae)}else{if(q.done&&Y.done)return X?ChangeSet.createSet(W,X):ChangeDesc.create(W);throw new Error("Mismatched change set lengths")}}function composeSets(B,_,T=!1){let E=[],W=T?[]:null,X=new SectionIter(B),q=new SectionIter(_);for(let Y=!1;;){if(X.done&&q.done)return W?ChangeSet.createSet(E,W):ChangeDesc.create(E);if(X.ins==0)addSection(E,X.len,0,Y),X.next();else if(q.len==0&&!q.done)addSection(E,0,q.ins,Y),W&&addInsert(W,E,q.text),q.next();else{if(X.done||q.done)throw new Error("Mismatched change set lengths");{let te=Math.min(X.len2,q.len),ne=E.length;if(X.ins==-1){let ae=q.ins==-1?-1:q.off?0:q.ins;addSection(E,te,ae,Y),W&&ae&&addInsert(W,E,q.text)}else q.ins==-1?(addSection(E,X.off?0:X.len,te,Y),W&&addInsert(W,E,X.textBit(te))):(addSection(E,X.off?0:X.len,q.off?0:q.ins,Y),W&&!q.off&&addInsert(W,E,q.text));Y=(X.ins>te||q.ins>=0&&q.len>te)&&(Y||E.length>ne),X.forward2(te),q.forward(te)}}}}class SectionIter{constructor(_){this.set=_,this.i=0,this.next()}next(){let{sections:_}=this.set;this.i<_.length?(this.len=_[this.i++],this.ins=_[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:_}=this.set,T=this.i-2>>1;return T>=_.length?Text.empty:_[T]}textBit(_){let{inserted:T}=this.set,E=this.i-2>>1;return E>=T.length&&!_?Text.empty:T[E].slice(this.off,_==null?void 0:this.off+_)}forward(_){_==this.len?this.next():(this.len-=_,this.off+=_)}forward2(_){this.ins==-1?this.forward(_):_==this.ins?this.next():(this.ins-=_,this.off+=_)}}class SelectionRange{constructor(_,T,E){this.from=_,this.to=T,this.flags=E}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let _=this.flags&7;return _==7?null:_}get goalColumn(){let _=this.flags>>6;return _==16777215?void 0:_}map(_,T=-1){let E,W;return this.empty?E=W=_.mapPos(this.from,T):(E=_.mapPos(this.from,1),W=_.mapPos(this.to,-1)),E==this.from&&W==this.to?this:new SelectionRange(E,W,this.flags)}extend(_,T=_){if(_<=this.anchor&&T>=this.anchor)return EditorSelection.range(_,T);let E=Math.abs(_-this.anchor)>Math.abs(T-this.anchor)?_:T;return EditorSelection.range(this.anchor,E)}eq(_,T=!1){return this.anchor==_.anchor&&this.head==_.head&&(!T||!this.empty||this.assoc==_.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(_){if(!_||typeof _.anchor!="number"||typeof _.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(_.anchor,_.head)}static create(_,T,E){return new SelectionRange(_,T,E)}}class EditorSelection{constructor(_,T){this.ranges=_,this.mainIndex=T}map(_,T=-1){return _.empty?this:EditorSelection.create(this.ranges.map(E=>E.map(_,T)),this.mainIndex)}eq(_,T=!1){if(this.ranges.length!=_.ranges.length||this.mainIndex!=_.mainIndex)return!1;for(let E=0;E<this.ranges.length;E++)if(!this.ranges[E].eq(_.ranges[E],T))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0)}addRange(_,T=!0){return EditorSelection.create([_].concat(this.ranges),T?0:this.mainIndex+1)}replaceRange(_,T=this.mainIndex){let E=this.ranges.slice();return E[T]=_,EditorSelection.create(E,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(_=>_.toJSON()),main:this.mainIndex}}static fromJSON(_){if(!_||!Array.isArray(_.ranges)||typeof _.main!="number"||_.main>=_.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(_.ranges.map(T=>SelectionRange.fromJSON(T)),_.main)}static single(_,T=_){return new EditorSelection([EditorSelection.range(_,T)],0)}static create(_,T=0){if(_.length==0)throw new RangeError("A selection needs at least one range");for(let E=0,W=0;W<_.length;W++){let X=_[W];if(X.empty?X.from<=E:X.from<E)return EditorSelection.normalized(_.slice(),T);E=X.to}return new EditorSelection(_,T)}static cursor(_,T=0,E,W){return SelectionRange.create(_,_,(T==0?0:T<0?8:16)|(E==null?7:Math.min(6,E))|(W??16777215)<<6)}static range(_,T,E,W){let X=(E??16777215)<<6|(W==null?7:Math.min(6,W));return T<_?SelectionRange.create(T,_,48|X):SelectionRange.create(_,T,(T>_?8:0)|X)}static normalized(_,T=0){let E=_[T];_.sort((W,X)=>W.from-X.from),T=_.indexOf(E);for(let W=1;W<_.length;W++){let X=_[W],q=_[W-1];if(X.empty?X.from<=q.to:X.from<q.to){let Y=q.from,te=Math.max(X.to,q.to);W<=T&&T--,_.splice(--W,2,X.anchor>X.head?EditorSelection.range(te,Y):EditorSelection.range(Y,te))}}return new EditorSelection(_,T)}}function checkSelection(B,_){for(let T of B.ranges)if(T.to>_)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(_,T,E,W,X){this.combine=_,this.compareInput=T,this.compare=E,this.isStatic=W,this.id=nextID++,this.default=_([]),this.extensions=typeof X=="function"?X(this):X}get reader(){return this}static define(_={}){return new Facet(_.combine||(T=>T),_.compareInput||((T,E)=>T===E),_.compare||(_.combine?(T,E)=>T===E:sameArray$1),!!_.static,_.enables)}of(_){return new FacetProvider([],this,0,_)}compute(_,T){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(_,this,1,T)}computeN(_,T){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(_,this,2,T)}from(_,T){return T||(T=E=>E),this.compute([_],E=>T(E.field(_)))}}function sameArray$1(B,_){return B==_||B.length==_.length&&B.every((T,E)=>T===_[E])}class FacetProvider{constructor(_,T,E,W){this.dependencies=_,this.facet=T,this.type=E,this.value=W,this.id=nextID++}dynamicSlot(_){var T;let E=this.value,W=this.facet.compareInput,X=this.id,q=_[X]>>1,Y=this.type==2,te=!1,ne=!1,ae=[];for(let le of this.dependencies)le=="doc"?te=!0:le=="selection"?ne=!0:((T=_[le.id])!==null&&T!==void 0?T:1)&1||ae.push(_[le.id]);return{create(le){return le.values[q]=E(le),1},update(le,ue){if(te&&ue.docChanged||ne&&(ue.docChanged||ue.selection)||ensureAll(le,ae)){let ge=E(le);if(Y?!compareArray(ge,le.values[q],W):!W(ge,le.values[q]))return le.values[q]=ge,1}return 0},reconfigure:(le,ue)=>{let ge,ye=ue.config.address[X];if(ye!=null){let xe=getAddr(ue,ye);if(this.dependencies.every(Te=>Te instanceof Facet?ue.facet(Te)===le.facet(Te):Te instanceof StateField?ue.field(Te,!1)==le.field(Te,!1):!0)||(Y?compareArray(ge=E(le),xe,W):W(ge=E(le),xe)))return le.values[q]=xe,0}else ge=E(le);return le.values[q]=ge,1}}}}function compareArray(B,_,T){if(B.length!=_.length)return!1;for(let E=0;E<B.length;E++)if(!T(B[E],_[E]))return!1;return!0}function ensureAll(B,_){let T=!1;for(let E of _)ensureAddr(B,E)&1&&(T=!0);return T}function dynamicFacetSlot(B,_,T){let E=T.map(te=>B[te.id]),W=T.map(te=>te.type),X=E.filter(te=>!(te&1)),q=B[_.id]>>1;function Y(te){let ne=[];for(let ae=0;ae<E.length;ae++){let le=getAddr(te,E[ae]);if(W[ae]==2)for(let ue of le)ne.push(ue);else ne.push(le)}return _.combine(ne)}return{create(te){for(let ne of E)ensureAddr(te,ne);return te.values[q]=Y(te),1},update(te,ne){if(!ensureAll(te,X))return 0;let ae=Y(te);return _.compare(ae,te.values[q])?0:(te.values[q]=ae,1)},reconfigure(te,ne){let ae=ensureAll(te,E),le=ne.config.facets[_.id],ue=ne.facet(_);if(le&&!ae&&sameArray$1(T,le))return te.values[q]=ue,0;let ge=Y(te);return _.compare(ge,ue)?(te.values[q]=ue,0):(te.values[q]=ge,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(_,T,E,W,X){this.id=_,this.createF=T,this.updateF=E,this.compareF=W,this.spec=X,this.provides=void 0}static define(_){let T=new StateField(nextID++,_.create,_.update,_.compare||((E,W)=>E===W),_);return _.provide&&(T.provides=_.provide(T)),T}create(_){let T=_.facet(initField).find(E=>E.field==this);return((T==null?void 0:T.create)||this.createF)(_)}slot(_){let T=_[this.id]>>1;return{create:E=>(E.values[T]=this.create(E),1),update:(E,W)=>{let X=E.values[T],q=this.updateF(X,W);return this.compareF(X,q)?0:(E.values[T]=q,1)},reconfigure:(E,W)=>W.config.address[this.id]!=null?(E.values[T]=W.field(this),0):(E.values[T]=this.create(E),1)}}init(_){return[this,initField.of({field:this,create:_})]}get extension(){return this}}const Prec_={lowest:4,low:3,default:2,high:1,highest:0};function prec(B){return _=>new PrecExtension(_,B)}const Prec={highest:prec(Prec_.highest),high:prec(Prec_.high),default:prec(Prec_.default),low:prec(Prec_.low),lowest:prec(Prec_.lowest)};class PrecExtension{constructor(_,T){this.inner=_,this.prec=T}}class Compartment{of(_){return new CompartmentInstance(this,_)}reconfigure(_){return Compartment.reconfigure.of({compartment:this,extension:_})}get(_){return _.config.compartments.get(this)}}class CompartmentInstance{constructor(_,T){this.compartment=_,this.inner=T}}class Configuration{constructor(_,T,E,W,X,q){for(this.base=_,this.compartments=T,this.dynamicSlots=E,this.address=W,this.staticValues=X,this.facets=q,this.statusTemplate=[];this.statusTemplate.length<E.length;)this.statusTemplate.push(0)}staticFacet(_){let T=this.address[_.id];return T==null?_.default:this.staticValues[T>>1]}static resolve(_,T,E){let W=[],X=Object.create(null),q=new Map;for(let ue of flatten(_,T,q))ue instanceof StateField?W.push(ue):(X[ue.facet.id]||(X[ue.facet.id]=[])).push(ue);let Y=Object.create(null),te=[],ne=[];for(let ue of W)Y[ue.id]=ne.length<<1,ne.push(ge=>ue.slot(ge));let ae=E==null?void 0:E.config.facets;for(let ue in X){let ge=X[ue],ye=ge[0].facet,xe=ae&&ae[ue]||[];if(ge.every(Te=>Te.type==0))if(Y[ye.id]=te.length<<1|1,sameArray$1(xe,ge))te.push(E.facet(ye));else{let Te=ye.combine(ge.map(Ae=>Ae.value));te.push(E&&ye.compare(Te,E.facet(ye))?E.facet(ye):Te)}else{for(let Te of ge)Te.type==0?(Y[Te.id]=te.length<<1|1,te.push(Te.value)):(Y[Te.id]=ne.length<<1,ne.push(Ae=>Te.dynamicSlot(Ae)));Y[ye.id]=ne.length<<1,ne.push(Te=>dynamicFacetSlot(Te,ye,ge))}}let le=ne.map(ue=>ue(Y));return new Configuration(_,q,le,Y,te,X)}}function flatten(B,_,T){let E=[[],[],[],[],[]],W=new Map;function X(q,Y){let te=W.get(q);if(te!=null){if(te<=Y)return;let ne=E[te].indexOf(q);ne>-1&&E[te].splice(ne,1),q instanceof CompartmentInstance&&T.delete(q.compartment)}if(W.set(q,Y),Array.isArray(q))for(let ne of q)X(ne,Y);else if(q instanceof CompartmentInstance){if(T.has(q.compartment))throw new RangeError("Duplicate use of compartment in extensions");let ne=_.get(q.compartment)||q.inner;T.set(q.compartment,ne),X(ne,Y)}else if(q instanceof PrecExtension)X(q.inner,q.prec);else if(q instanceof StateField)E[Y].push(q),q.provides&&X(q.provides,Y);else if(q instanceof FacetProvider)E[Y].push(q),q.facet.extensions&&X(q.facet.extensions,Prec_.default);else{let ne=q.extension;if(!ne)throw new Error(`Unrecognized extension value in extension set (${q}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);X(ne,Y)}}return X(B,Prec_.default),E.reduce((q,Y)=>q.concat(Y))}function ensureAddr(B,_){if(_&1)return 2;let T=_>>1,E=B.status[T];if(E==4)throw new Error("Cyclic dependency between fields and/or facets");if(E&2)return E;B.status[T]=4;let W=B.computeSlot(B,B.config.dynamicSlots[T]);return B.status[T]=2|W}function getAddr(B,_){return _&1?B.config.staticValues[_>>1]:B.values[_>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:B=>B.some(_=>_),static:!0}),lineSeparator=Facet.define({combine:B=>B.length?B[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:B=>B.length?B[0]:!1});class Annotation{constructor(_,T){this.type=_,this.value=T}static define(){return new AnnotationType}}class AnnotationType{of(_){return new Annotation(this,_)}}class StateEffectType{constructor(_){this.map=_}of(_){return new StateEffect(this,_)}}class StateEffect{constructor(_,T){this.type=_,this.value=T}map(_){let T=this.type.map(this.value,_);return T===void 0?void 0:T==this.value?this:new StateEffect(this.type,T)}is(_){return this.type==_}static define(_={}){return new StateEffectType(_.map||(T=>T))}static mapEffects(_,T){if(!_.length)return _;let E=[];for(let W of _){let X=W.map(T);X&&E.push(X)}return E}}StateEffect.reconfigure=StateEffect.define();StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(_,T,E,W,X,q){this.startState=_,this.changes=T,this.selection=E,this.effects=W,this.annotations=X,this.scrollIntoView=q,this._doc=null,this._state=null,E&&checkSelection(E,T.newLength),X.some(Y=>Y.type==Transaction.time)||(this.annotations=X.concat(Transaction.time.of(Date.now())))}static create(_,T,E,W,X,q){return new Transaction(_,T,E,W,X,q)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(_){for(let T of this.annotations)if(T.type==_)return T.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(_){let T=this.annotation(Transaction.userEvent);return!!(T&&(T==_||T.length>_.length&&T.slice(0,_.length)==_&&T[_.length]=="."))}}Transaction.time=Annotation.define();Transaction.userEvent=Annotation.define();Transaction.addToHistory=Annotation.define();Transaction.remote=Annotation.define();function joinRanges(B,_){let T=[];for(let E=0,W=0;;){let X,q;if(E<B.length&&(W==_.length||_[W]>=B[E]))X=B[E++],q=B[E++];else if(W<_.length)X=_[W++],q=_[W++];else return T;!T.length||T[T.length-1]<X?T.push(X,q):T[T.length-1]<q&&(T[T.length-1]=q)}}function mergeTransaction(B,_,T){var E;let W,X,q;return T?(W=_.changes,X=ChangeSet.empty(_.changes.length),q=B.changes.compose(_.changes)):(W=_.changes.map(B.changes),X=B.changes.mapDesc(_.changes,!0),q=B.changes.compose(W)),{changes:q,selection:_.selection?_.selection.map(X):(E=B.selection)===null||E===void 0?void 0:E.map(W),effects:StateEffect.mapEffects(B.effects,W).concat(StateEffect.mapEffects(_.effects,X)),annotations:B.annotations.length?B.annotations.concat(_.annotations):_.annotations,scrollIntoView:B.scrollIntoView||_.scrollIntoView}}function resolveTransactionInner(B,_,T){let E=_.selection,W=asArray$1(_.annotations);return _.userEvent&&(W=W.concat(Transaction.userEvent.of(_.userEvent))),{changes:_.changes instanceof ChangeSet?_.changes:ChangeSet.of(_.changes||[],T,B.facet(lineSeparator)),selection:E&&(E instanceof EditorSelection?E:EditorSelection.single(E.anchor,E.head)),effects:asArray$1(_.effects),annotations:W,scrollIntoView:!!_.scrollIntoView}}function resolveTransaction(B,_,T){let E=resolveTransactionInner(B,_.length?_[0]:{},B.doc.length);_.length&&_[0].filter===!1&&(T=!1);for(let X=1;X<_.length;X++){_[X].filter===!1&&(T=!1);let q=!!_[X].sequential;E=mergeTransaction(E,resolveTransactionInner(B,_[X],q?E.changes.newLength:B.doc.length),q)}let W=Transaction.create(B,E.changes,E.selection,E.effects,E.annotations,E.scrollIntoView);return extendTransaction(T?filterTransaction(W):W)}function filterTransaction(B){let _=B.startState,T=!0;for(let W of _.facet(changeFilter)){let X=W(B);if(X===!1){T=!1;break}Array.isArray(X)&&(T=T===!0?X:joinRanges(T,X))}if(T!==!0){let W,X;if(T===!1)X=B.changes.invertedDesc,W=ChangeSet.empty(_.doc.length);else{let q=B.changes.filter(T);W=q.changes,X=q.filtered.mapDesc(q.changes).invertedDesc}B=Transaction.create(_,W,B.selection&&B.selection.map(X),StateEffect.mapEffects(B.effects,X),B.annotations,B.scrollIntoView)}let E=_.facet(transactionFilter);for(let W=E.length-1;W>=0;W--){let X=E[W](B);X instanceof Transaction?B=X:Array.isArray(X)&&X.length==1&&X[0]instanceof Transaction?B=X[0]:B=resolveTransaction(_,asArray$1(X),!1)}return B}function extendTransaction(B){let _=B.startState,T=_.facet(transactionExtender),E=B;for(let W=T.length-1;W>=0;W--){let X=T[W](B);X&&Object.keys(X).length&&(E=mergeTransaction(E,resolveTransactionInner(_,X,B.changes.newLength),!0))}return E==B?B:Transaction.create(_,B.changes,B.selection,E.effects,E.annotations,E.scrollIntoView)}const none$2=[];function asArray$1(B){return B==null?none$2:Array.isArray(B)?B:[B]}var CharCategory=function(B){return B[B.Word=0]="Word",B[B.Space=1]="Space",B[B.Other=2]="Other",B}(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function hasWordChar(B){if(wordChar)return wordChar.test(B);for(let _=0;_<B.length;_++){let T=B[_];if(/\w/.test(T)||T>""&&(T.toUpperCase()!=T.toLowerCase()||nonASCIISingleCaseWordChar.test(T)))return!0}return!1}function makeCategorizer(B){return _=>{if(!/\S/.test(_))return CharCategory.Space;if(hasWordChar(_))return CharCategory.Word;for(let T=0;T<B.length;T++)if(_.indexOf(B[T])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(_,T,E,W,X,q){this.config=_,this.doc=T,this.selection=E,this.values=W,this.status=_.statusTemplate.slice(),this.computeSlot=X,q&&(q._state=this);for(let Y=0;Y<this.config.dynamicSlots.length;Y++)ensureAddr(this,Y<<1);this.computeSlot=null}field(_,T=!0){let E=this.config.address[_.id];if(E==null){if(T)throw new RangeError("Field is not present in this state");return}return ensureAddr(this,E),getAddr(this,E)}update(..._){return resolveTransaction(this,_,!0)}applyTransaction(_){let T=this.config,{base:E,compartments:W}=T;for(let Y of _.effects)Y.is(Compartment.reconfigure)?(T&&(W=new Map,T.compartments.forEach((te,ne)=>W.set(ne,te)),T=null),W.set(Y.value.compartment,Y.value.extension)):Y.is(StateEffect.reconfigure)?(T=null,E=Y.value):Y.is(StateEffect.appendConfig)&&(T=null,E=asArray$1(E).concat(Y.value));let X;T?X=_.startState.values.slice():(T=Configuration.resolve(E,W,this),X=new EditorState(T,this.doc,this.selection,T.dynamicSlots.map(()=>null),(te,ne)=>ne.reconfigure(te,this),null).values);let q=_.startState.facet(allowMultipleSelections)?_.newSelection:_.newSelection.asSingle();new EditorState(T,_.newDoc,q,X,(Y,te)=>te.update(Y,_),_)}replaceSelection(_){return typeof _=="string"&&(_=this.toText(_)),this.changeByRange(T=>({changes:{from:T.from,to:T.to,insert:_},range:EditorSelection.cursor(T.from+_.length)}))}changeByRange(_){let T=this.selection,E=_(T.ranges[0]),W=this.changes(E.changes),X=[E.range],q=asArray$1(E.effects);for(let Y=1;Y<T.ranges.length;Y++){let te=_(T.ranges[Y]),ne=this.changes(te.changes),ae=ne.map(W);for(let ue=0;ue<Y;ue++)X[ue]=X[ue].map(ae);let le=W.mapDesc(ne,!0);X.push(te.range.map(le)),W=W.compose(ae),q=StateEffect.mapEffects(q,ae).concat(StateEffect.mapEffects(asArray$1(te.effects),le))}return{changes:W,selection:EditorSelection.create(X,T.mainIndex),effects:q}}changes(_=[]){return _ instanceof ChangeSet?_:ChangeSet.of(_,this.doc.length,this.facet(EditorState.lineSeparator))}toText(_){return Text.of(_.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(_=0,T=this.doc.length){return this.doc.sliceString(_,T,this.lineBreak)}facet(_){let T=this.config.address[_.id];return T==null?_.default:(ensureAddr(this,T),getAddr(this,T))}toJSON(_){let T={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(_)for(let E in _){let W=_[E];W instanceof StateField&&this.config.address[W.id]!=null&&(T[E]=W.spec.toJSON(this.field(_[E]),this))}return T}static fromJSON(_,T={},E){if(!_||typeof _.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let W=[];if(E){for(let X in E)if(Object.prototype.hasOwnProperty.call(_,X)){let q=E[X],Y=_[X];W.push(q.init(te=>q.spec.fromJSON(Y,te)))}}return EditorState.create({doc:_.doc,selection:EditorSelection.fromJSON(_.selection),extensions:T.extensions?W.concat([T.extensions]):W})}static create(_={}){let T=Configuration.resolve(_.extensions||[],new Map),E=_.doc instanceof Text?_.doc:Text.of((_.doc||"").split(T.staticFacet(EditorState.lineSeparator)||DefaultSplit)),W=_.selection?_.selection instanceof EditorSelection?_.selection:EditorSelection.single(_.selection.anchor,_.selection.head):EditorSelection.single(0);return checkSelection(W,E.length),T.staticFacet(allowMultipleSelections)||(W=W.asSingle()),new EditorState(T,E,W,T.dynamicSlots.map(()=>null),(X,q)=>q.create(X),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||`
`}get readOnly(){return this.facet(readOnly)}phrase(_,...T){for(let E of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(E,_)){_=E[_];break}return T.length&&(_=_.replace(/\$(\$|\d*)/g,(E,W)=>{if(W=="$")return"$";let X=+(W||1);return!X||X>T.length?E:T[X-1]})),_}languageDataAt(_,T,E=-1){let W=[];for(let X of this.facet(languageData))for(let q of X(this,T,E))Object.prototype.hasOwnProperty.call(q,_)&&W.push(q[_]);return W}charCategorizer(_){return makeCategorizer(this.languageDataAt("wordChars",_).join(""))}wordAt(_){let{text:T,from:E,length:W}=this.doc.lineAt(_),X=this.charCategorizer(_),q=_-E,Y=_-E;for(;q>0;){let te=findClusterBreak(T,q,!1);if(X(T.slice(te,q))!=CharCategory.Word)break;q=te}for(;Y<W;){let te=findClusterBreak(T,Y);if(X(T.slice(Y,te))!=CharCategory.Word)break;Y=te}return q==Y?null:EditorSelection.range(q+E,Y+E)}}EditorState.allowMultipleSelections=allowMultipleSelections;EditorState.tabSize=Facet.define({combine:B=>B.length?B[0]:4});EditorState.lineSeparator=lineSeparator;EditorState.readOnly=readOnly;EditorState.phrases=Facet.define({compare(B,_){let T=Object.keys(B),E=Object.keys(_);return T.length==E.length&&T.every(W=>B[W]==_[W])}});EditorState.languageData=languageData;EditorState.changeFilter=changeFilter;EditorState.transactionFilter=transactionFilter;EditorState.transactionExtender=transactionExtender;Compartment.reconfigure=StateEffect.define();function combineConfig(B,_,T={}){let E={};for(let W of B)for(let X of Object.keys(W)){let q=W[X],Y=E[X];if(Y===void 0)E[X]=q;else if(!(Y===q||q===void 0))if(Object.hasOwnProperty.call(T,X))E[X]=T[X](Y,q);else throw new Error("Config merge conflict for field "+X)}for(let W in _)E[W]===void 0&&(E[W]=_[W]);return E}class RangeValue{eq(_){return this==_}range(_,T=_){return Range$1.create(_,T,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=!1;RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class mg{constructor(_,T,E){this.from=_,this.to=T,this.value=E}static create(_,T,E){return new mg(_,T,E)}};function cmpRange(B,_){return B.from-_.from||B.value.startSide-_.value.startSide}class Chunk{constructor(_,T,E,W){this.from=_,this.to=T,this.value=E,this.maxPoint=W}get length(){return this.to[this.to.length-1]}findIndex(_,T,E,W=0){let X=E?this.to:this.from;for(let q=W,Y=X.length;;){if(q==Y)return q;let te=q+Y>>1,ne=X[te]-_||(E?this.value[te].endSide:this.value[te].startSide)-T;if(te==q)return ne>=0?q:Y;ne>=0?Y=te:q=te+1}}between(_,T,E,W){for(let X=this.findIndex(T,-1e9,!0),q=this.findIndex(E,1e9,!1,X);X<q;X++)if(W(this.from[X]+_,this.to[X]+_,this.value[X])===!1)return!1}map(_,T){let E=[],W=[],X=[],q=-1,Y=-1;for(let te=0;te<this.value.length;te++){let ne=this.value[te],ae=this.from[te]+_,le=this.to[te]+_,ue,ge;if(ae==le){let ye=T.mapPos(ae,ne.startSide,ne.mapMode);if(ye==null||(ue=ge=ye,ne.startSide!=ne.endSide&&(ge=T.mapPos(ae,ne.endSide),ge<ue)))continue}else if(ue=T.mapPos(ae,ne.startSide),ge=T.mapPos(le,ne.endSide),ue>ge||ue==ge&&ne.startSide>0&&ne.endSide<=0)continue;(ge-ue||ne.endSide-ne.startSide)<0||(q<0&&(q=ue),ne.point&&(Y=Math.max(Y,ge-ue)),E.push(ne),W.push(ue-q),X.push(ge-q))}return{mapped:E.length?new Chunk(W,X,E,Y):null,pos:q}}}class RangeSet{constructor(_,T,E,W){this.chunkPos=_,this.chunk=T,this.nextLayer=E,this.maxPoint=W}static create(_,T,E,W){return new RangeSet(_,T,E,W)}get length(){let _=this.chunk.length-1;return _<0?0:Math.max(this.chunkEnd(_),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let _=this.nextLayer.size;for(let T of this.chunk)_+=T.value.length;return _}chunkEnd(_){return this.chunkPos[_]+this.chunk[_].length}update(_){let{add:T=[],sort:E=!1,filterFrom:W=0,filterTo:X=this.length}=_,q=_.filter;if(T.length==0&&!q)return this;if(E&&(T=T.slice().sort(cmpRange)),this.isEmpty)return T.length?RangeSet.of(T):this;let Y=new LayerCursor(this,null,-1).goto(0),te=0,ne=[],ae=new RangeSetBuilder;for(;Y.value||te<T.length;)if(te<T.length&&(Y.from-T[te].from||Y.startSide-T[te].value.startSide)>=0){let le=T[te++];ae.addInner(le.from,le.to,le.value)||ne.push(le)}else Y.rangeIndex==1&&Y.chunkIndex<this.chunk.length&&(te==T.length||this.chunkEnd(Y.chunkIndex)<T[te].from)&&(!q||W>this.chunkEnd(Y.chunkIndex)||X<this.chunkPos[Y.chunkIndex])&&ae.addChunk(this.chunkPos[Y.chunkIndex],this.chunk[Y.chunkIndex])?Y.nextChunk():((!q||W>Y.to||X<Y.from||q(Y.from,Y.to,Y.value))&&(ae.addInner(Y.from,Y.to,Y.value)||ne.push(Range$1.create(Y.from,Y.to,Y.value))),Y.next());return ae.finishInner(this.nextLayer.isEmpty&&!ne.length?RangeSet.empty:this.nextLayer.update({add:ne,filter:q,filterFrom:W,filterTo:X}))}map(_){if(_.empty||this.isEmpty)return this;let T=[],E=[],W=-1;for(let q=0;q<this.chunk.length;q++){let Y=this.chunkPos[q],te=this.chunk[q],ne=_.touchesRange(Y,Y+te.length);if(ne===!1)W=Math.max(W,te.maxPoint),T.push(te),E.push(_.mapPos(Y));else if(ne===!0){let{mapped:ae,pos:le}=te.map(Y,_);ae&&(W=Math.max(W,ae.maxPoint),T.push(ae),E.push(le))}}let X=this.nextLayer.map(_);return T.length==0?X:new RangeSet(E,T,X||RangeSet.empty,W)}between(_,T,E){if(!this.isEmpty){for(let W=0;W<this.chunk.length;W++){let X=this.chunkPos[W],q=this.chunk[W];if(T>=X&&_<=X+q.length&&q.between(X,_-X,T-X,E)===!1)return}this.nextLayer.between(_,T,E)}}iter(_=0){return HeapCursor.from([this]).goto(_)}get isEmpty(){return this.nextLayer==this}static iter(_,T=0){return HeapCursor.from(_).goto(T)}static compare(_,T,E,W,X=-1){let q=_.filter(le=>le.maxPoint>0||!le.isEmpty&&le.maxPoint>=X),Y=T.filter(le=>le.maxPoint>0||!le.isEmpty&&le.maxPoint>=X),te=findSharedChunks(q,Y,E),ne=new SpanCursor(q,te,X),ae=new SpanCursor(Y,te,X);E.iterGaps((le,ue,ge)=>compare(ne,le,ae,ue,ge,W)),E.empty&&E.length==0&&compare(ne,0,ae,0,0,W)}static eq(_,T,E=0,W){W==null&&(W=999999999);let X=_.filter(ae=>!ae.isEmpty&&T.indexOf(ae)<0),q=T.filter(ae=>!ae.isEmpty&&_.indexOf(ae)<0);if(X.length!=q.length)return!1;if(!X.length)return!0;let Y=findSharedChunks(X,q),te=new SpanCursor(X,Y,0).goto(E),ne=new SpanCursor(q,Y,0).goto(E);for(;;){if(te.to!=ne.to||!sameValues(te.active,ne.active)||te.point&&(!ne.point||!te.point.eq(ne.point)))return!1;if(te.to>W)return!0;te.next(),ne.next()}}static spans(_,T,E,W,X=-1){let q=new SpanCursor(_,null,X).goto(T),Y=T,te=q.openStart;for(;;){let ne=Math.min(q.to,E);if(q.point){let ae=q.activeForPoint(q.to),le=q.pointFrom<T?ae.length+1:q.point.startSide<0?ae.length:Math.min(ae.length,te);W.point(Y,ne,q.point,ae,le,q.pointRank),te=Math.min(q.openEnd(ne),ae.length)}else ne>Y&&(W.span(Y,ne,q.active,te),te=q.openEnd(ne));if(q.to>E)return te+(q.point&&q.to>E?1:0);Y=q.to,q.next()}}static of(_,T=!1){let E=new RangeSetBuilder;for(let W of _ instanceof Range$1?[_]:T?lazySort(_):_)E.add(W.from,W.to,W.value);return E.finish()}static join(_){if(!_.length)return RangeSet.empty;let T=_[_.length-1];for(let E=_.length-2;E>=0;E--)for(let W=_[E];W!=RangeSet.empty;W=W.nextLayer)T=new RangeSet(W.chunkPos,W.chunk,T,Math.max(W.maxPoint,T.maxPoint));return T}}RangeSet.empty=new RangeSet([],[],null,-1);function lazySort(B){if(B.length>1)for(let _=B[0],T=1;T<B.length;T++){let E=B[T];if(cmpRange(_,E)>0)return B.slice().sort(cmpRange);_=E}return B}RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{finishChunk(_){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,_&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(_,T,E){this.addInner(_,T,E)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(_,T,E)}addInner(_,T,E){let W=_-this.lastTo||E.startSide-this.last.endSide;if(W<=0&&(_-this.lastFrom||E.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return W<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=_),this.from.push(_-this.chunkStart),this.to.push(T-this.chunkStart),this.last=E,this.lastFrom=_,this.lastTo=T,this.value.push(E),E.point&&(this.maxPoint=Math.max(this.maxPoint,T-_)),!0)}addChunk(_,T){if((_-this.lastTo||T.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,T.maxPoint),this.chunks.push(T),this.chunkPos.push(_);let E=T.value.length-1;return this.last=T.value[E],this.lastFrom=T.from[E]+_,this.lastTo=T.to[E]+_,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(_){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return _;let T=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(_):_,this.setMaxPoint);return this.from=null,T}}function findSharedChunks(B,_,T){let E=new Map;for(let X of B)for(let q=0;q<X.chunk.length;q++)X.chunk[q].maxPoint<=0&&E.set(X.chunk[q],X.chunkPos[q]);let W=new Set;for(let X of _)for(let q=0;q<X.chunk.length;q++){let Y=E.get(X.chunk[q]);Y!=null&&(T?T.mapPos(Y):Y)==X.chunkPos[q]&&!(T!=null&&T.touchesRange(Y,Y+X.chunk[q].length))&&W.add(X.chunk[q])}return W}class LayerCursor{constructor(_,T,E,W=0){this.layer=_,this.skip=T,this.minPoint=E,this.rank=W}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(_,T=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(_,T,!1),this}gotoInner(_,T,E){for(;this.chunkIndex<this.layer.chunk.length;){let W=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(W)||this.layer.chunkEnd(this.chunkIndex)<_||W.maxPoint<this.minPoint))break;this.chunkIndex++,E=!1}if(this.chunkIndex<this.layer.chunk.length){let W=this.layer.chunk[this.chunkIndex].findIndex(_-this.layer.chunkPos[this.chunkIndex],T,!0);(!E||this.rangeIndex<W)&&this.setRangeIndex(W)}this.next()}forward(_,T){(this.to-_||this.endSide-T)<0&&this.gotoInner(_,T,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let _=this.layer.chunkPos[this.chunkIndex],T=this.layer.chunk[this.chunkIndex],E=_+T.from[this.rangeIndex];if(this.from=E,this.to=_+T.to[this.rangeIndex],this.value=T.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(_){if(_==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=_}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(_){return this.from-_.from||this.startSide-_.startSide||this.rank-_.rank||this.to-_.to||this.endSide-_.endSide}}class HeapCursor{constructor(_){this.heap=_}static from(_,T=null,E=-1){let W=[];for(let X=0;X<_.length;X++)for(let q=_[X];!q.isEmpty;q=q.nextLayer)q.maxPoint>=E&&W.push(new LayerCursor(q,T,E,X));return W.length==1?W[0]:new HeapCursor(W)}get startSide(){return this.value?this.value.startSide:0}goto(_,T=-1e9){for(let E of this.heap)E.goto(_,T);for(let E=this.heap.length>>1;E>=0;E--)heapBubble(this.heap,E);return this.next(),this}forward(_,T){for(let E of this.heap)E.forward(_,T);for(let E=this.heap.length>>1;E>=0;E--)heapBubble(this.heap,E);(this.to-_||this.value.endSide-T)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let _=this.heap[0];this.from=_.from,this.to=_.to,this.value=_.value,this.rank=_.rank,_.value&&_.next(),heapBubble(this.heap,0)}}}function heapBubble(B,_){for(let T=B[_];;){let E=(_<<1)+1;if(E>=B.length)break;let W=B[E];if(E+1<B.length&&W.compare(B[E+1])>=0&&(W=B[E+1],E++),T.compare(W)<0)break;B[E]=T,B[_]=W,_=E}}class SpanCursor{constructor(_,T,E){this.minPoint=E,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(_,T,E)}goto(_,T=-1e9){return this.cursor.goto(_,T),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=_,this.endSide=T,this.openStart=-1,this.next(),this}forward(_,T){for(;this.minActive>-1&&(this.activeTo[this.minActive]-_||this.active[this.minActive].endSide-T)<0;)this.removeActive(this.minActive);this.cursor.forward(_,T)}removeActive(_){remove$1(this.active,_),remove$1(this.activeTo,_),remove$1(this.activeRank,_),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(_){let T=0,{value:E,to:W,rank:X}=this.cursor;for(;T<this.activeRank.length&&(X-this.activeRank[T]||W-this.activeTo[T])>0;)T++;insert(this.active,T,E),insert(this.activeTo,T,W),insert(this.activeRank,T,X),_&&insert(_,T,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let _=this.to,T=this.point;this.point=null;let E=this.openStart<0?[]:null;for(;;){let W=this.minActive;if(W>-1&&(this.activeTo[W]-this.cursor.from||this.active[W].endSide-this.cursor.startSide)<0){if(this.activeTo[W]>_){this.to=this.activeTo[W],this.endSide=this.active[W].endSide;break}this.removeActive(W),E&&remove$1(E,W)}else if(this.cursor.value)if(this.cursor.from>_){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let X=this.cursor.value;if(!X.point)this.addActive(E),this.cursor.next();else if(T&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=X,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=X.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(E){this.openStart=0;for(let W=E.length-1;W>=0&&E[W]<_;W--)this.openStart++}}activeForPoint(_){if(!this.active.length)return this.active;let T=[];for(let E=this.active.length-1;E>=0&&!(this.activeRank[E]<this.pointRank);E--)(this.activeTo[E]>_||this.activeTo[E]==_&&this.active[E].endSide>=this.point.endSide)&&T.push(this.active[E]);return T.reverse()}openEnd(_){let T=0;for(let E=this.activeTo.length-1;E>=0&&this.activeTo[E]>_;E--)T++;return T}}function compare(B,_,T,E,W,X){B.goto(_),T.goto(E);let q=E+W,Y=E,te=E-_;for(;;){let ne=B.to+te-T.to||B.endSide-T.endSide,ae=ne<0?B.to+te:T.to,le=Math.min(ae,q);if(B.point||T.point?B.point&&T.point&&(B.point==T.point||B.point.eq(T.point))&&sameValues(B.activeForPoint(B.to),T.activeForPoint(T.to))||X.comparePoint(Y,le,B.point,T.point):le>Y&&!sameValues(B.active,T.active)&&X.compareRange(Y,le,B.active,T.active),ae>q)break;Y=ae,ne<=0&&B.next(),ne>=0&&T.next()}}function sameValues(B,_){if(B.length!=_.length)return!1;for(let T=0;T<B.length;T++)if(B[T]!=_[T]&&!B[T].eq(_[T]))return!1;return!0}function remove$1(B,_){for(let T=_,E=B.length-1;T<E;T++)B[T]=B[T+1];B.pop()}function insert(B,_,T){for(let E=B.length-1;E>=_;E--)B[E+1]=B[E];B[_]=T}function findMinIndex(B,_){let T=-1,E=1e9;for(let W=0;W<_.length;W++)(_[W]-E||B[W].endSide-B[T].endSide)<0&&(T=W,E=_[W]);return T}function countColumn(B,_,T=B.length){let E=0;for(let W=0;W<T;)B.charCodeAt(W)==9?(E+=_-E%_,W++):(E++,W=findClusterBreak(B,W));return E}function findColumn(B,_,T,E){for(let W=0,X=0;;){if(X>=_)return W;if(W==B.length)break;X+=B.charCodeAt(W)==9?T-X%T:1,W=findClusterBreak(B,W)}return E===!0?-1:B.length}const C="",COUNT=typeof Symbol>"u"?"__"+C:Symbol.for(C),SET=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),top=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class StyleModule{constructor(_,T){this.rules=[];let{finish:E}=T||{};function W(q){return/^@/.test(q)?[q]:q.split(/,\s*/)}function X(q,Y,te,ne){let ae=[],le=/^@(\w+)\b/.exec(q[0]),ue=le&&le[1]=="keyframes";if(le&&Y==null)return te.push(q[0]+";");for(let ge in Y){let ye=Y[ge];if(/&/.test(ge))X(ge.split(/,\s*/).map(xe=>q.map(Te=>xe.replace(/&/,Te))).reduce((xe,Te)=>xe.concat(Te)),ye,te);else if(ye&&typeof ye=="object"){if(!le)throw new RangeError("The value of a property ("+ge+") should be a primitive value.");X(W(ge),ye,ae,ue)}else ye!=null&&ae.push(ge.replace(/_.*/,"").replace(/[A-Z]/g,xe=>"-"+xe.toLowerCase())+": "+ye+";")}(ae.length||ue)&&te.push((E&&!le&&!ne?q.map(E):q).join(", ")+" {"+ae.join(" ")+"}")}for(let q in _)X(W(q),_[q],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let _=top[COUNT]||1;return top[COUNT]=_+1,C+_.toString(36)}static mount(_,T,E){let W=_[SET],X=E&&E.nonce;W?X&&W.setNonce(X):W=new StyleSet(_,X),W.mount(Array.isArray(T)?T:[T],_)}}let adoptedSet=new Map;class StyleSet{constructor(_,T){let E=_.ownerDocument||_,W=E.defaultView;if(!_.head&&_.adoptedStyleSheets&&W.CSSStyleSheet){let X=adoptedSet.get(E);if(X)return _[SET]=X;this.sheet=new W.CSSStyleSheet,adoptedSet.set(E,this)}else this.styleTag=E.createElement("style"),T&&this.styleTag.setAttribute("nonce",T);this.modules=[],_[SET]=this}mount(_,T){let E=this.sheet,W=0,X=0;for(let q=0;q<_.length;q++){let Y=_[q],te=this.modules.indexOf(Y);if(te<X&&te>-1&&(this.modules.splice(te,1),X--,te=-1),te==-1){if(this.modules.splice(X++,0,Y),E)for(let ne=0;ne<Y.rules.length;ne++)E.insertRule(Y.rules[ne],W++)}else{for(;X<te;)W+=this.modules[X++].rules.length;W+=Y.rules.length,X++}}if(E)T.adoptedStyleSheets.indexOf(this.sheet)<0&&(T.adoptedStyleSheets=[this.sheet,...T.adoptedStyleSheets]);else{let q="";for(let te=0;te<this.modules.length;te++)q+=this.modules[te].getRules()+`
`;this.styleTag.textContent=q;let Y=T.head||T;this.styleTag.parentNode!=Y&&Y.insertBefore(this.styleTag,Y.firstChild)}}setNonce(_){this.styleTag&&this.styleTag.getAttribute("nonce")!=_&&this.styleTag.setAttribute("nonce",_)}}var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift$1={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac=typeof navigator<"u"&&/Mac/.test(navigator.platform),ie$2=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(var i=1;i<=24;i++)base[i+111]="F"+i;for(var i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift$1[i]=String.fromCharCode(i);for(var code in base)shift$1.hasOwnProperty(code)||(shift$1[code]=base[code]);function keyName(B){var _=mac&&B.metaKey&&B.shiftKey&&!B.ctrlKey&&!B.altKey||ie$2&&B.shiftKey&&B.key&&B.key.length==1||B.key=="Unidentified",T=!_&&B.key||(B.shiftKey?shift$1:base)[B.keyCode]||B.key||"Unidentified";return T=="Esc"&&(T="Escape"),T=="Del"&&(T="Delete"),T=="Left"&&(T="ArrowLeft"),T=="Up"&&(T="ArrowUp"),T=="Right"&&(T="ArrowRight"),T=="Down"&&(T="ArrowDown"),T}function getSelection(B){let _;return B.nodeType==11?_=B.getSelection?B:B.ownerDocument:_=B,_.getSelection()}function contains(B,_){return _?B==_||B.contains(_.nodeType!=1?_.parentNode:_):!1}function deepActiveElement(B){let _=B.activeElement;for(;_&&_.shadowRoot;)_=_.shadowRoot.activeElement;return _}function hasSelection(B,_){if(!_.anchorNode)return!1;try{return contains(B,_.anchorNode)}catch{return!1}}function clientRectsFor(B){return B.nodeType==3?textRange(B,0,B.nodeValue.length).getClientRects():B.nodeType==1?B.getClientRects():[]}function isEquivalentPosition(B,_,T,E){return T?scanFor(B,_,T,E,-1)||scanFor(B,_,T,E,1):!1}function domIndex(B){for(var _=0;;_++)if(B=B.previousSibling,!B)return _}function isBlockElement(B){return B.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(B.nodeName)}function scanFor(B,_,T,E,W){for(;;){if(B==T&&_==E)return!0;if(_==(W<0?0:maxOffset(B))){if(B.nodeName=="DIV")return!1;let X=B.parentNode;if(!X||X.nodeType!=1)return!1;_=domIndex(B)+(W<0?0:1),B=X}else if(B.nodeType==1){if(B=B.childNodes[_+(W<0?-1:0)],B.nodeType==1&&B.contentEditable=="false")return!1;_=W<0?maxOffset(B):0}else return!1}}function maxOffset(B){return B.nodeType==3?B.nodeValue.length:B.childNodes.length}function flattenRect(B,_){let T=_?B.left:B.right;return{left:T,right:T,top:B.top,bottom:B.bottom}}function windowRect(B){let _=B.visualViewport;return _?{left:0,right:_.width,top:0,bottom:_.height}:{left:0,right:B.innerWidth,top:0,bottom:B.innerHeight}}function getScale(B,_){let T=_.width/B.offsetWidth,E=_.height/B.offsetHeight;return(T>.995&&T<1.005||!isFinite(T)||Math.abs(_.width-B.offsetWidth)<1)&&(T=1),(E>.995&&E<1.005||!isFinite(E)||Math.abs(_.height-B.offsetHeight)<1)&&(E=1),{scaleX:T,scaleY:E}}function scrollRectIntoView(B,_,T,E,W,X,q,Y){let te=B.ownerDocument,ne=te.defaultView||window;for(let ae=B,le=!1;ae&&!le;)if(ae.nodeType==1){let ue,ge=ae==te.body,ye=1,xe=1;if(ge)ue=windowRect(ne);else{if(/^(fixed|sticky)$/.test(getComputedStyle(ae).position)&&(le=!0),ae.scrollHeight<=ae.clientHeight&&ae.scrollWidth<=ae.clientWidth){ae=ae.assignedSlot||ae.parentNode;continue}let Ie=ae.getBoundingClientRect();({scaleX:ye,scaleY:xe}=getScale(ae,Ie)),ue={left:Ie.left,right:Ie.left+ae.clientWidth*ye,top:Ie.top,bottom:Ie.top+ae.clientHeight*xe}}let Te=0,Ae=0;if(W=="nearest")_.top<ue.top?(Ae=-(ue.top-_.top+q),T>0&&_.bottom>ue.bottom+Ae&&(Ae=_.bottom-ue.bottom+Ae+q)):_.bottom>ue.bottom&&(Ae=_.bottom-ue.bottom+q,T<0&&_.top-Ae<ue.top&&(Ae=-(ue.top+Ae-_.top+q)));else{let Ie=_.bottom-_.top,Ve=ue.bottom-ue.top;Ae=(W=="center"&&Ie<=Ve?_.top+Ie/2-Ve/2:W=="start"||W=="center"&&T<0?_.top-q:_.bottom-Ve+q)-ue.top}if(E=="nearest"?_.left<ue.left?(Te=-(ue.left-_.left+X),T>0&&_.right>ue.right+Te&&(Te=_.right-ue.right+Te+X)):_.right>ue.right&&(Te=_.right-ue.right+X,T<0&&_.left<ue.left+Te&&(Te=-(ue.left+Te-_.left+X))):Te=(E=="center"?_.left+(_.right-_.left)/2-(ue.right-ue.left)/2:E=="start"==Y?_.left-X:_.right-(ue.right-ue.left)+X)-ue.left,Te||Ae)if(ge)ne.scrollBy(Te,Ae);else{let Ie=0,Ve=0;if(Ae){let $e=ae.scrollTop;ae.scrollTop+=Ae/xe,Ve=(ae.scrollTop-$e)*xe}if(Te){let $e=ae.scrollLeft;ae.scrollLeft+=Te/ye,Ie=(ae.scrollLeft-$e)*ye}_={left:_.left-Ie,top:_.top-Ve,right:_.right-Ie,bottom:_.bottom-Ve},Ie&&Math.abs(Ie-Te)<1&&(E="nearest"),Ve&&Math.abs(Ve-Ae)<1&&(W="nearest")}if(ge)break;ae=ae.assignedSlot||ae.parentNode}else if(ae.nodeType==11)ae=ae.host;else break}function scrollableParents(B){let _=B.ownerDocument,T,E;for(let W=B.parentNode;W&&!(W==_.body||T&&E);)if(W.nodeType==1)!E&&W.scrollHeight>W.clientHeight&&(E=W),!T&&W.scrollWidth>W.clientWidth&&(T=W),W=W.assignedSlot||W.parentNode;else if(W.nodeType==11)W=W.host;else break;return{x:T,y:E}}class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(_){return this.anchorNode==_.anchorNode&&this.anchorOffset==_.anchorOffset&&this.focusNode==_.focusNode&&this.focusOffset==_.focusOffset}setRange(_){let{anchorNode:T,focusNode:E}=_;this.set(T,Math.min(_.anchorOffset,T?maxOffset(T):0),E,Math.min(_.focusOffset,E?maxOffset(E):0))}set(_,T,E,W){this.anchorNode=_,this.anchorOffset=T,this.focusNode=E,this.focusOffset=W}}let preventScrollSupported=null;function focusPreventScroll(B){if(B.setActive)return B.setActive();if(preventScrollSupported)return B.focus(preventScrollSupported);let _=[];for(let T=B;T&&(_.push(T,T.scrollTop,T.scrollLeft),T!=T.ownerDocument);T=T.parentNode);if(B.focus(preventScrollSupported==null?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let T=0;T<_.length;){let E=_[T++],W=_[T++],X=_[T++];E.scrollTop!=W&&(E.scrollTop=W),E.scrollLeft!=X&&(E.scrollLeft=X)}}}let scratchRange;function textRange(B,_,T=_){let E=scratchRange||(scratchRange=document.createRange());return E.setEnd(B,T),E.setStart(B,_),E}function dispatchKey(B,_,T,E){let W={key:_,code:_,keyCode:T,which:T,cancelable:!0};E&&({altKey:W.altKey,ctrlKey:W.ctrlKey,shiftKey:W.shiftKey,metaKey:W.metaKey}=E);let X=new KeyboardEvent("keydown",W);X.synthetic=!0,B.dispatchEvent(X);let q=new KeyboardEvent("keyup",W);return q.synthetic=!0,B.dispatchEvent(q),X.defaultPrevented||q.defaultPrevented}function getRoot(B){for(;B;){if(B&&(B.nodeType==9||B.nodeType==11&&B.host))return B;B=B.assignedSlot||B.parentNode}return null}function clearAttributes(B){for(;B.attributes.length;)B.removeAttributeNode(B.attributes[0])}function atElementStart(B,_){let T=_.focusNode,E=_.focusOffset;if(!T||_.anchorNode!=T||_.anchorOffset!=E)return!1;for(E=Math.min(E,maxOffset(T));;)if(E){if(T.nodeType!=1)return!1;let W=T.childNodes[E-1];W.contentEditable=="false"?E--:(T=W,E=maxOffset(T))}else{if(T==B)return!0;E=domIndex(T),T=T.parentNode}}function isScrolledToBottom(B){return B.scrollTop>Math.max(1,B.scrollHeight-B.clientHeight-4)}function textNodeBefore(B,_){for(let T=B,E=_;;){if(T.nodeType==3&&E>0)return{node:T,offset:E};if(T.nodeType==1&&E>0){if(T.contentEditable=="false")return null;T=T.childNodes[E-1],E=maxOffset(T)}else if(T.parentNode&&!isBlockElement(T))E=domIndex(T),T=T.parentNode;else return null}}function textNodeAfter(B,_){for(let T=B,E=_;;){if(T.nodeType==3&&E<T.nodeValue.length)return{node:T,offset:E};if(T.nodeType==1&&E<T.childNodes.length){if(T.contentEditable=="false")return null;T=T.childNodes[E],E=0}else if(T.parentNode&&!isBlockElement(T))E=domIndex(T)+1,T=T.parentNode;else return null}}class DOMPos{constructor(_,T,E=!0){this.node=_,this.offset=T,this.precise=E}static before(_,T){return new DOMPos(_.parentNode,domIndex(_),T)}static after(_,T){return new DOMPos(_.parentNode,domIndex(_)+1,T)}}const noChildren=[];class ContentView{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(_){let T=this.posAtStart;for(let E of this.children){if(E==_)return T;T+=E.length+E.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(_){return this.posBefore(_)+_.length}sync(_,T){if(this.flags&2){let E=this.dom,W=null,X;for(let q of this.children){if(q.flags&7){if(!q.dom&&(X=W?W.nextSibling:E.firstChild)){let Y=ContentView.get(X);(!Y||!Y.parent&&Y.canReuseDOM(q))&&q.reuseDOM(X)}q.sync(_,T),q.flags&=-8}if(X=W?W.nextSibling:E.firstChild,T&&!T.written&&T.node==E&&X!=q.dom&&(T.written=!0),q.dom.parentNode==E)for(;X&&X!=q.dom;)X=rm$1(X);else E.insertBefore(q.dom,X);W=q.dom}for(X=W?W.nextSibling:E.firstChild,X&&T&&T.node==E&&(T.written=!0);X;)X=rm$1(X)}else if(this.flags&1)for(let E of this.children)E.flags&7&&(E.sync(_,T),E.flags&=-8)}reuseDOM(_){}localPosFromDOM(_,T){let E;if(_==this.dom)E=this.dom.childNodes[T];else{let W=maxOffset(_)==0?0:T==0?-1:1;for(;;){let X=_.parentNode;if(X==this.dom)break;W==0&&X.firstChild!=X.lastChild&&(_==X.firstChild?W=-1:W=1),_=X}W<0?E=_:E=_.nextSibling}if(E==this.dom.firstChild)return 0;for(;E&&!ContentView.get(E);)E=E.nextSibling;if(!E)return this.length;for(let W=0,X=0;;W++){let q=this.children[W];if(q.dom==E)return X;X+=q.length+q.breakAfter}}domBoundsAround(_,T,E=0){let W=-1,X=-1,q=-1,Y=-1;for(let te=0,ne=E,ae=E;te<this.children.length;te++){let le=this.children[te],ue=ne+le.length;if(ne<_&&ue>T)return le.domBoundsAround(_,T,ne);if(ue>=_&&W==-1&&(W=te,X=ne),ne>T&&le.dom.parentNode==this.dom){q=te,Y=ae;break}ae=ue,ne=ue+le.breakAfter}return{from:X,to:Y<0?E+this.length:Y,startDOM:(W?this.children[W-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:q<this.children.length&&q>=0?this.children[q].dom:null}}markDirty(_=!1){this.flags|=2,this.markParentsDirty(_)}markParentsDirty(_){for(let T=this.parent;T;T=T.parent){if(_&&(T.flags|=2),T.flags&1)return;T.flags|=1,_=!1}}setParent(_){this.parent!=_&&(this.parent=_,this.flags&7&&this.markParentsDirty(!0))}setDOM(_){this.dom!=_&&(this.dom&&(this.dom.cmView=null),this.dom=_,_.cmView=this)}get rootView(){for(let _=this;;){let T=_.parent;if(!T)return _;_=T}}replaceChildren(_,T,E=noChildren){this.markDirty();for(let W=_;W<T;W++){let X=this.children[W];X.parent==this&&E.indexOf(X)<0&&X.destroy()}this.children.splice(_,T-_,...E);for(let W=0;W<E.length;W++)E[W].setParent(this)}ignoreMutation(_){return!1}ignoreEvent(_){return!1}childCursor(_=this.length){return new ChildCursor(this.children,_,this.children.length)}childPos(_,T=1){return this.childCursor().findPos(_,T)}toString(){let _=this.constructor.name.replace("View","");return _+(this.children.length?"("+this.children.join()+")":this.length?"["+(_=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(_){return _.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(_,T,E,W,X,q){return!1}become(_){return!1}canReuseDOM(_){return _.constructor==this.constructor&&!((this.flags|_.flags)&8)}getSide(){return 0}destroy(){for(let _ of this.children)_.parent==this&&_.destroy();this.parent=null}}ContentView.prototype.breakAfter=0;function rm$1(B){let _=B.nextSibling;return B.parentNode.removeChild(B),_}class ChildCursor{constructor(_,T,E){this.children=_,this.pos=T,this.i=E,this.off=0}findPos(_,T=1){for(;;){if(_>this.pos||_==this.pos&&(T>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=_-this.pos,this;let E=this.children[--this.i];this.pos-=E.length+E.breakAfter}}}function replaceRange(B,_,T,E,W,X,q,Y,te){let{children:ne}=B,ae=ne.length?ne[_]:null,le=X.length?X[X.length-1]:null,ue=le?le.breakAfter:q;if(!(_==E&&ae&&!q&&!ue&&X.length<2&&ae.merge(T,W,X.length?le:null,T==0,Y,te))){if(E<ne.length){let ge=ne[E];ge&&(W<ge.length||ge.breakAfter&&(le!=null&&le.breakAfter))?(_==E&&(ge=ge.split(W),W=0),!ue&&le&&ge.merge(0,W,le,!0,0,te)?X[X.length-1]=ge:((W||ge.children.length&&!ge.children[0].length)&&ge.merge(0,W,null,!1,0,te),X.push(ge))):ge!=null&&ge.breakAfter&&(le?le.breakAfter=1:q=1),E++}for(ae&&(ae.breakAfter=q,T>0&&(!q&&X.length&&ae.merge(T,ae.length,X[0],!1,Y,0)?ae.breakAfter=X.shift().breakAfter:(T<ae.length||ae.children.length&&ae.children[ae.children.length-1].length==0)&&ae.merge(T,ae.length,null,!1,Y,0),_++));_<E&&X.length;)if(ne[E-1].become(X[X.length-1]))E--,X.pop(),te=X.length?0:Y;else if(ne[_].become(X[0]))_++,X.shift(),Y=X.length?0:te;else break;!X.length&&_&&E<ne.length&&!ne[_-1].breakAfter&&ne[E].merge(0,0,ne[_-1],!1,Y,te)&&_--,(_<E||X.length)&&B.replaceChildren(_,E,X)}}function mergeChildrenInto(B,_,T,E,W,X){let q=B.childCursor(),{i:Y,off:te}=q.findPos(T,1),{i:ne,off:ae}=q.findPos(_,-1),le=_-T;for(let ue of E)le+=ue.length;B.length+=le,replaceRange(B,ne,ae,Y,te,E,0,W,X)}let nav=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},doc=typeof document<"u"?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie$1=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie$1&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie$1&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie$1&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie:ie$1,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios,android:/Android\b/.test(nav.userAgent),webkit,safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const MaxJoinLen=256;class TextView extends ContentView{constructor(_){super(),this.text=_}get length(){return this.text.length}createDOM(_){this.setDOM(_||document.createTextNode(this.text))}sync(_,T){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(T&&T.node==this.dom&&(T.written=!0),this.dom.nodeValue=this.text)}reuseDOM(_){_.nodeType==3&&this.createDOM(_)}merge(_,T,E){return this.flags&8||E&&(!(E instanceof TextView)||this.length-(T-_)+E.length>MaxJoinLen||E.flags&8)?!1:(this.text=this.text.slice(0,_)+(E?E.text:"")+this.text.slice(T),this.markDirty(),!0)}split(_){let T=new TextView(this.text.slice(_));return this.text=this.text.slice(0,_),this.markDirty(),T.flags|=this.flags&8,T}localPosFromDOM(_,T){return _==this.dom?T:T?this.text.length:0}domAtPos(_){return new DOMPos(this.dom,_)}domBoundsAround(_,T,E){return{from:E,to:E+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(_,T){return textCoords(this.dom,_,T)}}class MarkView extends ContentView{constructor(_,T=[],E=0){super(),this.mark=_,this.children=T,this.length=E;for(let W of T)W.setParent(this)}setAttrs(_){if(clearAttributes(_),this.mark.class&&(_.className=this.mark.class),this.mark.attrs)for(let T in this.mark.attrs)_.setAttribute(T,this.mark.attrs[T]);return _}canReuseDOM(_){return super.canReuseDOM(_)&&!((this.flags|_.flags)&8)}reuseDOM(_){_.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(_),this.flags|=6)}sync(_,T){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(_,T)}merge(_,T,E,W,X,q){return E&&(!(E instanceof MarkView&&E.mark.eq(this.mark))||_&&X<=0||T<this.length&&q<=0)?!1:(mergeChildrenInto(this,_,T,E?E.children.slice():[],X-1,q-1),this.markDirty(),!0)}split(_){let T=[],E=0,W=-1,X=0;for(let Y of this.children){let te=E+Y.length;te>_&&T.push(E<_?Y.split(_-E):Y),W<0&&E>=_&&(W=X),E=te,X++}let q=this.length-_;return this.length=_,W>-1&&(this.children.length=W,this.markDirty()),new MarkView(this.mark,T,q)}domAtPos(_){return inlineDOMAtPos(this,_)}coordsAt(_,T){return coordsInChildren(this,_,T)}}function textCoords(B,_,T){let E=B.nodeValue.length;_>E&&(_=E);let W=_,X=_,q=0;_==0&&T<0||_==E&&T>=0?browser.chrome||browser.gecko||(_?(W--,q=1):X<E&&(X++,q=-1)):T<0?W--:X<E&&X++;let Y=textRange(B,W,X).getClientRects();if(!Y.length)return null;let te=Y[(q?q<0:T>=0)?0:Y.length-1];return browser.safari&&!q&&te.width==0&&(te=Array.prototype.find.call(Y,ne=>ne.width)||te),q?flattenRect(te,q<0):te||null}class WidgetView extends ContentView{static create(_,T,E){return new WidgetView(_,T,E)}constructor(_,T,E){super(),this.widget=_,this.length=T,this.side=E,this.prevWidget=null}split(_){let T=WidgetView.create(this.widget,this.length-_,this.side);return this.length-=_,T}sync(_){(!this.dom||!this.widget.updateDOM(this.dom,_))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(_)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(_,T,E,W,X,q){return E&&(!(E instanceof WidgetView)||!this.widget.compare(E.widget)||_>0&&X<=0||T<this.length&&q<=0)?!1:(this.length=_+(E?E.length:0)+(this.length-T),!0)}become(_){return _ instanceof WidgetView&&_.side==this.side&&this.widget.constructor==_.widget.constructor?(this.widget.compare(_.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=_.widget,this.length=_.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(_){return this.widget.ignoreEvent(_)}get overrideDOMText(){if(this.length==0)return Text.empty;let _=this;for(;_.parent;)_=_.parent;let{view:T}=_,E=T&&T.state.doc,W=this.posAtStart;return E?E.slice(W,W+this.length):Text.empty}domAtPos(_){return(this.length?_==0:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,_==this.length)}domBoundsAround(){return null}coordsAt(_,T){let E=this.widget.coordsAt(this.dom,_,T);if(E)return E;let W=this.dom.getClientRects(),X=null;if(!W.length)return null;let q=this.side?this.side<0:_>0;for(let Y=q?W.length-1:0;X=W[Y],!(_>0?Y==0:Y==W.length-1||X.top<X.bottom);Y+=q?-1:1);return flattenRect(X,!q)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class WidgetBufferView extends ContentView{constructor(_){super(),this.side=_}get length(){return 0}merge(){return!1}become(_){return _ instanceof WidgetBufferView&&_.side==this.side}split(){return new WidgetBufferView(this.side)}sync(){if(!this.dom){let _=document.createElement("img");_.className="cm-widgetBuffer",_.setAttribute("aria-hidden","true"),this.setDOM(_)}}getSide(){return this.side}domAtPos(_){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(_){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Text.empty}get isHidden(){return!0}}TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;function inlineDOMAtPos(B,_){let T=B.dom,{children:E}=B,W=0;for(let X=0;W<E.length;W++){let q=E[W],Y=X+q.length;if(!(Y==X&&q.getSide()<=0)){if(_>X&&_<Y&&q.dom.parentNode==T)return q.domAtPos(_-X);if(_<=X)break;X=Y}}for(let X=W;X>0;X--){let q=E[X-1];if(q.dom.parentNode==T)return q.domAtPos(q.length)}for(let X=W;X<E.length;X++){let q=E[X];if(q.dom.parentNode==T)return q.domAtPos(0)}return new DOMPos(T,0)}function joinInlineInto(B,_,T){let E,{children:W}=B;T>0&&_ instanceof MarkView&&W.length&&(E=W[W.length-1])instanceof MarkView&&E.mark.eq(_.mark)?joinInlineInto(E,_.children[0],T-1):(W.push(_),_.setParent(B)),B.length+=_.length}function coordsInChildren(B,_,T){let E=null,W=-1,X=null,q=-1;function Y(ne,ae){for(let le=0,ue=0;le<ne.children.length&&ue<=ae;le++){let ge=ne.children[le],ye=ue+ge.length;ye>=ae&&(ge.children.length?Y(ge,ae-ue):(!X||X.isHidden&&T>0)&&(ye>ae||ue==ye&&ge.getSide()>0)?(X=ge,q=ae-ue):(ue<ae||ue==ye&&ge.getSide()<0&&!ge.isHidden)&&(E=ge,W=ae-ue)),ue=ye}}Y(B,_);let te=(T<0?E:X)||E||X;return te?te.coordsAt(Math.max(0,te==E?W:q),T):fallbackRect(B)}function fallbackRect(B){let _=B.dom.lastChild;if(!_)return B.dom.getBoundingClientRect();let T=clientRectsFor(_);return T[T.length-1]||null}function combineAttrs(B,_){for(let T in B)T=="class"&&_.class?_.class+=" "+B.class:T=="style"&&_.style?_.style+=";"+B.style:_[T]=B[T];return _}const noAttrs$1=Object.create(null);function attrsEq(B,_,T){if(B==_)return!0;B||(B=noAttrs$1),_||(_=noAttrs$1);let E=Object.keys(B),W=Object.keys(_);if(E.length-(T&&E.indexOf(T)>-1?1:0)!=W.length-(T&&W.indexOf(T)>-1?1:0))return!1;for(let X of E)if(X!=T&&(W.indexOf(X)==-1||B[X]!==_[X]))return!1;return!0}function updateAttrs(B,_,T){let E=!1;if(_)for(let W in _)T&&W in T||(E=!0,W=="style"?B.style.cssText="":B.removeAttribute(W));if(T)for(let W in T)_&&_[W]==T[W]||(E=!0,W=="style"?B.style.cssText=T[W]:B.setAttribute(W,T[W]));return E}function getAttrs(B){let _=Object.create(null);for(let T=0;T<B.attributes.length;T++){let E=B.attributes[T];_[E.name]=E.value}return _}class WidgetType{eq(_){return!1}updateDOM(_,T){return!1}compare(_){return this==_||this.constructor==_.constructor&&this.eq(_)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(_){return!0}coordsAt(_,T,E){return null}get isHidden(){return!1}get editable(){return!1}destroy(_){}}var BlockType=function(B){return B[B.Text=0]="Text",B[B.WidgetBefore=1]="WidgetBefore",B[B.WidgetAfter=2]="WidgetAfter",B[B.WidgetRange=3]="WidgetRange",B}(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(_,T,E,W){super(),this.startSide=_,this.endSide=T,this.widget=E,this.spec=W}get heightRelevant(){return!1}static mark(_){return new MarkDecoration(_)}static widget(_){let T=Math.max(-1e4,Math.min(1e4,_.side||0)),E=!!_.block;return T+=E&&!_.inlineOrder?T>0?3e8:-4e8:T>0?1e8:-1e8,new PointDecoration(_,T,T,E,_.widget||null,!1)}static replace(_){let T=!!_.block,E,W;if(_.isBlockGap)E=-5e8,W=4e8;else{let{start:X,end:q}=getInclusive(_,T);E=(X?T?-3e8:-1:5e8)-1,W=(q?T?2e8:1:-6e8)+1}return new PointDecoration(_,E,W,T,_.widget||null,!0)}static line(_){return new LineDecoration(_)}static set(_,T=!1){return RangeSet.of(_,T)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(_){let{start:T,end:E}=getInclusive(_);super(T?-1:5e8,E?1:-6e8,null,_),this.tagName=_.tagName||"span",this.class=_.class||"",this.attrs=_.attributes||null}eq(_){var T,E;return this==_||_ instanceof MarkDecoration&&this.tagName==_.tagName&&(this.class||((T=this.attrs)===null||T===void 0?void 0:T.class))==(_.class||((E=_.attrs)===null||E===void 0?void 0:E.class))&&attrsEq(this.attrs,_.attrs,"class")}range(_,T=_){if(_>=T)throw new RangeError("Mark decorations may not be empty");return super.range(_,T)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(_){super(-2e8,-2e8,null,_)}eq(_){return _ instanceof LineDecoration&&this.spec.class==_.spec.class&&attrsEq(this.spec.attributes,_.spec.attributes)}range(_,T=_){if(T!=_)throw new RangeError("Line decoration ranges must be zero-length");return super.range(_,T)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(_,T,E,W,X,q){super(T,E,X,_),this.block=W,this.isReplace=q,this.mapMode=W?T<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide!=this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(_){return _ instanceof PointDecoration&&widgetsEq(this.widget,_.widget)&&this.block==_.block&&this.startSide==_.startSide&&this.endSide==_.endSide}range(_,T=_){if(this.isReplace&&(_>T||_==T&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&T!=_)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(_,T)}}PointDecoration.prototype.point=!0;function getInclusive(B,_=!1){let{inclusiveStart:T,inclusiveEnd:E}=B;return T==null&&(T=B.inclusive),E==null&&(E=B.inclusive),{start:T??_,end:E??_}}function widgetsEq(B,_){return B==_||!!(B&&_&&B.compare(_))}function addRange(B,_,T,E=0){let W=T.length-1;W>=0&&T[W]+E>=B?T[W]=Math.max(T[W],_):T.push(B,_)}class LineView extends ContentView{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(_,T,E,W,X,q){if(E){if(!(E instanceof LineView))return!1;this.dom||E.transferDOM(this)}return W&&this.setDeco(E?E.attrs:null),mergeChildrenInto(this,_,T,E?E.children.slice():[],X,q),!0}split(_){let T=new LineView;if(T.breakAfter=this.breakAfter,this.length==0)return T;let{i:E,off:W}=this.childPos(_);W&&(T.append(this.children[E].split(W),0),this.children[E].merge(W,this.children[E].length,null,!1,0,0),E++);for(let X=E;X<this.children.length;X++)T.append(this.children[X],0);for(;E>0&&this.children[E-1].length==0;)this.children[--E].destroy();return this.children.length=E,this.markDirty(),this.length=_,T}transferDOM(_){this.dom&&(this.markDirty(),_.setDOM(this.dom),_.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(_){attrsEq(this.attrs,_)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=_)}append(_,T){joinInlineInto(this,_,T)}addLineDeco(_){let T=_.spec.attributes,E=_.spec.class;T&&(this.attrs=combineAttrs(T,this.attrs||{})),E&&(this.attrs=combineAttrs({class:E},this.attrs||{}))}domAtPos(_){return inlineDOMAtPos(this,_)}reuseDOM(_){_.nodeName=="DIV"&&(this.setDOM(_),this.flags|=6)}sync(_,T){var E;this.dom?this.flags&4&&(clearAttributes(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(_,T);let W=this.dom.lastChild;for(;W&&ContentView.get(W)instanceof MarkView;)W=W.lastChild;if(!W||!this.length||W.nodeName!="BR"&&((E=ContentView.get(W))===null||E===void 0?void 0:E.isEditable)==!1&&(!browser.ios||!this.children.some(X=>X instanceof TextView))){let X=document.createElement("BR");X.cmIgnore=!0,this.dom.appendChild(X)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let _=0,T;for(let E of this.children){if(!(E instanceof TextView)||/[^ -~]/.test(E.text))return null;let W=clientRectsFor(E.dom);if(W.length!=1)return null;_+=W[0].width,T=W[0].height}return _?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:_/this.length,textHeight:T}:null}coordsAt(_,T){let E=coordsInChildren(this,_,T);if(!this.children.length&&E&&this.parent){let{heightOracle:W}=this.parent.view.viewState,X=E.bottom-E.top;if(Math.abs(X-W.lineHeight)<2&&W.textHeight<X){let q=(X-W.textHeight)/2;return{top:E.top+q,bottom:E.bottom-q,left:E.left,right:E.left}}}return E}become(_){return _ instanceof LineView&&this.children.length==0&&_.children.length==0&&attrsEq(this.attrs,_.attrs)&&this.breakAfter==_.breakAfter}covers(){return!0}static find(_,T){for(let E=0,W=0;E<_.children.length;E++){let X=_.children[E],q=W+X.length;if(q>=T){if(X instanceof LineView)return X;if(q>T)break}W=q+X.breakAfter}return null}}class BlockWidgetView extends ContentView{constructor(_,T,E){super(),this.widget=_,this.length=T,this.deco=E,this.breakAfter=0,this.prevWidget=null}merge(_,T,E,W,X,q){return E&&(!(E instanceof BlockWidgetView)||!this.widget.compare(E.widget)||_>0&&X<=0||T<this.length&&q<=0)?!1:(this.length=_+(E?E.length:0)+(this.length-T),!0)}domAtPos(_){return _==0?DOMPos.before(this.dom):DOMPos.after(this.dom,_==this.length)}split(_){let T=this.length-_;this.length=_;let E=new BlockWidgetView(this.widget,T,this.deco);return E.breakAfter=this.breakAfter,E}get children(){return noChildren}sync(_){(!this.dom||!this.widget.updateDOM(this.dom,_))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(_)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty}domBoundsAround(){return null}become(_){return _ instanceof BlockWidgetView&&_.widget.constructor==this.widget.constructor?(_.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=_.widget,this.length=_.length,this.deco=_.deco,this.breakAfter=_.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(_){return this.widget.ignoreEvent(_)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(_,T){let E=this.widget.coordsAt(this.dom,_,T);return E||(this.widget instanceof BlockGapWidget?null:flattenRect(this.dom.getBoundingClientRect(),this.length?_==0:T<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(_){let{startSide:T,endSide:E}=this.deco;return T==E?!1:_<0?T<0:E>0}}class BlockGapWidget extends WidgetType{constructor(_){super(),this.height=_}toDOM(){let _=document.createElement("div");return _.className="cm-gap",this.updateDOM(_),_}eq(_){return _.height==this.height}updateDOM(_){return _.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class ContentBuilder{constructor(_,T,E,W){this.doc=_,this.pos=T,this.end=E,this.disallowBlockEffectsFor=W,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=_.iter(),this.skip=T}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let _=this.content[this.content.length-1];return!(_.breakAfter||_ instanceof BlockWidgetView&&_.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView),this.atCursorPos=!0),this.curLine}flushBuffer(_=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks(new WidgetBufferView(-1),_),_.length),this.pendingBuffer=0)}addBlockWidget(_){this.flushBuffer(),this.curLine=null,this.content.push(_)}finish(_){this.pendingBuffer&&_<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(_&&this.content.length&&this.content[this.content.length-1]instanceof BlockWidgetView)&&this.getLine()}buildText(_,T,E){for(;_>0;){if(this.textOff==this.text.length){let{value:X,lineBreak:q,done:Y}=this.cursor.next(this.skip);if(this.skip=0,Y)throw new Error("Ran out of text content when drawing inline views");if(q){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,_--;continue}else this.text=X,this.textOff=0}let W=Math.min(this.text.length-this.textOff,_,512);this.flushBuffer(T.slice(T.length-E)),this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+W)),T),E),this.atCursorPos=!0,this.textOff+=W,_-=W,E=0}}span(_,T,E,W){this.buildText(T-_,E,W),this.pos=T,this.openStart<0&&(this.openStart=W)}point(_,T,E,W,X,q){if(this.disallowBlockEffectsFor[q]&&E instanceof PointDecoration){if(E.block)throw new RangeError("Block decorations may not be specified via plugins");if(T>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let Y=T-_;if(E instanceof PointDecoration)if(E.block)E.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView(E.widget||NullWidget.block,Y,E));else{let te=WidgetView.create(E.widget||NullWidget.inline,Y,Y?0:E.startSide),ne=this.atCursorPos&&!te.isEditable&&X<=W.length&&(_<T||E.startSide>0),ae=!te.isEditable&&(_<T||X>W.length||E.startSide<=0),le=this.getLine();this.pendingBuffer==2&&!ne&&!te.isEditable&&(this.pendingBuffer=0),this.flushBuffer(W),ne&&(le.append(wrapMarks(new WidgetBufferView(1),W),X),X=W.length+Math.max(0,X-W.length)),le.append(wrapMarks(te,W),X),this.atCursorPos=ae,this.pendingBuffer=ae?_<T||X>W.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=W.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(E);Y&&(this.textOff+Y<=this.text.length?this.textOff+=Y:(this.skip+=Y-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=T),this.openStart<0&&(this.openStart=X)}static build(_,T,E,W,X){let q=new ContentBuilder(_,T,E,X);return q.openEnd=RangeSet.spans(W,T,E,q),q.openStart<0&&(q.openStart=q.openEnd),q.finish(q.openEnd),q}}function wrapMarks(B,_){for(let T of _)B=new MarkView(T,[B],B.length);return B}class NullWidget extends WidgetType{constructor(_){super(),this.tag=_}eq(_){return _.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(_){return _.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}NullWidget.inline=new NullWidget("span");NullWidget.block=new NullWidget("div");var Direction=function(B){return B[B.LTR=0]="LTR",B[B.RTL=1]="RTL",B}(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec(B){let _=[];for(let T=0;T<B.length;T++)_.push(1<<+B[T]);return _}const LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let B of["()","[]","{}"]){let _=B.charCodeAt(0),T=B.charCodeAt(1);Brackets[_]=T,Brackets[T]=-_}function charType(B){return B<=247?LowTypes[B]:1424<=B&&B<=1524?2:1536<=B&&B<=1785?ArabicTypes[B-1536]:1774<=B&&B<=2220?4:8192<=B&&B<=8204?256:64336<=B&&B<=65023?4:1}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{get dir(){return this.level%2?RTL:LTR}constructor(_,T,E){this.from=_,this.to=T,this.level=E}side(_,T){return this.dir==T==_?this.to:this.from}forward(_,T){return _==(this.dir==T)}static find(_,T,E,W){let X=-1;for(let q=0;q<_.length;q++){let Y=_[q];if(Y.from<=T&&Y.to>=T){if(Y.level==E)return q;(X<0||(W!=0?W<0?Y.from<T:Y.to>T:_[X].level>Y.level))&&(X=q)}}if(X<0)throw new RangeError("Index out of range");return X}}function isolatesEq(B,_){if(B.length!=_.length)return!1;for(let T=0;T<B.length;T++){let E=B[T],W=_[T];if(E.from!=W.from||E.to!=W.to||E.direction!=W.direction||!isolatesEq(E.inner,W.inner))return!1}return!0}const types=[];function computeCharTypes(B,_,T,E,W){for(let X=0;X<=E.length;X++){let q=X?E[X-1].to:_,Y=X<E.length?E[X].from:T,te=X?256:W;for(let ne=q,ae=te,le=te;ne<Y;ne++){let ue=charType(B.charCodeAt(ne));ue==512?ue=ae:ue==8&&le==4&&(ue=16),types[ne]=ue==4?2:ue,ue&7&&(le=ue),ae=ue}for(let ne=q,ae=te,le=te;ne<Y;ne++){let ue=types[ne];if(ue==128)ne<Y-1&&ae==types[ne+1]&&ae&24?ue=types[ne]=ae:types[ne]=256;else if(ue==64){let ge=ne+1;for(;ge<Y&&types[ge]==64;)ge++;let ye=ne&&ae==8||ge<T&&types[ge]==8?le==1?1:8:256;for(let xe=ne;xe<ge;xe++)types[xe]=ye;ne=ge-1}else ue==8&&le==1&&(types[ne]=1);ae=ue,ue&7&&(le=ue)}}}function processBracketPairs(B,_,T,E,W){let X=W==1?2:1;for(let q=0,Y=0,te=0;q<=E.length;q++){let ne=q?E[q-1].to:_,ae=q<E.length?E[q].from:T;for(let le=ne,ue,ge,ye;le<ae;le++)if(ge=Brackets[ue=B.charCodeAt(le)])if(ge<0){for(let xe=Y-3;xe>=0;xe-=3)if(BracketStack[xe+1]==-ge){let Te=BracketStack[xe+2],Ae=Te&2?W:Te&4?Te&1?X:W:0;Ae&&(types[le]=types[BracketStack[xe]]=Ae),Y=xe;break}}else{if(BracketStack.length==189)break;BracketStack[Y++]=le,BracketStack[Y++]=ue,BracketStack[Y++]=te}else if((ye=types[le])==2||ye==1){let xe=ye==W;te=xe?0:1;for(let Te=Y-3;Te>=0;Te-=3){let Ae=BracketStack[Te+2];if(Ae&2)break;if(xe)BracketStack[Te+2]|=2;else{if(Ae&4)break;BracketStack[Te+2]|=4}}}}}function processNeutrals(B,_,T,E){for(let W=0,X=E;W<=T.length;W++){let q=W?T[W-1].to:B,Y=W<T.length?T[W].from:_;for(let te=q;te<Y;){let ne=types[te];if(ne==256){let ae=te+1;for(;;)if(ae==Y){if(W==T.length)break;ae=T[W++].to,Y=W<T.length?T[W].from:_}else if(types[ae]==256)ae++;else break;let le=X==1,ue=(ae<_?types[ae]:E)==1,ge=le==ue?le?1:2:E;for(let ye=ae,xe=W,Te=xe?T[xe-1].to:B;ye>te;)ye==Te&&(ye=T[--xe].from,Te=xe?T[xe-1].to:B),types[--ye]=ge;te=ae}else X=ne,te++}}}function emitSpans(B,_,T,E,W,X,q){let Y=E%2?2:1;if(E%2==W%2)for(let te=_,ne=0;te<T;){let ae=!0,le=!1;if(ne==X.length||te<X[ne].from){let xe=types[te];xe!=Y&&(ae=!1,le=xe==16)}let ue=!ae&&Y==1?[]:null,ge=ae?E:E+1,ye=te;e:for(;;)if(ne<X.length&&ye==X[ne].from){if(le)break e;let xe=X[ne];if(!ae)for(let Te=xe.to,Ae=ne+1;;){if(Te==T)break e;if(Ae<X.length&&X[Ae].from==Te)Te=X[Ae++].to;else{if(types[Te]==Y)break e;break}}if(ne++,ue)ue.push(xe);else{xe.from>te&&q.push(new BidiSpan(te,xe.from,ge));let Te=xe.direction==LTR!=!(ge%2);computeSectionOrder(B,Te?E+1:E,W,xe.inner,xe.from,xe.to,q),te=xe.to}ye=xe.to}else{if(ye==T||(ae?types[ye]!=Y:types[ye]==Y))break;ye++}ue?emitSpans(B,te,ye,E+1,W,ue,q):te<ye&&q.push(new BidiSpan(te,ye,ge)),te=ye}else for(let te=T,ne=X.length;te>_;){let ae=!0,le=!1;if(!ne||te>X[ne-1].to){let xe=types[te-1];xe!=Y&&(ae=!1,le=xe==16)}let ue=!ae&&Y==1?[]:null,ge=ae?E:E+1,ye=te;e:for(;;)if(ne&&ye==X[ne-1].to){if(le)break e;let xe=X[--ne];if(!ae)for(let Te=xe.from,Ae=ne;;){if(Te==_)break e;if(Ae&&X[Ae-1].to==Te)Te=X[--Ae].from;else{if(types[Te-1]==Y)break e;break}}if(ue)ue.push(xe);else{xe.to<te&&q.push(new BidiSpan(xe.to,te,ge));let Te=xe.direction==LTR!=!(ge%2);computeSectionOrder(B,Te?E+1:E,W,xe.inner,xe.from,xe.to,q),te=xe.from}ye=xe.from}else{if(ye==_||(ae?types[ye-1]!=Y:types[ye-1]==Y))break;ye--}ue?emitSpans(B,ye,te,E+1,W,ue,q):ye<te&&q.push(new BidiSpan(ye,te,ge)),te=ye}}function computeSectionOrder(B,_,T,E,W,X,q){let Y=_%2?2:1;computeCharTypes(B,W,X,E,Y),processBracketPairs(B,W,X,E,Y),processNeutrals(W,X,E,Y),emitSpans(B,W,X,_,T,E,q)}function computeOrder(B,_,T){if(!B)return[new BidiSpan(0,0,_==RTL?1:0)];if(_==LTR&&!T.length&&!BidiRE.test(B))return trivialOrder(B.length);if(T.length)for(;B.length>types.length;)types[types.length]=256;let E=[],W=_==LTR?0:1;return computeSectionOrder(B,W,W,T,0,B.length,E),E}function trivialOrder(B){return[new BidiSpan(0,B,0)]}let movedOver="";function moveVisually(B,_,T,E,W){var X;let q=E.head-B.from,Y=BidiSpan.find(_,q,(X=E.bidiLevel)!==null&&X!==void 0?X:-1,E.assoc),te=_[Y],ne=te.side(W,T);if(q==ne){let ue=Y+=W?1:-1;if(ue<0||ue>=_.length)return null;te=_[Y=ue],q=te.side(!W,T),ne=te.side(W,T)}let ae=findClusterBreak(B.text,q,te.forward(W,T));(ae<te.from||ae>te.to)&&(ae=ne),movedOver=B.text.slice(Math.min(q,ae),Math.max(q,ae));let le=Y==(W?_.length-1:0)?null:_[Y+(W?1:-1)];return le&&ae==ne&&le.level+(W?0:1)<te.level?EditorSelection.cursor(le.side(!W,T)+B.from,le.forward(W,T)?1:-1,le.level):EditorSelection.cursor(ae+B.from,te.forward(W,T)?-1:1,te.level)}function autoDirection(B,_,T){for(let E=_;E<T;E++){let W=charType(B.charCodeAt(E));if(W==1)return LTR;if(W==2||W==4)return RTL}return LTR}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler$1=Facet.define(),focusChangeEffect=Facet.define(),clipboardInputFilter=Facet.define(),clipboardOutputFilter=Facet.define(),perLineTextDirection=Facet.define({combine:B=>B.some(_=>_)}),nativeSelectionHidden=Facet.define({combine:B=>B.some(_=>_)}),scrollHandler=Facet.define();class ScrollTarget{constructor(_,T="nearest",E="nearest",W=5,X=5,q=!1){this.range=_,this.y=T,this.x=E,this.yMargin=W,this.xMargin=X,this.isSnapshot=q}map(_){return _.empty?this:new ScrollTarget(this.range.map(_),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(_){return this.range.to<=_.doc.length?this:new ScrollTarget(EditorSelection.cursor(_.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const scrollIntoView$1=StateEffect.define({map:(B,_)=>B.map(_)}),setEditContextFormatting=StateEffect.define();function logException(B,_,T){let E=B.facet(exceptionSink);E.length?E[0](_):window.onerror?window.onerror(String(_),T,void 0,void 0,_):T?console.error(T+":",_):console.error(_)}const editable=Facet.define({combine:B=>B.length?B[0]:!0});let nextPluginID=0;const viewPlugin=Facet.define();class ViewPlugin{constructor(_,T,E,W,X){this.id=_,this.create=T,this.domEventHandlers=E,this.domEventObservers=W,this.extension=X(this)}static define(_,T){const{eventHandlers:E,eventObservers:W,provide:X,decorations:q}=T||{};return new ViewPlugin(nextPluginID++,_,E,W,Y=>{let te=[viewPlugin.of(Y)];return q&&te.push(decorations.of(ne=>{let ae=ne.plugin(Y);return ae?q(ae):Decoration.none})),X&&te.push(X(Y)),te})}static fromClass(_,T){return ViewPlugin.define(E=>new _(E),T)}}class PluginInstance{constructor(_){this.spec=_,this.mustUpdate=null,this.value=null}update(_){if(this.value){if(this.mustUpdate){let T=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(T)}catch(E){if(logException(T.state,E,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(_)}catch(T){logException(_.state,T,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(_){var T;if(!((T=this.value)===null||T===void 0)&&T.destroy)try{this.value.destroy()}catch(E){logException(_.state,E,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),outerDecorations=Facet.define(),atomicRanges=Facet.define(),bidiIsolatedRanges=Facet.define();function getIsolatedRanges(B,_){let T=B.state.facet(bidiIsolatedRanges);if(!T.length)return T;let E=T.map(X=>X instanceof Function?X(B):X),W=[];return RangeSet.spans(E,_.from,_.to,{point(){},span(X,q,Y,te){let ne=X-_.from,ae=q-_.from,le=W;for(let ue=Y.length-1;ue>=0;ue--,te--){let ge=Y[ue].spec.bidiIsolate,ye;if(ge==null&&(ge=autoDirection(_.text,ne,ae)),te>0&&le.length&&(ye=le[le.length-1]).to==ne&&ye.direction==ge)ye.to=ae,le=ye.inner;else{let xe={from:ne,to:ae,direction:ge,inner:[]};le.push(xe),le=xe.inner}}}}),W}const scrollMargins=Facet.define();function getScrollMargins(B){let _=0,T=0,E=0,W=0;for(let X of B.state.facet(scrollMargins)){let q=X(B);q&&(q.left!=null&&(_=Math.max(_,q.left)),q.right!=null&&(T=Math.max(T,q.right)),q.top!=null&&(E=Math.max(E,q.top)),q.bottom!=null&&(W=Math.max(W,q.bottom)))}return{left:_,right:T,top:E,bottom:W}}const styleModule=Facet.define();class ChangedRange{constructor(_,T,E,W){this.fromA=_,this.toA=T,this.fromB=E,this.toB=W}join(_){return new ChangedRange(Math.min(this.fromA,_.fromA),Math.max(this.toA,_.toA),Math.min(this.fromB,_.fromB),Math.max(this.toB,_.toB))}addToSet(_){let T=_.length,E=this;for(;T>0;T--){let W=_[T-1];if(!(W.fromA>E.toA)){if(W.toA<E.fromA)break;E=E.join(W),_.splice(T-1,1)}}return _.splice(T,0,E),_}static extendWithRanges(_,T){if(T.length==0)return _;let E=[];for(let W=0,X=0,q=0,Y=0;;W++){let te=W==_.length?null:_[W],ne=q-Y,ae=te?te.fromB:1e9;for(;X<T.length&&T[X]<ae;){let le=T[X],ue=T[X+1],ge=Math.max(Y,le),ye=Math.min(ae,ue);if(ge<=ye&&new ChangedRange(ge+ne,ye+ne,ge,ye).addToSet(E),ue>ae)break;X+=2}if(!te)return E;new ChangedRange(te.fromA,te.toA,te.fromB,te.toB).addToSet(E),q=te.toA,Y=te.toB}}}class ViewUpdate{constructor(_,T,E){this.view=_,this.state=T,this.transactions=E,this.flags=0,this.startState=_.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let X of E)this.changes=this.changes.compose(X.changes);let W=[];this.changes.iterChangedRanges((X,q,Y,te)=>W.push(new ChangedRange(X,q,Y,te))),this.changedRanges=W}static create(_,T,E){return new ViewUpdate(_,T,E)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(_=>_.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class DocView extends ContentView{get length(){return this.view.state.doc.length}constructor(_){super(),this.view=_,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Decoration.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(_.contentDOM),this.children=[new LineView],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange(0,0,0,_.state.doc.length)],0,null)}update(_){var T;let E=_.changedRanges;this.minWidth>0&&E.length&&(E.every(({fromA:ne,toA:ae})=>ae<this.minWidthFrom||ne>this.minWidthTo)?(this.minWidthFrom=_.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=_.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(_);let W=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((T=this.domChanged)===null||T===void 0)&&T.newSel?W=this.domChanged.newSel.head:!touchesComposition(_.changes,this.hasComposition)&&!_.selectionSet&&(W=_.state.selection.main.head));let X=W>-1?findCompositionRange(this.view,_.changes,W):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:ne,to:ae}=this.hasComposition;E=new ChangedRange(ne,ae,_.changes.mapPos(ne,-1),_.changes.mapPos(ae,1)).addToSet(E.slice())}this.hasComposition=X?{from:X.range.fromB,to:X.range.toB}:null,(browser.ie||browser.chrome)&&!X&&_&&_.state.doc.lines!=_.startState.doc.lines&&(this.forceSelection=!0);let q=this.decorations,Y=this.updateDeco(),te=findChangedDeco(q,Y,_.changes);return E=ChangedRange.extendWithRanges(E,te),!(this.flags&7)&&E.length==0?!1:(this.updateInner(E,_.startState.doc.length,X),_.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(_,T,E){this.view.viewState.mustMeasureContent=!0,this.updateChildren(_,T,E);let{observer:W}=this.view;W.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let q=browser.chrome||browser.ios?{node:W.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,q),this.flags&=-8,q&&(q.written||W.selectionRange.focusNode!=q.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(q=>q.flags&=-9);let X=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let q of this.children)q instanceof BlockWidgetView&&q.widget instanceof BlockGapWidget&&X.push(q.dom);W.updateGaps(X)}updateChildren(_,T,E){let W=E?E.range.addToSet(_.slice()):_,X=this.childCursor(T);for(let q=W.length-1;;q--){let Y=q>=0?W[q]:null;if(!Y)break;let{fromA:te,toA:ne,fromB:ae,toB:le}=Y,ue,ge,ye,xe;if(E&&E.range.fromB<le&&E.range.toB>ae){let $e=ContentBuilder.build(this.view.state.doc,ae,E.range.fromB,this.decorations,this.dynamicDecorationMap),We=ContentBuilder.build(this.view.state.doc,E.range.toB,le,this.decorations,this.dynamicDecorationMap);ge=$e.breakAtStart,ye=$e.openStart,xe=We.openEnd;let Ue=this.compositionView(E);We.breakAtStart?Ue.breakAfter=1:We.content.length&&Ue.merge(Ue.length,Ue.length,We.content[0],!1,We.openStart,0)&&(Ue.breakAfter=We.content[0].breakAfter,We.content.shift()),$e.content.length&&Ue.merge(0,0,$e.content[$e.content.length-1],!0,0,$e.openEnd)&&$e.content.pop(),ue=$e.content.concat(Ue).concat(We.content)}else({content:ue,breakAtStart:ge,openStart:ye,openEnd:xe}=ContentBuilder.build(this.view.state.doc,ae,le,this.decorations,this.dynamicDecorationMap));let{i:Te,off:Ae}=X.findPos(ne,1),{i:Ie,off:Ve}=X.findPos(te,-1);replaceRange(this,Ie,Ve,Te,Ae,ue,ge,ye,xe)}E&&this.fixCompositionDOM(E)}updateEditContextFormatting(_){this.editContextFormatting=this.editContextFormatting.map(_.changes);for(let T of _.transactions)for(let E of T.effects)E.is(setEditContextFormatting)&&(this.editContextFormatting=E.value)}compositionView(_){let T=new TextView(_.text.nodeValue);T.flags|=8;for(let{deco:W}of _.marks)T=new MarkView(W,[T],T.length);let E=new LineView;return E.append(T,0),E}fixCompositionDOM(_){let T=(X,q)=>{q.flags|=8|(q.children.some(te=>te.flags&7)?1:0),this.markedForComposition.add(q);let Y=ContentView.get(X);Y&&Y!=q&&(Y.dom=null),q.setDOM(X)},E=this.childPos(_.range.fromB,1),W=this.children[E.i];T(_.line,W);for(let X=_.marks.length-1;X>=-1;X--)E=W.childPos(E.off,1),W=W.children[E.i],T(X>=0?_.marks[X].node:_.text,W)}updateSelection(_=!1,T=!1){(_||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let E=this.view.root.activeElement,W=E==this.dom,X=!W&&hasSelection(this.dom,this.view.observer.selectionRange)&&!(E&&this.dom.contains(E));if(!(W||T||X))return;let q=this.forceSelection;this.forceSelection=!1;let Y=this.view.state.selection.main,te=this.moveToLine(this.domAtPos(Y.anchor)),ne=Y.empty?te:this.moveToLine(this.domAtPos(Y.head));if(browser.gecko&&Y.empty&&!this.hasComposition&&betweenUneditable(te)){let le=document.createTextNode("");this.view.observer.ignore(()=>te.node.insertBefore(le,te.node.childNodes[te.offset]||null)),te=ne=new DOMPos(le,0),q=!0}let ae=this.view.observer.selectionRange;(q||!ae.focusNode||(!isEquivalentPosition(te.node,te.offset,ae.anchorNode,ae.anchorOffset)||!isEquivalentPosition(ne.node,ne.offset,ae.focusNode,ae.focusOffset))&&!this.suppressWidgetCursorChange(ae,Y))&&(this.view.observer.ignore(()=>{browser.android&&browser.chrome&&this.dom.contains(ae.focusNode)&&inUneditable(ae.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let le=getSelection(this.view.root);if(le)if(Y.empty){if(browser.gecko){let ue=nextToUneditable(te.node,te.offset);if(ue&&ue!=3){let ge=(ue==1?textNodeBefore:textNodeAfter)(te.node,te.offset);ge&&(te=new DOMPos(ge.node,ge.offset))}}le.collapse(te.node,te.offset),Y.bidiLevel!=null&&le.caretBidiLevel!==void 0&&(le.caretBidiLevel=Y.bidiLevel)}else if(le.extend){le.collapse(te.node,te.offset);try{le.extend(ne.node,ne.offset)}catch{}}else{let ue=document.createRange();Y.anchor>Y.head&&([te,ne]=[ne,te]),ue.setEnd(ne.node,ne.offset),ue.setStart(te.node,te.offset),le.removeAllRanges(),le.addRange(ue)}X&&this.view.root.activeElement==this.dom&&(this.dom.blur(),E&&E.focus())}),this.view.observer.setSelectionRange(te,ne)),this.impreciseAnchor=te.precise?null:new DOMPos(ae.anchorNode,ae.anchorOffset),this.impreciseHead=ne.precise?null:new DOMPos(ae.focusNode,ae.focusOffset)}suppressWidgetCursorChange(_,T){return this.hasComposition&&T.empty&&isEquivalentPosition(_.focusNode,_.focusOffset,_.anchorNode,_.anchorOffset)&&this.posFromDOM(_.focusNode,_.focusOffset)==T.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:_}=this,T=_.state.selection.main,E=getSelection(_.root),{anchorNode:W,anchorOffset:X}=_.observer.selectionRange;if(!E||!T.empty||!T.assoc||!E.modify)return;let q=LineView.find(this,T.head);if(!q)return;let Y=q.posAtStart;if(T.head==Y||T.head==Y+q.length)return;let te=this.coordsAt(T.head,-1),ne=this.coordsAt(T.head,1);if(!te||!ne||te.bottom>ne.top)return;let ae=this.domAtPos(T.head+T.assoc);E.collapse(ae.node,ae.offset),E.modify("move",T.assoc<0?"forward":"backward","lineboundary"),_.observer.readSelectionRange();let le=_.observer.selectionRange;_.docView.posFromDOM(le.anchorNode,le.anchorOffset)!=T.from&&E.collapse(W,X)}moveToLine(_){let T=this.dom,E;if(_.node!=T)return _;for(let W=_.offset;!E&&W<T.childNodes.length;W++){let X=ContentView.get(T.childNodes[W]);X instanceof LineView&&(E=X.domAtPos(0))}for(let W=_.offset-1;!E&&W>=0;W--){let X=ContentView.get(T.childNodes[W]);X instanceof LineView&&(E=X.domAtPos(X.length))}return E?new DOMPos(E.node,E.offset,!0):_}nearest(_){for(let T=_;T;){let E=ContentView.get(T);if(E&&E.rootView==this)return E;T=T.parentNode}return null}posFromDOM(_,T){let E=this.nearest(_);if(!E)throw new RangeError("Trying to find position for a DOM position outside of the document");return E.localPosFromDOM(_,T)+E.posAtStart}domAtPos(_){let{i:T,off:E}=this.childCursor().findPos(_,-1);for(;T<this.children.length-1;){let W=this.children[T];if(E<W.length||W instanceof LineView)break;T++,E=0}return this.children[T].domAtPos(E)}coordsAt(_,T){let E=null,W=0;for(let X=this.length,q=this.children.length-1;q>=0;q--){let Y=this.children[q],te=X-Y.breakAfter,ne=te-Y.length;if(te<_)break;if(ne<=_&&(ne<_||Y.covers(-1))&&(te>_||Y.covers(1))&&(!E||Y instanceof LineView&&!(E instanceof LineView&&T>=0)))E=Y,W=ne;else if(E&&ne==_&&te==_&&Y instanceof BlockWidgetView&&Math.abs(T)<2){if(Y.deco.startSide<0)break;q&&(E=null)}X=ne}return E?E.coordsAt(_-W,T):null}coordsForChar(_){let{i:T,off:E}=this.childPos(_,1),W=this.children[T];if(!(W instanceof LineView))return null;for(;W.children.length;){let{i:Y,off:te}=W.childPos(E,1);for(;;Y++){if(Y==W.children.length)return null;if((W=W.children[Y]).length)break}E=te}if(!(W instanceof TextView))return null;let X=findClusterBreak(W.text,E);if(X==E)return null;let q=textRange(W.dom,E,X).getClientRects();for(let Y=0;Y<q.length;Y++){let te=q[Y];if(Y==q.length-1||te.top<te.bottom&&te.left<te.right)return te}return null}measureVisibleLineHeights(_){let T=[],{from:E,to:W}=_,X=this.view.contentDOM.clientWidth,q=X>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,Y=-1,te=this.view.textDirection==Direction.LTR;for(let ne=0,ae=0;ae<this.children.length;ae++){let le=this.children[ae],ue=ne+le.length;if(ue>W)break;if(ne>=E){let ge=le.dom.getBoundingClientRect();if(T.push(ge.height),q){let ye=le.dom.lastChild,xe=ye?clientRectsFor(ye):[];if(xe.length){let Te=xe[xe.length-1],Ae=te?Te.right-ge.left:ge.right-Te.left;Ae>Y&&(Y=Ae,this.minWidth=X,this.minWidthFrom=ne,this.minWidthTo=ue)}}}ne=ue+le.breakAfter}return T}textDirectionAt(_){let{i:T}=this.childPos(_,1);return getComputedStyle(this.children[T].dom).direction=="rtl"?Direction.RTL:Direction.LTR}measureTextSize(){for(let X of this.children)if(X instanceof LineView){let q=X.measureTextSize();if(q)return q}let _=document.createElement("div"),T,E,W;return _.className="cm-line",_.style.width="99999px",_.style.position="absolute",_.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(_);let X=clientRectsFor(_.firstChild)[0];T=_.getBoundingClientRect().height,E=X?X.width/27:7,W=X?X.height:T,_.remove()}),{lineHeight:T,charWidth:E,textHeight:W}}childCursor(_=this.length){let T=this.children.length;return T&&(_-=this.children[--T].length),new ChildCursor(this.children,_,T)}computeBlockGapDeco(){let _=[],T=this.view.viewState;for(let E=0,W=0;;W++){let X=W==T.viewports.length?null:T.viewports[W],q=X?X.from-1:this.length;if(q>E){let Y=(T.lineBlockAt(q).bottom-T.lineBlockAt(E).top)/this.view.scaleY;_.push(Decoration.replace({widget:new BlockGapWidget(Y),block:!0,inclusive:!0,isBlockGap:!0}).range(E,q))}if(!X)break;E=X.to+1}return Decoration.set(_)}updateDeco(){let _=1,T=this.view.state.facet(decorations).map(X=>(this.dynamicDecorationMap[_++]=typeof X=="function")?X(this.view):X),E=!1,W=this.view.state.facet(outerDecorations).map((X,q)=>{let Y=typeof X=="function";return Y&&(E=!0),Y?X(this.view):X});for(W.length&&(this.dynamicDecorationMap[_++]=E,T.push(RangeSet.join(W))),this.decorations=[this.editContextFormatting,...T,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];_<this.decorations.length;)this.dynamicDecorationMap[_++]=!1;return this.decorations}scrollIntoView(_){if(_.isSnapshot){let ne=this.view.viewState.lineBlockAt(_.range.head);this.view.scrollDOM.scrollTop=ne.top-_.yMargin,this.view.scrollDOM.scrollLeft=_.xMargin;return}for(let ne of this.view.state.facet(scrollHandler))try{if(ne(this.view,_.range,_))return!0}catch(ae){logException(this.view.state,ae,"scroll handler")}let{range:T}=_,E=this.coordsAt(T.head,T.empty?T.assoc:T.head>T.anchor?-1:1),W;if(!E)return;!T.empty&&(W=this.coordsAt(T.anchor,T.anchor>T.head?-1:1))&&(E={left:Math.min(E.left,W.left),top:Math.min(E.top,W.top),right:Math.max(E.right,W.right),bottom:Math.max(E.bottom,W.bottom)});let X=getScrollMargins(this.view),q={left:E.left-X.left,top:E.top-X.top,right:E.right+X.right,bottom:E.bottom+X.bottom},{offsetWidth:Y,offsetHeight:te}=this.view.scrollDOM;scrollRectIntoView(this.view.scrollDOM,q,T.head<T.anchor?-1:1,_.x,_.y,Math.max(Math.min(_.xMargin,Y),-Y),Math.max(Math.min(_.yMargin,te),-te),this.view.textDirection==Direction.LTR)}}function betweenUneditable(B){return B.node.nodeType==1&&B.node.firstChild&&(B.offset==0||B.node.childNodes[B.offset-1].contentEditable=="false")&&(B.offset==B.node.childNodes.length||B.node.childNodes[B.offset].contentEditable=="false")}function findCompositionNode(B,_){let T=B.observer.selectionRange;if(!T.focusNode)return null;let E=textNodeBefore(T.focusNode,T.focusOffset),W=textNodeAfter(T.focusNode,T.focusOffset),X=E||W;if(W&&E&&W.node!=E.node){let Y=ContentView.get(W.node);if(!Y||Y instanceof TextView&&Y.text!=W.node.nodeValue)X=W;else if(B.docView.lastCompositionAfterCursor){let te=ContentView.get(E.node);!te||te instanceof TextView&&te.text!=E.node.nodeValue||(X=W)}}if(B.docView.lastCompositionAfterCursor=X!=E,!X)return null;let q=_-X.offset;return{from:q,to:q+X.node.nodeValue.length,node:X.node}}function findCompositionRange(B,_,T){let E=findCompositionNode(B,T);if(!E)return null;let{node:W,from:X,to:q}=E,Y=W.nodeValue;if(/[\n\r]/.test(Y)||B.state.doc.sliceString(E.from,E.to)!=Y)return null;let te=_.invertedDesc,ne=new ChangedRange(te.mapPos(X),te.mapPos(q),X,q),ae=[];for(let le=W.parentNode;;le=le.parentNode){let ue=ContentView.get(le);if(ue instanceof MarkView)ae.push({node:le,deco:ue.mark});else{if(ue instanceof LineView||le.nodeName=="DIV"&&le.parentNode==B.contentDOM)return{range:ne,text:W,marks:ae,line:le};if(le!=B.contentDOM)ae.push({node:le,deco:new MarkDecoration({inclusive:!0,attributes:getAttrs(le),tagName:le.tagName.toLowerCase()})});else return null}}}function nextToUneditable(B,_){return B.nodeType!=1?0:(_&&B.childNodes[_-1].contentEditable=="false"?1:0)|(_<B.childNodes.length&&B.childNodes[_].contentEditable=="false"?2:0)}let DecorationComparator$1=class{constructor(){this.changes=[]}compareRange(_,T){addRange(_,T,this.changes)}comparePoint(_,T){addRange(_,T,this.changes)}};function findChangedDeco(B,_,T){let E=new DecorationComparator$1;return RangeSet.compare(B,_,T,E),E.changes}function inUneditable(B,_){for(let T=B;T&&T!=_;T=T.assignedSlot||T.parentNode)if(T.nodeType==1&&T.contentEditable=="false")return!0;return!1}function touchesComposition(B,_){let T=!1;return _&&B.iterChangedRanges((E,W)=>{E<_.to&&W>_.from&&(T=!0)}),T}function groupAt(B,_,T=1){let E=B.charCategorizer(_),W=B.doc.lineAt(_),X=_-W.from;if(W.length==0)return EditorSelection.cursor(_);X==0?T=1:X==W.length&&(T=-1);let q=X,Y=X;T<0?q=findClusterBreak(W.text,X,!1):Y=findClusterBreak(W.text,X);let te=E(W.text.slice(q,Y));for(;q>0;){let ne=findClusterBreak(W.text,q,!1);if(E(W.text.slice(ne,q))!=te)break;q=ne}for(;Y<W.length;){let ne=findClusterBreak(W.text,Y);if(E(W.text.slice(Y,ne))!=te)break;Y=ne}return EditorSelection.range(q+W.from,Y+W.from)}function getdx(B,_){return _.left>B?_.left-B:Math.max(0,B-_.right)}function getdy(B,_){return _.top>B?_.top-B:Math.max(0,B-_.bottom)}function yOverlap(B,_){return B.top<_.bottom-1&&B.bottom>_.top+1}function upTop(B,_){return _<B.top?{top:_,left:B.left,right:B.right,bottom:B.bottom}:B}function upBot(B,_){return _>B.bottom?{top:B.top,left:B.left,right:B.right,bottom:_}:B}function domPosAtCoords(B,_,T){let E,W,X,q,Y=!1,te,ne,ae,le;for(let ye=B.firstChild;ye;ye=ye.nextSibling){let xe=clientRectsFor(ye);for(let Te=0;Te<xe.length;Te++){let Ae=xe[Te];W&&yOverlap(W,Ae)&&(Ae=upTop(upBot(Ae,W.bottom),W.top));let Ie=getdx(_,Ae),Ve=getdy(T,Ae);if(Ie==0&&Ve==0)return ye.nodeType==3?domPosInText(ye,_,T):domPosAtCoords(ye,_,T);if(!E||q>Ve||q==Ve&&X>Ie){E=ye,W=Ae,X=Ie,q=Ve;let $e=Ve?T<Ae.top?-1:1:Ie?_<Ae.left?-1:1:0;Y=!$e||($e>0?Te<xe.length-1:Te>0)}Ie==0?T>Ae.bottom&&(!ae||ae.bottom<Ae.bottom)?(te=ye,ae=Ae):T<Ae.top&&(!le||le.top>Ae.top)&&(ne=ye,le=Ae):ae&&yOverlap(ae,Ae)?ae=upBot(ae,Ae.bottom):le&&yOverlap(le,Ae)&&(le=upTop(le,Ae.top))}}if(ae&&ae.bottom>=T?(E=te,W=ae):le&&le.top<=T&&(E=ne,W=le),!E)return{node:B,offset:0};let ue=Math.max(W.left,Math.min(W.right,_));if(E.nodeType==3)return domPosInText(E,ue,T);if(Y&&E.contentEditable!="false")return domPosAtCoords(E,ue,T);let ge=Array.prototype.indexOf.call(B.childNodes,E)+(_>=(W.left+W.right)/2?1:0);return{node:B,offset:ge}}function domPosInText(B,_,T){let E=B.nodeValue.length,W=-1,X=1e9,q=0;for(let Y=0;Y<E;Y++){let te=textRange(B,Y,Y+1).getClientRects();for(let ne=0;ne<te.length;ne++){let ae=te[ne];if(ae.top==ae.bottom)continue;q||(q=_-ae.left);let le=(ae.top>T?ae.top-T:T-ae.bottom)-1;if(ae.left-1<=_&&ae.right+1>=_&&le<X){let ue=_>=(ae.left+ae.right)/2,ge=ue;if((browser.chrome||browser.gecko)&&textRange(B,Y).getBoundingClientRect().left==ae.right&&(ge=!ue),le<=0)return{node:B,offset:Y+(ge?1:0)};W=Y+(ge?1:0),X=le}}}return{node:B,offset:W>-1?W:q>0?B.nodeValue.length:0}}function posAtCoords(B,_,T,E=-1){var W,X;let q=B.contentDOM.getBoundingClientRect(),Y=q.top+B.viewState.paddingTop,te,{docHeight:ne}=B.viewState,{x:ae,y:le}=_,ue=le-Y;if(ue<0)return 0;if(ue>ne)return B.state.doc.length;for(let $e=B.viewState.heightOracle.textHeight/2,We=!1;te=B.elementAtHeight(ue),te.type!=BlockType.Text;)for(;ue=E>0?te.bottom+$e:te.top-$e,!(ue>=0&&ue<=ne);){if(We)return T?null:0;We=!0,E=-E}le=Y+ue;let ge=te.from;if(ge<B.viewport.from)return B.viewport.from==0?0:T?null:posAtCoordsImprecise(B,q,te,ae,le);if(ge>B.viewport.to)return B.viewport.to==B.state.doc.length?B.state.doc.length:T?null:posAtCoordsImprecise(B,q,te,ae,le);let ye=B.dom.ownerDocument,xe=B.root.elementFromPoint?B.root:ye,Te=xe.elementFromPoint(ae,le);Te&&!B.contentDOM.contains(Te)&&(Te=null),Te||(ae=Math.max(q.left+1,Math.min(q.right-1,ae)),Te=xe.elementFromPoint(ae,le),Te&&!B.contentDOM.contains(Te)&&(Te=null));let Ae,Ie=-1;if(Te&&((W=B.docView.nearest(Te))===null||W===void 0?void 0:W.isEditable)!=!1){if(ye.caretPositionFromPoint){let $e=ye.caretPositionFromPoint(ae,le);$e&&({offsetNode:Ae,offset:Ie}=$e)}else if(ye.caretRangeFromPoint){let $e=ye.caretRangeFromPoint(ae,le);$e&&({startContainer:Ae,startOffset:Ie}=$e,(!B.contentDOM.contains(Ae)||browser.safari&&isSuspiciousSafariCaretResult(Ae,Ie,ae)||browser.chrome&&isSuspiciousChromeCaretResult(Ae,Ie,ae))&&(Ae=void 0))}}if(!Ae||!B.docView.dom.contains(Ae)){let $e=LineView.find(B.docView,ge);if(!$e)return ue>te.top+te.height/2?te.to:te.from;({node:Ae,offset:Ie}=domPosAtCoords($e.dom,ae,le))}let Ve=B.docView.nearest(Ae);if(!Ve)return null;if(Ve.isWidget&&((X=Ve.dom)===null||X===void 0?void 0:X.nodeType)==1){let $e=Ve.dom.getBoundingClientRect();return _.y<$e.top||_.y<=$e.bottom&&_.x<=($e.left+$e.right)/2?Ve.posAtStart:Ve.posAtEnd}else return Ve.localPosFromDOM(Ae,Ie)+Ve.posAtStart}function posAtCoordsImprecise(B,_,T,E,W){let X=Math.round((E-_.left)*B.defaultCharacterWidth);if(B.lineWrapping&&T.height>B.defaultLineHeight*1.5){let Y=B.viewState.heightOracle.textHeight,te=Math.floor((W-T.top-(B.defaultLineHeight-Y)*.5)/Y);X+=te*B.viewState.heightOracle.lineLength}let q=B.state.sliceDoc(T.from,T.to);return T.from+findColumn(q,X,B.state.tabSize)}function isSuspiciousSafariCaretResult(B,_,T){let E;if(B.nodeType!=3||_!=(E=B.nodeValue.length))return!1;for(let W=B.nextSibling;W;W=W.nextSibling)if(W.nodeType!=1||W.nodeName!="BR")return!1;return textRange(B,E-1,E).getBoundingClientRect().left>T}function isSuspiciousChromeCaretResult(B,_,T){if(_!=0)return!1;for(let W=B;;){let X=W.parentNode;if(!X||X.nodeType!=1||X.firstChild!=W)return!1;if(X.classList.contains("cm-line"))break;W=X}let E=B.nodeType==1?B.getBoundingClientRect():textRange(B,0,Math.max(B.nodeValue.length,1)).getBoundingClientRect();return T-E.left>5}function blockAt(B,_){let T=B.lineBlockAt(_);if(Array.isArray(T.type)){for(let E of T.type)if(E.to>_||E.to==_&&(E.to==T.to||E.type==BlockType.Text))return E}return T}function moveToLineBoundary(B,_,T,E){let W=blockAt(B,_.head),X=!E||W.type!=BlockType.Text||!(B.lineWrapping||W.widgetLineBreaks)?null:B.coordsAtPos(_.assoc<0&&_.head>W.from?_.head-1:_.head);if(X){let q=B.dom.getBoundingClientRect(),Y=B.textDirectionAt(W.from),te=B.posAtCoords({x:T==(Y==Direction.LTR)?q.right-1:q.left+1,y:(X.top+X.bottom)/2});if(te!=null)return EditorSelection.cursor(te,T?-1:1)}return EditorSelection.cursor(T?W.to:W.from,T?-1:1)}function moveByChar(B,_,T,E){let W=B.state.doc.lineAt(_.head),X=B.bidiSpans(W),q=B.textDirectionAt(W.from);for(let Y=_,te=null;;){let ne=moveVisually(W,X,q,Y,T),ae=movedOver;if(!ne){if(W.number==(T?B.state.doc.lines:1))return Y;ae=`
`,W=B.state.doc.line(W.number+(T?1:-1)),X=B.bidiSpans(W),ne=B.visualLineSide(W,!T)}if(te){if(!te(ae))return Y}else{if(!E)return ne;te=E(ae)}Y=ne}}function byGroup(B,_,T){let E=B.state.charCategorizer(_),W=E(T);return X=>{let q=E(X);return W==CharCategory.Space&&(W=q),W==q}}function moveVertically(B,_,T,E){let W=_.head,X=T?1:-1;if(W==(T?B.state.doc.length:0))return EditorSelection.cursor(W,_.assoc);let q=_.goalColumn,Y,te=B.contentDOM.getBoundingClientRect(),ne=B.coordsAtPos(W,_.assoc||-1),ae=B.documentTop;if(ne)q==null&&(q=ne.left-te.left),Y=X<0?ne.top:ne.bottom;else{let ge=B.viewState.lineBlockAt(W);q==null&&(q=Math.min(te.right-te.left,B.defaultCharacterWidth*(W-ge.from))),Y=(X<0?ge.top:ge.bottom)+ae}let le=te.left+q,ue=E??B.viewState.heightOracle.textHeight>>1;for(let ge=0;;ge+=10){let ye=Y+(ue+ge)*X,xe=posAtCoords(B,{x:le,y:ye},!1,X);if(ye<te.top||ye>te.bottom||(X<0?xe<W:xe>W)){let Te=B.docView.coordsForChar(xe),Ae=!Te||ye<Te.top?-1:1;return EditorSelection.cursor(xe,Ae,void 0,q)}}}function skipAtomicRanges(B,_,T){for(;;){let E=0;for(let W of B)W.between(_-1,_+1,(X,q,Y)=>{if(_>X&&_<q){let te=E||T||(_-X<q-_?-1:1);_=te<0?X:q,E=te}});if(!E)return _}}function skipAtoms(B,_,T){let E=skipAtomicRanges(B.state.facet(atomicRanges).map(W=>W(B)),T.from,_.head>T.from?-1:1);return E==T.from?T:EditorSelection.cursor(E,E<T.from?1:-1)}const LineBreakPlaceholder="";class DOMReader{constructor(_,T){this.points=_,this.text="",this.lineSeparator=T.facet(EditorState.lineSeparator)}append(_){this.text+=_}lineBreak(){this.text+=LineBreakPlaceholder}readRange(_,T){if(!_)return this;let E=_.parentNode;for(let W=_;;){this.findPointBefore(E,W);let X=this.text.length;this.readNode(W);let q=W.nextSibling;if(q==T)break;let Y=ContentView.get(W),te=ContentView.get(q);(Y&&te?Y.breakAfter:(Y?Y.breakAfter:isBlockElement(W))||isBlockElement(q)&&(W.nodeName!="BR"||W.cmIgnore)&&this.text.length>X)&&this.lineBreak(),W=q}return this.findPointBefore(E,T),this}readTextNode(_){let T=_.nodeValue;for(let E of this.points)E.node==_&&(E.pos=this.text.length+Math.min(E.offset,T.length));for(let E=0,W=this.lineSeparator?null:/\r\n?|\n/g;;){let X=-1,q=1,Y;if(this.lineSeparator?(X=T.indexOf(this.lineSeparator,E),q=this.lineSeparator.length):(Y=W.exec(T))&&(X=Y.index,q=Y[0].length),this.append(T.slice(E,X<0?T.length:X)),X<0)break;if(this.lineBreak(),q>1)for(let te of this.points)te.node==_&&te.pos>this.text.length&&(te.pos-=q-1);E=X+q}}readNode(_){if(_.cmIgnore)return;let T=ContentView.get(_),E=T&&T.overrideDOMText;if(E!=null){this.findPointInside(_,E.length);for(let W=E.iter();!W.next().done;)W.lineBreak?this.lineBreak():this.append(W.value)}else _.nodeType==3?this.readTextNode(_):_.nodeName=="BR"?_.nextSibling&&this.lineBreak():_.nodeType==1&&this.readRange(_.firstChild,null)}findPointBefore(_,T){for(let E of this.points)E.node==_&&_.childNodes[E.offset]==T&&(E.pos=this.text.length)}findPointInside(_,T){for(let E of this.points)(_.nodeType==3?E.node==_:_.contains(E.node))&&(E.pos=this.text.length+(isAtEnd(_,E.node,E.offset)?T:0))}}function isAtEnd(B,_,T){for(;;){if(!_||T<maxOffset(_))return!1;if(_==B)return!0;T=domIndex(_)+1,_=_.parentNode}}class DOMPoint{constructor(_,T){this.node=_,this.offset=T,this.pos=-1}}class DOMChange{constructor(_,T,E,W){this.typeOver=W,this.bounds=null,this.text="",this.domChanged=T>-1;let{impreciseHead:X,impreciseAnchor:q}=_.docView;if(_.state.readOnly&&T>-1)this.newSel=null;else if(T>-1&&(this.bounds=_.docView.domBoundsAround(T,E,0))){let Y=X||q?[]:selectionPoints(_),te=new DOMReader(Y,_.state);te.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=te.text,this.newSel=selectionFromPoints(Y,this.bounds.from)}else{let Y=_.observer.selectionRange,te=X&&X.node==Y.focusNode&&X.offset==Y.focusOffset||!contains(_.contentDOM,Y.focusNode)?_.state.selection.main.head:_.docView.posFromDOM(Y.focusNode,Y.focusOffset),ne=q&&q.node==Y.anchorNode&&q.offset==Y.anchorOffset||!contains(_.contentDOM,Y.anchorNode)?_.state.selection.main.anchor:_.docView.posFromDOM(Y.anchorNode,Y.anchorOffset),ae=_.viewport;if((browser.ios||browser.chrome)&&_.state.selection.main.empty&&te!=ne&&(ae.from>0||ae.to<_.state.doc.length)){let le=Math.min(te,ne),ue=Math.max(te,ne),ge=ae.from-le,ye=ae.to-ue;(ge==0||ge==1||le==0)&&(ye==0||ye==-1||ue==_.state.doc.length)&&(te=0,ne=_.state.doc.length)}this.newSel=EditorSelection.single(ne,te)}}}function applyDOMChange(B,_){let T,{newSel:E}=_,W=B.state.selection.main,X=B.inputState.lastKeyTime>Date.now()-100?B.inputState.lastKeyCode:-1;if(_.bounds){let{from:q,to:Y}=_.bounds,te=W.from,ne=null;(X===8||browser.android&&_.text.length<Y-q)&&(te=W.to,ne="end");let ae=findDiff(B.state.doc.sliceString(q,Y,LineBreakPlaceholder),_.text,te-q,ne);ae&&(browser.chrome&&X==13&&ae.toB==ae.from+2&&_.text.slice(ae.from,ae.toB)==LineBreakPlaceholder+LineBreakPlaceholder&&ae.toB--,T={from:q+ae.from,to:q+ae.toA,insert:Text.of(_.text.slice(ae.from,ae.toB).split(LineBreakPlaceholder))})}else E&&(!B.hasFocus&&B.state.facet(editable)||E.main.eq(W))&&(E=null);if(!T&&!E)return!1;if(!T&&_.typeOver&&!W.empty&&E&&E.main.empty?T={from:W.from,to:W.to,insert:B.state.doc.slice(W.from,W.to)}:T&&T.from>=W.from&&T.to<=W.to&&(T.from!=W.from||T.to!=W.to)&&W.to-W.from-(T.to-T.from)<=4?T={from:W.from,to:W.to,insert:B.state.doc.slice(W.from,T.from).append(T.insert).append(B.state.doc.slice(T.to,W.to))}:(browser.mac||browser.android)&&T&&T.from==T.to&&T.from==W.head-1&&/^\. ?$/.test(T.insert.toString())&&B.contentDOM.getAttribute("autocorrect")=="off"?(E&&T.insert.length==2&&(E=EditorSelection.single(E.main.anchor-1,E.main.head-1)),T={from:W.from,to:W.to,insert:Text.of([" "])}):browser.chrome&&T&&T.from==T.to&&T.from==W.head&&T.insert.toString()==`
 `&&B.lineWrapping&&(E&&(E=EditorSelection.single(E.main.anchor-1,E.main.head-1)),T={from:W.from,to:W.to,insert:Text.of([" "])}),T)return applyDOMChangeInner(B,T,E,X);if(E&&!E.main.eq(W)){let q=!1,Y="select";return B.inputState.lastSelectionTime>Date.now()-50&&(B.inputState.lastSelectionOrigin=="select"&&(q=!0),Y=B.inputState.lastSelectionOrigin),B.dispatch({selection:E,scrollIntoView:q,userEvent:Y}),!0}else return!1}function applyDOMChangeInner(B,_,T,E=-1){if(browser.ios&&B.inputState.flushIOSKey(_))return!0;let W=B.state.selection.main;if(browser.android&&(_.to==W.to&&(_.from==W.from||_.from==W.from-1&&B.state.sliceDoc(_.from,W.from)==" ")&&_.insert.length==1&&_.insert.lines==2&&dispatchKey(B.contentDOM,"Enter",13)||(_.from==W.from-1&&_.to==W.to&&_.insert.length==0||E==8&&_.insert.length<_.to-_.from&&_.to>W.head)&&dispatchKey(B.contentDOM,"Backspace",8)||_.from==W.from&&_.to==W.to+1&&_.insert.length==0&&dispatchKey(B.contentDOM,"Delete",46)))return!0;let X=_.insert.toString();B.inputState.composing>=0&&B.inputState.composing++;let q,Y=()=>q||(q=applyDefaultInsert(B,_,T));return B.state.facet(inputHandler$1).some(te=>te(B,_.from,_.to,X,Y))||B.dispatch(Y()),!0}function applyDefaultInsert(B,_,T){let E,W=B.state,X=W.selection.main;if(_.from>=X.from&&_.to<=X.to&&_.to-_.from>=(X.to-X.from)/3&&(!T||T.main.empty&&T.main.from==_.from+_.insert.length)&&B.inputState.composing<0){let Y=X.from<_.from?W.sliceDoc(X.from,_.from):"",te=X.to>_.to?W.sliceDoc(_.to,X.to):"";E=W.replaceSelection(B.state.toText(Y+_.insert.sliceString(0,void 0,B.state.lineBreak)+te))}else{let Y=W.changes(_),te=T&&T.main.to<=Y.newLength?T.main:void 0;if(W.selection.ranges.length>1&&B.inputState.composing>=0&&_.to<=X.to&&_.to>=X.to-10){let ne=B.state.sliceDoc(_.from,_.to),ae,le=T&&findCompositionNode(B,T.main.head);if(le){let ye=_.insert.length-(_.to-_.from);ae={from:le.from,to:le.to-ye}}else ae=B.state.doc.lineAt(X.head);let ue=X.to-_.to,ge=X.to-X.from;E=W.changeByRange(ye=>{if(ye.from==X.from&&ye.to==X.to)return{changes:Y,range:te||ye.map(Y)};let xe=ye.to-ue,Te=xe-ne.length;if(ye.to-ye.from!=ge||B.state.sliceDoc(Te,xe)!=ne||ye.to>=ae.from&&ye.from<=ae.to)return{range:ye};let Ae=W.changes({from:Te,to:xe,insert:_.insert}),Ie=ye.to-X.to;return{changes:Ae,range:te?EditorSelection.range(Math.max(0,te.anchor+Ie),Math.max(0,te.head+Ie)):ye.map(Ae)}})}else E={changes:Y,selection:te&&W.selection.replaceRange(te)}}let q="input.type";return(B.composing||B.inputState.compositionPendingChange&&B.inputState.compositionEndedAt>Date.now()-50)&&(B.inputState.compositionPendingChange=!1,q+=".compose",B.inputState.compositionFirstChange&&(q+=".start",B.inputState.compositionFirstChange=!1)),W.update(E,{userEvent:q,scrollIntoView:!0})}function findDiff(B,_,T,E){let W=Math.min(B.length,_.length),X=0;for(;X<W&&B.charCodeAt(X)==_.charCodeAt(X);)X++;if(X==W&&B.length==_.length)return null;let q=B.length,Y=_.length;for(;q>0&&Y>0&&B.charCodeAt(q-1)==_.charCodeAt(Y-1);)q--,Y--;if(E=="end"){let te=Math.max(0,X-Math.min(q,Y));T-=q+te-X}if(q<X&&B.length<_.length){let te=T<=X&&T>=q?X-T:0;X-=te,Y=X+(Y-q),q=X}else if(Y<X){let te=T<=X&&T>=Y?X-T:0;X-=te,q=X+(q-Y),Y=X}return{from:X,toA:q,toB:Y}}function selectionPoints(B){let _=[];if(B.root.activeElement!=B.contentDOM)return _;let{anchorNode:T,anchorOffset:E,focusNode:W,focusOffset:X}=B.observer.selectionRange;return T&&(_.push(new DOMPoint(T,E)),(W!=T||X!=E)&&_.push(new DOMPoint(W,X))),_}function selectionFromPoints(B,_){if(B.length==0)return null;let T=B[0].pos,E=B.length==2?B[1].pos:T;return T>-1&&E>-1?EditorSelection.single(T+_,E+_):null}class InputState{setSelectionOrigin(_){this.lastSelectionOrigin=_,this.lastSelectionTime=Date.now()}constructor(_){this.view=_,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=_.hasFocus,browser.safari&&_.contentDOM.addEventListener("input",()=>null),browser.gecko&&firefoxCopyCutHack(_.contentDOM.ownerDocument)}handleEvent(_){!eventBelongsToEditor(this.view,_)||this.ignoreDuringComposition(_)||_.type=="keydown"&&this.keydown(_)||this.runHandlers(_.type,_)}runHandlers(_,T){let E=this.handlers[_];if(E){for(let W of E.observers)W(this.view,T);for(let W of E.handlers){if(T.defaultPrevented)break;if(W(this.view,T)){T.preventDefault();break}}}}ensureHandlers(_){let T=computeHandlers(_),E=this.handlers,W=this.view.contentDOM;for(let X in T)if(X!="scroll"){let q=!T[X].handlers.length,Y=E[X];Y&&q!=!Y.handlers.length&&(W.removeEventListener(X,this.handleEvent),Y=null),Y||W.addEventListener(X,this.handleEvent,{passive:q})}for(let X in E)X!="scroll"&&!T[X]&&W.removeEventListener(X,this.handleEvent);this.handlers=T}keydown(_){if(this.lastKeyCode=_.keyCode,this.lastKeyTime=Date.now(),_.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&_.keyCode!=27&&modifierCodes.indexOf(_.keyCode)<0&&(this.tabFocusMode=-1),browser.android&&browser.chrome&&!_.synthetic&&(_.keyCode==13||_.keyCode==8))return this.view.observer.delayAndroidKey(_.key,_.keyCode),!0;let T;return browser.ios&&!_.synthetic&&!_.altKey&&!_.metaKey&&((T=PendingKeys.find(E=>E.keyCode==_.keyCode))&&!_.ctrlKey||EmacsyPendingKeys.indexOf(_.key)>-1&&_.ctrlKey&&!_.shiftKey)?(this.pendingIOSKey=T||_,setTimeout(()=>this.flushIOSKey(),250),!0):(_.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(_){let T=this.pendingIOSKey;return!T||T.key=="Enter"&&_&&_.from<_.to&&/^\S+$/.test(_.insert.toString())?!1:(this.pendingIOSKey=void 0,dispatchKey(this.view.contentDOM,T.key,T.keyCode,T instanceof KeyboardEvent?T:void 0))}ignoreDuringComposition(_){return/^key/.test(_.type)?this.composing>0?!0:browser.safari&&!browser.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(_){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=_}update(_){this.view.observer.update(_),this.mouseSelection&&this.mouseSelection.update(_),this.draggedContent&&_.docChanged&&(this.draggedContent=this.draggedContent.map(_.changes)),_.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function bindHandler(B,_){return(T,E)=>{try{return _.call(B,E,T)}catch(W){logException(T.state,W)}}}function computeHandlers(B){let _=Object.create(null);function T(E){return _[E]||(_[E]={observers:[],handlers:[]})}for(let E of B){let W=E.spec;if(W&&W.domEventHandlers)for(let X in W.domEventHandlers){let q=W.domEventHandlers[X];q&&T(X).handlers.push(bindHandler(E.value,q))}if(W&&W.domEventObservers)for(let X in W.domEventObservers){let q=W.domEventObservers[X];q&&T(X).observers.push(bindHandler(E.value,q))}}for(let E in handlers)T(E).handlers.push(handlers[E]);for(let E in observers)T(E).observers.push(observers[E]);return _}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225],dragScrollMargin=6;function dragScrollSpeed(B){return Math.max(0,B)*.7+8}function dist$1(B,_){return Math.max(Math.abs(B.clientX-_.clientX),Math.abs(B.clientY-_.clientY))}class MouseSelection{constructor(_,T,E,W){this.view=_,this.startEvent=T,this.style=E,this.mustSelect=W,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=T,this.scrollParents=scrollableParents(_.contentDOM),this.atoms=_.state.facet(atomicRanges).map(q=>q(_));let X=_.contentDOM.ownerDocument;X.addEventListener("mousemove",this.move=this.move.bind(this)),X.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=T.shiftKey,this.multiple=_.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(_,T),this.dragging=isInPrimarySelection(_,T)&&getClickType(T)==1?null:!1}start(_){this.dragging===!1&&this.select(_)}move(_){if(_.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&dist$1(this.startEvent,_)<10)return;this.select(this.lastEvent=_);let T=0,E=0,W=0,X=0,q=this.view.win.innerWidth,Y=this.view.win.innerHeight;this.scrollParents.x&&({left:W,right:q}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:X,bottom:Y}=this.scrollParents.y.getBoundingClientRect());let te=getScrollMargins(this.view);_.clientX-te.left<=W+dragScrollMargin?T=-dragScrollSpeed(W-_.clientX):_.clientX+te.right>=q-dragScrollMargin&&(T=dragScrollSpeed(_.clientX-q)),_.clientY-te.top<=X+dragScrollMargin?E=-dragScrollSpeed(X-_.clientY):_.clientY+te.bottom>=Y-dragScrollMargin&&(E=dragScrollSpeed(_.clientY-Y)),this.setScrollSpeed(T,E)}up(_){this.dragging==null&&this.select(this.lastEvent),this.dragging||_.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let _=this.view.contentDOM.ownerDocument;_.removeEventListener("mousemove",this.move),_.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(_,T){this.scrollSpeed={x:_,y:T},_||T?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:_,y:T}=this.scrollSpeed;_&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=_,_=0),T&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=T,T=0),(_||T)&&this.view.win.scrollBy(_,T),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(_){let T=null;for(let E=0;E<_.ranges.length;E++){let W=_.ranges[E],X=null;if(W.empty){let q=skipAtomicRanges(this.atoms,W.from,0);q!=W.from&&(X=EditorSelection.cursor(q,-1))}else{let q=skipAtomicRanges(this.atoms,W.from,-1),Y=skipAtomicRanges(this.atoms,W.to,1);(q!=W.from||Y!=W.to)&&(X=EditorSelection.range(W.from==W.anchor?q:Y,W.from==W.head?q:Y))}X&&(T||(T=_.ranges.slice()),T[E]=X)}return T?EditorSelection.create(T,_.mainIndex):_}select(_){let{view:T}=this,E=this.skipAtoms(this.style.get(_,this.extend,this.multiple));(this.mustSelect||!E.eq(T.state.selection,this.dragging===!1))&&this.view.dispatch({selection:E,userEvent:"select.pointer"}),this.mustSelect=!1}update(_){_.transactions.some(T=>T.isUserEvent("input.type"))?this.destroy():this.style.update(_)&&setTimeout(()=>this.select(this.lastEvent),20)}}function addsSelectionRange(B,_){let T=B.state.facet(clickAddsSelectionRange);return T.length?T[0](_):browser.mac?_.metaKey:_.ctrlKey}function dragMovesSelection(B,_){let T=B.state.facet(dragMovesSelection$1);return T.length?T[0](_):browser.mac?!_.altKey:!_.ctrlKey}function isInPrimarySelection(B,_){let{main:T}=B.state.selection;if(T.empty)return!1;let E=getSelection(B.root);if(!E||E.rangeCount==0)return!0;let W=E.getRangeAt(0).getClientRects();for(let X=0;X<W.length;X++){let q=W[X];if(q.left<=_.clientX&&q.right>=_.clientX&&q.top<=_.clientY&&q.bottom>=_.clientY)return!0}return!1}function eventBelongsToEditor(B,_){if(!_.bubbles)return!0;if(_.defaultPrevented)return!1;for(let T=_.target,E;T!=B.contentDOM;T=T.parentNode)if(!T||T.nodeType==11||(E=ContentView.get(T))&&E.ignoreEvent(_))return!1;return!0}const handlers=Object.create(null),observers=Object.create(null),brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(B){let _=B.dom.parentNode;if(!_)return;let T=_.appendChild(document.createElement("textarea"));T.style.cssText="position: fixed; left: -10000px; top: 10px",T.focus(),setTimeout(()=>{B.focus(),T.remove(),doPaste(B,T.value)},50)}function textFilter(B,_,T){for(let E of B.facet(_))T=E(T,B);return T}function doPaste(B,_){_=textFilter(B.state,clipboardInputFilter,_);let{state:T}=B,E,W=1,X=T.toText(_),q=X.lines==T.selection.ranges.length;if(lastLinewiseCopy!=null&&T.selection.ranges.every(te=>te.empty)&&lastLinewiseCopy==X.toString()){let te=-1;E=T.changeByRange(ne=>{let ae=T.doc.lineAt(ne.from);if(ae.from==te)return{range:ne};te=ae.from;let le=T.toText((q?X.line(W++).text:_)+T.lineBreak);return{changes:{from:ae.from,insert:le},range:EditorSelection.cursor(ne.from+le.length)}})}else q?E=T.changeByRange(te=>{let ne=X.line(W++);return{changes:{from:te.from,to:te.to,insert:ne.text},range:EditorSelection.cursor(te.from+ne.length)}}):E=T.replaceSelection(X);B.dispatch(E,{userEvent:"input.paste",scrollIntoView:!0})}observers.scroll=B=>{B.inputState.lastScrollTop=B.scrollDOM.scrollTop,B.inputState.lastScrollLeft=B.scrollDOM.scrollLeft};handlers.keydown=(B,_)=>(B.inputState.setSelectionOrigin("select"),_.keyCode==27&&B.inputState.tabFocusMode!=0&&(B.inputState.tabFocusMode=Date.now()+2e3),!1);observers.touchstart=(B,_)=>{B.inputState.lastTouchTime=Date.now(),B.inputState.setSelectionOrigin("select.pointer")};observers.touchmove=B=>{B.inputState.setSelectionOrigin("select.pointer")};handlers.mousedown=(B,_)=>{if(B.observer.flush(),B.inputState.lastTouchTime>Date.now()-2e3)return!1;let T=null;for(let E of B.state.facet(mouseSelectionStyle))if(T=E(B,_),T)break;if(!T&&_.button==0&&(T=basicMouseSelection(B,_)),T){let E=!B.hasFocus;B.inputState.startMouseSelection(new MouseSelection(B,_,T,E)),E&&B.observer.ignore(()=>{focusPreventScroll(B.contentDOM);let X=B.root.activeElement;X&&!X.contains(B.contentDOM)&&X.blur()});let W=B.inputState.mouseSelection;if(W)return W.start(_),W.dragging===!1}return!1};function rangeForClick(B,_,T,E){if(E==1)return EditorSelection.cursor(_,T);if(E==2)return groupAt(B.state,_,T);{let W=LineView.find(B.docView,_),X=B.state.doc.lineAt(W?W.posAtEnd:_),q=W?W.posAtStart:X.from,Y=W?W.posAtEnd:X.to;return Y<B.state.doc.length&&Y==X.to&&Y++,EditorSelection.range(q,Y)}}let inside=(B,_,T)=>_>=T.top&&_<=T.bottom&&B>=T.left&&B<=T.right;function findPositionSide(B,_,T,E){let W=LineView.find(B.docView,_);if(!W)return 1;let X=_-W.posAtStart;if(X==0)return 1;if(X==W.length)return-1;let q=W.coordsAt(X,-1);if(q&&inside(T,E,q))return-1;let Y=W.coordsAt(X,1);return Y&&inside(T,E,Y)?1:q&&q.bottom>=E?-1:1}function queryPos(B,_){let T=B.posAtCoords({x:_.clientX,y:_.clientY},!1);return{pos:T,bias:findPositionSide(B,T,_.clientX,_.clientY)}}const BadMouseDetail=browser.ie&&browser.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(B){if(!BadMouseDetail)return B.detail;let _=lastMouseDown,T=lastMouseDownTime;return lastMouseDown=B,lastMouseDownTime=Date.now(),lastMouseDownCount=!_||T>Date.now()-400&&Math.abs(_.clientX-B.clientX)<2&&Math.abs(_.clientY-B.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(B,_){let T=queryPos(B,_),E=getClickType(_),W=B.state.selection;return{update(X){X.docChanged&&(T.pos=X.changes.mapPos(T.pos),W=W.map(X.changes))},get(X,q,Y){let te=queryPos(B,X),ne,ae=rangeForClick(B,te.pos,te.bias,E);if(T.pos!=te.pos&&!q){let le=rangeForClick(B,T.pos,T.bias,E),ue=Math.min(le.from,ae.from),ge=Math.max(le.to,ae.to);ae=ue<ae.from?EditorSelection.range(ue,ge):EditorSelection.range(ge,ue)}return q?W.replaceRange(W.main.extend(ae.from,ae.to)):Y&&E==1&&W.ranges.length>1&&(ne=removeRangeAround(W,te.pos))?ne:Y?W.addRange(ae):EditorSelection.create([ae])}}}function removeRangeAround(B,_){for(let T=0;T<B.ranges.length;T++){let{from:E,to:W}=B.ranges[T];if(E<=_&&W>=_)return EditorSelection.create(B.ranges.slice(0,T).concat(B.ranges.slice(T+1)),B.mainIndex==T?0:B.mainIndex-(B.mainIndex>T?1:0))}return null}handlers.dragstart=(B,_)=>{let{selection:{main:T}}=B.state;if(_.target.draggable){let W=B.docView.nearest(_.target);if(W&&W.isWidget){let X=W.posAtStart,q=X+W.length;(X>=T.to||q<=T.from)&&(T=EditorSelection.range(X,q))}}let{inputState:E}=B;return E.mouseSelection&&(E.mouseSelection.dragging=!0),E.draggedContent=T,_.dataTransfer&&(_.dataTransfer.setData("Text",textFilter(B.state,clipboardOutputFilter,B.state.sliceDoc(T.from,T.to))),_.dataTransfer.effectAllowed="copyMove"),!1};handlers.dragend=B=>(B.inputState.draggedContent=null,!1);function dropText(B,_,T,E){if(T=textFilter(B.state,clipboardInputFilter,T),!T)return;let W=B.posAtCoords({x:_.clientX,y:_.clientY},!1),{draggedContent:X}=B.inputState,q=E&&X&&dragMovesSelection(B,_)?{from:X.from,to:X.to}:null,Y={from:W,insert:T},te=B.state.changes(q?[q,Y]:Y);B.focus(),B.dispatch({changes:te,selection:{anchor:te.mapPos(W,-1),head:te.mapPos(W,1)},userEvent:q?"move.drop":"input.drop"}),B.inputState.draggedContent=null}handlers.drop=(B,_)=>{if(!_.dataTransfer)return!1;if(B.state.readOnly)return!0;let T=_.dataTransfer.files;if(T&&T.length){let E=Array(T.length),W=0,X=()=>{++W==T.length&&dropText(B,_,E.filter(q=>q!=null).join(B.state.lineBreak),!1)};for(let q=0;q<T.length;q++){let Y=new FileReader;Y.onerror=X,Y.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(Y.result)||(E[q]=Y.result),X()},Y.readAsText(T[q])}return!0}else{let E=_.dataTransfer.getData("Text");if(E)return dropText(B,_,E,!0),!0}return!1};handlers.paste=(B,_)=>{if(B.state.readOnly)return!0;B.observer.flush();let T=brokenClipboardAPI?null:_.clipboardData;return T?(doPaste(B,T.getData("text/plain")||T.getData("text/uri-list")),!0):(capturePaste(B),!1)};function captureCopy(B,_){let T=B.dom.parentNode;if(!T)return;let E=T.appendChild(document.createElement("textarea"));E.style.cssText="position: fixed; left: -10000px; top: 10px",E.value=_,E.focus(),E.selectionEnd=_.length,E.selectionStart=0,setTimeout(()=>{E.remove(),B.focus()},50)}function copiedRange(B){let _=[],T=[],E=!1;for(let W of B.selection.ranges)W.empty||(_.push(B.sliceDoc(W.from,W.to)),T.push(W));if(!_.length){let W=-1;for(let{from:X}of B.selection.ranges){let q=B.doc.lineAt(X);q.number>W&&(_.push(q.text),T.push({from:q.from,to:Math.min(B.doc.length,q.to+1)})),W=q.number}E=!0}return{text:textFilter(B,clipboardOutputFilter,_.join(B.lineBreak)),ranges:T,linewise:E}}let lastLinewiseCopy=null;handlers.copy=handlers.cut=(B,_)=>{let{text:T,ranges:E,linewise:W}=copiedRange(B.state);if(!T&&!W)return!1;lastLinewiseCopy=W?T:null,_.type=="cut"&&!B.state.readOnly&&B.dispatch({changes:E,scrollIntoView:!0,userEvent:"delete.cut"});let X=brokenClipboardAPI?null:_.clipboardData;return X?(X.clearData(),X.setData("text/plain",T),!0):(captureCopy(B,T),!1)};const isFocusChange=Annotation.define();function focusChangeTransaction(B,_){let T=[];for(let E of B.facet(focusChangeEffect)){let W=E(B,_);W&&T.push(W)}return T?B.update({effects:T,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(B){setTimeout(()=>{let _=B.hasFocus;if(_!=B.inputState.notifiedFocused){let T=focusChangeTransaction(B.state,_);T?B.dispatch(T):B.update([])}},10)}observers.focus=B=>{B.inputState.lastFocusTime=Date.now(),!B.scrollDOM.scrollTop&&(B.inputState.lastScrollTop||B.inputState.lastScrollLeft)&&(B.scrollDOM.scrollTop=B.inputState.lastScrollTop,B.scrollDOM.scrollLeft=B.inputState.lastScrollLeft),updateForFocusChange(B)};observers.blur=B=>{B.observer.clearSelectionRange(),updateForFocusChange(B)};observers.compositionstart=observers.compositionupdate=B=>{B.observer.editContext||(B.inputState.compositionFirstChange==null&&(B.inputState.compositionFirstChange=!0),B.inputState.composing<0&&(B.inputState.composing=0))};observers.compositionend=B=>{B.observer.editContext||(B.inputState.composing=-1,B.inputState.compositionEndedAt=Date.now(),B.inputState.compositionPendingKey=!0,B.inputState.compositionPendingChange=B.observer.pendingRecords().length>0,B.inputState.compositionFirstChange=null,browser.chrome&&browser.android?B.observer.flushSoon():B.inputState.compositionPendingChange?Promise.resolve().then(()=>B.observer.flush()):setTimeout(()=>{B.inputState.composing<0&&B.docView.hasComposition&&B.update([])},50))};observers.contextmenu=B=>{B.inputState.lastContextMenu=Date.now()};handlers.beforeinput=(B,_)=>{var T,E;if(_.inputType=="insertReplacementText"&&B.observer.editContext){let X=(T=_.dataTransfer)===null||T===void 0?void 0:T.getData("text/plain"),q=_.getTargetRanges();if(X&&q.length){let Y=q[0],te=B.posAtDOM(Y.startContainer,Y.startOffset),ne=B.posAtDOM(Y.endContainer,Y.endOffset);return applyDOMChangeInner(B,{from:te,to:ne,insert:B.state.toText(X)},null),!0}}let W;if(browser.chrome&&browser.android&&(W=PendingKeys.find(X=>X.inputType==_.inputType))&&(B.observer.delayAndroidKey(W.key,W.keyCode),W.key=="Backspace"||W.key=="Delete")){let X=((E=window.visualViewport)===null||E===void 0?void 0:E.height)||0;setTimeout(()=>{var q;(((q=window.visualViewport)===null||q===void 0?void 0:q.height)||0)>X+10&&B.hasFocus&&(B.contentDOM.blur(),B.focus())},100)}return browser.ios&&_.inputType=="deleteContentForward"&&B.observer.flushSoon(),browser.safari&&_.inputType=="insertText"&&B.inputState.composing>=0&&setTimeout(()=>observers.compositionend(B,_),20),!1};const appliedFirefoxHack=new Set;function firefoxCopyCutHack(B){appliedFirefoxHack.has(B)||(appliedFirefoxHack.add(B),B.addEventListener("copy",()=>{}),B.addEventListener("cut",()=>{}))}const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];let heightChangeFlag=!1;function clearHeightChangeFlag(){heightChangeFlag=!1}class HeightOracle{constructor(_){this.lineWrapping=_,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(_,T){let E=this.doc.lineAt(T).number-this.doc.lineAt(_).number+1;return this.lineWrapping&&(E+=Math.max(0,Math.ceil((T-_-E*this.lineLength*.5)/this.lineLength))),this.lineHeight*E}heightForLine(_){return this.lineWrapping?(1+Math.max(0,Math.ceil((_-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(_){return this.doc=_,this}mustRefreshForWrapping(_){return wrappingWhiteSpace.indexOf(_)>-1!=this.lineWrapping}mustRefreshForHeights(_){let T=!1;for(let E=0;E<_.length;E++){let W=_[E];W<0?E++:this.heightSamples[Math.floor(W*10)]||(T=!0,this.heightSamples[Math.floor(W*10)]=!0)}return T}refresh(_,T,E,W,X,q){let Y=wrappingWhiteSpace.indexOf(_)>-1,te=Math.round(T)!=Math.round(this.lineHeight)||this.lineWrapping!=Y;if(this.lineWrapping=Y,this.lineHeight=T,this.charWidth=E,this.textHeight=W,this.lineLength=X,te){this.heightSamples={};for(let ne=0;ne<q.length;ne++){let ae=q[ne];ae<0?ne++:this.heightSamples[Math.floor(ae*10)]=!0}}return te}}class MeasuredHeights{constructor(_,T){this.from=_,this.heights=T,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(_,T,E,W,X){this.from=_,this.length=T,this.top=E,this.height=W,this._content=X}get type(){return typeof this._content=="number"?BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof PointDecoration?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(_){let T=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(_._content)?_._content:[_]);return new BlockInfo(this.from,this.length+_.length,this.top,this.height+_.height,T)}}var QueryType$1=function(B){return B[B.ByPos=0]="ByPos",B[B.ByHeight=1]="ByHeight",B[B.ByPosNoHeight=2]="ByPosNoHeight",B}(QueryType$1||(QueryType$1={}));const Epsilon=.001;class HeightMap{constructor(_,T,E=2){this.length=_,this.height=T,this.flags=E}get outdated(){return(this.flags&2)>0}set outdated(_){this.flags=(_?2:0)|this.flags&-3}setHeight(_){this.height!=_&&(Math.abs(this.height-_)>Epsilon&&(heightChangeFlag=!0),this.height=_)}replace(_,T,E){return HeightMap.of(E)}decomposeLeft(_,T){T.push(this)}decomposeRight(_,T){T.push(this)}applyChanges(_,T,E,W){let X=this,q=E.doc;for(let Y=W.length-1;Y>=0;Y--){let{fromA:te,toA:ne,fromB:ae,toB:le}=W[Y],ue=X.lineAt(te,QueryType$1.ByPosNoHeight,E.setDoc(T),0,0),ge=ue.to>=ne?ue:X.lineAt(ne,QueryType$1.ByPosNoHeight,E,0,0);for(le+=ge.to-ne,ne=ge.to;Y>0&&ue.from<=W[Y-1].toA;)te=W[Y-1].fromA,ae=W[Y-1].fromB,Y--,te<ue.from&&(ue=X.lineAt(te,QueryType$1.ByPosNoHeight,E,0,0));ae+=ue.from-te,te=ue.from;let ye=NodeBuilder.build(E.setDoc(q),_,ae,le);X=replace(X,X.replace(te,ne,ye))}return X.updateHeight(E,0)}static empty(){return new HeightMapText(0,0)}static of(_){if(_.length==1)return _[0];let T=0,E=_.length,W=0,X=0;for(;;)if(T==E)if(W>X*2){let Y=_[T-1];Y.break?_.splice(--T,1,Y.left,null,Y.right):_.splice(--T,1,Y.left,Y.right),E+=1+Y.break,W-=Y.size}else if(X>W*2){let Y=_[E];Y.break?_.splice(E,1,Y.left,null,Y.right):_.splice(E,1,Y.left,Y.right),E+=2+Y.break,X-=Y.size}else break;else if(W<X){let Y=_[T++];Y&&(W+=Y.size)}else{let Y=_[--E];Y&&(X+=Y.size)}let q=0;return _[T-1]==null?(q=1,T--):_[T]==null&&(q=1,E++),new HeightMapBranch(HeightMap.of(_.slice(0,T)),q,HeightMap.of(_.slice(E)))}}function replace(B,_){return B==_?B:(B.constructor!=_.constructor&&(heightChangeFlag=!0),_)}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(_,T,E){super(_,T),this.deco=E}blockAt(_,T,E,W){return new BlockInfo(W,this.length,E,this.height,this.deco||0)}lineAt(_,T,E,W,X){return this.blockAt(0,E,W,X)}forEachLine(_,T,E,W,X,q){_<=X+this.length&&T>=X&&q(this.blockAt(0,E,W,X))}updateHeight(_,T=0,E=!1,W){return W&&W.from<=T&&W.more&&this.setHeight(W.heights[W.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(_,T){super(_,T,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(_,T,E,W){return new BlockInfo(W,this.length,E,this.height,this.breaks)}replace(_,T,E){let W=E[0];return E.length==1&&(W instanceof HeightMapText||W instanceof HeightMapGap&&W.flags&4)&&Math.abs(this.length-W.length)<10?(W instanceof HeightMapGap?W=new HeightMapText(W.length,this.height):W.height=this.height,this.outdated||(W.outdated=!1),W):HeightMap.of(E)}updateHeight(_,T=0,E=!1,W){return W&&W.from<=T&&W.more?this.setHeight(W.heights[W.index++]):(E||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,_.heightForLine(this.length-this.collapsed))+this.breaks*_.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(_){super(_,0)}heightMetrics(_,T){let E=_.doc.lineAt(T).number,W=_.doc.lineAt(T+this.length).number,X=W-E+1,q,Y=0;if(_.lineWrapping){let te=Math.min(this.height,_.lineHeight*X);q=te/X,this.length>X+1&&(Y=(this.height-te)/(this.length-X-1))}else q=this.height/X;return{firstLine:E,lastLine:W,perLine:q,perChar:Y}}blockAt(_,T,E,W){let{firstLine:X,lastLine:q,perLine:Y,perChar:te}=this.heightMetrics(T,W);if(T.lineWrapping){let ne=W+(_<T.lineHeight?0:Math.round(Math.max(0,Math.min(1,(_-E)/this.height))*this.length)),ae=T.doc.lineAt(ne),le=Y+ae.length*te,ue=Math.max(E,_-le/2);return new BlockInfo(ae.from,ae.length,ue,le,0)}else{let ne=Math.max(0,Math.min(q-X,Math.floor((_-E)/Y))),{from:ae,length:le}=T.doc.line(X+ne);return new BlockInfo(ae,le,E+Y*ne,Y,0)}}lineAt(_,T,E,W,X){if(T==QueryType$1.ByHeight)return this.blockAt(_,E,W,X);if(T==QueryType$1.ByPosNoHeight){let{from:ge,to:ye}=E.doc.lineAt(_);return new BlockInfo(ge,ye-ge,0,0,0)}let{firstLine:q,perLine:Y,perChar:te}=this.heightMetrics(E,X),ne=E.doc.lineAt(_),ae=Y+ne.length*te,le=ne.number-q,ue=W+Y*le+te*(ne.from-X-le);return new BlockInfo(ne.from,ne.length,Math.max(W,Math.min(ue,W+this.height-ae)),ae,0)}forEachLine(_,T,E,W,X,q){_=Math.max(_,X),T=Math.min(T,X+this.length);let{firstLine:Y,perLine:te,perChar:ne}=this.heightMetrics(E,X);for(let ae=_,le=W;ae<=T;){let ue=E.doc.lineAt(ae);if(ae==_){let ye=ue.number-Y;le+=te*ye+ne*(_-X-ye)}let ge=te+ne*ue.length;q(new BlockInfo(ue.from,ue.length,le,ge,0)),le+=ge,ae=ue.to+1}}replace(_,T,E){let W=this.length-T;if(W>0){let X=E[E.length-1];X instanceof HeightMapGap?E[E.length-1]=new HeightMapGap(X.length+W):E.push(null,new HeightMapGap(W-1))}if(_>0){let X=E[0];X instanceof HeightMapGap?E[0]=new HeightMapGap(_+X.length):E.unshift(new HeightMapGap(_-1),null)}return HeightMap.of(E)}decomposeLeft(_,T){T.push(new HeightMapGap(_-1),null)}decomposeRight(_,T){T.push(null,new HeightMapGap(this.length-_-1))}updateHeight(_,T=0,E=!1,W){let X=T+this.length;if(W&&W.from<=T+this.length&&W.more){let q=[],Y=Math.max(T,W.from),te=-1;for(W.from>T&&q.push(new HeightMapGap(W.from-T-1).updateHeight(_,T));Y<=X&&W.more;){let ae=_.doc.lineAt(Y).length;q.length&&q.push(null);let le=W.heights[W.index++];te==-1?te=le:Math.abs(le-te)>=Epsilon&&(te=-2);let ue=new HeightMapText(ae,le);ue.outdated=!1,q.push(ue),Y+=ae+1}Y<=X&&q.push(null,new HeightMapGap(X-Y).updateHeight(_,Y));let ne=HeightMap.of(q);return(te<0||Math.abs(ne.height-this.height)>=Epsilon||Math.abs(te-this.heightMetrics(_,T).perLine)>=Epsilon)&&(heightChangeFlag=!0),replace(this,ne)}else(E||this.outdated)&&(this.setHeight(_.heightForGap(T,T+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(_,T,E){super(_.length+T+E.length,_.height+E.height,T|(_.outdated||E.outdated?2:0)),this.left=_,this.right=E,this.size=_.size+E.size}get break(){return this.flags&1}blockAt(_,T,E,W){let X=E+this.left.height;return _<X?this.left.blockAt(_,T,E,W):this.right.blockAt(_,T,X,W+this.left.length+this.break)}lineAt(_,T,E,W,X){let q=W+this.left.height,Y=X+this.left.length+this.break,te=T==QueryType$1.ByHeight?_<q:_<Y,ne=te?this.left.lineAt(_,T,E,W,X):this.right.lineAt(_,T,E,q,Y);if(this.break||(te?ne.to<Y:ne.from>Y))return ne;let ae=T==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return te?ne.join(this.right.lineAt(Y,ae,E,q,Y)):this.left.lineAt(Y,ae,E,W,X).join(ne)}forEachLine(_,T,E,W,X,q){let Y=W+this.left.height,te=X+this.left.length+this.break;if(this.break)_<te&&this.left.forEachLine(_,T,E,W,X,q),T>=te&&this.right.forEachLine(_,T,E,Y,te,q);else{let ne=this.lineAt(te,QueryType$1.ByPos,E,W,X);_<ne.from&&this.left.forEachLine(_,ne.from-1,E,W,X,q),ne.to>=_&&ne.from<=T&&q(ne),T>ne.to&&this.right.forEachLine(ne.to+1,T,E,Y,te,q)}}replace(_,T,E){let W=this.left.length+this.break;if(T<W)return this.balanced(this.left.replace(_,T,E),this.right);if(_>this.left.length)return this.balanced(this.left,this.right.replace(_-W,T-W,E));let X=[];_>0&&this.decomposeLeft(_,X);let q=X.length;for(let Y of E)X.push(Y);if(_>0&&mergeGaps(X,q-1),T<this.length){let Y=X.length;this.decomposeRight(T,X),mergeGaps(X,Y)}return HeightMap.of(X)}decomposeLeft(_,T){let E=this.left.length;if(_<=E)return this.left.decomposeLeft(_,T);T.push(this.left),this.break&&(E++,_>=E&&T.push(null)),_>E&&this.right.decomposeLeft(_-E,T)}decomposeRight(_,T){let E=this.left.length,W=E+this.break;if(_>=W)return this.right.decomposeRight(_-W,T);_<E&&this.left.decomposeRight(_,T),this.break&&_<W&&T.push(null),T.push(this.right)}balanced(_,T){return _.size>2*T.size||T.size>2*_.size?HeightMap.of(this.break?[_,null,T]:[_,T]):(this.left=replace(this.left,_),this.right=replace(this.right,T),this.setHeight(_.height+T.height),this.outdated=_.outdated||T.outdated,this.size=_.size+T.size,this.length=_.length+this.break+T.length,this)}updateHeight(_,T=0,E=!1,W){let{left:X,right:q}=this,Y=T+X.length+this.break,te=null;return W&&W.from<=T+X.length&&W.more?te=X=X.updateHeight(_,T,E,W):X.updateHeight(_,T,E),W&&W.from<=Y+q.length&&W.more?te=q=q.updateHeight(_,Y,E,W):q.updateHeight(_,Y,E),te?this.balanced(X,q):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(B,_){let T,E;B[_]==null&&(T=B[_-1])instanceof HeightMapGap&&(E=B[_+1])instanceof HeightMapGap&&B.splice(_-1,3,new HeightMapGap(T.length+1+E.length))}const relevantWidgetHeight=5;class NodeBuilder{constructor(_,T){this.pos=_,this.oracle=T,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=_}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(_,T){if(this.lineStart>-1){let E=Math.min(T,this.lineEnd),W=this.nodes[this.nodes.length-1];W instanceof HeightMapText?W.length+=E-this.pos:(E>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(E-this.pos,-1)),this.writtenTo=E,T>E&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=T}point(_,T,E){if(_<T||E.heightRelevant){let W=E.widget?E.widget.estimatedHeight:0,X=E.widget?E.widget.lineBreaks:0;W<0&&(W=this.oracle.lineHeight);let q=T-_;E.block?this.addBlock(new HeightMapBlock(q,W,E)):(q||X||W>=relevantWidgetHeight)&&this.addLineDeco(W,X,q)}else T>_&&this.span(_,T);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:_,to:T}=this.oracle.doc.lineAt(this.pos);this.lineStart=_,this.lineEnd=T,this.writtenTo<_&&((this.writtenTo<_-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,_-1)),this.nodes.push(null)),this.pos>_&&this.nodes.push(new HeightMapText(this.pos-_,-1)),this.writtenTo=this.pos}blankContent(_,T){let E=new HeightMapGap(T-_);return this.oracle.doc.lineAt(_).to==T&&(E.flags|=4),E}ensureLine(){this.enterLine();let _=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(_ instanceof HeightMapText)return _;let T=new HeightMapText(0,-1);return this.nodes.push(T),T}addBlock(_){this.enterLine();let T=_.deco;T&&T.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(_),this.writtenTo=this.pos=this.pos+_.length,T&&T.endSide>0&&(this.covering=_)}addLineDeco(_,T,E){let W=this.ensureLine();W.length+=E,W.collapsed+=E,W.widgetHeight=Math.max(W.widgetHeight,_),W.breaks+=T,this.writtenTo=this.pos=this.pos+E}finish(_){let T=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(T instanceof HeightMapText)&&!this.isCovered?this.nodes.push(new HeightMapText(0,-1)):(this.writtenTo<this.pos||T==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let E=_;for(let W of this.nodes)W instanceof HeightMapText&&W.updateHeight(this.oracle,E),E+=W?W.length:1;return this.nodes}static build(_,T,E,W){let X=new NodeBuilder(E,_);return RangeSet.spans(T,E,W,X,0),X.finish(E)}}function heightRelevantDecoChanges(B,_,T){let E=new DecorationComparator;return RangeSet.compare(B,_,T,E,0),E.changes}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(_,T,E,W){(_<T||E&&E.heightRelevant||W&&W.heightRelevant)&&addRange(_,T,this.changes,5)}}function visiblePixelRange(B,_){let T=B.getBoundingClientRect(),E=B.ownerDocument,W=E.defaultView||window,X=Math.max(0,T.left),q=Math.min(W.innerWidth,T.right),Y=Math.max(0,T.top),te=Math.min(W.innerHeight,T.bottom);for(let ne=B.parentNode;ne&&ne!=E.body;)if(ne.nodeType==1){let ae=ne,le=window.getComputedStyle(ae);if((ae.scrollHeight>ae.clientHeight||ae.scrollWidth>ae.clientWidth)&&le.overflow!="visible"){let ue=ae.getBoundingClientRect();X=Math.max(X,ue.left),q=Math.min(q,ue.right),Y=Math.max(Y,ue.top),te=Math.min(ne==B.parentNode?W.innerHeight:te,ue.bottom)}ne=le.position=="absolute"||le.position=="fixed"?ae.offsetParent:ae.parentNode}else if(ne.nodeType==11)ne=ne.host;else break;return{left:X-T.left,right:Math.max(X,q)-T.left,top:Y-(T.top+_),bottom:Math.max(Y,te)-(T.top+_)}}function fullPixelRange(B,_){let T=B.getBoundingClientRect();return{left:0,right:T.right-T.left,top:_,bottom:T.bottom-(T.top+_)}}class LineGap{constructor(_,T,E){this.from=_,this.to=T,this.size=E}static same(_,T){if(_.length!=T.length)return!1;for(let E=0;E<_.length;E++){let W=_[E],X=T[E];if(W.from!=X.from||W.to!=X.to||W.size!=X.size)return!1}return!0}draw(_,T){return Decoration.replace({widget:new LineGapWidget(this.size*(T?_.scaleY:_.scaleX),T)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(_,T){super(),this.size=_,this.vertical=T}eq(_){return _.size==this.size&&_.vertical==this.vertical}toDOM(){let _=document.createElement("div");return this.vertical?_.style.height=this.size+"px":(_.style.width=this.size+"px",_.style.height="2px",_.style.display="inline-block"),_}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(_){this.state=_,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let T=_.facet(contentAttributes).some(E=>typeof E!="function"&&E.class=="cm-lineWrapping");this.heightOracle=new HeightOracle(T),this.stateDeco=_.facet(decorations).filter(E=>typeof E!="function"),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(_.doc),[new ChangedRange(0,0,0,_.doc.length)]);for(let E=0;E<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());E++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map(E=>E.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let _=[this.viewport],{main:T}=this.state.selection;for(let E=0;E<=1;E++){let W=E?T.head:T.anchor;if(!_.some(({from:X,to:q})=>W>=X&&W<=q)){let{from:X,to:q}=this.lineBlockAt(W);_.push(new Viewport(X,q))}}return this.viewports=_.sort((E,W)=>E.from-W.from),this.updateScaler()}updateScaler(){let _=this.scaler;return this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports),_.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,_=>{this.viewportLines.push(scaleBlock(_,this.scaler))})}update(_,T=null){this.state=_.state;let E=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(ae=>typeof ae!="function");let W=_.changedRanges,X=ChangedRange.extendWithRanges(W,heightRelevantDecoChanges(E,this.stateDeco,_?_.changes:ChangeSet.empty(this.state.doc.length))),q=this.heightMap.height,Y=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);clearHeightChangeFlag(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,_.startState.doc,this.heightOracle.setDoc(this.state.doc),X),(this.heightMap.height!=q||heightChangeFlag)&&(_.flags|=2),Y?(this.scrollAnchorPos=_.changes.mapPos(Y.from,-1),this.scrollAnchorHeight=Y.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let te=X.length?this.mapViewport(this.viewport,_.changes):this.viewport;(T&&(T.range.head<te.from||T.range.head>te.to)||!this.viewportIsAppropriate(te))&&(te=this.getViewport(0,T));let ne=te.from!=this.viewport.from||te.to!=this.viewport.to;this.viewport=te,_.flags|=this.updateForViewport(),(ne||!_.changes.empty||_.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,_.changes))),_.flags|=this.computeVisibleRanges(),T&&(this.scrollTarget=T),!this.mustEnforceCursorAssoc&&_.selectionSet&&_.view.lineWrapping&&_.state.selection.main.empty&&_.state.selection.main.assoc&&!_.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(_){let T=_.contentDOM,E=window.getComputedStyle(T),W=this.heightOracle,X=E.whiteSpace;this.defaultTextDirection=E.direction=="rtl"?Direction.RTL:Direction.LTR;let q=this.heightOracle.mustRefreshForWrapping(X),Y=T.getBoundingClientRect(),te=q||this.mustMeasureContent||this.contentDOMHeight!=Y.height;this.contentDOMHeight=Y.height,this.mustMeasureContent=!1;let ne=0,ae=0;if(Y.width&&Y.height){let{scaleX:$e,scaleY:We}=getScale(T,Y);($e>.005&&Math.abs(this.scaleX-$e)>.005||We>.005&&Math.abs(this.scaleY-We)>.005)&&(this.scaleX=$e,this.scaleY=We,ne|=8,q=te=!0)}let le=(parseInt(E.paddingTop)||0)*this.scaleY,ue=(parseInt(E.paddingBottom)||0)*this.scaleY;(this.paddingTop!=le||this.paddingBottom!=ue)&&(this.paddingTop=le,this.paddingBottom=ue,ne|=10),this.editorWidth!=_.scrollDOM.clientWidth&&(W.lineWrapping&&(te=!0),this.editorWidth=_.scrollDOM.clientWidth,ne|=8);let ge=_.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=ge&&(this.scrollAnchorHeight=-1,this.scrollTop=ge),this.scrolledToBottom=isScrolledToBottom(_.scrollDOM);let ye=(this.printing?fullPixelRange:visiblePixelRange)(T,this.paddingTop),xe=ye.top-this.pixelViewport.top,Te=ye.bottom-this.pixelViewport.bottom;this.pixelViewport=ye;let Ae=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(Ae!=this.inView&&(this.inView=Ae,Ae&&(te=!0)),!this.inView&&!this.scrollTarget)return 0;let Ie=Y.width;if((this.contentDOMWidth!=Ie||this.editorHeight!=_.scrollDOM.clientHeight)&&(this.contentDOMWidth=Y.width,this.editorHeight=_.scrollDOM.clientHeight,ne|=8),te){let $e=_.docView.measureVisibleLineHeights(this.viewport);if(W.mustRefreshForHeights($e)&&(q=!0),q||W.lineWrapping&&Math.abs(Ie-this.contentDOMWidth)>W.charWidth){let{lineHeight:We,charWidth:Ue,textHeight:je}=_.docView.measureTextSize();q=We>0&&W.refresh(X,We,Ue,je,Ie/Ue,$e),q&&(_.docView.minWidth=0,ne|=8)}xe>0&&Te>0?ae=Math.max(xe,Te):xe<0&&Te<0&&(ae=Math.min(xe,Te)),clearHeightChangeFlag();for(let We of this.viewports){let Ue=We.from==this.viewport.from?$e:_.docView.measureVisibleLineHeights(We);this.heightMap=(q?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,_.state.doc.length)]):this.heightMap).updateHeight(W,0,q,new MeasuredHeights(We.from,Ue))}heightChangeFlag&&(ne|=2)}let Ve=!this.viewportIsAppropriate(this.viewport,ae)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return Ve&&(ne&2&&(ne|=this.updateScaler()),this.viewport=this.getViewport(ae,this.scrollTarget),ne|=this.updateForViewport()),(ne&2||Ve)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(q?[]:this.lineGaps,_)),ne|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,_.docView.enforceCursorAssoc()),ne}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(_,T){let E=.5-Math.max(-.5,Math.min(.5,_/1e3/2)),W=this.heightMap,X=this.heightOracle,{visibleTop:q,visibleBottom:Y}=this,te=new Viewport(W.lineAt(q-E*1e3,QueryType$1.ByHeight,X,0,0).from,W.lineAt(Y+(1-E)*1e3,QueryType$1.ByHeight,X,0,0).to);if(T){let{head:ne}=T.range;if(ne<te.from||ne>te.to){let ae=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),le=W.lineAt(ne,QueryType$1.ByPos,X,0,0),ue;T.y=="center"?ue=(le.top+le.bottom)/2-ae/2:T.y=="start"||T.y=="nearest"&&ne<te.from?ue=le.top:ue=le.bottom-ae,te=new Viewport(W.lineAt(ue-1e3/2,QueryType$1.ByHeight,X,0,0).from,W.lineAt(ue+ae+1e3/2,QueryType$1.ByHeight,X,0,0).to)}}return te}mapViewport(_,T){let E=T.mapPos(_.from,-1),W=T.mapPos(_.to,1);return new Viewport(this.heightMap.lineAt(E,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(W,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:_,to:T},E=0){if(!this.inView)return!0;let{top:W}=this.heightMap.lineAt(_,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:X}=this.heightMap.lineAt(T,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:q,visibleBottom:Y}=this;return(_==0||W<=q-Math.max(10,Math.min(-E,250)))&&(T==this.state.doc.length||X>=Y+Math.max(10,Math.min(E,250)))&&W>q-2*1e3&&X<Y+2*1e3}mapLineGaps(_,T){if(!_.length||T.empty)return _;let E=[];for(let W of _)T.touchesRange(W.from,W.to)||E.push(new LineGap(T.mapPos(W.from),T.mapPos(W.to),W.size));return E}ensureLineGaps(_,T){let E=this.heightOracle.lineWrapping,W=E?1e4:2e3,X=W>>1,q=W<<1;if(this.defaultTextDirection!=Direction.LTR&&!E)return[];let Y=[],te=(ae,le,ue,ge)=>{if(le-ae<X)return;let ye=this.state.selection.main,xe=[ye.from];ye.empty||xe.push(ye.to);for(let Ae of xe)if(Ae>ae&&Ae<le){te(ae,Ae-10,ue,ge),te(Ae+10,le,ue,ge);return}let Te=find(_,Ae=>Ae.from>=ue.from&&Ae.to<=ue.to&&Math.abs(Ae.from-ae)<X&&Math.abs(Ae.to-le)<X&&!xe.some(Ie=>Ae.from<Ie&&Ae.to>Ie));if(!Te){if(le<ue.to&&T&&E&&T.visibleRanges.some(Ae=>Ae.from<=le&&Ae.to>=le)){let Ae=T.moveToLineBoundary(EditorSelection.cursor(le),!1,!0).head;Ae>ae&&(le=Ae)}Te=new LineGap(ae,le,this.gapSize(ue,ae,le,ge))}Y.push(Te)},ne=ae=>{if(ae.length<q||ae.type!=BlockType.Text)return;let le=lineStructure(ae.from,ae.to,this.stateDeco);if(le.total<q)return;let ue=this.scrollTarget?this.scrollTarget.range.head:null,ge,ye;if(E){let xe=W/this.heightOracle.lineLength*this.heightOracle.lineHeight,Te,Ae;if(ue!=null){let Ie=findFraction(le,ue),Ve=((this.visibleBottom-this.visibleTop)/2+xe)/ae.height;Te=Ie-Ve,Ae=Ie+Ve}else Te=(this.visibleTop-ae.top-xe)/ae.height,Ae=(this.visibleBottom-ae.top+xe)/ae.height;ge=findPosition(le,Te),ye=findPosition(le,Ae)}else{let xe=le.total*this.heightOracle.charWidth,Te=W*this.heightOracle.charWidth,Ae,Ie;if(ue!=null){let Ve=findFraction(le,ue),$e=((this.pixelViewport.right-this.pixelViewport.left)/2+Te)/xe;Ae=Ve-$e,Ie=Ve+$e}else Ae=(this.pixelViewport.left-Te)/xe,Ie=(this.pixelViewport.right+Te)/xe;ge=findPosition(le,Ae),ye=findPosition(le,Ie)}ge>ae.from&&te(ae.from,ge,ae,le),ye<ae.to&&te(ye,ae.to,ae,le)};for(let ae of this.viewportLines)Array.isArray(ae.type)?ae.type.forEach(ne):ne(ae);return Y}gapSize(_,T,E,W){let X=findFraction(W,E)-findFraction(W,T);return this.heightOracle.lineWrapping?_.height*X:W.total*this.heightOracle.charWidth*X}updateLineGaps(_){LineGap.same(_,this.lineGaps)||(this.lineGaps=_,this.lineGapDeco=Decoration.set(_.map(T=>T.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let _=this.stateDeco;this.lineGaps.length&&(_=_.concat(this.lineGapDeco));let T=[];RangeSet.spans(_,this.viewport.from,this.viewport.to,{span(W,X){T.push({from:W,to:X})},point(){}},20);let E=T.length!=this.visibleRanges.length||this.visibleRanges.some((W,X)=>W.from!=T[X].from||W.to!=T[X].to);return this.visibleRanges=T,E?4:0}lineBlockAt(_){return _>=this.viewport.from&&_<=this.viewport.to&&this.viewportLines.find(T=>T.from<=_&&T.to>=_)||scaleBlock(this.heightMap.lineAt(_,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(_){return _>=this.viewportLines[0].top&&_<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(T=>T.top<=_&&T.bottom>=_)||scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(_),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(_){let T=this.lineBlockAtHeight(_+8);return T.from>=this.viewport.from||this.viewportLines[0].top-_>200?T:this.viewportLines[0]}elementAtHeight(_){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(_),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(_,T){this.from=_,this.to=T}}function lineStructure(B,_,T){let E=[],W=B,X=0;return RangeSet.spans(T,B,_,{span(){},point(q,Y){q>W&&(E.push({from:W,to:q}),X+=q-W),W=Y}},20),W<_&&(E.push({from:W,to:_}),X+=_-W),{total:X,ranges:E}}function findPosition({total:B,ranges:_},T){if(T<=0)return _[0].from;if(T>=1)return _[_.length-1].to;let E=Math.floor(B*T);for(let W=0;;W++){let{from:X,to:q}=_[W],Y=q-X;if(E<=Y)return X+E;E-=Y}}function findFraction(B,_){let T=0;for(let{from:E,to:W}of B.ranges){if(_<=W){T+=_-E;break}T+=W-E}return T/B.total}function find(B,_){for(let T of B)if(_(T))return T}const IdScaler={toDOM(B){return B},fromDOM(B){return B},scale:1,eq(B){return B==this}};class BigScaler{constructor(_,T,E){let W=0,X=0,q=0;this.viewports=E.map(({from:Y,to:te})=>{let ne=T.lineAt(Y,QueryType$1.ByPos,_,0,0).top,ae=T.lineAt(te,QueryType$1.ByPos,_,0,0).bottom;return W+=ae-ne,{from:Y,to:te,top:ne,bottom:ae,domTop:0,domBottom:0}}),this.scale=(7e6-W)/(T.height-W);for(let Y of this.viewports)Y.domTop=q+(Y.top-X)*this.scale,q=Y.domBottom=Y.domTop+(Y.bottom-Y.top),X=Y.bottom}toDOM(_){for(let T=0,E=0,W=0;;T++){let X=T<this.viewports.length?this.viewports[T]:null;if(!X||_<X.top)return W+(_-E)*this.scale;if(_<=X.bottom)return X.domTop+(_-X.top);E=X.bottom,W=X.domBottom}}fromDOM(_){for(let T=0,E=0,W=0;;T++){let X=T<this.viewports.length?this.viewports[T]:null;if(!X||_<X.domTop)return E+(_-W)/this.scale;if(_<=X.domBottom)return X.top+(_-X.domTop);E=X.bottom,W=X.domBottom}}eq(_){return _ instanceof BigScaler?this.scale==_.scale&&this.viewports.length==_.viewports.length&&this.viewports.every((T,E)=>T.from==_.viewports[E].from&&T.to==_.viewports[E].to):!1}}function scaleBlock(B,_){if(_.scale==1)return B;let T=_.toDOM(B.top),E=_.toDOM(B.bottom);return new BlockInfo(B.from,B.length,T,E-T,Array.isArray(B._content)?B._content.map(W=>scaleBlock(W,_)):B._content)}const theme=Facet.define({combine:B=>B.join(" ")}),darkTheme=Facet.define({combine:B=>B.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(B,_,T){return new StyleModule(_,{finish(E){return/&/.test(E)?E.replace(/&\w*/,W=>{if(W=="&")return B;if(!T||!T[W])throw new RangeError(`Unsupported selector: ${W}`);return T[W]}):B+" "+E}})}const baseTheme$1$3=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs),observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser.ie&&browser.ie_version<=11;class DOMObserver{constructor(_){this.view=_,this.active=!1,this.editContext=null,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=_.contentDOM,this.observer=new MutationObserver(T=>{for(let E of T)this.queue.push(E);(browser.ie&&browser.ie_version<=11||browser.ios&&_.composing)&&T.some(E=>E.type=="childList"&&E.removedNodes.length||E.type=="characterData"&&E.oldValue.length>E.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&_.constructor.EDIT_CONTEXT!==!1&&!(browser.chrome&&browser.chrome_version<126)&&(this.editContext=new EditContextManager(_),_.state.facet(editable)&&(_.contentDOM.editContext=this.editContext.editContext)),useCharData&&(this.onCharData=T=>{this.queue.push({target:T.target,type:"characterData",oldValue:T.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var T;((T=this.view.docView)===null||T===void 0?void 0:T.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(_.scrollDOM)),this.addWindowListeners(this.win=_.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(T=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),T.length>0&&T[T.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(T=>{T.length>0&&T[T.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(_){this.view.inputState.runHandlers("scroll",_),this.intersecting&&this.view.measure()}onScroll(_){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(_)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(_){(_.type=="change"||!_.type)&&!_.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(_){if(this.gapIntersection&&(_.length!=this.gaps.length||this.gaps.some((T,E)=>T!=_[E]))){this.gapIntersection.disconnect();for(let T of _)this.gapIntersection.observe(T);this.gaps=_}}onSelectionChange(_){let T=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:E}=this,W=this.selectionRange;if(E.state.facet(editable)?E.root.activeElement!=this.dom:!hasSelection(E.dom,W))return;let X=W.anchorNode&&E.docView.nearest(W.anchorNode);if(X&&X.ignoreEvent(_)){T||(this.selectionChanged=!1);return}(browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!E.state.selection.main.empty&&W.focusNode&&isEquivalentPosition(W.focusNode,W.focusOffset,W.anchorNode,W.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:_}=this,T=getSelection(_.root);if(!T)return!1;let E=browser.safari&&_.root.nodeType==11&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariSelectionRangeHack(this.view,T)||T;if(!E||this.selectionRange.eq(E))return!1;let W=hasSelection(this.dom,E);return W&&!this.selectionChanged&&_.inputState.lastFocusTime>Date.now()-200&&_.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,E)?(this.view.inputState.lastFocusTime=0,_.docView.updateSelection(),!1):(this.selectionRange.setRange(E),W&&(this.selectionChanged=!0),!0)}setSelectionRange(_,T){this.selectionRange.set(_.node,_.offset,T.node,T.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let _=0,T=null;for(let E=this.dom;E;)if(E.nodeType==1)!T&&_<this.scrollTargets.length&&this.scrollTargets[_]==E?_++:T||(T=this.scrollTargets.slice(0,_)),T&&T.push(E),E=E.assignedSlot||E.parentNode;else if(E.nodeType==11)E=E.host;else break;if(_<this.scrollTargets.length&&!T&&(T=this.scrollTargets.slice(0,_)),T){for(let E of this.scrollTargets)E.removeEventListener("scroll",this.onScroll);for(let E of this.scrollTargets=T)E.addEventListener("scroll",this.onScroll)}}ignore(_){if(!this.active)return _();try{return this.stop(),_()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(_,T){var E;if(!this.delayedAndroidKey){let W=()=>{let X=this.delayedAndroidKey;X&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=X.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&X.force&&dispatchKey(this.dom,X.key,X.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(W)}(!this.delayedAndroidKey||_=="Enter")&&(this.delayedAndroidKey={key:_,keyCode:T,force:this.lastChange<Date.now()-50||!!(!((E=this.delayedAndroidKey)===null||E===void 0)&&E.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let _ of this.observer.takeRecords())this.queue.push(_);return this.queue}processRecords(){let _=this.pendingRecords();_.length&&(this.queue=[]);let T=-1,E=-1,W=!1;for(let X of _){let q=this.readMutation(X);q&&(q.typeOver&&(W=!0),T==-1?{from:T,to:E}=q:(T=Math.min(q.from,T),E=Math.max(q.to,E)))}return{from:T,to:E,typeOver:W}}readChange(){let{from:_,to:T,typeOver:E}=this.processRecords(),W=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);if(_<0&&!W)return null;_>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let X=new DOMChange(this.view,_,T,E);return this.view.docView.domChanged={newSel:X.newSel?X.newSel.main:null},X}flush(_=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;_&&this.readSelectionRange();let T=this.readChange();if(!T)return this.view.requestMeasure(),!1;let E=this.view.state,W=applyDOMChange(this.view,T);return this.view.state==E&&(T.domChanged||T.newSel&&!T.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),W}readMutation(_){let T=this.view.docView.nearest(_.target);if(!T||T.ignoreMutation(_))return null;if(T.markDirty(_.type=="attributes"),_.type=="attributes"&&(T.flags|=4),_.type=="childList"){let E=findChild(T,_.previousSibling||_.target.previousSibling,-1),W=findChild(T,_.nextSibling||_.target.nextSibling,1);return{from:E?T.posAfter(E):T.posAtStart,to:W?T.posBefore(W):T.posAtEnd,typeOver:!1}}else return _.type=="characterData"?{from:T.posAtStart,to:T.posAtEnd,typeOver:_.target.nodeValue==_.oldValue}:null}setWindow(_){_!=this.win&&(this.removeWindowListeners(this.win),this.win=_,this.addWindowListeners(this.win))}addWindowListeners(_){_.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):_.addEventListener("beforeprint",this.onPrint),_.addEventListener("scroll",this.onScroll),_.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(_){_.removeEventListener("scroll",this.onScroll),_.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):_.removeEventListener("beforeprint",this.onPrint),_.document.removeEventListener("selectionchange",this.onSelectionChange)}update(_){this.editContext&&(this.editContext.update(_),_.startState.facet(editable)!=_.state.facet(editable)&&(_.view.contentDOM.editContext=_.state.facet(editable)?this.editContext.editContext:null))}destroy(){var _,T,E;this.stop(),(_=this.intersection)===null||_===void 0||_.disconnect(),(T=this.gapIntersection)===null||T===void 0||T.disconnect(),(E=this.resizeScroll)===null||E===void 0||E.disconnect();for(let W of this.scrollTargets)W.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function findChild(B,_,T){for(;_;){let E=ContentView.get(_);if(E&&E.parent==B)return E;let W=_.parentNode;_=W!=B.dom?W:T>0?_.nextSibling:_.previousSibling}return null}function buildSelectionRangeFromRange(B,_){let T=_.startContainer,E=_.startOffset,W=_.endContainer,X=_.endOffset,q=B.docView.domAtPos(B.state.selection.main.anchor);return isEquivalentPosition(q.node,q.offset,W,X)&&([T,E,W,X]=[W,X,T,E]),{anchorNode:T,anchorOffset:E,focusNode:W,focusOffset:X}}function safariSelectionRangeHack(B,_){if(_.getComposedRanges){let W=_.getComposedRanges(B.root)[0];if(W)return buildSelectionRangeFromRange(B,W)}let T=null;function E(W){W.preventDefault(),W.stopImmediatePropagation(),T=W.getTargetRanges()[0]}return B.contentDOM.addEventListener("beforeinput",E,!0),B.dom.ownerDocument.execCommand("indent"),B.contentDOM.removeEventListener("beforeinput",E,!0),T?buildSelectionRangeFromRange(B,T):null}class EditContextManager{constructor(_){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.resetRange(_.state);let T=this.editContext=new window.EditContext({text:_.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,_.state.selection.main.anchor))),selectionEnd:this.toContextPos(_.state.selection.main.head)});this.handlers.textupdate=E=>{let{anchor:W}=_.state.selection.main,X={from:this.toEditorPos(E.updateRangeStart),to:this.toEditorPos(E.updateRangeEnd),insert:Text.of(E.text.split(`
`))};X.from==this.from&&W<this.from?X.from=W:X.to==this.to&&W>this.to&&(X.to=W),!(X.from==X.to&&!X.insert.length)&&(this.pendingContextChange=X,_.state.readOnly||applyDOMChangeInner(_,X,EditorSelection.single(this.toEditorPos(E.selectionStart),this.toEditorPos(E.selectionEnd))),this.pendingContextChange&&(this.revertPending(_.state),this.setSelection(_.state)))},this.handlers.characterboundsupdate=E=>{let W=[],X=null;for(let q=this.toEditorPos(E.rangeStart),Y=this.toEditorPos(E.rangeEnd);q<Y;q++){let te=_.coordsForChar(q);X=te&&new DOMRect(te.left,te.top,te.right-te.left,te.bottom-te.top)||X||new DOMRect,W.push(X)}T.updateCharacterBounds(E.rangeStart,W)},this.handlers.textformatupdate=E=>{let W=[];for(let X of E.getTextFormats()){let q=X.underlineStyle,Y=X.underlineThickness;if(q!="None"&&Y!="None"){let te=`text-decoration: underline ${q=="Dashed"?"dashed ":q=="Squiggle"?"wavy ":""}${Y=="Thin"?1:2}px`;W.push(Decoration.mark({attributes:{style:te}}).range(this.toEditorPos(X.rangeStart),this.toEditorPos(X.rangeEnd)))}}_.dispatch({effects:setEditContextFormatting.of(Decoration.set(W))})},this.handlers.compositionstart=()=>{_.inputState.composing<0&&(_.inputState.composing=0,_.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{_.inputState.composing=-1,_.inputState.compositionFirstChange=null};for(let E in this.handlers)T.addEventListener(E,this.handlers[E]);this.measureReq={read:E=>{this.editContext.updateControlBounds(E.contentDOM.getBoundingClientRect());let W=getSelection(E.root);W&&W.rangeCount&&this.editContext.updateSelectionBounds(W.getRangeAt(0).getBoundingClientRect())}}}applyEdits(_){let T=0,E=!1,W=this.pendingContextChange;return _.changes.iterChanges((X,q,Y,te,ne)=>{if(E)return;let ae=ne.length-(q-X);if(W&&q>=W.to)if(W.from==X&&W.to==q&&W.insert.eq(ne)){W=this.pendingContextChange=null,T+=ae,this.to+=ae;return}else W=null,this.revertPending(_.state);if(X+=T,q+=T,q<=this.from)this.from+=ae,this.to+=ae;else if(X<this.to){if(X<this.from||q>this.to||this.to-this.from+ne.length>3e4){E=!0;return}this.editContext.updateText(this.toContextPos(X),this.toContextPos(q),ne.toString()),this.to+=ae}T+=ae}),W&&!E&&this.revertPending(_.state),!E}update(_){let T=this.pendingContextChange;!this.applyEdits(_)||!this.rangeIsValid(_.state)?(this.pendingContextChange=null,this.resetRange(_.state),this.editContext.updateText(0,this.editContext.text.length,_.state.doc.sliceString(this.from,this.to)),this.setSelection(_.state)):(_.docChanged||_.selectionSet||T)&&this.setSelection(_.state),(_.geometryChanged||_.docChanged||_.selectionSet)&&_.view.requestMeasure(this.measureReq)}resetRange(_){let{head:T}=_.selection.main;this.from=Math.max(0,T-1e4),this.to=Math.min(_.doc.length,T+1e4)}revertPending(_){let T=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(T.from),this.toContextPos(T.from+T.insert.length),_.doc.sliceString(T.from,T.to))}setSelection(_){let{main:T}=_.selection,E=this.toContextPos(Math.max(this.from,Math.min(this.to,T.anchor))),W=this.toContextPos(T.head);(this.editContext.selectionStart!=E||this.editContext.selectionEnd!=W)&&this.editContext.updateSelection(E,W)}rangeIsValid(_){let{head:T}=_.selection.main;return!(this.from>0&&T-this.from<500||this.to<_.doc.length&&this.to-T<500||this.to-this.from>1e4*3)}toEditorPos(_){return _+this.from}toContextPos(_){return _-this.from}destroy(){for(let _ in this.handlers)this.editContext.removeEventListener(_,this.handlers[_])}}class EditorView{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(_={}){var T;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),_.parent&&_.parent.appendChild(this.dom);let{dispatch:E}=_;this.dispatchTransactions=_.dispatchTransactions||E&&(W=>W.forEach(X=>E(X,this)))||(W=>this.update(W)),this.dispatch=this.dispatch.bind(this),this._root=_.root||getRoot(_.parent)||document,this.viewState=new ViewState(_.state||EditorState.create(_)),_.scrollTo&&_.scrollTo.is(scrollIntoView$1)&&(this.viewState.scrollTarget=_.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(viewPlugin).map(W=>new PluginInstance(W));for(let W of this.plugins)W.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((T=document.fonts)===null||T===void 0)&&T.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(..._){let T=_.length==1&&_[0]instanceof Transaction?_:_.length==1&&Array.isArray(_[0])?_[0]:[this.state.update(..._)];this.dispatchTransactions(T,this)}update(_){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let T=!1,E=!1,W,X=this.state;for(let ue of _){if(ue.startState!=X)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");X=ue.state}if(this.destroyed){this.viewState.state=X;return}let q=this.hasFocus,Y=0,te=null;_.some(ue=>ue.annotation(isFocusChange))?(this.inputState.notifiedFocused=q,Y=1):q!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=q,te=focusChangeTransaction(X,q),te||(Y=1));let ne=this.observer.delayedAndroidKey,ae=null;if(ne?(this.observer.clearDelayedAndroidKey(),ae=this.observer.readChange(),(ae&&!this.state.doc.eq(X.doc)||!this.state.selection.eq(X.selection))&&(ae=null)):this.observer.clear(),X.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(X);W=ViewUpdate.create(this,X,_),W.flags|=Y;let le=this.viewState.scrollTarget;try{this.updateState=2;for(let ue of _){if(le&&(le=le.map(ue.changes)),ue.scrollIntoView){let{main:ge}=ue.state.selection;le=new ScrollTarget(ge.empty?ge:EditorSelection.cursor(ge.head,ge.head>ge.anchor?-1:1))}for(let ge of ue.effects)ge.is(scrollIntoView$1)&&(le=ge.value.clip(this.state))}this.viewState.update(W,le),this.bidiCache=CachedOrder.update(this.bidiCache,W.changes),W.empty||(this.updatePlugins(W),this.inputState.update(W)),T=this.docView.update(W),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),E=this.updateAttrs(),this.showAnnouncements(_),this.docView.updateSelection(T,_.some(ue=>ue.isUserEvent("select.pointer")))}finally{this.updateState=0}if(W.startState.facet(theme)!=W.state.facet(theme)&&(this.viewState.mustMeasureContent=!0),(T||E||le||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),T&&this.docViewUpdate(),!W.empty)for(let ue of this.state.facet(updateListener))try{ue(W)}catch(ge){logException(this.state,ge,"update listener")}(te||ae)&&Promise.resolve().then(()=>{te&&this.state==te.startState&&this.dispatch(te),ae&&!applyDOMChange(this,ae)&&ne.force&&dispatchKey(this.contentDOM,ne.key,ne.keyCode)})}setState(_){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=_;return}this.updateState=2;let T=this.hasFocus;try{for(let E of this.plugins)E.destroy(this);this.viewState=new ViewState(_),this.plugins=_.facet(viewPlugin).map(E=>new PluginInstance(E)),this.pluginMap.clear();for(let E of this.plugins)E.update(this);this.docView.destroy(),this.docView=new DocView(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}T&&this.focus(),this.requestMeasure()}updatePlugins(_){let T=_.startState.facet(viewPlugin),E=_.state.facet(viewPlugin);if(T!=E){let W=[];for(let X of E){let q=T.indexOf(X);if(q<0)W.push(new PluginInstance(X));else{let Y=this.plugins[q];Y.mustUpdate=_,W.push(Y)}}for(let X of this.plugins)X.mustUpdate!=_&&X.destroy(this);this.plugins=W,this.pluginMap.clear()}else for(let W of this.plugins)W.mustUpdate=_;for(let W=0;W<this.plugins.length;W++)this.plugins[W].update(this);T!=E&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let _ of this.plugins){let T=_.value;if(T&&T.docViewUpdate)try{T.docViewUpdate(this)}catch(E){logException(this.state,E,"doc view update listener")}}}measure(_=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,_&&this.observer.forceFlush();let T=null,E=this.scrollDOM,W=E.scrollTop*this.scaleY,{scrollAnchorPos:X,scrollAnchorHeight:q}=this.viewState;Math.abs(W-this.viewState.scrollTop)>1&&(q=-1),this.viewState.scrollAnchorHeight=-1;try{for(let Y=0;;Y++){if(q<0)if(isScrolledToBottom(E))X=-1,q=this.viewState.heightMap.height;else{let ge=this.viewState.scrollAnchorAt(W);X=ge.from,q=ge.top}this.updateState=1;let te=this.viewState.measure(this);if(!te&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(Y>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let ne=[];te&4||([this.measureRequests,ne]=[ne,this.measureRequests]);let ae=ne.map(ge=>{try{return ge.read(this)}catch(ye){return logException(this.state,ye),BadMeasure}}),le=ViewUpdate.create(this,this.state,[]),ue=!1;le.flags|=te,T?T.flags|=te:T=le,this.updateState=2,le.empty||(this.updatePlugins(le),this.inputState.update(le),this.updateAttrs(),ue=this.docView.update(le),ue&&this.docViewUpdate());for(let ge=0;ge<ne.length;ge++)if(ae[ge]!=BadMeasure)try{let ye=ne[ge];ye.write&&ye.write(ae[ge],this)}catch(ye){logException(this.state,ye)}if(ue&&this.docView.updateSelection(!0),!le.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,q=-1;continue}else{let ye=(X<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(X).top)-q;if(ye>1||ye<-1){W=W+ye,E.scrollTop=W/this.scaleY,q=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(T&&!T.empty)for(let Y of this.state.facet(updateListener))Y(T)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){let _=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),T={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(T["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,T);let E=this.observer.ignore(()=>{let W=updateAttrs(this.contentDOM,this.contentAttrs,T),X=updateAttrs(this.dom,this.editorAttrs,_);return W||X});return this.editorAttrs=_,this.contentAttrs=T,E}showAnnouncements(_){let T=!0;for(let E of _)for(let W of E.effects)if(W.is(EditorView.announce)){T&&(this.announceDOM.textContent=""),T=!1;let X=this.announceDOM.appendChild(document.createElement("div"));X.textContent=W.value}}mountStyles(){this.styleModules=this.state.facet(styleModule);let _=this.state.facet(EditorView.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$3).reverse(),_?{nonce:_}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(_){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),_){if(this.measureRequests.indexOf(_)>-1)return;if(_.key!=null){for(let T=0;T<this.measureRequests.length;T++)if(this.measureRequests[T].key===_.key){this.measureRequests[T]=_;return}}this.measureRequests.push(_)}}plugin(_){let T=this.pluginMap.get(_);return(T===void 0||T&&T.spec!=_)&&this.pluginMap.set(_,T=this.plugins.find(E=>E.spec==_)||null),T&&T.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(_){return this.readMeasured(),this.viewState.elementAtHeight(_)}lineBlockAtHeight(_){return this.readMeasured(),this.viewState.lineBlockAtHeight(_)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(_){return this.viewState.lineBlockAt(_)}get contentHeight(){return this.viewState.contentHeight}moveByChar(_,T,E){return skipAtoms(this,_,moveByChar(this,_,T,E))}moveByGroup(_,T){return skipAtoms(this,_,moveByChar(this,_,T,E=>byGroup(this,_.head,E)))}visualLineSide(_,T){let E=this.bidiSpans(_),W=this.textDirectionAt(_.from),X=E[T?E.length-1:0];return EditorSelection.cursor(X.side(T,W)+_.from,X.forward(!T,W)?1:-1)}moveToLineBoundary(_,T,E=!0){return moveToLineBoundary(this,_,T,E)}moveVertically(_,T,E){return skipAtoms(this,_,moveVertically(this,_,T,E))}domAtPos(_){return this.docView.domAtPos(_)}posAtDOM(_,T=0){return this.docView.posFromDOM(_,T)}posAtCoords(_,T=!0){return this.readMeasured(),posAtCoords(this,_,T)}coordsAtPos(_,T=1){this.readMeasured();let E=this.docView.coordsAt(_,T);if(!E||E.left==E.right)return E;let W=this.state.doc.lineAt(_),X=this.bidiSpans(W),q=X[BidiSpan.find(X,_-W.from,-1,T)];return flattenRect(E,q.dir==Direction.LTR==T>0)}coordsForChar(_){return this.readMeasured(),this.docView.coordsForChar(_)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(_){return!this.state.facet(perLineTextDirection)||_<this.viewport.from||_>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(_))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(_){if(_.length>MaxBidiLine)return trivialOrder(_.length);let T=this.textDirectionAt(_.from),E;for(let X of this.bidiCache)if(X.from==_.from&&X.dir==T&&(X.fresh||isolatesEq(X.isolates,E=getIsolatedRanges(this,_))))return X.order;E||(E=getIsolatedRanges(this,_));let W=computeOrder(_.text,T,E);return this.bidiCache.push(new CachedOrder(_.from,_.to,T,E,!0,W)),W}get hasFocus(){var _;return(this.dom.ownerDocument.hasFocus()||browser.safari&&((_=this.inputState)===null||_===void 0?void 0:_.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()})}setRoot(_){this._root!=_&&(this._root=_,this.observer.setWindow((_.nodeType==9?_:_.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let _ of this.plugins)_.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(_,T={}){return scrollIntoView$1.of(new ScrollTarget(typeof _=="number"?EditorSelection.cursor(_):_,T.y,T.x,T.yMargin,T.xMargin))}scrollSnapshot(){let{scrollTop:_,scrollLeft:T}=this.scrollDOM,E=this.viewState.scrollAnchorAt(_);return scrollIntoView$1.of(new ScrollTarget(EditorSelection.cursor(E.from),"start","start",E.top-_,T,!0))}setTabFocusMode(_){_==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof _=="boolean"?this.inputState.tabFocusMode=_?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+_)}static domEventHandlers(_){return ViewPlugin.define(()=>({}),{eventHandlers:_})}static domEventObservers(_){return ViewPlugin.define(()=>({}),{eventObservers:_})}static theme(_,T){let E=StyleModule.newName(),W=[theme.of(E),styleModule.of(buildTheme(`.${E}`,_))];return T&&T.dark&&W.push(darkTheme.of(!0)),W}static baseTheme(_){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,_,lightDarkIDs)))}static findFromDOM(_){var T;let E=_.querySelector(".cm-content"),W=E&&ContentView.get(E)||ContentView.get(_);return((T=W==null?void 0:W.rootView)===null||T===void 0?void 0:T.view)||null}}EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler$1;EditorView.clipboardInputFilter=clipboardInputFilter;EditorView.clipboardOutputFilter=clipboardOutputFilter;EditorView.scrollHandler=scrollHandler;EditorView.focusChangeEffect=focusChangeEffect;EditorView.perLineTextDirection=perLineTextDirection;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.dragMovesSelection=dragMovesSelection$1;EditorView.clickAddsSelectionRange=clickAddsSelectionRange;EditorView.decorations=decorations;EditorView.outerDecorations=outerDecorations;EditorView.atomicRanges=atomicRanges;EditorView.bidiIsolatedRanges=bidiIsolatedRanges;EditorView.scrollMargins=scrollMargins;EditorView.darkTheme=darkTheme;EditorView.cspNonce=Facet.define({combine:B=>B.length?B[0]:""});EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"});EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(_,T,E,W,X,q){this.from=_,this.to=T,this.dir=E,this.isolates=W,this.fresh=X,this.order=q}static update(_,T){if(T.empty&&!_.some(X=>X.fresh))return _;let E=[],W=_.length?_[_.length-1].dir:Direction.LTR;for(let X=Math.max(0,_.length-10);X<_.length;X++){let q=_[X];q.dir==W&&!T.touchesRange(q.from,q.to)&&E.push(new CachedOrder(T.mapPos(q.from,1),T.mapPos(q.to,-1),q.dir,q.isolates,!1,q.order))}return E}}function attrsFromFacet(B,_,T){for(let E=B.state.facet(_),W=E.length-1;W>=0;W--){let X=E[W],q=typeof X=="function"?X(B):X;q&&combineAttrs(q,T)}return T}const currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(B,_){const T=B.split(/-(?!$)/);let E=T[T.length-1];E=="Space"&&(E=" ");let W,X,q,Y;for(let te=0;te<T.length-1;++te){const ne=T[te];if(/^(cmd|meta|m)$/i.test(ne))Y=!0;else if(/^a(lt)?$/i.test(ne))W=!0;else if(/^(c|ctrl|control)$/i.test(ne))X=!0;else if(/^s(hift)?$/i.test(ne))q=!0;else if(/^mod$/i.test(ne))_=="mac"?Y=!0:X=!0;else throw new Error("Unrecognized modifier name: "+ne)}return W&&(E="Alt-"+E),X&&(E="Ctrl-"+E),Y&&(E="Meta-"+E),q&&(E="Shift-"+E),E}function modifiers(B,_,T){return _.altKey&&(B="Alt-"+B),_.ctrlKey&&(B="Ctrl-"+B),_.metaKey&&(B="Meta-"+B),T!==!1&&_.shiftKey&&(B="Shift-"+B),B}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown(B,_){return runHandlers(getKeymap(_.state),B,_,"editor")}})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;function getKeymap(B){let _=B.facet(keymap),T=Keymaps.get(_);return T||Keymaps.set(_,T=buildKeymap(_.reduce((E,W)=>E.concat(W),[]))),T}function runScopeHandlers(B,_,T){return runHandlers(getKeymap(B.state),_,B,T)}let storedPrefix=null;const PrefixTimeout=4e3;function buildKeymap(B,_=currentPlatform){let T=Object.create(null),E=Object.create(null),W=(q,Y)=>{let te=E[q];if(te==null)E[q]=Y;else if(te!=Y)throw new Error("Key binding "+q+" is used both as a regular binding and as a multi-stroke prefix")},X=(q,Y,te,ne,ae)=>{var le,ue;let ge=T[q]||(T[q]=Object.create(null)),ye=Y.split(/ (?!$)/).map(Ae=>normalizeKeyName(Ae,_));for(let Ae=1;Ae<ye.length;Ae++){let Ie=ye.slice(0,Ae).join(" ");W(Ie,!0),ge[Ie]||(ge[Ie]={preventDefault:!0,stopPropagation:!1,run:[Ve=>{let $e=storedPrefix={view:Ve,prefix:Ie,scope:q};return setTimeout(()=>{storedPrefix==$e&&(storedPrefix=null)},PrefixTimeout),!0}]})}let xe=ye.join(" ");W(xe,!1);let Te=ge[xe]||(ge[xe]={preventDefault:!1,stopPropagation:!1,run:((ue=(le=ge._any)===null||le===void 0?void 0:le.run)===null||ue===void 0?void 0:ue.slice())||[]});te&&Te.run.push(te),ne&&(Te.preventDefault=!0),ae&&(Te.stopPropagation=!0)};for(let q of B){let Y=q.scope?q.scope.split(" "):["editor"];if(q.any)for(let ne of Y){let ae=T[ne]||(T[ne]=Object.create(null));ae._any||(ae._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:le}=q;for(let ue in ae)ae[ue].run.push(ge=>le(ge,currentKeyEvent))}let te=q[_]||q.key;if(te)for(let ne of Y)X(ne,te,q.run,q.preventDefault,q.stopPropagation),q.shift&&X(ne,"Shift-"+te,q.shift,q.preventDefault,q.stopPropagation)}return T}let currentKeyEvent=null;function runHandlers(B,_,T,E){currentKeyEvent=_;let W=keyName(_),X=codePointAt(W,0),q=codePointSize(X)==W.length&&W!=" ",Y="",te=!1,ne=!1,ae=!1;storedPrefix&&storedPrefix.view==T&&storedPrefix.scope==E&&(Y=storedPrefix.prefix+" ",modifierCodes.indexOf(_.keyCode)<0&&(ne=!0,storedPrefix=null));let le=new Set,ue=Te=>{if(Te){for(let Ae of Te.run)if(!le.has(Ae)&&(le.add(Ae),Ae(T)))return Te.stopPropagation&&(ae=!0),!0;Te.preventDefault&&(Te.stopPropagation&&(ae=!0),ne=!0)}return!1},ge=B[E],ye,xe;return ge&&(ue(ge[Y+modifiers(W,_,!q)])?te=!0:q&&(_.altKey||_.metaKey||_.ctrlKey)&&!(browser.windows&&_.ctrlKey&&_.altKey)&&(ye=base[_.keyCode])&&ye!=W?(ue(ge[Y+modifiers(ye,_,!0)])||_.shiftKey&&(xe=shift$1[_.keyCode])!=W&&xe!=ye&&ue(ge[Y+modifiers(xe,_,!1)]))&&(te=!0):q&&_.shiftKey&&ue(ge[Y+modifiers(W,_,!0)])&&(te=!0),!te&&ue(ge._any)&&(te=!0)),ne&&(te=!0),te&&ae&&_.stopPropagation(),currentKeyEvent=null,te}class RectangleMarker{constructor(_,T,E,W,X){this.className=_,this.left=T,this.top=E,this.width=W,this.height=X}draw(){let _=document.createElement("div");return _.className=this.className,this.adjust(_),_}update(_,T){return T.className!=this.className?!1:(this.adjust(_),!0)}adjust(_){_.style.left=this.left+"px",_.style.top=this.top+"px",this.width!=null&&(_.style.width=this.width+"px"),_.style.height=this.height+"px"}eq(_){return this.left==_.left&&this.top==_.top&&this.width==_.width&&this.height==_.height&&this.className==_.className}static forRange(_,T,E){if(E.empty){let W=_.coordsAtPos(E.head,E.assoc||1);if(!W)return[];let X=getBase(_);return[new RectangleMarker(T,W.left-X.left,W.top-X.top,null,W.bottom-W.top)]}else return rectanglesForRange(_,T,E)}}function getBase(B){let _=B.scrollDOM.getBoundingClientRect();return{left:(B.textDirection==Direction.LTR?_.left:_.right-B.scrollDOM.clientWidth*B.scaleX)-B.scrollDOM.scrollLeft*B.scaleX,top:_.top-B.scrollDOM.scrollTop*B.scaleY}}function wrappedLine(B,_,T,E){let W=B.coordsAtPos(_,T*2);if(!W)return E;let X=B.dom.getBoundingClientRect(),q=(W.top+W.bottom)/2,Y=B.posAtCoords({x:X.left+1,y:q}),te=B.posAtCoords({x:X.right-1,y:q});return Y==null||te==null?E:{from:Math.max(E.from,Math.min(Y,te)),to:Math.min(E.to,Math.max(Y,te))}}function rectanglesForRange(B,_,T){if(T.to<=B.viewport.from||T.from>=B.viewport.to)return[];let E=Math.max(T.from,B.viewport.from),W=Math.min(T.to,B.viewport.to),X=B.textDirection==Direction.LTR,q=B.contentDOM,Y=q.getBoundingClientRect(),te=getBase(B),ne=q.querySelector(".cm-line"),ae=ne&&window.getComputedStyle(ne),le=Y.left+(ae?parseInt(ae.paddingLeft)+Math.min(0,parseInt(ae.textIndent)):0),ue=Y.right-(ae?parseInt(ae.paddingRight):0),ge=blockAt(B,E),ye=blockAt(B,W),xe=ge.type==BlockType.Text?ge:null,Te=ye.type==BlockType.Text?ye:null;if(xe&&(B.lineWrapping||ge.widgetLineBreaks)&&(xe=wrappedLine(B,E,1,xe)),Te&&(B.lineWrapping||ye.widgetLineBreaks)&&(Te=wrappedLine(B,W,-1,Te)),xe&&Te&&xe.from==Te.from&&xe.to==Te.to)return Ie(Ve(T.from,T.to,xe));{let We=xe?Ve(T.from,null,xe):$e(ge,!1),Ue=Te?Ve(null,T.to,Te):$e(ye,!0),je=[];return(xe||ge).to<(Te||ye).from-(xe&&Te?1:0)||ge.widgetLineBreaks>1&&We.bottom+B.defaultLineHeight/2<Ue.top?je.push(Ae(le,We.bottom,ue,Ue.top)):We.bottom<Ue.top&&B.elementAtHeight((We.bottom+Ue.top)/2).type==BlockType.Text&&(We.bottom=Ue.top=(We.bottom+Ue.top)/2),Ie(We).concat(je).concat(Ie(Ue))}function Ae(We,Ue,je,ze){return new RectangleMarker(_,We-te.left,Ue-te.top-.01,je-We,ze-Ue+.01)}function Ie({top:We,bottom:Ue,horizontal:je}){let ze=[];for(let He=0;He<je.length;He+=2)ze.push(Ae(je[He],We,je[He+1],Ue));return ze}function Ve(We,Ue,je){let ze=1e9,He=-1e9,Le=[];function qe(Je,pt,ut,lt,st){let sr=B.coordsAtPos(Je,Je==je.to?-2:2),mt=B.coordsAtPos(ut,ut==je.from?2:-2);!sr||!mt||(ze=Math.min(sr.top,mt.top,ze),He=Math.max(sr.bottom,mt.bottom,He),st==Direction.LTR?Le.push(X&&pt?le:sr.left,X&&lt?ue:mt.right):Le.push(!X&&lt?le:mt.left,!X&&pt?ue:sr.right))}let Qe=We??je.from,Ke=Ue??je.to;for(let Je of B.visibleRanges)if(Je.to>Qe&&Je.from<Ke)for(let pt=Math.max(Je.from,Qe),ut=Math.min(Je.to,Ke);;){let lt=B.state.doc.lineAt(pt);for(let st of B.bidiSpans(lt)){let sr=st.from+lt.from,mt=st.to+lt.from;if(sr>=ut)break;mt>pt&&qe(Math.max(sr,pt),We==null&&sr<=Qe,Math.min(mt,ut),Ue==null&&mt>=Ke,st.dir)}if(pt=lt.to+1,pt>=ut)break}return Le.length==0&&qe(Qe,We==null,Ke,Ue==null,B.textDirection),{top:ze,bottom:He,horizontal:Le}}function $e(We,Ue){let je=Y.top+(Ue?We.top:We.bottom);return{top:je,bottom:je,horizontal:[]}}}function sameMarker(B,_){return B.constructor==_.constructor&&B.eq(_)}class LayerView{constructor(_,T){this.view=_,this.layer=T,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=_.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),T.above&&this.dom.classList.add("cm-layer-above"),T.class&&this.dom.classList.add(T.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(_.state),_.requestMeasure(this.measureReq),T.mount&&T.mount(this.dom,_)}update(_){_.startState.facet(layerOrder)!=_.state.facet(layerOrder)&&this.setOrder(_.state),(this.layer.update(_,this.dom)||_.geometryChanged)&&(this.scale(),_.view.requestMeasure(this.measureReq))}docViewUpdate(_){this.layer.updateOnDocViewUpdate!==!1&&_.requestMeasure(this.measureReq)}setOrder(_){let T=0,E=_.facet(layerOrder);for(;T<E.length&&E[T]!=this.layer;)T++;this.dom.style.zIndex=String((this.layer.above?150:-1)-T)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:_,scaleY:T}=this.view;(_!=this.scaleX||T!=this.scaleY)&&(this.scaleX=_,this.scaleY=T,this.dom.style.transform=`scale(${1/_}, ${1/T})`)}draw(_){if(_.length!=this.drawn.length||_.some((T,E)=>!sameMarker(T,this.drawn[E]))){let T=this.dom.firstChild,E=0;for(let W of _)W.update&&T&&W.constructor&&this.drawn[E].constructor&&W.update(T,this.drawn[E])?(T=T.nextSibling,E++):this.dom.insertBefore(W.draw(),T);for(;T;){let W=T.nextSibling;T.remove(),T=W}this.drawn=_}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const layerOrder=Facet.define();function layer(B){return[ViewPlugin.define(_=>new LayerView(_,B)),layerOrder.of(B)]}const CanHidePrimary=!browser.ios,selectionConfig=Facet.define({combine(B){return combineConfig(B,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(_,T)=>Math.min(_,T),drawRangeCursor:(_,T)=>_||T})}});function drawSelection(B={}){return[selectionConfig.of(B),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden.of(!0)]}function configChanged(B){return B.startState.facet(selectionConfig)!=B.state.facet(selectionConfig)}const cursorLayer=layer({above:!0,markers(B){let{state:_}=B,T=_.facet(selectionConfig),E=[];for(let W of _.selection.ranges){let X=W==_.selection.main;if(W.empty?!X||CanHidePrimary:T.drawRangeCursor){let q=X?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",Y=W.empty?W:EditorSelection.cursor(W.head,W.head>W.anchor?-1:1);for(let te of RectangleMarker.forRange(B,q,Y))E.push(te)}}return E},update(B,_){B.transactions.some(E=>E.selection)&&(_.style.animationName=_.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let T=configChanged(B);return T&&setBlinkRate(B.state,_),B.docChanged||B.selectionSet||T},mount(B,_){setBlinkRate(_.state,B)},class:"cm-cursorLayer"});function setBlinkRate(B,_){_.style.animationDuration=B.facet(selectionConfig).cursorBlinkRate+"ms"}const selectionLayer=layer({above:!1,markers(B){return B.state.selection.ranges.map(_=>_.empty?[]:RectangleMarker.forRange(B,"cm-selectionBackground",_)).reduce((_,T)=>_.concat(T))},update(B,_){return B.docChanged||B.selectionSet||B.viewportChanged||configChanged(B)},class:"cm-selectionLayer"}),themeSpec={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};CanHidePrimary&&(themeSpec[".cm-line"].caretColor=themeSpec[".cm-content"].caretColor="transparent !important");const hideNativeSelection=Prec.highest(EditorView.theme(themeSpec)),setDropCursorPos=StateEffect.define({map(B,_){return B==null?null:_.mapPos(B)}}),dropCursorPos=StateField.define({create(){return null},update(B,_){return B!=null&&(B=_.changes.mapPos(B)),_.effects.reduce((T,E)=>E.is(setDropCursorPos)?E.value:T,B)}}),drawDropCursor=ViewPlugin.fromClass(class{constructor(B){this.view=B,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(B){var _;let T=B.state.field(dropCursorPos);T==null?this.cursor!=null&&((_=this.cursor)===null||_===void 0||_.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(B.startState.field(dropCursorPos)!=T||B.docChanged||B.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:B}=this,_=B.state.field(dropCursorPos),T=_!=null&&B.coordsAtPos(_);if(!T)return null;let E=B.scrollDOM.getBoundingClientRect();return{left:T.left-E.left+B.scrollDOM.scrollLeft*B.scaleX,top:T.top-E.top+B.scrollDOM.scrollTop*B.scaleY,height:T.bottom-T.top}}drawCursor(B){if(this.cursor){let{scaleX:_,scaleY:T}=this.view;B?(this.cursor.style.left=B.left/_+"px",this.cursor.style.top=B.top/T+"px",this.cursor.style.height=B.height/T+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(B){this.view.state.field(dropCursorPos)!=B&&this.view.dispatch({effects:setDropCursorPos.of(B)})}},{eventObservers:{dragover(B){this.setDropPos(this.view.posAtCoords({x:B.clientX,y:B.clientY}))},dragleave(B){(B.target==this.view.contentDOM||!this.view.contentDOM.contains(B.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function dropCursor(){return[dropCursorPos,drawDropCursor]}function iterMatches(B,_,T,E,W){_.lastIndex=0;for(let X=B.iterRange(T,E),q=T,Y;!X.next().done;q+=X.value.length)if(!X.lineBreak)for(;Y=_.exec(X.value);)W(q+Y.index,Y)}function matchRanges(B,_){let T=B.visibleRanges;if(T.length==1&&T[0].from==B.viewport.from&&T[0].to==B.viewport.to)return T;let E=[];for(let{from:W,to:X}of T)W=Math.max(B.state.doc.lineAt(W).from,W-_),X=Math.min(B.state.doc.lineAt(X).to,X+_),E.length&&E[E.length-1].to>=W?E[E.length-1].to=X:E.push({from:W,to:X});return E}class MatchDecorator{constructor(_){const{regexp:T,decoration:E,decorate:W,boundary:X,maxLength:q=1e3}=_;if(!T.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=T,W)this.addMatch=(Y,te,ne,ae)=>W(ae,ne,ne+Y[0].length,Y,te);else if(typeof E=="function")this.addMatch=(Y,te,ne,ae)=>{let le=E(Y,te,ne);le&&ae(ne,ne+Y[0].length,le)};else if(E)this.addMatch=(Y,te,ne,ae)=>ae(ne,ne+Y[0].length,E);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=X,this.maxLength=q}createDeco(_){let T=new RangeSetBuilder,E=T.add.bind(T);for(let{from:W,to:X}of matchRanges(_,this.maxLength))iterMatches(_.state.doc,this.regexp,W,X,(q,Y)=>this.addMatch(Y,_,q,E));return T.finish()}updateDeco(_,T){let E=1e9,W=-1;return _.docChanged&&_.changes.iterChanges((X,q,Y,te)=>{te>_.view.viewport.from&&Y<_.view.viewport.to&&(E=Math.min(Y,E),W=Math.max(te,W))}),_.viewportChanged||W-E>1e3?this.createDeco(_.view):W>-1?this.updateRange(_.view,T.map(_.changes),E,W):T}updateRange(_,T,E,W){for(let X of _.visibleRanges){let q=Math.max(X.from,E),Y=Math.min(X.to,W);if(Y>q){let te=_.state.doc.lineAt(q),ne=te.to<Y?_.state.doc.lineAt(Y):te,ae=Math.max(X.from,te.from),le=Math.min(X.to,ne.to);if(this.boundary){for(;q>te.from;q--)if(this.boundary.test(te.text[q-1-te.from])){ae=q;break}for(;Y<ne.to;Y++)if(this.boundary.test(ne.text[Y-ne.from])){le=Y;break}}let ue=[],ge,ye=(xe,Te,Ae)=>ue.push(Ae.range(xe,Te));if(te==ne)for(this.regexp.lastIndex=ae-te.from;(ge=this.regexp.exec(te.text))&&ge.index<le-te.from;)this.addMatch(ge,_,ge.index+te.from,ye);else iterMatches(_.state.doc,this.regexp,ae,le,(xe,Te)=>this.addMatch(Te,_,xe,ye));T=T.update({filterFrom:ae,filterTo:le,filter:(xe,Te)=>xe<ae||Te>le,add:ue})}}return T}}const UnicodeRegexpSupport=/x/.unicode!=null?"gu":"g",Specials=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,UnicodeRegexpSupport),Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _supportsTabSize=null;function supportsTabSize(){var B;if(_supportsTabSize==null&&typeof document<"u"&&document.body){let _=document.body.style;_supportsTabSize=((B=_.tabSize)!==null&&B!==void 0?B:_.MozTabSize)!=null}return _supportsTabSize||!1}const specialCharConfig=Facet.define({combine(B){let _=combineConfig(B,{render:null,specialChars:Specials,addSpecialChars:null});return(_.replaceTabs=!supportsTabSize())&&(_.specialChars=new RegExp("	|"+_.specialChars.source,UnicodeRegexpSupport)),_.addSpecialChars&&(_.specialChars=new RegExp(_.specialChars.source+"|"+_.addSpecialChars.source,UnicodeRegexpSupport)),_}});function highlightSpecialChars(B={}){return[specialCharConfig.of(B),specialCharPlugin()]}let _plugin=null;function specialCharPlugin(){return _plugin||(_plugin=ViewPlugin.fromClass(class{constructor(B){this.view=B,this.decorations=Decoration.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(B.state.facet(specialCharConfig)),this.decorations=this.decorator.createDeco(B)}makeDecorator(B){return new MatchDecorator({regexp:B.specialChars,decoration:(_,T,E)=>{let{doc:W}=T.state,X=codePointAt(_[0],0);if(X==9){let q=W.lineAt(E),Y=T.state.tabSize,te=countColumn(q.text,Y,E-q.from);return Decoration.replace({widget:new TabWidget((Y-te%Y)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[X]||(this.decorationCache[X]=Decoration.replace({widget:new SpecialCharWidget(B,X)}))},boundary:B.replaceTabs?void 0:/[^]/})}update(B){let _=B.state.facet(specialCharConfig);B.startState.facet(specialCharConfig)!=_?(this.decorator=this.makeDecorator(_),this.decorations=this.decorator.createDeco(B.view)):this.decorations=this.decorator.updateDeco(B,this.decorations)}},{decorations:B=>B.decorations}))}const DefaultPlaceholder="";function placeholder$1(B){return B>=32?DefaultPlaceholder:B==10?"":String.fromCharCode(9216+B)}class SpecialCharWidget extends WidgetType{constructor(_,T){super(),this.options=_,this.code=T}eq(_){return _.code==this.code}toDOM(_){let T=placeholder$1(this.code),E=_.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16)),W=this.options.render&&this.options.render(this.code,E,T);if(W)return W;let X=document.createElement("span");return X.textContent=T,X.title=E,X.setAttribute("aria-label",E),X.className="cm-specialChar",X}ignoreEvent(){return!1}}class TabWidget extends WidgetType{constructor(_){super(),this.width=_}eq(_){return _.width==this.width}toDOM(){let _=document.createElement("span");return _.textContent="	",_.className="cm-tab",_.style.width=this.width+"px",_}ignoreEvent(){return!1}}function highlightActiveLine(){return activeLineHighlighter}const lineDeco=Decoration.line({class:"cm-activeLine"}),activeLineHighlighter=ViewPlugin.fromClass(class{constructor(B){this.decorations=this.getDeco(B)}update(B){(B.docChanged||B.selectionSet)&&(this.decorations=this.getDeco(B.view))}getDeco(B){let _=-1,T=[];for(let E of B.state.selection.ranges){let W=B.lineBlockAt(E.head);W.from>_&&(T.push(lineDeco.range(W.from)),_=W.from)}return Decoration.set(T)}},{decorations:B=>B.decorations}),MaxOff=2e3;function rectangleFor(B,_,T){let E=Math.min(_.line,T.line),W=Math.max(_.line,T.line),X=[];if(_.off>MaxOff||T.off>MaxOff||_.col<0||T.col<0){let q=Math.min(_.off,T.off),Y=Math.max(_.off,T.off);for(let te=E;te<=W;te++){let ne=B.doc.line(te);ne.length<=Y&&X.push(EditorSelection.range(ne.from+q,ne.to+Y))}}else{let q=Math.min(_.col,T.col),Y=Math.max(_.col,T.col);for(let te=E;te<=W;te++){let ne=B.doc.line(te),ae=findColumn(ne.text,q,B.tabSize,!0);if(ae<0)X.push(EditorSelection.cursor(ne.to));else{let le=findColumn(ne.text,Y,B.tabSize);X.push(EditorSelection.range(ne.from+ae,ne.from+le))}}}return X}function absoluteColumn(B,_){let T=B.coordsAtPos(B.viewport.from);return T?Math.round(Math.abs((T.left-_)/B.defaultCharacterWidth)):-1}function getPos(B,_){let T=B.posAtCoords({x:_.clientX,y:_.clientY},!1),E=B.state.doc.lineAt(T),W=T-E.from,X=W>MaxOff?-1:W==E.length?absoluteColumn(B,_.clientX):countColumn(E.text,B.state.tabSize,T-E.from);return{line:E.number,col:X,off:W}}function rectangleSelectionStyle(B,_){let T=getPos(B,_),E=B.state.selection;return T?{update(W){if(W.docChanged){let X=W.changes.mapPos(W.startState.doc.line(T.line).from),q=W.state.doc.lineAt(X);T={line:q.number,col:T.col,off:Math.min(T.off,q.length)},E=E.map(W.changes)}},get(W,X,q){let Y=getPos(B,W);if(!Y)return E;let te=rectangleFor(B.state,T,Y);return te.length?q?EditorSelection.create(te.concat(E.ranges)):EditorSelection.create(te):E}}:null}function rectangularSelection(B){let _=T=>T.altKey&&T.button==0;return EditorView.mouseSelectionStyle.of((T,E)=>_(E)?rectangleSelectionStyle(T,E):null)}const keys={Alt:[18,B=>!!B.altKey],Control:[17,B=>!!B.ctrlKey],Shift:[16,B=>!!B.shiftKey],Meta:[91,B=>!!B.metaKey]},showCrosshair={style:"cursor: crosshair"};function crosshairCursor(B={}){let[_,T]=keys[B.key||"Alt"],E=ViewPlugin.fromClass(class{constructor(W){this.view=W,this.isDown=!1}set(W){this.isDown!=W&&(this.isDown=W,this.view.update([]))}},{eventObservers:{keydown(W){this.set(W.keyCode==_||T(W))},keyup(W){(W.keyCode==_||!T(W))&&this.set(!1)},mousemove(W){this.set(T(W))}}});return[E,EditorView.contentAttributes.of(W=>{var X;return!((X=W.plugin(E))===null||X===void 0)&&X.isDown?showCrosshair:null})]}const Outside="-10000px";class TooltipViewManager{constructor(_,T,E,W){this.facet=T,this.createTooltipView=E,this.removeTooltipView=W,this.input=_.state.facet(T),this.tooltips=this.input.filter(q=>q);let X=null;this.tooltipViews=this.tooltips.map(q=>X=E(q,X))}update(_,T){var E;let W=_.state.facet(this.facet),X=W.filter(te=>te);if(W===this.input){for(let te of this.tooltipViews)te.update&&te.update(_);return!1}let q=[],Y=T?[]:null;for(let te=0;te<X.length;te++){let ne=X[te],ae=-1;if(ne){for(let le=0;le<this.tooltips.length;le++){let ue=this.tooltips[le];ue&&ue.create==ne.create&&(ae=le)}if(ae<0)q[te]=this.createTooltipView(ne,te?q[te-1]:null),Y&&(Y[te]=!!ne.above);else{let le=q[te]=this.tooltipViews[ae];Y&&(Y[te]=T[ae]),le.update&&le.update(_)}}}for(let te of this.tooltipViews)q.indexOf(te)<0&&(this.removeTooltipView(te),(E=te.destroy)===null||E===void 0||E.call(te));return T&&(Y.forEach((te,ne)=>T[ne]=te),T.length=Y.length),this.input=W,this.tooltips=X,this.tooltipViews=q,!0}}function windowSpace(B){let{win:_}=B;return{top:0,left:0,bottom:_.innerHeight,right:_.innerWidth}}const tooltipConfig=Facet.define({combine:B=>{var _,T,E;return{position:browser.ios?"absolute":((_=B.find(W=>W.position))===null||_===void 0?void 0:_.position)||"fixed",parent:((T=B.find(W=>W.parent))===null||T===void 0?void 0:T.parent)||null,tooltipSpace:((E=B.find(W=>W.tooltipSpace))===null||E===void 0?void 0:E.tooltipSpace)||windowSpace}}}),knownHeight=new WeakMap,tooltipPlugin=ViewPlugin.fromClass(class{constructor(B){this.view=B,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let _=B.state.facet(tooltipConfig);this.position=_.position,this.parent=_.parent,this.classes=B.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new TooltipViewManager(B,showTooltip,(T,E)=>this.createTooltip(T,E),T=>{this.resizeObserver&&this.resizeObserver.unobserve(T.dom),T.dom.remove()}),this.above=this.manager.tooltips.map(T=>!!T.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(T=>{Date.now()>this.lastTransaction-50&&T.length>0&&T[T.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),B.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let B of this.manager.tooltipViews)this.intersectionObserver.observe(B.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(B){B.transactions.length&&(this.lastTransaction=Date.now());let _=this.manager.update(B,this.above);_&&this.observeIntersection();let T=_||B.geometryChanged,E=B.state.facet(tooltipConfig);if(E.position!=this.position&&!this.madeAbsolute){this.position=E.position;for(let W of this.manager.tooltipViews)W.dom.style.position=this.position;T=!0}if(E.parent!=this.parent){this.parent&&this.container.remove(),this.parent=E.parent,this.createContainer();for(let W of this.manager.tooltipViews)this.container.appendChild(W.dom);T=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);T&&this.maybeMeasure()}createTooltip(B,_){let T=B.create(this.view),E=_?_.dom:null;if(T.dom.classList.add("cm-tooltip"),B.arrow&&!T.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let W=document.createElement("div");W.className="cm-tooltip-arrow",T.dom.appendChild(W)}return T.dom.style.position=this.position,T.dom.style.top=Outside,T.dom.style.left="0px",this.container.insertBefore(T.dom,E),T.mount&&T.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(T.dom),T}destroy(){var B,_,T;this.view.win.removeEventListener("resize",this.measureSoon);for(let E of this.manager.tooltipViews)E.dom.remove(),(B=E.destroy)===null||B===void 0||B.call(E);this.parent&&this.container.remove(),(_=this.resizeObserver)===null||_===void 0||_.disconnect(),(T=this.intersectionObserver)===null||T===void 0||T.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let B=this.view.dom.getBoundingClientRect(),_=1,T=1,E=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:W}=this.manager.tooltipViews[0];if(browser.gecko)E=W.offsetParent!=this.container.ownerDocument.body;else if(W.style.top==Outside&&W.style.left=="0px"){let X=W.getBoundingClientRect();E=Math.abs(X.top+1e4)>1||Math.abs(X.left)>1}}if(E||this.position=="absolute")if(this.parent){let W=this.parent.getBoundingClientRect();W.width&&W.height&&(_=W.width/this.parent.offsetWidth,T=W.height/this.parent.offsetHeight)}else({scaleX:_,scaleY:T}=this.view.viewState);return{editor:B,parent:this.parent?this.container.getBoundingClientRect():B,pos:this.manager.tooltips.map((W,X)=>{let q=this.manager.tooltipViews[X];return q.getCoords?q.getCoords(W.pos):this.view.coordsAtPos(W.pos)}),size:this.manager.tooltipViews.map(({dom:W})=>W.getBoundingClientRect()),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view),scaleX:_,scaleY:T,makeAbsolute:E}}writeMeasure(B){var _;if(B.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let Y of this.manager.tooltipViews)Y.dom.style.position="absolute"}let{editor:T,space:E,scaleX:W,scaleY:X}=B,q=[];for(let Y=0;Y<this.manager.tooltips.length;Y++){let te=this.manager.tooltips[Y],ne=this.manager.tooltipViews[Y],{dom:ae}=ne,le=B.pos[Y],ue=B.size[Y];if(!le||le.bottom<=Math.max(T.top,E.top)||le.top>=Math.min(T.bottom,E.bottom)||le.right<Math.max(T.left,E.left)-.1||le.left>Math.min(T.right,E.right)+.1){ae.style.top=Outside;continue}let ge=te.arrow?ne.dom.querySelector(".cm-tooltip-arrow"):null,ye=ge?7:0,xe=ue.right-ue.left,Te=(_=knownHeight.get(ne))!==null&&_!==void 0?_:ue.bottom-ue.top,Ae=ne.offset||noOffset,Ie=this.view.textDirection==Direction.LTR,Ve=ue.width>E.right-E.left?Ie?E.left:E.right-ue.width:Ie?Math.max(E.left,Math.min(le.left-(ge?14:0)+Ae.x,E.right-xe)):Math.min(Math.max(E.left,le.left-xe+(ge?14:0)-Ae.x),E.right-xe),$e=this.above[Y];!te.strictSide&&($e?le.top-(ue.bottom-ue.top)-Ae.y<E.top:le.bottom+(ue.bottom-ue.top)+Ae.y>E.bottom)&&$e==E.bottom-le.bottom>le.top-E.top&&($e=this.above[Y]=!$e);let We=($e?le.top-E.top:E.bottom-le.bottom)-ye;if(We<Te&&ne.resize!==!1){if(We<this.view.defaultLineHeight){ae.style.top=Outside;continue}knownHeight.set(ne,Te),ae.style.height=(Te=We)/X+"px"}else ae.style.height&&(ae.style.height="");let Ue=$e?le.top-Te-ye-Ae.y:le.bottom+ye+Ae.y,je=Ve+xe;if(ne.overlap!==!0)for(let ze of q)ze.left<je&&ze.right>Ve&&ze.top<Ue+Te&&ze.bottom>Ue&&(Ue=$e?ze.top-Te-2-ye:ze.bottom+ye+2);if(this.position=="absolute"?(ae.style.top=(Ue-B.parent.top)/X+"px",ae.style.left=(Ve-B.parent.left)/W+"px"):(ae.style.top=Ue/X+"px",ae.style.left=Ve/W+"px"),ge){let ze=le.left+(Ie?Ae.x:-Ae.x)-(Ve+14-7);ge.style.left=ze/W+"px"}ne.overlap!==!0&&q.push({left:Ve,top:Ue,right:je,bottom:Ue+Te}),ae.classList.toggle("cm-tooltip-above",$e),ae.classList.toggle("cm-tooltip-below",!$e),ne.positioned&&ne.positioned(B.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let B of this.manager.tooltipViews)B.dom.style.top=Outside}},{eventObservers:{scroll(){this.maybeMeasure()}}}),baseTheme$4=EditorView.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),noOffset={x:0,y:0},showTooltip=Facet.define({enables:[tooltipPlugin,baseTheme$4]}),showHoverTooltip=Facet.define({combine:B=>B.reduce((_,T)=>_.concat(T),[])});class HoverTooltipHost{static create(_){return new HoverTooltipHost(_)}constructor(_){this.view=_,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new TooltipViewManager(_,showHoverTooltip,(T,E)=>this.createHostedView(T,E),T=>T.dom.remove())}createHostedView(_,T){let E=_.create(this.view);return E.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(E.dom,T?T.dom.nextSibling:this.dom.firstChild),this.mounted&&E.mount&&E.mount(this.view),E}mount(_){for(let T of this.manager.tooltipViews)T.mount&&T.mount(_);this.mounted=!0}positioned(_){for(let T of this.manager.tooltipViews)T.positioned&&T.positioned(_)}update(_){this.manager.update(_)}destroy(){var _;for(let T of this.manager.tooltipViews)(_=T.destroy)===null||_===void 0||_.call(T)}passProp(_){let T;for(let E of this.manager.tooltipViews){let W=E[_];if(W!==void 0){if(T===void 0)T=W;else if(T!==W)return}}return T}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const showHoverTooltipHost=showTooltip.compute([showHoverTooltip],B=>{let _=B.facet(showHoverTooltip);return _.length===0?null:{pos:Math.min(..._.map(T=>T.pos)),end:Math.max(..._.map(T=>{var E;return(E=T.end)!==null&&E!==void 0?E:T.pos})),create:HoverTooltipHost.create,above:_[0].above,arrow:_.some(T=>T.arrow)}});class HoverPlugin{constructor(_,T,E,W,X){this.view=_,this.source=T,this.field=E,this.setHover=W,this.hoverTime=X,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:_.dom,time:0},this.checkHover=this.checkHover.bind(this),_.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),_.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let _=Date.now()-this.lastMove.time;_<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-_):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:_,lastMove:T}=this,E=_.docView.nearest(T.target);if(!E)return;let W,X=1;if(E instanceof WidgetView)W=E.posAtStart;else{if(W=_.posAtCoords(T),W==null)return;let Y=_.coordsAtPos(W);if(!Y||T.y<Y.top||T.y>Y.bottom||T.x<Y.left-_.defaultCharacterWidth||T.x>Y.right+_.defaultCharacterWidth)return;let te=_.bidiSpans(_.state.doc.lineAt(W)).find(ae=>ae.from<=W&&ae.to>=W),ne=te&&te.dir==Direction.RTL?-1:1;X=T.x<Y.left?-ne:ne}let q=this.source(_,W,X);if(q!=null&&q.then){let Y=this.pending={pos:W};q.then(te=>{this.pending==Y&&(this.pending=null,te&&!(Array.isArray(te)&&!te.length)&&_.dispatch({effects:this.setHover.of(Array.isArray(te)?te:[te])}))},te=>logException(_.state,te,"hover tooltip"))}else q&&!(Array.isArray(q)&&!q.length)&&_.dispatch({effects:this.setHover.of(Array.isArray(q)?q:[q])})}get tooltip(){let _=this.view.plugin(tooltipPlugin),T=_?_.manager.tooltips.findIndex(E=>E.create==HoverTooltipHost.create):-1;return T>-1?_.manager.tooltipViews[T]:null}mousemove(_){var T,E;this.lastMove={x:_.clientX,y:_.clientY,target:_.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:W,tooltip:X}=this;if(W.length&&X&&!isInTooltip(X.dom,_)||this.pending){let{pos:q}=W[0]||this.pending,Y=(E=(T=W[0])===null||T===void 0?void 0:T.end)!==null&&E!==void 0?E:q;(q==Y?this.view.posAtCoords(this.lastMove)!=q:!isOverRange(this.view,q,Y,_.clientX,_.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(_){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:T}=this;if(T.length){let{tooltip:E}=this;E&&E.dom.contains(_.relatedTarget)?this.watchTooltipLeave(E.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(_){let T=E=>{_.removeEventListener("mouseleave",T),this.active.length&&!this.view.dom.contains(E.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};_.addEventListener("mouseleave",T)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const tooltipMargin=4;function isInTooltip(B,_){let{left:T,right:E,top:W,bottom:X}=B.getBoundingClientRect(),q;if(q=B.querySelector(".cm-tooltip-arrow")){let Y=q.getBoundingClientRect();W=Math.min(Y.top,W),X=Math.max(Y.bottom,X)}return _.clientX>=T-tooltipMargin&&_.clientX<=E+tooltipMargin&&_.clientY>=W-tooltipMargin&&_.clientY<=X+tooltipMargin}function isOverRange(B,_,T,E,W,X){let q=B.scrollDOM.getBoundingClientRect(),Y=B.documentTop+B.documentPadding.top+B.contentHeight;if(q.left>E||q.right<E||q.top>W||Math.min(q.bottom,Y)<W)return!1;let te=B.posAtCoords({x:E,y:W},!1);return te>=_&&te<=T}function hoverTooltip(B,_={}){let T=StateEffect.define(),E=StateField.define({create(){return[]},update(W,X){if(W.length&&(_.hideOnChange&&(X.docChanged||X.selection)?W=[]:_.hideOn&&(W=W.filter(q=>!_.hideOn(X,q))),X.docChanged)){let q=[];for(let Y of W){let te=X.changes.mapPos(Y.pos,-1,MapMode.TrackDel);if(te!=null){let ne=Object.assign(Object.create(null),Y);ne.pos=te,ne.end!=null&&(ne.end=X.changes.mapPos(ne.end)),q.push(ne)}}W=q}for(let q of X.effects)q.is(T)&&(W=q.value),q.is(closeHoverTooltipEffect)&&(W=[]);return W},provide:W=>showHoverTooltip.from(W)});return{active:E,extension:[E,ViewPlugin.define(W=>new HoverPlugin(W,B,E,T,_.hoverTime||300)),showHoverTooltipHost]}}function getTooltip(B,_){let T=B.plugin(tooltipPlugin);if(!T)return null;let E=T.manager.tooltips.indexOf(_);return E<0?null:T.manager.tooltipViews[E]}const closeHoverTooltipEffect=StateEffect.define(),panelConfig=Facet.define({combine(B){let _,T;for(let E of B)_=_||E.topContainer,T=T||E.bottomContainer;return{topContainer:_,bottomContainer:T}}});function getPanel(B,_){let T=B.plugin(panelPlugin),E=T?T.specs.indexOf(_):-1;return E>-1?T.panels[E]:null}const panelPlugin=ViewPlugin.fromClass(class{constructor(B){this.input=B.state.facet(showPanel),this.specs=this.input.filter(T=>T),this.panels=this.specs.map(T=>T(B));let _=B.state.facet(panelConfig);this.top=new PanelGroup(B,!0,_.topContainer),this.bottom=new PanelGroup(B,!1,_.bottomContainer),this.top.sync(this.panels.filter(T=>T.top)),this.bottom.sync(this.panels.filter(T=>!T.top));for(let T of this.panels)T.dom.classList.add("cm-panel"),T.mount&&T.mount()}update(B){let _=B.state.facet(panelConfig);this.top.container!=_.topContainer&&(this.top.sync([]),this.top=new PanelGroup(B.view,!0,_.topContainer)),this.bottom.container!=_.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(B.view,!1,_.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let T=B.state.facet(showPanel);if(T!=this.input){let E=T.filter(te=>te),W=[],X=[],q=[],Y=[];for(let te of E){let ne=this.specs.indexOf(te),ae;ne<0?(ae=te(B.view),Y.push(ae)):(ae=this.panels[ne],ae.update&&ae.update(B)),W.push(ae),(ae.top?X:q).push(ae)}this.specs=E,this.panels=W,this.top.sync(X),this.bottom.sync(q);for(let te of Y)te.dom.classList.add("cm-panel"),te.mount&&te.mount()}else for(let E of this.panels)E.update&&E.update(B)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:B=>EditorView.scrollMargins.of(_=>{let T=_.plugin(B);return T&&{top:T.top.scrollMargin(),bottom:T.bottom.scrollMargin()}})});class PanelGroup{constructor(_,T,E){this.view=_,this.top=T,this.container=E,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(_){for(let T of this.panels)T.destroy&&_.indexOf(T)<0&&T.destroy();this.panels=_,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let T=this.container||this.view.dom;T.insertBefore(this.dom,this.top?T.firstChild:null)}let _=this.dom.firstChild;for(let T of this.panels)if(T.dom.parentNode==this.dom){for(;_!=T.dom;)_=rm(_);_=_.nextSibling}else this.dom.insertBefore(T.dom,_);for(;_;)_=rm(_)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let _ of this.classes.split(" "))_&&this.container.classList.remove(_);for(let _ of(this.classes=this.view.themeClasses).split(" "))_&&this.container.classList.add(_)}}}function rm(B){let _=B.nextSibling;return B.remove(),_}const showPanel=Facet.define({enables:panelPlugin});class GutterMarker extends RangeValue{compare(_){return this==_||this.constructor==_.constructor&&this.eq(_)}eq(_){return!1}destroy(_){}}GutterMarker.prototype.elementClass="";GutterMarker.prototype.toDOM=void 0;GutterMarker.prototype.mapMode=MapMode.TrackBefore;GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1;GutterMarker.prototype.point=!0;const gutterLineClass=Facet.define(),gutterWidgetClass=Facet.define(),defaults$1={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},activeGutters=Facet.define();function gutter(B){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults$1),B))]}const unfixGutters=Facet.define({combine:B=>B.some(_=>_)});function gutters(B){return[gutterView]}const gutterView=ViewPlugin.fromClass(class{constructor(B){this.view=B,this.prevViewport=B.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=B.state.facet(activeGutters).map(_=>new SingleGutterView(B,_));for(let _ of this.gutters)this.dom.appendChild(_.dom);this.fixed=!B.state.facet(unfixGutters),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),B.scrollDOM.insertBefore(this.dom,B.contentDOM)}update(B){if(this.updateGutters(B)){let _=this.prevViewport,T=B.view.viewport,E=Math.min(_.to,T.to)-Math.max(_.from,T.from);this.syncGutters(E<(T.to-T.from)*.8)}B.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(unfixGutters)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=B.view.viewport}syncGutters(B){let _=this.dom.nextSibling;B&&this.dom.remove();let T=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from),E=[],W=this.gutters.map(X=>new UpdateContext(X,this.view.viewport,-this.view.documentPadding.top));for(let X of this.view.viewportLineBlocks)if(E.length&&(E=[]),Array.isArray(X.type)){let q=!0;for(let Y of X.type)if(Y.type==BlockType.Text&&q){advanceCursor(T,E,Y.from);for(let te of W)te.line(this.view,Y,E);q=!1}else if(Y.widget)for(let te of W)te.widget(this.view,Y)}else if(X.type==BlockType.Text){advanceCursor(T,E,X.from);for(let q of W)q.line(this.view,X,E)}else if(X.widget)for(let q of W)q.widget(this.view,X);for(let X of W)X.finish();B&&this.view.scrollDOM.insertBefore(this.dom,_)}updateGutters(B){let _=B.startState.facet(activeGutters),T=B.state.facet(activeGutters),E=B.docChanged||B.heightChanged||B.viewportChanged||!RangeSet.eq(B.startState.facet(gutterLineClass),B.state.facet(gutterLineClass),B.view.viewport.from,B.view.viewport.to);if(_==T)for(let W of this.gutters)W.update(B)&&(E=!0);else{E=!0;let W=[];for(let X of T){let q=_.indexOf(X);q<0?W.push(new SingleGutterView(this.view,X)):(this.gutters[q].update(B),W.push(this.gutters[q]))}for(let X of this.gutters)X.dom.remove(),W.indexOf(X)<0&&X.destroy();for(let X of W)this.dom.appendChild(X.dom);this.gutters=W}return E}destroy(){for(let B of this.gutters)B.destroy();this.dom.remove()}},{provide:B=>EditorView.scrollMargins.of(_=>{let T=_.plugin(B);return!T||T.gutters.length==0||!T.fixed?null:_.textDirection==Direction.LTR?{left:T.dom.offsetWidth*_.scaleX}:{right:T.dom.offsetWidth*_.scaleX}})});function asArray(B){return Array.isArray(B)?B:[B]}function advanceCursor(B,_,T){for(;B.value&&B.from<=T;)B.from==T&&_.push(B.value),B.next()}class UpdateContext{constructor(_,T,E){this.gutter=_,this.height=E,this.i=0,this.cursor=RangeSet.iter(_.markers,T.from)}addElement(_,T,E){let{gutter:W}=this,X=(T.top-this.height)/_.scaleY,q=T.height/_.scaleY;if(this.i==W.elements.length){let Y=new GutterElement(_,q,X,E);W.elements.push(Y),W.dom.appendChild(Y.dom)}else W.elements[this.i].update(_,q,X,E);this.height=T.bottom,this.i++}line(_,T,E){let W=[];advanceCursor(this.cursor,W,T.from),E.length&&(W=W.concat(E));let X=this.gutter.config.lineMarker(_,T,W);X&&W.unshift(X);let q=this.gutter;W.length==0&&!q.config.renderEmptyElements||this.addElement(_,T,W)}widget(_,T){let E=this.gutter.config.widgetMarker(_,T.widget,T),W=E?[E]:null;for(let X of _.state.facet(gutterWidgetClass)){let q=X(_,T.widget,T);q&&(W||(W=[])).push(q)}W&&this.addElement(_,T,W)}finish(){let _=this.gutter;for(;_.elements.length>this.i;){let T=_.elements.pop();_.dom.removeChild(T.dom),T.destroy()}}}class SingleGutterView{constructor(_,T){this.view=_,this.config=T,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let E in T.domEventHandlers)this.dom.addEventListener(E,W=>{let X=W.target,q;if(X!=this.dom&&this.dom.contains(X)){for(;X.parentNode!=this.dom;)X=X.parentNode;let te=X.getBoundingClientRect();q=(te.top+te.bottom)/2}else q=W.clientY;let Y=_.lineBlockAtHeight(q-_.documentTop);T.domEventHandlers[E](_,Y,W)&&W.preventDefault()});this.markers=asArray(T.markers(_)),T.initialSpacer&&(this.spacer=new GutterElement(_,0,0,[T.initialSpacer(_)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(_){let T=this.markers;if(this.markers=asArray(this.config.markers(_.view)),this.spacer&&this.config.updateSpacer){let W=this.config.updateSpacer(this.spacer.markers[0],_);W!=this.spacer.markers[0]&&this.spacer.update(_.view,0,0,[W])}let E=_.view.viewport;return!RangeSet.eq(this.markers,T,E.from,E.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(_):!1)}destroy(){for(let _ of this.elements)_.destroy()}}class GutterElement{constructor(_,T,E,W){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(_,T,E,W)}update(_,T,E,W){this.height!=T&&(this.height=T,this.dom.style.height=T+"px"),this.above!=E&&(this.dom.style.marginTop=(this.above=E)?E+"px":""),sameMarkers(this.markers,W)||this.setMarkers(_,W)}setMarkers(_,T){let E="cm-gutterElement",W=this.dom.firstChild;for(let X=0,q=0;;){let Y=q,te=X<T.length?T[X++]:null,ne=!1;if(te){let ae=te.elementClass;ae&&(E+=" "+ae);for(let le=q;le<this.markers.length;le++)if(this.markers[le].compare(te)){Y=le,ne=!0;break}}else Y=this.markers.length;for(;q<Y;){let ae=this.markers[q++];if(ae.toDOM){ae.destroy(W);let le=W.nextSibling;W.remove(),W=le}}if(!te)break;te.toDOM&&(ne?W=W.nextSibling:this.dom.insertBefore(te.toDOM(_),W)),ne&&q++}this.dom.className=E,this.markers=T}destroy(){this.setMarkers(null,[])}}function sameMarkers(B,_){if(B.length!=_.length)return!1;for(let T=0;T<B.length;T++)if(!B[T].compare(_[T]))return!1;return!0}const lineNumberMarkers=Facet.define(),lineNumberWidgetMarker=Facet.define(),lineNumberConfig=Facet.define({combine(B){return combineConfig(B,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(_,T){let E=Object.assign({},_);for(let W in T){let X=E[W],q=T[W];E[W]=X?(Y,te,ne)=>X(Y,te,ne)||q(Y,te,ne):q}return E}})}});class NumberMarker extends GutterMarker{constructor(_){super(),this.number=_}eq(_){return this.number==_.number}toDOM(){return document.createTextNode(this.number)}}function formatNumber(B,_){return B.state.facet(lineNumberConfig).formatNumber(_,B.state)}const lineNumberGutter=activeGutters.compute([lineNumberConfig],B=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(_){return _.state.facet(lineNumberMarkers)},lineMarker(_,T,E){return E.some(W=>W.toDOM)?null:new NumberMarker(formatNumber(_,_.state.doc.lineAt(T.from).number))},widgetMarker:(_,T,E)=>{for(let W of _.state.facet(lineNumberWidgetMarker)){let X=W(_,T,E);if(X)return X}return null},lineMarkerChange:_=>_.startState.facet(lineNumberConfig)!=_.state.facet(lineNumberConfig),initialSpacer(_){return new NumberMarker(formatNumber(_,maxLineNumber(_.state.doc.lines)))},updateSpacer(_,T){let E=formatNumber(T.view,maxLineNumber(T.view.state.doc.lines));return E==_.number?_:new NumberMarker(E)},domEventHandlers:B.facet(lineNumberConfig).domEventHandlers}));function lineNumbers(B={}){return[lineNumberConfig.of(B),gutters(),lineNumberGutter]}function maxLineNumber(B){let _=9;for(;_<B;)_=_*10+9;return _}const activeLineGutterMarker=new class extends GutterMarker{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},activeLineGutterHighlighter=gutterLineClass.compute(["selection"],B=>{let _=[],T=-1;for(let E of B.selection.ranges){let W=B.doc.lineAt(E.head).from;W>T&&(T=W,_.push(activeLineGutterMarker.range(W)))}return RangeSet.of(_)});function highlightActiveLineGutter(){return activeLineGutterHighlighter}const DefaultBufferLength=1024;let nextPropID=0;class Range{constructor(_,T){this.from=_,this.to=T}}class NodeProp{constructor(_={}){this.id=nextPropID++,this.perNode=!!_.perNode,this.deserialize=_.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(_){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof _!="function"&&(_=NodeType.match(_)),T=>{let E=_(T);return E===void 0?null:[this,E]}}}NodeProp.closedBy=new NodeProp({deserialize:B=>B.split(" ")});NodeProp.openedBy=new NodeProp({deserialize:B=>B.split(" ")});NodeProp.group=new NodeProp({deserialize:B=>B.split(" ")});NodeProp.isolate=new NodeProp({deserialize:B=>{if(B&&B!="rtl"&&B!="ltr"&&B!="auto")throw new RangeError("Invalid value for isolate: "+B);return B||"auto"}});NodeProp.contextHash=new NodeProp({perNode:!0});NodeProp.lookAhead=new NodeProp({perNode:!0});NodeProp.mounted=new NodeProp({perNode:!0});class MountedTree{constructor(_,T,E){this.tree=_,this.overlay=T,this.parser=E}static get(_){return _&&_.props&&_.props[NodeProp.mounted.id]}}const noProps=Object.create(null);class NodeType{constructor(_,T,E,W=0){this.name=_,this.props=T,this.id=E,this.flags=W}static define(_){let T=_.props&&_.props.length?Object.create(null):noProps,E=(_.top?1:0)|(_.skipped?2:0)|(_.error?4:0)|(_.name==null?8:0),W=new NodeType(_.name||"",T,_.id,E);if(_.props){for(let X of _.props)if(Array.isArray(X)||(X=X(W)),X){if(X[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");T[X[0].id]=X[1]}}return W}prop(_){return this.props[_.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(_){if(typeof _=="string"){if(this.name==_)return!0;let T=this.prop(NodeProp.group);return T?T.indexOf(_)>-1:!1}return this.id==_}static match(_){let T=Object.create(null);for(let E in _)for(let W of E.split(" "))T[W]=_[E];return E=>{for(let W=E.prop(NodeProp.group),X=-1;X<(W?W.length:0);X++){let q=T[X<0?E.name:W[X]];if(q)return q}}}}NodeType.none=new NodeType("",Object.create(null),0,8);class NodeSet{constructor(_){this.types=_;for(let T=0;T<_.length;T++)if(_[T].id!=T)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(..._){let T=[];for(let E of this.types){let W=null;for(let X of _){let q=X(E);q&&(W||(W=Object.assign({},E.props)),W[q[0].id]=q[1])}T.push(W?new NodeType(E.name,W,E.id,E.flags):E)}return new NodeSet(T)}}const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;(function(B){B[B.ExcludeBuffers=1]="ExcludeBuffers",B[B.IncludeAnonymous=2]="IncludeAnonymous",B[B.IgnoreMounts=4]="IgnoreMounts",B[B.IgnoreOverlays=8]="IgnoreOverlays"})(IterMode||(IterMode={}));class Tree{constructor(_,T,E,W,X){if(this.type=_,this.children=T,this.positions=E,this.length=W,this.props=null,X&&X.length){this.props=Object.create(null);for(let[q,Y]of X)this.props[typeof q=="number"?q:q.id]=Y}}toString(){let _=MountedTree.get(this);if(_&&!_.overlay)return _.tree.toString();let T="";for(let E of this.children){let W=E.toString();W&&(T&&(T+=","),T+=W)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(T.length?"("+T+")":""):T}cursor(_=0){return new TreeCursor(this.topNode,_)}cursorAt(_,T=0,E=0){let W=CachedNode.get(this)||this.topNode,X=new TreeCursor(W);return X.moveTo(_,T),CachedNode.set(this,X._tree),X}get topNode(){return new TreeNode$1(this,0,0,null)}resolve(_,T=0){let E=resolveNode(CachedNode.get(this)||this.topNode,_,T,!1);return CachedNode.set(this,E),E}resolveInner(_,T=0){let E=resolveNode(CachedInnerNode.get(this)||this.topNode,_,T,!0);return CachedInnerNode.set(this,E),E}resolveStack(_,T=0){return stackIterator(this,_,T)}iterate(_){let{enter:T,leave:E,from:W=0,to:X=this.length}=_,q=_.mode||0,Y=(q&IterMode.IncludeAnonymous)>0;for(let te=this.cursor(q|IterMode.IncludeAnonymous);;){let ne=!1;if(te.from<=X&&te.to>=W&&(!Y&&te.type.isAnonymous||T(te)!==!1)){if(te.firstChild())continue;ne=!0}for(;ne&&E&&(Y||!te.type.isAnonymous)&&E(te),!te.nextSibling();){if(!te.parent())return;ne=!0}}}prop(_){return _.perNode?this.props?this.props[_.id]:void 0:this.type.prop(_)}get propValues(){let _=[];if(this.props)for(let T in this.props)_.push([+T,this.props[T]]);return _}balance(_={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,(T,E,W)=>new Tree(this.type,T,E,W,this.propValues),_.makeTree||((T,E,W)=>new Tree(NodeType.none,T,E,W)))}static build(_){return buildTree(_)}}Tree.empty=new Tree(NodeType.none,[],[],0);class FlatBufferCursor{constructor(_,T){this.buffer=_,this.index=T}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(_,T,E){this.buffer=_,this.length=T,this.set=E}get type(){return NodeType.none}toString(){let _=[];for(let T=0;T<this.buffer.length;)_.push(this.childString(T)),T=this.buffer[T+3];return _.join(",")}childString(_){let T=this.buffer[_],E=this.buffer[_+3],W=this.set.types[T],X=W.name;if(/\W/.test(X)&&!W.isError&&(X=JSON.stringify(X)),_+=4,E==_)return X;let q=[];for(;_<E;)q.push(this.childString(_)),_=this.buffer[_+3];return X+"("+q.join(",")+")"}findChild(_,T,E,W,X){let{buffer:q}=this,Y=-1;for(let te=_;te!=T&&!(checkSide(X,W,q[te+1],q[te+2])&&(Y=te,E>0));te=q[te+3]);return Y}slice(_,T,E){let W=this.buffer,X=new Uint16Array(T-_),q=0;for(let Y=_,te=0;Y<T;){X[te++]=W[Y++],X[te++]=W[Y++]-E;let ne=X[te++]=W[Y++]-E;X[te++]=W[Y++]-_,q=Math.max(q,ne)}return new TreeBuffer(X,q,this.set)}}function checkSide(B,_,T,E){switch(B){case-2:return T<_;case-1:return E>=_&&T<_;case 0:return T<_&&E>_;case 1:return T<=_&&E>_;case 2:return E>_;case 4:return!0}}function resolveNode(B,_,T,E){for(var W;B.from==B.to||(T<1?B.from>=_:B.from>_)||(T>-1?B.to<=_:B.to<_);){let q=!E&&B instanceof TreeNode$1&&B.index<0?null:B.parent;if(!q)return B;B=q}let X=E?0:IterMode.IgnoreOverlays;if(E)for(let q=B,Y=q.parent;Y;q=Y,Y=q.parent)q instanceof TreeNode$1&&q.index<0&&((W=Y.enter(_,T,X))===null||W===void 0?void 0:W.from)!=q.from&&(B=Y);for(;;){let q=B.enter(_,T,X);if(!q)return B;B=q}}class BaseNode{cursor(_=0){return new TreeCursor(this,_)}getChild(_,T=null,E=null){let W=getChildren(this,_,T,E);return W.length?W[0]:null}getChildren(_,T=null,E=null){return getChildren(this,_,T,E)}resolve(_,T=0){return resolveNode(this,_,T,!1)}resolveInner(_,T=0){return resolveNode(this,_,T,!0)}matchContext(_){return matchNodeContext(this,_)}enterUnfinishedNodesBefore(_){let T=this.childBefore(_),E=this;for(;T;){let W=T.lastChild;if(!W||W.to!=T.to)break;W.type.isError&&W.from==W.to?(E=T,T=W.prevSibling):T=W}return E}get node(){return this}get next(){return this.parent}}let TreeNode$1=class xu extends BaseNode{constructor(_,T,E,W){super(),this._tree=_,this.from=T,this.index=E,this._parent=W}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(_,T,E,W,X=0){for(let q=this;;){for(let{children:Y,positions:te}=q._tree,ne=T>0?Y.length:-1;_!=ne;_+=T){let ae=Y[_],le=te[_]+q.from;if(checkSide(W,E,le,le+ae.length)){if(ae instanceof TreeBuffer){if(X&IterMode.ExcludeBuffers)continue;let ue=ae.findChild(0,ae.buffer.length,T,E-le,W);if(ue>-1)return new BufferNode(new BufferContext(q,ae,_,le),null,ue)}else if(X&IterMode.IncludeAnonymous||!ae.type.isAnonymous||hasChild(ae)){let ue;if(!(X&IterMode.IgnoreMounts)&&(ue=MountedTree.get(ae))&&!ue.overlay)return new xu(ue.tree,le,_,q);let ge=new xu(ae,le,_,q);return X&IterMode.IncludeAnonymous||!ge.type.isAnonymous?ge:ge.nextChild(T<0?ae.children.length-1:0,T,E,W)}}}if(X&IterMode.IncludeAnonymous||!q.type.isAnonymous||(q.index>=0?_=q.index+T:_=T<0?-1:q._parent._tree.children.length,q=q._parent,!q))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(_){return this.nextChild(0,1,_,2)}childBefore(_){return this.nextChild(this._tree.children.length-1,-1,_,-2)}enter(_,T,E=0){let W;if(!(E&IterMode.IgnoreOverlays)&&(W=MountedTree.get(this._tree))&&W.overlay){let X=_-this.from;for(let{from:q,to:Y}of W.overlay)if((T>0?q<=X:q<X)&&(T<0?Y>=X:Y>X))return new xu(W.tree,W.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,_,T,E)}nextSignificantParent(){let _=this;for(;_.type.isAnonymous&&_._parent;)_=_._parent;return _}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function getChildren(B,_,T,E){let W=B.cursor(),X=[];if(!W.firstChild())return X;if(T!=null){for(let q=!1;!q;)if(q=W.type.is(T),!W.nextSibling())return X}for(;;){if(E!=null&&W.type.is(E))return X;if(W.type.is(_)&&X.push(W.node),!W.nextSibling())return E==null?X:[]}}function matchNodeContext(B,_,T=_.length-1){for(let E=B.parent;T>=0;E=E.parent){if(!E)return!1;if(!E.type.isAnonymous){if(_[T]&&_[T]!=E.name)return!1;T--}}return!0}class BufferContext{constructor(_,T,E,W){this.parent=_,this.buffer=T,this.index=E,this.start=W}}class BufferNode extends BaseNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(_,T,E){super(),this.context=_,this._parent=T,this.index=E,this.type=_.buffer.set.types[_.buffer.buffer[E]]}child(_,T,E){let{buffer:W}=this.context,X=W.findChild(this.index+4,W.buffer[this.index+3],_,T-this.context.start,E);return X<0?null:new BufferNode(this.context,this,X)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(_){return this.child(1,_,2)}childBefore(_){return this.child(-1,_,-2)}enter(_,T,E=0){if(E&IterMode.ExcludeBuffers)return null;let{buffer:W}=this.context,X=W.findChild(this.index+4,W.buffer[this.index+3],T>0?1:-1,_-this.context.start,T);return X<0?null:new BufferNode(this.context,this,X)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(_){return this._parent?null:this.context.parent.nextChild(this.context.index+_,_,0,4)}get nextSibling(){let{buffer:_}=this.context,T=_.buffer[this.index+3];return T<(this._parent?_.buffer[this._parent.index+3]:_.buffer.length)?new BufferNode(this.context,this._parent,T):this.externalSibling(1)}get prevSibling(){let{buffer:_}=this.context,T=this._parent?this._parent.index+4:0;return this.index==T?this.externalSibling(-1):new BufferNode(this.context,this._parent,_.findChild(T,this.index,-1,0,4))}get tree(){return null}toTree(){let _=[],T=[],{buffer:E}=this.context,W=this.index+4,X=E.buffer[this.index+3];if(X>W){let q=E.buffer[this.index+1];_.push(E.slice(W,X,q)),T.push(0)}return new Tree(this.type,_,T,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function iterStack(B){if(!B.length)return null;let _=0,T=B[0];for(let X=1;X<B.length;X++){let q=B[X];(q.from>T.from||q.to<T.to)&&(T=q,_=X)}let E=T instanceof TreeNode$1&&T.index<0?null:T.parent,W=B.slice();return E?W[_]=E:W.splice(_,1),new StackIterator(W,T)}class StackIterator{constructor(_,T){this.heads=_,this.node=T}get next(){return iterStack(this.heads)}}function stackIterator(B,_,T){let E=B.resolveInner(_,T),W=null;for(let X=E instanceof TreeNode$1?E:E.context.parent;X;X=X.parent)if(X.index<0){let q=X.parent;(W||(W=[E])).push(q.resolve(_,T)),X=q}else{let q=MountedTree.get(X.tree);if(q&&q.overlay&&q.overlay[0].from<=_&&q.overlay[q.overlay.length-1].to>=_){let Y=new TreeNode$1(q.tree,q.overlay[0].from+X.from,-1,X);(W||(W=[E])).push(resolveNode(Y,_,T,!1))}}return W?iterStack(W):E}class TreeCursor{get name(){return this.type.name}constructor(_,T=0){if(this.mode=T,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,_ instanceof TreeNode$1)this.yieldNode(_);else{this._tree=_.context.parent,this.buffer=_.context;for(let E=_._parent;E;E=E._parent)this.stack.unshift(E.index);this.bufferNode=_,this.yieldBuf(_.index)}}yieldNode(_){return _?(this._tree=_,this.type=_.type,this.from=_.from,this.to=_.to,!0):!1}yieldBuf(_,T){this.index=_;let{start:E,buffer:W}=this.buffer;return this.type=T||W.set.types[W.buffer[_]],this.from=E+W.buffer[_+1],this.to=E+W.buffer[_+2],!0}yield(_){return _?_ instanceof TreeNode$1?(this.buffer=null,this.yieldNode(_)):(this.buffer=_.context,this.yieldBuf(_.index,_.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(_,T,E){if(!this.buffer)return this.yield(this._tree.nextChild(_<0?this._tree._tree.children.length-1:0,_,T,E,this.mode));let{buffer:W}=this.buffer,X=W.findChild(this.index+4,W.buffer[this.index+3],_,T-this.buffer.start,E);return X<0?!1:(this.stack.push(this.index),this.yieldBuf(X))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(_){return this.enterChild(1,_,2)}childBefore(_){return this.enterChild(-1,_,-2)}enter(_,T,E=this.mode){return this.buffer?E&IterMode.ExcludeBuffers?!1:this.enterChild(1,_,T):this.yield(this._tree.enter(_,T,E))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let _=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(_)}sibling(_){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+_,_,0,4,this.mode)):!1;let{buffer:T}=this.buffer,E=this.stack.length-1;if(_<0){let W=E<0?0:this.stack[E]+4;if(this.index!=W)return this.yieldBuf(T.findChild(W,this.index,-1,0,4))}else{let W=T.buffer[this.index+3];if(W<(E<0?T.buffer.length:T.buffer[this.stack[E]+3]))return this.yieldBuf(W)}return E<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+_,_,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(_){let T,E,{buffer:W}=this;if(W){if(_>0){if(this.index<W.buffer.buffer.length)return!1}else for(let X=0;X<this.index;X++)if(W.buffer.buffer[X+3]<this.index)return!1;({index:T,parent:E}=W)}else({index:T,_parent:E}=this._tree);for(;E;{index:T,_parent:E}=E)if(T>-1)for(let X=T+_,q=_<0?-1:E._tree.children.length;X!=q;X+=_){let Y=E._tree.children[X];if(this.mode&IterMode.IncludeAnonymous||Y instanceof TreeBuffer||!Y.type.isAnonymous||hasChild(Y))return!1}return!0}move(_,T){if(T&&this.enterChild(_,0,4))return!0;for(;;){if(this.sibling(_))return!0;if(this.atLastNode(_)||!this.parent())return!1}}next(_=!0){return this.move(1,_)}prev(_=!0){return this.move(-1,_)}moveTo(_,T=0){for(;(this.from==this.to||(T<1?this.from>=_:this.from>_)||(T>-1?this.to<=_:this.to<_))&&this.parent(););for(;this.enterChild(1,_,T););return this}get node(){if(!this.buffer)return this._tree;let _=this.bufferNode,T=null,E=0;if(_&&_.context==this.buffer)e:for(let W=this.index,X=this.stack.length;X>=0;){for(let q=_;q;q=q._parent)if(q.index==W){if(W==this.index)return q;T=q,E=X+1;break e}W=this.stack[--X]}for(let W=E;W<this.stack.length;W++)T=new BufferNode(this.buffer,T,this.stack[W]);return this.bufferNode=new BufferNode(this.buffer,T,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(_,T){for(let E=0;;){let W=!1;if(this.type.isAnonymous||_(this)!==!1){if(this.firstChild()){E++;continue}this.type.isAnonymous||(W=!0)}for(;W&&T&&T(this),W=this.type.isAnonymous,!this.nextSibling();){if(!E)return;this.parent(),E--,W=!0}}}matchContext(_){if(!this.buffer)return matchNodeContext(this.node,_);let{buffer:T}=this.buffer,{types:E}=T.set;for(let W=_.length-1,X=this.stack.length-1;W>=0;X--){if(X<0)return matchNodeContext(this.node,_,W);let q=E[T.buffer[this.stack[X]]];if(!q.isAnonymous){if(_[W]&&_[W]!=q.name)return!1;W--}}return!0}}function hasChild(B){return B.children.some(_=>_ instanceof TreeBuffer||!_.type.isAnonymous||hasChild(_))}function buildTree(B){var _;let{buffer:T,nodeSet:E,maxBufferLength:W=DefaultBufferLength,reused:X=[],minRepeatType:q=E.types.length}=B,Y=Array.isArray(T)?new FlatBufferCursor(T,T.length):T,te=E.types,ne=0,ae=0;function le(We,Ue,je,ze,He,Le){let{id:qe,start:Qe,end:Ke,size:Je}=Y,pt=ae;for(;Je<0;)if(Y.next(),Je==-1){let mt=X[qe];je.push(mt),ze.push(Qe-We);return}else if(Je==-3){ne=qe;return}else if(Je==-4){ae=qe;return}else throw new RangeError(`Unrecognized record size: ${Je}`);let ut=te[qe],lt,st,sr=Qe-We;if(Ke-Qe<=W&&(st=Te(Y.pos-Ue,He))){let mt=new Uint16Array(st.size-st.skip),Tr=Y.pos-st.size,di=mt.length;for(;Y.pos>Tr;)di=Ae(st.start,mt,di);lt=new TreeBuffer(mt,Ke-st.start,E),sr=st.start-We}else{let mt=Y.pos-Je;Y.next();let Tr=[],di=[],Mi=qe>=q?qe:-1,Gr=0,ci=Ke;for(;Y.pos>mt;)Mi>=0&&Y.id==Mi&&Y.size>=0?(Y.end<=ci-W&&(ye(Tr,di,Qe,Gr,Y.end,ci,Mi,pt),Gr=Tr.length,ci=Y.end),Y.next()):Le>2500?ue(Qe,mt,Tr,di):le(Qe,mt,Tr,di,Mi,Le+1);if(Mi>=0&&Gr>0&&Gr<Tr.length&&ye(Tr,di,Qe,Gr,Qe,ci,Mi,pt),Tr.reverse(),di.reverse(),Mi>-1&&Gr>0){let gi=ge(ut);lt=balanceRange(ut,Tr,di,0,Tr.length,0,Ke-Qe,gi,gi)}else lt=xe(ut,Tr,di,Ke-Qe,pt-Ke)}je.push(lt),ze.push(sr)}function ue(We,Ue,je,ze){let He=[],Le=0,qe=-1;for(;Y.pos>Ue;){let{id:Qe,start:Ke,end:Je,size:pt}=Y;if(pt>4)Y.next();else{if(qe>-1&&Ke<qe)break;qe<0&&(qe=Je-W),He.push(Qe,Ke,Je),Le++,Y.next()}}if(Le){let Qe=new Uint16Array(Le*4),Ke=He[He.length-2];for(let Je=He.length-3,pt=0;Je>=0;Je-=3)Qe[pt++]=He[Je],Qe[pt++]=He[Je+1]-Ke,Qe[pt++]=He[Je+2]-Ke,Qe[pt++]=pt;je.push(new TreeBuffer(Qe,He[2]-Ke,E)),ze.push(Ke-We)}}function ge(We){return(Ue,je,ze)=>{let He=0,Le=Ue.length-1,qe,Qe;if(Le>=0&&(qe=Ue[Le])instanceof Tree){if(!Le&&qe.type==We&&qe.length==ze)return qe;(Qe=qe.prop(NodeProp.lookAhead))&&(He=je[Le]+qe.length+Qe)}return xe(We,Ue,je,ze,He)}}function ye(We,Ue,je,ze,He,Le,qe,Qe){let Ke=[],Je=[];for(;We.length>ze;)Ke.push(We.pop()),Je.push(Ue.pop()+je-He);We.push(xe(E.types[qe],Ke,Je,Le-He,Qe-Le)),Ue.push(He-je)}function xe(We,Ue,je,ze,He=0,Le){if(ne){let qe=[NodeProp.contextHash,ne];Le=Le?[qe].concat(Le):[qe]}if(He>25){let qe=[NodeProp.lookAhead,He];Le=Le?[qe].concat(Le):[qe]}return new Tree(We,Ue,je,ze,Le)}function Te(We,Ue){let je=Y.fork(),ze=0,He=0,Le=0,qe=je.end-W,Qe={size:0,start:0,skip:0};e:for(let Ke=je.pos-We;je.pos>Ke;){let Je=je.size;if(je.id==Ue&&Je>=0){Qe.size=ze,Qe.start=He,Qe.skip=Le,Le+=4,ze+=4,je.next();continue}let pt=je.pos-Je;if(Je<0||pt<Ke||je.start<qe)break;let ut=je.id>=q?4:0,lt=je.start;for(je.next();je.pos>pt;){if(je.size<0)if(je.size==-3)ut+=4;else break e;else je.id>=q&&(ut+=4);je.next()}He=lt,ze+=Je,Le+=ut}return(Ue<0||ze==We)&&(Qe.size=ze,Qe.start=He,Qe.skip=Le),Qe.size>4?Qe:void 0}function Ae(We,Ue,je){let{id:ze,start:He,end:Le,size:qe}=Y;if(Y.next(),qe>=0&&ze<q){let Qe=je;if(qe>4){let Ke=Y.pos-(qe-4);for(;Y.pos>Ke;)je=Ae(We,Ue,je)}Ue[--je]=Qe,Ue[--je]=Le-We,Ue[--je]=He-We,Ue[--je]=ze}else qe==-3?ne=ze:qe==-4&&(ae=ze);return je}let Ie=[],Ve=[];for(;Y.pos>0;)le(B.start||0,B.bufferStart||0,Ie,Ve,-1,0);let $e=(_=B.length)!==null&&_!==void 0?_:Ie.length?Ve[0]+Ie[0].length:0;return new Tree(te[B.topID],Ie.reverse(),Ve.reverse(),$e)}const nodeSizeCache=new WeakMap;function nodeSize(B,_){if(!B.isAnonymous||_ instanceof TreeBuffer||_.type!=B)return 1;let T=nodeSizeCache.get(_);if(T==null){T=1;for(let E of _.children){if(E.type!=B||!(E instanceof Tree)){T=1;break}T+=nodeSize(B,E)}nodeSizeCache.set(_,T)}return T}function balanceRange(B,_,T,E,W,X,q,Y,te){let ne=0;for(let ye=E;ye<W;ye++)ne+=nodeSize(B,_[ye]);let ae=Math.ceil(ne*1.5/8),le=[],ue=[];function ge(ye,xe,Te,Ae,Ie){for(let Ve=Te;Ve<Ae;){let $e=Ve,We=xe[Ve],Ue=nodeSize(B,ye[Ve]);for(Ve++;Ve<Ae;Ve++){let je=nodeSize(B,ye[Ve]);if(Ue+je>=ae)break;Ue+=je}if(Ve==$e+1){if(Ue>ae){let je=ye[$e];ge(je.children,je.positions,0,je.children.length,xe[$e]+Ie);continue}le.push(ye[$e])}else{let je=xe[Ve-1]+ye[Ve-1].length-We;le.push(balanceRange(B,ye,xe,$e,Ve,We,je,null,te))}ue.push(We+Ie-X)}}return ge(_,T,E,W,0),(Y||te)(le,ue,q)}class TreeFragment{constructor(_,T,E,W,X=!1,q=!1){this.from=_,this.to=T,this.tree=E,this.offset=W,this.open=(X?1:0)|(q?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(_,T=[],E=!1){let W=[new TreeFragment(0,_.length,_,0,!1,E)];for(let X of T)X.to>_.length&&W.push(X);return W}static applyChanges(_,T,E=128){if(!T.length)return _;let W=[],X=1,q=_.length?_[0]:null;for(let Y=0,te=0,ne=0;;Y++){let ae=Y<T.length?T[Y]:null,le=ae?ae.fromA:1e9;if(le-te>=E)for(;q&&q.from<le;){let ue=q;if(te>=ue.from||le<=ue.to||ne){let ge=Math.max(ue.from,te)-ne,ye=Math.min(ue.to,le)-ne;ue=ge>=ye?null:new TreeFragment(ge,ye,ue.tree,ue.offset+ne,Y>0,!!ae)}if(ue&&W.push(ue),q.to>le)break;q=X<_.length?_[X++]:null}if(!ae)break;te=ae.toA,ne=ae.toA-ae.toB}return W}}class Parser{startParse(_,T,E){return typeof _=="string"&&(_=new StringInput(_)),E=E?E.length?E.map(W=>new Range(W.from,W.to)):[new Range(0,0)]:[new Range(0,_.length)],this.createParse(_,T||[],E)}parse(_,T,E){let W=this.startParse(_,T,E);for(;;){let X=W.advance();if(X)return X}}}class StringInput{constructor(_){this.string=_}get length(){return this.string.length}chunk(_){return this.string.slice(_)}get lineChunks(){return!1}read(_,T){return this.string.slice(_,T)}}new NodeProp({perNode:!0});let nextTagID=0;class Tag{constructor(_,T,E,W){this.name=_,this.set=T,this.base=E,this.modified=W,this.id=nextTagID++}toString(){let{name:_}=this;for(let T of this.modified)T.name&&(_=`${T.name}(${_})`);return _}static define(_,T){let E=typeof _=="string"?_:"?";if(_ instanceof Tag&&(T=_),T!=null&&T.base)throw new Error("Can not derive from a modified tag");let W=new Tag(E,[],null,[]);if(W.set.push(W),T)for(let X of T.set)W.set.push(X);return W}static defineModifier(_){let T=new Modifier(_);return E=>E.modified.indexOf(T)>-1?E:Modifier.get(E.base||E,E.modified.concat(T).sort((W,X)=>W.id-X.id))}}let nextModifierID=0;class Modifier{constructor(_){this.name=_,this.instances=[],this.id=nextModifierID++}static get(_,T){if(!T.length)return _;let E=T[0].instances.find(Y=>Y.base==_&&sameArray(T,Y.modified));if(E)return E;let W=[],X=new Tag(_.name,W,_,T);for(let Y of T)Y.instances.push(X);let q=powerSet(T);for(let Y of _.set)if(!Y.modified.length)for(let te of q)W.push(Modifier.get(Y,te));return X}}function sameArray(B,_){return B.length==_.length&&B.every((T,E)=>T==_[E])}function powerSet(B){let _=[[]];for(let T=0;T<B.length;T++)for(let E=0,W=_.length;E<W;E++)_.push(_[E].concat(B[T]));return _.sort((T,E)=>E.length-T.length)}function styleTags(B){let _=Object.create(null);for(let T in B){let E=B[T];Array.isArray(E)||(E=[E]);for(let W of T.split(" "))if(W){let X=[],q=2,Y=W;for(let le=0;;){if(Y=="..."&&le>0&&le+3==W.length){q=1;break}let ue=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Y);if(!ue)throw new RangeError("Invalid path: "+W);if(X.push(ue[0]=="*"?"":ue[0][0]=='"'?JSON.parse(ue[0]):ue[0]),le+=ue[0].length,le==W.length)break;let ge=W[le++];if(le==W.length&&ge=="!"){q=0;break}if(ge!="/")throw new RangeError("Invalid path: "+W);Y=W.slice(le)}let te=X.length-1,ne=X[te];if(!ne)throw new RangeError("Invalid path: "+W);let ae=new Rule(E,q,te>0?X.slice(0,te):null);_[ne]=ae.sort(_[ne])}}return ruleNodeProp.add(_)}const ruleNodeProp=new NodeProp;class Rule{constructor(_,T,E,W){this.tags=_,this.mode=T,this.context=E,this.next=W}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(_){return!_||_.depth<this.depth?(this.next=_,this):(_.next=this.sort(_.next),_)}get depth(){return this.context?this.context.length:0}}Rule.empty=new Rule([],2,null);function tagHighlighter(B,_){let T=Object.create(null);for(let X of B)if(!Array.isArray(X.tag))T[X.tag.id]=X.class;else for(let q of X.tag)T[q.id]=X.class;let{scope:E,all:W=null}=_||{};return{style:X=>{let q=W;for(let Y of X)for(let te of Y.set){let ne=T[te.id];if(ne){q=q?q+" "+ne:ne;break}}return q},scope:E}}function highlightTags(B,_){let T=null;for(let E of B){let W=E.style(_);W&&(T=T?T+" "+W:W)}return T}function highlightTree(B,_,T,E=0,W=B.length){let X=new HighlightBuilder(E,Array.isArray(_)?_:[_],T);X.highlightRange(B.cursor(),E,W,"",X.highlighters),X.flush(W)}class HighlightBuilder{constructor(_,T,E){this.at=_,this.highlighters=T,this.span=E,this.class=""}startSpan(_,T){T!=this.class&&(this.flush(_),_>this.at&&(this.at=_),this.class=T)}flush(_){_>this.at&&this.class&&this.span(this.at,_,this.class)}highlightRange(_,T,E,W,X){let{type:q,from:Y,to:te}=_;if(Y>=E||te<=T)return;q.isTop&&(X=this.highlighters.filter(ge=>!ge.scope||ge.scope(q)));let ne=W,ae=getStyleTags(_)||Rule.empty,le=highlightTags(X,ae.tags);if(le&&(ne&&(ne+=" "),ne+=le,ae.mode==1&&(W+=(W?" ":"")+le)),this.startSpan(Math.max(T,Y),ne),ae.opaque)return;let ue=_.tree&&_.tree.prop(NodeProp.mounted);if(ue&&ue.overlay){let ge=_.node.enter(ue.overlay[0].from+Y,1),ye=this.highlighters.filter(Te=>!Te.scope||Te.scope(ue.tree.type)),xe=_.firstChild();for(let Te=0,Ae=Y;;Te++){let Ie=Te<ue.overlay.length?ue.overlay[Te]:null,Ve=Ie?Ie.from+Y:te,$e=Math.max(T,Ae),We=Math.min(E,Ve);if($e<We&&xe)for(;_.from<We&&(this.highlightRange(_,$e,We,W,X),this.startSpan(Math.min(We,_.to),ne),!(_.to>=Ve||!_.nextSibling())););if(!Ie||Ve>E)break;Ae=Ie.to+Y,Ae>T&&(this.highlightRange(ge.cursor(),Math.max(T,Ie.from+Y),Math.min(E,Ae),"",ye),this.startSpan(Math.min(E,Ae),ne))}xe&&_.parent()}else if(_.firstChild()){ue&&(W="");do if(!(_.to<=T)){if(_.from>=E)break;this.highlightRange(_,T,E,W,X),this.startSpan(Math.min(E,_.to),ne)}while(_.nextSibling());_.parent()}}}function getStyleTags(B){let _=B.type.prop(ruleNodeProp);for(;_&&_.context&&!B.matchContext(_.context);)_=_.next;return _||null}const t$1=Tag.define,comment=t$1(),name=t$1(),typeName=t$1(name),propertyName=t$1(name),literal=t$1(),string=t$1(literal),number=t$1(literal),content=t$1(),heading=t$1(content),keyword=t$1(),operator=t$1(),punctuation=t$1(),bracket=t$1(punctuation),meta=t$1(),tags={comment,lineComment:t$1(comment),blockComment:t$1(comment),docComment:t$1(comment),name,variableName:t$1(name),typeName,tagName:t$1(typeName),propertyName,attributeName:t$1(propertyName),className:t$1(name),labelName:t$1(name),namespace:t$1(name),macroName:t$1(name),literal,string,docString:t$1(string),character:t$1(string),attributeValue:t$1(string),number,integer:t$1(number),float:t$1(number),bool:t$1(literal),regexp:t$1(literal),escape:t$1(literal),color:t$1(literal),url:t$1(literal),keyword,self:t$1(keyword),null:t$1(keyword),atom:t$1(keyword),unit:t$1(keyword),modifier:t$1(keyword),operatorKeyword:t$1(keyword),controlKeyword:t$1(keyword),definitionKeyword:t$1(keyword),moduleKeyword:t$1(keyword),operator,derefOperator:t$1(operator),arithmeticOperator:t$1(operator),logicOperator:t$1(operator),bitwiseOperator:t$1(operator),compareOperator:t$1(operator),updateOperator:t$1(operator),definitionOperator:t$1(operator),typeOperator:t$1(operator),controlOperator:t$1(operator),punctuation,separator:t$1(punctuation),bracket,angleBracket:t$1(bracket),squareBracket:t$1(bracket),paren:t$1(bracket),brace:t$1(bracket),content,heading,heading1:t$1(heading),heading2:t$1(heading),heading3:t$1(heading),heading4:t$1(heading),heading5:t$1(heading),heading6:t$1(heading),contentSeparator:t$1(content),list:t$1(content),quote:t$1(content),emphasis:t$1(content),strong:t$1(content),link:t$1(content),monospace:t$1(content),strikethrough:t$1(content),inserted:t$1(),deleted:t$1(),changed:t$1(),invalid:t$1(),meta,documentMeta:t$1(meta),annotation:t$1(meta),processingInstruction:t$1(meta),definition:Tag.defineModifier("definition"),constant:Tag.defineModifier("constant"),function:Tag.defineModifier("function"),standard:Tag.defineModifier("standard"),local:Tag.defineModifier("local"),special:Tag.defineModifier("special")};for(let B in tags){let _=tags[B];_ instanceof Tag&&(_.name=B)}tagHighlighter([{tag:tags.link,class:"tok-link"},{tag:tags.heading,class:"tok-heading"},{tag:tags.emphasis,class:"tok-emphasis"},{tag:tags.strong,class:"tok-strong"},{tag:tags.keyword,class:"tok-keyword"},{tag:tags.atom,class:"tok-atom"},{tag:tags.bool,class:"tok-bool"},{tag:tags.url,class:"tok-url"},{tag:tags.labelName,class:"tok-labelName"},{tag:tags.inserted,class:"tok-inserted"},{tag:tags.deleted,class:"tok-deleted"},{tag:tags.literal,class:"tok-literal"},{tag:tags.string,class:"tok-string"},{tag:tags.number,class:"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],class:"tok-string2"},{tag:tags.variableName,class:"tok-variableName"},{tag:tags.local(tags.variableName),class:"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),class:"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),class:"tok-variableName2"},{tag:tags.definition(tags.propertyName),class:"tok-propertyName tok-definition"},{tag:tags.typeName,class:"tok-typeName"},{tag:tags.namespace,class:"tok-namespace"},{tag:tags.className,class:"tok-className"},{tag:tags.macroName,class:"tok-macroName"},{tag:tags.propertyName,class:"tok-propertyName"},{tag:tags.operator,class:"tok-operator"},{tag:tags.comment,class:"tok-comment"},{tag:tags.meta,class:"tok-meta"},{tag:tags.invalid,class:"tok-invalid"},{tag:tags.punctuation,class:"tok-punctuation"}]);var _a$1;const languageDataProp=new NodeProp;function defineLanguageFacet(B){return Facet.define({combine:B?_=>_.concat(B):void 0})}const sublanguageProp=new NodeProp;class Language{constructor(_,T,E=[],W=""){this.data=_,this.name=W,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=T,this.extension=[language.of(this),EditorState.languageData.of((X,q,Y)=>{let te=topNodeAt(X,q,Y),ne=te.type.prop(languageDataProp);if(!ne)return[];let ae=X.facet(ne),le=te.type.prop(sublanguageProp);if(le){let ue=te.resolve(q-te.from,Y);for(let ge of le)if(ge.test(ue,X)){let ye=X.facet(ge.facet);return ge.type=="replace"?ye:ye.concat(ae)}}return ae})].concat(E)}isActiveAt(_,T,E=-1){return topNodeAt(_,T,E).type.prop(languageDataProp)==this.data}findRegions(_){let T=_.facet(language);if((T==null?void 0:T.data)==this.data)return[{from:0,to:_.doc.length}];if(!T||!T.allowsNesting)return[];let E=[],W=(X,q)=>{if(X.prop(languageDataProp)==this.data){E.push({from:q,to:q+X.length});return}let Y=X.prop(NodeProp.mounted);if(Y){if(Y.tree.prop(languageDataProp)==this.data){if(Y.overlay)for(let te of Y.overlay)E.push({from:te.from+q,to:te.to+q});else E.push({from:q,to:q+X.length});return}else if(Y.overlay){let te=E.length;if(W(Y.tree,Y.overlay[0].from+q),E.length>te)return}}for(let te=0;te<X.children.length;te++){let ne=X.children[te];ne instanceof Tree&&W(ne,X.positions[te]+q)}};return W(syntaxTree(_),0),E}get allowsNesting(){return!0}}Language.setState=StateEffect.define();function topNodeAt(B,_,T){let E=B.facet(language),W=syntaxTree(B).topNode;if(!E||E.allowsNesting)for(let X=W;X;X=X.enter(_,T,IterMode.ExcludeBuffers))X.type.isTop&&(W=X);return W}class LRLanguage extends Language{constructor(_,T,E){super(_,T,[],E),this.parser=T}static define(_){let T=defineLanguageFacet(_.languageData);return new LRLanguage(T,_.parser.configure({props:[languageDataProp.add(E=>E.isTop?T:void 0)]}),_.name)}configure(_,T){return new LRLanguage(this.data,this.parser.configure(_),T||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(B){let _=B.field(Language.state,!1);return _?_.tree:Tree.empty}class DocInput{constructor(_){this.doc=_,this.cursorPos=0,this.string="",this.cursor=_.iter()}get length(){return this.doc.length}syncTo(_){return this.string=this.cursor.next(_-this.cursorPos).value,this.cursorPos=_+this.string.length,this.cursorPos-this.string.length}chunk(_){return this.syncTo(_),this.string}get lineChunks(){return!0}read(_,T){let E=this.cursorPos-this.string.length;return _<E||T>=this.cursorPos?this.doc.sliceString(_,T):this.string.slice(_-E,T-E)}}let currentContext=null;class ParseContext{constructor(_,T,E=[],W,X,q,Y,te){this.parser=_,this.state=T,this.fragments=E,this.tree=W,this.treeLen=X,this.viewport=q,this.skipped=Y,this.scheduleOn=te,this.parse=null,this.tempSkipped=[]}static create(_,T,E){return new ParseContext(_,T,[],Tree.empty,0,E,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(_,T){return T!=null&&T>=this.state.doc.length&&(T=void 0),this.tree!=Tree.empty&&this.isDone(T??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var E;if(typeof _=="number"){let W=Date.now()+_;_=()=>Date.now()>W}for(this.parse||(this.parse=this.startParse()),T!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>T)&&T<this.state.doc.length&&this.parse.stopAt(T);;){let W=this.parse.advance();if(W)if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(W,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(E=this.parse.stoppedAt)!==null&&E!==void 0?E:this.state.doc.length,this.tree=W,this.parse=null,this.treeLen<(T??this.state.doc.length))this.parse=this.startParse();else return!0;if(_())return!1}})}takeTree(){let _,T;this.parse&&(_=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>_)&&this.parse.stopAt(_),this.withContext(()=>{for(;!(T=this.parse.advance()););}),this.treeLen=_,this.tree=T,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(_){let T=currentContext;currentContext=this;try{return _()}finally{currentContext=T}}withoutTempSkipped(_){for(let T;T=this.tempSkipped.pop();)_=cutFragments(_,T.from,T.to);return _}changes(_,T){let{fragments:E,tree:W,treeLen:X,viewport:q,skipped:Y}=this;if(this.takeTree(),!_.empty){let te=[];if(_.iterChangedRanges((ne,ae,le,ue)=>te.push({fromA:ne,toA:ae,fromB:le,toB:ue})),E=TreeFragment.applyChanges(E,te),W=Tree.empty,X=0,q={from:_.mapPos(q.from,-1),to:_.mapPos(q.to,1)},this.skipped.length){Y=[];for(let ne of this.skipped){let ae=_.mapPos(ne.from,1),le=_.mapPos(ne.to,-1);ae<le&&Y.push({from:ae,to:le})}}}return new ParseContext(this.parser,T,E,W,X,q,Y,this.scheduleOn)}updateViewport(_){if(this.viewport.from==_.from&&this.viewport.to==_.to)return!1;this.viewport=_;let T=this.skipped.length;for(let E=0;E<this.skipped.length;E++){let{from:W,to:X}=this.skipped[E];W<_.to&&X>_.from&&(this.fragments=cutFragments(this.fragments,W,X),this.skipped.splice(E--,1))}return this.skipped.length>=T?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(_,T){this.skipped.push({from:_,to:T})}static getSkippingParser(_){return new class extends Parser{createParse(T,E,W){let X=W[0].from,q=W[W.length-1].to;return{parsedPos:X,advance(){let te=currentContext;if(te){for(let ne of W)te.tempSkipped.push(ne);_&&(te.scheduleOn=te.scheduleOn?Promise.all([te.scheduleOn,_]):_)}return this.parsedPos=q,new Tree(NodeType.none,[],[],q-X)},stoppedAt:null,stopAt(){}}}}}isDone(_){_=Math.min(_,this.state.doc.length);let T=this.fragments;return this.treeLen>=_&&T.length&&T[0].from==0&&T[0].to>=_}static get(){return currentContext}}function cutFragments(B,_,T){return TreeFragment.applyChanges(B,[{fromA:_,toA:T,fromB:_,toB:T}])}class LanguageState{constructor(_){this.context=_,this.tree=_.tree}apply(_){if(!_.docChanged&&this.tree==this.context.tree)return this;let T=this.context.changes(_.changes,_.state),E=this.context.treeLen==_.startState.doc.length?void 0:Math.max(_.changes.mapPos(this.context.treeLen),T.viewport.to);return T.work(20,E)||T.takeTree(),new LanguageState(T)}static init(_){let T=Math.min(3e3,_.doc.length),E=ParseContext.create(_.facet(language).parser,_,{from:0,to:T});return E.work(20,T)||E.takeTree(),new LanguageState(E)}}Language.state=StateField.define({create:LanguageState.init,update(B,_){for(let T of _.effects)if(T.is(Language.setState))return T.value;return _.startState.facet(language)!=_.state.facet(language)?LanguageState.init(_.state):B.apply(_)}});let requestIdle=B=>{let _=setTimeout(()=>B(),500);return()=>clearTimeout(_)};typeof requestIdleCallback<"u"&&(requestIdle=B=>{let _=-1,T=setTimeout(()=>{_=requestIdleCallback(B,{timeout:400})},100);return()=>_<0?clearTimeout(T):cancelIdleCallback(_)});const isInputPending=typeof navigator<"u"&&(!((_a$1=navigator.scheduling)===null||_a$1===void 0)&&_a$1.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(_){this.view=_,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(_){let T=this.view.state.field(Language.state).context;(T.updateViewport(_.view.viewport)||this.view.viewport.to>T.treeLen)&&this.scheduleWork(),(_.docChanged||_.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(T)}scheduleWork(){if(this.working)return;let{state:_}=this.view,T=_.field(Language.state);(T.tree!=T.context.tree||!T.context.isDone(_.doc.length))&&(this.working=requestIdle(this.work))}work(_){this.working=null;let T=Date.now();if(this.chunkEnd<T&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=T+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:E,viewport:{to:W}}=this.view,X=E.field(Language.state);if(X.tree==X.context.tree&&X.context.isDone(W+1e5))return;let q=Date.now()+Math.min(this.chunkBudget,100,_&&!isInputPending?Math.max(25,_.timeRemaining()-5):1e9),Y=X.context.treeLen<W&&E.doc.length>W+1e3,te=X.context.work(()=>isInputPending&&isInputPending()||Date.now()>q,W+(Y?0:1e5));this.chunkBudget-=Date.now()-T,(te||this.chunkBudget<=0)&&(X.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(X.context))})),this.chunkBudget>0&&!(te&&!Y)&&this.scheduleWork(),this.checkAsyncSchedule(X.context)}checkAsyncSchedule(_){_.scheduleOn&&(this.workScheduled++,_.scheduleOn.then(()=>this.scheduleWork()).catch(T=>logException(this.view.state,T)).then(()=>this.workScheduled--),_.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine(B){return B.length?B[0]:null},enables:B=>[Language.state,parseWorker,EditorView.contentAttributes.compute([B],_=>{let T=_.facet(B);return T&&T.name?{"data-language":T.name}:{}})]});class LanguageSupport{constructor(_,T=[]){this.language=_,this.support=T,this.extension=[_,T]}}const indentService=Facet.define(),indentUnit=Facet.define({combine:B=>{if(!B.length)return"  ";let _=B[0];if(!_||/\S/.test(_)||Array.from(_).some(T=>T!=_[0]))throw new Error("Invalid indent unit: "+JSON.stringify(B[0]));return _}});function getIndentUnit(B){let _=B.facet(indentUnit);return _.charCodeAt(0)==9?B.tabSize*_.length:_.length}function indentString(B,_){let T="",E=B.tabSize,W=B.facet(indentUnit)[0];if(W=="	"){for(;_>=E;)T+="	",_-=E;W=" "}for(let X=0;X<_;X++)T+=W;return T}function getIndentation(B,_){B instanceof EditorState&&(B=new IndentContext(B));for(let E of B.state.facet(indentService)){let W=E(B,_);if(W!==void 0)return W}let T=syntaxTree(B.state);return T.length>=_?syntaxIndentation(B,T,_):null}class IndentContext{constructor(_,T={}){this.state=_,this.options=T,this.unit=getIndentUnit(_)}lineAt(_,T=1){let E=this.state.doc.lineAt(_),{simulateBreak:W,simulateDoubleBreak:X}=this.options;return W!=null&&W>=E.from&&W<=E.to?X&&W==_?{text:"",from:_}:(T<0?W<_:W<=_)?{text:E.text.slice(W-E.from),from:W}:{text:E.text.slice(0,W-E.from),from:E.from}:E}textAfterPos(_,T=1){if(this.options.simulateDoubleBreak&&_==this.options.simulateBreak)return"";let{text:E,from:W}=this.lineAt(_,T);return E.slice(_-W,Math.min(E.length,_+100-W))}column(_,T=1){let{text:E,from:W}=this.lineAt(_,T),X=this.countColumn(E,_-W),q=this.options.overrideIndentation?this.options.overrideIndentation(W):-1;return q>-1&&(X+=q-this.countColumn(E,E.search(/\S|$/))),X}countColumn(_,T=_.length){return countColumn(_,this.state.tabSize,T)}lineIndent(_,T=1){let{text:E,from:W}=this.lineAt(_,T),X=this.options.overrideIndentation;if(X){let q=X(W);if(q>-1)return q}return this.countColumn(E,E.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp;function syntaxIndentation(B,_,T){let E=_.resolveStack(T),W=E.node.enterUnfinishedNodesBefore(T);if(W!=E.node){let X=[];for(let q=W;q!=E.node;q=q.parent)X.push(q);for(let q=X.length-1;q>=0;q--)E={node:X[q],next:E}}return indentFor(E,B,T)}function indentFor(B,_,T){for(let E=B;E;E=E.next){let W=indentStrategy(E.node);if(W)return W(TreeIndentContext.create(_,T,E))}return 0}function ignoreClosed(B){return B.pos==B.options.simulateBreak&&B.options.simulateDoubleBreak}function indentStrategy(B){let _=B.type.prop(indentNodeProp);if(_)return _;let T=B.firstChild,E;if(T&&(E=T.type.prop(NodeProp.closedBy))){let W=B.lastChild,X=W&&E.indexOf(W.name)>-1;return q=>delimitedStrategy(q,!0,1,void 0,X&&!ignoreClosed(q)?W.from:void 0)}return B.parent==null?topIndent:null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(_,T,E){super(_.state,_.options),this.base=_,this.pos=T,this.context=E}get node(){return this.context.node}static create(_,T,E){return new TreeIndentContext(_,T,E)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(_){let T=this.state.doc.lineAt(_.from);for(;;){let E=_.resolve(T.from);for(;E.parent&&E.parent.from==E.from;)E=E.parent;if(isParent(E,_))break;T=this.state.doc.lineAt(E.from)}return this.lineIndent(T.from)}continue(){return indentFor(this.context.next,this.base,this.pos)}}function isParent(B,_){for(let T=_;T;T=T.parent)if(B==T)return!0;return!1}function bracketedAligned(B){let _=B.node,T=_.childAfter(_.from),E=_.lastChild;if(!T)return null;let W=B.options.simulateBreak,X=B.state.doc.lineAt(T.from),q=W==null||W<=X.from?X.to:Math.min(X.to,W);for(let Y=T.to;;){let te=_.childAfter(Y);if(!te||te==E)return null;if(!te.type.isSkipped)return te.from<q?T:null;Y=te.to}}function delimitedIndent({closing:B,align:_=!0,units:T=1}){return E=>delimitedStrategy(E,_,T,B)}function delimitedStrategy(B,_,T,E,W){let X=B.textAfter,q=X.match(/^\s*/)[0].length,Y=E&&X.slice(q,q+E.length)==E||W==B.pos+q,te=_?bracketedAligned(B):null;return te?Y?B.column(te.from):B.column(te.to):B.baseIndent+(Y?0:B.unit*T)}const flatIndent=B=>B.baseIndent;function continuedIndent({except:B,units:_=1}={}){return T=>{let E=B&&B.test(T.textAfter);return T.baseIndent+(E?0:_*T.unit)}}const DontIndentBeyond=200;function indentOnInput(){return EditorState.transactionFilter.of(B=>{if(!B.docChanged||!B.isUserEvent("input.type")&&!B.isUserEvent("input.complete"))return B;let _=B.startState.languageDataAt("indentOnInput",B.startState.selection.main.head);if(!_.length)return B;let T=B.newDoc,{head:E}=B.newSelection.main,W=T.lineAt(E);if(E>W.from+DontIndentBeyond)return B;let X=T.sliceString(W.from,E);if(!_.some(ne=>ne.test(X)))return B;let{state:q}=B,Y=-1,te=[];for(let{head:ne}of q.selection.ranges){let ae=q.doc.lineAt(ne);if(ae.from==Y)continue;Y=ae.from;let le=getIndentation(q,ae.from);if(le==null)continue;let ue=/^\s*/.exec(ae.text)[0],ge=indentString(q,le);ue!=ge&&te.push({from:ae.from,to:ae.from+ue.length,insert:ge})}return te.length?[B,{changes:te,sequential:!0}]:B})}const foldService=Facet.define(),foldNodeProp=new NodeProp;function foldInside(B){let _=B.firstChild,T=B.lastChild;return _&&_.to<T.from?{from:_.to,to:T.type.isError?B.to:T.from}:null}function syntaxFolding(B,_,T){let E=syntaxTree(B);if(E.length<T)return null;let W=E.resolveStack(T,1),X=null;for(let q=W;q;q=q.next){let Y=q.node;if(Y.to<=T||Y.from>T)continue;if(X&&Y.from<_)break;let te=Y.type.prop(foldNodeProp);if(te&&(Y.to<E.length-50||E.length==B.doc.length||!isUnfinished(Y))){let ne=te(Y,B);ne&&ne.from<=T&&ne.from>=_&&ne.to>T&&(X=ne)}}return X}function isUnfinished(B){let _=B.lastChild;return _&&_.to==B.to&&_.type.isError}function foldable(B,_,T){for(let E of B.facet(foldService)){let W=E(B,_,T);if(W)return W}return syntaxFolding(B,_,T)}function mapRange(B,_){let T=_.mapPos(B.from,1),E=_.mapPos(B.to,-1);return T>=E?void 0:{from:T,to:E}}const foldEffect=StateEffect.define({map:mapRange}),unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(B){let _=[];for(let{head:T}of B.state.selection.ranges)_.some(E=>E.from<=T&&E.to>=T)||_.push(B.lineBlockAt(T));return _}const foldState=StateField.define({create(){return Decoration.none},update(B,_){B=B.map(_.changes);for(let T of _.effects)if(T.is(foldEffect)&&!foldExists(B,T.value.from,T.value.to)){let{preparePlaceholder:E}=_.state.facet(foldConfig),W=E?Decoration.replace({widget:new PreparedFoldWidget(E(_.state,T.value))}):foldWidget;B=B.update({add:[W.range(T.value.from,T.value.to)]})}else T.is(unfoldEffect)&&(B=B.update({filter:(E,W)=>T.value.from!=E||T.value.to!=W,filterFrom:T.value.from,filterTo:T.value.to}));if(_.selection){let T=!1,{head:E}=_.selection.main;B.between(E,E,(W,X)=>{W<E&&X>E&&(T=!0)}),T&&(B=B.update({filterFrom:E,filterTo:E,filter:(W,X)=>X<=E||W>=E}))}return B},provide:B=>EditorView.decorations.from(B),toJSON(B,_){let T=[];return B.between(0,_.doc.length,(E,W)=>{T.push(E,W)}),T},fromJSON(B){if(!Array.isArray(B)||B.length%2)throw new RangeError("Invalid JSON for fold state");let _=[];for(let T=0;T<B.length;){let E=B[T++],W=B[T++];if(typeof E!="number"||typeof W!="number")throw new RangeError("Invalid JSON for fold state");_.push(foldWidget.range(E,W))}return Decoration.set(_,!0)}});function findFold(B,_,T){var E;let W=null;return(E=B.field(foldState,!1))===null||E===void 0||E.between(_,T,(X,q)=>{(!W||W.from>X)&&(W={from:X,to:q})}),W}function foldExists(B,_,T){let E=!1;return B.between(_,_,(W,X)=>{W==_&&X==T&&(E=!0)}),E}function maybeEnable(B,_){return B.field(foldState,!1)?_:_.concat(StateEffect.appendConfig.of(codeFolding()))}const foldCode=B=>{for(let _ of selectedLines(B)){let T=foldable(B.state,_.from,_.to);if(T)return B.dispatch({effects:maybeEnable(B.state,[foldEffect.of(T),announceFold(B,T)])}),!0}return!1},unfoldCode=B=>{if(!B.state.field(foldState,!1))return!1;let _=[];for(let T of selectedLines(B)){let E=findFold(B.state,T.from,T.to);E&&_.push(unfoldEffect.of(E),announceFold(B,E,!1))}return _.length&&B.dispatch({effects:_}),_.length>0};function announceFold(B,_,T=!0){let E=B.state.doc.lineAt(_.from).number,W=B.state.doc.lineAt(_.to).number;return EditorView.announce.of(`${B.state.phrase(T?"Folded lines":"Unfolded lines")} ${E} ${B.state.phrase("to")} ${W}.`)}const foldAll=B=>{let{state:_}=B,T=[];for(let E=0;E<_.doc.length;){let W=B.lineBlockAt(E),X=foldable(_,W.from,W.to);X&&T.push(foldEffect.of(X)),E=(X?B.lineBlockAt(X.to):W).to+1}return T.length&&B.dispatch({effects:maybeEnable(B.state,T)}),!!T.length},unfoldAll=B=>{let _=B.state.field(foldState,!1);if(!_||!_.size)return!1;let T=[];return _.between(0,B.state.doc.length,(E,W)=>{T.push(unfoldEffect.of({from:E,to:W}))}),B.dispatch({effects:T}),!0},foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Ctrl-Alt-[",run:foldAll},{key:"Ctrl-Alt-]",run:unfoldAll}],defaultConfig={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},foldConfig=Facet.define({combine(B){return combineConfig(B,defaultConfig)}});function codeFolding(B){return[foldState,baseTheme$1$2]}function widgetToDOM(B,_){let{state:T}=B,E=T.facet(foldConfig),W=q=>{let Y=B.lineBlockAt(B.posAtDOM(q.target)),te=findFold(B.state,Y.from,Y.to);te&&B.dispatch({effects:unfoldEffect.of(te)}),q.preventDefault()};if(E.placeholderDOM)return E.placeholderDOM(B,W,_);let X=document.createElement("span");return X.textContent=E.placeholderText,X.setAttribute("aria-label",T.phrase("folded code")),X.title=T.phrase("unfold"),X.className="cm-foldPlaceholder",X.onclick=W,X}const foldWidget=Decoration.replace({widget:new class extends WidgetType{toDOM(B){return widgetToDOM(B,null)}}});class PreparedFoldWidget extends WidgetType{constructor(_){super(),this.value=_}eq(_){return this.value==_.value}toDOM(_){return widgetToDOM(_,this.value)}}const foldGutterDefaults={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class FoldMarker extends GutterMarker{constructor(_,T){super(),this.config=_,this.open=T}eq(_){return this.config==_.config&&this.open==_.open}toDOM(_){if(this.config.markerDOM)return this.config.markerDOM(this.open);let T=document.createElement("span");return T.textContent=this.open?this.config.openText:this.config.closedText,T.title=_.state.phrase(this.open?"Fold line":"Unfold line"),T}}function foldGutter(B={}){let _=Object.assign(Object.assign({},foldGutterDefaults),B),T=new FoldMarker(_,!0),E=new FoldMarker(_,!1),W=ViewPlugin.fromClass(class{constructor(q){this.from=q.viewport.from,this.markers=this.buildMarkers(q)}update(q){(q.docChanged||q.viewportChanged||q.startState.facet(language)!=q.state.facet(language)||q.startState.field(foldState,!1)!=q.state.field(foldState,!1)||syntaxTree(q.startState)!=syntaxTree(q.state)||_.foldingChanged(q))&&(this.markers=this.buildMarkers(q.view))}buildMarkers(q){let Y=new RangeSetBuilder;for(let te of q.viewportLineBlocks){let ne=findFold(q.state,te.from,te.to)?E:foldable(q.state,te.from,te.to)?T:null;ne&&Y.add(te.from,te.from,ne)}return Y.finish()}}),{domEventHandlers:X}=_;return[W,gutter({class:"cm-foldGutter",markers(q){var Y;return((Y=q.plugin(W))===null||Y===void 0?void 0:Y.markers)||RangeSet.empty},initialSpacer(){return new FoldMarker(_,!1)},domEventHandlers:Object.assign(Object.assign({},X),{click:(q,Y,te)=>{if(X.click&&X.click(q,Y,te))return!0;let ne=findFold(q.state,Y.from,Y.to);if(ne)return q.dispatch({effects:unfoldEffect.of(ne)}),!0;let ae=foldable(q.state,Y.from,Y.to);return ae?(q.dispatch({effects:foldEffect.of(ae)}),!0):!1}})}),codeFolding()]}const baseTheme$1$2=EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class HighlightStyle{constructor(_,T){this.specs=_;let E;function W(Y){let te=StyleModule.newName();return(E||(E=Object.create(null)))["."+te]=Y,te}const X=typeof T.all=="string"?T.all:T.all?W(T.all):void 0,q=T.scope;this.scope=q instanceof Language?Y=>Y.prop(languageDataProp)==q.data:q?Y=>Y==q:void 0,this.style=tagHighlighter(_.map(Y=>({tag:Y.tag,class:Y.class||W(Object.assign({},Y,{tag:null}))})),{all:X}).style,this.module=E?new StyleModule(E):null,this.themeType=T.themeType}static define(_,T){return new HighlightStyle(_,T||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine(B){return B.length?[B[0]]:null}});function getHighlighters(B){let _=B.facet(highlighterFacet);return _.length?_:B.facet(fallbackHighlighter)}function syntaxHighlighting(B,_){let T=[treeHighlighter],E;return B instanceof HighlightStyle&&(B.module&&T.push(EditorView.styleModule.of(B.module)),E=B.themeType),_!=null&&_.fallback?T.push(fallbackHighlighter.of(B)):E?T.push(highlighterFacet.computeN([EditorView.darkTheme],W=>W.facet(EditorView.darkTheme)==(E=="dark")?[B]:[])):T.push(highlighterFacet.of(B)),T}class TreeHighlighter{constructor(_){this.markCache=Object.create(null),this.tree=syntaxTree(_.state),this.decorations=this.buildDeco(_,getHighlighters(_.state)),this.decoratedTo=_.viewport.to}update(_){let T=syntaxTree(_.state),E=getHighlighters(_.state),W=E!=getHighlighters(_.startState),{viewport:X}=_.view,q=_.changes.mapPos(this.decoratedTo,1);T.length<X.to&&!W&&T.type==this.tree.type&&q>=X.to?(this.decorations=this.decorations.map(_.changes),this.decoratedTo=q):(T!=this.tree||_.viewportChanged||W)&&(this.tree=T,this.decorations=this.buildDeco(_.view,E),this.decoratedTo=X.to)}buildDeco(_,T){if(!T||!this.tree.length)return Decoration.none;let E=new RangeSetBuilder;for(let{from:W,to:X}of _.visibleRanges)highlightTree(this.tree,T,(q,Y,te)=>{E.add(q,Y,this.markCache[te]||(this.markCache[te]=Decoration.mark({class:te})))},W,X);return E.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:B=>B.decorations})),defaultHighlightStyle=HighlightStyle.define([{tag:tags.meta,color:"#404740"},{tag:tags.link,textDecoration:"underline"},{tag:tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strong,fontWeight:"bold"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.keyword,color:"#708"},{tag:[tags.atom,tags.bool,tags.url,tags.contentSeparator,tags.labelName],color:"#219"},{tag:[tags.literal,tags.inserted],color:"#164"},{tag:[tags.string,tags.deleted],color:"#a11"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],color:"#e40"},{tag:tags.definition(tags.variableName),color:"#00f"},{tag:tags.local(tags.variableName),color:"#30a"},{tag:[tags.typeName,tags.namespace],color:"#085"},{tag:tags.className,color:"#167"},{tag:[tags.special(tags.variableName),tags.macroName],color:"#256"},{tag:tags.definition(tags.propertyName),color:"#00c"},{tag:tags.comment,color:"#940"},{tag:tags.invalid,color:"#f00"}]),baseTheme$3=EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingConfig=Facet.define({combine(B){return combineConfig(B,{afterCursor:!0,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch})}}),matchingMark=Decoration.mark({class:"cm-matchingBracket"}),nonmatchingMark=Decoration.mark({class:"cm-nonmatchingBracket"});function defaultRenderMatch(B){let _=[],T=B.matched?matchingMark:nonmatchingMark;return _.push(T.range(B.start.from,B.start.to)),B.end&&_.push(T.range(B.end.from,B.end.to)),_}const bracketMatchingState=StateField.define({create(){return Decoration.none},update(B,_){if(!_.docChanged&&!_.selection)return B;let T=[],E=_.state.facet(bracketMatchingConfig);for(let W of _.state.selection.ranges){if(!W.empty)continue;let X=matchBrackets(_.state,W.head,-1,E)||W.head>0&&matchBrackets(_.state,W.head-1,1,E)||E.afterCursor&&(matchBrackets(_.state,W.head,1,E)||W.head<_.state.doc.length&&matchBrackets(_.state,W.head+1,-1,E));X&&(T=T.concat(E.renderMatch(X,_.state)))}return Decoration.set(T,!0)},provide:B=>EditorView.decorations.from(B)}),bracketMatchingUnique=[bracketMatchingState,baseTheme$3];function bracketMatching(B={}){return[bracketMatchingConfig.of(B),bracketMatchingUnique]}const bracketMatchingHandle=new NodeProp;function matchingNodes(B,_,T){let E=B.prop(_<0?NodeProp.openedBy:NodeProp.closedBy);if(E)return E;if(B.name.length==1){let W=T.indexOf(B.name);if(W>-1&&W%2==(_<0?1:0))return[T[W+_]]}return null}function findHandle(B){let _=B.type.prop(bracketMatchingHandle);return _?_(B.node):B}function matchBrackets(B,_,T,E={}){let W=E.maxScanDistance||DefaultScanDist,X=E.brackets||DefaultBrackets,q=syntaxTree(B),Y=q.resolveInner(_,T);for(let te=Y;te;te=te.parent){let ne=matchingNodes(te.type,T,X);if(ne&&te.from<te.to){let ae=findHandle(te);if(ae&&(T>0?_>=ae.from&&_<ae.to:_>ae.from&&_<=ae.to))return matchMarkedBrackets(B,_,T,te,ae,ne,X)}}return matchPlainBrackets(B,_,T,q,Y.type,W,X)}function matchMarkedBrackets(B,_,T,E,W,X,q){let Y=E.parent,te={from:W.from,to:W.to},ne=0,ae=Y==null?void 0:Y.cursor();if(ae&&(T<0?ae.childBefore(E.from):ae.childAfter(E.to)))do if(T<0?ae.to<=E.from:ae.from>=E.to){if(ne==0&&X.indexOf(ae.type.name)>-1&&ae.from<ae.to){let le=findHandle(ae);return{start:te,end:le?{from:le.from,to:le.to}:void 0,matched:!0}}else if(matchingNodes(ae.type,T,q))ne++;else if(matchingNodes(ae.type,-T,q)){if(ne==0){let le=findHandle(ae);return{start:te,end:le&&le.from<le.to?{from:le.from,to:le.to}:void 0,matched:!1}}ne--}}while(T<0?ae.prevSibling():ae.nextSibling());return{start:te,matched:!1}}function matchPlainBrackets(B,_,T,E,W,X,q){let Y=T<0?B.sliceDoc(_-1,_):B.sliceDoc(_,_+1),te=q.indexOf(Y);if(te<0||te%2==0!=T>0)return null;let ne={from:T<0?_-1:_,to:T>0?_+1:_},ae=B.doc.iterRange(_,T>0?B.doc.length:0),le=0;for(let ue=0;!ae.next().done&&ue<=X;){let ge=ae.value;T<0&&(ue+=ge.length);let ye=_+ue*T;for(let xe=T>0?0:ge.length-1,Te=T>0?ge.length:-1;xe!=Te;xe+=T){let Ae=q.indexOf(ge[xe]);if(!(Ae<0||E.resolveInner(ye+xe,1).type!=W))if(Ae%2==0==T>0)le++;else{if(le==1)return{start:ne,end:{from:ye+xe,to:ye+xe+1},matched:Ae>>1==te>>1};le--}}T>0&&(ue+=ge.length)}return ae.done?{start:ne,matched:!1}:null}const noTokens=Object.create(null),typeArray=[NodeType.none],warned=[],byTag=Object.create(null),defaultTable=Object.create(null);for(let[B,_]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[B]=createTokenType(noTokens,_);function warnForPart(B,_){warned.indexOf(B)>-1||(warned.push(B),console.warn(_))}function createTokenType(B,_){let T=[];for(let Y of _.split(" ")){let te=[];for(let ne of Y.split(".")){let ae=B[ne]||tags[ne];ae?typeof ae=="function"?te.length?te=te.map(ae):warnForPart(ne,`Modifier ${ne} used at start of tag`):te.length?warnForPart(ne,`Tag ${ne} used as modifier`):te=Array.isArray(ae)?ae:[ae]:warnForPart(ne,`Unknown highlighting tag ${ne}`)}for(let ne of te)T.push(ne)}if(!T.length)return 0;let E=_.replace(/ /g,"_"),W=E+" "+T.map(Y=>Y.id),X=byTag[W];if(X)return X.id;let q=byTag[W]=NodeType.define({id:typeArray.length,name:E,props:[styleTags({[E]:T})]});return typeArray.push(q),q.id}Direction.RTL,Direction.LTR;const toggleComment=B=>{let{state:_}=B,T=_.doc.lineAt(_.selection.main.from),E=getConfig(B.state,T.from);return E.line?toggleLineComment(B):E.block?toggleBlockCommentByLine(B):!1};function command(B,_){return({state:T,dispatch:E})=>{if(T.readOnly)return!1;let W=B(_,T);return W?(E(T.update(W)),!0):!1}}const toggleLineComment=command(changeLineComment,0),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command((B,_)=>changeBlockComment(B,_,selectedLineRanges(_)),0);function getConfig(B,_){let T=B.languageDataAt("commentTokens",_);return T.length?T[0]:{}}const SearchMargin=50;function findBlockComment(B,{open:_,close:T},E,W){let X=B.sliceDoc(E-SearchMargin,E),q=B.sliceDoc(W,W+SearchMargin),Y=/\s*$/.exec(X)[0].length,te=/^\s*/.exec(q)[0].length,ne=X.length-Y;if(X.slice(ne-_.length,ne)==_&&q.slice(te,te+T.length)==T)return{open:{pos:E-Y,margin:Y&&1},close:{pos:W+te,margin:te&&1}};let ae,le;W-E<=2*SearchMargin?ae=le=B.sliceDoc(E,W):(ae=B.sliceDoc(E,E+SearchMargin),le=B.sliceDoc(W-SearchMargin,W));let ue=/^\s*/.exec(ae)[0].length,ge=/\s*$/.exec(le)[0].length,ye=le.length-ge-T.length;return ae.slice(ue,ue+_.length)==_&&le.slice(ye,ye+T.length)==T?{open:{pos:E+ue+_.length,margin:/\s/.test(ae.charAt(ue+_.length))?1:0},close:{pos:W-ge-T.length,margin:/\s/.test(le.charAt(ye-1))?1:0}}:null}function selectedLineRanges(B){let _=[];for(let T of B.selection.ranges){let E=B.doc.lineAt(T.from),W=T.to<=E.to?E:B.doc.lineAt(T.to),X=_.length-1;X>=0&&_[X].to>E.from?_[X].to=W.to:_.push({from:E.from+/^\s*/.exec(E.text)[0].length,to:W.to})}return _}function changeBlockComment(B,_,T=_.selection.ranges){let E=T.map(X=>getConfig(_,X.from).block);if(!E.every(X=>X))return null;let W=T.map((X,q)=>findBlockComment(_,E[q],X.from,X.to));if(B!=2&&!W.every(X=>X))return{changes:_.changes(T.map((X,q)=>W[q]?[]:[{from:X.from,insert:E[q].open+" "},{from:X.to,insert:" "+E[q].close}]))};if(B!=1&&W.some(X=>X)){let X=[];for(let q=0,Y;q<W.length;q++)if(Y=W[q]){let te=E[q],{open:ne,close:ae}=Y;X.push({from:ne.pos-te.open.length,to:ne.pos+ne.margin},{from:ae.pos-ae.margin,to:ae.pos+te.close.length})}return{changes:X}}return null}function changeLineComment(B,_,T=_.selection.ranges){let E=[],W=-1;for(let{from:X,to:q}of T){let Y=E.length,te=1e9,ne=getConfig(_,X).line;if(ne){for(let ae=X;ae<=q;){let le=_.doc.lineAt(ae);if(le.from>W&&(X==q||q>le.from)){W=le.from;let ue=/^\s*/.exec(le.text)[0].length,ge=ue==le.length,ye=le.text.slice(ue,ue+ne.length)==ne?ue:-1;ue<le.text.length&&ue<te&&(te=ue),E.push({line:le,comment:ye,token:ne,indent:ue,empty:ge,single:!1})}ae=le.to+1}if(te<1e9)for(let ae=Y;ae<E.length;ae++)E[ae].indent<E[ae].line.text.length&&(E[ae].indent=te);E.length==Y+1&&(E[Y].single=!0)}}if(B!=2&&E.some(X=>X.comment<0&&(!X.empty||X.single))){let X=[];for(let{line:Y,token:te,indent:ne,empty:ae,single:le}of E)(le||!ae)&&X.push({from:Y.from+ne,insert:te+" "});let q=_.changes(X);return{changes:q,selection:_.selection.map(q,1)}}else if(B!=1&&E.some(X=>X.comment>=0)){let X=[];for(let{line:q,comment:Y,token:te}of E)if(Y>=0){let ne=q.from+Y,ae=ne+te.length;q.text[ae-q.from]==" "&&ae++,X.push({from:ne,to:ae})}return{changes:X}}return null}const fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine(B){return combineConfig(B,{minDepth:100,newGroupDelay:500,joinToEvent:(_,T)=>T},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(_,T)=>(E,W)=>_(E,W)||T(E,W)})}}),historyField_=StateField.define({create(){return HistoryState.empty},update(B,_){let T=_.state.facet(historyConfig),E=_.annotation(fromHistory);if(E){let te=HistEvent.fromTransaction(_,E.selection),ne=E.side,ae=ne==0?B.undone:B.done;return te?ae=updateBranch(ae,ae.length,T.minDepth,te):ae=addSelection(ae,_.startState.selection),new HistoryState(ne==0?E.rest:ae,ne==0?ae:E.rest)}let W=_.annotation(isolateHistory);if((W=="full"||W=="before")&&(B=B.isolate()),_.annotation(Transaction.addToHistory)===!1)return _.changes.empty?B:B.addMapping(_.changes.desc);let X=HistEvent.fromTransaction(_),q=_.annotation(Transaction.time),Y=_.annotation(Transaction.userEvent);return X?B=B.addChanges(X,q,Y,T,_):_.selection&&(B=B.addSelection(_.startState.selection,q,Y,T.newGroupDelay)),(W=="full"||W=="after")&&(B=B.isolate()),B},toJSON(B){return{done:B.done.map(_=>_.toJSON()),undone:B.undone.map(_=>_.toJSON())}},fromJSON(B){return new HistoryState(B.done.map(HistEvent.fromJSON),B.undone.map(HistEvent.fromJSON))}});function history(B={}){return[historyField_,historyConfig.of(B),EditorView.domEventHandlers({beforeinput(_,T){let E=_.inputType=="historyUndo"?undo:_.inputType=="historyRedo"?redo:null;return E?(_.preventDefault(),E(T)):!1}})]}function cmd(B,_){return function({state:T,dispatch:E}){if(!_&&T.readOnly)return!1;let W=T.field(historyField_,!1);if(!W)return!1;let X=W.pop(B,T,_);return X?(E(X),!0):!1}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(_,T,E,W,X){this.changes=_,this.effects=T,this.mapped=E,this.startSelection=W,this.selectionsAfter=X}setSelAfter(_){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,_)}toJSON(){var _,T,E;return{changes:(_=this.changes)===null||_===void 0?void 0:_.toJSON(),mapped:(T=this.mapped)===null||T===void 0?void 0:T.toJSON(),startSelection:(E=this.startSelection)===null||E===void 0?void 0:E.toJSON(),selectionsAfter:this.selectionsAfter.map(W=>W.toJSON())}}static fromJSON(_){return new HistEvent(_.changes&&ChangeSet.fromJSON(_.changes),[],_.mapped&&ChangeDesc.fromJSON(_.mapped),_.startSelection&&EditorSelection.fromJSON(_.startSelection),_.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(_,T){let E=none$1;for(let W of _.startState.facet(invertedEffects)){let X=W(_);X.length&&(E=E.concat(X))}return!E.length&&_.changes.empty?null:new HistEvent(_.changes.invert(_.startState.doc),E,void 0,T||_.startState.selection,none$1)}static selection(_){return new HistEvent(void 0,none$1,void 0,void 0,_)}}function updateBranch(B,_,T,E){let W=_+1>T+20?_-T-1:0,X=B.slice(W,_);return X.push(E),X}function isAdjacent(B,_){let T=[],E=!1;return B.iterChangedRanges((W,X)=>T.push(W,X)),_.iterChangedRanges((W,X,q,Y)=>{for(let te=0;te<T.length;){let ne=T[te++],ae=T[te++];Y>=ne&&q<=ae&&(E=!0)}}),E}function eqSelectionShape(B,_){return B.ranges.length==_.ranges.length&&B.ranges.filter((T,E)=>T.empty!=_.ranges[E].empty).length===0}function conc(B,_){return B.length?_.length?B.concat(_):B:_}const none$1=[],MaxSelectionsPerEvent=200;function addSelection(B,_){if(B.length){let T=B[B.length-1],E=T.selectionsAfter.slice(Math.max(0,T.selectionsAfter.length-MaxSelectionsPerEvent));return E.length&&E[E.length-1].eq(_)?B:(E.push(_),updateBranch(B,B.length-1,1e9,T.setSelAfter(E)))}else return[HistEvent.selection([_])]}function popSelection(B){let _=B[B.length-1],T=B.slice();return T[B.length-1]=_.setSelAfter(_.selectionsAfter.slice(0,_.selectionsAfter.length-1)),T}function addMappingToBranch(B,_){if(!B.length)return B;let T=B.length,E=none$1;for(;T;){let W=mapEvent(B[T-1],_,E);if(W.changes&&!W.changes.empty||W.effects.length){let X=B.slice(0,T);return X[T-1]=W,X}else _=W.mapped,T--,E=W.selectionsAfter}return E.length?[HistEvent.selection(E)]:none$1}function mapEvent(B,_,T){let E=conc(B.selectionsAfter.length?B.selectionsAfter.map(Y=>Y.map(_)):none$1,T);if(!B.changes)return HistEvent.selection(E);let W=B.changes.map(_),X=_.mapDesc(B.changes,!0),q=B.mapped?B.mapped.composeDesc(X):X;return new HistEvent(W,StateEffect.mapEffects(B.effects,_),q,B.startSelection.map(X),E)}const joinableUserEvent=/^(input\.type|delete)($|\.)/;class HistoryState{constructor(_,T,E=0,W=void 0){this.done=_,this.undone=T,this.prevTime=E,this.prevUserEvent=W}isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this}addChanges(_,T,E,W,X){let q=this.done,Y=q[q.length-1];return Y&&Y.changes&&!Y.changes.empty&&_.changes&&(!E||joinableUserEvent.test(E))&&(!Y.selectionsAfter.length&&T-this.prevTime<W.newGroupDelay&&W.joinToEvent(X,isAdjacent(Y.changes,_.changes))||E=="input.type.compose")?q=updateBranch(q,q.length-1,W.minDepth,new HistEvent(_.changes.compose(Y.changes),conc(StateEffect.mapEffects(_.effects,Y.changes),Y.effects),Y.mapped,Y.startSelection,none$1)):q=updateBranch(q,q.length,W.minDepth,_),new HistoryState(q,none$1,T,E)}addSelection(_,T,E,W){let X=this.done.length?this.done[this.done.length-1].selectionsAfter:none$1;return X.length>0&&T-this.prevTime<W&&E==this.prevUserEvent&&E&&/^select($|\.)/.test(E)&&eqSelectionShape(X[X.length-1],_)?this:new HistoryState(addSelection(this.done,_),this.undone,T,E)}addMapping(_){return new HistoryState(addMappingToBranch(this.done,_),addMappingToBranch(this.undone,_),this.prevTime,this.prevUserEvent)}pop(_,T,E){let W=_==0?this.done:this.undone;if(W.length==0)return null;let X=W[W.length-1],q=X.selectionsAfter[0]||T.selection;if(E&&X.selectionsAfter.length)return T.update({selection:X.selectionsAfter[X.selectionsAfter.length-1],annotations:fromHistory.of({side:_,rest:popSelection(W),selection:q}),userEvent:_==0?"select.undo":"select.redo",scrollIntoView:!0});if(X.changes){let Y=W.length==1?none$1:W.slice(0,W.length-1);return X.mapped&&(Y=addMappingToBranch(Y,X.mapped)),T.update({changes:X.changes,selection:X.startSelection,effects:X.effects,annotations:fromHistory.of({side:_,rest:Y,selection:q}),filter:!1,userEvent:_==0?"undo":"redo",scrollIntoView:!0})}else return null}}HistoryState.empty=new HistoryState(none$1,none$1);const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];function updateSel(B,_){return EditorSelection.create(B.ranges.map(_),B.mainIndex)}function setSel(B,_){return B.update({selection:_,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:B,dispatch:_},T){let E=updateSel(B.selection,T);return E.eq(B.selection,!0)?!1:(_(setSel(B,E)),!0)}function rangeEnd(B,_){return EditorSelection.cursor(_?B.to:B.from)}function cursorByChar(B,_){return moveSel(B,T=>T.empty?B.moveByChar(T,_):rangeEnd(T,_))}function ltrAtCursor(B){return B.textDirectionAt(B.state.selection.main.head)==Direction.LTR}const cursorCharLeft=B=>cursorByChar(B,!ltrAtCursor(B)),cursorCharRight=B=>cursorByChar(B,ltrAtCursor(B));function cursorByGroup(B,_){return moveSel(B,T=>T.empty?B.moveByGroup(T,_):rangeEnd(T,_))}const cursorGroupLeft=B=>cursorByGroup(B,!ltrAtCursor(B)),cursorGroupRight=B=>cursorByGroup(B,ltrAtCursor(B));function interestingNode(B,_,T){if(_.type.prop(T))return!0;let E=_.to-_.from;return E&&(E>2||/[^\s,.;:]/.test(B.sliceDoc(_.from,_.to)))||_.firstChild}function moveBySyntax(B,_,T){let E=syntaxTree(B).resolveInner(_.head),W=T?NodeProp.closedBy:NodeProp.openedBy;for(let te=_.head;;){let ne=T?E.childAfter(te):E.childBefore(te);if(!ne)break;interestingNode(B,ne,W)?E=ne:te=T?ne.to:ne.from}let X=E.type.prop(W),q,Y;return X&&(q=T?matchBrackets(B,E.from,1):matchBrackets(B,E.to,-1))&&q.matched?Y=T?q.end.to:q.end.from:Y=T?E.to:E.from,EditorSelection.cursor(Y,T?-1:1)}const cursorSyntaxLeft=B=>moveSel(B,_=>moveBySyntax(B.state,_,!ltrAtCursor(B))),cursorSyntaxRight=B=>moveSel(B,_=>moveBySyntax(B.state,_,ltrAtCursor(B)));function cursorByLine(B,_){return moveSel(B,T=>{if(!T.empty)return rangeEnd(T,_);let E=B.moveVertically(T,_);return E.head!=T.head?E:B.moveToLineBoundary(T,_)})}const cursorLineUp=B=>cursorByLine(B,!1),cursorLineDown=B=>cursorByLine(B,!0);function pageInfo(B){let _=B.scrollDOM.clientHeight<B.scrollDOM.scrollHeight-2,T=0,E=0,W;if(_){for(let X of B.state.facet(EditorView.scrollMargins)){let q=X(B);q!=null&&q.top&&(T=Math.max(q==null?void 0:q.top,T)),q!=null&&q.bottom&&(E=Math.max(q==null?void 0:q.bottom,E))}W=B.scrollDOM.clientHeight-T-E}else W=(B.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:T,marginBottom:E,selfScroll:_,height:Math.max(B.defaultLineHeight,W-5)}}function cursorByPage(B,_){let T=pageInfo(B),{state:E}=B,W=updateSel(E.selection,q=>q.empty?B.moveVertically(q,_,T.height):rangeEnd(q,_));if(W.eq(E.selection))return!1;let X;if(T.selfScroll){let q=B.coordsAtPos(E.selection.main.head),Y=B.scrollDOM.getBoundingClientRect(),te=Y.top+T.marginTop,ne=Y.bottom-T.marginBottom;q&&q.top>te&&q.bottom<ne&&(X=EditorView.scrollIntoView(W.main.head,{y:"start",yMargin:q.top-te}))}return B.dispatch(setSel(E,W),{effects:X}),!0}const cursorPageUp=B=>cursorByPage(B,!1),cursorPageDown=B=>cursorByPage(B,!0);function moveByLineBoundary(B,_,T){let E=B.lineBlockAt(_.head),W=B.moveToLineBoundary(_,T);if(W.head==_.head&&W.head!=(T?E.to:E.from)&&(W=B.moveToLineBoundary(_,T,!1)),!T&&W.head==E.from&&E.length){let X=/^\s*/.exec(B.state.sliceDoc(E.from,Math.min(E.from+100,E.to)))[0].length;X&&_.head!=E.from+X&&(W=EditorSelection.cursor(E.from+X))}return W}const cursorLineBoundaryForward=B=>moveSel(B,_=>moveByLineBoundary(B,_,!0)),cursorLineBoundaryBackward=B=>moveSel(B,_=>moveByLineBoundary(B,_,!1)),cursorLineBoundaryLeft=B=>moveSel(B,_=>moveByLineBoundary(B,_,!ltrAtCursor(B))),cursorLineBoundaryRight=B=>moveSel(B,_=>moveByLineBoundary(B,_,ltrAtCursor(B))),cursorLineStart=B=>moveSel(B,_=>EditorSelection.cursor(B.lineBlockAt(_.head).from,1)),cursorLineEnd=B=>moveSel(B,_=>EditorSelection.cursor(B.lineBlockAt(_.head).to,-1));function toMatchingBracket(B,_,T){let E=!1,W=updateSel(B.selection,X=>{let q=matchBrackets(B,X.head,-1)||matchBrackets(B,X.head,1)||X.head>0&&matchBrackets(B,X.head-1,1)||X.head<B.doc.length&&matchBrackets(B,X.head+1,-1);if(!q||!q.end)return X;E=!0;let Y=q.start.from==X.head?q.end.to:q.end.from;return EditorSelection.cursor(Y)});return E?(_(setSel(B,W)),!0):!1}const cursorMatchingBracket=({state:B,dispatch:_})=>toMatchingBracket(B,_);function extendSel(B,_){let T=updateSel(B.state.selection,E=>{let W=_(E);return EditorSelection.range(E.anchor,W.head,W.goalColumn,W.bidiLevel||void 0)});return T.eq(B.state.selection)?!1:(B.dispatch(setSel(B.state,T)),!0)}function selectByChar(B,_){return extendSel(B,T=>B.moveByChar(T,_))}const selectCharLeft=B=>selectByChar(B,!ltrAtCursor(B)),selectCharRight=B=>selectByChar(B,ltrAtCursor(B));function selectByGroup(B,_){return extendSel(B,T=>B.moveByGroup(T,_))}const selectGroupLeft=B=>selectByGroup(B,!ltrAtCursor(B)),selectGroupRight=B=>selectByGroup(B,ltrAtCursor(B)),selectSyntaxLeft=B=>extendSel(B,_=>moveBySyntax(B.state,_,!ltrAtCursor(B))),selectSyntaxRight=B=>extendSel(B,_=>moveBySyntax(B.state,_,ltrAtCursor(B)));function selectByLine(B,_){return extendSel(B,T=>B.moveVertically(T,_))}const selectLineUp=B=>selectByLine(B,!1),selectLineDown=B=>selectByLine(B,!0);function selectByPage(B,_){return extendSel(B,T=>B.moveVertically(T,_,pageInfo(B).height))}const selectPageUp=B=>selectByPage(B,!1),selectPageDown=B=>selectByPage(B,!0),selectLineBoundaryForward=B=>extendSel(B,_=>moveByLineBoundary(B,_,!0)),selectLineBoundaryBackward=B=>extendSel(B,_=>moveByLineBoundary(B,_,!1)),selectLineBoundaryLeft=B=>extendSel(B,_=>moveByLineBoundary(B,_,!ltrAtCursor(B))),selectLineBoundaryRight=B=>extendSel(B,_=>moveByLineBoundary(B,_,ltrAtCursor(B))),selectLineStart=B=>extendSel(B,_=>EditorSelection.cursor(B.lineBlockAt(_.head).from)),selectLineEnd=B=>extendSel(B,_=>EditorSelection.cursor(B.lineBlockAt(_.head).to)),cursorDocStart=({state:B,dispatch:_})=>(_(setSel(B,{anchor:0})),!0),cursorDocEnd=({state:B,dispatch:_})=>(_(setSel(B,{anchor:B.doc.length})),!0),selectDocStart=({state:B,dispatch:_})=>(_(setSel(B,{anchor:B.selection.main.anchor,head:0})),!0),selectDocEnd=({state:B,dispatch:_})=>(_(setSel(B,{anchor:B.selection.main.anchor,head:B.doc.length})),!0),selectAll=({state:B,dispatch:_})=>(_(B.update({selection:{anchor:0,head:B.doc.length},userEvent:"select"})),!0),selectLine=({state:B,dispatch:_})=>{let T=selectedLineBlocks(B).map(({from:E,to:W})=>EditorSelection.range(E,Math.min(W+1,B.doc.length)));return _(B.update({selection:EditorSelection.create(T),userEvent:"select"})),!0},selectParentSyntax=({state:B,dispatch:_})=>{let T=updateSel(B.selection,E=>{var W;let X=syntaxTree(B).resolveStack(E.from,1);for(let q=X;q;q=q.next){let{node:Y}=q;if((Y.from<E.from&&Y.to>=E.to||Y.to>E.to&&Y.from<=E.from)&&(!((W=Y.parent)===null||W===void 0)&&W.parent))return EditorSelection.range(Y.to,Y.from)}return E});return _(setSel(B,T)),!0},simplifySelection=({state:B,dispatch:_})=>{let T=B.selection,E=null;return T.ranges.length>1?E=EditorSelection.create([T.main]):T.main.empty||(E=EditorSelection.create([EditorSelection.cursor(T.main.head)])),E?(_(setSel(B,E)),!0):!1};function deleteBy(B,_){if(B.state.readOnly)return!1;let T="delete.selection",{state:E}=B,W=E.changeByRange(X=>{let{from:q,to:Y}=X;if(q==Y){let te=_(X);te<q?(T="delete.backward",te=skipAtomic(B,te,!1)):te>q&&(T="delete.forward",te=skipAtomic(B,te,!0)),q=Math.min(q,te),Y=Math.max(Y,te)}else q=skipAtomic(B,q,!1),Y=skipAtomic(B,Y,!0);return q==Y?{range:X}:{changes:{from:q,to:Y},range:EditorSelection.cursor(q,q<X.head?-1:1)}});return W.changes.empty?!1:(B.dispatch(E.update(W,{scrollIntoView:!0,userEvent:T,effects:T=="delete.selection"?EditorView.announce.of(E.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(B,_,T){if(B instanceof EditorView)for(let E of B.state.facet(EditorView.atomicRanges).map(W=>W(B)))E.between(_,_,(W,X)=>{W<_&&X>_&&(_=T?X:W)});return _}const deleteByChar=(B,_,T)=>deleteBy(B,E=>{let W=E.from,{state:X}=B,q=X.doc.lineAt(W),Y,te;if(T&&!_&&W>q.from&&W<q.from+200&&!/[^ \t]/.test(Y=q.text.slice(0,W-q.from))){if(Y[Y.length-1]=="	")return W-1;let ne=countColumn(Y,X.tabSize),ae=ne%getIndentUnit(X)||getIndentUnit(X);for(let le=0;le<ae&&Y[Y.length-1-le]==" ";le++)W--;te=W}else te=findClusterBreak(q.text,W-q.from,_,_)+q.from,te==W&&q.number!=(_?X.doc.lines:1)?te+=_?1:-1:!_&&/[\ufe00-\ufe0f]/.test(q.text.slice(te-q.from,W-q.from))&&(te=findClusterBreak(q.text,te-q.from,!1,!1)+q.from);return te}),deleteCharBackward=B=>deleteByChar(B,!1,!0),deleteCharForward=B=>deleteByChar(B,!0,!1),deleteByGroup=(B,_)=>deleteBy(B,T=>{let E=T.head,{state:W}=B,X=W.doc.lineAt(E),q=W.charCategorizer(E);for(let Y=null;;){if(E==(_?X.to:X.from)){E==T.head&&X.number!=(_?W.doc.lines:1)&&(E+=_?1:-1);break}let te=findClusterBreak(X.text,E-X.from,_)+X.from,ne=X.text.slice(Math.min(E,te)-X.from,Math.max(E,te)-X.from),ae=q(ne);if(Y!=null&&ae!=Y)break;(ne!=" "||E!=T.head)&&(Y=ae),E=te}return E}),deleteGroupBackward=B=>deleteByGroup(B,!1),deleteGroupForward=B=>deleteByGroup(B,!0),deleteToLineEnd=B=>deleteBy(B,_=>{let T=B.lineBlockAt(_.head).to;return _.head<T?T:Math.min(B.state.doc.length,_.head+1)}),deleteLineBoundaryBackward=B=>deleteBy(B,_=>{let T=B.moveToLineBoundary(_,!1).head;return _.head>T?T:Math.max(0,_.head-1)}),deleteLineBoundaryForward=B=>deleteBy(B,_=>{let T=B.moveToLineBoundary(_,!0).head;return _.head<T?T:Math.min(B.state.doc.length,_.head+1)}),splitLine=({state:B,dispatch:_})=>{if(B.readOnly)return!1;let T=B.changeByRange(E=>({changes:{from:E.from,to:E.to,insert:Text.of(["",""])},range:EditorSelection.cursor(E.from)}));return _(B.update(T,{scrollIntoView:!0,userEvent:"input"})),!0},transposeChars=({state:B,dispatch:_})=>{if(B.readOnly)return!1;let T=B.changeByRange(E=>{if(!E.empty||E.from==0||E.from==B.doc.length)return{range:E};let W=E.from,X=B.doc.lineAt(W),q=W==X.from?W-1:findClusterBreak(X.text,W-X.from,!1)+X.from,Y=W==X.to?W+1:findClusterBreak(X.text,W-X.from,!0)+X.from;return{changes:{from:q,to:Y,insert:B.doc.slice(W,Y).append(B.doc.slice(q,W))},range:EditorSelection.cursor(Y)}});return T.changes.empty?!1:(_(B.update(T,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function selectedLineBlocks(B){let _=[],T=-1;for(let E of B.selection.ranges){let W=B.doc.lineAt(E.from),X=B.doc.lineAt(E.to);if(!E.empty&&E.to==X.from&&(X=B.doc.lineAt(E.to-1)),T>=W.number){let q=_[_.length-1];q.to=X.to,q.ranges.push(E)}else _.push({from:W.from,to:X.to,ranges:[E]});T=X.number+1}return _}function moveLine(B,_,T){if(B.readOnly)return!1;let E=[],W=[];for(let X of selectedLineBlocks(B)){if(T?X.to==B.doc.length:X.from==0)continue;let q=B.doc.lineAt(T?X.to+1:X.from-1),Y=q.length+1;if(T){E.push({from:X.to,to:q.to},{from:X.from,insert:q.text+B.lineBreak});for(let te of X.ranges)W.push(EditorSelection.range(Math.min(B.doc.length,te.anchor+Y),Math.min(B.doc.length,te.head+Y)))}else{E.push({from:q.from,to:X.from},{from:X.to,insert:B.lineBreak+q.text});for(let te of X.ranges)W.push(EditorSelection.range(te.anchor-Y,te.head-Y))}}return E.length?(_(B.update({changes:E,scrollIntoView:!0,selection:EditorSelection.create(W,B.selection.mainIndex),userEvent:"move.line"})),!0):!1}const moveLineUp=({state:B,dispatch:_})=>moveLine(B,_,!1),moveLineDown=({state:B,dispatch:_})=>moveLine(B,_,!0);function copyLine(B,_,T){if(B.readOnly)return!1;let E=[];for(let W of selectedLineBlocks(B))T?E.push({from:W.from,insert:B.doc.slice(W.from,W.to)+B.lineBreak}):E.push({from:W.to,insert:B.lineBreak+B.doc.slice(W.from,W.to)});return _(B.update({changes:E,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const copyLineUp=({state:B,dispatch:_})=>copyLine(B,_,!1),copyLineDown=({state:B,dispatch:_})=>copyLine(B,_,!0),deleteLine=B=>{if(B.state.readOnly)return!1;let{state:_}=B,T=_.changes(selectedLineBlocks(_).map(({from:W,to:X})=>(W>0?W--:X<_.doc.length&&X++,{from:W,to:X}))),E=updateSel(_.selection,W=>{let X;if(B.lineWrapping){let q=B.lineBlockAt(W.head),Y=B.coordsAtPos(W.head,W.assoc||1);Y&&(X=q.bottom+B.documentTop-Y.bottom+B.defaultLineHeight/2)}return B.moveVertically(W,!0,X)}).map(T);return B.dispatch({changes:T,selection:E,scrollIntoView:!0,userEvent:"delete.line"}),!0};function isBetweenBrackets(B,_){if(/\(\)|\[\]|\{\}/.test(B.sliceDoc(_-1,_+1)))return{from:_,to:_};let T=syntaxTree(B).resolveInner(_),E=T.childBefore(_),W=T.childAfter(_),X;return E&&W&&E.to<=_&&W.from>=_&&(X=E.type.prop(NodeProp.closedBy))&&X.indexOf(W.name)>-1&&B.doc.lineAt(E.to).from==B.doc.lineAt(W.from).from&&!/\S/.test(B.sliceDoc(E.to,W.from))?{from:E.to,to:W.from}:null}const insertNewlineAndIndent=newlineAndIndent(!1),insertBlankLine=newlineAndIndent(!0);function newlineAndIndent(B){return({state:_,dispatch:T})=>{if(_.readOnly)return!1;let E=_.changeByRange(W=>{let{from:X,to:q}=W,Y=_.doc.lineAt(X),te=!B&&X==q&&isBetweenBrackets(_,X);B&&(X=q=(q<=Y.to?Y:_.doc.lineAt(q)).to);let ne=new IndentContext(_,{simulateBreak:X,simulateDoubleBreak:!!te}),ae=getIndentation(ne,X);for(ae==null&&(ae=countColumn(/^\s*/.exec(_.doc.lineAt(X).text)[0],_.tabSize));q<Y.to&&/\s/.test(Y.text[q-Y.from]);)q++;te?{from:X,to:q}=te:X>Y.from&&X<Y.from+100&&!/\S/.test(Y.text.slice(0,X))&&(X=Y.from);let le=["",indentString(_,ae)];return te&&le.push(indentString(_,ne.lineIndent(Y.from,-1))),{changes:{from:X,to:q,insert:Text.of(le)},range:EditorSelection.cursor(X+1+le[1].length)}});return T(_.update(E,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(B,_){let T=-1;return B.changeByRange(E=>{let W=[];for(let q=E.from;q<=E.to;){let Y=B.doc.lineAt(q);Y.number>T&&(E.empty||E.to>Y.from)&&(_(Y,W,E),T=Y.number),q=Y.to+1}let X=B.changes(W);return{changes:W,range:EditorSelection.range(X.mapPos(E.anchor,1),X.mapPos(E.head,1))}})}const indentSelection=({state:B,dispatch:_})=>{if(B.readOnly)return!1;let T=Object.create(null),E=new IndentContext(B,{overrideIndentation:X=>{let q=T[X];return q??-1}}),W=changeBySelectedLine(B,(X,q,Y)=>{let te=getIndentation(E,X.from);if(te==null)return;/\S/.test(X.text)||(te=0);let ne=/^\s*/.exec(X.text)[0],ae=indentString(B,te);(ne!=ae||Y.from<X.from+ne.length)&&(T[X.from]=te,q.push({from:X.from,to:X.from+ne.length,insert:ae}))});return W.changes.empty||_(B.update(W,{userEvent:"indent"})),!0},indentMore=({state:B,dispatch:_})=>B.readOnly?!1:(_(B.update(changeBySelectedLine(B,(T,E)=>{E.push({from:T.from,insert:B.facet(indentUnit)})}),{userEvent:"input.indent"})),!0),indentLess=({state:B,dispatch:_})=>B.readOnly?!1:(_(B.update(changeBySelectedLine(B,(T,E)=>{let W=/^\s*/.exec(T.text)[0];if(!W)return;let X=countColumn(W,B.tabSize),q=0,Y=indentString(B,Math.max(0,X-getIndentUnit(B)));for(;q<W.length&&q<Y.length&&W.charCodeAt(q)==Y.charCodeAt(q);)q++;E.push({from:T.from+q,to:T.from+W.length,insert:Y.slice(q)})}),{userEvent:"delete.dedent"})),!0),toggleTabFocusMode=B=>(B.setTabFocusMode(),!0),emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}],standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteLineBoundaryBackward},{mac:"Mod-Delete",run:deleteLineBoundaryForward}].concat(emacsStyleKeymap.map(B=>({mac:B.key,run:B.run,shift:B.shift}))),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment},{key:"Ctrl-m",mac:"Shift-Alt-m",run:toggleTabFocusMode}].concat(standardKeymap);function crelt(){var B=arguments[0];typeof B=="string"&&(B=document.createElement(B));var _=1,T=arguments[1];if(T&&typeof T=="object"&&T.nodeType==null&&!Array.isArray(T)){for(var E in T)if(Object.prototype.hasOwnProperty.call(T,E)){var W=T[E];typeof W=="string"?B.setAttribute(E,W):W!=null&&(B[E]=W)}_++}for(;_<arguments.length;_++)add$1(B,arguments[_]);return B}function add$1(B,_){if(typeof _=="string")B.appendChild(document.createTextNode(_));else if(_!=null)if(_.nodeType!=null)B.appendChild(_);else if(Array.isArray(_))for(var T=0;T<_.length;T++)add$1(B,_[T]);else throw new RangeError("Unsupported child node: "+_)}const basicNormalize=typeof String.prototype.normalize=="function"?B=>B.normalize("NFKD"):B=>B;class SearchCursor{constructor(_,T,E=0,W=_.length,X,q){this.test=q,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=_.iterRange(E,W),this.bufferStart=E,this.normalize=X?Y=>X(basicNormalize(Y)):basicNormalize,this.query=this.normalize(T)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let _=this.peek();if(_<0)return this.done=!0,this;let T=fromCodePoint(_),E=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(_);let W=this.normalize(T);for(let X=0,q=E;;X++){let Y=W.charCodeAt(X),te=this.match(Y,q,this.bufferPos+this.bufferStart);if(X==W.length-1){if(te)return this.value=te,this;break}q==E&&X<T.length&&T.charCodeAt(X)==Y&&q++}}}match(_,T,E){let W=null;for(let X=0;X<this.matches.length;X+=2){let q=this.matches[X],Y=!1;this.query.charCodeAt(q)==_&&(q==this.query.length-1?W={from:this.matches[X+1],to:E}:(this.matches[X]++,Y=!0)),Y||(this.matches.splice(X,2),X-=2)}return this.query.charCodeAt(0)==_&&(this.query.length==1?W={from:T,to:E}:this.matches.push(1,T)),W&&this.test&&!this.test(W.from,W.to,this.buffer,this.bufferStart)&&(W=null),W}}typeof Symbol<"u"&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(/x/.unicode==null?"":"u");class RegExpCursor{constructor(_,T,E,W=0,X=_.length){if(this.text=_,this.to=X,this.curLine="",this.done=!1,this.value=empty,/\\[sWDnr]|\n|\r|\[\^/.test(T))return new MultilineRegExpCursor(_,T,E,W,X);this.re=new RegExp(T,baseFlags+(E!=null&&E.ignoreCase?"i":"")),this.test=E==null?void 0:E.test,this.iter=_.iter();let q=_.lineAt(W);this.curLineStart=q.from,this.matchPos=toCharEnd(_,W),this.getLine(this.curLineStart)}getLine(_){this.iter.next(_),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let _=this.matchPos-this.curLineStart;;){this.re.lastIndex=_;let T=this.matchPos<=this.to&&this.re.exec(this.curLine);if(T){let E=this.curLineStart+T.index,W=E+T[0].length;if(this.matchPos=toCharEnd(this.text,W+(E==W?1:0)),E==this.curLineStart+this.curLine.length&&this.nextLine(),(E<W||E>this.value.to)&&(!this.test||this.test(E,W,T)))return this.value={from:E,to:W,match:T},this;_=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),_=0;else return this.done=!0,this}}}const flattened=new WeakMap;class FlattenedDoc{constructor(_,T){this.from=_,this.text=T}get to(){return this.from+this.text.length}static get(_,T,E){let W=flattened.get(_);if(!W||W.from>=E||W.to<=T){let Y=new FlattenedDoc(T,_.sliceString(T,E));return flattened.set(_,Y),Y}if(W.from==T&&W.to==E)return W;let{text:X,from:q}=W;return q>T&&(X=_.sliceString(T,q)+X,q=T),W.to<E&&(X+=_.sliceString(W.to,E)),flattened.set(_,new FlattenedDoc(q,X)),new FlattenedDoc(T,X.slice(T-q,E-q))}}class MultilineRegExpCursor{constructor(_,T,E,W,X){this.text=_,this.to=X,this.done=!1,this.value=empty,this.matchPos=toCharEnd(_,W),this.re=new RegExp(T,baseFlags+(E!=null&&E.ignoreCase?"i":"")),this.test=E==null?void 0:E.test,this.flat=FlattenedDoc.get(_,W,this.chunkEnd(W+5e3))}chunkEnd(_){return _>=this.to?this.to:this.text.lineAt(_).to}next(){for(;;){let _=this.re.lastIndex=this.matchPos-this.flat.from,T=this.re.exec(this.flat.text);if(T&&!T[0]&&T.index==_&&(this.re.lastIndex=_+1,T=this.re.exec(this.flat.text)),T){let E=this.flat.from+T.index,W=E+T[0].length;if((this.flat.to>=this.to||T.index+T[0].length<=this.flat.text.length-10)&&(!this.test||this.test(E,W,T)))return this.value={from:E,to:W,match:T},this.matchPos=toCharEnd(this.text,W+(E==W?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});function validRegExp(B){try{return new RegExp(B,baseFlags),!0}catch{return!1}}function toCharEnd(B,_){if(_>=B.length)return _;let T=B.lineAt(_),E;for(;_<T.to&&(E=T.text.charCodeAt(_-T.from))>=56320&&E<57344;)_++;return _}function createLineDialog(B){let _=String(B.state.doc.lineAt(B.state.selection.main.head).number),T=crelt("input",{class:"cm-textfield",name:"line",value:_}),E=crelt("form",{class:"cm-gotoLine",onkeydown:X=>{X.keyCode==27?(X.preventDefault(),B.dispatch({effects:dialogEffect.of(!1)}),B.focus()):X.keyCode==13&&(X.preventDefault(),W())},onsubmit:X=>{X.preventDefault(),W()}},crelt("label",B.state.phrase("Go to line"),": ",T)," ",crelt("button",{class:"cm-button",type:"submit"},B.state.phrase("go")));function W(){let X=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(T.value);if(!X)return;let{state:q}=B,Y=q.doc.lineAt(q.selection.main.head),[,te,ne,ae,le]=X,ue=ae?+ae.slice(1):0,ge=ne?+ne:Y.number;if(ne&&le){let Te=ge/100;te&&(Te=Te*(te=="-"?-1:1)+Y.number/q.doc.lines),ge=Math.round(q.doc.lines*Te)}else ne&&te&&(ge=ge*(te=="-"?-1:1)+Y.number);let ye=q.doc.line(Math.max(1,Math.min(q.doc.lines,ge))),xe=EditorSelection.cursor(ye.from+Math.max(0,Math.min(ue,ye.length)));B.dispatch({effects:[dialogEffect.of(!1),EditorView.scrollIntoView(xe.from,{y:"center"})],selection:xe}),B.focus()}return{dom:E}}const dialogEffect=StateEffect.define(),dialogField=StateField.define({create(){return!0},update(B,_){for(let T of _.effects)T.is(dialogEffect)&&(B=T.value);return B},provide:B=>showPanel.from(B,_=>_?createLineDialog:null)}),gotoLine=B=>{let _=getPanel(B,createLineDialog);if(!_){let T=[dialogEffect.of(!0)];B.state.field(dialogField,!1)==null&&T.push(StateEffect.appendConfig.of([dialogField,baseTheme$1$1])),B.dispatch({effects:T}),_=getPanel(B,createLineDialog)}return _&&_.dom.querySelector("input").select(),!0},baseTheme$1$1=EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),defaultHighlightOptions={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},highlightConfig=Facet.define({combine(B){return combineConfig(B,defaultHighlightOptions,{highlightWordAroundCursor:(_,T)=>_||T,minSelectionLength:Math.min,maxMatches:Math.min})}});function highlightSelectionMatches(B){return[defaultTheme,matchHighlighter]}const matchDeco=Decoration.mark({class:"cm-selectionMatch"}),mainMatchDeco=Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(B,_,T,E){return(T==0||B(_.sliceDoc(T-1,T))!=CharCategory.Word)&&(E==_.doc.length||B(_.sliceDoc(E,E+1))!=CharCategory.Word)}function insideWord(B,_,T,E){return B(_.sliceDoc(T,T+1))==CharCategory.Word&&B(_.sliceDoc(E-1,E))==CharCategory.Word}const matchHighlighter=ViewPlugin.fromClass(class{constructor(B){this.decorations=this.getDeco(B)}update(B){(B.selectionSet||B.docChanged||B.viewportChanged)&&(this.decorations=this.getDeco(B.view))}getDeco(B){let _=B.state.facet(highlightConfig),{state:T}=B,E=T.selection;if(E.ranges.length>1)return Decoration.none;let W=E.main,X,q=null;if(W.empty){if(!_.highlightWordAroundCursor)return Decoration.none;let te=T.wordAt(W.head);if(!te)return Decoration.none;q=T.charCategorizer(W.head),X=T.sliceDoc(te.from,te.to)}else{let te=W.to-W.from;if(te<_.minSelectionLength||te>200)return Decoration.none;if(_.wholeWords){if(X=T.sliceDoc(W.from,W.to),q=T.charCategorizer(W.head),!(insideWordBoundaries(q,T,W.from,W.to)&&insideWord(q,T,W.from,W.to)))return Decoration.none}else if(X=T.sliceDoc(W.from,W.to),!X)return Decoration.none}let Y=[];for(let te of B.visibleRanges){let ne=new SearchCursor(T.doc,X,te.from,te.to);for(;!ne.next().done;){let{from:ae,to:le}=ne.value;if((!q||insideWordBoundaries(q,T,ae,le))&&(W.empty&&ae<=W.from&&le>=W.to?Y.push(mainMatchDeco.range(ae,le)):(ae>=W.to||le<=W.from)&&Y.push(matchDeco.range(ae,le)),Y.length>_.maxMatches))return Decoration.none}}return Decoration.set(Y)}},{decorations:B=>B.decorations}),defaultTheme=EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),selectWord=({state:B,dispatch:_})=>{let{selection:T}=B,E=EditorSelection.create(T.ranges.map(W=>B.wordAt(W.head)||EditorSelection.cursor(W.head)),T.mainIndex);return E.eq(T)?!1:(_(B.update({selection:E})),!0)};function findNextOccurrence(B,_){let{main:T,ranges:E}=B.selection,W=B.wordAt(T.head),X=W&&W.from==T.from&&W.to==T.to;for(let q=!1,Y=new SearchCursor(B.doc,_,E[E.length-1].to);;)if(Y.next(),Y.done){if(q)return null;Y=new SearchCursor(B.doc,_,0,Math.max(0,E[E.length-1].from-1)),q=!0}else{if(q&&E.some(te=>te.from==Y.value.from))continue;if(X){let te=B.wordAt(Y.value.from);if(!te||te.from!=Y.value.from||te.to!=Y.value.to)continue}return Y.value}}const selectNextOccurrence=({state:B,dispatch:_})=>{let{ranges:T}=B.selection;if(T.some(X=>X.from===X.to))return selectWord({state:B,dispatch:_});let E=B.sliceDoc(T[0].from,T[0].to);if(B.selection.ranges.some(X=>B.sliceDoc(X.from,X.to)!=E))return!1;let W=findNextOccurrence(B,E);return W?(_(B.update({selection:B.selection.addRange(EditorSelection.range(W.from,W.to),!1),effects:EditorView.scrollIntoView(W.to)})),!0):!1},searchConfigFacet=Facet.define({combine(B){return combineConfig(B,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:_=>new SearchPanel(_),scrollToMatch:_=>EditorView.scrollIntoView(_)})}});class SearchQuery{constructor(_){this.search=_.search,this.caseSensitive=!!_.caseSensitive,this.literal=!!_.literal,this.regexp=!!_.regexp,this.replace=_.replace||"",this.valid=!!this.search&&(!this.regexp||validRegExp(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!_.wholeWord}unquote(_){return this.literal?_:_.replace(/\\([nrt\\])/g,(T,E)=>E=="n"?`
`:E=="r"?"\r":E=="t"?"	":"\\")}eq(_){return this.search==_.search&&this.replace==_.replace&&this.caseSensitive==_.caseSensitive&&this.regexp==_.regexp&&this.wholeWord==_.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(_,T=0,E){let W=_.doc?_:EditorState.create({doc:_});return E==null&&(E=W.doc.length),this.regexp?regexpCursor(this,W,T,E):stringCursor(this,W,T,E)}}class QueryType{constructor(_){this.spec=_}}function stringCursor(B,_,T,E){return new SearchCursor(_.doc,B.unquoted,T,E,B.caseSensitive?void 0:W=>W.toLowerCase(),B.wholeWord?stringWordTest(_.doc,_.charCategorizer(_.selection.main.head)):void 0)}function stringWordTest(B,_){return(T,E,W,X)=>((X>T||X+W.length<E)&&(X=Math.max(0,T-2),W=B.sliceString(X,Math.min(B.length,E+2))),(_(charBefore(W,T-X))!=CharCategory.Word||_(charAfter(W,T-X))!=CharCategory.Word)&&(_(charAfter(W,E-X))!=CharCategory.Word||_(charBefore(W,E-X))!=CharCategory.Word))}class StringQuery extends QueryType{constructor(_){super(_)}nextMatch(_,T,E){let W=stringCursor(this.spec,_,E,_.doc.length).nextOverlapping();return W.done&&(W=stringCursor(this.spec,_,0,T).nextOverlapping()),W.done?null:W.value}prevMatchInRange(_,T,E){for(let W=E;;){let X=Math.max(T,W-1e4-this.spec.unquoted.length),q=stringCursor(this.spec,_,X,W),Y=null;for(;!q.nextOverlapping().done;)Y=q.value;if(Y)return Y;if(X==T)return null;W-=1e4}}prevMatch(_,T,E){return this.prevMatchInRange(_,0,T)||this.prevMatchInRange(_,E,_.doc.length)}getReplacement(_){return this.spec.unquote(this.spec.replace)}matchAll(_,T){let E=stringCursor(this.spec,_,0,_.doc.length),W=[];for(;!E.next().done;){if(W.length>=T)return null;W.push(E.value)}return W}highlight(_,T,E,W){let X=stringCursor(this.spec,_,Math.max(0,T-this.spec.unquoted.length),Math.min(E+this.spec.unquoted.length,_.doc.length));for(;!X.next().done;)W(X.value.from,X.value.to)}}function regexpCursor(B,_,T,E){return new RegExpCursor(_.doc,B.search,{ignoreCase:!B.caseSensitive,test:B.wholeWord?regexpWordTest(_.charCategorizer(_.selection.main.head)):void 0},T,E)}function charBefore(B,_){return B.slice(findClusterBreak(B,_,!1),_)}function charAfter(B,_){return B.slice(_,findClusterBreak(B,_))}function regexpWordTest(B){return(_,T,E)=>!E[0].length||(B(charBefore(E.input,E.index))!=CharCategory.Word||B(charAfter(E.input,E.index))!=CharCategory.Word)&&(B(charAfter(E.input,E.index+E[0].length))!=CharCategory.Word||B(charBefore(E.input,E.index+E[0].length))!=CharCategory.Word)}class RegExpQuery extends QueryType{nextMatch(_,T,E){let W=regexpCursor(this.spec,_,E,_.doc.length).next();return W.done&&(W=regexpCursor(this.spec,_,0,T).next()),W.done?null:W.value}prevMatchInRange(_,T,E){for(let W=1;;W++){let X=Math.max(T,E-W*1e4),q=regexpCursor(this.spec,_,X,E),Y=null;for(;!q.next().done;)Y=q.value;if(Y&&(X==T||Y.from>X+10))return Y;if(X==T)return null}}prevMatch(_,T,E){return this.prevMatchInRange(_,0,T)||this.prevMatchInRange(_,E,_.doc.length)}getReplacement(_){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(T,E)=>E=="$"?"$":E=="&"?_.match[0]:E!="0"&&+E<_.match.length?_.match[E]:T)}matchAll(_,T){let E=regexpCursor(this.spec,_,0,_.doc.length),W=[];for(;!E.next().done;){if(W.length>=T)return null;W.push(E.value)}return W}highlight(_,T,E,W){let X=regexpCursor(this.spec,_,Math.max(0,T-250),Math.min(E+250,_.doc.length));for(;!X.next().done;)W(X.value.from,X.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel$1=StateEffect.define(),searchState=StateField.define({create(B){return new SearchState(defaultQuery(B).create(),null)},update(B,_){for(let T of _.effects)T.is(setSearchQuery)?B=new SearchState(T.value.create(),B.panel):T.is(togglePanel$1)&&(B=new SearchState(B.query,T.value?createSearchPanel:null));return B},provide:B=>showPanel.from(B,_=>_.panel)});class SearchState{constructor(_,T){this.query=_,this.panel=T}}const matchMark=Decoration.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin.fromClass(class{constructor(B){this.view=B,this.decorations=this.highlight(B.state.field(searchState))}update(B){let _=B.state.field(searchState);(_!=B.startState.field(searchState)||B.docChanged||B.selectionSet||B.viewportChanged)&&(this.decorations=this.highlight(_))}highlight({query:B,panel:_}){if(!_||!B.spec.valid)return Decoration.none;let{view:T}=this,E=new RangeSetBuilder;for(let W=0,X=T.visibleRanges,q=X.length;W<q;W++){let{from:Y,to:te}=X[W];for(;W<q-1&&te>X[W+1].from-2*250;)te=X[++W].to;B.highlight(T.state,Y,te,(ne,ae)=>{let le=T.state.selection.ranges.some(ue=>ue.from==ne&&ue.to==ae);E.add(ne,ae,le?selectedMatchMark:matchMark)})}return E.finish()}},{decorations:B=>B.decorations});function searchCommand(B){return _=>{let T=_.state.field(searchState,!1);return T&&T.query.spec.valid?B(_,T):openSearchPanel(_)}}const findNext=searchCommand((B,{query:_})=>{let{to:T}=B.state.selection.main,E=_.nextMatch(B.state,T,T);if(!E)return!1;let W=EditorSelection.single(E.from,E.to),X=B.state.facet(searchConfigFacet);return B.dispatch({selection:W,effects:[announceMatch(B,E),X.scrollToMatch(W.main,B)],userEvent:"select.search"}),selectSearchInput(B),!0}),findPrevious=searchCommand((B,{query:_})=>{let{state:T}=B,{from:E}=T.selection.main,W=_.prevMatch(T,E,E);if(!W)return!1;let X=EditorSelection.single(W.from,W.to),q=B.state.facet(searchConfigFacet);return B.dispatch({selection:X,effects:[announceMatch(B,W),q.scrollToMatch(X.main,B)],userEvent:"select.search"}),selectSearchInput(B),!0}),selectMatches=searchCommand((B,{query:_})=>{let T=_.matchAll(B.state,1e3);return!T||!T.length?!1:(B.dispatch({selection:EditorSelection.create(T.map(E=>EditorSelection.range(E.from,E.to))),userEvent:"select.search.matches"}),!0)}),selectSelectionMatches=({state:B,dispatch:_})=>{let T=B.selection;if(T.ranges.length>1||T.main.empty)return!1;let{from:E,to:W}=T.main,X=[],q=0;for(let Y=new SearchCursor(B.doc,B.sliceDoc(E,W));!Y.next().done;){if(X.length>1e3)return!1;Y.value.from==E&&(q=X.length),X.push(EditorSelection.range(Y.value.from,Y.value.to))}return _(B.update({selection:EditorSelection.create(X,q),userEvent:"select.search.matches"})),!0},replaceNext=searchCommand((B,{query:_})=>{let{state:T}=B,{from:E,to:W}=T.selection.main;if(T.readOnly)return!1;let X=_.nextMatch(T,E,E);if(!X)return!1;let q=[],Y,te,ne=[];if(X.from==E&&X.to==W&&(te=T.toText(_.getReplacement(X)),q.push({from:X.from,to:X.to,insert:te}),X=_.nextMatch(T,X.from,X.to),ne.push(EditorView.announce.of(T.phrase("replaced match on line $",T.doc.lineAt(E).number)+"."))),X){let ae=q.length==0||q[0].from>=X.to?0:X.to-X.from-te.length;Y=EditorSelection.single(X.from-ae,X.to-ae),ne.push(announceMatch(B,X)),ne.push(T.facet(searchConfigFacet).scrollToMatch(Y.main,B))}return B.dispatch({changes:q,selection:Y,effects:ne,userEvent:"input.replace"}),!0}),replaceAll=searchCommand((B,{query:_})=>{if(B.state.readOnly)return!1;let T=_.matchAll(B.state,1e9).map(W=>{let{from:X,to:q}=W;return{from:X,to:q,insert:_.getReplacement(W)}});if(!T.length)return!1;let E=B.state.phrase("replaced $ matches",T.length)+".";return B.dispatch({changes:T,effects:EditorView.announce.of(E),userEvent:"input.replace.all"}),!0});function createSearchPanel(B){return B.state.facet(searchConfigFacet).createPanel(B)}function defaultQuery(B,_){var T,E,W,X,q;let Y=B.selection.main,te=Y.empty||Y.to>Y.from+100?"":B.sliceDoc(Y.from,Y.to);if(_&&!te)return _;let ne=B.facet(searchConfigFacet);return new SearchQuery({search:((T=_==null?void 0:_.literal)!==null&&T!==void 0?T:ne.literal)?te:te.replace(/\n/g,"\\n"),caseSensitive:(E=_==null?void 0:_.caseSensitive)!==null&&E!==void 0?E:ne.caseSensitive,literal:(W=_==null?void 0:_.literal)!==null&&W!==void 0?W:ne.literal,regexp:(X=_==null?void 0:_.regexp)!==null&&X!==void 0?X:ne.regexp,wholeWord:(q=_==null?void 0:_.wholeWord)!==null&&q!==void 0?q:ne.wholeWord})}function getSearchInput(B){let _=getPanel(B,createSearchPanel);return _&&_.dom.querySelector("[main-field]")}function selectSearchInput(B){let _=getSearchInput(B);_&&_==B.root.activeElement&&_.select()}const openSearchPanel=B=>{let _=B.state.field(searchState,!1);if(_&&_.panel){let T=getSearchInput(B);if(T&&T!=B.root.activeElement){let E=defaultQuery(B.state,_.query.spec);E.valid&&B.dispatch({effects:setSearchQuery.of(E)}),T.focus(),T.select()}}else B.dispatch({effects:[togglePanel$1.of(!0),_?setSearchQuery.of(defaultQuery(B.state,_.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=B=>{let _=B.state.field(searchState,!1);if(!_||!_.panel)return!1;let T=getPanel(B,createSearchPanel);return T&&T.dom.contains(B.root.activeElement)&&B.focus(),B.dispatch({effects:togglePanel$1.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Mod-Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0}];class SearchPanel{constructor(_){this.view=_;let T=this.query=_.state.field(searchState).query.spec;this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:T.search,placeholder:phrase(_,"Find"),"aria-label":phrase(_,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:T.replace,placeholder:phrase(_,"Replace"),"aria-label":phrase(_,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:T.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:T.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:T.wholeWord,onchange:this.commit});function E(W,X,q){return crelt("button",{class:"cm-button",name:W,onclick:X,type:"button"},q)}this.dom=crelt("div",{onkeydown:W=>this.keydown(W),class:"cm-search"},[this.searchField,E("next",()=>findNext(_),[phrase(_,"next")]),E("prev",()=>findPrevious(_),[phrase(_,"previous")]),E("select",()=>selectMatches(_),[phrase(_,"all")]),crelt("label",null,[this.caseField,phrase(_,"match case")]),crelt("label",null,[this.reField,phrase(_,"regexp")]),crelt("label",null,[this.wordField,phrase(_,"by word")]),..._.state.readOnly?[]:[crelt("br"),this.replaceField,E("replace",()=>replaceNext(_),[phrase(_,"replace")]),E("replaceAll",()=>replaceAll(_),[phrase(_,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(_),"aria-label":phrase(_,"close"),type:"button"},[""])])}commit(){let _=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});_.eq(this.query)||(this.query=_,this.view.dispatch({effects:setSearchQuery.of(_)}))}keydown(_){runScopeHandlers(this.view,_,"search-panel")?_.preventDefault():_.keyCode==13&&_.target==this.searchField?(_.preventDefault(),(_.shiftKey?findPrevious:findNext)(this.view)):_.keyCode==13&&_.target==this.replaceField&&(_.preventDefault(),replaceNext(this.view))}update(_){for(let T of _.transactions)for(let E of T.effects)E.is(setSearchQuery)&&!E.value.eq(this.query)&&this.setQuery(E.value)}setQuery(_){this.query=_,this.searchField.value=_.search,this.replaceField.value=_.replace,this.caseField.checked=_.caseSensitive,this.reField.checked=_.regexp,this.wordField.checked=_.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(B,_){return B.state.phrase(_)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(B,{from:_,to:T}){let E=B.state.doc.lineAt(_),W=B.state.doc.lineAt(T).to,X=Math.max(E.from,_-AnnounceMargin),q=Math.min(W,T+AnnounceMargin),Y=B.state.sliceDoc(X,q);if(X!=E.from){for(let te=0;te<AnnounceMargin;te++)if(!Break.test(Y[te+1])&&Break.test(Y[te])){Y=Y.slice(te);break}}if(q!=W){for(let te=Y.length-1;te>Y.length-AnnounceMargin;te--)if(!Break.test(Y[te-1])&&Break.test(Y[te])){Y=Y.slice(0,te);break}}return EditorView.announce.of(`${B.state.phrase("current match")}. ${Y} ${B.state.phrase("on line")} ${E.number}.`)}const baseTheme$2=EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.low(searchHighlighter),baseTheme$2];class CompletionContext{constructor(_,T,E,W){this.state=_,this.pos=T,this.explicit=E,this.view=W,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(_){let T=syntaxTree(this.state).resolveInner(this.pos,-1);for(;T&&_.indexOf(T.name)<0;)T=T.parent;return T?{from:T.from,to:this.pos,text:this.state.sliceDoc(T.from,this.pos),type:T.type}:null}matchBefore(_){let T=this.state.doc.lineAt(this.pos),E=Math.max(T.from,this.pos-250),W=T.text.slice(E-T.from,this.pos-T.from),X=W.search(ensureAnchor(_,!1));return X<0?null:{from:E+X,to:this.pos,text:W.slice(X)}}get aborted(){return this.abortListeners==null}addEventListener(_,T,E){_=="abort"&&this.abortListeners&&(this.abortListeners.push(T),E&&E.onDocChange&&(this.abortOnDocChange=!0))}}function toSet(B){let _=Object.keys(B).join(""),T=/\w/.test(_);return T&&(_=_.replace(/\w/g,"")),`[${T?"\\w":""}${_.replace(/[^\w\s]/g,"\\$&")}]`}function prefixMatch(B){let _=Object.create(null),T=Object.create(null);for(let{label:W}of B){_[W[0]]=!0;for(let X=1;X<W.length;X++)T[W[X]]=!0}let E=toSet(_)+toSet(T)+"*$";return[new RegExp("^"+E),new RegExp(E)]}function completeFromList(B){let _=B.map(W=>typeof W=="string"?{label:W}:W),[T,E]=_.every(W=>/^\w+$/.test(W.label))?[/\w*$/,/\w+$/]:prefixMatch(_);return W=>{let X=W.matchBefore(E);return X||W.explicit?{from:X?X.from:W.pos,options:_,validFor:T}:null}}class Option{constructor(_,T,E,W){this.completion=_,this.source=T,this.match=E,this.score=W}}function cur(B){return B.selection.main.from}function ensureAnchor(B,_){var T;let{source:E}=B,W=_&&E[0]!="^",X=E[E.length-1]!="$";return!W&&!X?B:new RegExp(`${W?"^":""}(?:${E})${X?"$":""}`,(T=B.flags)!==null&&T!==void 0?T:B.ignoreCase?"i":"")}const pickedCompletion=Annotation.define();function insertCompletionText(B,_,T,E){let{main:W}=B.selection,X=T-W.from,q=E-W.from;return Object.assign(Object.assign({},B.changeByRange(Y=>Y!=W&&T!=E&&B.sliceDoc(Y.from+X,Y.from+q)!=B.sliceDoc(T,E)?{range:Y}:{changes:{from:Y.from+X,to:E==W.from?Y.to:Y.from+q,insert:_},range:EditorSelection.cursor(Y.from+X+_.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const SourceCache=new WeakMap;function asSource(B){if(!Array.isArray(B))return B;let _=SourceCache.get(B);return _||SourceCache.set(B,_=completeFromList(B)),_}const startCompletionEffect=StateEffect.define(),closeCompletionEffect=StateEffect.define();class FuzzyMatcher{constructor(_){this.pattern=_,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let T=0;T<_.length;){let E=codePointAt(_,T),W=codePointSize(E);this.chars.push(E);let X=_.slice(T,T+W),q=X.toUpperCase();this.folded.push(codePointAt(q==X?X.toLowerCase():q,0)),T+=W}this.astral=_.length!=this.chars.length}ret(_,T){return this.score=_,this.matched=T,this}match(_){if(this.pattern.length==0)return this.ret(-100,[]);if(_.length<this.pattern.length)return null;let{chars:T,folded:E,any:W,precise:X,byWord:q}=this;if(T.length==1){let Ie=codePointAt(_,0),Ve=codePointSize(Ie),$e=Ve==_.length?0:-100;if(Ie!=T[0])if(Ie==E[0])$e+=-200;else return null;return this.ret($e,[0,Ve])}let Y=_.indexOf(this.pattern);if(Y==0)return this.ret(_.length==this.pattern.length?0:-100,[0,this.pattern.length]);let te=T.length,ne=0;if(Y<0){for(let Ie=0,Ve=Math.min(_.length,200);Ie<Ve&&ne<te;){let $e=codePointAt(_,Ie);($e==T[ne]||$e==E[ne])&&(W[ne++]=Ie),Ie+=codePointSize($e)}if(ne<te)return null}let ae=0,le=0,ue=!1,ge=0,ye=-1,xe=-1,Te=/[a-z]/.test(_),Ae=!0;for(let Ie=0,Ve=Math.min(_.length,200),$e=0;Ie<Ve&&le<te;){let We=codePointAt(_,Ie);Y<0&&(ae<te&&We==T[ae]&&(X[ae++]=Ie),ge<te&&(We==T[ge]||We==E[ge]?(ge==0&&(ye=Ie),xe=Ie+1,ge++):ge=0));let Ue,je=We<255?We>=48&&We<=57||We>=97&&We<=122?2:We>=65&&We<=90?1:0:(Ue=fromCodePoint(We))!=Ue.toLowerCase()?1:Ue!=Ue.toUpperCase()?2:0;(!Ie||je==1&&Te||$e==0&&je!=0)&&(T[le]==We||E[le]==We&&(ue=!0)?q[le++]=Ie:q.length&&(Ae=!1)),$e=je,Ie+=codePointSize(We)}return le==te&&q[0]==0&&Ae?this.result(-100+(ue?-200:0),q,_):ge==te&&ye==0?this.ret(-200-_.length+(xe==_.length?0:-100),[0,xe]):Y>-1?this.ret(-700-_.length,[Y,Y+this.pattern.length]):ge==te?this.ret(-900-_.length,[ye,xe]):le==te?this.result(-100+(ue?-200:0)+-700+(Ae?0:-1100),q,_):T.length==2?null:this.result((W[0]?-700:0)+-200+-1100,W,_)}result(_,T,E){let W=[],X=0;for(let q of T){let Y=q+(this.astral?codePointSize(codePointAt(E,q)):1);X&&W[X-1]==q?W[X-1]=Y:(W[X++]=q,W[X++]=Y)}return this.ret(_-E.length,W)}}class StrictMatcher{constructor(_){this.pattern=_,this.matched=[],this.score=0,this.folded=_.toLowerCase()}match(_){if(_.length<this.pattern.length)return null;let T=_.slice(0,this.pattern.length),E=T==this.pattern?0:T.toLowerCase()==this.folded?-200:null;return E==null?null:(this.matched=[0,T.length],this.score=E+(_.length==this.pattern.length?0:-100),this)}}const completionConfig=Facet.define({combine(B){return combineConfig(B,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:defaultPositionInfo,filterStrict:!1,compareCompletions:(_,T)=>_.label.localeCompare(T.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(_,T)=>_&&T,closeOnBlur:(_,T)=>_&&T,icons:(_,T)=>_&&T,tooltipClass:(_,T)=>E=>joinClass(_(E),T(E)),optionClass:(_,T)=>E=>joinClass(_(E),T(E)),addToOptions:(_,T)=>_.concat(T),filterStrict:(_,T)=>_||T})}});function joinClass(B,_){return B?_?B+" "+_:B:_}function defaultPositionInfo(B,_,T,E,W,X){let q=B.textDirection==Direction.RTL,Y=q,te=!1,ne="top",ae,le,ue=_.left-W.left,ge=W.right-_.right,ye=E.right-E.left,xe=E.bottom-E.top;if(Y&&ue<Math.min(ye,ge)?Y=!1:!Y&&ge<Math.min(ye,ue)&&(Y=!0),ye<=(Y?ue:ge))ae=Math.max(W.top,Math.min(T.top,W.bottom-xe))-_.top,le=Math.min(400,Y?ue:ge);else{te=!0,le=Math.min(400,(q?_.right:W.right-_.left)-30);let Ie=W.bottom-_.bottom;Ie>=xe||Ie>_.top?ae=T.bottom-_.top:(ne="bottom",ae=_.bottom-T.top)}let Te=(_.bottom-_.top)/X.offsetHeight,Ae=(_.right-_.left)/X.offsetWidth;return{style:`${ne}: ${ae/Te}px; max-width: ${le/Ae}px`,class:"cm-completionInfo-"+(te?q?"left-narrow":"right-narrow":Y?"left":"right")}}function optionContent(B){let _=B.addToOptions.slice();return B.icons&&_.push({render(T){let E=document.createElement("div");return E.classList.add("cm-completionIcon"),T.type&&E.classList.add(...T.type.split(/\s+/g).map(W=>"cm-completionIcon-"+W)),E.setAttribute("aria-hidden","true"),E},position:20}),_.push({render(T,E,W,X){let q=document.createElement("span");q.className="cm-completionLabel";let Y=T.displayLabel||T.label,te=0;for(let ne=0;ne<X.length;){let ae=X[ne++],le=X[ne++];ae>te&&q.appendChild(document.createTextNode(Y.slice(te,ae)));let ue=q.appendChild(document.createElement("span"));ue.appendChild(document.createTextNode(Y.slice(ae,le))),ue.className="cm-completionMatchedText",te=le}return te<Y.length&&q.appendChild(document.createTextNode(Y.slice(te))),q},position:50},{render(T){if(!T.detail)return null;let E=document.createElement("span");return E.className="cm-completionDetail",E.textContent=T.detail,E},position:80}),_.sort((T,E)=>T.position-E.position).map(T=>T.render)}function rangeAroundSelected(B,_,T){if(B<=T)return{from:0,to:B};if(_<0&&(_=0),_<=B>>1){let W=Math.floor(_/T);return{from:W*T,to:(W+1)*T}}let E=Math.floor((B-_)/T);return{from:B-(E+1)*T,to:B-E*T}}class CompletionTooltip{constructor(_,T,E){this.view=_,this.stateField=T,this.applyCompletion=E,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:te=>this.placeInfo(te),key:this},this.space=null,this.currentClass="";let W=_.state.field(T),{options:X,selected:q}=W.open,Y=_.state.facet(completionConfig);this.optionContent=optionContent(Y),this.optionClass=Y.optionClass,this.tooltipClass=Y.tooltipClass,this.range=rangeAroundSelected(X.length,q,Y.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(_.state),this.dom.addEventListener("mousedown",te=>{let{options:ne}=_.state.field(T).open;for(let ae=te.target,le;ae&&ae!=this.dom;ae=ae.parentNode)if(ae.nodeName=="LI"&&(le=/-(\d+)$/.exec(ae.id))&&+le[1]<ne.length){this.applyCompletion(_,ne[+le[1]]),te.preventDefault();return}}),this.dom.addEventListener("focusout",te=>{let ne=_.state.field(this.stateField,!1);ne&&ne.tooltip&&_.state.facet(completionConfig).closeOnBlur&&te.relatedTarget!=_.contentDOM&&_.dispatch({effects:closeCompletionEffect.of(null)})}),this.showOptions(X,W.id)}mount(){this.updateSel()}showOptions(_,T){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(_,T,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(_){var T;let E=_.state.field(this.stateField),W=_.startState.field(this.stateField);if(this.updateTooltipClass(_.state),E!=W){let{options:X,selected:q,disabled:Y}=E.open;(!W.open||W.open.options!=X)&&(this.range=rangeAroundSelected(X.length,q,_.state.facet(completionConfig).maxRenderedOptions),this.showOptions(X,E.id)),this.updateSel(),Y!=((T=W.open)===null||T===void 0?void 0:T.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!Y)}}updateTooltipClass(_){let T=this.tooltipClass(_);if(T!=this.currentClass){for(let E of this.currentClass.split(" "))E&&this.dom.classList.remove(E);for(let E of T.split(" "))E&&this.dom.classList.add(E);this.currentClass=T}}positioned(_){this.space=_,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let _=this.view.state.field(this.stateField),T=_.open;if((T.selected>-1&&T.selected<this.range.from||T.selected>=this.range.to)&&(this.range=rangeAroundSelected(T.options.length,T.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.showOptions(T.options,_.id)),this.updateSelectedOption(T.selected)){this.destroyInfo();let{completion:E}=T.options[T.selected],{info:W}=E;if(!W)return;let X=typeof W=="string"?document.createTextNode(W):W(E);if(!X)return;"then"in X?X.then(q=>{q&&this.view.state.field(this.stateField,!1)==_&&this.addInfoPane(q,E)}).catch(q=>logException(this.view.state,q,"completion info")):this.addInfoPane(X,E)}}addInfoPane(_,T){this.destroyInfo();let E=this.info=document.createElement("div");if(E.className="cm-tooltip cm-completionInfo",_.nodeType!=null)E.appendChild(_),this.infoDestroy=null;else{let{dom:W,destroy:X}=_;E.appendChild(W),this.infoDestroy=X||null}this.dom.appendChild(E),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(_){let T=null;for(let E=this.list.firstChild,W=this.range.from;E;E=E.nextSibling,W++)E.nodeName!="LI"||!E.id?W--:W==_?E.hasAttribute("aria-selected")||(E.setAttribute("aria-selected","true"),T=E):E.hasAttribute("aria-selected")&&E.removeAttribute("aria-selected");return T&&scrollIntoView(this.list,T),T}measureInfo(){let _=this.dom.querySelector("[aria-selected]");if(!_||!this.info)return null;let T=this.dom.getBoundingClientRect(),E=this.info.getBoundingClientRect(),W=_.getBoundingClientRect(),X=this.space;if(!X){let q=this.dom.ownerDocument.defaultView||window;X={left:0,top:0,right:q.innerWidth,bottom:q.innerHeight}}return W.top>Math.min(X.bottom,T.bottom)-10||W.bottom<Math.max(X.top,T.top)+10?null:this.view.state.facet(completionConfig).positionInfo(this.view,T,W,E,X,this.dom)}placeInfo(_){this.info&&(_?(_.style&&(this.info.style.cssText=_.style),this.info.className="cm-tooltip cm-completionInfo "+(_.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(_,T,E){const W=document.createElement("ul");W.id=T,W.setAttribute("role","listbox"),W.setAttribute("aria-expanded","true"),W.setAttribute("aria-label",this.view.state.phrase("Completions"));let X=null;for(let q=E.from;q<E.to;q++){let{completion:Y,match:te}=_[q],{section:ne}=Y;if(ne){let ue=typeof ne=="string"?ne:ne.name;if(ue!=X&&(q>E.from||E.from==0))if(X=ue,typeof ne!="string"&&ne.header)W.appendChild(ne.header(ne));else{let ge=W.appendChild(document.createElement("completion-section"));ge.textContent=ue}}const ae=W.appendChild(document.createElement("li"));ae.id=T+"-"+q,ae.setAttribute("role","option");let le=this.optionClass(Y);le&&(ae.className=le);for(let ue of this.optionContent){let ge=ue(Y,this.view.state,this.view,te);ge&&ae.appendChild(ge)}}return E.from&&W.classList.add("cm-completionListIncompleteTop"),E.to<_.length&&W.classList.add("cm-completionListIncompleteBottom"),W}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function completionTooltip(B,_){return T=>new CompletionTooltip(T,B,_)}function scrollIntoView(B,_){let T=B.getBoundingClientRect(),E=_.getBoundingClientRect(),W=T.height/B.offsetHeight;E.top<T.top?B.scrollTop-=(T.top-E.top)/W:E.bottom>T.bottom&&(B.scrollTop+=(E.bottom-T.bottom)/W)}function score(B){return(B.boost||0)*100+(B.apply?10:0)+(B.info?5:0)+(B.type?1:0)}function sortOptions(B,_){let T=[],E=null,W=ne=>{T.push(ne);let{section:ae}=ne.completion;if(ae){E||(E=[]);let le=typeof ae=="string"?ae:ae.name;E.some(ue=>ue.name==le)||E.push(typeof ae=="string"?{name:le}:ae)}},X=_.facet(completionConfig);for(let ne of B)if(ne.hasResult()){let ae=ne.result.getMatch;if(ne.result.filter===!1)for(let le of ne.result.options)W(new Option(le,ne.source,ae?ae(le):[],1e9-T.length));else{let le=_.sliceDoc(ne.from,ne.to),ue,ge=X.filterStrict?new StrictMatcher(le):new FuzzyMatcher(le);for(let ye of ne.result.options)if(ue=ge.match(ye.label)){let xe=ye.displayLabel?ae?ae(ye,ue.matched):[]:ue.matched;W(new Option(ye,ne.source,xe,ue.score+(ye.boost||0)))}}}if(E){let ne=Object.create(null),ae=0,le=(ue,ge)=>{var ye,xe;return((ye=ue.rank)!==null&&ye!==void 0?ye:1e9)-((xe=ge.rank)!==null&&xe!==void 0?xe:1e9)||(ue.name<ge.name?-1:1)};for(let ue of E.sort(le))ae-=1e5,ne[ue.name]=ae;for(let ue of T){let{section:ge}=ue.completion;ge&&(ue.score+=ne[typeof ge=="string"?ge:ge.name])}}let q=[],Y=null,te=X.compareCompletions;for(let ne of T.sort((ae,le)=>le.score-ae.score||te(ae.completion,le.completion))){let ae=ne.completion;!Y||Y.label!=ae.label||Y.detail!=ae.detail||Y.type!=null&&ae.type!=null&&Y.type!=ae.type||Y.apply!=ae.apply||Y.boost!=ae.boost?q.push(ne):score(ne.completion)>score(Y)&&(q[q.length-1]=ne),Y=ne.completion}return q}class CompletionDialog{constructor(_,T,E,W,X,q){this.options=_,this.attrs=T,this.tooltip=E,this.timestamp=W,this.selected=X,this.disabled=q}setSelected(_,T){return _==this.selected||_>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(T,_),this.tooltip,this.timestamp,_,this.disabled)}static build(_,T,E,W,X){let q=sortOptions(_,T);if(!q.length)return W&&_.some(te=>te.state==1)?new CompletionDialog(W.options,W.attrs,W.tooltip,W.timestamp,W.selected,!0):null;let Y=T.facet(completionConfig).selectOnOpen?0:-1;if(W&&W.selected!=Y&&W.selected!=-1){let te=W.options[W.selected].completion;for(let ne=0;ne<q.length;ne++)if(q[ne].completion==te){Y=ne;break}}return new CompletionDialog(q,makeAttrs(E,Y),{pos:_.reduce((te,ne)=>ne.hasResult()?Math.min(te,ne.from):te,1e8),create:createTooltip,above:X.aboveCursor},W?W.timestamp:Date.now(),Y,!1)}map(_){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:_.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class CompletionState{constructor(_,T,E){this.active=_,this.id=T,this.open=E}static start(){return new CompletionState(none,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(_){let{state:T}=_,E=T.facet(completionConfig),X=(E.override||T.languageDataAt("autocomplete",cur(T)).map(asSource)).map(Y=>(this.active.find(ne=>ne.source==Y)||new ActiveSource(Y,this.active.some(ne=>ne.state!=0)?1:0)).update(_,E));X.length==this.active.length&&X.every((Y,te)=>Y==this.active[te])&&(X=this.active);let q=this.open;q&&_.docChanged&&(q=q.map(_.changes)),_.selection||X.some(Y=>Y.hasResult()&&_.changes.touchesRange(Y.from,Y.to))||!sameResults(X,this.active)?q=CompletionDialog.build(X,T,this.id,q,E):q&&q.disabled&&!X.some(Y=>Y.state==1)&&(q=null),!q&&X.every(Y=>Y.state!=1)&&X.some(Y=>Y.hasResult())&&(X=X.map(Y=>Y.hasResult()?new ActiveSource(Y.source,0):Y));for(let Y of _.effects)Y.is(setSelectedEffect)&&(q=q&&q.setSelected(Y.value,this.id));return X==this.active&&q==this.open?this:new CompletionState(X,this.id,q)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?baseAttrs:noAttrs}}function sameResults(B,_){if(B==_)return!0;for(let T=0,E=0;;){for(;T<B.length&&!B[T].hasResult;)T++;for(;E<_.length&&!_[E].hasResult;)E++;let W=T==B.length,X=E==_.length;if(W||X)return W==X;if(B[T++].result!=_[E++].result)return!1}}const baseAttrs={"aria-autocomplete":"list"},noAttrs={};function makeAttrs(B,_){let T={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":B};return _>-1&&(T["aria-activedescendant"]=B+"-"+_),T}const none=[];function getUpdateType(B,_){if(B.isUserEvent("input.complete")){let E=B.annotation(pickedCompletion);if(E&&_.activateOnCompletion(E))return 12}let T=B.isUserEvent("input.type");return T&&_.activateOnTyping?5:T?1:B.isUserEvent("delete.backward")?2:B.selection?8:B.docChanged?16:0}class ActiveSource{constructor(_,T,E=-1){this.source=_,this.state=T,this.explicitPos=E}hasResult(){return!1}update(_,T){let E=getUpdateType(_,T),W=this;(E&8||E&16&&this.touches(_))&&(W=new ActiveSource(W.source,0)),E&4&&W.state==0&&(W=new ActiveSource(this.source,1)),W=W.updateFor(_,E);for(let X of _.effects)if(X.is(startCompletionEffect))W=new ActiveSource(W.source,1,X.value?cur(_.state):-1);else if(X.is(closeCompletionEffect))W=new ActiveSource(W.source,0);else if(X.is(setActiveEffect))for(let q of X.value)q.source==W.source&&(W=q);return W}updateFor(_,T){return this.map(_.changes)}map(_){return _.empty||this.explicitPos<0?this:new ActiveSource(this.source,this.state,_.mapPos(this.explicitPos))}touches(_){return _.changes.touchesRange(cur(_.state))}}class ActiveResult extends ActiveSource{constructor(_,T,E,W,X){super(_,2,T),this.result=E,this.from=W,this.to=X}hasResult(){return!0}updateFor(_,T){var E;if(!(T&3))return this.map(_.changes);let W=this.result;W.map&&!_.changes.empty&&(W=W.map(W,_.changes));let X=_.changes.mapPos(this.from),q=_.changes.mapPos(this.to,1),Y=cur(_.state);if((this.explicitPos<0?Y<=X:Y<this.from)||Y>q||!W||T&2&&cur(_.startState)==this.from)return new ActiveSource(this.source,T&4?1:0);let te=this.explicitPos<0?-1:_.changes.mapPos(this.explicitPos);return checkValid(W.validFor,_.state,X,q)?new ActiveResult(this.source,te,W,X,q):W.update&&(W=W.update(W,X,q,new CompletionContext(_.state,Y,te>=0)))?new ActiveResult(this.source,te,W,W.from,(E=W.to)!==null&&E!==void 0?E:cur(_.state)):new ActiveSource(this.source,1,te)}map(_){return _.empty?this:(this.result.map?this.result.map(this.result,_):this.result)?new ActiveResult(this.source,this.explicitPos<0?-1:_.mapPos(this.explicitPos),this.result,_.mapPos(this.from),_.mapPos(this.to,1)):new ActiveSource(this.source,0)}touches(_){return _.changes.touchesRange(this.from,this.to)}}function checkValid(B,_,T,E){if(!B)return!1;let W=_.sliceDoc(T,E);return typeof B=="function"?B(W,T,E,_):ensureAnchor(B,!0).test(W)}const setActiveEffect=StateEffect.define({map(B,_){return B.map(T=>T.map(_))}}),setSelectedEffect=StateEffect.define(),completionState=StateField.define({create(){return CompletionState.start()},update(B,_){return B.update(_)},provide:B=>[showTooltip.from(B,_=>_.tooltip),EditorView.contentAttributes.from(B,_=>_.attrs)]});function applyCompletion(B,_){const T=_.completion.apply||_.completion.label;let E=B.state.field(completionState).active.find(W=>W.source==_.source);return E instanceof ActiveResult?(typeof T=="string"?B.dispatch(Object.assign(Object.assign({},insertCompletionText(B.state,T,E.from,E.to)),{annotations:pickedCompletion.of(_.completion)})):T(B,_.completion,E.from,E.to),!0):!1}const createTooltip=completionTooltip(completionState,applyCompletion);function moveCompletionSelection(B,_="option"){return T=>{let E=T.state.field(completionState,!1);if(!E||!E.open||E.open.disabled||Date.now()-E.open.timestamp<T.state.facet(completionConfig).interactionDelay)return!1;let W=1,X;_=="page"&&(X=getTooltip(T,E.open.tooltip))&&(W=Math.max(2,Math.floor(X.dom.offsetHeight/X.dom.querySelector("li").offsetHeight)-1));let{length:q}=E.open.options,Y=E.open.selected>-1?E.open.selected+W*(B?1:-1):B?0:q-1;return Y<0?Y=_=="page"?0:q-1:Y>=q&&(Y=_=="page"?q-1:0),T.dispatch({effects:setSelectedEffect.of(Y)}),!0}}const acceptCompletion=B=>{let _=B.state.field(completionState,!1);return B.state.readOnly||!_||!_.open||_.open.selected<0||_.open.disabled||Date.now()-_.open.timestamp<B.state.facet(completionConfig).interactionDelay?!1:applyCompletion(B,_.open.options[_.open.selected])},startCompletion=B=>B.state.field(completionState,!1)?(B.dispatch({effects:startCompletionEffect.of(!0)}),!0):!1,closeCompletion=B=>{let _=B.state.field(completionState,!1);return!_||!_.active.some(T=>T.state!=0)?!1:(B.dispatch({effects:closeCompletionEffect.of(null)}),!0)};class RunningQuery{constructor(_,T){this.active=_,this.context=T,this.time=Date.now(),this.updates=[],this.done=void 0}}const MaxUpdateCount=50,MinAbortTime=1e3,completionPlugin=ViewPlugin.fromClass(class{constructor(B){this.view=B,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let _ of B.state.field(completionState).active)_.state==1&&this.startQuery(_)}update(B){let _=B.state.field(completionState),T=B.state.facet(completionConfig);if(!B.selectionSet&&!B.docChanged&&B.startState.field(completionState)==_)return;let E=B.transactions.some(X=>{let q=getUpdateType(X,T);return q&8||(X.selection||X.docChanged)&&!(q&3)});for(let X=0;X<this.running.length;X++){let q=this.running[X];if(E||q.context.abortOnDocChange&&B.docChanged||q.updates.length+B.transactions.length>MaxUpdateCount&&Date.now()-q.time>MinAbortTime){for(let Y of q.context.abortListeners)try{Y()}catch(te){logException(this.view.state,te)}q.context.abortListeners=null,this.running.splice(X--,1)}else q.updates.push(...B.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),B.transactions.some(X=>X.effects.some(q=>q.is(startCompletionEffect)))&&(this.pendingStart=!0);let W=this.pendingStart?50:T.activateOnTypingDelay;if(this.debounceUpdate=_.active.some(X=>X.state==1&&!this.running.some(q=>q.active.source==X.source))?setTimeout(()=>this.startUpdate(),W):-1,this.composing!=0)for(let X of B.transactions)X.isUserEvent("input.type")?this.composing=2:this.composing==2&&X.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:B}=this.view,_=B.field(completionState);for(let T of _.active)T.state==1&&!this.running.some(E=>E.active.source==T.source)&&this.startQuery(T)}startQuery(B){let{state:_}=this.view,T=cur(_),E=new CompletionContext(_,T,B.explicitPos==T,this.view),W=new RunningQuery(B,E);this.running.push(W),Promise.resolve(B.source(E)).then(X=>{W.context.aborted||(W.done=X||null,this.scheduleAccept())},X=>{this.view.dispatch({effects:closeCompletionEffect.of(null)}),logException(this.view.state,X)})}scheduleAccept(){this.running.every(B=>B.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(completionConfig).updateSyncTime))}accept(){var B;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let _=[],T=this.view.state.facet(completionConfig);for(let E=0;E<this.running.length;E++){let W=this.running[E];if(W.done===void 0)continue;if(this.running.splice(E--,1),W.done){let q=new ActiveResult(W.active.source,W.active.explicitPos,W.done,W.done.from,(B=W.done.to)!==null&&B!==void 0?B:cur(W.updates.length?W.updates[0].startState:this.view.state));for(let Y of W.updates)q=q.update(Y,T);if(q.hasResult()){_.push(q);continue}}let X=this.view.state.field(completionState).active.find(q=>q.source==W.active.source);if(X&&X.state==1)if(W.done==null){let q=new ActiveSource(W.active.source,0);for(let Y of W.updates)q=q.update(Y,T);q.state!=1&&_.push(q)}else this.startQuery(X)}_.length&&this.view.dispatch({effects:setActiveEffect.of(_)})}},{eventHandlers:{blur(B){let _=this.view.state.field(completionState,!1);if(_&&_.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){let T=_.open&&getTooltip(this.view,_.open.tooltip);(!T||!T.dom.contains(B.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:closeCompletionEffect.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:startCompletionEffect.of(!1)}),20),this.composing=0}}}),windows=typeof navigator=="object"&&/Win/.test(navigator.platform),commitCharacters=Prec.highest(EditorView.domEventHandlers({keydown(B,_){let T=_.state.field(completionState,!1);if(!T||!T.open||T.open.disabled||T.open.selected<0||B.key.length>1||B.ctrlKey&&!(windows&&B.altKey)||B.metaKey)return!1;let E=T.open.options[T.open.selected],W=T.active.find(q=>q.source==E.source),X=E.completion.commitCharacters||W.result.commitCharacters;return X&&X.indexOf(B.key)>-1&&applyCompletion(_,E),!1}})),baseTheme$1=EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),defaults={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},closeBracketEffect=StateEffect.define({map(B,_){let T=_.mapPos(B,-1,MapMode.TrackAfter);return T??void 0}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1;closedBracket.endSide=-1;const bracketState=StateField.define({create(){return RangeSet.empty},update(B,_){if(B=B.map(_.changes),_.selection){let T=_.state.doc.lineAt(_.selection.main.head);B=B.update({filter:E=>E>=T.from&&E<=T.to})}for(let T of _.effects)T.is(closeBracketEffect)&&(B=B.update({add:[closedBracket.range(T.value,T.value+1)]}));return B}});function closeBrackets(){return[inputHandler,bracketState]}const definedClosing="()[]{}<>";function closing(B){for(let _=0;_<definedClosing.length;_+=2)if(definedClosing.charCodeAt(_)==B)return definedClosing.charAt(_+1);return fromCodePoint(B<128?B:B+1)}function config(B,_){return B.languageDataAt("closeBrackets",_)[0]||defaults}const android=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),inputHandler=EditorView.inputHandler.of((B,_,T,E)=>{if((android?B.composing:B.compositionStarted)||B.state.readOnly)return!1;let W=B.state.selection.main;if(E.length>2||E.length==2&&codePointSize(codePointAt(E,0))==1||_!=W.from||T!=W.to)return!1;let X=insertBracket(B.state,E);return X?(B.dispatch(X),!0):!1}),deleteBracketPair=({state:B,dispatch:_})=>{if(B.readOnly)return!1;let E=config(B,B.selection.main.head).brackets||defaults.brackets,W=null,X=B.changeByRange(q=>{if(q.empty){let Y=prevChar(B.doc,q.head);for(let te of E)if(te==Y&&nextChar(B.doc,q.head)==closing(codePointAt(te,0)))return{changes:{from:q.head-te.length,to:q.head+te.length},range:EditorSelection.cursor(q.head-te.length)}}return{range:W=q}});return W||_(B.update(X,{scrollIntoView:!0,userEvent:"delete.backward"})),!W},closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}];function insertBracket(B,_){let T=config(B,B.selection.main.head),E=T.brackets||defaults.brackets;for(let W of E){let X=closing(codePointAt(W,0));if(_==W)return X==W?handleSame(B,W,E.indexOf(W+W+W)>-1,T):handleOpen(B,W,X,T.before||defaults.before);if(_==X&&closedBracketAt(B,B.selection.main.from))return handleClose(B,W,X)}return null}function closedBracketAt(B,_){let T=!1;return B.field(bracketState).between(0,B.doc.length,E=>{E==_&&(T=!0)}),T}function nextChar(B,_){let T=B.sliceString(_,_+2);return T.slice(0,codePointSize(codePointAt(T,0)))}function prevChar(B,_){let T=B.sliceString(_-2,_);return codePointSize(codePointAt(T,0))==T.length?T:T.slice(1)}function handleOpen(B,_,T,E){let W=null,X=B.changeByRange(q=>{if(!q.empty)return{changes:[{insert:_,from:q.from},{insert:T,from:q.to}],effects:closeBracketEffect.of(q.to+_.length),range:EditorSelection.range(q.anchor+_.length,q.head+_.length)};let Y=nextChar(B.doc,q.head);return!Y||/\s/.test(Y)||E.indexOf(Y)>-1?{changes:{insert:_+T,from:q.head},effects:closeBracketEffect.of(q.head+_.length),range:EditorSelection.cursor(q.head+_.length)}:{range:W=q}});return W?null:B.update(X,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(B,_,T){let E=null,W=B.changeByRange(X=>X.empty&&nextChar(B.doc,X.head)==T?{changes:{from:X.head,to:X.head+T.length,insert:T},range:EditorSelection.cursor(X.head+T.length)}:E={range:X});return E?null:B.update(W,{scrollIntoView:!0,userEvent:"input.type"})}function handleSame(B,_,T,E){let W=E.stringPrefixes||defaults.stringPrefixes,X=null,q=B.changeByRange(Y=>{if(!Y.empty)return{changes:[{insert:_,from:Y.from},{insert:_,from:Y.to}],effects:closeBracketEffect.of(Y.to+_.length),range:EditorSelection.range(Y.anchor+_.length,Y.head+_.length)};let te=Y.head,ne=nextChar(B.doc,te),ae;if(ne==_){if(nodeStart(B,te))return{changes:{insert:_+_,from:te},effects:closeBracketEffect.of(te+_.length),range:EditorSelection.cursor(te+_.length)};if(closedBracketAt(B,te)){let ue=T&&B.sliceDoc(te,te+_.length*3)==_+_+_?_+_+_:_;return{changes:{from:te,to:te+ue.length,insert:ue},range:EditorSelection.cursor(te+ue.length)}}}else{if(T&&B.sliceDoc(te-2*_.length,te)==_+_&&(ae=canStartStringAt(B,te-2*_.length,W))>-1&&nodeStart(B,ae))return{changes:{insert:_+_+_+_,from:te},effects:closeBracketEffect.of(te+_.length),range:EditorSelection.cursor(te+_.length)};if(B.charCategorizer(te)(ne)!=CharCategory.Word&&canStartStringAt(B,te,W)>-1&&!probablyInString(B,te,_,W))return{changes:{insert:_+_,from:te},effects:closeBracketEffect.of(te+_.length),range:EditorSelection.cursor(te+_.length)}}return{range:X=Y}});return X?null:B.update(q,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(B,_){let T=syntaxTree(B).resolveInner(_+1);return T.parent&&T.from==_}function probablyInString(B,_,T,E){let W=syntaxTree(B).resolveInner(_,-1),X=E.reduce((q,Y)=>Math.max(q,Y.length),0);for(let q=0;q<5;q++){let Y=B.sliceDoc(W.from,Math.min(W.to,W.from+T.length+X)),te=Y.indexOf(T);if(!te||te>-1&&E.indexOf(Y.slice(0,te))>-1){let ae=W.firstChild;for(;ae&&ae.from==W.from&&ae.to-ae.from>T.length+te;){if(B.sliceDoc(ae.to-T.length,ae.to)==T)return!1;ae=ae.firstChild}return!0}let ne=W.to==_&&W.parent;if(!ne)break;W=ne}return!1}function canStartStringAt(B,_,T){let E=B.charCategorizer(_);if(E(B.sliceDoc(_-1,_))!=CharCategory.Word)return _;for(let W of T){let X=_-W.length;if(B.sliceDoc(X,_)==W&&E(B.sliceDoc(X-1,X))!=CharCategory.Word)return X}return-1}function autocompletion(B={}){return[commitCharacters,completionState,completionConfig.of(B),completionPlugin,completionKeymapExt,baseTheme$1]}const completionKeymap=[{key:"Ctrl-Space",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:acceptCompletion}],completionKeymapExt=Prec.highest(keymap.computeN([completionConfig],B=>B.facet(completionConfig).defaultKeymap?[completionKeymap]:[]));class SelectedDiagnostic{constructor(_,T,E){this.from=_,this.to=T,this.diagnostic=E}}class LintState{constructor(_,T,E){this.diagnostics=_,this.panel=T,this.selected=E}static init(_,T,E){let W=_,X=E.facet(lintConfig).markerFilter;X&&(W=X(W,E));let q=Decoration.set(W.map(Y=>Y.from==Y.to||Y.from==Y.to-1&&E.doc.lineAt(Y.from).to==Y.from?Decoration.widget({widget:new DiagnosticWidget(Y),diagnostic:Y}).range(Y.from):Decoration.mark({attributes:{class:"cm-lintRange cm-lintRange-"+Y.severity+(Y.markClass?" "+Y.markClass:"")},diagnostic:Y}).range(Y.from,Y.to)),!0);return new LintState(q,T,findDiagnostic(q))}}function findDiagnostic(B,_=null,T=0){let E=null;return B.between(T,1e9,(W,X,{spec:q})=>{if(!(_&&q.diagnostic!=_))return E=new SelectedDiagnostic(W,X,q.diagnostic),!1}),E}function hideTooltip(B,_){let T=_.pos,E=_.end||T,W=B.state.facet(lintConfig).hideOn(B,T,E);if(W!=null)return W;let X=B.startState.doc.lineAt(_.pos);return!!(B.effects.some(q=>q.is(setDiagnosticsEffect))||B.changes.touchesRange(X.from,Math.max(X.to,E)))}function maybeEnableLint(B,_){return B.field(lintState,!1)?_:_.concat(StateEffect.appendConfig.of(lintExtensions))}const setDiagnosticsEffect=StateEffect.define(),togglePanel=StateEffect.define(),movePanelSelection=StateEffect.define(),lintState=StateField.define({create(){return new LintState(Decoration.none,null,null)},update(B,_){if(_.docChanged&&B.diagnostics.size){let T=B.diagnostics.map(_.changes),E=null,W=B.panel;if(B.selected){let X=_.changes.mapPos(B.selected.from,1);E=findDiagnostic(T,B.selected.diagnostic,X)||findDiagnostic(T,null,X)}!T.size&&W&&_.state.facet(lintConfig).autoPanel&&(W=null),B=new LintState(T,W,E)}for(let T of _.effects)if(T.is(setDiagnosticsEffect)){let E=_.state.facet(lintConfig).autoPanel?T.value.length?LintPanel.open:null:B.panel;B=LintState.init(T.value,E,_.state)}else T.is(togglePanel)?B=new LintState(B.diagnostics,T.value?LintPanel.open:null,B.selected):T.is(movePanelSelection)&&(B=new LintState(B.diagnostics,B.panel,T.value));return B},provide:B=>[showPanel.from(B,_=>_.panel),EditorView.decorations.from(B,_=>_.diagnostics)]}),activeMark=Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function lintTooltip(B,_,T){let{diagnostics:E}=B.state.field(lintState),W=[],X=2e8,q=0;E.between(_-(T<0?1:0),_+(T>0?1:0),(te,ne,{spec:ae})=>{_>=te&&_<=ne&&(te==ne||(_>te||T>0)&&(_<ne||T<0))&&(W.push(ae.diagnostic),X=Math.min(te,X),q=Math.max(ne,q))});let Y=B.state.facet(lintConfig).tooltipFilter;return Y&&(W=Y(W,B.state)),W.length?{pos:X,end:q,above:B.state.doc.lineAt(X).to<q,create(){return{dom:diagnosticsTooltip(B,W)}}}:null}function diagnosticsTooltip(B,_){return crelt("ul",{class:"cm-tooltip-lint"},_.map(T=>renderDiagnostic(B,T,!1)))}const openLintPanel=B=>{let _=B.state.field(lintState,!1);(!_||!_.panel)&&B.dispatch({effects:maybeEnableLint(B.state,[togglePanel.of(!0)])});let T=getPanel(B,LintPanel.open);return T&&T.dom.querySelector(".cm-panel-lint ul").focus(),!0},closeLintPanel=B=>{let _=B.state.field(lintState,!1);return!_||!_.panel?!1:(B.dispatch({effects:togglePanel.of(!1)}),!0)},nextDiagnostic=B=>{let _=B.state.field(lintState,!1);if(!_)return!1;let T=B.state.selection.main,E=_.diagnostics.iter(T.to+1);return!E.value&&(E=_.diagnostics.iter(0),!E.value||E.from==T.from&&E.to==T.to)?!1:(B.dispatch({selection:{anchor:E.from,head:E.to},scrollIntoView:!0}),!0)},lintKeymap=[{key:"Mod-Shift-m",run:openLintPanel,preventDefault:!0},{key:"F8",run:nextDiagnostic}],lintConfig=Facet.define({combine(B){return Object.assign({sources:B.map(_=>_.source).filter(_=>_!=null)},combineConfig(B.map(_=>_.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(_,T)=>_?T?E=>_(E)||T(E):_:T}))}});function assignKeys(B){let _=[];if(B)e:for(let{name:T}of B){for(let E=0;E<T.length;E++){let W=T[E];if(/[a-zA-Z]/.test(W)&&!_.some(X=>X.toLowerCase()==W.toLowerCase())){_.push(W);continue e}}_.push("")}return _}function renderDiagnostic(B,_,T){var E;let W=T?assignKeys(_.actions):[];return crelt("li",{class:"cm-diagnostic cm-diagnostic-"+_.severity},crelt("span",{class:"cm-diagnosticText"},_.renderMessage?_.renderMessage(B):_.message),(E=_.actions)===null||E===void 0?void 0:E.map((X,q)=>{let Y=!1,te=ue=>{if(ue.preventDefault(),Y)return;Y=!0;let ge=findDiagnostic(B.state.field(lintState).diagnostics,_);ge&&X.apply(B,ge.from,ge.to)},{name:ne}=X,ae=W[q]?ne.indexOf(W[q]):-1,le=ae<0?ne:[ne.slice(0,ae),crelt("u",ne.slice(ae,ae+1)),ne.slice(ae+1)];return crelt("button",{type:"button",class:"cm-diagnosticAction",onclick:te,onmousedown:te,"aria-label":` Action: ${ne}${ae<0?"":` (access key "${W[q]})"`}.`},le)}),_.source&&crelt("div",{class:"cm-diagnosticSource"},_.source))}class DiagnosticWidget extends WidgetType{constructor(_){super(),this.diagnostic=_}eq(_){return _.diagnostic==this.diagnostic}toDOM(){return crelt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class PanelItem{constructor(_,T){this.diagnostic=T,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=renderDiagnostic(_,T,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class LintPanel{constructor(_){this.view=_,this.items=[];let T=W=>{if(W.keyCode==27)closeLintPanel(this.view),this.view.focus();else if(W.keyCode==38||W.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(W.keyCode==40||W.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(W.keyCode==36)this.moveSelection(0);else if(W.keyCode==35)this.moveSelection(this.items.length-1);else if(W.keyCode==13)this.view.focus();else if(W.keyCode>=65&&W.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:X}=this.items[this.selectedIndex],q=assignKeys(X.actions);for(let Y=0;Y<q.length;Y++)if(q[Y].toUpperCase().charCodeAt(0)==W.keyCode){let te=findDiagnostic(this.view.state.field(lintState).diagnostics,X);te&&X.actions[Y].apply(_,te.from,te.to)}}else return;W.preventDefault()},E=W=>{for(let X=0;X<this.items.length;X++)this.items[X].dom.contains(W.target)&&this.moveSelection(X)};this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:T,onclick:E}),this.dom=crelt("div",{class:"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>closeLintPanel(this.view)},"")),this.update()}get selectedIndex(){let _=this.view.state.field(lintState).selected;if(!_)return-1;for(let T=0;T<this.items.length;T++)if(this.items[T].diagnostic==_.diagnostic)return T;return-1}update(){let{diagnostics:_,selected:T}=this.view.state.field(lintState),E=0,W=!1,X=null;for(_.between(0,this.view.state.doc.length,(q,Y,{spec:te})=>{let ne=-1,ae;for(let le=E;le<this.items.length;le++)if(this.items[le].diagnostic==te.diagnostic){ne=le;break}ne<0?(ae=new PanelItem(this.view,te.diagnostic),this.items.splice(E,0,ae),W=!0):(ae=this.items[ne],ne>E&&(this.items.splice(E,ne-E),W=!0)),T&&ae.diagnostic==T.diagnostic?ae.dom.hasAttribute("aria-selected")||(ae.dom.setAttribute("aria-selected","true"),X=ae):ae.dom.hasAttribute("aria-selected")&&ae.dom.removeAttribute("aria-selected"),E++});E<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)W=!0,this.items.pop();this.items.length==0&&(this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),W=!0),X?(this.list.setAttribute("aria-activedescendant",X.id),this.view.requestMeasure({key:this,read:()=>({sel:X.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:q,panel:Y})=>{let te=Y.height/this.list.offsetHeight;q.top<Y.top?this.list.scrollTop-=(Y.top-q.top)/te:q.bottom>Y.bottom&&(this.list.scrollTop+=(q.bottom-Y.bottom)/te)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),W&&this.sync()}sync(){let _=this.list.firstChild;function T(){let E=_;_=E.nextSibling,E.remove()}for(let E of this.items)if(E.dom.parentNode==this.list){for(;_!=E.dom;)T();_=E.dom.nextSibling}else this.list.insertBefore(E.dom,_);for(;_;)T()}moveSelection(_){if(this.selectedIndex<0)return;let T=this.view.state.field(lintState),E=findDiagnostic(T.diagnostics,this.items[_].diagnostic);E&&this.view.dispatch({selection:{anchor:E.from,head:E.to},scrollIntoView:!0,effects:movePanelSelection.of(E)})}static open(_){return new LintPanel(_)}}function svg(B,_='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${_}>${encodeURIComponent(B)}</svg>')`}function underline(B){return svg(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${B}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const baseTheme=EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:underline("#d11")},".cm-lintRange-warning":{backgroundImage:underline("orange")},".cm-lintRange-info":{backgroundImage:underline("#999")},".cm-lintRange-hint":{backgroundImage:underline("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),lintExtensions=[lintState,EditorView.decorations.compute([lintState],B=>{let{selected:_,panel:T}=B.field(lintState);return!_||!T||_.from==_.to?Decoration.none:Decoration.set([activeMark.range(_.from,_.to)])}),hoverTooltip(lintTooltip,{hideOn:hideTooltip}),baseTheme],basicSetup=[lineNumbers(),highlightActiveLineGutter(),highlightSpecialChars(),history(),foldGutter(),drawSelection(),dropCursor(),EditorState.allowMultipleSelections.of(!0),indentOnInput(),syntaxHighlighting(defaultHighlightStyle,{fallback:!0}),bracketMatching(),closeBrackets(),autocompletion(),rectangularSelection(),crosshairCursor(),highlightActiveLine(),highlightSelectionMatches(),keymap.of([...closeBracketsKeymap,...defaultKeymap,...searchKeymap,...historyKeymap,...foldKeymap,...completionKeymap,...lintKeymap])];var define_process_env_default={};class Stack{constructor(_,T,E,W,X,q,Y,te,ne,ae=0,le){this.p=_,this.stack=T,this.state=E,this.reducePos=W,this.pos=X,this.score=q,this.buffer=Y,this.bufferBase=te,this.curContext=ne,this.lookAhead=ae,this.parent=le}toString(){return`[${this.stack.filter((_,T)=>T%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(_,T,E=0){let W=_.parser.context;return new Stack(_,[],T,E,E,0,[],0,W?new StackContext(W,W.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(_,T){this.stack.push(this.state,T,this.bufferBase+this.buffer.length),this.state=_}reduce(_){var T;let E=_>>19,W=_&65535,{parser:X}=this.p,q=this.reducePos<this.pos-25;q&&this.setLookAhead(this.pos);let Y=X.dynamicPrecedence(W);if(Y&&(this.score+=Y),E==0){this.pushState(X.getGoto(this.state,W,!0),this.reducePos),W<X.minRepeatTerm&&this.storeNode(W,this.reducePos,this.reducePos,q?8:4,!0),this.reduceContext(W,this.reducePos);return}let te=this.stack.length-(E-1)*3-(_&262144?6:0),ne=te?this.stack[te-2]:this.p.ranges[0].from,ae=this.reducePos-ne;ae>=2e3&&!(!((T=this.p.parser.nodeSet.types[W])===null||T===void 0)&&T.isAnonymous)&&(ne==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=ae):this.p.lastBigReductionSize<ae&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=ne,this.p.lastBigReductionSize=ae));let le=te?this.stack[te-1]:0,ue=this.bufferBase+this.buffer.length-le;if(W<X.minRepeatTerm||_&131072){let ge=X.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(W,ne,ge,ue+4,!0)}if(_&262144)this.state=this.stack[te];else{let ge=this.stack[te-3];this.state=X.getGoto(ge,W,!0)}for(;this.stack.length>te;)this.stack.pop();this.reduceContext(W,ne)}storeNode(_,T,E,W=4,X=!1){if(_==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let q=this,Y=this.buffer.length;if(Y==0&&q.parent&&(Y=q.bufferBase-q.parent.bufferBase,q=q.parent),Y>0&&q.buffer[Y-4]==0&&q.buffer[Y-1]>-1){if(T==E)return;if(q.buffer[Y-2]>=T){q.buffer[Y-2]=E;return}}}if(!X||this.pos==E)this.buffer.push(_,T,E,W);else{let q=this.buffer.length;if(q>0&&this.buffer[q-4]!=0){let Y=!1;for(let te=q;te>0&&this.buffer[te-2]>E;te-=4)if(this.buffer[te-1]>=0){Y=!0;break}if(Y)for(;q>0&&this.buffer[q-2]>E;)this.buffer[q]=this.buffer[q-4],this.buffer[q+1]=this.buffer[q-3],this.buffer[q+2]=this.buffer[q-2],this.buffer[q+3]=this.buffer[q-1],q-=4,W>4&&(W-=4)}this.buffer[q]=_,this.buffer[q+1]=T,this.buffer[q+2]=E,this.buffer[q+3]=W}}shift(_,T,E,W){if(_&131072)this.pushState(_&65535,this.pos);else if(_&262144)this.pos=W,this.shiftContext(T,E),T<=this.p.parser.maxNode&&this.buffer.push(T,E,W,4);else{let X=_,{parser:q}=this.p;(W>this.pos||T<=q.maxNode)&&(this.pos=W,q.stateFlag(X,1)||(this.reducePos=W)),this.pushState(X,E),this.shiftContext(T,E),T<=q.maxNode&&this.buffer.push(T,E,W,4)}}apply(_,T,E,W){_&65536?this.reduce(_):this.shift(_,T,E,W)}useNode(_,T){let E=this.p.reused.length-1;(E<0||this.p.reused[E]!=_)&&(this.p.reused.push(_),E++);let W=this.pos;this.reducePos=this.pos=W+_.length,this.pushState(T,W),this.buffer.push(E,W,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,_,this,this.p.stream.reset(this.pos-_.length)))}split(){let _=this,T=_.buffer.length;for(;T>0&&_.buffer[T-2]>_.reducePos;)T-=4;let E=_.buffer.slice(T),W=_.bufferBase+T;for(;_&&W==_.bufferBase;)_=_.parent;return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,E,W,this.curContext,this.lookAhead,_)}recoverByDelete(_,T){let E=_<=this.p.parser.maxNode;E&&this.storeNode(_,this.pos,T,4),this.storeNode(0,this.pos,T,E?8:4),this.pos=this.reducePos=T,this.score-=190}canShift(_){for(let T=new SimulatedStack(this);;){let E=this.p.parser.stateSlot(T.state,4)||this.p.parser.hasAction(T.state,_);if(E==0)return!1;if(!(E&65536))return!0;T.reduce(E)}}recoverByInsert(_){if(this.stack.length>=300)return[];let T=this.p.parser.nextStates(this.state);if(T.length>8||this.stack.length>=120){let W=[];for(let X=0,q;X<T.length;X+=2)(q=T[X+1])!=this.state&&this.p.parser.hasAction(q,_)&&W.push(T[X],q);if(this.stack.length<120)for(let X=0;W.length<8&&X<T.length;X+=2){let q=T[X+1];W.some((Y,te)=>te&1&&Y==q)||W.push(T[X],q)}T=W}let E=[];for(let W=0;W<T.length&&E.length<4;W+=2){let X=T[W+1];if(X==this.state)continue;let q=this.split();q.pushState(X,this.pos),q.storeNode(0,q.pos,q.pos,4,!0),q.shiftContext(T[W],this.pos),q.reducePos=this.pos,q.score-=200,E.push(q)}return E}forceReduce(){let{parser:_}=this.p,T=_.stateSlot(this.state,5);if(!(T&65536))return!1;if(!_.validAction(this.state,T)){let E=T>>19,W=T&65535,X=this.stack.length-E*3;if(X<0||_.getGoto(this.stack[X],W,!1)<0){let q=this.findForcedReduction();if(q==null)return!1;T=q}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(T),!0}findForcedReduction(){let{parser:_}=this.p,T=[],E=(W,X)=>{if(!T.includes(W))return T.push(W),_.allActions(W,q=>{if(!(q&393216))if(q&65536){let Y=(q>>19)-X;if(Y>1){let te=q&65535,ne=this.stack.length-Y*3;if(ne>=0&&_.getGoto(this.stack[ne],te,!1)>=0)return Y<<19|65536|te}}else{let Y=E(q,X+1);if(Y!=null)return Y}})};return E(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:_}=this.p;return _.data[_.stateSlot(this.state,1)]==65535&&!_.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(_){if(this.state!=_.state||this.stack.length!=_.stack.length)return!1;for(let T=0;T<this.stack.length;T+=3)if(this.stack[T]!=_.stack[T])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(_){return this.p.parser.dialect.flags[_]}shiftContext(_,T){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,_,this,this.p.stream.reset(T)))}reduceContext(_,T){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,_,this,this.p.stream.reset(T)))}emitContext(){let _=this.buffer.length-1;(_<0||this.buffer[_]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let _=this.buffer.length-1;(_<0||this.buffer[_]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(_){if(_!=this.curContext.context){let T=new StackContext(this.curContext.tracker,_);T.hash!=this.curContext.hash&&this.emitContext(),this.curContext=T}}setLookAhead(_){_>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=_)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class StackContext{constructor(_,T){this.tracker=_,this.context=T,this.hash=_.strict?_.hash(T):0}}class SimulatedStack{constructor(_){this.start=_,this.state=_.state,this.stack=_.stack,this.base=this.stack.length}reduce(_){let T=_&65535,E=_>>19;E==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(E-1)*3;let W=this.start.p.parser.getGoto(this.stack[this.base-3],T,!0);this.state=W}}class StackBufferCursor{constructor(_,T,E){this.stack=_,this.pos=T,this.index=E,this.buffer=_.buffer,this.index==0&&this.maybeNext()}static create(_,T=_.bufferBase+_.buffer.length){return new StackBufferCursor(_,T,T-_.bufferBase)}maybeNext(){let _=this.stack.parent;_!=null&&(this.index=this.stack.bufferBase-_.bufferBase,this.stack=_,this.buffer=_.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new StackBufferCursor(this.stack,this.pos,this.index)}}function decodeArray(B,_=Uint16Array){if(typeof B!="string")return B;let T=null;for(let E=0,W=0;E<B.length;){let X=0;for(;;){let q=B.charCodeAt(E++),Y=!1;if(q==126){X=65535;break}q>=92&&q--,q>=34&&q--;let te=q-32;if(te>=46&&(te-=46,Y=!0),X+=te,Y)break;X*=46}T?T[W++]=X:T=new _(X)}return T}class CachedToken{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const nullToken=new CachedToken;class InputStream{constructor(_,T){this.input=_,this.ranges=T,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=nullToken,this.rangeIndex=0,this.pos=this.chunkPos=T[0].from,this.range=T[0],this.end=T[T.length-1].to,this.readNext()}resolveOffset(_,T){let E=this.range,W=this.rangeIndex,X=this.pos+_;for(;X<E.from;){if(!W)return null;let q=this.ranges[--W];X-=E.from-q.to,E=q}for(;T<0?X>E.to:X>=E.to;){if(W==this.ranges.length-1)return null;let q=this.ranges[++W];X+=q.from-E.to,E=q}return X}clipPos(_){if(_>=this.range.from&&_<this.range.to)return _;for(let T of this.ranges)if(T.to>_)return Math.max(_,T.from);return this.end}peek(_){let T=this.chunkOff+_,E,W;if(T>=0&&T<this.chunk.length)E=this.pos+_,W=this.chunk.charCodeAt(T);else{let X=this.resolveOffset(_,1);if(X==null)return-1;if(E=X,E>=this.chunk2Pos&&E<this.chunk2Pos+this.chunk2.length)W=this.chunk2.charCodeAt(E-this.chunk2Pos);else{let q=this.rangeIndex,Y=this.range;for(;Y.to<=E;)Y=this.ranges[++q];this.chunk2=this.input.chunk(this.chunk2Pos=E),E+this.chunk2.length>Y.to&&(this.chunk2=this.chunk2.slice(0,Y.to-E)),W=this.chunk2.charCodeAt(0)}}return E>=this.token.lookAhead&&(this.token.lookAhead=E+1),W}acceptToken(_,T=0){let E=T?this.resolveOffset(T,-1):this.pos;if(E==null||E<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=_,this.token.end=E}acceptTokenTo(_,T){this.token.value=_,this.token.end=T}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:_,chunkPos:T}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=_,this.chunk2Pos=T,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let _=this.input.chunk(this.pos),T=this.pos+_.length;this.chunk=T>this.range.to?_.slice(0,this.range.to-this.pos):_,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(_=1){for(this.chunkOff+=_;this.pos+_>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();_-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=_,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(_,T){if(T?(this.token=T,T.start=_,T.lookAhead=_+1,T.value=T.extended=-1):this.token=nullToken,this.pos!=_){if(this.pos=_,_==this.end)return this.setDone(),this;for(;_<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;_>=this.range.to;)this.range=this.ranges[++this.rangeIndex];_>=this.chunkPos&&_<this.chunkPos+this.chunk.length?this.chunkOff=_-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(_,T){if(_>=this.chunkPos&&T<=this.chunkPos+this.chunk.length)return this.chunk.slice(_-this.chunkPos,T-this.chunkPos);if(_>=this.chunk2Pos&&T<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(_-this.chunk2Pos,T-this.chunk2Pos);if(_>=this.range.from&&T<=this.range.to)return this.input.read(_,T);let E="";for(let W of this.ranges){if(W.from>=T)break;W.to>_&&(E+=this.input.read(Math.max(W.from,_),Math.min(W.to,T)))}return E}}class TokenGroup{constructor(_,T){this.data=_,this.id=T}token(_,T){let{parser:E}=T.p;readToken(this.data,_,T,this.id,E.data,E.tokenPrecTable)}}TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;class ExternalTokenizer{constructor(_,T={}){this.token=_,this.contextual=!!T.contextual,this.fallback=!!T.fallback,this.extend=!!T.extend}}function readToken(B,_,T,E,W,X){let q=0,Y=1<<E,{dialect:te}=T.p.parser;e:for(;Y&B[q];){let ne=B[q+1];for(let ge=q+3;ge<ne;ge+=2)if((B[ge+1]&Y)>0){let ye=B[ge];if(te.allows(ye)&&(_.token.value==-1||_.token.value==ye||overrides(ye,_.token.value,W,X))){_.acceptToken(ye);break}}let ae=_.next,le=0,ue=B[q+2];if(_.next<0&&ue>le&&B[ne+ue*3-3]==65535){q=B[ne+ue*3-1];continue e}for(;le<ue;){let ge=le+ue>>1,ye=ne+ge+(ge<<1),xe=B[ye],Te=B[ye+1]||65536;if(ae<xe)ue=ge;else if(ae>=Te)le=ge+1;else{q=B[ye+2],_.advance();continue e}}break}}function findOffset(B,_,T){for(let E=_,W;(W=B[E])!=65535;E++)if(W==T)return E-_;return-1}function overrides(B,_,T,E){let W=findOffset(T,E,_);return W<0||findOffset(T,E,B)<W}const verbose=typeof process<"u"&&define_process_env_default&&/\bparse\b/.test(define_process_env_default.LOG);let stackIDs=null;function cutAt(B,_,T){let E=B.cursor(IterMode.IncludeAnonymous);for(E.moveTo(_);;)if(!(T<0?E.childBefore(_):E.childAfter(_)))for(;;){if((T<0?E.to<_:E.from>_)&&!E.type.isError)return T<0?Math.max(0,Math.min(E.to-1,_-25)):Math.min(B.length,Math.max(E.from+1,_+25));if(T<0?E.prevSibling():E.nextSibling())break;if(!E.parent())return T<0?0:B.length}}class FragmentCursor{constructor(_,T){this.fragments=_,this.nodeSet=T,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let _=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(_){for(this.safeFrom=_.openStart?cutAt(_.tree,_.from+_.offset,1)-_.offset:_.from,this.safeTo=_.openEnd?cutAt(_.tree,_.to+_.offset,-1)-_.offset:_.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(_.tree),this.start.push(-_.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(_){if(_<this.nextStart)return null;for(;this.fragment&&this.safeTo<=_;)this.nextFragment();if(!this.fragment)return null;for(;;){let T=this.trees.length-1;if(T<0)return this.nextFragment(),null;let E=this.trees[T],W=this.index[T];if(W==E.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let X=E.children[W],q=this.start[T]+E.positions[W];if(q>_)return this.nextStart=q,null;if(X instanceof Tree){if(q==_){if(q<this.safeFrom)return null;let Y=q+X.length;if(Y<=this.safeTo){let te=X.prop(NodeProp.lookAhead);if(!te||Y+te<this.fragment.to)return X}}this.index[T]++,q+X.length>=Math.max(this.safeFrom,_)&&(this.trees.push(X),this.start.push(q),this.index.push(0))}else this.index[T]++,this.nextStart=q+X.length}}}class TokenCache{constructor(_,T){this.stream=T,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=_.tokenizers.map(E=>new CachedToken)}getActions(_){let T=0,E=null,{parser:W}=_.p,{tokenizers:X}=W,q=W.stateSlot(_.state,3),Y=_.curContext?_.curContext.hash:0,te=0;for(let ne=0;ne<X.length;ne++){if(!(1<<ne&q))continue;let ae=X[ne],le=this.tokens[ne];if(!(E&&!ae.fallback)&&((ae.contextual||le.start!=_.pos||le.mask!=q||le.context!=Y)&&(this.updateCachedToken(le,ae,_),le.mask=q,le.context=Y),le.lookAhead>le.end+25&&(te=Math.max(le.lookAhead,te)),le.value!=0)){let ue=T;if(le.extended>-1&&(T=this.addActions(_,le.extended,le.end,T)),T=this.addActions(_,le.value,le.end,T),!ae.extend&&(E=le,T>ue))break}}for(;this.actions.length>T;)this.actions.pop();return te&&_.setLookAhead(te),!E&&_.pos==this.stream.end&&(E=new CachedToken,E.value=_.p.parser.eofTerm,E.start=E.end=_.pos,T=this.addActions(_,E.value,E.end,T)),this.mainToken=E,this.actions}getMainToken(_){if(this.mainToken)return this.mainToken;let T=new CachedToken,{pos:E,p:W}=_;return T.start=E,T.end=Math.min(E+1,W.stream.end),T.value=E==W.stream.end?W.parser.eofTerm:0,T}updateCachedToken(_,T,E){let W=this.stream.clipPos(E.pos);if(T.token(this.stream.reset(W,_),E),_.value>-1){let{parser:X}=E.p;for(let q=0;q<X.specialized.length;q++)if(X.specialized[q]==_.value){let Y=X.specializers[q](this.stream.read(_.start,_.end),E);if(Y>=0&&E.p.parser.dialect.allows(Y>>1)){Y&1?_.extended=Y>>1:_.value=Y>>1;break}}}else _.value=0,_.end=this.stream.clipPos(W+1)}putAction(_,T,E,W){for(let X=0;X<W;X+=3)if(this.actions[X]==_)return W;return this.actions[W++]=_,this.actions[W++]=T,this.actions[W++]=E,W}addActions(_,T,E,W){let{state:X}=_,{parser:q}=_.p,{data:Y}=q;for(let te=0;te<2;te++)for(let ne=q.stateSlot(X,te?2:1);;ne+=3){if(Y[ne]==65535)if(Y[ne+1]==1)ne=pair(Y,ne+2);else{W==0&&Y[ne+1]==2&&(W=this.putAction(pair(Y,ne+2),T,E,W));break}Y[ne]==T&&(W=this.putAction(pair(Y,ne+1),T,E,W))}return W}}class Parse{constructor(_,T,E,W){this.parser=_,this.input=T,this.ranges=W,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new InputStream(T,W),this.tokens=new TokenCache(_,this.stream),this.topTerm=_.top[1];let{from:X}=W[0];this.stacks=[Stack.start(this,_.top[0],X)],this.fragments=E.length&&this.stream.end-X>_.bufferLength*4?new FragmentCursor(E,_.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let _=this.stacks,T=this.minStackPos,E=this.stacks=[],W,X;if(this.bigReductionCount>300&&_.length==1){let[q]=_;for(;q.forceReduce()&&q.stack.length&&q.stack[q.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let q=0;q<_.length;q++){let Y=_[q];for(;;){if(this.tokens.mainToken=null,Y.pos>T)E.push(Y);else{if(this.advanceStack(Y,E,_))continue;{W||(W=[],X=[]),W.push(Y);let te=this.tokens.getMainToken(Y);X.push(te.value,te.end)}}break}}if(!E.length){let q=W&&findFinished(W);if(q)return verbose&&console.log("Finish with "+this.stackID(q)),this.stackToTree(q);if(this.parser.strict)throw verbose&&W&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+T);this.recovering||(this.recovering=5)}if(this.recovering&&W){let q=this.stoppedAt!=null&&W[0].pos>this.stoppedAt?W[0]:this.runRecovery(W,X,E);if(q)return verbose&&console.log("Force-finish "+this.stackID(q)),this.stackToTree(q.forceAll())}if(this.recovering){let q=this.recovering==1?1:this.recovering*3;if(E.length>q)for(E.sort((Y,te)=>te.score-Y.score);E.length>q;)E.pop();E.some(Y=>Y.reducePos>T)&&this.recovering--}else if(E.length>1){e:for(let q=0;q<E.length-1;q++){let Y=E[q];for(let te=q+1;te<E.length;te++){let ne=E[te];if(Y.sameState(ne)||Y.buffer.length>500&&ne.buffer.length>500)if((Y.score-ne.score||Y.buffer.length-ne.buffer.length)>0)E.splice(te--,1);else{E.splice(q--,1);continue e}}}E.length>12&&E.splice(12,E.length-12)}this.minStackPos=E[0].pos;for(let q=1;q<E.length;q++)E[q].pos<this.minStackPos&&(this.minStackPos=E[q].pos);return null}stopAt(_){if(this.stoppedAt!=null&&this.stoppedAt<_)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=_}advanceStack(_,T,E){let W=_.pos,{parser:X}=this,q=verbose?this.stackID(_)+" -> ":"";if(this.stoppedAt!=null&&W>this.stoppedAt)return _.forceReduce()?_:null;if(this.fragments){let ne=_.curContext&&_.curContext.tracker.strict,ae=ne?_.curContext.hash:0;for(let le=this.fragments.nodeAt(W);le;){let ue=this.parser.nodeSet.types[le.type.id]==le.type?X.getGoto(_.state,le.type.id):-1;if(ue>-1&&le.length&&(!ne||(le.prop(NodeProp.contextHash)||0)==ae))return _.useNode(le,ue),verbose&&console.log(q+this.stackID(_)+` (via reuse of ${X.getName(le.type.id)})`),!0;if(!(le instanceof Tree)||le.children.length==0||le.positions[0]>0)break;let ge=le.children[0];if(ge instanceof Tree&&le.positions[0]==0)le=ge;else break}}let Y=X.stateSlot(_.state,4);if(Y>0)return _.reduce(Y),verbose&&console.log(q+this.stackID(_)+` (via always-reduce ${X.getName(Y&65535)})`),!0;if(_.stack.length>=8400)for(;_.stack.length>6e3&&_.forceReduce(););let te=this.tokens.getActions(_);for(let ne=0;ne<te.length;){let ae=te[ne++],le=te[ne++],ue=te[ne++],ge=ne==te.length||!E,ye=ge?_:_.split(),xe=this.tokens.mainToken;if(ye.apply(ae,le,xe?xe.start:ye.pos,ue),verbose&&console.log(q+this.stackID(ye)+` (via ${ae&65536?`reduce of ${X.getName(ae&65535)}`:"shift"} for ${X.getName(le)} @ ${W}${ye==_?"":", split"})`),ge)return!0;ye.pos>W?T.push(ye):E.push(ye)}return!1}advanceFully(_,T){let E=_.pos;for(;;){if(!this.advanceStack(_,null,null))return!1;if(_.pos>E)return pushStackDedup(_,T),!0}}runRecovery(_,T,E){let W=null,X=!1;for(let q=0;q<_.length;q++){let Y=_[q],te=T[q<<1],ne=T[(q<<1)+1],ae=verbose?this.stackID(Y)+" -> ":"";if(Y.deadEnd&&(X||(X=!0,Y.restart(),verbose&&console.log(ae+this.stackID(Y)+" (restarted)"),this.advanceFully(Y,E))))continue;let le=Y.split(),ue=ae;for(let ge=0;le.forceReduce()&&ge<10&&(verbose&&console.log(ue+this.stackID(le)+" (via force-reduce)"),!this.advanceFully(le,E));ge++)verbose&&(ue=this.stackID(le)+" -> ");for(let ge of Y.recoverByInsert(te))verbose&&console.log(ae+this.stackID(ge)+" (via recover-insert)"),this.advanceFully(ge,E);this.stream.end>Y.pos?(ne==Y.pos&&(ne++,te=0),Y.recoverByDelete(te,ne),verbose&&console.log(ae+this.stackID(Y)+` (via recover-delete ${this.parser.getName(te)})`),pushStackDedup(Y,E)):(!W||W.score<Y.score)&&(W=Y)}return W}stackToTree(_){return _.close(),Tree.build({buffer:StackBufferCursor.create(_),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:_.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(_){let T=(stackIDs||(stackIDs=new WeakMap)).get(_);return T||stackIDs.set(_,T=String.fromCodePoint(this.nextStackID++)),T+_}}function pushStackDedup(B,_){for(let T=0;T<_.length;T++){let E=_[T];if(E.pos==B.pos&&E.sameState(B)){_[T].score<B.score&&(_[T]=B);return}}_.push(B)}class Dialect{constructor(_,T,E){this.source=_,this.flags=T,this.disabled=E}allows(_){return!this.disabled||this.disabled[_]==0}}class LRParser extends Parser{constructor(_){if(super(),this.wrappers=[],_.version!=14)throw new RangeError(`Parser version (${_.version}) doesn't match runtime version (14)`);let T=_.nodeNames.split(" ");this.minRepeatTerm=T.length;for(let Y=0;Y<_.repeatNodeCount;Y++)T.push("");let E=Object.keys(_.topRules).map(Y=>_.topRules[Y][1]),W=[];for(let Y=0;Y<T.length;Y++)W.push([]);function X(Y,te,ne){W[Y].push([te,te.deserialize(String(ne))])}if(_.nodeProps)for(let Y of _.nodeProps){let te=Y[0];typeof te=="string"&&(te=NodeProp[te]);for(let ne=1;ne<Y.length;){let ae=Y[ne++];if(ae>=0)X(ae,te,Y[ne++]);else{let le=Y[ne+-ae];for(let ue=-ae;ue>0;ue--)X(Y[ne++],te,le);ne++}}}this.nodeSet=new NodeSet(T.map((Y,te)=>NodeType.define({name:te>=this.minRepeatTerm?void 0:Y,id:te,props:W[te],top:E.indexOf(te)>-1,error:te==0,skipped:_.skippedNodes&&_.skippedNodes.indexOf(te)>-1}))),_.propSources&&(this.nodeSet=this.nodeSet.extend(..._.propSources)),this.strict=!1,this.bufferLength=DefaultBufferLength;let q=decodeArray(_.tokenData);this.context=_.context,this.specializerSpecs=_.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let Y=0;Y<this.specializerSpecs.length;Y++)this.specialized[Y]=this.specializerSpecs[Y].term;this.specializers=this.specializerSpecs.map(getSpecializer),this.states=decodeArray(_.states,Uint32Array),this.data=decodeArray(_.stateData),this.goto=decodeArray(_.goto),this.maxTerm=_.maxTerm,this.tokenizers=_.tokenizers.map(Y=>typeof Y=="number"?new TokenGroup(q,Y):Y),this.topRules=_.topRules,this.dialects=_.dialects||{},this.dynamicPrecedences=_.dynamicPrecedences||null,this.tokenPrecTable=_.tokenPrec,this.termNames=_.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(_,T,E){let W=new Parse(this,_,T,E);for(let X of this.wrappers)W=X(W,_,T,E);return W}getGoto(_,T,E=!1){let W=this.goto;if(T>=W[0])return-1;for(let X=W[T+1];;){let q=W[X++],Y=q&1,te=W[X++];if(Y&&E)return te;for(let ne=X+(q>>1);X<ne;X++)if(W[X]==_)return te;if(Y)return-1}}hasAction(_,T){let E=this.data;for(let W=0;W<2;W++)for(let X=this.stateSlot(_,W?2:1),q;;X+=3){if((q=E[X])==65535)if(E[X+1]==1)q=E[X=pair(E,X+2)];else{if(E[X+1]==2)return pair(E,X+2);break}if(q==T||q==0)return pair(E,X+1)}return 0}stateSlot(_,T){return this.states[_*6+T]}stateFlag(_,T){return(this.stateSlot(_,0)&T)>0}validAction(_,T){return!!this.allActions(_,E=>E==T?!0:null)}allActions(_,T){let E=this.stateSlot(_,4),W=E?T(E):void 0;for(let X=this.stateSlot(_,1);W==null;X+=3){if(this.data[X]==65535)if(this.data[X+1]==1)X=pair(this.data,X+2);else break;W=T(pair(this.data,X+1))}return W}nextStates(_){let T=[];for(let E=this.stateSlot(_,1);;E+=3){if(this.data[E]==65535)if(this.data[E+1]==1)E=pair(this.data,E+2);else break;if(!(this.data[E+2]&1)){let W=this.data[E+1];T.some((X,q)=>q&1&&X==W)||T.push(this.data[E],W)}}return T}configure(_){let T=Object.assign(Object.create(LRParser.prototype),this);if(_.props&&(T.nodeSet=this.nodeSet.extend(..._.props)),_.top){let E=this.topRules[_.top];if(!E)throw new RangeError(`Invalid top rule name ${_.top}`);T.top=E}return _.tokenizers&&(T.tokenizers=this.tokenizers.map(E=>{let W=_.tokenizers.find(X=>X.from==E);return W?W.to:E})),_.specializers&&(T.specializers=this.specializers.slice(),T.specializerSpecs=this.specializerSpecs.map((E,W)=>{let X=_.specializers.find(Y=>Y.from==E.external);if(!X)return E;let q=Object.assign(Object.assign({},E),{external:X.to});return T.specializers[W]=getSpecializer(q),q})),_.contextTracker&&(T.context=_.contextTracker),_.dialect&&(T.dialect=this.parseDialect(_.dialect)),_.strict!=null&&(T.strict=_.strict),_.wrap&&(T.wrappers=T.wrappers.concat(_.wrap)),_.bufferLength!=null&&(T.bufferLength=_.bufferLength),T}hasWrappers(){return this.wrappers.length>0}getName(_){return this.termNames?this.termNames[_]:String(_<=this.maxNode&&this.nodeSet.types[_].name||_)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(_){let T=this.dynamicPrecedences;return T==null?0:T[_]||0}parseDialect(_){let T=Object.keys(this.dialects),E=T.map(()=>!1);if(_)for(let X of _.split(" ")){let q=T.indexOf(X);q>=0&&(E[q]=!0)}let W=null;for(let X=0;X<T.length;X++)if(!E[X])for(let q=this.dialects[T[X]],Y;(Y=this.data[q++])!=65535;)(W||(W=new Uint8Array(this.maxTerm+1)))[Y]=1;return new Dialect(_,E,W)}static deserialize(_){return new LRParser(_)}}function pair(B,_){return B[_]|B[_+1]<<16}function findFinished(B){let _=null;for(let T of B){let E=T.p.stoppedAt;(T.pos==T.p.stream.end||E!=null&&T.pos>E)&&T.p.parser.stateFlag(T.state,2)&&(!_||_.score<T.score)&&(_=T)}return _}function getSpecializer(B){if(B.external){let _=B.extend?1:0;return(T,E)=>B.external(T,E)<<1|_}return B.get}const RawString=1,templateArgsEndFallback=2,MacroName=3,R=82,L=76,u=117,U=85,a$1=97,z=122,A=65,Z=90,Underscore=95,Zero=48,Quote=34,ParenL=40,ParenR=41,Space=32,GreaterThan=62,rawString=new ExternalTokenizer(B=>{if(B.next==L||B.next==U?B.advance():B.next==u&&(B.advance(),B.next==Zero+8&&B.advance()),B.next!=R||(B.advance(),B.next!=Quote))return;B.advance();let _="";for(;B.next!=ParenL;){if(B.next==Space||B.next<=13||B.next==ParenR)return;_+=String.fromCharCode(B.next),B.advance()}for(B.advance();;){if(B.next<0)return B.acceptToken(RawString);if(B.next==ParenR){let T=!0;for(let E=0;T&&E<_.length;E++)B.peek(E+1)!=_.charCodeAt(E)&&(T=!1);if(T&&B.peek(_.length+1)==Quote)return B.acceptToken(RawString,2+_.length)}B.advance()}}),fallback=new ExternalTokenizer(B=>{if(B.next==GreaterThan)B.peek(1)==GreaterThan&&B.acceptToken(templateArgsEndFallback,1);else{let _=!1,T=0;for(;;T++){if(B.next>=A&&B.next<=Z)_=!0;else{if(B.next>=a$1&&B.next<=z)return;if(B.next!=Underscore&&!(B.next>=Zero&&B.next<=Zero+9))break}B.advance()}_&&T>1&&B.acceptToken(MacroName)}},{extend:!0}),cppHighlighting=styleTags({"typedef struct union enum class typename decltype auto template operator friend noexcept namespace using requires concept import export module __attribute__ __declspec __based":tags.definitionKeyword,"extern MsCallModifier MsPointerModifier extern static register thread_local inline const volatile restrict _Atomic mutable constexpr constinit consteval virtual explicit VirtualSpecifier Access":tags.modifier,"if else switch for while do case default return break continue goto throw try catch":tags.controlKeyword,"co_return co_yield co_await":tags.controlKeyword,"new sizeof delete static_assert":tags.operatorKeyword,"NULL nullptr":tags.null,this:tags.self,"True False":tags.bool,"TypeSize PrimitiveType":tags.standard(tags.typeName),TypeIdentifier:tags.typeName,FieldIdentifier:tags.propertyName,"CallExpression/FieldExpression/FieldIdentifier":tags.function(tags.propertyName),"ModuleName/Identifier":tags.namespace,PartitionName:tags.labelName,StatementIdentifier:tags.labelName,"Identifier DestructorName":tags.variableName,"CallExpression/Identifier":tags.function(tags.variableName),"CallExpression/ScopedIdentifier/Identifier":tags.function(tags.variableName),"FunctionDeclarator/Identifier FunctionDeclarator/DestructorName":tags.function(tags.definition(tags.variableName)),NamespaceIdentifier:tags.namespace,OperatorName:tags.operator,ArithOp:tags.arithmeticOperator,LogicOp:tags.logicOperator,BitOp:tags.bitwiseOperator,CompareOp:tags.compareOperator,AssignOp:tags.definitionOperator,UpdateOp:tags.updateOperator,LineComment:tags.lineComment,BlockComment:tags.blockComment,Number:tags.number,String:tags.string,"RawString SystemLibString":tags.special(tags.string),CharLiteral:tags.character,EscapeSequence:tags.escape,"UserDefinedLiteral/Identifier":tags.literal,PreProcArg:tags.meta,"PreprocDirectiveName #include #ifdef #ifndef #if #define #else #endif #elif":tags.processingInstruction,MacroName:tags.special(tags.name),"( )":tags.paren,"[ ]":tags.squareBracket,"{ }":tags.brace,"< >":tags.angleBracket,". ->":tags.derefOperator,", ;":tags.separator}),spec_identifier={__proto__:null,bool:34,char:34,int:34,float:34,double:34,void:34,size_t:34,ssize_t:34,intptr_t:34,uintptr_t:34,charptr_t:34,int8_t:34,int16_t:34,int32_t:34,int64_t:34,uint8_t:34,uint16_t:34,uint32_t:34,uint64_t:34,char8_t:34,char16_t:34,char32_t:34,char64_t:34,const:68,volatile:70,restrict:72,_Atomic:74,mutable:76,constexpr:78,constinit:80,consteval:82,struct:86,__declspec:90,final:148,override:148,public:152,private:152,protected:152,virtual:154,extern:160,static:162,register:164,inline:166,thread_local:168,__attribute__:172,__based:178,__restrict:180,__uptr:180,__sptr:180,_unaligned:180,__unaligned:180,noexcept:194,requires:198,TRUE:784,true:784,FALSE:786,false:786,typename:218,class:220,template:234,throw:248,__cdecl:256,__clrcall:256,__stdcall:256,__fastcall:256,__thiscall:256,__vectorcall:256,try:260,catch:264,export:282,import:286,case:296,default:298,if:308,else:314,switch:318,do:322,while:324,for:330,return:334,break:338,continue:342,goto:346,co_return:350,co_yield:354,using:362,typedef:366,namespace:380,new:398,delete:400,co_await:402,concept:406,enum:410,static_assert:414,friend:422,union:424,explicit:430,operator:444,module:456,signed:518,unsigned:518,long:518,short:518,decltype:528,auto:530,sizeof:566,NULL:572,nullptr:586,this:588},spec_={__proto__:null,"<":131},spec_templateArgsEnd={__proto__:null,">":135},spec_scopedIdentifier={__proto__:null,operator:388,new:576,delete:582},parser=LRParser.deserialize({version:14,states:"$:|Q!QQVOOP'gOUOOO(XOWO'#CdO,RQUO'#CgO,]QUO'#FjO-sQbO'#CwO.UQUO'#CwO0TQUO'#KZO0[QUO'#CvO0gOpO'#DvO0oQ!dO'#D]OOQR'#JO'#JOO5XQVO'#GUO5fQUO'#JVOOQQ'#JV'#JVO8zQUO'#KmO<eQUO'#KmO>{QVO'#E^O?]QUO'#E^OOQQ'#Ed'#EdOOQQ'#Ee'#EeO?bQVO'#EfO@XQVO'#EiOBUQUO'#FPOBvQUO'#FhOOQR'#Fj'#FjOB{QUO'#FjOOQR'#LQ'#LQOOQR'#LP'#LPOETQVO'#KQOFxQUO'#LVOGVQUO'#KqOGkQUO'#LVOH]QUO'#LXOOQR'#HU'#HUOOQR'#HV'#HVOOQR'#HW'#HWOOQR'#K|'#K|OOQR'#J_'#J_Q!QQVOOOHkQVO'#FOOIWQUO'#EhOI_QUOOOKZQVO'#HgOKkQUO'#HgONVQUO'#KqONaQUO'#KqOOQQ'#Kq'#KqO!!_QUO'#KqOOQQ'#Jq'#JqO!!lQUO'#HxOOQQ'#KZ'#KZO!&^QUO'#KZO!&zQUO'#KQO!(zQVO'#I]O!(zQVO'#I`OCQQUO'#KQOOQQ'#Ip'#IpOOQQ'#KQ'#KQO!,}QUO'#KZOOQR'#KY'#KYO!-UQUO'#DYO!/mQUO'#KnOOQQ'#Kn'#KnO!/tQUO'#KnO!/{QUO'#ETO!0QQUO'#EWO!0VQUO'#FRO8zQUO'#FPO!QQVO'#F^O!0[Q#vO'#F`O!0gQUO'#FkO!0oQUO'#FpO!0tQVO'#FrO!0oQUO'#FuO!3sQUO'#FvO!3xQVO'#FxO!4SQUO'#FzO!4XQUO'#F|O!4^QUO'#GOO!4cQVO'#GQO!(zQVO'#GSO!4jQUO'#GpO!4xQUO'#GYO!(zQVO'#FeO!6VQUO'#FeO!6[QVO'#G`O!6cQUO'#GaO!6nQUO'#GnO!6sQUO'#GrO!6xQUO'#GzO!7jQ&lO'#HiO!:mQUO'#GuO!:}QUO'#HXO!;YQUO'#HZO!;bQUO'#DWO!;bQUO'#HuO!;bQUO'#HvO!;yQUO'#HwO!<[QUO'#H|O!=PQUO'#H}O!>uQVO'#IbO!(zQVO'#IdO!?PQUO'#IgO!?WQVO'#IjP!@}{,UO'#CbP!6n{,UO'#CbP!AY{7[O'#CbP!6n{,UO'#CbP!A_{,UO'#CbP!AjOSO'#IzPOOO)CEn)CEnOOOO'#I|'#I|O!AtOWO,59OOOQR,59O,59OO!(zQVO,59UOOQQ,59W,59WO!(zQVO,5;ROOQR,5<U,5<UO!BPQUO,59YO!(zQVO,5>qOOQR'#IX'#IXOOQR'#IY'#IYOOQR'#IZ'#IZOOQR'#I['#I[O!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!(zQVO,5>rO!DOQVO,5>zOOQQ,5?W,5?WO!EqQVO'#ChO!IjQUO'#CyOOQQ,59c,59cOOQQ,59b,59bOOQQ,5<},5<}O!IwQ&lO,5=mO!?PQUO,5?RO!LkQVO,5?UO!LrQbO,59cO!L}QVO'#FYOOQQ,5?P,5?PO!M_QVO,59VO!MfO`O,5:bO!MkQbO'#D^O!M|QbO'#K^O!N[QbO,59wO!NdQbO'#CwO!NuQUO'#CwO!NzQUO'#KZO# UQUO'#CvOOQR-E<|-E<|O# aQUO,5AoO# hQVO'#EfO@XQVO'#EiOBUQUO,5;kOOQR,5<p,5<pO#$aQUO'#KQO#$hQUO'#KQO!(zQVO'#IUO8zQUO,5;kO#${Q&lO'#HiO#(SQUO'#CsO#*wQbO'#CwO#*|QUO'#CvO#.jQUO'#KZOOQQ-E=T-E=TO#0}QUO,5AXO#1XQUO'#KZO#1cQUO,5AXOOQR,5Ao,5AoOOQQ,5>l,5>lO#3gQUO'#CgO#4]QUO,5>pO#6OQUO'#IeOOQR'#I}'#I}O#6WQUO,5:xO#6tQUO,5:xO#7eQUO,5:xO#8YQUO'#CtO!0QQUO'#ClOOQQ'#JW'#JWO#6tQUO,5:xO#8bQUO,5;QO!4xQUO'#C}O#9kQUO,5;QO#9pQUO,5>QO#:|QUO'#C}O#;dQUO,5>{O#;iQUO'#KwO#<rQUO,5;TO#<zQVO,5;TO#=UQUO,5;TOOQQ,5;T,5;TO#>}QUO'#L[O#?UQUO,5>UO#?ZQbO'#CwO#?fQUO'#GcO#?kQUO'#E^O#@[QUO,5;kO#@sQUO'#K}O#@{QUO,5;rOKkQUO'#HfOBUQUO'#HgO#AQQUO'#KqO!6nQUO'#HjO#AxQUO'#CtO!0tQVO,5<SOOQQ'#Cg'#CgOOQR'#Jh'#JhO#A}QVO,5=`OOQQ,5?Z,5?ZO#DWQbO'#CwO#DcQUO'#GcOOQQ'#Ji'#JiOOQQ-E=g-E=gOGVQUO,5AqOGkQUO,5AqO#DhQUO,5AsO#DsQUO'#G|OOQR,5Aq,5AqO#DhQUO,5AqO#EOQUO'#HOO#EWQUO,5AsOOQR,5As,5AsOOQR,5At,5AtO#EfQVO,5AtOOQR-E=]-E=]O#G`QVO,5;jOOQR,5;j,5;jO#IaQUO'#EjO#JfQUO'#EwO#K]QVO'#ExO#MoQUO'#EvO#MwQUO'#EyO#NvQUO'#EzOOQQ'#Kz'#KzO$ mQUO,5;SO$!sQUO'#EvOOQQ,5;S,5;SO$#pQUO,5;SO$%cQUO,5:yO$'|QVO,5>PO$(WQUO'#E[O$(eQUO,5>ROOQQ,5>S,5>SO$,RQVO'#C{OOQQ-E=o-E=oOOQQ,5>d,5>dOOQQ,59`,59`O$,]QUO,5>wO$.]QUO,5>zO!6nQUO,59tO$.pQUO,5;qO$.}QUO,5<{O!0QQUO,5:oOOQQ,5:r,5:rO$/YQUO,5;mO$/_QUO'#KmOBUQUO,5;kOOQR,5;x,5;xO$0OQUO'#FbO$0^QUO'#FbO$0cQUO,5;zO$3|QVO'#FmO!0tQVO,5<VO!0oQUO,5<VO!0VQUO,5<[O$4TQVO'#GUO$7PQUO,5<^O!0tQVO,5<aO$:gQVO,5<bO$:tQUO,5<dOOQR,5<d,5<dO$;}QUO,5<dOOQR,5<f,5<fOOQR,5<h,5<hOOQQ'#Fi'#FiO$<SQUO,5<jO$<XQUO,5<lOOQR,5<l,5<lO$=_QUO,5<nO$>eQUO,5<rO$>pQUO,5=[O$>uQUO,5=[O!4xQUO,5<tO$>}QUO,5<tO$?cQUO,5<PO$@iQVO,5<PO$BzQUO,5<zOOQR,5<z,5<zOOQR,5<{,5<{O$>uQUO,5<{O$DQQUO,5<{O$D]QUO,5=YO!(zQVO,5=^O!(zQVO,5=fO#NeQUO,5=mOOQQ,5>T,5>TO$FbQUO,5>TO$FlQUO,5>TO$FqQUO,5>TO$FvQUO,5>TO!6nQUO,5>TO$HtQUO'#KZO$H{QUO,5=oO$IWQUO,5=aOKkQUO,5=oO$JQQUO,5=sOOQR,5=s,5=sO$JYQUO,5=sO$LeQVO'#H[OOQQ,5=u,5=uO!;]QUO,5=uO%#`QUO'#KjO%#gQUO'#K[O%#{QUO'#KjO%$VQUO'#DyO%$hQUO'#D|O%'eQUO'#K[OOQQ'#K['#K[O%)WQUO'#K[O%#gQUO'#K[O%)]QUO'#K[OOQQ,59r,59rOOQQ,5>a,5>aOOQQ,5>b,5>bO%)eQUO'#HzO%)mQUO,5>cOOQQ,5>c,5>cO%-XQUO,5>cO%-dQUO,5>hO%1OQVO,5>iO%1VQUO,5>|O# hQVO'#EfO%4]QUO,5>|OOQQ,5>|,5>|O%4|QUO,5?OO%7QQUO,5?RO!<[QUO,5?RO%8|QUO,5?UO%<iQVO,5?UP!A_{,UO,58|P%<p{,UO,58|P%=O{7[O,58|P%=U{,UO,58|PO{O'#Ju'#JuP%=Z{,UO'#LcPOOO'#Lc'#LcP%=a{,UO'#LcPOOO,58|,58|POOO,5?f,5?fP%=fOSO,5?fOOOO-E<z-E<zOOQR1G.j1G.jO%=mQUO1G.pO%>sQUO1G0mOOQQ1G0m1G0mO%@PQUO'#CoO%B`QbO'#CwO%BkQUO'#CrO%BpQUO'#CrO%BuQUO1G.tO#AxQUO'#CqOOQQ1G.t1G.tO%DxQUO1G4]O%FOQUO1G4^O%GqQUO1G4^O%IdQUO1G4^O%KVQUO1G4^O%LxQUO1G4^O%NkQUO1G4^O&!^QUO1G4^O&$PQUO1G4^O&%rQUO1G4^O&'eQUO1G4^O&)WQUO1G4^O&*yQUO'#KPO&,SQUO'#KPO&,[QUO,59SOOQQ,5=P,5=PO&.dQUO,5=PO&.nQUO,5=PO&.sQUO,5=PO&.xQUO,5=PO!6nQUO,5=PO#NeQUO1G3XO&/SQUO1G4mO!<[QUO1G4mO&1OQUO1G4pO&2qQVO1G4pOOQQ1G.}1G.}OOQQ1G.|1G.|OOQQ1G2i1G2iO!IwQ&lO1G3XO&2xQUO'#LOO@XQVO'#EiO&4RQUO'#F]OOQQ'#Ja'#JaO&4WQUO'#FZO&4cQUO'#LOO&4kQUO,5;tO&4pQUO1G.qOOQQ1G.q1G.qOOQR1G/|1G/|O&6cQ!dO'#JPO&6hQbO,59xO&8yQ!eO'#D`O&9QQ!dO'#JRO&9VQbO,5@xO&9VQbO,5@xOOQR1G/c1G/cO&9bQbO1G/cO&9gQ&lO'#GeO&:eQbO,59cOOQR1G7Z1G7ZO#@[QUO1G1VO&:pQUO1G1^OBUQUO1G1VO&=RQUO'#CyO#*wQbO,59cO&@tQUO1G6sOOQR-E<{-E<{O&BWQUO1G0dO#6WQUO1G0dOOQQ-E=U-E=UO#6tQUO1G0dOOQQ1G0l1G0lO&B{QUO,59iOOQQ1G3l1G3lO&CcQUO,59iO&CyQUO,59iO!M_QVO1G4gO!(zQVO'#JYO&DeQUO,5AcOOQQ1G0o1G0oO!(zQVO1G0oO!6nQUO'#JnO&DmQUO,5AvOOQQ1G3p1G3pOOQR1G1V1G1VO&HjQVO'#FOO!M_QVO,5;sOOQQ,5;s,5;sOBUQUO'#JcO&JfQUO,5AiO&JnQVO'#E[OOQR1G1^1G1^O&M]QUO'#L[OOQR1G1n1G1nOOQR-E=f-E=fOOQR1G7]1G7]O#DhQUO1G7]OGVQUO1G7]O#DhQUO1G7_OOQR1G7_1G7_O&MeQUO'#G}O&MmQUO'#LWOOQQ,5=h,5=hO&M{QUO,5=jO&NQQUO,5=kOOQR1G7`1G7`O#EfQVO1G7`O&NVQUO1G7`O' ]QVO,5=kOOQR1G1U1G1UO$.vQUO'#E]O'!RQUO'#E]OOQQ'#Ky'#KyO'!lQUO'#KxO'!wQUO,5;UO'#PQUO'#ElO'#dQUO'#ElO'#wQUO'#EtOOQQ'#J['#J[O'#|QUO,5;cO'$sQUO,5;cO'%nQUO,5;dO'&tQVO,5;dOOQQ,5;d,5;dO''OQVO,5;dO'&tQVO,5;dO''VQUO,5;bO'(SQUO,5;eO'(_QUO'#KpO'(gQUO,5:vO'(lQUO,5;fOOQQ1G0n1G0nOOQQ'#J]'#J]O''VQUO,5;bO!4xQUO'#E}OOQQ,5;b,5;bO')gQUO'#E`O'+aQUO'#E{OHrQUO1G0nO'+fQUO'#EbOOQQ'#JX'#JXO'-OQUO'#KrOOQQ'#Kr'#KrO'-xQUO1G0eO'.pQUO1G3kO'/vQVO1G3kOOQQ1G3k1G3kO'0QQVO1G3kO'0XQUO'#L_O'1eQUO'#KXO'1sQUO'#KWO'2OQUO,59gO'2WQUO1G/`O'2]QUO'#FPOOQR1G1]1G1]OOQR1G2g1G2gO$>uQUO1G2gO'2gQUO1G2gO'2rQUO1G0ZOOQR'#J`'#J`O'2wQVO1G1XO'8pQUO'#FTO'8uQUO1G1VO!6nQUO'#JdO'9TQUO,5;|O$0^QUO,5;|OOQQ'#Fc'#FcOOQQ,5;|,5;|O'9cQUO1G1fOOQR1G1f1G1fO'9kQUO,5<XO$.vQUO'#FWOBUQUO'#FWO'9rQUO,5<XO!(zQVO,5<XO'9zQUO,5<XO':PQVO1G1qO!0tQVO1G1qOOQR1G1v1G1vO'?oQUO1G1xOOQR1G1{1G1{O'?tQUO1G1|OBUQUO1G2]O'@}QVO1G1|O'CcQUO1G1|O'ChQUO'#GWO8zQUO1G2]OOQR1G2O1G2OOOQR1G2U1G2UOOQR1G2W1G2WOOQR1G2Y1G2YO'CmQUO1G2^O!4xQUO1G2^OOQR1G2v1G2vO'CuQUO1G2vO$>}QUO1G2`OOQQ'#Cu'#CuO'CzQUO'#G[O'DuQUO'#G[O'DzQUO'#LRO'EYQUO'#G_OOQQ'#LS'#LSO'EhQUO1G2`O'EmQVO1G1kO'HOQVO'#GUOBUQUO'#FWOOQR'#Je'#JeO'EmQVO1G1kO'HYQUO'#FvOOQR1G2f1G2fO'H_QUO1G2gO'HdQUO'#JgO'2gQUO1G2gO!(zQVO1G2tO'HlQUO1G2xO'IuQUO1G3QO'J{QUO1G3XOOQQ1G3o1G3oO'KaQUO1G3oOOQR1G3Z1G3ZO'KfQUO'#KZO'2]QUO'#LTOGkQUO'#LVOOQR'#Gy'#GyO#DhQUO'#LXOOQR'#HQ'#HQO'KpQUO'#GvO'#wQUO'#GuOOQR1G2{1G2{O'LmQUO1G2{O'MdQUO1G3ZO'MoQUO1G3_O'MtQUO1G3_OOQR1G3_1G3_O'M|QUO'#H]OOQR'#H]'#H]O( VQUO'#H]O!(zQVO'#H`O!(zQVO'#H_OOQR'#LZ'#LZO( [QUO'#LZOOQR'#Jk'#JkO( aQVO,5=vOOQQ,5=v,5=vO( hQUO'#H^O( pQUO'#HZOOQQ1G3a1G3aO( zQUO,5@vOOQQ,5@v,5@vO%)WQUO,5@vO%)]QUO,5@vO%$VQUO,5:eO(%iQUO'#KkO(%wQUO'#KkOOQQ,5:e,5:eOOQQ'#JS'#JSO(&SQUO'#D}O(&^QUO'#KqOGkQUO'#LVO('YQUO'#D}OOQQ'#Hp'#HpOOQQ'#Hr'#HrOOQQ'#Hs'#HsOOQQ'#Kl'#KlOOQQ'#JU'#JUO('dQUO,5:hOOQQ,5:h,5:hO((aQUO'#LVO((nQUO'#HtO()UQUO,5@vO()]QUO'#H{O()hQUO'#L^O()pQUO,5>fO()uQUO'#L]OOQQ1G3}1G3}O(-lQUO1G3}O(-sQUO1G3}O(-zQUO1G4TO(/QQUO1G4TO(/VQUO,5A|O!6nQUO1G4hO!(zQVO'#IiOOQQ1G4m1G4mO(/[QUO1G4mO(1_QVO1G4pPOOO1G.h1G.hP!A_{,UO1G.hP(3_QUO'#LeP(3j{,UO1G.hP(3o{7[O1G.hPO{O-E=s-E=sPOOO,5A},5A}P(3w{,UO,5A}POOO1G5Q1G5QO!(zQVO7+$[O(3|QUO'#CyOOQQ,59^,59^O(4XQbO,59cO(4dQbO,59^OOQQ,59],59]OOQQ7+)w7+)wO!M_QVO'#JtO(4oQUO,5@kOOQQ1G.n1G.nOOQQ1G2k1G2kO(4wQUO1G2kO(4|QUO7+(sOOQQ7+*X7+*XO(7bQUO7+*XO(7iQUO7+*XO(1_QVO7+*[O#NeQUO7+(sO(7vQVO'#JbO(8ZQUO,5AjO(8cQUO,5;vOOQQ'#Co'#CoOOQQ,5;w,5;wO!(zQVO'#F[OOQQ-E=_-E=_O!M_QVO,5;uOOQQ1G1`1G1`OOQQ,5?k,5?kOOQQ-E<}-E<}OOQR'#Dg'#DgOOQR'#Di'#DiOOQR'#Dl'#DlO(9lQ!eO'#K_O(9sQMkO'#K_O(9zQ!eO'#K_OOQR'#K_'#K_OOQR'#JQ'#JQO(:RQ!eO,59zOOQQ,59z,59zO(:YQbO,5?mOOQQ-E=P-E=PO(:hQbO1G6dOOQR7+$}7+$}OOQR7+&q7+&qOOQR7+&x7+&xO'8uQUO7+&qO(:sQUO7+&OO#6WQUO7+&OO(;hQUO1G/TO(<OQUO1G/TO(<jQUO7+*ROOQQ7+*V7+*VO(>]QUO,5?tOOQQ-E=W-E=WO(?fQUO7+&ZOOQQ,5@Y,5@YOOQQ-E=l-E=lO(?kQUO'#LOO@XQVO'#EiO(@wQUO1G1_OOQQ1G1_1G1_O(BQQUO,5?}OOQQ,5?},5?}OOQQ-E=a-E=aO(BfQUO'#KpOOQR7+,w7+,wO#DhQUO7+,wOOQR7+,y7+,yO(BsQUO,5=iO#DsQUO'#JjO(CUQUO,5ArOOQR1G3U1G3UOOQR1G3V1G3VO(CdQUO7+,zOOQR7+,z7+,zO(E[QUO,5:wO(FyQUO'#EwO!(zQVO,5;VO(GlQUO,5:wO(GvQUO'#EpO(HXQUO'#EzOOQQ,5;Z,5;ZO#K]QVO'#ExO(HoQUO,5:wO(HvQUO'#EyO#GgQUO'#JZO(J`QUO,5AdOOQQ1G0p1G0pO(JkQUO,5;WO!<[QUO,5;^O(KUQUO,5;_O(KdQUO,5;WO(MvQUO,5;`OOQQ-E=Y-E=YO(NOQUO1G0}OOQQ1G1O1G1OO(NyQUO1G1OO)!PQVO1G1OO)!WQVO1G1OO)!bQUO1G0|OOQQ1G0|1G0|OOQQ1G1P1G1PO)#_QUO'#JoO)#iQUO,5A[OOQQ1G0b1G0bOOQQ-E=Z-E=ZO)#qQUO,5;iO!<[QUO,5;iO)$nQVO,5:zO)$uQUO,5;gO$ mQUO7+&YOOQQ7+&Y7+&YO!(zQVO'#EfO)$|QUO,5:|OOQQ'#Ks'#KsOOQQ-E=V-E=VOOQQ,5A^,5A^OOQQ'#Jl'#JlO)(qQUO7+&PPOQQ7+&P7+&POOQQ7+)V7+)VO))iQUO7+)VO)*oQVO7+)VOOQQ,5>m,5>mO$)YQVO'#JsO)*vQUO,5@rOOQQ1G/R1G/ROOQQ7+$z7+$zO)+RQUO7+(RO)+WQUO7+(ROOQR7+(R7+(RO$>uQUO7+(ROOQQ7+%u7+%uOOQR-E=^-E=^O!0VQUO,5;oOOQQ,5@O,5@OOOQQ-E=b-E=bO$0^QUO1G1hOOQQ1G1h1G1hOOQR7+'Q7+'QOOQR1G1s1G1sOBUQUO,5;rO)+tQUO,5<YO)+{QUO1G1sO)-UQUO1G1sO!0tQVO7+']O)-ZQVO7+']O)2yQUO7+'dO)3OQVO7+'hO)5dQUO7+'wO)5nQUO7+'hO)6tQVO7+'hOKkQUO7+'wO$>hQUO,5<rO!4xQUO7+'xO)6{QUO7+'xOOQR7+(b7+(bO)7QQUO7+'zO)7VQUO,5<vO'CzQUO,5<vO)7}QUO,5<vO'CzQUO,5<vOOQQ,5<w,5<wO)8`QVO,5<xO'EYQUO'#JfO)8jQUO,5AmO)8rQUO,5<yOOQR7+'z7+'zO)8}QVO7+'VO)5gQUO'#K}OOQR-E=c-E=cO);`QVO,5<bOOQQ,5@R,5@RO!6nQUO,5@ROOQQ-E=e-E=eO)=wQUO7+(`O)>}QUO7+(dO)?SQVO7+(dOOQQ7+(l7+(lOOQQ7+)Z7+)ZO)?[QUO'#KjO)?fQUO'#KjOOQR,5=b,5=bO)?sQUO,5=bO!;bQUO,5=bO!;bQUO,5=bO!;bQUO,5=bOOQR7+(g7+(gOOQR7+(u7+(uOOQR7+(y7+(yOOQR,5=w,5=wO)?xQUO,5=zO)AOQUO,5=yOOQR,5Au,5AuOOQR-E=i-E=iOOQQ1G3b1G3bO)BUQUO,5=xO)BZQVO'#EfOOQQ1G6b1G6bO%)WQUO1G6bO%)]QUO1G6bOOQQ1G0P1G0POOQQ-E=Q-E=QO)DrQUO,5AVO(%iQUO'#JTO)D}QUO,5AVO)D}QUO,5AVO)EVQUO,5:iO8zQUO,5:iOOQQ,5>],5>]O)EaQUO,5AqO)EhQUO'#EVO)FrQUO'#EVO)G]QUO,5:iO)GgQUO'#HlO)GgQUO'#HmOOQQ'#Ko'#KoO)HUQUO'#KoO!(zQVO'#HnOOQQ,5:i,5:iO)HvQUO,5:iO!M_QVO,5:iOOQQ-E=S-E=SOOQQ1G0S1G0SOOQQ,5>`,5>`O)H{QUO1G6bO!(zQVO,5>gO)LjQUO'#JrO)LuQUO,5AxOOQQ1G4Q1G4QO)L}QUO,5AwOOQQ,5Aw,5AwOOQQ7+)i7+)iO*!lQUO7+)iOOQQ7+)o7+)oO*'kQVO1G7hO*)mQUO7+*SO*)rQUO,5?TO**xQUO7+*[POOO7+$S7+$SP*,kQUO'#LfP*,sQUO,5BPP*,x{,UO7+$SPOOO1G7i1G7iO*,}QUO<<GvOOQQ1G.x1G.xOOQQ'#IT'#ITO*.pQUO,5@`OOQQ,5@`,5@`OOQQ-E=r-E=rOOQQ7+(V7+(VOOQQ<<Ms<<MsO*/yQUO<<MsO*1|QUO<<MvO*3oQUO<<L_O*4TQUO,5?|OOQQ,5?|,5?|OOQQ-E=`-E=`OOQQ1G1b1G1bO*5^QUO,5;vO*6dQUO1G1aOOQQ1G1a1G1aOOQR,5@y,5@yO*7mQ!eO,5@yO*7tQMkO,5@yO*7{Q!eO,5@yOOQR-E=O-E=OOOQQ1G/f1G/fO*8SQ!eO'#DwOOQQ1G5X1G5XOOQR<<J]<<J]O*8ZQUO<<IjO*9OQUO7+$oOOQQ<<Iu<<IuO(7vQVO,5;ROOQR<=!c<=!cOOQQ1G3T1G3TOOQQ,5@U,5@UOOQQ-E=h-E=hOOQR<=!f<=!fO*9{QUO1G0cO*:SQUO'#EzO*:dQUO1G0cO*:kQUO'#I}O*<RQUO1G0qO!(zQVO1G0qOOQQ,5;[,5;[OOQQ,5;],5;]OOQQ,5?u,5?uOOQQ-E=X-E=XO!<[QUO1G0xO*=bQUO1G0xOOQQ1G0y1G0yO*=sQUO'#ElOOQQ1G0z1G0zOOQQ7+&j7+&jO*>XQUO7+&jO*?_QVO7+&jOOQQ7+&h7+&hOOQQ,5@Z,5@ZOOQQ-E=m-E=mO*@ZQUO1G1TO*@eQUO1G1TO*AOQUO1G0fOOQQ1G0f1G0fO*BUQUO'#K{O*B^QUO1G1ROOQQ<<It<<ItOOQQ'#Hb'#HbO'+fQUO,5={OOQQ'#Hd'#HdO'+fQUO,5=}OOQQ-E=j-E=jPOQQ<<Ik<<IkPOQQ-E=k-E=kOOQQ<<Lq<<LqO*BcQUO'#LaO*CoQUO'#L`OOQQ,5@_,5@_OOQQ-E=q-E=qOOQR<<Km<<KmO$>uQUO<<KmO*C}QUO<<KmOOQR1G1Z1G1ZOOQQ7+'S7+'SO!M_QVO1G1tO*DSQUO1G1tOOQR7+'_7+'_OOQR<<Jw<<JwO!0tQVO<<JwOOQR<<KO<<KOO*D_QUO<<KSO*EeQVO<<KSOKkQUO<<KcO!M_QVO<<KcO*ElQUO<<KSO!0tQVO<<KSO*FuQUO<<KSO*FzQUO<<KcO*GVQUO<<KdOOQR<<Kd<<KdOOQR<<Kf<<KfO*G[QUO1G2bO)7VQUO1G2bO'CzQUO1G2bO*GmQUO1G2dO*HsQVO1G2dOOQQ1G2d1G2dO*H}QVO1G2dO*IUQUO,5@QOOQQ-E=d-E=dOOQQ1G2e1G2eO*IdQUO1G1|O*JmQVO1G1|O*JtQUO1G1|OOQQ1G5m1G5mOOQR<<Kz<<KzOOQR<<LO<<LOO*JyQVO<<LOO*KUQUO<<LOOOQR1G2|1G2|O*KZQUO1G2|O*KbQUO1G3eOOQR1G3d1G3dOOQQ7++|7++|O%)WQUO7++|O*KmQUO1G6qO*KmQUO1G6qO(%iQUO,5?oO*KuQUO,5?oOOQQ-E=R-E=RO*LQQUO1G0TOOQQ1G0T1G0TO*L[QUO1G0TO!M_QVO1G0TO*LaQUO1G0TOOQQ1G3w1G3wO*LkQUO,5:qO)EhQUO,5:qO*MXQUO,5:qO)EhQUO,5:qO$#uQUO,5:uO*MvQVO,5>VO)GgQUO'#JpO*NQQUO1G0TO*NcQVO1G0TOOQQ1G3u1G3uO*NjQUO,5>WO*NuQUO,5>XO+ dQUO,5>YO+!jQUO1G0TO%)]QUO7++|O+#pQUO1G4ROOQQ,5@^,5@^OOQQ-E=p-E=pOOQQ<<MT<<MTOOQQ<<Mn<<MnO+$yQUO1G4oP+&|QUO'#JvP+'UQUO,5BQPO{O1G7k1G7kPOOO<<Gn<<GnOOQQANC_ANC_OOQR1G6e1G6eO+'^Q!eO,5:cOOQQ,5:c,5:cO+'eQUO1G0mO+(qQUO7+&]O+*QQUO7+&dO+*cQUO,5;WOOQQ<<JU<<JUO+*qQUO7+&oOOQQ7+&Q7+&QO!4xQUO'#J^O++lQUO,5AgOOQQ7+&m7+&mOOQQ1G3g1G3gO++tQUO1G3iOOQQ,5>n,5>nO+/iQUOANAXOOQRANAXANAXO+/nQUO7+'`OOQRAN@cAN@cO+0zQVOAN@nO+1RQUOAN@nO!0tQVOAN@nO+2[QUOAN@nO+2aQUOAN@}O+2lQUOAN@}O+3rQUOAN@}OOQRAN@nAN@nO!M_QVOAN@}OOQRANAOANAOO+3wQUO7+'|O)7VQUO7+'|OOQQ7+(O7+(OO+4YQUO7+(OO+5`QVO7+(OO+5gQVO7+'hO+5nQUOANAjOOQR7+(h7+(hOOQR7+)P7+)PO+5sQUO7+)PO+5xQUO7+)POOQQ<= h<= hO+6QQUO7+,]O+6YQUO1G5ZOOQQ1G5Z1G5ZO+6eQUO7+%oOOQQ7+%o7+%oO+6vQUO7+%oO*NcQVO7+%oOOQQ7+)a7+)aO+6{QUO7+%oO+8RQUO7+%oO!M_QVO7+%oO+8]QUO1G0]O*LkQUO1G0]O)EhQUO1G0]OOQQ1G0a1G0aO+8zQUO1G3qO+:QQVO1G3qOOQQ1G3q1G3qO+:[QVO1G3qO+:cQUO,5@[OOQQ-E=n-E=nOOQQ1G3r1G3rO%)WQUO<= hOOQQ7+*Z7+*ZPOQQ,5@b,5@bPOQQ-E=t-E=tOOQQ1G/}1G/}OOQQ,5?x,5?xOOQQ-E=[-E=[OOQRG26sG26sO+:zQUOG26YO!0tQVOG26YO+<TQUOG26YOOQRG26YG26YO!M_QVOG26iO!0tQVOG26iO+<YQUOG26iO+=`QUOG26iO+=eQUO<<KhOOQQ<<Kj<<KjOOQRG27UG27UOOQR<<Lk<<LkO+=vQUO<<LkOOQQ7+*u7+*uOOQQ<<IZ<<IZO+={QUO<<IZO!M_QVO<<IZO+>QQUO<<IZO+?WQUO<<IZO*NcQVO<<IZOOQQ<<L{<<L{O+?iQUO7+%wO*LkQUO7+%wOOQQ7+)]7+)]O+@WQUO7+)]O+A^QVO7+)]OOQQANESANESO!0tQVOLD+tOOQRLD+tLD+tO+AeQUOLD,TO+BkQUOLD,TOOQRLD,TLD,TO!0tQVOLD,TOOQRANBVANBVOOQQAN>uAN>uO+BpQUOAN>uO+CvQUOAN>uO!M_QVOAN>uO+C{QUO<<IcOOQQ<<Lw<<LwOOQR!$( `!$( `O!0tQVO!$( oOOQR!$( o!$( oOOQQG24aG24aO+DjQUOG24aO+EpQUOG24aOOQR!)9EZ!)9EZOOQQLD){LD){O+EuQUO'#CgO(dQUO'#CgO+IrQUO'#CyO+LcQUO'#CyO!E{QUO'#CyO+M[QUO'#CyO+MoQUO'#CyO,#bQUO'#CyO,#rQUO'#CyO,$PQUO'#CyO,$[QbO,59cO,$gQbO,59cO,$rQbO,59cO,$}QbO'#CwO,%`QbO'#CwO,%qQbO'#CwO,&SQUO'#CgO,(gQUO'#CgO,(tQUO'#CgO,+iQUO'#CgO,.lQUO'#CgO,.|QUO'#CgO,2uQUO'#CgO,2|QUO'#CgO,3|QUO'#CgO,6VQUO,5:xO#?kQUO,5:xO#?kQUO,5:xO#=ZQUO'#L[O,6sQbO'#CwO,7OQbO'#CwO,7ZQbO'#CwO,7fQbO'#CwO#6tQUO'#E^O,7qQUO'#E^O,9OQUO'#HgO,9pQbO'#CwO,9{QbO'#CwO,:WQUO'#CvO,:]QUO'#CvO,:bQUO'#CoO,:pQbO,59cO,:{QbO,59cO,;WQbO,59cO,;cQbO,59cO,;nQbO,59cO,;yQbO,59cO,<UQbO,59cO,6VQUO1G0dO,<aQUO1G0dO#?kQUO1G0dO,7qQUO1G0dO,>nQUO'#KZO,?OQUO'#CyO,?^QbO,59cO,6VQUO7+&OO,<aQUO7+&OO,?iQUO'#EwO,@[QUO'#EzO,@{QUO'#E^O,AQQUO'#GcO,AVQUO'#CvO,A[QUO'#CwO,AaQUO'#CwO,AfQUO'#CvO,AkQUO'#GcO,ApQUO'#KZO,B^QUO'#KZO,BhQUO'#CvO,BsQUO'#CvO,COQUO'#CvO,<aQUO,5:xO,7qQUO,5:xO,7qQUO,5:xO,CZQUO'#KZO,CnQbO'#CwO,CyQUO'#CrO,DOQUO'#E^",stateData:",Dt~O(nOSSOSTOSRPQVPQ'ePQ'gPQ'hPQ'iPQ'jPQ'kPQ'lPQ'mPQ~O*ZOS~OPmO]eOa!]Od!POlTOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!VfO!X!XO!Y!WO!i!YO!opO!r!`O!s!aO!t!aO!u!bO!v!aO!x!cO!{!dO#V#QO#a#VO#b#TO#i#OO#p!xO#t!fO#v!eO$R!gO$T!hO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO${!tO$}!uO%U!yO%_#ZO%`#[O%a#YO%c!zO%e#UO%g!{O%l#SO%o!|O%v!}O%|#PO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(rRO)PYO)SaO)U|O)V{O)WiO)X!ZO)YXO)hcO)idO~OR#bOV#]O'e#^O'g#_O'h#`O'i#`O'j#aO'k#aO'l#_O'm#_O~OX#dO(p#dO(q#fO~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX(uZX(v$]X(wZX(xZX)SZX)SiX)TZX)UZX)UiX)VZX)ViX)WZX)XZX)jZX~O)WiX!UZX~P(dO]#}O!V#lO!X#{O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO(w#kO(x#kO)S#mO)T#oO)U#nO)V#pO)W#jO)X#|O~Od$RO%Y$SO'[$TO'_$UO(y$OO~Ol$VO~O!T$WO](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X~Ol$VO~P.ZOl$VO!g$YO)j$YO~OX$ZO)Z$ZO~O!R$[O)X)QP)])QP~OPmO]$eOa!]Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!TxO!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~Ol$_O#t$lO(rRO~P0zO](]Xa'yXd(]Xl'yXl(]Xr'yXr(]Xs'yXs(]Xt'yXt(]Xu'yXu(]Xv'yXv(]Xw'yXw(]Xx'yXx(]Xy'yXy(]X{'yX}'yX!V(]X!o(]X!r'yX!r(]X!s'yX!s(]X!t'yX!t(]X!u'yX!u(]X!v'yX!v(]X!x'yX!x(]X!{(]X#a'yX#b'yX%e'yX%l'yX%o(]X%v(]X&m'yX&r'yX&s'yX(r'yX(r(]X)S(]X)U(]X)V(]X~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO&r#WO&s$wO])aXd)aXl)aX!V)aX!{)aX%v)aX(r)aX)S)aX)U)aX)V)aX~O)W$vO~P:nOPmO]eOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)SaO)U|O)V{O)X!ZO)YXO)hcO)idO~Oa%QOl:zO!|%RO(r$xO~P<lO)S%SO~Oa!]Ol$_O{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r:}O~P<lOPmO]$eOa%QOl:zO!V$fO!W%_O!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V%]O)X!ZO)YXO)hcO)idO)j%[O~O]%hOd!POl%bO!V%kO!{!dO%v$mO(r;OO)S%dO)U%iO)V%iO~O(v%mO~O)W#jO~O(r%nO](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!g(tX)j(tX!O(tX!W(tX(v(tX!U(tXQ(tX!d(tX~OP%oO(oQO~PCQO]%hOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO%o!|O%v!}O)S;`O)U|O)V|O~Ol%rO!o%wO(r$xO~PE_O!TxO#v!eO(v%yO)j%|O])eX!V)eX~O]%hOd!POl%rO!V%kO!{!dO%v!}O(r$xO)S;`O)U|O)V|O~O!TxO#v!eO)W&PO)j&QO~O!U&TO~P!QO]&YO!TxO!V&WO)S&VO)U&ZO)V&ZO~Op&UO~PHrO]&cO!V&bO~OPmO]eOd!PO!VfO!X!XO!Y!WO!i!YO!{!dO#V#QO%_#ZO%`#[O%a#YO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)SaO)U|O)V{O)X!ZO)YXO)hcO)idO~Oa%QOl:zO%v$mO(r$xO~PIgO]%hOd!POl;[O!V%kO!{!dO%v$mO(r$xO)S;`O)U|O)V|O~Op&fO](tX])eX!V(tX!V)eX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!O(tX!O)eX!U(tX~O!g$YO)j$YO~PL]O!g(tX)j(tX~PL]O](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!g(tX)j(tX!O(tX!U(tX~O])eX!V)eX!O)eX~PNkOa&hO&m!RO]&lXd&lXl&lXr&lXs&lXt&lXu&lXv&lXw&lXx&lXy&lX}&lX!V&lX!r&lX!s&lX!t&lX!u&lX!v&lX!x&lX!{&lX%v&lX&r&lX&s&lX(r&lX)S&lX)U&lX)V&lX)W&lX!O&lX!T&lX!X&lX!Y&lX![&lX!^&lX!_&lX!a&lX!b&lX!c&lX!e&lX!f&lX!h&lX(u&lX(w&lX(x&lX)T&lX)X&lX!g&lX)j&lX!W&lXQ&lX!d&lX(v&lX!U&lX#v&lX~Op&fOl(}X!O(}XQ(}X!d(}X!h(}X)X(}X)j(}X~P.ZO!g$YO)j$YO](tX!V(tX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX!h(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)W(tX)X(tX!O(tX!W(tX(v(tX!U(tXQ(tX!d(tX~OPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O](}Xd(}Xl(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X!O(}XQ(}X!d(}X!h(}X)X(}X)j(}X~O]#}O~P!*qO]&lO~O])bXa)bXd)bXl)bXr)bXs)bXt)bXu)bXv)bXw)bXx)bXy)bX{)bX})bX!V)bX!o)bX!r)bX!s)bX!t)bX!u)bX!v)bX!x)bX!{)bX#a)bX#b)bX%e)bX%l)bX%o)bX%v)bX&m)bX&r)bX&s)bX(r)bX)S)bX)U)bX)V)bX~O(oQO~P!-ZO%U&nO~P!-ZO]&oO~O]#}O~O!TxO~O$W&wO(r%nO(v&vO~O]&xOw&zO~O]&xO~OPmO]$eOa%QOl:zO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#p!xO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:mO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O]'PO~O!T$WO)W'RO~P!(zO)W'TO~O)W'UO~O(r'VO~O)W'YO~P!(zOl;^O%U'^O%e'^O(r;PO~Oa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~O(v'bO~O)W'dO~P!(zO!TxO(r%nO)j'fO~O(r%nO~O]'iO~O]'jOd%nXl%nX!V%nX!{%nX%v%nX(r%nX)S%nX)U%nX)V%nX~O]'nO!V'oO!X'lO!g'lO%Z'lO%['lO%]'lO%^'lO%_'pO%`'pO%a'lO(x'mO)j'lO)x'qO~P8zO]%hOa!TOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V%kO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO!{!dO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO)S;`O)U|O)V|O~Ol;_Op&UO%v$mO(r;QO~P!8jO(r%nO(v'vO)W'wO~O]&cO!T'yO~Ol$oO}!_O!T(QO!l(VO(r$nO(v(PO)PYO~Ol$oO{(^O!T(ZO#b(^O(r$nO~Oa!TOl$oO{#RO#a#VO#b#TO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO~O](`O~OPmOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)YXO)hcO)idO~O](bO)X(cO~P!=UO]#}O~P!<[OPmO]$eOa%QOl:zO!V(iO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~OY(jO(oQO(r%nO~O'f(mO~OS(qOT(nO*W(pO~O]#}O(n(tO~Q'nXX#dO(p#dO(q(vO~Od)QOl({O&r#WO(r(zO~O!Y'Sa!['Sa!^'Sa!_'Sa!a'Sa!b'Sa!c'Sa!e'Sa!f'Sa!h'Sa(u'Sa)S'Sa)T'Sa)U'Sa)V'Sa)W'Sa)X'Sa!g'Sa)j'Sa!O'Sa!W'Sa(v'Sa!U'SaQ'Sa!d'Sa~OPmOa%QOl:zO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)YXO)hcO)idO]'Sa!V'Sa!X'Sa(w'Sa(x'Sa~P!B_O!T$WO!O(sP~P!(zO]nX]%WXdnXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!TnX!VnX!V%WX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!e%WX!f%WX!gmX!h%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX(u%WX(w%WX(x%WX)SnX)S%WX)T%WX)UnX)U%WX)VnX)V%WX)W%WX)X%WX)jmX!O%WX~O)WnX!OnX!U%WX~P!E{O])dO!V)eO!X)bO!g)bO%Z)bO%[)bO%])bO%^)bO%_)fO%`)fO%a)bO(x)cO)j)bO)x)gO~P8zOPmO]$eOa%QOl:zO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O!V)lO~P!JwOd)oO%Y)pO(y$OO~O!T$WO!V)rO(w)sO!U)rP~P!JwO!T$WO~P!(zO)[)zO~Ol){O]!QX!h!QX)X!QX)]!QX~O])}O!h*OO)X)QX)])QX~O)X*SO)]*RO~Od$RO%Y*TO'[$TO'_$UO(y$OO~Ol*UO~Ol*UO!O(}X~P.ZOl*UO!g$YO)j$YO~O)W*VO~P:nOPmO]$eOa!]Ol$_Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)X!ZO)YXO)hcO)idO~Op&fO~P!&zOp&fO!W(tX(v(tXQ(tX!d(tX~PNkO]'nO!V'oO!X'lO!g'lO%Z'lO%['lO%]'lO%^'lO%_'pO%`'pO%a'lO(x'mO)j'lO)x'qO~O]iXdiXlgXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX!TiX!hiX)XiX)jiX!OiX~O!liX(viX)WiX!XiX!YiX![iX!^iX!_iX!aiX!biX!ciX!eiX!fiX(uiX(wiX(xiX)TiX!giX!WiXQiX!diX!UiX#viX#TiX#ViX#piXaiX{iX!oiX#aiX#biX#iiX#tiX${iX%ciX%eiX%kiX%liX%oiX&miX)PiX~P#%yO(y*ZO~Ol*[O~O](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)W(}X!T(}X!X(}X!Y(}X![(}X!^(}X!_(}X!a(}X!b(}X!c(}X!e(}X!f(}X!h(}X(u(}X(w(}X(x(}X)T(}X)X(}X!g(}X)j(}X!O(}X!W(}XQ(}X!d(}X(v(}X!U(}X#v(}X~Ol*[O~P#+ROr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO])aad)aal)aa!V)aa!{)aa%v)aa(r)aa)S)aa)U)aa)V)aaQ)aa!d)aa!h)aa)X)aa)j)aa!O)aa!T)aa(v)aa)W)aa~O&r#WO&s$wO~P#.qOp&fOl(}X~P#+RO&r)aa~P#.qO]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(uZX(wZX(xZX)SZX)TZX)UZX)VZX)WZX)XZX)jZX!OZX~O!WZX(vZX!UZXQZX!dZX~P#1jO]#}O!V#lO!X#{O(w#kO(x#kO~O!Y&xa![&xa!^&xa!_&xa!a&xa!b&xa!c&xa!e&xa!f&xa!g&xa!h&xa(u&xa)S&xa)T&xa)U&xa)V&xa)W&xa)X&xa)j&xa!O&xa!W&xa(v&xa!U&xaQ&xa!d&xa~P#3zOl;hO!T$WO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PKkOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PKkO]&cO!V&bO!O#Qa!T#Qa!h#Qa#v#Qa)W#Qa)j#QaQ#Qa!d#Qa(v#Qa~Op&fO!T$WO~O!O*cO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O*cO~O]&cO!O*eO!V&bO~O]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO&r#WO&s$wO)S&VO)U&ZO)V&ZO~O!OqXQqX!dqX!hqX)XqX)WqX~P#9{O!O*hO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!W)kX~P#3zO!W*kO!h*lO~O!W*kO!h*lO~P!(zO!W*kO~Op&fO!g$YO!h*mO)j$YO](tX!V(tX!W(tX!W*OX!X(tX!Y(tX![(tX!^(tX!_(tX!a(tX!b(tX!c(tX!e(tX!f(tX(u(tX(w(tX(x(tX)S(tX)T(tX)U(tX)V(tX)X(tX~O!h(tX~P#=ZO!W*oO~Od$RO%Y*TO(y:rO~Ol;kO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!|%RO~PBUO]*vO!T*qO!V&bO!h*tO#v!eO)j*rO)W)qX~O!h*tO)W)qX~O)W*wO~Op&fO])eX!T)eX!V)eX!h)eX#v)eX)W)eX)j)eX!O)eXQ)eX!d)eX(v)eX~Op&fO~OP%oO(oQO]%ha!V%ha!X%ha!Y%ha![%ha!^%ha!_%ha!a%ha!b%ha!c%ha!e%ha!f%ha!h%ha(r%ha(u%ha(w%ha(x%ha)S%ha)T%ha)U%ha)V%ha)W%ha)X%ha!g%ha)j%ha!O%ha!W%ha(v%ha!U%haQ%ha!d%ha~Od$RO%Y$SO(y:oO~Ol:wO~O!TxO#v!eO)j%|O~Ol<[O&r#WO(r;gO~O$Z+TO%`+UO~O!TxO#v!eO)W+VO)j+WO~OPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO$Z+TO%_#ZO%`+YO%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O!U+ZO~P!QOa!TOl$oOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#a+aO#b+bO#i+cO%e#UO%l#SO&m!RO&r#WO&s!TO(r$nO)PYO~OQ)lP!d)lP~P#GgO]&YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V&WO)S&VO)U&ZO)V&ZO~O!O#kX!T#kX#v#kX)W#kX)j#kXQ#kX!d#kX!h#kX)X#kX!x#kX(v#kX~P#IkOPmO]$eOa%QOl:zOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!W+iO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S+jO)V$kO)X!ZO)YXO)hcO)idO~O]&cO!V+kO~O]&YO!V&WO)PYO)S&VO)U&ZO)V&ZO)X+nO!O)dP~P8zO]&YO!V&WO)S&VO)U&ZO)V&ZO~O!O#nX!T#nX#v#nX)W#nX)j#nXQ#nX!d#nX!h#nX)X#nX!x#nX(v#nX~P#NeO!TxO])nX!V)nX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O#T+vO#p+wO(x+tO)U+rO)V+rO~O]#jX!T#jX!V#jX!O#jX#v#jX)W#jX)j#jXQ#jX!d#jX!h#jX)X#jX!x#jX(v#jX~P$ xO#V+yO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+zO#T+vO#V+yO#p+wO(x+tO)U+zO)V+zO])fP!T)fP!V)fP#v)fP(v)fP)j)fP!O)fP!h)fP)W)fP~O!x)fPQ)fP!d)fP~P$#uOPmO]$eOa%QOl:zOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)V$kO)X!ZO)YXO)hcO)idO~O!W,QO)S,RO~P$%pO)PYO)X+nO!O)dP~P8zO]&cO!V&bO!O&Za!T&Za!h&Za#v&Za)W&Za)j&ZaQ&Za!d&Za(v&Za~OPmO]$eOa!]Ol:|Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;RO)S$kO)V$kO)X!ZO)YXO)hcO)idO~OQ(zP!d(zP~P$)YO]#}O!V#lO(w#kO(x#kO!X'Pa!Y'Pa!['Pa!^'Pa!_'Pa!a'Pa!b'Pa!c'Pa!e'Pa!f'Pa!h'Pa(u'Pa)S'Pa)T'Pa)U'Pa)V'Pa)W'Pa)X'Pa!g'Pa)j'Pa!O'Pa!W'Pa(v'Pa!U'PaQ'Pa!d'Pa~O]#}O!V#lO!X#{O(w#kO(x#kO~P!B_O!TxO#t!fO)PYO~P8zO!TxO(r%nO)j,[O~O#x,aO~OQ)aX!d)aX!h)aX)X)aX)j)aX!O)aX!T)aX(v)aX)W)aX~P:nO(v,eO(w,cO)P$UX)W$UX~O(r,fO~O)PYO)W,iO~OPmO]$eOa!]Ol:{Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O(r;SO~P$0kOPmO]$eOa%QOl:zO!TxO!V$fO!X!XO!Y!WO!i!YO#V#QO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:mO)PYO)S$kO)V$kO)WiO)X!ZO)YXO)hcO)idO~O$h,sO~OPmO]$eOa!]Ol:{Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!V$fO!X!XO!Y!WO!i!YO!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO#V#QO#a#VO#b#TO$}!uO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)S$kO)V$kO)X!ZO)YXO)hcO)idO~O${,yO(r:}O)W,wO~P$7UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W,{O)X#|O~P#3zO)W,{O~O)W,|O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W,}O)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W-OO)X#|O~P#3zOp&fO)PYO)j-QO~O)W-RO~Ol;^O(r;PO~O]-YO!{!dO&r#WO&s$wO(r-UO)S-VO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO(v-]O)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xa!o$Xa!{$Xa#i$Xa#p$Xa#t$Xa#v$Xa$R$Xa$T$Xa$Y$Xa$Z$Xa${$Xa%U$Xa%c$Xa%g$Xa%o$Xa%|$Xa(k$Xa)U$Xa!U$Xa$c$Xa~P$0kO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W-cO)X#|O~P#3zOl-eO!TxO)j,[O~O)j-gO~O]&]a!X&]a!Y&]a![&]a!^&]a!_&]a!a&]a!b&]a!c&]a!e&]a!f&]a!h&]a(u&]a(w&]a(x&]a)T&]a)U&]a)V&]a)W&]a)X&]a!g&]a)j&]a!O&]a!W&]a!T&]a#v&]a(v&]a!U&]aQ&]a!d&]a~O)S-kO!V&]a~P$DbO!O-kO~O!W-kO~O!V-lO)S&]a~P$DbO](}Xd(}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!V(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X~Ol;mO~P$GQO]&cO!V&bO)W-mO~Ol;cO!o-pO#V+yO#i-uO#t!fO${,yO%c!zO%k-tO%o!|O%v!}O(r;TO)PYO~P!8jO!n-yO(r,fO~O)PYO)W-{O~OPmO]$eOa%QOl:zO!T.QO!V$fO!X!XO!Y!WO!i!YO#V.XO#a.WO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO(x.PO)S$kO)V$kO)W-}O)X!ZO)YXO)hcO)idO~O!U.VO~P$JbO])^Xd)^Xr)^Xs)^Xt)^Xu)^Xv)^Xw)^Xx)^Xy)^X})^X!T)^X!V)^X!l)^X!r)^X!s)^X!t)^X!u)^X!v)^X!x)^X!{)^X%v)^X&r)^X&s)^X(r)^X(v)^X)S)^X)U)^X)V)^X)W)^X!O)^X!h)^X)X)^X!X)^X!Y)^X![)^X!^)^X!_)^X!a)^X!b)^X!c)^X!e)^X!f)^X(u)^X(w)^X(x)^X)T)^X!g)^X)j)^X!W)^XQ)^X!d)^X#T)^X#V)^X#p)^X#v)^Xa)^X{)^X!o)^X#a)^X#b)^X#i)^X#t)^X${)^X%c)^X%e)^X%k)^X%l)^X%o)^X&m)^X)P)^X!U)^X~Ol*[O~P$LlOl$oO!T(QO!l.^O(r$nO(v(PO)PYO~Op&fOl)^X~P$LlOl$oO!n.cO!o.cO(r$nO)PYO~Ol;dO!U.nO!n.pO!o.oO#i-uO${!tO$}!uO%g!{O%k-tO%o!|O%v!}O(r;VO)PYO~P!8jO!T(QO!l.^O(v(PO])OXd)OXl)OXr)OXs)OXt)OXu)OXv)OXw)OXx)OXy)OX})OX!V)OX!r)OX!s)OX!t)OX!u)OX!v)OX!x)OX!{)OX%v)OX&r)OX&s)OX(r)OX)S)OX)U)OX)V)OX~O)W)OX!O)OX!X)OX!Y)OX![)OX!^)OX!_)OX!a)OX!b)OX!c)OX!e)OX!f)OX!h)OX(u)OX(w)OX(x)OX)T)OX)X)OX!g)OX)j)OX!W)OXQ)OX!d)OX!U)OX#v)OX~P%%eO!T(QO~O!T(QO(v(PO~O(r%nO!U*QP~O!T(ZO(v.uO]&kad&kal&kar&kas&kat&kau&kav&kaw&kax&kay&ka}&ka!V&ka!r&ka!s&ka!t&ka!u&ka!v&ka!x&ka!{&ka%v&ka&r&ka&s&ka(r&ka)S&ka)U&ka)V&ka)W&ka!O&ka!X&ka!Y&ka![&ka!^&ka!_&ka!a&ka!b&ka!c&ka!e&ka!f&ka!h&ka(u&ka(w&ka(x&ka)T&ka)X&ka!g&ka)j&ka!W&kaQ&ka!d&ka!U&ka#v&ka~Ol$oO!T(ZO(r$nO~O&r#WO&s$wO]&pad&pal&par&pas&pat&pau&pav&paw&pax&pay&pa}&pa!V&pa!r&pa!s&pa!t&pa!u&pa!v&pa!x&pa!{&pa%v&pa(r&pa)S&pa)U&pa)V&pa)W&pa!O&pa!T&pa!X&pa!Y&pa![&pa!^&pa!_&pa!a&pa!b&pa!c&pa!e&pa!f&pa!h&pa(u&pa(w&pa(x&pa)T&pa)X&pa!g&pa)j&pa!W&paQ&pa!d&pa(v&pa!U&pa#v&pa~O&s.zO~P!(zO!Y#qO![#rO!f#zO)S#mO!^'Ua!_'Ua!a'Ua!b'Ua!c'Ua!e'Ua!h'Ua(u'Ua)T'Ua)U'Ua)V'Ua)W'Ua)X'Ua!g'Ua)j'Ua!O'Ua!W'Ua(v'Ua!U'UaQ'Ua!d'Ua~P#3zO!V'dX!X'dX!Y'dX!['dX!^'dX!_'dX!a'dX!b'dX!c'dX!e'dX!f'dX!h'dX(u'dX(w'dX(x'dX)S'dX)T'dX)U'dX)V'dX)X'dX!O'dX~O].|O)W'dX!g'dX)j'dX!W'dX(v'dX!U'dXQ'dX!d'dX~P%2xO!Y#qO![#rO!f#zO)S#mO!^'Wa!_'Wa!a'Wa!b'Wa!c'Wa!e'Wa!h'Wa(u'Wa)T'Wa)U'Wa)V'Wa)W'Wa)X'Wa!g'Wa)j'Wa!O'Wa!W'Wa(v'Wa!U'WaQ'Wa!d'Wa~P#3zO]#}O!T$WO!V.}O&r#WO&s$wO~O!X'Za!Y'Za!['Za!^'Za!_'Za!a'Za!b'Za!c'Za!e'Za!f'Za!h'Za(u'Za(w'Za(x'Za)S'Za)T'Za)U'Za)V'Za)W'Za)X'Za!g'Za)j'Za!O'Za!W'Za(v'Za!U'ZaQ'Za!d'Za~P%6oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^a)W'^a!g'^a)j'^a!O'^a!W'^a(v'^a!U'^aQ'^a!d'^a~P#3zOPmO]$eOa%QOl:zO!V$fO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)S$kO)V%]O)X!ZO)YXO)hcO)idO)j%[O~O!W/QO~P%:oOS(qOT(nO]#}O*W(pO~O]/TO'f/UO*W/RO~OS/YOT(nO*W/XO~O]#}O~Q'na!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO(v/[O)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W#Zi!O#Zi~P#3zO]cXlgXpcXpiX!VcX!XcX!YcX![cX!^cX!_cX!acX!bcX!ccX!ecX!fcX!gcX!hcX(ucX(wcX(xcX)ScX)TcX)UcX)VcX)WcX)XcX)jcX!OcX!WcX(vcX!TcX#vcX!UcXQcX!dcX~Od/^O%Y*TO(y/]O~Ol/_O~Ol/`O~Op&fO]bi!Vbi!Xbi!Ybi![bi!^bi!_bi!abi!bbi!cbi!ebi!fbi!gbi!hbi(ubi(wbi(xbi)Sbi)Tbi)Ubi)Vbi)Wbi)Xbi)jbi!Obi!Wbi(vbi!UbiQbi!dbi~O!W/bO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO![#rO)S#mO!Y&zi!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y&zi![&zi!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)S&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)U#nO)V#pO!h&zi(u&zi)T&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!^&zi!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)V#pO!^&zi!_&zi!h&zi(u&zi)T&zi)U&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO!^&zi!_&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!b#yO!c#yO!e#yO!f#zO)S#mO!^&zi!_&zi!a&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!f#zO)S#mO!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO)S#mO!^&zi!_&zi!a&zi!b&zi!c&zi!e&zi!f&zi!h&zi(u&zi)T&zi)U&zi)V&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)T#oO)U#nO)V#pO!h&zi(u&zi)W&zi)X&zi!g&zi)j&zi!O&zi!W&zi(v&zi!U&ziQ&zi!d&zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/cO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O(sX~P#3zO!h/cO!O(sX~O!O/eO~O]%Xap%Xa!X%Xa!Y%Xa![%Xa!^%Xa!_%Xa!a%Xa!b%Xa!c%Xa!e%Xa!f%Xa!h%Xa(u%Xa(w%Xa(x%Xa)T%Xa)U%Xa)V%Xa)W%Xa)X%Xa!g%Xa)j%Xa!O%Xa!W%Xa!T%Xa#v%Xa(v%Xa!U%XaQ%Xa!d%Xa~O)S/fO!V%Xa~P&,aO!O/fO~O!W/fO~O!V/gO)S%Xa~P&,aO!X'Zi!Y'Zi!['Zi!^'Zi!_'Zi!a'Zi!b'Zi!c'Zi!e'Zi!f'Zi!h'Zi(u'Zi(w'Zi(x'Zi)S'Zi)T'Zi)U'Zi)V'Zi)W'Zi)X'Zi!g'Zi)j'Zi!O'Zi!W'Zi(v'Zi!U'ZiQ'Zi!d'Zi~P%6oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^i)W'^i!g'^i)j'^i!O'^i!W'^i(v'^i!U'^iQ'^i!d'^i~P#3zO!W/lO~P%:oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h/nO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U)rX~P#3zO(r/qO~O!V/sO(w)sO)j/uO~O!h/nO!U)rX~O!U/vO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO)S#mO)T#oO)U#nO)V#pO)X#|O!h_i(u_i)W_i!g_i)j_i!O_i!W_i(v_i!U_iQ_i!d_i~P#3zO!R/wO~Ol){O]!Qa!h!Qa)X!Qa)]!Qa~OP0PO]0OOl0PO!R0PO!T/|O!V/}O!X0PO!Y0PO![0PO!^0PO!_0PO!a0PO!b0PO!c0PO!e0PO!f0PO!g0PO!h0PO!i0PO(oQO(v0PO(w0PO(x0PO)S/yO)T/zO)U/zO)V/{O)W0PO)X0PO)YXO~O!O0SO~P&6yO!R$[O~O!h*OO)X)Qa)])Qa~O)]0WO~O])dO!V)eO!X)bO!g)bO%Z)bO%[)bO%])bO%^)bO%_)fO%`)fO%a)bO(x)cO)j)bO)x)gO~Od)oO%Y*TO(y$OO~O)W0YO~O]nXdnXlmXpnXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX!TnX!hnX)XnX!OnXQnX!dnX~O!lnX(vnX)WnX!XnX!YnX![nX!^nX!_nX!anX!bnX!cnX!enX!fnX(unX(wnX(xnX)TnX!gnX)jnX!WnX!UnX#vnX#TnX#VnX#pnXanX{nX!onX#anX#bnX#inX#tnX${nX%cnX%enX%knX%lnX%onX&mnX)PnX~P&:uOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O}!_O!r!aO!s!aO!t!aO!u!aO!v!aO!x!cO~O])aid)ail)ai!V)ai!{)ai%v)ai(r)ai)S)ai)U)ai)V)aiQ)ai!d)ai!h)ai)X)ai)j)ai!O)ai!T)ai&r)ai(v)ai)W)ai~P&?sO]&cO!V&bO!O#Qi!T#Qi!h#Qi#v#Qi)W#Qi)j#QiQ#Qi!d#Qi(v#Qi~O!OqaQqa!dqa!hqa)Xqa)Wqa~P#9{O!OqaQqa!dqa!hqa)Xqa)Wqa~P#IkO]&cO!V+kO!OqaQqa!dqa!hqa)Xqa)Wqa~O!h*iO!W)ka~O!h*mO!W*Oa~OPmOa!]Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O{#RO}!_O!X!XO!Y!WO!i!YO!s!aO!t!aO!v!aO!x!cO#V#QO#a#VO#b#TO#v!eO$Y!vO$Z!wO$`!iO$e!jO$g!kO$h!lO$k!mO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO%_#ZO%`#[O%a#YO%e#UO%l#SO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO)PYO)WiO)X!ZO)YXO)hcO)idO~O]eOd!POlTO!T*qO!U&TO!V0hO!opO!r!`O!u!bO!{!dO#i#OO#p!xO#t!fO$R!gO$T!hO${!tO$}!uO%U!yO%c!zO%g!{O%o!|O%v!}O%|#PO(rRO(w)sO)SaO)U|O)V{O~P&DuO!h*tO)W)qa~OPmO]$eOa!]Ol:|O{#RO!T$WO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;UO)PYO)S$kO)V$kO)X0nO)YXO)hcO)idO!O(sP!O)dP~P&?sO!h*mO!W*OX~O]#}O!T$WO~O!h0sO!T)zX#v)zX)j)zX~O)W0uO~O)W0vO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W0xO)X#|O~P#3zO)W0vO~P!?WO]1SOd!POl%bO!V1QO!{!dO%v$mO(r$xO)S0zO)X0}O~O)U1OO)V1OO)j0{OQ#PX!d#PX!h#PX!O#PX~P' dO!h1TOQ)lX!d)lX~OQ1VO!d1VO~O)X1YO)j1XOQ#`X!d#`X!h#`X~P!<[O)X1YO)j1XOQ#`X!d#`X!h#`X~P!;bOp&UO~O!O#ka!T#ka#v#ka)W#ka)j#kaQ#ka!d#ka!h#ka)X#ka!x#ka(v#ka~P#IkO]&cO!V+kO!O#ka!T#ka#v#ka)W#ka)j#kaQ#ka!d#ka!h#ka)X#ka!x#ka(v#ka~O!W1_O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W1_O)S1aO~P$%pO!W1_O~P!(zO]#ja!T#ja!V#ja!O#ja#v#ja)W#ja)j#jaQ#ja!d#ja!h#ja)X#ja!x#ja(v#ja~P$ xO]&cO!O1eO!V+kO~O!h1fO!O)dX~O!O1hO~O]&cO!V+kO!O#na!T#na#v#na)W#na)j#naQ#na!d#na!h#na)X#na!x#na(v#na~O]1lOr#SXs#SXt#SXu#SXv#SXw#SXx#SXy#SX!T#SX!V#SX#T#SX#p#SX(x#SX)U#SX)V#SX!l#SX!x#SX#V#SX#v#SX(v#SX)j#SX!O#SX!h#SX)W#SXQ#SX!d#SX)X#SX~O]1mO~O]1pOl$oO!V$fO#V#QO(r$nO)hcO)idO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!l+zO#T+vO#V+yO#p+wO(x+tO)U+zO)V+zO~O])fX!T)fX!V)fX!x)fX#v)fX(v)fX)j)fX!O)fX!h)fX)W)fXQ)fX!d)fX~P'+}O!x!cO]#Ri!T#Ri!V#Ri#v#Ri(v#Ri)j#Ri!O#Ri!h#Ri)W#RiQ#Ri!d#Ri~O!W1xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W1xO)S1zO~P$%pO!W1xO~P!(zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ*RX!d*RX!h*RX~P#3zO)X1{OQ({X!d({X!h({X~O!h1|OQ(zX!d(zX~OQ2OO!d2OO~O!O2PO~O#t$lO)PYO~P8zOl-eO!TxO)j2TO~O!O2UO~O#x,aOP#ui]#uia#uid#uil#uir#uis#uit#uiu#uiv#uiw#uix#uiy#ui{#ui}#ui!T#ui!V#ui!X#ui!Y#ui!i#ui!o#ui!r#ui!s#ui!t#ui!u#ui!v#ui!x#ui!{#ui#V#ui#a#ui#b#ui#i#ui#p#ui#t#ui#v#ui$R#ui$T#ui$Y#ui$Z#ui$`#ui$e#ui$g#ui$h#ui$k#ui$m#ui$o#ui$q#ui$s#ui$u#ui$w#ui${#ui$}#ui%U#ui%_#ui%`#ui%a#ui%c#ui%e#ui%g#ui%l#ui%o#ui%v#ui%|#ui&m#ui&r#ui&s#ui'Q#ui'R#ui'V#ui'Y#ui'a#ui'b#ui(k#ui(o#ui(r#ui)P#ui)S#ui)U#ui)V#ui)W#ui)X#ui)Y#ui)h#ui)i#ui!U#ui$c#ui!n#ui%k#ui~O]&cO~O]&cO!TxO!V&bO#v!eO~O(v2ZO(w,cO)P$Ua)W$Ua~O)PYO)W2]O~O!O2^O~P,]O!O2^O)W#jO~O!O2^O~O$c2cOP$_i]$_ia$_id$_il$_ir$_is$_it$_iu$_iv$_iw$_ix$_iy$_i{$_i}$_i!T$_i!V$_i!X$_i!Y$_i!i$_i!o$_i!r$_i!s$_i!t$_i!u$_i!v$_i!x$_i!{$_i#V$_i#a$_i#b$_i#i$_i#p$_i#t$_i#v$_i$R$_i$T$_i$Y$_i$Z$_i$`$_i$e$_i$g$_i$h$_i$k$_i$m$_i$o$_i$q$_i$s$_i$u$_i$w$_i${$_i$}$_i%U$_i%_$_i%`$_i%a$_i%c$_i%e$_i%g$_i%l$_i%o$_i%v$_i%|$_i&m$_i&r$_i&s$_i'Q$_i'R$_i'V$_i'Y$_i'a$_i'b$_i(k$_i(o$_i(r$_i)P$_i)S$_i)U$_i)V$_i)W$_i)X$_i)Y$_i)h$_i)i$_i!U$_i~O]1pO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W2fO)X#|O~P#3zOPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)W2iO)X!ZO)YXO)hcO)idO~P&?sO)W2fO~O(r-UO~O)PYO)j2lO~O)W2nO~O]-YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO(r-UO)S-VO~O)S2sO~O]&cO!V2uO!h2vO)W)uX~O]-YO!{!dO(r-UO)S-VO~O)W2yO~O!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xi!o$Xi!{$Xi#i$Xi#p$Xi#t$Xi#v$Xi$R$Xi$T$Xi$Y$Xi$Z$Xi${$Xi%U$Xi%c$Xi%g$Xi%o$Xi%|$Xi(k$Xi)U$Xi!U$Xi$c$Xi~P$0kOl:{O(r:nO~P0zO]2}O~O)W2SO~O!u3PO(r%nO~O!O3SO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h3TO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O3UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO]&cO!V+kO!T%ui#v%ui)W%ui)j%ui~O!W3VO~Ol:yO)W(}X~P$GQOa!TOl$oO{3]O#a#VO#b3[O#t!fO%e#UO%l3^O&m!RO&r#WO&s!TO(r$nO)PYO~P&?sOl;cO!o-pO#i-uO#t!fO${,yO%c!zO%k-tO%o!|O%v!}O(r;TO)PYO~P!8jO]&cO!V&bO)W3`O~O)W3aO~O)PYO)W3aO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W3bO)X#|O~P#3zO)W3bO~O)W3eO~O!U3gO~P$JbOl$oO(r$nO~O]3iO!T'yO~P'+iO!T(QO!l3lO(v(PO])Oad)Oal)Oar)Oas)Oat)Oau)Oav)Oaw)Oax)Oay)Oa})Oa!V)Oa!r)Oa!s)Oa!t)Oa!u)Oa!v)Oa!x)Oa!{)Oa%v)Oa&r)Oa&s)Oa(r)Oa)S)Oa)U)Oa)V)Oa)W)Oa!O)Oa!X)Oa!Y)Oa![)Oa!^)Oa!_)Oa!a)Oa!b)Oa!c)Oa!e)Oa!f)Oa!h)Oa(u)Oa(w)Oa(x)Oa)T)Oa)X)Oa!g)Oa)j)Oa!W)OaQ)Oa!d)Oa!U)Oa#v)Oa~Ol$oO!n.cO!o.cO(r$nO~O!h3pO)X3rO!T)_X~O!o3tO)PYO~P8zO)W3uO~PGVO]3zOl({O!T$WO!{!dO%v$mO&r#WO(r(zO(v4OO)S3wO)U3{O)V3{O~O)W4PO)j4RO~P(&eOl;dO!U4TO!n.pO!o.oO#i-uO${!tO$}!uO%g!{O%k-tO%o!|O%v!}O(r;VO)PYO~P!8jOl;dO%v!}O(r;VO~P!8jO(v4UO~Ol$oO!T(QO(r$nO(v(PO)PYO~O!l3lO~P((sO)j4WO!U&oX!h&oX~O!h4XO!U*QX~O!U4ZO~Oa4]Ol$oO&m!RO(r$nO~O!T(ZO]&kid&kil&kir&kis&kit&kiu&kiv&kiw&kix&kiy&ki}&ki!V&ki!r&ki!s&ki!t&ki!u&ki!v&ki!x&ki!{&ki%v&ki&r&ki&s&ki(r&ki)S&ki)U&ki)V&ki)W&ki!O&ki!X&ki!Y&ki![&ki!^&ki!_&ki!a&ki!b&ki!c&ki!e&ki!f&ki!h&ki(u&ki(w&ki(x&ki)T&ki)X&ki!g&ki)j&ki!W&kiQ&ki!d&ki!U&ki#v&ki~O(v&ki~P(*TO(v.uO~P(*TO!O4`O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O4`O~O!O4aO~O]#}O!T$WO!V'Zi!X'Zi!Y'Zi!['Zi!^'Zi!_'Zi!a'Zi!b'Zi!c'Zi!e'Zi!f'Zi!h'Zi(u'Zi(w'Zi(x'Zi)S'Zi)T'Zi)U'Zi)V'Zi)W'Zi)X'Zi!g'Zi)j'Zi!O'Zi!W'Zi(v'Zi!U'ZiQ'Zi!d'Zi~OPmOa%QOl:zO!X!XO!Y!WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)X!ZO)YXO)hcO)idO]#]ap#]a!T#]a!V#]a)S#]a)U#]a)V#]a~O(r%nO)X4fO!O*YP~O*W4eO~O'f4hO*W4eO~O*W4iO~OlmXpnXp&wX~Od4kO%Y*TO(y/]O~Od4kO%Y*TO(y4lO~O!h/cO!O(sa~O!W4pO~O]&cO!V+kO!T%uq#v%uq)W%uq)j%uq~O]#}O!T$WO!X'Zq!Y'Zq!['Zq!^'Zq!_'Zq!a'Zq!b'Zq!c'Zq!e'Zq!f'Zq!h'Zq(u'Zq(w'Zq(x'Zq)S'Zq)T'Zq)U'Zq)V'Zq)W'Zq)X'Zq!g'Zq)j'Zq!O'Zq!W'Zq(v'Zq!U'ZqQ'Zq!d'Zq~O!V'Zq~P(5bO!V.}O&r#WO&s$wO~P(5bO!T$WO!V)rO(w)sO!U(UX!h(UX~P!JwO!h/nO!U)ra~O!W4xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h*iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!U4|O~P&6yO!W4|O~P&6yO!O4|O~P&6yO!O5RO~P&6yO]5SO!h'ua)X'ua)]'ua~O!h*OO)X)Qi)])Qi~O]&cO!V&bO!O#Qq!T#Qq!h#Qq#v#Qq)W#Qq)j#QqQ#Qq!d#Qq(v#Qq~O!OqiQqi!dqi!hqi)Xqi)Wqi~P#IkO]&cO!V+kO!OqiQqi!dqi!hqi)Xqi)Wqi~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'Tq)W'Tq!g'Tq)j'Tq!O'Tq!W'Tq(v'Tq!U'TqQ'Tq!d'Tq~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!W'|a!h'|a~P#3zO!W5XO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h5YO(u#gO)S#mO)T#oO)U#nO)V#pO)W#jO)X#|O!U)rX~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h#{i)W#{i~P#3zO]*vO!T$WO!V&bO)j*rO!h(Va)W(Va~O!h1fO]'dX!O)dX~P%2xO)X5[O!T%qa!h%qa#v%qa)j%qa~O!h0sO!T)za#v)za)j)za~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W5_O)X#|O~P#3zO]1SOd!POl;[O!V1QO!{!dO%v$mO(r$xO)S;xO)U5aO)V5aO~OQ#Pa!d#Pa!h#Pa!O#Pa~P(DjO]1SOd!POr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V1QO!{!dO!|%RO%v$mO(r$xOQ#kX!d#kX!h#kX!O#kX~Ol%bO)S0zO)U;yO)V;yO~P(ElO]&cOQ#Pa!d#Pa!h#Pa!O#Pa~O!V&bO)j5eO~P(GZO(r%nOQ#dX!d#dX!h#dX!O#dX~O)U;yO)V;yOQ#nX!d#nX!h#nX!O#nX~P' dO!V+kO~P(GZO]1SOa!TOd!POl;]O{#RO!V1QO!{!dO#a#VO#b#TO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO(r;QO)PYO)S;xO)U5aO)V5aO)X+nO!O)dP~P&?sO!h1TOQ)la!d)la~Op&fO)j5jOQ#`al(}X!d#`a!h#`a)X(}X~P$GQO(r-UOQ#ga!d#ga!h#ga~Op&fO)j5jOQ#`a])^Xd)^Xl)^Xr)^Xs)^Xt)^Xu)^Xv)^Xw)^Xx)^Xy)^X})^X!T)^X!V)^X!d#`a!h#`a!l)^X!r)^X!s)^X!t)^X!u)^X!v)^X!x)^X!{)^X%v)^X&r)^X&s)^X(r)^X(v)^X)S)^X)U)^X)V)^X)X)^X~O#a5mO#b5mO~O]&cO!V+kO!O#ki!T#ki#v#ki)W#ki)j#kiQ#ki!d#ki!h#ki)X#ki!x#ki(v#ki~O!W5oO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W5oO~P!(zO!W5oO)S5qO~P$%pO]#ji!T#ji!V#ji!O#ji#v#ji)W#ji)j#jiQ#ji!d#ji!h#ji)X#ji!x#ji(v#ji~P$ xO)PYO)X5sO~P8zO!h1fO!O)da~O&r#WO&s$wO!T#qa!x#qa#v#qa(v#qa)j#qa!O#qa!h#qa)W#qaQ#qa!d#qa)X#qa~P#NeO!O5xO~P!(zO!O)oP~P!4xO)T6OO)U5|O]#Ua!T#Ua!V#Ua)S#Ua)V#Uar#Uas#Uat#Uau#Uav#Uaw#Uax#Uay#Ua!l#Ua!x#Ua#T#Ua#V#Ua#p#Ua#v#Ua(v#Ua(x#Ua)j#Uaa#Uad#Ual#Ua{#Ua}#Ua!o#Ua!r#Ua!s#Ua!t#Ua!u#Ua!v#Ua!{#Ua#a#Ua#b#Ua#i#Ua#t#Ua${#Ua%c#Ua%e#Ua%k#Ua%l#Ua%o#Ua%v#Ua&m#Ua&r#Ua&s#Ua(r#Ua)P#Ua)W#Ua!O#Ua!h#UaQ#Ua!d#Ua~O!x!cO]#Rq!T#Rq!V#Rq#v#Rq(v#Rq)j#Rq!O#Rq!h#Rq)W#RqQ#Rq!d#Rq~O!W6TO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W6TO~P!(zO!h1|OQ(za!d(za~O)W6YO~Ol-eO!TxO)j6ZO~O]*vO!T$WO!V&bO!h*tO)W)qX~O)j6_O~P)+cO!O6aO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O6aO~O$c6cOP$_q]$_qa$_qd$_ql$_qr$_qs$_qt$_qu$_qv$_qw$_qx$_qy$_q{$_q}$_q!T$_q!V$_q!X$_q!Y$_q!i$_q!o$_q!r$_q!s$_q!t$_q!u$_q!v$_q!x$_q!{$_q#V$_q#a$_q#b$_q#i$_q#p$_q#t$_q#v$_q$R$_q$T$_q$Y$_q$Z$_q$`$_q$e$_q$g$_q$h$_q$k$_q$m$_q$o$_q$q$_q$s$_q$u$_q$w$_q${$_q$}$_q%U$_q%_$_q%`$_q%a$_q%c$_q%e$_q%g$_q%l$_q%o$_q%v$_q%|$_q&m$_q&r$_q&s$_q'Q$_q'R$_q'V$_q'Y$_q'a$_q'b$_q(k$_q(o$_q(r$_q)P$_q)S$_q)U$_q)V$_q)W$_q)X$_q)Y$_q)h$_q)i$_q!U$_q~O)W6dO~OPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)S$kO)V$kO)W6fO)X!ZO)YXO)hcO)idO~P&?sO(v6hO)j*rO~P)+cO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W6fO)X#|O~P#3zO!O6jO~P!(zO)W6nO~O)W6oO~O]-YOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO(r-UO)S-VO~O]&cO!V2uO!h%Oa)W%Oa!O%Oa~O!W6uO)S6vO~P$%pO!h2vO)W)ua~O]&cO!O6yO!V2uO~O!TxO$`!iO$e!jO$g!kO$h!lO$k-bO$m!nO$o!oO$q!pO$s!qO$u!rO$w!sO$}!uO(r:nOd$Xq!o$Xq!{$Xq#i$Xq#p$Xq#t$Xq#v$Xq$R$Xq$T$Xq$Y$Xq$Z$Xq${$Xq%U$Xq%c$Xq%g$Xq%o$Xq%|$Xq(k$Xq)U$Xq!U$Xq$c$Xq~P$0kOPmO]$eOa!]Ol:{O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r:}O)PYO)S$kO)V$kO)W6{O)X!ZO)YXO)hcO)idO~P&?sO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W7OO)X#|O~P#3zO)W7PO~OP7QO(oQO~Ol*[O)W)^X~P$GQOp&fOl(}X)W)^X~P$GQO)W7SO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W&Sa~P#3zO!U7UO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO)W7VO~OPmO]$eOa!]Ol:|O{#RO!V$fO!X!XO!Y!WO!i!YO#V#QO#a#VO#b#TO%_#ZO%`#[O%a#YO%e#UO%l#SO%v$mO&m!RO&r#WO&s!TO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r;UO)PYO)S$kO)V$kO)X0nO)YXO)hcO)idO!O)dP~P&?sO!h3pO)X7ZO!T)_a~O!h3pO!T)_a~O)W7`O)j7bO~P(&eO)W7dO~PGVO]3zOl({Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!{!dO!|%RO%v$mO&r#WO(r(zO)S3wO)U3{O)V3{O~O)S7hO~O]&cO!T*qO!V7jO!h7kO#v!eO(v4OO~O)W7`O)j7mO~P)FwO]3zOl({O!{!dO%v$mO&r#WO(r(zO)S3wO)U3{O)V3{O~Op&fO])cX!T)cX!V)cX!h)cX#v)cX(v)cX)W)cX)j)cX!O)cX~O)W7`O~O!T(QO!l7sO(v(PO])Oid)Oil)Oir)Ois)Oit)Oiu)Oiv)Oiw)Oix)Oiy)Oi})Oi!V)Oi!r)Oi!s)Oi!t)Oi!u)Oi!v)Oi!x)Oi!{)Oi%v)Oi&r)Oi&s)Oi(r)Oi)S)Oi)U)Oi)V)Oi)W)Oi!O)Oi!X)Oi!Y)Oi![)Oi!^)Oi!_)Oi!a)Oi!b)Oi!c)Oi!e)Oi!f)Oi!h)Oi(u)Oi(w)Oi(x)Oi)T)Oi)X)Oi!g)Oi)j)Oi!W)OiQ)Oi!d)Oi!U)Oi#v)Oi~O(r%nO!U(fX!h(fX~O!h4XO!U*Qa~Op&fO]*Pad*Pal*Par*Pas*Pat*Pau*Pav*Paw*Pax*Pay*Pa}*Pa!T*Pa!V*Pa!r*Pa!s*Pa!t*Pa!u*Pa!v*Pa!x*Pa!{*Pa%v*Pa&r*Pa&s*Pa(r*Pa)S*Pa)U*Pa)V*Pa)W*Pa!O*Pa!X*Pa!Y*Pa![*Pa!^*Pa!_*Pa!a*Pa!b*Pa!c*Pa!e*Pa!f*Pa!h*Pa(u*Pa(w*Pa(x*Pa)T*Pa)X*Pa!g*Pa)j*Pa!W*PaQ*Pa!d*Pa(v*Pa!U*Pa#v*Pa~O!T(ZO]&kqd&kql&kqr&kqs&kqt&kqu&kqv&kqw&kqx&kqy&kq}&kq!V&kq!r&kq!s&kq!t&kq!u&kq!v&kq!x&kq!{&kq%v&kq&r&kq&s&kq(r&kq)S&kq)U&kq)V&kq)W&kq!O&kq!X&kq!Y&kq![&kq!^&kq!_&kq!a&kq!b&kq!c&kq!e&kq!f&kq!h&kq(u&kq(w&kq(x&kq)T&kq)X&kq!g&kq)j&kq!W&kqQ&kq!d&kq(v&kq!U&kq#v&kq~OPmOa%QOl:zO!T$WO!i!YO#V#QO%_#ZO%`#[O%a#YO%v$mO'Q!WO'R!WO'V#XO'Y![O'a![O'b![O(oQO(r$xO)YXO)hcO)idO~O]*Ui!V*Ui!X*Ui!Y*Ui![*Ui!^*Ui!_*Ui!a*Ui!b*Ui!c*Ui!e*Ui!f*Ui!h*Ui(u*Ui(w*Ui(x*Ui)S*Ui)T*Ui)U*Ui)V*Ui)W*Ui)X*Ui!g*Ui)j*Ui!O*Ui!W*Ui(v*Ui!U*UiQ*Ui!d*Ui~P*&WO!O7xO~O!W7yO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^q)W'^q!g'^q)j'^q!O'^q!W'^q(v'^q!U'^qQ'^q!d'^q~P#3zO!h7zO!O*YX~O!O7|O~O*W7}O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h^y)W^y!g^y)j^y!O^y!W^y(v^y!U^yQ^y!d^y~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O(ha!h(ha~P#3zO]#}O!T$WO!V'Zy!X'Zy!Y'Zy!['Zy!^'Zy!_'Zy!a'Zy!b'Zy!c'Zy!e'Zy!f'Zy!h'Zy(u'Zy(w'Zy(x'Zy)S'Zy)T'Zy)U'Zy)V'Zy)W'Zy)X'Zy!g'Zy)j'Zy!O'Zy!W'Zy(v'Zy!U'ZyQ'Zy!d'Zy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!h'^y)W'^y!g'^y)j'^y!O'^y!W'^y(v'^y!U'^yQ'^y!d'^y~P#3zO]&cO!V+kO!T%uy#v%uy)W%uy)j%uy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U(Ua!h(Ua~P#3zO!W4xO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U#}i!h#}i~P#3zO!U8PO~P&6yO!W8PO~P&6yO!O8PO~P&6yO!O8RO~P&6yO]&cO!V&bO!O#Qy!T#Qy!h#Qy#v#Qy)W#Qy)j#QyQ#Qy!d#Qy(v#Qy~O]&cO!V+kO!OqqQqq!dqq!hqq)Xqq)Wqq~O]&cOQ#Pi!d#Pi!h#Pi!O#Pi~O!V+kO~P*9jOQ#nX!d#nX!h#nX!O#nX~P(DjO!V&bO~P*9jOQ(OX](OXd'qXl'qXr(OXs(OXt(OXu(OXv(OXw(OXx(OXy(OX!V(OX!d(OX!h(OX!{'qX%v'qX(r'qX)S(OX)U(OX)V(OX!O(OX~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ#_i!d#_i!h#_i!O#_i~P#3zO&r#WO&s$wOQ#fi!d#fi!h#fi~O(r-UO)X1YO)j1XOQ#`X!d#`X!h#`X~O!W8WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W8WO~P!(zO!T#qi!x#qi#v#qi(v#qi)j#qi!O#qi!h#qi)W#qiQ#qi!d#qi)X#qi~O]&cO!V+kO~P*?fO]&YO!V&WO&r#WO&s$wO)S&VO)U&ZO)V&ZO~P*?fO!O8YO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!h8ZO!O)oX~O!O8]O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ*TX!d*TX!h*TX~P#3zO)X8`OQ*SX!d*SX!h*SX~O)W8bO~O!O$bi!h#{a)W#{a~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W8eO)X#|O~P#3zO!O8gO~P!(zO!O8gO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O8gO~O]&cO!V&bO(v8mO~O)W8nO~O]&cO!V2uO!h%Oi)W%Oi!O%Oi~O!W8qO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W8qO)S8sO~P$%pO!W8qO~P!(zO]&cO!V2uO!h(Ya)W(Ya~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)W8tO)X#|O~P#3zO)W2iO~P!(zO)W8tO~OP%oO!O8uO(oQO~O!O8uO~O)W8vO~P%%eO#T8yO(x.PO)W8wO~O!h3pO!T)_i~O)X8}O!T'wa!h'wa~O)W9PO)j9RO~P)FwO)W9PO~O)W9PO)j9VO~P(&eOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P)GgO]&cO!V7jO!T!ya!h!ya#v!ya(v!ya)W!ya)j!ya!O!ya~O!W9^O)S9_O~P$%pO!T$WO!h7kO(v4OO)W9PO)j9VO~O!T$WO~P#EfO]&cO!O9bO!V7jO~O]&cO!V7jO!T&aa!h&aa#v&aa(v&aa)W&aa)j&aa!O&aa~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O)W&ba~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W9PO)X#|O~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U&oi!h&oi~P#3zO!V.}O]']i!T']i!X']i!Y']i![']i!^']i!_']i!a']i!b']i!c']i!e']i!f']i!h']i(u']i(w']i(x']i)S']i)T']i)U']i)V']i)W']i)X']i!g']i)j']i!O']i!W']i(v']i!U']iQ']i!d']i~O(r%nO)X9eO~O!h7zO!O*Ya~O!O9gO~P&6yO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!U(Ua)W#Zi~P#3zO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|OQ#_q!d#_q!h#_q!O#_q~P#3zO&r#WO&s$wOQ#fq!d#fq!h#fq~O)j5jOQ#`a!d#`a!h#`a~O]&cO!V+kO!T#qq!x#qq#v#qq(v#qq)j#qq!O#qq!h#qq)W#qqQ#qq!d#qq)X#qq~O!h8ZO!O)oa~O)U5|O]&Vi!T&Vi!V&Vi)S&Vi)T&Vi)V&Vir&Vis&Vit&Viu&Viv&Viw&Vix&Viy&Vi!l&Vi!x&Vi#T&Vi#V&Vi#p&Vi#v&Vi(v&Vi(x&Vi)j&Via&Vid&Vil&Vi{&Vi}&Vi!o&Vi!r&Vi!s&Vi!t&Vi!u&Vi!v&Vi!{&Vi#a&Vi#b&Vi#i&Vi#t&Vi${&Vi%c&Vi%e&Vi%k&Vi%l&Vi%o&Vi%v&Vi&m&Vi&r&Vi&s&Vi(r&Vi)P&Vi)W&Vi!O&Vi!h&ViQ&Vi!d&Vi~O)W9jO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O!O$bq!h#{i)W#{i~P#3zO!O9lO~P!(zO!O9lO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O9lO~O]&cO!V&bO(v9oO~O!O9pO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O9pO~O]&cO!V2uO!h%Oq)W%Oq!O%Oq~O!W9tO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W9tO~P!(zO)W6fO~P!(zO)W9uO~O)W9vO~O(x.PO)W9vO~O!h3pO!T)_q~O)X9xO!T'wi!h'wi~O!T$WO!h7kO(v4OO)W9yO)j9{O~O)W9yO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W9yO)X#|O~P#3zO)W9yO)j:OO~P)FwO]&cO!V7jO!T!yi!h!yi#v!yi(v!yi)W!yi)j!yi!O!yi~O!W:SO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W:SO)S:UO~P$%pO!W:SO~P!(zO]&cO!V7jO!T(da!h(da(v(da)W(da)j(da~O!O:WO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO!h#iO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:WO~O!O:]O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:]O~O]&cO!V2uO!h%Oy)W%Oy!O%Oy~O)W:^O~O)W:_O~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:_O)X#|O~P#3zO!T$WO!h7kO(v4OO)W:_O)j:bO~O]&cO!V7jO!T!yq!h!yq#v!yq(v!yq)W!yq)j!yq!O!yq~O!W:dO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!W:dO~P!(zO!O:fO!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)X#|O~P#3zO!O:fO~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:hO)X#|O~P#3zO)W:hO~O]&cO!V7jO!T!yy!h!yy#v!yy(v!yy)W!yy)j!yy!O!yy~O!Y#qO![#rO!^#uO!_#vO!a#xO!b#yO!c#yO!e#yO!f#zO(u#gO)S#mO)T#oO)U#nO)V#pO)W:lO)X#|O~P#3zO)W:lO~O]ZXlgXpZXpiX!TiX!VZX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX(uZX(v$]X(wZX(xZX)SZX)TZX)UZX)VZX)WZX)XZX)jZX~O]%WXlmXpnXp%WX!TnX!V%WX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!e%WX!f%WX!gmX!h%WX(u%WX(w%WX(x%WX)S%WX)T%WX)U%WX)V%WX)X%WX)jmX!O%WXQ%WX!d%WX~O)W%WX!W%WX(v%WX!U%WX~P+GrO]nX]%WXdnXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!VnX!V%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX!OnX!O%WX!hnX)XnX~O)WnX)jnX~P+JSO]%WXlmXpnXp%WX!V%WX!h%WXQ%WX!d%WX!O%WX~O!T%WX#v%WX)W%WX)j%WX(v%WX~P+LmOQnXQ%WX!TnX!X%WX!Y%WX![%WX!^%WX!_%WX!a%WX!b%WX!c%WX!dnX!d%WX!e%WX!f%WX!gmX!h%WX(u%WX(w%WX(x%WX)S%WX)T%WX)U%WX)V%WX)X%WX)jmX~P+JSO]nX]%WXlmXpnXp%WXrnXsnXtnXunXvnXwnXxnXynX}nX!V%WX!rnX!snX!tnX!unX!vnX!xnX!{nX%vnX&rnX&snX(rnX)SnX)UnX)VnX~O!TnX(vnX)WnX)jnX~P, eOdnX!VnX)W%WX~P, eOlmXpnX)W%WX~Od)oO%Y)pO(y:oO~Od)oO%Y)pO(y:tO~Od)oO%Y)pO(y:pO~Od$RO%Y*TO'[$TO'_$UO(y:oO~Od$RO%Y*TO'[$TO'_$UO(y:qO~Od$RO%Y*TO'[$TO'_$UO(y:sO~O]iXriXsiXtiXuiXviXwiXxiXyiX!OiX!ViX&riX&siX)SiX)UiX)ViXdiX}iX!riX!siX!tiX!uiX!viX!xiX!{iX%viX(riX~P#1jO]ZXlgXpZXpiX!VZX!hZX)WZX)jZX~O!TZX#vZX(vZX~P,'{OlgXpiX)PiX)WZX)jiX~O]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX!OZX!OiX!hiX)XiX)jiX~O)WZX~P,)VO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX!TiX!VZX!ViX!XZX!YZX![ZX!^ZX!_ZX!aZX!bZX!cZX!eZX!fZX!gZX!hZX!hiX&riX&siX(uZX(wZX(xZX)SZX)SiX)TZX)UZX)UiX)VZX)ViX)XZX)XiX)jZX~OQZXQiX!dZX!diX~P,+pO]iXdiXriXsiXtiXuiXviXwiXxiXyiX}iX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX~P#1jO]ZX]iXdiXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!VZX!ViX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX)SiX)UiX)ViX~O)WiX~P,0rOdiX}iX!OZX!OiX!riX!siX!tiX!uiX!viX!xiX!{iX%viX(riX)jiX~P,+pO]ZX]iXlgXpZXpiXriXsiXtiXuiXviXwiXxiXyiX}iX!TiX!VZX!riX!siX!tiX!uiX!viX!xiX!{iX%viX&riX&siX(riX(viX)SiX)UiX)ViX)WiX)jiX~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~PBUOd$RO%Y*TO(y:oO~Od$RO%Y*TO(y:pO~Od$RO%Y*TO(y:vO~Od$RO%Y*TO(y:uO~O]%hOd!POl%bOr!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O!V%kO!{!dO!|%RO%v$mO(r$xO)S;aO)U;bO)V;bO~O]%hOd!POl%bO!V%kO!{!dO%v$mO(r$xO)S;aO)U;bO)V;bO~Od$RO%Y$SO(y:pO~Od$RO%Y$SO(y:tO~Ol:yO~Ol:xO~O]cXlgXpiX!TcX~Od)oO%Y*TO(y:oO~Od)oO%Y*TO(y:pO~Od)oO%Y*TO(y:qO~Od)oO%Y*TO(y:rO~Od)oO%Y*TO(y:sO~Od)oO%Y*TO(y:uO~Od)oO%Y*TO(y:vO~Or!^Os!^Ot!^Ou!^Ov!^Ow!^Ox!^Oy!^O~P,9OO](}Xr(}Xs(}Xt(}Xu(}Xv(}Xw(}Xx(}Xy(}X}(}X!r(}X!s(}X!t(}X!u(}X!v(}X!x(}X!{(}X%v(}X&r(}X&s(}X(r(}X)S(}X)U(}X)V(}X)j(}X~Ol:xO!T(}X(v(}X)W(}X~P,<}O]&wXlmXpnX!T&wX~Od4kO%Y*TO(y;tO~Ol;[O)S;xO)U5aO)V5aO~P(ElOd!POl%bO!{!dO%v$mO(r$xO~O]1SO!V1QO)S0zO)U;yO)V;yOQ#nX!d#nX!h#nX!O#nX~P,?yO)S;YO~Ol;hO~Ol;iO~Ol;jO~Ol;lO~Ol;mO~Ol;nO~Ol;lO!T$WOQ(}X!d(}X!h(}X)X(}X!O(}X)j(}X~P$GQOl;jO!T$WO~P$GQOl;hO!g$YO)j$YO~Ol;jO!g$YO)j$YO~Ol;lO!g$YO)j$YO~Ol;iO!O(}X!h(}X)X(}X)j(}X~P$GQOd/^O%Y*TO(y;tO~Ol;uO~O)S<YO~OV'e'h'i'g(o)Y!R(rST%Z!Y!['jd%[!i'R!f]'f*Z'k(w!^!_'l'm'l~",goto:"%5]*ZPPPPPP*[P*_PP.T4iP7j7j:tP:t>OP>i>{?aFXMX!&]!,sP!3m!4b!5VP!5qPPPPPPPP!6[P!7tPP!9V!:oP!:uPPPPPP!:xP!:xPP!:xPPPPPPPPP!;U!>lP!>oPP!?]!@QPPPPP!@UP>l!AgPP>l!Cn!Eo!E}!Gd!ITP!I`P!Io!Io!MP#!`##v#'S#*^!Eo#*hPP!Eo#*o#*u#*h#*h#*xP#*|#+k#+k#+k#+k!ITP#,U#,g#.|P#/bP#0}P#1R#1Z#2O#2Z#4i#4q#4q#1RP#1RP#4x#5OP#5YPP#5u#6d#7U#5uP#7v#8SP#5uP#5uPP#5u#5uP#5uP#5uP#5uP#5uP#5uP#5uP#8V#5Y#8sP#9YP#9o#9o#9o#9o#9|#1RP#:d#?`#?}PPPPPPPP#@uP#ATP#ATP#Aa#Dn#9OPP#@}#EQP#Ee#Ep#Ev#Ev#@}#FlP#1R#1R#1R#1R#1RP!Io#GW#G_#G_#G_#Gc!Ly#Gm!Ly#Gq!E}!E}!E}#Gt#L^!E}>l>l>l$#V!@Q!@Q!@Q!@Q!@Q!@Q!6[!6[!6[$#jP$%V$%e!6[$%kPP!6[$'y$'|#@l$(P:t7j$+V$-Q$.q$0a7jPP7j$2T7jP7j7jP7jP$5Z7jP7jPP7j$5gPPPPPPPPP*[P$8o$8u$;^$=d$=j$>Q$>[$>g$>v$>|$@[$AZ$Ab$Ai$Ao$Aw$BR$BX$Bd$Bj$Bs$B{$CW$C^$Ch$Cn$Cx$DP$D`$Df$DlP$Dr$Dz$ER$Ea$F}$GT$GZ$Gb$GkPPPPPPPP$Gq$GuPPPPP$Nw$'y$Nz%$S%&[P%&i%&lPPPPPPPPPP%&x%'{%(R%(V%)|%+Z%+|%,T%.d%.jPPP%.t%/P%/S%/Y%0a%0d%0n%0x%0|%2Q%2s%2y#@uP%3d%3t%3w%4X%4e%4i%4o%4u$'y$'|$'|%4x%4{P%5V%5YR#cP'`mO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fU%om%p7QQ&m!`Q(j#]d0P)}/|/}0O0R4}5O5P5S8QR7Q3Tb}Oaewx{!g&S*q&v$i[!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0{1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fS%`f0h#d%jgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YS%qm!YS&u!h#PQ']!tQ'g!yQ'h!zQ(j#`Q(k#]Q(l#^Q*x%kQ,W&lQ,]&nQ-S'^Q-d'fQ-k'qS.r(Z4XQ/f)gQ0e*mQ2Q,[Q2X,cQ3O-eQ4b.|Q4f/TQ5f0}Q6[2TQ6}3PQ8a6ZQ9e7zR;Z1Q$|#hS!]$y%Q%T%Z&j&k'Q'X'Z'a'c(a(e(h(w(x)R)S)T)U)V)W)X)Y)Z)[)])^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:iQ&p!dQ(g#ZQ(s#bQ)j$T[*s%e*W0k2`2g2{Q,^&oQ/O(fQ/S(kQ/Z(tS/i)i/PQ0r+QS4q/j/kR8O4r'a![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f'a!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ)O#kS+Q%y0sQ/r)sk3}.g3s3w3z3{7c7e7f7h7k9X9Y:RQ)Q#kk3|.g3s3w3z3{7c7e7f7h7k9X9Y:Rl)P#k.g3s3w3z3{7c7e7f7h7k9X9Y:RT+Q%y0s[UOwx!g&S*qW$`[e$e(b#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_'}(P(U(^(g)j)p+[+a+b+t+y,X,k,z-Q-o-t.W.X._.`.d.q.u1T1X1f1k1m2l3[3]3^3p3t5j5}6P7[8Z![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fl(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS;e't-wU;f(Q.m.o&|;{af{|!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k$|$}%S%]%h%m&Q&W&b&y&|'O'i'j'u'y(`(i)l)r*`*b*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0]0h0y0{1Q1a1b1l1p1z2c2i2j2u4O4R4W4a5Y5a5e5q6_6c6f6g6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f;`;xQ;|1Sd;}&x'P'b,w-]-^-a2f2z2}W<O&f*v1|3iQ<P#O[<Q!t'^'f,[2T6ZT<]%y0s[VOwx!g&S*qW$a[e$e(bQ$p.u!j$q_!f!u!}#V#Z$S$T$l%U&U&Y&c&m'_(g)j)p+[+a+t,X,k,z-Q-o.d1T1X1f1k1m2l3t5j8Z&^$zaf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fQ'r#O|'|#R#S#T#U'}(P(U(^+b+y.W.X._.`.q3[3]3^3p5}6P7[l(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS-n't-wQ3W-tU;s(Q.m.on;{|$|$}%S%h'u*`*b0]0y2j5a6g;`;x[<Q!t'^'f,[2T6ZW<R&f*v1|3id<S&x'P'b,w-]-^-a2f2z2}Q<Z1ST<]%y0s!Q!UO[ewx!g$e&S&f&x'P'b(b*q*v,w-]-^-a1|2f2z2}3i!v$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'t(Q(g)j)p+[+t,X,k,z-Q-o-w.d.m.o1S1T1X1f1k1m2l3t5j8Z&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$Q%lgnp|#k$g$|$}%S%d%h%i%w%y&s'^'f'u*Y*`*b*t+],[,l,v-_-p.f.g0]0s0y0z1O2T2_2j3s3w3z3{5a6Z6g7c7e7f7h7k9X9Y:R;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YQ'[!tz(O#R#S#T#U'}(P(U(^+y.W.X._.`.q3[3]3^3p5}6P7[f-Z'`-T-V-Y2p2q2s2v6q6r8pQ1W+aQ1Z+bQ2k,yQ3X-tQ4[.uQ5l1YR8V5m!Q!UO[ewx!g$e&S&f&x'P'b(b*q*v,w-]-^-a1|2f2z2}3i!x$t_!f!u!}#O#V#Z$S$T$l%U&U&Y&c&m'_'t(Q(g)j)p+[+a+t,X,k,z-Q-o-w.d.m.o1S1T1X1f1k1m2l3t5j8Z&^%Paf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$S%lgnp|!t#k$g$|$}%S%d%h%i%w%y&s'^'f'u*Y*`*b*t+],[,l,v-_-p.f.g0]0s0y0z1O2T2_2j3s3w3z3{5a6Z6g7c7e7f7h7k9X9Y:R;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Y|(O#R#S#T#U'}(P(U(^+b+y.W.X._.`.q3[3]3^3p5}6P7[Q3X-tR4[.u[WOwx!g&S*qW$b[e$e(b#l$p_!f!u!}#R#S#T#U#V#Z$S$T$l%U&U&Y&c&m'_'}(P(U(^(g)j)p+[+a+b+t+y,X,k,z-Q-o-t.W.X._.`.d.q.u1T1X1f1k1m2l3[3]3^3p3t5j5}6P7[8Z![%cg$g%d%i&s*Y*t+],l,v-_0z1O2_;W;X;Y;a;b;o;p;q;r;v;w;y<W<X<YY%snp%w-p.fl(|#k.g3s3w3z3{7c7e7f7h7k9X9Y:RS;e't-wU;f(Q.m.on;{|$|$}%S%h'u*`*b0]0y2j5a6g;`;xQ;|1SQ<P#O[<Q!t'^'f,[2T6Z&^<Taf{!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$f$k%]%m&Q&W&b&y&|'O'i'j'y(`(i)l)r*h*i*l*r+W+Y+h+j+k,P,R,n,q-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z2c2i2u4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fd<U&x'P'b,w-]-^-a2f2z2}W<V&f*v1|3iT<]%y0sp$PT$_$o%b%r({:z:{:|;[;];^;_;c;d<[o)m$V*U*[/_:w:x:y;h;i;j;k;l;m;n;up$QT$_$o%b%r({:z:{:|;[;];^;_;c;d<[o)n$V*U*[/_:w:x:y;h;i;j;k;l;m;n;u^&e}!O$i$j%`%j;Zd&i!U$t%P%l'[(O1W1Z3X4[V/a)O)P3}S%Ye$eQ,T&fQ.{(bQ2m-QQ5y1mQ6V1|Q6m2lR9h8Z#}!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8Z#[^O[_`wx!f!g!}#O$S$d$l$s$u&S&U&Y&c&m&r&x'P'b't(Q)p*]*q*v+[,X,k,w,z-]-^-a-o-t-w.d.m.o1S1T1f2f2z2}3i3t_(U#R#S#T+b3[3]3^#}ZO[wx!g!k#R#S#T%m&S&U&Y&c&m&w&x&y&|'O'P'['b't'x'}(P(Q(U*q*v+[+b,X,h,k,q-P-]-^-a-o-t-w-z._.d.m.q1S1T1f2c2k2z2}3[3]3^3i6c6j8g9l9p:W:]:fQ$]YR0T*OR*Q$]e0P)}/|/}0O0R4}5O5P5S8Q'`!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fe0P)}/|/}0O0R4}5O5P5S8QR5T0T^(T#R#S#T+b3[3]3^Y.]'}(R(U(V7TU3k.Z.^.qS7X3l4VR9c7s^(S#R#S#T+b3[3]3^[.['}(R(T(U(V7TW3j.Z.].^.qU7W3k3l4VS8z7X7sR:V9cT.k(Q.md]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3tQ%tnT1u+}1v!jbOaenpwx{|!g#O$|$}%S%h%w&S't'u(Q*`*b*q-p-w.f.m.o0]0y1S2j5a6g;`;xf-W'`-T-V-Y2p2q2s2v6q6r8pj3x.g3s3w3z3{7c7e7f7h7k9X9Y:Rr;zg$g%d%i&s*Y*t,l,v-_2_;W;X;Y;o;q;vi<^+]0z1O;a;b;p;r;w;y<W<X<Y!O&^y%X&V&Y&Z'k)h*d*f+]+e+x/m0^0y0z1O1S1j5a5v;x;yz&az%O%W%e&d's*W*_,b-x0Z0[0k0|2`2g2{5V5b6l8iS'{#Q.Xn+l&X*g+f+m+p-j/h0_1R1^4t5W5`5u8XQ2W,a^2t-X2r2x6p6w8o9se7i3y7_7g7o7p9U9W9`:Q:cS+^&U1TY+n&Y&c*v1S3iR5s1f#w!POaegnpwx{|!g#O$g$|$}%S%d%h%i%w&S&s't'u(Q*Y*`*b*q*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Y`oOwx!g&S't*q-w#U!Paeg{|#O$g$|$}%S%d%h%i&s'u*Y*`*b*t+],l,v-_0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YU%vnp-pQ*}%wS.e(Q.mT3v.f.oW+r&^+l+s1cV+z&a+{7iQ+x&`U+z&a+{7iQ-w'tT.S'y.U'`![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fX1r+y.X5}6P'W!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fW1r+y.X5}6PR2e,s!WjO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fY%Ve$e(b1p3iQ'S!nS(y#i5YQ,m&xQ,x'PS.O'y.UQ2b,nQ6k2iQ6|2}Q8h6fR9m8e'W![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fX1r+y.X5}6P'ayO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k+y,P,R,n,q,w-]-^-a-g.P.Q.U.X.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q5}6P6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ&`yS't#O-uR1[+cS+^&U1TR5n1[Q1P+]R5g1OR1P+]T+^&U1Tz&[%X&V&Y&Z'k)h*d*f+]+e/m0^0y0z1O1S1j5a5v;x;yQ&]yR1n+x!P&[y%X&V&Y&Z'k)h*d*f+]+e+x/m0^0y0z1O1S1j5a5v;x;yQ+u&^S+|&a7iS1d+l+sQ1t+{R5r1c!WkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fS%zo.eS&Oq-rQ&_yQ&q!eQ'e!yQ*p%eU*{%v%{3vS+P%x%}Q+q&]Q,Y&mS,Z&n'gQ,r&{S0X*W,bS0o*|*}Q0q+OQ1o+xS2S,]-fQ5U0ZQ5Z0pQ5{1nQ6Y2RQ6]2WQ7n3yQ9S7_R:P9U[uOwx!g&S*qQ,Y&mQ-v'tQ3Y-tR3_-wxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fU$h[&|-^S%zo.eS&Oq-rQ*p%eU*{%v%{3vS+P%x%}S0X*W,bS0o*|*}Q0q+OQ5U0ZQ5Z0pQ7n3yQ9S7_R:P9UT,_&q,`]uOwx!g&S*q[uOwx!g&S*qQ,Y&mQ,n&xQ,w'PW-`'b-]-a2zQ-v'tQ3Y-tQ3_-wR6{2}[%fg$g,l,v-_2_R0l*t^$XV!U$a$z%P<R<SQ'S!nS)`#}*vS)v$W*qQ)y$YY*s%e*W0k2g2{Q/O(fS/i)i/PS0a*h4aS0j*r6_Q0r+QQ4Q.gQ4n/cS4q/j/kS4v/n5YQ4{/uQ6`2`U7a3s3y4RQ8O4rQ8k6hY9Q7_7b7c7l7mQ9r8mW9z9O9R9U9VQ:Z9oU:a9{9}:OR:j:bS)v$W*qT4v/n5YZ)t$W)u*q/n5YQ&w!hR'x#PS,g&v'vQ2[,eR6^2ZxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fV$h[&|-^!XkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:f!WhO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fR'W!q!WkO[wx!g!k%m&S&y&|'O'b*q,q-]-^-a2c2z6c6j8g9l9p:W:]:fR,n&xQ&y!iQ&{!jQ'O!lR,q&zR,o&xxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fX-`'b-]-a2z[uOwx!g&S*qQ,z'PQ-v'tS.k(Q.mR3_-w[uOwx!g&S*qQ,z'PW-`'b-]-a2zT.k(Q.mg-Z'`-T-V-Y2p2q2s2v6q6r8pylOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fb!OOaewx{!g&S*q&|$j[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f#d%jgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<YQ']!tQ-S'^Q-d'fQ2Q,[Q6[2TR8a6Zj$RT$_%b%r:z:{:|;[;];^;_;c;di)o$V*U:w:x:y;h;i;j;k;l;m;nj$RT$_%b%r:z:{:|;[;];^;_;c;dh)o$V*U:w:x:y;h;i;j;k;l;m;nS/^({<[V4k/_/`;u[uOwx!g&S*qQ-v'tR3_-w[uOwx!g&S*qT.k(Q.m'`!YO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fR7R3T[uOwx!g&S*qQ-v'tS.k(Q.mR3_-w[pOwx!g&S*qQ%wnS-p't-wT.f(Q.mS%{o.eS*|%v3vR0p*}Q+R%yR5]0sS%zo.eS&Oq-rU*{%v%{3vS+P%x%}S0o*|*}Q0q+OQ5Z0pQ7n3yQ9S7_R:P9U`qOwx!g&S(Q*q.mS%xn-pU%}p.f.oQ+O%wT-r't-wS'z#Q.XR.Y'{T.R'y.US.S'y.UQ8x7UR9w8yT5}1q8_R6P1q#d!Pgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Yb!QOaewx{!g&S*q&}![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f#d!Pgnp|#O$g$|$}%S%d%h%i%w&s't'u(Q*Y*`*b*t+],l,v-_-p-w.f.m.o0]0y0z1O1S2_2j5a6g;W;X;Y;`;a;b;o;p;q;r;v;w;x;y<W<X<Yb!QOaewx{!g&S*q&|![[f!W!X!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#{#}$U$W$Y$e$f$k%]%m&Q&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W4a5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fk3|.g3s3w3z3{7c7e7f7h7k9X9Y:RQ4Q.gS7a3s3yU9Q7_7c7lS9z9O9UR:a9}#|!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8ZR4].uQ(]#US.v([(^S4^.w.xR7w4_Q.s(ZR7u4X#|!TO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o1S1T1X1f1k1m1|2f2l2z2}3i3t5j8Zp$w`$d$s%X&r'`(_(f)i*d-T/k1j5k5v8Uq(}#k%y.g0s3s3w3z3{7c7e7f7h7k9X9Y:RR,U&fR6W1|'X!VO[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:f$q#rS%T%Z'Q'X'Z'a'c(a(e(h(w(x)R)S)U)V)W)X)Y)Z)[)])^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$]#sS%T%Z'Q'X'Z'a'c(h(w(x)R)V)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$Z#tS%T%Z'Q'X'Z'a'c(h(w(x)R)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i$c#wS%T%Z'Q'X'Z'a'c(h(w(x)R)U)V)W)X)^)_)k)q)x+X+g,O,S,j,u-h-i-|.y/p0`0b0g0i0w1`1y2a2h3R3c3d4c4d4j4m4s4u4y4z5d5p5w6U6e6i6s6z7q7r7t8S8T8c8f8j8r9T9[9k9q9|:T:Y:`:i'X![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/[/c/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ/P(fQ/j)iQ4r/kR9d7y']![O[aefwx{!W!X!g!k!n!r!s!v!x#X#Y#[#g#i#l#q#r#s#t#u#v#w#x#y#z#}$U$W$Y$e$f$k%]%m&Q&S&W&b&f&x&y&|'O'P'b'i'j'y(`(b(i)l)r*h*i*l*q*r*v+W+Y+h+j+k,P,R,n,q,w-]-^-a-g.P.Q.U.}/Q/[/c/l/n/s/u0h0{1Q1a1b1l1p1z1|2c2f2i2u2z2}3i4O4R4W5Y5e5q6_6c6f6h6j6t6v6{7b7j7m8e8g8m8s8t9R9V9]9_9l9o9p9{:O:U:W:]:b:fQ#eQR(u#eU$|a;`;xb%Ue$e&f(b-Q1m1|2l8ZQ'_!u!Q*^$|%U'_*`*f+h,P0]0^1b2p6q6t7e8p9X9]:R;W;o;p;v;w<WS*`$}%SQ*f%XS+h&W1QQ,P&bQ0]*bQ0^*dQ1b+kQ2p-VS6q2q2sQ6t2uQ7e3wQ8p6rS9X7f7hQ9]7jQ:R9YQ;W%dS;o;X;YS;p<X<YQ;v;qQ;w;rT<W0z;a[[Owx!g&S*ql$c[&|'}+[,X,h,k-P-^-o-z._.d.ql&|!k%m&y'O,q2c6c6j8g9l9p:W:]:f^'}#R#S#T+b3[3]3^`+[&U&Y&c*v1S1T1f3iS,X&m-tQ,h&wU,k&x'P2}S-P'[2kW-^'b-]-a2zS-o't-wQ-z'xQ._(PS.d(Q.mR.q(UQ)|$[R/x)|Q0R)}Q4}/|Q5O/}Q5P0OY5Q0R4}5O5P8QR8Q5SQ*P$]S0U*P0VR0V*QS.`(P._S3n.`7[R7[3pQ3q.aS7Y3o3rU7^3q7Y8{R8{7ZQ.m(QR4S.m!|_O[wx!f!g!}#O$S$l&S&U&Y&c&m&x'P'b't(Q)p*q*v+[,X,k,w,z-]-^-a-o-t-w.d.m.o1S1T1f2f2z2}3i3tU$r_$u*]U$u`$d&rR*]$sU$}a;`;xd*a$}*b2q6r7f9Y;X;q;r<XQ*b%SQ2q-VQ6r2sQ7f3wQ9Y7hQ;X%dQ;q;YQ;r<YT<X0z;aS+{&a7iR1s+{S*j%Z/pR0c*jQ1U+_R5i1UU+e&V0z;xR1]+eQ+s&^Q1c+lT1i+s1cQ8[5yR9i8[QwOS&Rw&ST&Sx*qQ,`&qR2V,`W)u$W*q/n5YR/t)uU/o)q)v0gR4w/o[*u%e%f*W2`2g2{R0m*uQ,d&uR2Y,dQ-a'bQ2z-]T2|-a2zQ2w-XR6x2wQ-f'gQ2R,]T3Q-f2RS%pm7QR*z%pdnOwx!g&S't(Q*q-w.mR%unQ0t+RR5^0tQ.U'yR3f.UQ1v+}R6Q1vU*n%`*x;ZR0f*nS1g+n0nR5t1gQ7l3yQ9O7_U9a7l9O9}R9}9U$O!SO[_ewx!f!g!u!}#O#V#Z$S$T$e$l%U&S&U&Y&c&f&m&x'P'_'b't(Q(b(g)j)p*q*v+[+a+t,X,k,w,z-Q-]-^-a-o-t-w.d.m.o.u1S1T1X1f1k1m1|2f2l2z2}3i3t5j8ZR&g!SQ4Y.sR7v4YQ1},UR6X1}S/d)_)`R4o/dW(o#a(j(k/SR/W(oQ7{4fR9f7{T)a#}*v!USO[wx!g!k%m&S&y&|'O'b,q-]-^-a2c2z6c6j8g9l9p:W:]:fj$ya{$k%]+j,R1a1z5q6v8s9_:UY%Te$e(b1p3iY%Zf$f(i)l*lQ&j!WQ&k!XQ'Q!nQ'X!rQ'Z!sQ'a!vQ'c!xQ(a#XQ(e#YS(h#[+YQ(w#gQ(x#iQ)R#lQ)S#qQ)T#rQ)U#sQ)V#tQ)W#uQ)X#vQ)Y#wQ)Z#xQ)[#yQ)]#zQ)^#{S)_#}*vQ)k$UQ)q$WQ)x$YQ+X&QS+g&W1QQ,O&bQ,S&fQ,j&xQ,u'PQ-h'iQ-i'jS-|'y.UQ.y(`S/p)r0hS0`*h4aQ0b*iQ0g*qQ0i*rQ0w+WS1`+h+kQ1y,PQ2a,nS2h,w6{Q3R-gQ3c.PQ3d.QQ4c.}Q4d/QQ4j/[Q4m/cQ4s/lQ4u/nQ4y/sQ4z/uQ5d0{Q5p1bQ5w1lQ6U1|S6e2f8tQ6i2iQ6s2uQ6z2}Q7q4OQ7r4RQ7t4WQ8S5YQ8T5eQ8c6_Q8f6fQ8j6hQ8r6tS9T7b7mQ9[7jQ9k8eQ9q8mS9|9R9VQ:T9]Q:Y9oS:`9{:OR:i:bR,V&fd]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3t#r${ae!u$e$|$}%S%U%X%d&W&b&f'_(b*`*b*d*f+h+k,P-Q-V0]0^1Q1b1m1|2l2p2q2s2u3w6q6r6t7e7f7h7j8Z8p9X9Y9]:R;W;X;Y;`;a;o;p;q;r;v;w<W<X<YQ%tnS+d&V+eW+r&^+l+s1cU+z&a+{7iQ1k+tT5c0z;x``Owx!g&S't*q-wS$d[-oQ$s_b%Xe$e&f(b-Q1m1|2l8Z!h&r!f!}#O$S$l&U&Y&c&m&x'P'b(Q)p*v+[,X,k,w,z-]-^-a-t.d.m.o1S1T1f2f2z2}3i3tQ'`!uS(_#V+aQ(f#ZS)i$T(gQ*d%UQ-T'_Q/k)jQ1j+tQ5k1XQ5v1kR8U5jS(W#R3]S(X#S3^V(Y#T+b3[R$^Ye0Q)}/|/}0O0R4}5O5P5S8QW(R#R#S#T+bQ([#US.Z'}(US.a(P._Q.x(^W1r+y.X5}6PQ3Z-tQ3h.WQ3o.`Q4V.qU7T3[3]3^Q7]3pR8|7[Q.b(PR3m._T.l(Q.mdgOwx!g&S&m't*q-t-wU$g[,X-oQ&s!fQ'k!}Q'u#OQ)h$SQ*Y$l`+]&U&Y&c*v1S1T1f3iQ,l&xQ,v'PY-_'b-]-a2z2}S.g(Q.mQ/m)pQ0y+[S2_,k-^S2j,w,zS3s.d.oQ6g2fR7c3td]Owx!g&S't(Q*q-w.m!v^[_`!f!}#O$S$d$l$s$u&U&Y&c&m&r&x'P'b)p*]*v+[,X,k,w,z-]-^-a-o-t.d.o1S1T1f2f2z2}3i3tR%tnQ3y.gQ7_3sQ7g3wQ7o3zQ7p3{Q9U7cU9W7e7f7hQ9`7kS:Q9X9YR:c:RZ+o&Y&c*v1S3ipzOnpwx!g%w&S't(Q*q-p-w.f.m.o[%Oa%d0z;`;a;xU%We%h1SQ%eg^&d{|%i1O5a;b;yQ's#OQ*W$gb*_$|$}%S;W;X;Y<W<X<YQ,b&sQ-x'uQ0Z*Y[0[*`*b;o;p;q;rQ0k*tQ0|+]Q2`,lQ2g,vS2{-_2_U5V0];v;wQ5b0yQ6l2jR8i6gQ+}&aR9Z7iS1q+y.XQ8^5}R8_6P[%^f$f(i)l)r0hR0d*lR+`&UQ+_&UR5h1TS&Xy+xQ*g%XU+f&V0z;xS+m&Y1SW+p&Z1O5a;yQ-j'kQ/h)hS0_*d*fQ1R+]Q1^+eQ4t/mQ5W0^Q5`0yQ5u1jR8X5vR5z1mYvOwx&S*qR&t!gW%gg,l,v-_T*X$g2_T)w$W*q[uOwx!g&S*qQ&}!kQ*y%mQ,p&yQ,t'OQ2d,qQ6b2cQ8d6cQ8l6jQ9n8gQ:X9lQ:[9pQ:e:WQ:g:]R:k:fxlOwx!g!k%m&S&y'O*q,q2c6c6j8g9l9p:W:]:fU$h[&|-^X-`'b-]-a2zQ-['`R2o-TS-X'`-TQ2r-VQ2x-YU6p2p2q2sQ6w2vS8o6q6rR9s8p[rOwx!g&S*qS-q't-wT.h(Q.mR+S%y[sOwx!g&S*qS-s't-wT.i(Q.m[tOwx!g&S*qT.j(Q.mT.T'y.UX%af%k0h1QQ.w([R4_.xR.t(ZR(d#XQ(r#aS/R(j(kR4e/SR/V(lR4g/T",nodeNames:" RawString > MacroName LineComment BlockComment PreprocDirective #include String EscapeSequence SystemLibString Identifier ArgumentList ( ConditionalExpression AssignmentExpression CallExpression PrimitiveType FieldExpression FieldIdentifier DestructorName TemplateMethod ScopedFieldIdentifier NamespaceIdentifier TemplateType TypeIdentifier ScopedTypeIdentifier ScopedNamespaceIdentifier :: NamespaceIdentifier TypeIdentifier TemplateArgumentList < TypeDescriptor const volatile restrict _Atomic mutable constexpr constinit consteval StructSpecifier struct MsDeclspecModifier __declspec ) Attribute AttributeName Identifier AttributeArgs { } [ ] UpdateOp ArithOp ArithOp ArithOp LogicOp BitOp BitOp BitOp CompareOp CompareOp CompareOp > CompareOp BitOp UpdateOp , Number CharLiteral AttributeArgs VirtualSpecifier BaseClassClause Access virtual FieldDeclarationList FieldDeclaration extern static register inline thread_local AttributeSpecifier __attribute__ PointerDeclarator MsBasedModifier __based MsPointerModifier FunctionDeclarator ParameterList ParameterDeclaration PointerDeclarator FunctionDeclarator Noexcept noexcept RequiresClause requires True False ParenthesizedExpression CommaExpression LambdaExpression LambdaCaptureSpecifier TemplateParameterList OptionalParameterDeclaration TypeParameterDeclaration typename class VariadicParameterDeclaration VariadicDeclarator ReferenceDeclarator OptionalTypeParameterDeclaration VariadicTypeParameterDeclaration TemplateTemplateParameterDeclaration template AbstractFunctionDeclarator AbstractPointerDeclarator AbstractArrayDeclarator AbstractParenthesizedDeclarator AbstractReferenceDeclarator ThrowSpecifier throw TrailingReturnType CompoundStatement FunctionDefinition MsCallModifier TryStatement try CatchClause catch LinkageSpecification Declaration InitDeclarator InitializerList InitializerPair SubscriptDesignator FieldDesignator ExportDeclaration export ImportDeclaration import ModuleName PartitionName HeaderName CaseStatement case default LabeledStatement StatementIdentifier ExpressionStatement IfStatement if ConditionClause Declaration else SwitchStatement switch DoStatement do while WhileStatement ForStatement for ReturnStatement return BreakStatement break ContinueStatement continue GotoStatement goto CoReturnStatement co_return CoYieldStatement co_yield AttributeStatement ForRangeLoop AliasDeclaration using TypeDefinition typedef PointerDeclarator FunctionDeclarator ArrayDeclarator ParenthesizedDeclarator ThrowStatement NamespaceDefinition namespace ScopedIdentifier Identifier OperatorName operator ArithOp BitOp CompareOp LogicOp new delete co_await ConceptDefinition concept UsingDeclaration enum StaticAssertDeclaration static_assert ConcatenatedString TemplateDeclaration FriendDeclaration friend union FunctionDefinition ExplicitFunctionSpecifier explicit FieldInitializerList FieldInitializer DefaultMethodClause DeleteMethodClause FunctionDefinition OperatorCast operator TemplateInstantiation FunctionDefinition FunctionDefinition Declaration ModuleDeclaration module RequiresExpression RequirementList SimpleRequirement TypeRequirement CompoundRequirement ReturnTypeRequirement ConstraintConjuction LogicOp ConstraintDisjunction LogicOp ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator TemplateFunction OperatorName StructuredBindingDeclarator ArrayDeclarator ParenthesizedDeclarator ReferenceDeclarator BitfieldClause FunctionDefinition FunctionDefinition Declaration FunctionDefinition Declaration AccessSpecifier UnionSpecifier ClassSpecifier EnumSpecifier SizedTypeSpecifier TypeSize EnumeratorList Enumerator DependentType Decltype decltype auto PlaceholderTypeSpecifier ParameterPackExpansion ParameterPackExpansion FieldIdentifier PointerExpression SubscriptExpression BinaryExpression ArithOp LogicOp LogicOp BitOp UnaryExpression LogicOp BitOp UpdateExpression CastExpression SizeofExpression sizeof CoAwaitExpression CompoundLiteralExpression NULL NewExpression new NewDeclarator DeleteExpression delete ParameterPackExpansion nullptr this UserDefinedLiteral ParamPack #define PreprocArg #if #ifdef #ifndef #else #endif #elif PreprocDirectiveName Macro Program",maxTerm:425,nodeProps:[["group",-35,1,8,11,14,15,16,18,71,72,100,101,102,104,191,208,229,242,243,270,271,272,277,280,281,282,284,285,286,287,290,292,293,294,295,296,"Expression",-13,17,24,25,26,42,255,256,257,258,262,263,265,266,"Type",-19,126,129,147,150,152,153,158,160,163,164,166,168,170,172,174,176,178,179,188,"Statement"],["isolate",-4,4,5,8,10,""]],propSources:[cppHighlighting],skippedNodes:[0,3,4,5,6,7,10,297,298,299,300,301,302,303,304,305,306,347,348],repeatNodeCount:41,tokenData:"&*r7ZR!UOX$eXY({YZ.gZ]$e]^+P^p$epq({qr.}rs0}st2ktu$euv!7dvw!9bwx!;exy!<Yyz!=Tz{!>O{|!?R|}!AV}!O!BQ!O!P!DX!P!Q#+y!Q!R#Az!R![$(x![!]$Ag!]!^$Cc!^!_$D^!_!`%1W!`!a%2X!a!b%5_!b!c$e!c!n%6Y!n!o%7q!o!w%6Y!w!x%7q!x!}%6Y!}#O%:n#O#P%<g#P#Q%Kz#Q#R%Ms#R#S%6Y#S#T$e#T#i%6Y#i#j%Nv#j#o%6Y#o#p&!e#p#q&#`#q#r&%f#r#s&&a#s;'S$e;'S;=`(u<%lO$e&t$nY)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&r%eW)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^&j&SU'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j&kX'f&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j']V'f&jOY%}YZ%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&j'uP;=`<%l%}&r'{P;=`<%l%^&l(VW(pQ'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O&l(rP;=`<%l(O&t(xP;=`<%l$e7Z)Y`)ZW(pQ(n.o'f&j*Z)`OX$eXY({YZ*[Z]$e]^+P^p$epq({qr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e.o*aT(n.oXY*[YZ*[]^*[pq*[#O#P*p.o*sQYZ*[]^*y.o*|PYZ*[4e+[`)ZW(pQ(n.o'f&jOX$eXY+PYZ*[Z]$e]^+P^p$epq+Pqr$ers%^sw$ewx(Ox#O$e#O#P,^#P;'S$e;'S;=`(u<%lO$e4Z,cX'f&jOY%}YZ-OZ]%}]^-{^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4Z-V[(n.o'f&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4Z.QV'f&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P.nT*W)`(n.oXY*[YZ*[]^*[pq*[#O#P*p3o/[[%^!b'QP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o0_Y%]!b!a,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e6e1YY)ZW(qQ(o/]'f&jOY%^Zr%^rs1xsw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^(U2RW)x!b)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^4e2tf)ZW(pQ'f&jOX$eXY2kZp$epq2kqr$ers%^sw$ewx(Ox!c$e!c!}4Y!}#O$e#O#P&f#P#T$e#T#W4Y#W#X5m#X#Y>u#Y#]4Y#]#^NZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e4eb)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e5xd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y7W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e7cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z8q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e8|d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^:[#^#o4Y#o;'S$e;'S;=`(u<%lO$e4e:gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#b4Y#b#c;u#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e<Qd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y=`#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e=mb)ZW(pQ'e.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e?Qf)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a@f#a#b4Y#b#cHV#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e@qf)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^BV#^#g4Y#g#hEV#h#o4Y#o;'S$e;'S;=`(u<%lO$e4eBbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZCp#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eC}b)ZW(pQ'f&j'l.o'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eEbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#YFp#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4eF}b)ZW(pQ'j.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eHbd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#XIp#X#o4Y#o;'S$e;'S;=`(u<%lO$e4eI{d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#]4Y#]#^KZ#^#o4Y#o;'S$e;'S;=`(u<%lO$e4eKfd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#ZLt#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4eMRb)ZW(pQ'f&j'k.o'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4eNff)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z! z#Z#b4Y#b#c!.[#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!!Xf)ZW(pQ'g.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!#m#X#b4Y#b#c!(W#c#o4Y#o;'S$e;'S;=`(u<%lO$e4e!#xd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!%W#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!%cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!&q#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!'Ob)ZW(pQ'h.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!(cd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!)q#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!)|d)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!+[#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!+gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#Y4Y#Y#Z!,u#Z#o4Y#o;'S$e;'S;=`(u<%lO$e4e!-Sb)ZW(pQ'i.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e4e!.gd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#V4Y#V#W!/u#W#o4Y#o;'S$e;'S;=`(u<%lO$e4e!0Qd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#`4Y#`#a!1`#a#o4Y#o;'S$e;'S;=`(u<%lO$e4e!1kd)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#i4Y#i#j!2y#j#o4Y#o;'S$e;'S;=`(u<%lO$e4e!3Ud)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#W4Y#W#X!4d#X#o4Y#o;'S$e;'S;=`(u<%lO$e4e!4od)ZW(pQ'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#X4Y#X#Y!5}#Y#o4Y#o;'S$e;'S;=`(u<%lO$e4e!6[b)ZW(pQV.o'f&j'm.oOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![4Y![!c$e!c!}4Y!}#O$e#O#P&f#P#R$e#R#S4Y#S#T$e#T#o4Y#o;'S$e;'S;=`(u<%lO$e3o!7q[)ZW(pQ%Z!b![,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!8rY!g-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!9o])V,g)ZW(pQ%[!b'f&jOY$eZr$ers%^sv$evw!:hwx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!:uY)U,g%^!b)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2X!;pW)[S(pQ)Y,g'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O6i!<eY)ZW(pQ]6_'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V!=`Y!Oa)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!>][)S,g)ZW(pQ%Z!b'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!?`^)ZW(pQ%Z!b!Y,g'f&jOY$eZr$ers%^sw$ewx(Ox{$e{|!@[|!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!@gY)ZW!X-y(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!AbY!h,k)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!B__)ZW(pQ%Z!b!Y,g'f&jOY$eZr$ers%^sw$ewx(Ox}$e}!O!@[!O!_$e!_!`!8g!`!a!C^!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o!CiY(x-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Dd^)ZW(pQ'f&j(w,gOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!E`!P!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!Ei[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P!F_!P#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2a!FjY)X,k)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]!Gen)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx!Icx!Q$e!Q![!GY![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T!IjY(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![!JY![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T!Jcn(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx!Icx!Q(O!Q![!JY![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ljl(pQ!i,g'f&jOY(OZr(Ors%}s{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T!Ni^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![# e![!c(O!c!i# e!i#O(O#O#P&f#P#T(O#T#Z# e#Z;'S(O;'S;=`(o<%lO(O2T# nj(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx!Nbx!Q(O!Q![# e![!c(O!c!h# e!h!i# e!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#Y# e#Y#Z# e#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T##id(pQ!i,g'f&jOY(OZr(Ors%}s!h(O!h!i##`!i!n(O!n!o##`!o!w(O!w!x##`!x#O(O#O#P&f#P#Y(O#Y#Z##`#Z#`(O#`#a##`#a#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]#%Sn)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#'Z`)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![#(]![!c$e!c!i#(]!i#O$e#O#P&f#P#T$e#T#Z#(]#Z;'S$e;'S;=`(u<%lO$e2]#(hj)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx!Nbx!Q$e!Q![#(]![!c$e!c!h#(]!h!i#(]!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#Y#(]#Y#Z#(]#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]#*ef)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox!h$e!h!i#*Y!i!n$e!n!o#*Y!o!w$e!w!x#*Y!x#O$e#O#P&f#P#Y$e#Y#Z#*Y#Z#`$e#`#a#*Y#a#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e7Z#,W`)ZW(pQ%Z!b![,g'f&jOY$eZr$ers%^sw$ewx(Oxz$ez{#-Y{!P$e!P!Q#:s!Q!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#-c])ZW(pQ'f&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y1e#._TOz#.[z{#.n{;'S#.[;'S;=`#/]<%lO#.[1e#.qVOz#.[z{#.n{!P#.[!P!Q#/W!Q;'S#.[;'S;=`#/]<%lO#.[1e#/]OT1e1e#/`P;=`<%l#.[7X#/jZ)ZW'f&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7P#0bX'f&jOY#0]YZ#.[Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1SZ'f&jOY#0]YZ#.[Zz#0]z{#0}{!P#0]!P!Q#1u!Q#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#1|UT1e'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}7P#2eZ'f&jOY#0]YZ#0]Z]#0]]^#3W^z#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3]X'f&jOY#0]YZ#0]Zz#0]z{#0}{#O#0]#O#P#2`#P;'S#0];'S;=`#3x<%lO#0]7P#3{P;=`<%l#0]7X#4V])ZW'f&jOY#/cYZ#.[Zw#/cwx#0]xz#/cz{#4O{!P#/c!P!Q#5O!Q#O#/c#O#P#2`#P;'S#/c;'S;=`#5q<%lO#/c7X#5XW)ZWT1e'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^7X#5tP;=`<%l#/c7R#6OZ(pQ'f&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#6x](pQ'f&jOY#5wYZ#.[Zr#5wrs#0]sz#5wz{#6q{!P#5w!P!Q#7q!Q#O#5w#O#P#2`#P;'S#5w;'S;=`#8d<%lO#5w7R#7zW(pQT1e'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O7R#8gP;=`<%l#5w7Z#8s_)ZW(pQ'f&jOY#-YYZ#.[Zr#-Yrs#/csw#-Ywx#5wxz#-Yz{#8j{!P#-Y!P!Q#9r!Q#O#-Y#O#P#2`#P;'S#-Y;'S;=`#:m<%lO#-Y7Z#9}Y)ZW(pQT1e'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z#:pP;=`<%l#-Y7Z#;OY)ZW(pQS1e'f&jOY#:sZr#:srs#;nsw#:swx#@{x#O#:s#O#P#<z#P;'S#:s;'S;=`#At<%lO#:s7X#;wW)ZWS1e'f&jOY#;nZw#;nwx#<ax#O#;n#O#P#<z#P;'S#;n;'S;=`#@u<%lO#;n7P#<hUS1e'f&jOY#<aZ#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#=RXS1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P;'S#<a;'S;=`#>[<%lO#<a7P#=uVS1e'f&jOY#<aYZ%}Z#O#<a#O#P#<z#P;'S#<a;'S;=`#>[<%lO#<a7P#>_P;=`<%l#<a7P#>i]S1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c#f#<a#f#g#?b#g;'S#<a;'S;=`#>[<%lO#<a7P#?iUS1e'f&jOY#<aZ#O#<a#O#P#?{#P;'S#<a;'S;=`#>[<%lO#<a7P#@SZS1e'f&jOY#<aYZ%}Z]#<a]^#=n^#O#<a#O#P#>b#P#b#<a#b#c#<a#c;'S#<a;'S;=`#>[<%lO#<a7X#@xP;=`<%l#;n7R#AUW(pQS1e'f&jOY#@{Zr#@{rs#<as#O#@{#O#P#<z#P;'S#@{;'S;=`#An<%lO#@{7R#AqP;=`<%l#@{7Z#AwP;=`<%l#:s2]#BVt)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$+X#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$=`#m;'S$e;'S;=`(u<%lO$e2T#DnY(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![#E^![#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O2T#Egp(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#Dgx!O(O!O!P#Gk!P!Q(O!Q![#E^![!g(O!g!h!La!h!i##`!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#X(O#X#Y!La#Y#Z##`#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#Gtn(pQ!i,g'f&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#I{p(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#LPx!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T#LW^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![#Ir![!c(O!c!i#Ir!i#O(O#O#P&f#P#T(O#T#Z#Ir#Z;'S(O;'S;=`(o<%lO(O2T#M]t(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx#LPx{(O{|!Nb|}(O}!O!Nb!O!Q(O!Q![#Ir![!c(O!c!g#Ir!g!h#MS!h!i#Ir!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X#Ir#X#Y#MS#Y#Z#Ir#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$ xp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$$Xp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#LPx!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$&ht)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#LPx{$e{|#'Q|}$e}!O#'Q!O!Q$e!Q![$#|![!c$e!c!g$#|!g!h$&]!h!i$#|!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$#|#X#Y$&]#Y#Z$#|#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$)Tp)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$+b_)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$-`!R![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$,j[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![!GY![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$-kt)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx#Dgx!O$e!O!P$ m!P!Q$e!Q![$(x![!g$e!g!h#$w!h!i#*Y!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#U$e#U#V$/{#V#X$e#X#Y#$w#Y#Z#*Y#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e2]$0U[)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$(x![#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$1T`)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$2br)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2T$4s^(pQ'f&jOY(OZr(Ors%}s!Q(O!Q![$5o![!c(O!c!i$5o!i#O(O#O#P&f#P#T(O#T#Z$5o#Z;'S(O;'S;=`(o<%lO(O2T$5xr(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx$4lx!O(O!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2T$8]u(pQ!i,g'f&jOY(OZr(Ors%}sw(Owx$4lx{(O{|!Nb|}(O}!O!Nb!O!P#Gk!P!Q(O!Q![$5o![!c(O!c!g$5o!g!h$8S!h!i$5o!i!n(O!n!o##`!o!r(O!r!s!La!s!w(O!w!x##`!x#O(O#O#P&f#P#T(O#T#X$5o#X#Y$8S#Y#Z$5o#Z#`(O#`#a##`#a#d(O#d#e!La#e#i(O#i#j##`#j;'S(O;'S;=`(o<%lO(O2]$:{u)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx{$e{|#'Q|}$e}!O#'Q!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j;'S$e;'S;=`(u<%lO$e2]$=ic)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!O$e!O!P$,a!P!Q$e!Q!R$>t!R![$2V![!c$e!c!i$2V!i#O$e#O#P&f#P#T$e#T#Z$2V#Z;'S$e;'S;=`(u<%lO$e2]$?Pv)ZW(pQ!i,g'f&jOY$eZr$ers%^sw$ewx$4lx!O$e!O!P$ m!P!Q$e!Q![$2V![!c$e!c!g$2V!g!h$:p!h!i$2V!i!n$e!n!o#*Y!o!r$e!r!s#$w!s!w$e!w!x#*Y!x#O$e#O#P&f#P#T$e#T#U$2V#U#V$2V#V#X$2V#X#Y$:p#Y#Z$2V#Z#`$e#`#a#*Y#a#d$e#d#e#$w#e#i$e#i#j#*Y#j#l$e#l#m$0z#m;'S$e;'S;=`(u<%lO$e4e$Ar[(v-X)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox![$e![!]$Bh!]#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3s$BsYl-})ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e2]$CnY)W,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7V$Dk_p,g%]!b)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!^$Ej!^!_%+w!_!`%.U!`!a%0]!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej*[$Es])ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ejp$FoTO!`$Fl!`!a$GO!a;'S$Fl;'S;=`$GT<%lO$Flp$GTO$Wpp$GWP;=`<%l$Fl*Y$GbZ)ZW'f&jOY$GZYZ$FlZw$GZwx$HTx!`$GZ!`!a%(U!a#O$GZ#O#P$Ib#P;'S$GZ;'S;=`%(y<%lO$GZ*Q$HYX'f&jOY$HTYZ$FlZ!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q$IOU$WpY#t'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}*Q$Ig['f&jOY$HTYZ$HTZ]$HT]^$J]^!`$HT!`!a$NO!a#O$HT#O#P%&n#P;'S$HT;'S;=`%'f;=`<%l%$z<%lO$HT*Q$JbX'f&jOY$HTYZ$J}Z!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT'[$KSX'f&jOY$J}YZ$FlZ!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$KvU$Wp'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}'[$L_Z'f&jOY$J}YZ$J}Z]$J}]^$MQ^!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MVX'f&jOY$J}YZ$J}Z!`$J}!`!a$Ko!a#O$J}#O#P$LY#P;'S$J};'S;=`$Mr<%lO$J}'[$MuP;=`<%l$J}*Q$M{P;=`<%l$HT*Q$NVW$Wp'f&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`$NtW'f&jOY$NoZ!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`% eUY#t'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%})`% |Y'f&jOY$NoYZ$NoZ]$No]^%!l^#O$No#O#P%#d#P;'S$No;'S;=`%$[;=`<%l%$z<%lO$No)`%!qX'f&jOY$NoYZ%}Z!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%#aP;=`<%l$No)`%#iZ'f&jOY$NoYZ%}Z]$No]^%!l^!`$No!`!a% ^!a#O$No#O#P% w#P;'S$No;'S;=`%#^<%lO$No)`%$_XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$No<%lO%$z#t%$}WOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h<%lO%$z#t%%lOY#t#t%%oRO;'S%$z;'S;=`%%x;=`O%$z#t%%{XOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l%$z<%lO%$z#t%&kP;=`<%l%$z*Q%&sZ'f&jOY$HTYZ$J}Z]$HT]^$J]^!`$HT!`!a$Hu!a#O$HT#O#P$Ib#P;'S$HT;'S;=`$Mx<%lO$HT*Q%'iXOY%$zZ!`%$z!`!a%%g!a#O%$z#O#P%%l#P;'S%$z;'S;=`%&h;=`<%l$HT<%lO%$z*Y%(aW$WpY#t)ZW'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^*Y%(|P;=`<%l$GZ*S%)WZ(pQ'f&jOY%)PYZ$FlZr%)Prs$HTs!`%)P!`!a%)y!a#O%)P#O#P$Ib#P;'S%)P;'S;=`%*n<%lO%)P*S%*UW$WpY#t(pQ'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O*S%*qP;=`<%l%)P*[%+RY$WpY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e*[%+tP;=`<%l$Ej7V%,U^)ZW(pQ%[!b!f,g'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!_$Ej!_!`%-Q!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%-]]!g-y)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%*t!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%.c]%]!b!b,g)ZW(pQ'f&jOY$EjYZ$FlZr$Ejrs$GZsw$Ejwx%)Px!`$Ej!`!a%/[!a#O$Ej#O#P$Ib#P;'S$Ej;'S;=`%+q<%lO$Ej7V%/mY%]!b!b,g$WpY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e)j%0hYY#t)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%1c[)j!c)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`0Q!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%2f]%]!b)ZW(pQ!d,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`%3_!`!a%4[!a#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%3lY%]!b!b,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%4i[)ZW(pQ%[!b!f,g'f&jOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%5jY(uP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z%6ib)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e7Z%8Qb)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e5P%9cW)ZW(o/]'f&jOY%^Zw%^wx%}x#O%^#O#P&f#P;'S%^;'S;=`'x<%lO%^2T%:UW(pQ)Y,g'f&jOY(OZr(Ors%}s#O(O#O#P&f#P;'S(O;'S;=`(o<%lO(O3o%:yZ!V-y)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox!}$e!}#O%;l#O#P&f#P;'S$e;'S;=`(u<%lO$e&u%;wY)PP)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e4e%<la'f&jOY%=qYZ%>[Z]%=q]^%?Z^!Q%=q!Q![%?w![!w%=q!w!x%AX!x#O%=q#O#P%H_#P#i%=q#i#j%Ds#j#l%=q#l#m%IR#m;'S%=q;'S;=`%Kt<%lO%=q&t%=xUXY'f&jOY%}Z#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}4e%>e[XY(n.o'f&jOX%}XY-OYZ*[Z]%}]^-O^p%}pq-Oq#O%}#O#P,^#P;'S%};'S;=`'r<%lO%}4e%?bVXY'f&jOY%}YZ-OZ#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@OWXY'f&jOY%}Z!Q%}!Q![%@h![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%@oWXY'f&jOY%}Z!Q%}!Q![%=q![#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%A^['f&jOY%}Z!Q%}!Q![%BS![!c%}!c!i%BS!i#O%}#O#P&f#P#T%}#T#Z%BS#Z;'S%};'S;=`'r<%lO%}&t%BX['f&jOY%}Z!Q%}!Q![%B}![!c%}!c!i%B}!i#O%}#O#P&f#P#T%}#T#Z%B}#Z;'S%};'S;=`'r<%lO%}&t%CS['f&jOY%}Z!Q%}!Q![%Cx![!c%}!c!i%Cx!i#O%}#O#P&f#P#T%}#T#Z%Cx#Z;'S%};'S;=`'r<%lO%}&t%C}['f&jOY%}Z!Q%}!Q![%Ds![!c%}!c!i%Ds!i#O%}#O#P&f#P#T%}#T#Z%Ds#Z;'S%};'S;=`'r<%lO%}&t%Dx['f&jOY%}Z!Q%}!Q![%En![!c%}!c!i%En!i#O%}#O#P&f#P#T%}#T#Z%En#Z;'S%};'S;=`'r<%lO%}&t%Es['f&jOY%}Z!Q%}!Q![%Fi![!c%}!c!i%Fi!i#O%}#O#P&f#P#T%}#T#Z%Fi#Z;'S%};'S;=`'r<%lO%}&t%Fn['f&jOY%}Z!Q%}!Q![%Gd![!c%}!c!i%Gd!i#O%}#O#P&f#P#T%}#T#Z%Gd#Z;'S%};'S;=`'r<%lO%}&t%Gi['f&jOY%}Z!Q%}!Q![%=q![!c%}!c!i%=q!i#O%}#O#P&f#P#T%}#T#Z%=q#Z;'S%};'S;=`'r<%lO%}&t%HfXXY'f&jOY%}YZ%}Z]%}]^'W^#O%}#O#P&f#P;'S%};'S;=`'r<%lO%}&t%IW['f&jOY%}Z!Q%}!Q![%I|![!c%}!c!i%I|!i#O%}#O#P&f#P#T%}#T#Z%I|#Z;'S%};'S;=`'r<%lO%}&t%JR['f&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KO[XY'f&jOY%}Z!Q%}!Q![%Jw![!c%}!c!i%Jw!i#O%}#O#P&f#P#T%}#T#Z%Jw#Z;'S%};'S;=`'r<%lO%}&t%KwP;=`<%l%=q2a%LVZ!W,V)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P#Q%Lx#Q;'S$e;'S;=`(u<%lO$e'Y%MTY)]d)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o%NQ[)ZW(pQ%[!b'f&j!_,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e7Z& Vd)ZW(yS(pQ!R,f(r%y'f&jOY$eZr$ers%9Ysw$ewx%9{x!Q$e!Q!Y%6Y!Y!Z%7q!Z![%6Y![!c$e!c!}%6Y!}#O$e#O#P&f#P#R$e#R#S%6Y#S#T$e#T#o%6Y#o;'S$e;'S;=`(u<%lO$e2]&!pY!T,g)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e3o&#m^)ZW(pQ%[!b'f&j!^,gOY$eZr$ers%^sw$ewx(Ox!_$e!_!`!8g!`#O$e#O#P&f#P#p$e#p#q&$i#q;'S$e;'S;=`(u<%lO$e3o&$vY)T,g%^!b)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e'V&%qY!Ua)ZW(pQ'f&jOY$eZr$ers%^sw$ewx(Ox#O$e#O#P&f#P;'S$e;'S;=`(u<%lO$e(]&&nc)ZW(pQ%[!b'RP'f&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&(Sc)ZW(pQ'f&jOX$eXY&'yZp$epq&'yqr$ers%^sw$ewx(Ox!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e&y&)jb)ZW(pQdT'f&jOY$eZr$ers%^sw$ewx(Ox!Q$e!Q![&)_![!c$e!c!}&)_!}#O$e#O#P&f#P#R$e#R#S&)_#S#T$e#T#o&)_#o;'S$e;'S;=`(u<%lO$e",tokenizers:[rawString,fallback,0,1,2,3,4,5,6,7,8,9],topRules:{Program:[0,307]},dynamicPrecedences:{87:1,94:1,119:1,184:1,187:-10,240:-10,241:1,244:-1,246:-10,247:1,262:-1,267:2,268:2,306:-10,365:3,417:1,418:3,419:1,420:1},specialized:[{term:356,get:B=>spec_identifier[B]||-1},{term:32,get:B=>spec_[B]||-1},{term:66,get:B=>spec_templateArgsEnd[B]||-1},{term:363,get:B=>spec_scopedIdentifier[B]||-1}],tokenPrec:24891}),cppLanguage=LRLanguage.define({name:"cpp",parser:parser.configure({props:[indentNodeProp.add({IfStatement:continuedIndent({except:/^\s*({|else\b)/}),TryStatement:continuedIndent({except:/^\s*({|catch)\b/}),LabeledStatement:flatIndent,CaseStatement:B=>B.baseIndent+B.unit,BlockComment:()=>null,CompoundStatement:delimitedIndent({closing:"}"}),Statement:continuedIndent({except:/^{/})}),foldNodeProp.add({"DeclarationList CompoundStatement EnumeratorList FieldDeclarationList InitializerList":foldInside,BlockComment(B){return{from:B.from+2,to:B.to-2}}})]}),languageData:{commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\})$/,closeBrackets:{stringPrefixes:["L","u","U","u8","LR","UR","uR","u8R","R"]}}});function cpp(){return new LanguageSupport(cppLanguage)}const _withScopeId$2=B=>(pushScopeId("data-v-c96e8edb"),B=B(),popScopeId(),B),_hoisted_1$b=_withScopeId$2(()=>createBaseVNode("TresPerspectiveCamera",{position:[0,0,5]},null,-1)),_hoisted_2$6=_withScopeId$2(()=>createBaseVNode("TresAxesHelper",{args:[2]},null,-1)),_hoisted_3$5=_withScopeId$2(()=>createBaseVNode("TresBoxGeometry",{args:[2,2,2]},null,-1)),CommonVert$1=`
varying vec2 UV;
void main() {
    UV = uv;
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
}
`,CommonFrag$1=`
void main() {
  gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);
}
`,_sfc_main$b={__name:"ShaderFragBase",setup(B){const{onLoop:_}=G(),T=[{name:"",children:[{name:"1",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = st.x;
    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"2",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = 1.0-st.x-st.y; //
    c = abs(c);
    gl_FragColor = vec4(c, c, c, 1.0);
}

                `},{name:"3",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = st.x*st.x*st.x-st.y; //
    c = abs(c);
    gl_FragColor = vec4(c, c, c, 1.0);
}

                `},{name:"4",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = (st.x-0.5)*2.0;
    c = abs(c);
    gl_FragColor = vec4(0.0, c, 0.0, 1.0);
}
`},{name:"5",frag:`
uniform vec2 u_resolution;
varying vec2 UV;
void main() {
    vec2 st = UV;
    float c = 1.0-distance(st, vec2(0.5))*1.0;
    gl_FragColor = vec4(0.0, c, c, 1.0);
}
`}]},{name:"",children:[{name:"1",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = distance(st, vec2(0.5))*2.0;
    c = smoothstep(0.8, 0.9, c);
    
    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"2",frag:`

uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = st.x*st.x*st.x-st.y;
    c = abs(c);
    c = smoothstep(0.005, 0.015, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}

`},{name:"()",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    
    float c = st.x*st.y;
    vec3 color = mix(vec3(1.0, 0.0, 0.0), vec3(0.0, 1.0, 0.0), c);
    
    gl_FragColor = vec4(color, 1.0);
}
`}]},{name:"",children:[{name:"1",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 c = floor(st)*0.5;
    
    gl_FragColor = vec4(c, 0.0, 1.0);
}

`},{name:"2",frag:`
uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 c = fract(st);
    
    gl_FragColor = vec4(c, 0.0, 1.0);
}

`},{name:"3",frag:`

uniform vec2 u_resolution;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st *= 3.0;

    vec2 center = 0.5+floor(st);
    float c = distance(st, center)*2.0;
    
    gl_FragColor = vec4(c, c, c, 1.0);
}
`}]},{name:"",children:[{name:"",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st.x -= fract(u_time*0.2)*2.0-1.0;

    float c = distance(st, vec2(0.5))*2.0;
    c = step(0.5, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st -= 0.5;
    st /= sin(u_time);

    float c = distance(st, vec2(0.0))*2.0;
    c = step(1.0, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`},{name:"",frag:`
uniform vec2 u_resolution;
uniform float u_time;

varying vec2 UV;
void main() {
    vec2 st = UV;
    st -= 0.5;
    float theta = mod(u_time, 6.28);
    st = mat2(cos(theta), sin(theta), -sin(theta), cos(theta)) * st; //Z

    float c = st.x;
    c = abs(c);
    c = step(0.05, c);

    gl_FragColor = vec4(c, c, c, 1.0);
}
`}]}],E={u_time:{value:0},u_resolution:{value:{x:800,y:600}}};_(({elapsed:ue})=>{E.u_time.value=ue}),ref$1(!0);const W=shallowRef(null),X=shallowRef(null),q=ref$1(null);let Y=null;const te=ref$1(null);let ne=null;onMounted(()=>{const ue=EditorView.updateListener.of(ye=>{if(ye.docChanged){let xe=W.value;if(!xe)return;xe.vertexShader=ye.state.doc.toString(),xe.needsUpdate=!0}});Y=new EditorView({doc:"",extensions:[basicSetup,cpp(),ue],parent:q.value});const ge=EditorView.updateListener.of(ye=>{if(ye.docChanged){let xe=W.value;if(!xe)return;xe.fragmentShader=ye.state.doc.toString(),xe.needsUpdate=!0}});ne=new EditorView({doc:"",extensions:[basicSetup,cpp(),ge],parent:te.value}),E.u_resolution.value.x=X.value.clientWidth,E.u_resolution.value.y=X.value.clientHeight}),watch(W,()=>{le(0,0)});function ae(ue){return ue.trim()}function le(ue,ge){let xe=T[ue].children[ge],Te=xe.vert?xe.vert:CommonVert$1,Ae=xe.frag?xe.frag:CommonFrag$1;Te=ae(Te),Ae=ae(Ae);let Ie=Y,Ve=Ie.state.update({changes:{from:0,to:Ie.state.doc.length,insert:Te}});Ie.dispatch(Ve),Ie=ne,Ve=Ie.state.update({changes:{from:0,to:Ie.state.doc.length,insert:Ae}}),Ie.dispatch(Ve)}return(ue,ge)=>{const ye=resolveComponent("Button"),xe=resolveComponent("Card"),Te=resolveComponent("Col"),Ae=resolveComponent("Divider"),Ie=resolveComponent("Row");return openBlock(),createBlock(Ie,null,{default:withCtx(()=>[createVNode(Te,{span:4},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(T,(Ve,$e)=>createVNode(xe,null,{title:withCtx(()=>[createBaseVNode("h3",null,toDisplayString(Ve.name),1)]),default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(Ve.children,(We,Ue)=>(openBlock(),createBlock(ye,{onClick:je=>le($e,Ue)},{default:withCtx(()=>[createTextVNode(toDisplayString(We.name),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024)),64))]),_:1}),createVNode(Te,{span:10},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"tresCanvasParentRef",ref:X,class:"tresCanvasBorder"},[createVNode(unref(kr),{"clear-color":"#FDF5E6"},{default:withCtx(()=>[_hoisted_1$b,_hoisted_2$6,createBaseVNode("TresMesh",null,[_hoisted_3$5,createBaseVNode("TresShaderMaterial",{ref_key:"materialRef",ref:W,uniforms:E,vertexShader:CommonVert$1,fragmentShader:CommonFrag$1},null,512)]),createVNode(unref(xg))]),_:1})],512)]),_:1}),createVNode(Te,{span:10},{default:withCtx(()=>[createVNode(Ae,{orientation:"left"},{default:withCtx(()=>[createTextVNode("")]),_:1}),createBaseVNode("div",{ref_key:"codeContainerV",ref:q},null,512),createVNode(Ae,{orientation:"left"},{default:withCtx(()=>[createTextVNode("")]),_:1}),createBaseVNode("div",{ref_key:"codeContainerF",ref:te},null,512)]),_:1})]),_:1})}}},ShaderFragBase=_export_sfc(_sfc_main$b,[["__scopeId","data-v-c96e8edb"]]),_withScopeId$1=B=>(pushScopeId("data-v-53185512"),B=B(),popScopeId(),B),_hoisted_1$a=_withScopeId$1(()=>createBaseVNode("TresPerspectiveCamera",{position:[0,0,5]},null,-1)),_hoisted_2$5=_withScopeId$1(()=>createBaseVNode("TresAxesHelper",{args:[2]},null,-1)),_hoisted_3$4=_withScopeId$1(()=>createBaseVNode("TresBoxGeometry",{args:[2,3.6,2]},null,-1)),CommonVert=`
varying vec2 UV;
void main() {
    UV = uv;
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( position, 1.0 );
}
`,CommonFrag=`
void main() {
  gl_FragColor = vec4(0.5, 0.5, 0.5, 1.0);
}
`,_sfc_main$a={__name:"ShaderImageBase",setup(B){const{onLoop:_}=G(),T=[{name:"",children:[{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    gl_FragColor = color;
}
`},{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    float scale = abs(sin(u_time));
    scale *= 1.5;
    color.rgb *= scale;
    gl_FragColor = color;
}
`},{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;
void main() {
    vec4 color = texture2D(u_tex0, UV);
    float gray = color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
    gl_FragColor = vec4(gray, gray, gray, color.a);
}
`},{name:"",frag:`
varying vec2 UV;
uniform sampler2D u_tex0;
uniform float u_time;

void main() {
    vec4 self = texture2D(u_tex0, UV);

    if(self.a>0.5){
        gl_FragColor = self;
        return;
    }

    float outlineW = abs(sin(u_time))*0.01;
    // outlineW = 0.01;

    int strokeCount = 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x-outlineW, UV.y)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x+outlineW, UV.y)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x, UV.y-outlineW)).a>0.0 ? 1 : 0;
    strokeCount += texture2D(u_tex0, vec2(UV.x, UV.y+outlineW)).a>0.0 ? 1 : 0;

    if (strokeCount>0){
        self.rgb = vec3(1.0, 0.0, 1.0);
        self.a = 1.0;
    }

    gl_FragColor = self;
}
`}]}],E={u_time:{value:0},u_resolution:{value:{x:800,y:600}},u_tex0:{value:null}};_(({elapsed:ue})=>{E.u_time.value=ue}),ref$1(!0);const W=shallowRef(null),X=shallowRef(null),q=ref$1(null);let Y=null;const te=ref$1(null);let ne=null;onMounted(()=>{const ue=EditorView.updateListener.of(ye=>{if(ye.docChanged){let xe=W.value;if(!xe)return;xe.vertexShader=ye.state.doc.toString(),xe.needsUpdate=!0}});Y=new EditorView({doc:"",extensions:[basicSetup,cpp(),ue],parent:q.value});const ge=EditorView.updateListener.of(ye=>{if(ye.docChanged){let xe=W.value;if(!xe)return;xe.fragmentShader=ye.state.doc.toString(),xe.needsUpdate=!0}});ne=new EditorView({doc:"",extensions:[basicSetup,cpp(),ge],parent:te.value}),E.u_resolution.value.x=X.value.clientWidth,E.u_resolution.value.y=X.value.clientHeight,Nr$1({map:"img/img1.png"}).then(ye=>{E.u_tex0.value=ye.map})}),watch(W,()=>{le(0,0)});function ae(ue){return ue.trim()}function le(ue,ge){let xe=T[ue].children[ge],Te=xe.vert?xe.vert:CommonVert,Ae=xe.frag?xe.frag:CommonFrag;Te=ae(Te),Ae=ae(Ae);let Ie=Y,Ve=Ie.state.update({changes:{from:0,to:Ie.state.doc.length,insert:Te}});Ie.dispatch(Ve),Ie=ne,Ve=Ie.state.update({changes:{from:0,to:Ie.state.doc.length,insert:Ae}}),Ie.dispatch(Ve)}return(ue,ge)=>{const ye=resolveComponent("Button"),xe=resolveComponent("Card"),Te=resolveComponent("Col"),Ae=resolveComponent("Divider"),Ie=resolveComponent("Row");return openBlock(),createBlock(Ie,null,{default:withCtx(()=>[createVNode(Te,{span:4},{default:withCtx(()=>[(openBlock(),createElementBlock(Fragment,null,renderList(T,(Ve,$e)=>createVNode(xe,null,{title:withCtx(()=>[createBaseVNode("h3",null,toDisplayString(Ve.name),1)]),default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(Ve.children,(We,Ue)=>(openBlock(),createBlock(ye,{onClick:je=>le($e,Ue)},{default:withCtx(()=>[createTextVNode(toDisplayString(We.name),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024)),64))]),_:1}),createVNode(Te,{span:10},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"tresCanvasParentRef",ref:X,class:"tresCanvasBorder"},[createVNode(unref(kr),{"clear-color":"#FDF5E6"},{default:withCtx(()=>[_hoisted_1$a,_hoisted_2$5,createBaseVNode("TresMesh",null,[_hoisted_3$4,createBaseVNode("TresShaderMaterial",{ref_key:"materialRef",ref:W,uniforms:E,vertexShader:CommonVert,fragmentShader:CommonFrag},null,512)]),createVNode(unref(xg))]),_:1})],512)]),_:1}),createVNode(Te,{span:10},{default:withCtx(()=>[createVNode(Ae,{orientation:"left"},{default:withCtx(()=>[createTextVNode("")]),_:1}),createBaseVNode("div",{ref_key:"codeContainerV",ref:q},null,512),createVNode(Ae,{orientation:"left"},{default:withCtx(()=>[createTextVNode("")]),_:1}),createBaseVNode("div",{ref_key:"codeContainerF",ref:te},null,512)]),_:1})]),_:1})}}},ShaderImageBase=_export_sfc(_sfc_main$a,[["__scopeId","data-v-53185512"]]),_hoisted_1$9=["src"],_sfc_main$9={__name:"ShowVideo",props:{link:String,width:Number,height:Number},setup(B){const _=B,T=ref$1(null);return onMounted(()=>{var E=_.width?`${E}px`:"100%",W=_.height?`${W}px`:"100vh";T.value={width:E,height:W}}),(E,W)=>(openBlock(),createElementBlock("video",{src:_.link,style:normalizeStyle(T.value),controls:"",autoplay:"",loop:""},null,12,_hoisted_1$9))}};var Easing=Object.freeze({Linear:Object.freeze({None:function(B){return B},In:function(B){return B},Out:function(B){return B},InOut:function(B){return B}}),Quadratic:Object.freeze({In:function(B){return B*B},Out:function(B){return B*(2-B)},InOut:function(B){return(B*=2)<1?.5*B*B:-.5*(--B*(B-2)-1)}}),Cubic:Object.freeze({In:function(B){return B*B*B},Out:function(B){return--B*B*B+1},InOut:function(B){return(B*=2)<1?.5*B*B*B:.5*((B-=2)*B*B+2)}}),Quartic:Object.freeze({In:function(B){return B*B*B*B},Out:function(B){return 1- --B*B*B*B},InOut:function(B){return(B*=2)<1?.5*B*B*B*B:-.5*((B-=2)*B*B*B-2)}}),Quintic:Object.freeze({In:function(B){return B*B*B*B*B},Out:function(B){return--B*B*B*B*B+1},InOut:function(B){return(B*=2)<1?.5*B*B*B*B*B:.5*((B-=2)*B*B*B*B+2)}}),Sinusoidal:Object.freeze({In:function(B){return 1-Math.sin((1-B)*Math.PI/2)},Out:function(B){return Math.sin(B*Math.PI/2)},InOut:function(B){return .5*(1-Math.sin(Math.PI*(.5-B)))}}),Exponential:Object.freeze({In:function(B){return B===0?0:Math.pow(1024,B-1)},Out:function(B){return B===1?1:1-Math.pow(2,-10*B)},InOut:function(B){return B===0?0:B===1?1:(B*=2)<1?.5*Math.pow(1024,B-1):.5*(-Math.pow(2,-10*(B-1))+2)}}),Circular:Object.freeze({In:function(B){return 1-Math.sqrt(1-B*B)},Out:function(B){return Math.sqrt(1- --B*B)},InOut:function(B){return(B*=2)<1?-.5*(Math.sqrt(1-B*B)-1):.5*(Math.sqrt(1-(B-=2)*B)+1)}}),Elastic:Object.freeze({In:function(B){return B===0?0:B===1?1:-Math.pow(2,10*(B-1))*Math.sin((B-1.1)*5*Math.PI)},Out:function(B){return B===0?0:B===1?1:Math.pow(2,-10*B)*Math.sin((B-.1)*5*Math.PI)+1},InOut:function(B){return B===0?0:B===1?1:(B*=2,B<1?-.5*Math.pow(2,10*(B-1))*Math.sin((B-1.1)*5*Math.PI):.5*Math.pow(2,-10*(B-1))*Math.sin((B-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(B){var _=1.70158;return B===1?1:B*B*((_+1)*B-_)},Out:function(B){var _=1.70158;return B===0?0:--B*B*((_+1)*B+_)+1},InOut:function(B){var _=2.5949095;return(B*=2)<1?.5*(B*B*((_+1)*B-_)):.5*((B-=2)*B*((_+1)*B+_)+2)}}),Bounce:Object.freeze({In:function(B){return 1-Easing.Bounce.Out(1-B)},Out:function(B){return B<1/2.75?7.5625*B*B:B<2/2.75?7.5625*(B-=1.5/2.75)*B+.75:B<2.5/2.75?7.5625*(B-=2.25/2.75)*B+.9375:7.5625*(B-=2.625/2.75)*B+.984375},InOut:function(B){return B<.5?Easing.Bounce.In(B*2)*.5:Easing.Bounce.Out(B*2-1)*.5+.5}}),generatePow:function(B){return B===void 0&&(B=4),B=B<Number.EPSILON?Number.EPSILON:B,B=B>1e4?1e4:B,{In:function(_){return Math.pow(_,B)},Out:function(_){return 1-Math.pow(1-_,B)},InOut:function(_){return _<.5?Math.pow(_*2,B)/2:(1-Math.pow(2-_*2,B))/2+.5}}}}),now$1=function(){return performance.now()},Group=function(){function B(){this._tweens={},this._tweensAddedDuringUpdate={}}return B.prototype.getAll=function(){var _=this;return Object.keys(this._tweens).map(function(T){return _._tweens[T]})},B.prototype.removeAll=function(){this._tweens={}},B.prototype.add=function(_){this._tweens[_.getId()]=_,this._tweensAddedDuringUpdate[_.getId()]=_},B.prototype.remove=function(_){delete this._tweens[_.getId()],delete this._tweensAddedDuringUpdate[_.getId()]},B.prototype.update=function(_,T){_===void 0&&(_=now$1()),T===void 0&&(T=!1);var E=Object.keys(this._tweens);if(E.length===0)return!1;for(;E.length>0;){this._tweensAddedDuringUpdate={};for(var W=0;W<E.length;W++){var X=this._tweens[E[W]],q=!T;X&&X.update(_,q)===!1&&!T&&delete this._tweens[E[W]]}E=Object.keys(this._tweensAddedDuringUpdate)}return!0},B}(),Interpolation={Linear:function(B,_){var T=B.length-1,E=T*_,W=Math.floor(E),X=Interpolation.Utils.Linear;return _<0?X(B[0],B[1],E):_>1?X(B[T],B[T-1],T-E):X(B[W],B[W+1>T?T:W+1],E-W)},Bezier:function(B,_){for(var T=0,E=B.length-1,W=Math.pow,X=Interpolation.Utils.Bernstein,q=0;q<=E;q++)T+=W(1-_,E-q)*W(_,q)*B[q]*X(E,q);return T},CatmullRom:function(B,_){var T=B.length-1,E=T*_,W=Math.floor(E),X=Interpolation.Utils.CatmullRom;return B[0]===B[T]?(_<0&&(W=Math.floor(E=T*(1+_))),X(B[(W-1+T)%T],B[W],B[(W+1)%T],B[(W+2)%T],E-W)):_<0?B[0]-(X(B[0],B[0],B[1],B[1],-E)-B[0]):_>1?B[T]-(X(B[T],B[T],B[T-1],B[T-1],E-T)-B[T]):X(B[W?W-1:0],B[W],B[T<W+1?T:W+1],B[T<W+2?T:W+2],E-W)},Utils:{Linear:function(B,_,T){return(_-B)*T+B},Bernstein:function(B,_){var T=Interpolation.Utils.Factorial;return T(B)/T(_)/T(B-_)},Factorial:function(){var B=[1];return function(_){var T=1;if(B[_])return B[_];for(var E=_;E>1;E--)T*=E;return B[_]=T,T}}(),CatmullRom:function(B,_,T,E,W){var X=(T-B)*.5,q=(E-_)*.5,Y=W*W,te=W*Y;return(2*_-2*T+X+q)*te+(-3*_+3*T-2*X-q)*Y+X*W+_}}},Sequence=function(){function B(){}return B.nextId=function(){return B._nextId++},B._nextId=0,B}(),mainGroup=new Group,Tween=function(){function B(_,T){T===void 0&&(T=mainGroup),this._object=_,this._group=T,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Easing.Linear.None,this._interpolationFunction=Interpolation.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Sequence.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return B.prototype.getId=function(){return this._id},B.prototype.isPlaying=function(){return this._isPlaying},B.prototype.isPaused=function(){return this._isPaused},B.prototype.getDuration=function(){return this._duration},B.prototype.to=function(_,T){if(T===void 0&&(T=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=_,this._propertiesAreSetUp=!1,this._duration=T<0?0:T,this},B.prototype.duration=function(_){return _===void 0&&(_=1e3),this._duration=_<0?0:_,this},B.prototype.dynamic=function(_){return _===void 0&&(_=!1),this._isDynamic=_,this},B.prototype.start=function(_,T){if(_===void 0&&(_=now$1()),T===void 0&&(T=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var E in this._valuesStartRepeat)this._swapEndStartRepeatValues(E),this._valuesStart[E]=this._valuesStartRepeat[E]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=_,this._startTime+=this._delayTime,!this._propertiesAreSetUp||T){if(this._propertiesAreSetUp=!0,!this._isDynamic){var W={};for(var X in this._valuesEnd)W[X]=this._valuesEnd[X];this._valuesEnd=W}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,T)}return this},B.prototype.startFromCurrentValues=function(_){return this.start(_,!0)},B.prototype._setupProperties=function(_,T,E,W,X){for(var q in E){var Y=_[q],te=Array.isArray(Y),ne=te?"array":typeof Y,ae=!te&&Array.isArray(E[q]);if(!(ne==="undefined"||ne==="function")){if(ae){var le=E[q];if(le.length===0)continue;for(var ue=[Y],ge=0,ye=le.length;ge<ye;ge+=1){var xe=this._handleRelativeValue(Y,le[ge]);if(isNaN(xe)){ae=!1,console.warn("Found invalid interpolation list. Skipping.");break}ue.push(xe)}ae&&(E[q]=ue)}if((ne==="object"||te)&&Y&&!ae){T[q]=te?[]:{};var Te=Y;for(var Ae in Te)T[q][Ae]=Te[Ae];W[q]=te?[]:{};var le=E[q];if(!this._isDynamic){var Ie={};for(var Ae in le)Ie[Ae]=le[Ae];E[q]=le=Ie}this._setupProperties(Te,T[q],le,W[q],X)}else(typeof T[q]>"u"||X)&&(T[q]=Y),te||(T[q]*=1),ae?W[q]=E[q].slice().reverse():W[q]=T[q]||0}}},B.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},B.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},B.prototype.pause=function(_){return _===void 0&&(_=now$1()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=_,this._group&&this._group.remove(this),this)},B.prototype.resume=function(_){return _===void 0&&(_=now$1()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=_-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},B.prototype.stopChainedTweens=function(){for(var _=0,T=this._chainedTweens.length;_<T;_++)this._chainedTweens[_].stop();return this},B.prototype.group=function(_){return _===void 0&&(_=mainGroup),this._group=_,this},B.prototype.delay=function(_){return _===void 0&&(_=0),this._delayTime=_,this},B.prototype.repeat=function(_){return _===void 0&&(_=0),this._initialRepeat=_,this._repeat=_,this},B.prototype.repeatDelay=function(_){return this._repeatDelayTime=_,this},B.prototype.yoyo=function(_){return _===void 0&&(_=!1),this._yoyo=_,this},B.prototype.easing=function(_){return _===void 0&&(_=Easing.Linear.None),this._easingFunction=_,this},B.prototype.interpolation=function(_){return _===void 0&&(_=Interpolation.Linear),this._interpolationFunction=_,this},B.prototype.chain=function(){for(var _=[],T=0;T<arguments.length;T++)_[T]=arguments[T];return this._chainedTweens=_,this},B.prototype.onStart=function(_){return this._onStartCallback=_,this},B.prototype.onEveryStart=function(_){return this._onEveryStartCallback=_,this},B.prototype.onUpdate=function(_){return this._onUpdateCallback=_,this},B.prototype.onRepeat=function(_){return this._onRepeatCallback=_,this},B.prototype.onComplete=function(_){return this._onCompleteCallback=_,this},B.prototype.onStop=function(_){return this._onStopCallback=_,this},B.prototype.update=function(_,T){var E;if(_===void 0&&(_=now$1()),T===void 0&&(T=!0),this._isPaused)return!0;var W=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(_>W)return!1;T&&this.start(_,!0)}if(this._goToEnd=!1,_<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var X=_-this._startTime,q=this._duration+((E=this._repeatDelayTime)!==null&&E!==void 0?E:this._delayTime),Y=this._duration+this._repeat*q,te=this._calculateElapsedPortion(X,q,Y),ne=this._easingFunction(te),ae=this._calculateCompletionStatus(X,q);if(ae==="repeat"&&this._processRepetition(X,q),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,ne),ae==="about-to-repeat"&&this._processRepetition(X,q),this._onUpdateCallback&&this._onUpdateCallback(this._object,te),ae==="repeat"||ae==="about-to-repeat")this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1;else if(ae==="completed"){this._isPlaying=!1,this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var le=0,ue=this._chainedTweens.length;le<ue;le++)this._chainedTweens[le].start(this._startTime+this._duration,!1)}return ae!=="completed"},B.prototype._calculateElapsedPortion=function(_,T,E){if(this._duration===0||_>E)return 1;var W=_%T,X=Math.min(W/this._duration,1);return X===0&&_!==0&&_%this._duration===0?1:X},B.prototype._calculateCompletionStatus=function(_,T){return this._duration!==0&&_<this._duration?"playing":this._repeat<=0?"completed":_===this._duration?"about-to-repeat":"repeat"},B.prototype._processRepetition=function(_,T){var E=Math.min(Math.trunc((_-this._duration)/T)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=E);for(var W in this._valuesStartRepeat){var X=this._valuesEnd[W];!this._yoyo&&typeof X=="string"&&(this._valuesStartRepeat[W]=this._valuesStartRepeat[W]+parseFloat(X)),this._yoyo&&this._swapEndStartRepeatValues(W),this._valuesStart[W]=this._valuesStartRepeat[W]}this._yoyo&&(this._reversed=!this._reversed),this._startTime+=T*E},B.prototype._updateProperties=function(_,T,E,W){for(var X in E)if(T[X]!==void 0){var q=T[X]||0,Y=E[X],te=Array.isArray(_[X]),ne=Array.isArray(Y),ae=!te&&ne;ae?_[X]=this._interpolationFunction(Y,W):typeof Y=="object"&&Y?this._updateProperties(_[X],q,Y,W):(Y=this._handleRelativeValue(q,Y),typeof Y=="number"&&(_[X]=q+(Y-q)*W))}},B.prototype._handleRelativeValue=function(_,T){return typeof T!="string"?T:T.charAt(0)==="+"||T.charAt(0)==="-"?_+parseFloat(T):parseFloat(T)},B.prototype._swapEndStartRepeatValues=function(_){var T=this._valuesStartRepeat[_],E=this._valuesEnd[_];typeof E=="string"?this._valuesStartRepeat[_]=this._valuesStartRepeat[_]+parseFloat(E):this._valuesStartRepeat[_]=this._valuesEnd[_],this._valuesEnd[_]=T},B}(),VERSION="23.1.2",nextId=Sequence.nextId,TWEEN=mainGroup,getAll=TWEEN.getAll.bind(TWEEN),removeAll=TWEEN.removeAll.bind(TWEEN),add=TWEEN.add.bind(TWEEN),remove=TWEEN.remove.bind(TWEEN),update=TWEEN.update.bind(TWEEN),exports={Easing,Group,Interpolation,now:now$1,Sequence,nextId,Tween,VERSION,getAll,removeAll,add,remove,update};const _hoisted_1$8={class:"game-container"},_sfc_main$8={__name:"BallGame",setup(B){const _=["ballgame/player_run.png","ballgame/player_win.png","ballgame/player_fail.png","ballgame/bomb.png","ballgame/hankey.png","ballgame/star_small.png"],T=[{name:"",targetScore:5,path:{type:"line",start:{x:.1,y:.7},end:{x:.9,y:.7},width:.06},obstacles:{interval:2e3,types:["hankey","hankey","bomb"]},playerSpeed:.012},{name:"",targetScore:8,path:{type:"arc",center:{x:.5,y:.7},radiusX:.4,radiusY:.15,startAngle:0,endAngle:Math.PI,width:.06},obstacles:{interval:1800,types:["hankey","hankey","hankey","bomb"]},playerSpeed:.014},{name:"",targetScore:10,path:{type:"sin",start:{x:.1,y:.7},end:{x:.9,y:.7},amplitude:.04,frequency:2,width:.06},obstacles:{interval:1600,types:["hankey","hankey","bomb","bomb"]},playerSpeed:.016},{name:"",targetScore:10,path:{type:"circle",center:{x:.5,y:.7},radius:.4,width:.06},obstacles:{interval:1400,types:["hankey","bomb"]},playerSpeed:.01},{name:"",targetScore:10,path:{type:"wave",start:{x:.1,y:.7},end:{x:.9,y:.7},amplitude:.12,frequency:2,width:.06},obstacles:{interval:1200,types:["hankey","bomb"]},playerSpeed:.03}];class E{constructor(le,ue,ge){this.pixi=le,this.path=ue,this.speed=ge,this.sprite=null,this.currentPosition=0,this.direction=1,this.isMoving=!1,this.init()}init(){this.sprite=new Sprite$1(this.pixi.gameApp.textures["ballgame/player_run.png"]),this.sprite.anchor.set(.5),this.pixi.stage.addChild(this.sprite),this.updatePosition()}updatePosition(){const le=this.getPathPosition(this.currentPosition);this.sprite.x=le.x,this.sprite.y=le.y,this.direction<0?this.sprite.scale.x=-1:this.sprite.scale.x=1}getPathPosition(le){const ue=this.pixi.screen.width,ge=this.pixi.screen.height;switch(this.path.type){case"line":return{x:this.path.start.x*ue+(this.path.end.x*ue-this.path.start.x*ue)*le,y:this.path.start.y*ge+(this.path.end.y*ge-this.path.start.y*ge)*le};case"arc":const ye=this.path.startAngle+(this.path.endAngle-this.path.startAngle)*le;return{x:this.path.center.x*ue+Math.cos(ye)*this.path.radiusX*ue,y:this.path.center.y*ge+Math.sin(ye)*this.path.radiusY*ge};case"sin":const xe=this.path.start.x*ue+(this.path.end.x*ue-this.path.start.x*ue)*le,Te=Math.sin(le*this.path.frequency*Math.PI*2)*this.path.amplitude*ge;return{x:xe,y:this.path.start.y*ge+Te};case"wave":const Ae=this.path.start.x*ue,Ie=this.path.end.x*ue,Ve=this.path.start.y*ge,$e=this.path.amplitude*ge,We=this.path.frequency,Ue=Ie-Ae,je=Ue/We,ze=Ae+le*Ue,He=(ze-Ae)%je/je,Le=Ve+$e,qe=Ve-$e,Qe=1-He,Ke=He,Je=Qe*Qe*Qe*Ve+3*Qe*Qe*Ke*Le+3*Qe*Ke*Ke*qe+Ke*Ke*Ke*Ve;return{x:ze,y:Je};case"circle":const pt=le*Math.PI*2,ut=this.path.radius*Math.min(ue,ge);return{x:this.path.center.x*ue+Math.cos(pt)*ut,y:this.path.center.y*ge+Math.sin(pt)*ut};case"polyline":const lt=this.path.points.length-1,st=Math.floor(le*lt),sr=le*lt%1,mt=Math.min(st,lt-1),Tr=this.path.points[mt],di=this.path.points[mt+1];return{x:Tr.x*ue+(di.x*ue-Tr.x*ue)*sr,y:Tr.y*ge+(di.y*ge-Tr.y*ge)*sr}}}update(){this.isMoving&&(this.currentPosition+=this.speed*this.direction,this.currentPosition>=1?(this.currentPosition=1,this.direction=-1):this.currentPosition<=0&&(this.currentPosition=0,this.direction=1),this.updatePosition())}reverse(){this.direction*=-1}start(){this.isMoving=!0}getBounds(){const le=this.sprite.getBounds(),ue=.9,ge=le.x+le.width/2,ye=le.y+le.height/2,xe=le.width*ue,Te=le.height*ue;return{x:ge-xe/2,y:ye-Te/2,width:xe,height:Te}}}class W{constructor(le,ue,ge,ye){this.pixi=le,this.type=ue,this.sprite=null,this.x=ge,this.y=ye,this.speed=8,this.init()}init(){const le=this.type==="bomb"?"ballgame/bomb.png":"ballgame/hankey.png";this.sprite=new Sprite$1(this.pixi.gameApp.textures[le]),this.sprite.anchor.set(.5),this.sprite.x=this.x,this.sprite.y=this.y,this.pixi.stage.addChild(this.sprite)}update(){this.sprite.y+=this.speed}isOutOfScreen(){return this.sprite.y>this.pixi.screen.height+100}getBounds(){const le=this.sprite.getBounds(),ue=.9,ge=le.x+le.width/2,ye=le.y+le.height/2,xe=le.width*ue,Te=le.height*ue;return{x:ge-xe/2,y:ye-Te/2,width:xe,height:Te}}destroy(){this.sprite&&this.sprite.parent&&this.sprite.parent.removeChild(this.sprite)}}class X{constructor(){this.pixi=null,this.currentLevel=0,this.score=0,this.gameState="waiting",this.player=null,this.obstacles=[],this.pathGraphics=null,this.scoreText=null,this.levelText=null,this.instructionText=null,this.obstacleTimer=0,this.lastObstacleTime=0,this.audioContext=null,this.sounds={},this.textures={},this.resourcesLoaded=!1,this.starContainer=null,this.baseFontStyle={fontFamily:"Verdana, Geneva, sans-serif",fontWeight:"bold",strokeThickness:5}}async init(){this.pixi=createPixi(ne.value),this.pixi.gameApp=this,this.pixi.stage.eventMode="static",this.pixi.stage.hitArea=this.pixi.screen,this.pixi.stage.on("pointerdown",this.handleClick.bind(this)),this.starContainer=new Container,this.pixi.stage.addChildAt(this.starContainer,0),this.initAudio(),this.pixi.ticker.add(this.gameLoop,this)}setTextures(le){this.textures=le,this.resourcesLoaded=!0,this.createBackground(),this.initUI(),this.initGame()}createBackground(){for(let le=0;le<30;le++){const ue=new Sprite$1(this.textures["ballgame/star_small.png"]);ue.anchor.set(.5),ue.x=Math.random()*this.pixi.screen.width,ue.y=Math.random()*this.pixi.screen.height,ue.scale.set(Math.random()*.5+.5),ue.alpha=Math.random()*.4+.2,this.starContainer.addChild(ue)}}initAudio(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.loadSound("ballgame/ball_click.mp3","click"),this.loadSound("ballgame/ball_bomb.mp3","bomb"),this.loadSound("ballgame/ball_collect.mp3","collect")}async loadSound(le,ue){try{const ye=await(await fetch(le)).arrayBuffer(),xe=await this.audioContext.decodeAudioData(ye);this.sounds[ue]=xe}catch(ge){console.log(":",ge)}}playSound(le){if(this.sounds[le]&&this.audioContext.state==="running"){const ue=this.audioContext.createBufferSource();ue.buffer=this.sounds[le],ue.connect(this.audioContext.destination),ue.start()}}initUI(){this.titleText=new Text$1("",{...this.baseFontStyle,fontSize:64,fill:14540262,dropShadow:!0,dropShadowColor:16777215,dropShadowBlur:4,dropShadowDistance:2}),this.titleText.anchor.set(0,.5),this.titleText.x=this.pixi.screen.width*.05,this.titleText.y=this.pixi.screen.height*.04,this.pixi.stage.addChild(this.titleText),this.levelText=new Text$1("",{...this.baseFontStyle,fontSize:48,fill:11591910,dropShadow:!0,dropShadowColor:16777215,dropShadowBlur:2,dropShadowDistance:1}),this.levelText.anchor.set(0,.5),this.levelText.x=this.pixi.screen.width*.05,this.levelText.y=this.pixi.screen.height*.08,this.pixi.stage.addChild(this.levelText),this.scoreText=new Text$1("0/5",{...this.baseFontStyle,fontSize:56,fill:11591910,dropShadow:!0,dropShadowColor:16777215,dropShadowBlur:2,dropShadowDistance:1}),this.scoreText.anchor.set(1,.5),this.scoreText.x=this.pixi.screen.width*.95,this.scoreText.y=this.pixi.screen.height*.04,this.pixi.stage.addChild(this.scoreText),this.instructionText=new Text$1("",{...this.baseFontStyle,fontSize:60,fill:11591910}),this.instructionText.anchor.set(.5),this.instructionText.x=this.pixi.screen.width*.5,this.instructionText.y=this.pixi.screen.height*.35,this.pixi.stage.addChild(this.instructionText),this.helpText=new Text$1(`
`,{...this.baseFontStyle,fontSize:50,fill:11591910,align:"center"}),this.helpText.anchor.set(.5),this.helpText.x=this.pixi.screen.width*.5,this.helpText.y=this.pixi.screen.height*.45,this.pixi.stage.addChild(this.helpText)}initGame(){this.loadLevel(this.currentLevel),this.updateUI()}loadLevel(le){this.cleanupLevel();const ue=T[le];this.levelText.text=`${ue.name}`,this.drawPath(ue.path),this.player=new E(this.pixi,ue.path,ue.playerSpeed),this.score=0,this.gameState="waiting",this.obstacles=[],this.obstacleTimer=0,this.lastObstacleTime=0,this.updateUI()}drawPath(le){this.pathGraphics&&this.pixi.stage.removeChild(this.pathGraphics),this.pathGraphics=new Graphics;const ue=this.pixi.screen.width,ge=this.pixi.screen.height,ye=le.width*ue;switch(this.pathGraphics.lineStyle(ye,6710886,.5),le.type){case"line":this.drawRoundedLine(le.start.x*ue,le.start.y*ge,le.end.x*ue,le.end.y*ge,ye/2);break;case"arc":const xe=100;for(let He=0;He<=xe;He++){const Le=He/xe,qe=le.startAngle+(le.endAngle-le.startAngle)*Le,Qe=le.center.x*ue+Math.cos(qe)*le.radiusX*ue,Ke=le.center.y*ge+Math.sin(qe)*le.radiusY*ge;He===0?this.pathGraphics.moveTo(Qe,Ke):this.pathGraphics.lineTo(Qe,Ke)}break;case"sin":const Te=200;for(let He=0;He<=Te;He++){const Le=He/Te,qe=le.start.x*ue+(le.end.x*ue-le.start.x*ue)*Le,Qe=Math.sin(Le*le.frequency*Math.PI*2)*le.amplitude*ge,Ke=le.start.y*ge+Qe;He===0?this.pathGraphics.moveTo(qe,Ke):this.pathGraphics.lineTo(qe,Ke)}break;case"wave":const Ae=le.start.x*ue,Ie=le.end.x*ue,Ve=le.start.y*ge,$e=le.amplitude*ge,We=le.frequency,je=(Ie-Ae)/We;this.pathGraphics.moveTo(Ae,Ve);for(let He=0;He<We;He++){const Le=Ae+He*je,qe=Ae+(He+1)*je,Qe=Le+je*.25,Ke=Ve+$e,Je=Le+je*.75,pt=Ve-$e;this.pathGraphics.bezierCurveTo(Qe,Ke,Je,pt,qe,Ve)}break;case"circle":const ze=100;for(let He=0;He<=ze;He++){const qe=He/ze*Math.PI*2,Qe=le.radius*Math.min(ue,ge),Ke=le.center.x*ue+Math.cos(qe)*Qe,Je=le.center.y*ge+Math.sin(qe)*Qe;He===0?this.pathGraphics.moveTo(Ke,Je):this.pathGraphics.lineTo(Ke,Je)}break;case"polyline":this.pathGraphics.moveTo(le.points[0].x*ue,le.points[0].y*ge);for(let He=1;He<le.points.length;He++)this.pathGraphics.lineTo(le.points[He].x*ue,le.points[He].y*ge);break}this.pixi.stage.addChild(this.pathGraphics)}drawRoundedLine(le,ue,ge,ye,xe){const Te=ge-le,Ae=ye-ue,Ie=Math.sqrt(Te*Te+Ae*Ae);if(Ie===0)return;const Ve=Te/Ie,$e=Ae/Ie;this.pathGraphics.moveTo(le+Ve*xe,ue+$e*xe),this.pathGraphics.lineTo(ge-Ve*xe,ye-$e*xe)}getWavePosition(le,ue){const ge=this.pixi.screen.width,ye=this.pixi.screen.height,xe=le.start.x*ge+(le.end.x*ge-le.start.x*ge)*ue,Te=Math.sin(ue*le.frequency*Math.PI*2)*le.amplitude*ye;return{x:xe,y:le.start.y*ye+Te}}cleanupLevel(){this.obstacles.forEach(le=>le.destroy()),this.obstacles=[],this.player&&this.player.sprite&&this.pixi.stage.removeChild(this.player.sprite),this.pathGraphics&&this.pixi.stage.removeChild(this.pathGraphics)}updateUI(){const le=T[this.currentLevel];this.scoreText.text=`${this.score}/${le.targetScore}`,this.gameState==="waiting"?(this.instructionText.text="",this.instructionText.visible=!1,this.helpText.visible=!0):this.gameState==="playing"?(this.instructionText.visible=!1,this.helpText.visible=!1):this.gameState==="gameover"?(this.instructionText.text="",this.instructionText.visible=!0,this.helpText.visible=!1):this.gameState==="win"&&(this.instructionText.text="",this.instructionText.visible=!0,this.helpText.visible=!1)}startGame(){this.gameState==="waiting"?(this.gameState="playing",this.player.start(),this.playSound("click"),this.updateUI()):this.gameState==="gameover"?this.loadLevel(this.currentLevel):this.gameState==="win"&&(this.currentLevel++,this.currentLevel>=T.length&&(this.currentLevel=0),this.loadLevel(this.currentLevel))}reversePlayer(){this.gameState==="playing"&&this.player&&(this.player.reverse(),this.playSound("click"))}spawnObstacle(){const le=T[this.currentLevel],ue=le.obstacles.types[Math.floor(Math.random()*le.obstacles.types.length)],ge=Math.random()*this.pixi.screen.width*.8+this.pixi.screen.width*.1,ye=new W(this.pixi,ue,ge,-50);this.obstacles.push(ye)}checkCollisions(){if(!this.player)return;const le=this.player.getBounds();for(let ue=this.obstacles.length-1;ue>=0;ue--){const ge=this.obstacles[ue],ye=ge.getBounds();if(this.isColliding(le,ye)){if(ge.type==="bomb")this.score=0,this.playSound("bomb"),this.gameState="gameover",this.updateUI(),this.createExplosion(ge.sprite.x,ge.sprite.y),this.showFailScreen();else if(ge.type==="hankey"){this.score++,this.playSound("collect"),this.createHankeyFlyEffect(ge.sprite.x,ge.sprite.y);const xe=T[this.currentLevel];this.score>=xe.targetScore&&(this.gameState="win",this.updateUI(),this.showWinScreen())}ge.destroy(),this.obstacles.splice(ue,1)}}}createExplosion(le,ue){const ge=new Graphics;ge.beginFill(16711680,.8),ge.drawCircle(0,0,50),ge.endFill(),ge.x=le,ge.y=ue,ge.alpha=1,ge.scale.set(1),this.pixi.stage.addChild(ge);const ye={scale:1,alpha:1};new exports.Tween(ye).to({scale:2,alpha:0},800).easing(exports.Easing.Quadratic.Out).onUpdate(()=>{ge.alpha=ye.alpha,ge.scale.set(ye.scale)}).onComplete(()=>{this.pixi.stage.removeChild(ge)}).start()}createHankeyFlyEffect(le,ue){const ge=new Sprite$1(this.textures["ballgame/hankey.png"]);ge.anchor.set(.5),ge.x=le,ge.y=ue,ge.scale.set(1),this.pixi.stage.addChild(ge);const ye=this.scoreText.x-this.scoreText.width/2,xe=this.scoreText.y,Te={x:le,y:ue,scale:1};new exports.Tween(Te).to({x:ye,y:xe,scale:.5},600).easing(exports.Easing.Quadratic.InOut).onUpdate(()=>{ge.x=Te.x,ge.y=Te.y,ge.scale.set(Te.scale)}).onComplete(()=>{this.pixi.stage.removeChild(ge),this.updateUI()}).start()}showFailScreen(){const le=new Sprite$1(this.textures["ballgame/player_fail.png"]);le.anchor.set(.5),le.x=this.pixi.screen.width*.5,le.y=this.pixi.screen.height*.5,le.alpha=0,this.pixi.stage.addChild(le);const ue={alpha:0};new exports.Tween(ue).to({alpha:1},500).easing(exports.Easing.Quadratic.Out).onUpdate(()=>{le.alpha=ue.alpha}).chain(new exports.Tween(ue).to({alpha:0},500).delay(1e3).easing(exports.Easing.Quadratic.In).onUpdate(()=>{le.alpha=ue.alpha}).onComplete(()=>{this.pixi.stage.removeChild(le)})).start()}showWinScreen(){const le=new Sprite$1(this.textures["ballgame/player_win.png"]);le.anchor.set(.5),le.x=this.pixi.screen.width*.5,le.y=this.pixi.screen.height*.5,le.alpha=0,le.scale.set(1),this.pixi.stage.addChild(le);for(let ge=0;ge<20;ge++){const ye=new Graphics;ye.beginFill(16776960,.8),ye.drawCircle(0,0,5),ye.endFill(),ye.x=this.pixi.screen.width*.5,ye.y=this.pixi.screen.height*.5,ye.alpha=0,this.pixi.stage.addChild(ye);const xe=Math.PI*2*ge/20,Te=100+Math.random()*50,Ae=this.pixi.screen.width*.5+Math.cos(xe)*Te,Ie=this.pixi.screen.height*.5+Math.sin(xe)*Te,Ve={x:ye.x,y:ye.y,alpha:0};new exports.Tween(Ve).to({alpha:1},300).delay(ge*100).easing(exports.Easing.Quadratic.Out).onUpdate(()=>{ye.alpha=Ve.alpha}).chain(new exports.Tween(Ve).to({x:Ae,y:Ie,alpha:0},1500).easing(exports.Easing.Quadratic.In).onUpdate(()=>{ye.x=Ve.x,ye.y=Ve.y,ye.alpha=Ve.alpha}).onComplete(()=>{this.pixi.stage.removeChild(ye)})).start()}const ue={alpha:0,scale:1.2};le.scale.set(ue.scale),new exports.Tween(ue).to({alpha:1,scale:1.2},800).easing(exports.Easing.Back.Out).onUpdate(()=>{le.alpha=ue.alpha,le.scale.set(ue.scale)}).chain(new exports.Tween(ue).to({scale:1},300).easing(exports.Easing.Quadratic.Out).onUpdate(()=>{le.scale.set(ue.scale)}).chain(new exports.Tween(ue).to({alpha:0},500).delay(2e3).easing(exports.Easing.Quadratic.In).onUpdate(()=>{le.alpha=ue.alpha}).onComplete(()=>{this.pixi.stage.removeChild(le)}))).start()}isColliding(le,ue){return le.x<ue.x+ue.width&&le.x+le.width>ue.x&&le.y<ue.y+ue.height&&le.y+le.height>ue.y}gameLoop(){const le=Date.now();if(exports.update(),this.gameState==="playing"){this.player&&this.player.update();const ue=T[this.currentLevel];le-this.lastObstacleTime>ue.obstacles.interval&&(this.spawnObstacle(),this.lastObstacleTime=le);for(let ge=this.obstacles.length-1;ge>=0;ge--){const ye=this.obstacles[ge];ye.update(),ye.isOutOfScreen()&&(ye.destroy(),this.obstacles.splice(ge,1))}this.checkCollisions()}}handleClick(le){const ue={x:le.global.x,y:le.global.y};this.createSpreadCircle(ue),this.gameState==="waiting"||this.gameState==="gameover"||this.gameState==="win"?this.startGame():this.gameState==="playing"&&this.reversePlayer()}createSpreadCircle(le){const ue=new Graphics,ge=6737151;ue.beginFill(ge,1),ue.drawCircle(0,0,10),ue.endFill(),ue.x=le.x,ue.y=le.y,ue.alpha=1,ue.radius=10,this.pixi.stage.addChild(ue),new exports.Tween({radius:10,alpha:1}).to({radius:80,alpha:0},500).onUpdate(ye=>{ue.clear(),ue.beginFill(ge,ye.alpha),ue.drawCircle(0,0,ye.radius),ue.endFill()}).onComplete(()=>{ue.parent&&ue.parent.removeChild(ue),ue.destroy()}).start()}destroy(){this.pixi&&(this.pixi.destroy(!0),this.pixi=null)}}const q=ae=>{console.log(`: ${ae.progress}% (${ae.loaded}/${ae.total})`)},Y=async ae=>{console.log("");const le={designWidth:1080,designHeight:1920};initDom(ne.value,le),te=new X,await te.init(),te.setTextures(ae)};let te=null;const ne=ref$1(null);return onUnmounted(()=>{te&&te.destroy()}),(ae,le)=>(openBlock(),createElementBlock("div",_hoisted_1$8,[createBaseVNode("canvas",{ref_key:"pixiContainer",ref:ne},null,512),createVNode(PixiLoader,{textureUrls:_,onLoaded:Y,onProgress:q})]))}},_hoisted_1$7=createBaseVNode("TresPerspectiveCamera",{position:[0,20,0],rotation:[0,0,0]},null,-1),_hoisted_2$4=createBaseVNode("TresAmbientLight",{intensity:1},null,-1),_hoisted_3$3=createBaseVNode("TresAxesHelper",null,null,-1),_hoisted_4$3=createBaseVNode("TresGridHelper",null,null,-1),_sfc_main$7={__name:"ThreeHello",setup(B){const _=shallowRef(null);return watch(_,()=>{}),(T,E)=>{const W=resolveComponent("TresCanvas");return openBlock(),createElementBlock("div",null,[createVNode(W,{ref_key:"canvasRef",ref:_,"clear-color":"#e0eee8","window-size":""},{default:withCtx(()=>[_hoisted_1$7,_hoisted_2$4,_hoisted_3$3,_hoisted_4$3,createVNode(unref(xg))]),_:1},512)])}}},_hoisted_1$6=createBaseVNode("TresAmbientLight",{intensity:1},null,-1),_hoisted_2$3=createBaseVNode("TresAxesHelper",null,null,-1),_hoisted_3$2=["position"],_hoisted_4$2=createBaseVNode("TresSphereGeometry",{args:[.4,8,8]},null,-1),_hoisted_5$1=createBaseVNode("TresMeshBasicMaterial",{color:"red",transparent:!0,opacity:.1},null,-1),_hoisted_6$1=[_hoisted_4$2,_hoisted_5$1],_sfc_main$6={__name:"CurveRope",setup(B){const _=shallowRef(null),T=shallowRef(null),E=shallowRef(null);let X=new TextureLoader().load("img/rope3.png");var q=new MeshBasicMaterial({map:X});const Y=shallowRef(null);let te=-1,ne=new Raycaster,ae=reactive([new Vector3(0,-8,0),new Vector3(0,2,0),new Vector3(0,8,0)]);function le(){const xe=new QuadraticBezierCurve(...ae),Te=xe.getLength();console.log("curveLength",Te);const Ae=30;var Ie=[],Ve=[];for(let ze=0;ze<Ae;ze++){let He=ze/Ae,Le=xe.getPointAt(He),qe=xe.getTangentAt(He),Qe=new Vector2(-qe.y,qe.x).normalize(),Ke=(ze+1)/Ae,Je=xe.getPointAt(Ke),pt=xe.getTangentAt(Ke),ut=new Vector2(-pt.y,pt.x).normalize(),lt=[Le.clone().add(Qe.clone().multiplyScalar(.4)),Le.clone().sub(Qe.clone().multiplyScalar(.4)),Je.clone().add(ut.clone().multiplyScalar(.4)),Je.clone().sub(ut.clone().multiplyScalar(.4))];Ie.push(lt[0]),Ie.push(lt[1]),Ie.push(lt[2]),Ie.push(lt[1]),Ie.push(lt[3]),Ie.push(lt[2]);let st=0,sr=1;console.log(`ratio1=${He.toFixed(2)}`,`uv1=${st.toFixed(2)}`,`uv2=${sr.toFixed(2)}`),Ve.push(new Vector2(0,st)),Ve.push(new Vector2(1,st)),Ve.push(new Vector2(0,sr)),Ve.push(new Vector2(1,st)),Ve.push(new Vector2(1,sr)),Ve.push(new Vector2(0,sr))}const $e=new Float32Array(Ie.length*3);for(let ze=0;ze<Ie.length;ze++)$e[ze*3]=Ie[ze].x,$e[ze*3+1]=Ie[ze].y,$e[ze*3+2]=0;const We=new Float32Array(Ve.length*2);for(let ze=0;ze<Ve.length;ze++)We[ze*2]=Ve[ze].x,We[ze*2+1]=Ve[ze].y;var Ue=new BufferGeometry;for(Ue.setAttribute("position",new BufferAttribute($e,3)),Ue.setAttribute("uv",new BufferAttribute(We,2));T.value.children.length>0;)T.value.remove(T.value.children[0]);var je;{var je=new Mesh(Ue,q);T.value.add(je)}}watch(T,()=>{le()});function ue(xe){if(te>=0){let Te={x:0,y:0};Te.x=xe.clientX/window.innerWidth*2-1,Te.y=-(xe.clientY/window.innerHeight)*2+1,ne.setFromCamera(Te,E.value);let Ae=new Plane(new Vector3(0,0,1),0),Ie=new Vector3;ne.ray.intersectPlane(Ae,Ie)&&(ae[te]=Ie),le()}}function ge(xe){let Te={x:xe.clientX/window.innerWidth*2-1,y:-(xe.clientY/window.innerHeight)*2+1};ne.setFromCamera(Te,E.value);const Ae=ne.intersectObjects(Y.value.children);if(Ae.length>0){const Ie=Ae[0].object;te=Y.value.children.indexOf(Ie)}else te=-1}function ye(xe){te=-1}return(xe,Te)=>{const Ae=resolveComponent("TresCanvas");return openBlock(),createElementBlock("div",{onMousemove:ue,onMousedown:ge,onMouseup:ye},[createVNode(Ae,{ref_key:"canvasRef",ref:_,"clear-color":"#f9f7f7","window-size":""},{default:withCtx(()=>[createBaseVNode("TresPerspectiveCamera",{ref_key:"cameraRef",ref:E,position:[0,0,20],rotation:[0,0,0]},null,512),_hoisted_1$6,_hoisted_2$3,createBaseVNode("TresGroup",{ref_key:"curveRef",ref:T},null,512),createBaseVNode("TresGroup",{ref_key:"controlPointsRef",ref:Y},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(ae),(Ie,Ve)=>(openBlock(),createElementBlock("TresMesh",{key:Ve,position:Ie},_hoisted_6$1,8,_hoisted_3$2))),128))],512)]),_:1},512)],32)}}},{abs:abs$1,cos:cos$1,sin:sin$1,acos:acos$1,atan2,sqrt:sqrt$1,pow}=Math;function crt(B){return B<0?-pow(-B,1/3):pow(B,1/3)}const pi$1=Math.PI,tau=2*pi$1,quart=pi$1/2,epsilon=1e-6,nMax=Number.MAX_SAFE_INTEGER||9007199254740991,nMin=Number.MIN_SAFE_INTEGER||-9007199254740991,ZERO={x:0,y:0,z:0},utils={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(B,_){const T=_(B);let E=T.x*T.x+T.y*T.y;return typeof T.z<"u"&&(E+=T.z*T.z),sqrt$1(E)},compute:function(B,_,T){if(B===0)return _[0].t=0,_[0];const E=_.length-1;if(B===1)return _[E].t=1,_[E];const W=1-B;let X=_;if(E===0)return _[0].t=B,_[0];if(E===1){const Y={x:W*X[0].x+B*X[1].x,y:W*X[0].y+B*X[1].y,t:B};return T&&(Y.z=W*X[0].z+B*X[1].z),Y}if(E<4){let Y=W*W,te=B*B,ne,ae,le,ue=0;E===2?(X=[X[0],X[1],X[2],ZERO],ne=Y,ae=W*B*2,le=te):E===3&&(ne=Y*W,ae=Y*B*3,le=W*te*3,ue=B*te);const ge={x:ne*X[0].x+ae*X[1].x+le*X[2].x+ue*X[3].x,y:ne*X[0].y+ae*X[1].y+le*X[2].y+ue*X[3].y,t:B};return T&&(ge.z=ne*X[0].z+ae*X[1].z+le*X[2].z+ue*X[3].z),ge}const q=JSON.parse(JSON.stringify(_));for(;q.length>1;){for(let Y=0;Y<q.length-1;Y++)q[Y]={x:q[Y].x+(q[Y+1].x-q[Y].x)*B,y:q[Y].y+(q[Y+1].y-q[Y].y)*B},typeof q[Y].z<"u"&&(q[Y].z=q[Y].z+(q[Y+1].z-q[Y].z)*B);q.splice(q.length-1,1)}return q[0].t=B,q[0]},computeWithRatios:function(B,_,T,E){const W=1-B,X=T,q=_;let Y=X[0],te=X[1],ne=X[2],ae=X[3],le;if(Y*=W,te*=B,q.length===2)return le=Y+te,{x:(Y*q[0].x+te*q[1].x)/le,y:(Y*q[0].y+te*q[1].y)/le,z:E?(Y*q[0].z+te*q[1].z)/le:!1,t:B};if(Y*=W,te*=2*W,ne*=B*B,q.length===3)return le=Y+te+ne,{x:(Y*q[0].x+te*q[1].x+ne*q[2].x)/le,y:(Y*q[0].y+te*q[1].y+ne*q[2].y)/le,z:E?(Y*q[0].z+te*q[1].z+ne*q[2].z)/le:!1,t:B};if(Y*=W,te*=1.5*W,ne*=3*W,ae*=B*B*B,q.length===4)return le=Y+te+ne+ae,{x:(Y*q[0].x+te*q[1].x+ne*q[2].x+ae*q[3].x)/le,y:(Y*q[0].y+te*q[1].y+ne*q[2].y+ae*q[3].y)/le,z:E?(Y*q[0].z+te*q[1].z+ne*q[2].z+ae*q[3].z)/le:!1,t:B}},derive:function(B,_){const T=[];for(let E=B,W=E.length,X=W-1;W>1;W--,X--){const q=[];for(let Y=0,te;Y<X;Y++)te={x:X*(E[Y+1].x-E[Y].x),y:X*(E[Y+1].y-E[Y].y)},_&&(te.z=X*(E[Y+1].z-E[Y].z)),q.push(te);T.push(q),E=q}return T},between:function(B,_,T){return _<=B&&B<=T||utils.approximately(B,_)||utils.approximately(B,T)},approximately:function(B,_,T){return abs$1(B-_)<=(T||epsilon)},length:function(B){const T=utils.Tvalues.length;let E=0;for(let W=0,X;W<T;W++)X=.5*utils.Tvalues[W]+.5,E+=utils.Cvalues[W]*utils.arcfn(X,B);return .5*E},map:function(B,_,T,E,W){const X=T-_,q=W-E,Y=B-_,te=Y/X;return E+q*te},lerp:function(B,_,T){const E={x:_.x+B*(T.x-_.x),y:_.y+B*(T.y-_.y)};return _.z!==void 0&&T.z!==void 0&&(E.z=_.z+B*(T.z-_.z)),E},pointToString:function(B){let _=B.x+"/"+B.y;return typeof B.z<"u"&&(_+="/"+B.z),_},pointsToString:function(B){return"["+B.map(utils.pointToString).join(", ")+"]"},copy:function(B){return JSON.parse(JSON.stringify(B))},angle:function(B,_,T){const E=_.x-B.x,W=_.y-B.y,X=T.x-B.x,q=T.y-B.y,Y=E*q-W*X,te=E*X+W*q;return atan2(Y,te)},round:function(B,_){const T=""+B,E=T.indexOf(".");return parseFloat(T.substring(0,E+1+_))},dist:function(B,_){const T=B.x-_.x,E=B.y-_.y;return sqrt$1(T*T+E*E)},closest:function(B,_){let T=pow(2,63),E,W;return B.forEach(function(X,q){W=utils.dist(_,X),W<T&&(T=W,E=q)}),{mdist:T,mpos:E}},abcratio:function(B,_){if(_!==2&&_!==3)return!1;if(typeof B>"u")B=.5;else if(B===0||B===1)return B;const T=pow(B,_)+pow(1-B,_),E=T-1;return abs$1(E/T)},projectionratio:function(B,_){if(_!==2&&_!==3)return!1;if(typeof B>"u")B=.5;else if(B===0||B===1)return B;const T=pow(1-B,_),E=pow(B,_)+T;return T/E},lli8:function(B,_,T,E,W,X,q,Y){const te=(B*E-_*T)*(W-q)-(B-T)*(W*Y-X*q),ne=(B*E-_*T)*(X-Y)-(_-E)*(W*Y-X*q),ae=(B-T)*(X-Y)-(_-E)*(W-q);return ae==0?!1:{x:te/ae,y:ne/ae}},lli4:function(B,_,T,E){const W=B.x,X=B.y,q=_.x,Y=_.y,te=T.x,ne=T.y,ae=E.x,le=E.y;return utils.lli8(W,X,q,Y,te,ne,ae,le)},lli:function(B,_){return utils.lli4(B,B.c,_,_.c)},makeline:function(B,_){return new Bezier(B.x,B.y,(B.x+_.x)/2,(B.y+_.y)/2,_.x,_.y)},findbbox:function(B){let _=nMax,T=nMax,E=nMin,W=nMin;return B.forEach(function(X){const q=X.bbox();_>q.x.min&&(_=q.x.min),T>q.y.min&&(T=q.y.min),E<q.x.max&&(E=q.x.max),W<q.y.max&&(W=q.y.max)}),{x:{min:_,mid:(_+E)/2,max:E,size:E-_},y:{min:T,mid:(T+W)/2,max:W,size:W-T}}},shapeintersections:function(B,_,T,E,W){if(!utils.bboxoverlap(_,E))return[];const X=[],q=[B.startcap,B.forward,B.back,B.endcap],Y=[T.startcap,T.forward,T.back,T.endcap];return q.forEach(function(te){te.virtual||Y.forEach(function(ne){if(ne.virtual)return;const ae=te.intersects(ne,W);ae.length>0&&(ae.c1=te,ae.c2=ne,ae.s1=B,ae.s2=T,X.push(ae))})}),X},makeshape:function(B,_,T){const E=_.points.length,W=B.points.length,X=utils.makeline(_.points[E-1],B.points[0]),q=utils.makeline(B.points[W-1],_.points[0]),Y={startcap:X,forward:B,back:_,endcap:q,bbox:utils.findbbox([X,B,_,q])};return Y.intersections=function(te){return utils.shapeintersections(Y,Y.bbox,te,te.bbox,T)},Y},getminmax:function(B,_,T){if(!T)return{min:0,max:0};let E=nMax,W=nMin,X,q;T.indexOf(0)===-1&&(T=[0].concat(T)),T.indexOf(1)===-1&&T.push(1);for(let Y=0,te=T.length;Y<te;Y++)X=T[Y],q=B.get(X),q[_]<E&&(E=q[_]),q[_]>W&&(W=q[_]);return{min:E,mid:(E+W)/2,max:W,size:W-E}},align:function(B,_){const T=_.p1.x,E=_.p1.y,W=-atan2(_.p2.y-E,_.p2.x-T),X=function(q){return{x:(q.x-T)*cos$1(W)-(q.y-E)*sin$1(W),y:(q.x-T)*sin$1(W)+(q.y-E)*cos$1(W)}};return B.map(X)},roots:function(B,_){_=_||{p1:{x:0,y:0},p2:{x:1,y:0}};const T=B.length-1,E=utils.align(B,_),W=function(je){return 0<=je&&je<=1};if(T===2){const je=E[0].y,ze=E[1].y,He=E[2].y,Le=je-2*ze+He;if(Le!==0){const qe=-sqrt$1(ze*ze-je*He),Qe=-je+ze,Ke=-(qe+Qe)/Le,Je=-(-qe+Qe)/Le;return[Ke,Je].filter(W)}else if(ze!==He&&Le===0)return[(2*ze-He)/(2*ze-2*He)].filter(W);return[]}const X=E[0].y,q=E[1].y,Y=E[2].y,te=E[3].y;let ne=-X+3*q-3*Y+te,ae=3*X-6*q+3*Y,le=-3*X+3*q,ue=X;if(utils.approximately(ne,0)){if(utils.approximately(ae,0))return utils.approximately(le,0)?[]:[-ue/le].filter(W);const je=sqrt$1(le*le-4*ae*ue),ze=2*ae;return[(je-le)/ze,(-le-je)/ze].filter(W)}ae/=ne,le/=ne,ue/=ne;const ge=(3*le-ae*ae)/3,ye=ge/3,xe=(2*ae*ae*ae-9*ae*le+27*ue)/27,Te=xe/2,Ae=Te*Te+ye*ye*ye;let Ie,Ve,$e,We,Ue;if(Ae<0){const je=-ge/3,ze=je*je*je,He=sqrt$1(ze),Le=-xe/(2*He),qe=Le<-1?-1:Le>1?1:Le,Qe=acos$1(qe),Ke=crt(He),Je=2*Ke;return $e=Je*cos$1(Qe/3)-ae/3,We=Je*cos$1((Qe+tau)/3)-ae/3,Ue=Je*cos$1((Qe+2*tau)/3)-ae/3,[$e,We,Ue].filter(W)}else{if(Ae===0)return Ie=Te<0?crt(-Te):-crt(Te),$e=2*Ie-ae/3,We=-Ie-ae/3,[$e,We].filter(W);{const je=sqrt$1(Ae);return Ie=crt(-Te+je),Ve=crt(Te+je),[Ie-Ve-ae/3].filter(W)}}},droots:function(B){if(B.length===3){const _=B[0],T=B[1],E=B[2],W=_-2*T+E;if(W!==0){const X=-sqrt$1(T*T-_*E),q=-_+T,Y=-(X+q)/W,te=-(-X+q)/W;return[Y,te]}else if(T!==E&&W===0)return[(2*T-E)/(2*(T-E))];return[]}if(B.length===2){const _=B[0],T=B[1];return _!==T?[_/(_-T)]:[]}return[]},curvature:function(B,_,T,E,W){let X,q,Y,te,ne=0,ae=0;const le=utils.compute(B,_),ue=utils.compute(B,T),ge=le.x*le.x+le.y*le.y;if(E?(X=sqrt$1(pow(le.y*ue.z-ue.y*le.z,2)+pow(le.z*ue.x-ue.z*le.x,2)+pow(le.x*ue.y-ue.x*le.y,2)),q=pow(ge+le.z*le.z,3/2)):(X=le.x*ue.y-le.y*ue.x,q=pow(ge,3/2)),X===0||q===0)return{k:0,r:0};if(ne=X/q,ae=q/X,!W){const ye=utils.curvature(B-.001,_,T,E,!0).k,xe=utils.curvature(B+.001,_,T,E,!0).k;te=(xe-ne+(ne-ye))/2,Y=(abs$1(xe-ne)+abs$1(ne-ye))/2}return{k:ne,r:ae,dk:te,adk:Y}},inflections:function(B){if(B.length<4)return[];const _=utils.align(B,{p1:B[0],p2:B.slice(-1)[0]}),T=_[2].x*_[1].y,E=_[3].x*_[1].y,W=_[1].x*_[2].y,X=_[3].x*_[2].y,q=18*(-3*T+2*E+3*W-X),Y=18*(3*T-E-3*W),te=18*(W-T);if(utils.approximately(q,0)){if(!utils.approximately(Y,0)){let ue=-te/Y;if(0<=ue&&ue<=1)return[ue]}return[]}const ne=2*q;if(utils.approximately(ne,0))return[];const ae=Y*Y-4*q*te;if(ae<0)return[];const le=Math.sqrt(ae);return[(le-Y)/ne,-(Y+le)/ne].filter(function(ue){return 0<=ue&&ue<=1})},bboxoverlap:function(B,_){const T=["x","y"],E=T.length;for(let W=0,X,q,Y,te;W<E;W++)if(X=T[W],q=B[X].mid,Y=_[X].mid,te=(B[X].size+_[X].size)/2,abs$1(q-Y)>=te)return!1;return!0},expandbox:function(B,_){_.x.min<B.x.min&&(B.x.min=_.x.min),_.y.min<B.y.min&&(B.y.min=_.y.min),_.z&&_.z.min<B.z.min&&(B.z.min=_.z.min),_.x.max>B.x.max&&(B.x.max=_.x.max),_.y.max>B.y.max&&(B.y.max=_.y.max),_.z&&_.z.max>B.z.max&&(B.z.max=_.z.max),B.x.mid=(B.x.min+B.x.max)/2,B.y.mid=(B.y.min+B.y.max)/2,B.z&&(B.z.mid=(B.z.min+B.z.max)/2),B.x.size=B.x.max-B.x.min,B.y.size=B.y.max-B.y.min,B.z&&(B.z.size=B.z.max-B.z.min)},pairiteration:function(B,_,T){const E=B.bbox(),W=_.bbox(),X=1e5,q=T||.5;if(E.x.size+E.y.size<q&&W.x.size+W.y.size<q)return[(X*(B._t1+B._t2)/2|0)/X+"/"+(X*(_._t1+_._t2)/2|0)/X];let Y=B.split(.5),te=_.split(.5),ne=[{left:Y.left,right:te.left},{left:Y.left,right:te.right},{left:Y.right,right:te.right},{left:Y.right,right:te.left}];ne=ne.filter(function(le){return utils.bboxoverlap(le.left.bbox(),le.right.bbox())});let ae=[];return ne.length===0||(ne.forEach(function(le){ae=ae.concat(utils.pairiteration(le.left,le.right,q))}),ae=ae.filter(function(le,ue){return ae.indexOf(le)===ue})),ae},getccenter:function(B,_,T){const E=_.x-B.x,W=_.y-B.y,X=T.x-_.x,q=T.y-_.y,Y=E*cos$1(quart)-W*sin$1(quart),te=E*sin$1(quart)+W*cos$1(quart),ne=X*cos$1(quart)-q*sin$1(quart),ae=X*sin$1(quart)+q*cos$1(quart),le=(B.x+_.x)/2,ue=(B.y+_.y)/2,ge=(_.x+T.x)/2,ye=(_.y+T.y)/2,xe=le+Y,Te=ue+te,Ae=ge+ne,Ie=ye+ae,Ve=utils.lli8(le,ue,xe,Te,ge,ye,Ae,Ie),$e=utils.dist(Ve,B);let We=atan2(B.y-Ve.y,B.x-Ve.x),Ue=atan2(_.y-Ve.y,_.x-Ve.x),je=atan2(T.y-Ve.y,T.x-Ve.x),ze;return We<je?((We>Ue||Ue>je)&&(We+=tau),We>je&&(ze=je,je=We,We=ze)):je<Ue&&Ue<We?(ze=je,je=We,We=ze):je+=tau,Ve.s=We,Ve.e=je,Ve.r=$e,Ve},numberSort:function(B,_){return B-_}};class PolyBezier{constructor(_){this.curves=[],this._3d=!1,_&&(this.curves=_,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(_){return utils.pointsToString(_.points)}).join(", ")+"]"}addCurve(_){this.curves.push(_),this._3d=this._3d||_._3d}length(){return this.curves.map(function(_){return _.length()}).reduce(function(_,T){return _+T})}curve(_){return this.curves[_]}bbox(){const _=this.curves;for(var T=_[0].bbox(),E=1;E<_.length;E++)utils.expandbox(T,_[E].bbox());return T}offset(_){const T=[];return this.curves.forEach(function(E){T.push(...E.offset(_))}),new PolyBezier(T)}}const{abs,min,max,cos,sin,acos,sqrt}=Math,pi=Math.PI;class Bezier{constructor(_){let T=_&&_.forEach?_:Array.from(arguments).slice(),E=!1;if(typeof T[0]=="object"){E=T.length;const ge=[];T.forEach(function(ye){["x","y","z"].forEach(function(xe){typeof ye[xe]<"u"&&ge.push(ye[xe])})}),T=ge}let W=!1;const X=T.length;if(E){if(E>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");W=!0}}else if(X!==6&&X!==8&&X!==9&&X!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const q=this._3d=!W&&(X===9||X===12)||_&&_[0]&&typeof _[0].z<"u",Y=this.points=[];for(let ge=0,ye=q?3:2;ge<X;ge+=ye){var te={x:T[ge],y:T[ge+1]};q&&(te.z=T[ge+2]),Y.push(te)}const ne=this.order=Y.length-1,ae=this.dims=["x","y"];q&&ae.push("z"),this.dimlen=ae.length;const le=utils.align(Y,{p1:Y[0],p2:Y[ne]}),ue=utils.dist(Y[0],Y[ne]);this._linear=le.reduce((ge,ye)=>ge+abs(ye.y),0)<ue/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(_,T,E,W){if(typeof W>"u"&&(W=.5),W===0)return new Bezier(T,T,E);if(W===1)return new Bezier(_,T,T);const X=Bezier.getABC(2,_,T,E,W);return new Bezier(_,X.A,E)}static cubicFromPoints(_,T,E,W,X){typeof W>"u"&&(W=.5);const q=Bezier.getABC(3,_,T,E,W);typeof X>"u"&&(X=utils.dist(T,q.C));const Y=X*(1-W)/W,te=utils.dist(_,E),ne=(E.x-_.x)/te,ae=(E.y-_.y)/te,le=X*ne,ue=X*ae,ge=Y*ne,ye=Y*ae,xe={x:T.x-le,y:T.y-ue},Te={x:T.x+ge,y:T.y+ye},Ae=q.A,Ie={x:Ae.x+(xe.x-Ae.x)/(1-W),y:Ae.y+(xe.y-Ae.y)/(1-W)},Ve={x:Ae.x+(Te.x-Ae.x)/W,y:Ae.y+(Te.y-Ae.y)/W},$e={x:_.x+(Ie.x-_.x)/W,y:_.y+(Ie.y-_.y)/W},We={x:E.x+(Ve.x-E.x)/(1-W),y:E.y+(Ve.y-E.y)/(1-W)};return new Bezier(_,$e,We,E)}static getUtils(){return utils}getUtils(){return Bezier.getUtils()}static get PolyBezier(){return PolyBezier}valueOf(){return this.toString()}toString(){return utils.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const _=this.points,T=_[0].x,E=_[0].y,W=["M",T,E,this.order===2?"Q":"C"];for(let X=1,q=_.length;X<q;X++)W.push(_[X].x),W.push(_[X].y);return W.join(" ")}setRatios(_){if(_.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=_,this._lut=[]}verify(){const _=this.coordDigest();_!==this._print&&(this._print=_,this.update())}coordDigest(){return this.points.map(function(_,T){return""+T+_.x+_.y+(_.z?_.z:0)}).join("")}update(){this._lut=[],this.dpoints=utils.derive(this.points,this._3d),this.computedirection()}computedirection(){const _=this.points,T=utils.angle(_[0],_[this.order],_[1]);this.clockwise=T>0}length(){return utils.length(this.derivative.bind(this))}static getABC(_=2,T,E,W,X=.5){const q=utils.projectionratio(X,_),Y=1-q,te={x:q*T.x+Y*W.x,y:q*T.y+Y*W.y},ne=utils.abcratio(X,_);return{A:{x:E.x+(E.x-te.x)/ne,y:E.y+(E.y-te.y)/ne},B:E,C:te,S:T,E:W}}getABC(_,T){T=T||this.get(_);let E=this.points[0],W=this.points[this.order];return Bezier.getABC(this.order,E,T,W,_)}getLUT(_){if(this.verify(),_=_||100,this._lut.length===_+1)return this._lut;this._lut=[],_++,this._lut=[];for(let T=0,E,W;T<_;T++)W=T/(_-1),E=this.compute(W),E.t=W,this._lut.push(E);return this._lut}on(_,T){T=T||5;const E=this.getLUT(),W=[];for(let X=0,q,Y=0;X<E.length;X++)q=E[X],utils.dist(q,_)<T&&(W.push(q),Y+=X/E.length);return W.length?t/=W.length:!1}project(_){const T=this.getLUT(),E=T.length-1,W=utils.closest(T,_),X=W.mpos,q=(X-1)/E,Y=(X+1)/E,te=.1/E;let ne=W.mdist,ae=q,le=ae,ue;ne+=1;for(let ge;ae<Y+te;ae+=te)ue=this.compute(ae),ge=utils.dist(_,ue),ge<ne&&(ne=ge,le=ae);return le=le<0?0:le>1?1:le,ue=this.compute(le),ue.t=le,ue.d=ne,ue}get(_){return this.compute(_)}point(_){return this.points[_]}compute(_){return this.ratios?utils.computeWithRatios(_,this.points,this.ratios,this._3d):utils.compute(_,this.points,this._3d,this.ratios)}raise(){const _=this.points,T=[_[0]],E=_.length;for(let W=1,X,q;W<E;W++)X=_[W],q=_[W-1],T[W]={x:(E-W)/E*X.x+W/E*q.x,y:(E-W)/E*X.y+W/E*q.y};return T[E]=_[E-1],new Bezier(T)}derivative(_){return utils.compute(_,this.dpoints[0],this._3d)}dderivative(_){return utils.compute(_,this.dpoints[1],this._3d)}align(){let _=this.points;return new Bezier(utils.align(_,{p1:_[0],p2:_[_.length-1]}))}curvature(_){return utils.curvature(_,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return utils.inflections(this.points)}normal(_){return this._3d?this.__normal3(_):this.__normal2(_)}__normal2(_){const T=this.derivative(_),E=sqrt(T.x*T.x+T.y*T.y);return{t:_,x:-T.y/E,y:T.x/E}}__normal3(_){const T=this.derivative(_),E=this.derivative(_+.01),W=sqrt(T.x*T.x+T.y*T.y+T.z*T.z),X=sqrt(E.x*E.x+E.y*E.y+E.z*E.z);T.x/=W,T.y/=W,T.z/=W,E.x/=X,E.y/=X,E.z/=X;const q={x:E.y*T.z-E.z*T.y,y:E.z*T.x-E.x*T.z,z:E.x*T.y-E.y*T.x},Y=sqrt(q.x*q.x+q.y*q.y+q.z*q.z);q.x/=Y,q.y/=Y,q.z/=Y;const te=[q.x*q.x,q.x*q.y-q.z,q.x*q.z+q.y,q.x*q.y+q.z,q.y*q.y,q.y*q.z-q.x,q.x*q.z-q.y,q.y*q.z+q.x,q.z*q.z];return{t:_,x:te[0]*T.x+te[1]*T.y+te[2]*T.z,y:te[3]*T.x+te[4]*T.y+te[5]*T.z,z:te[6]*T.x+te[7]*T.y+te[8]*T.z}}hull(_){let T=this.points,E=[],W=[],X=0;for(W[X++]=T[0],W[X++]=T[1],W[X++]=T[2],this.order===3&&(W[X++]=T[3]);T.length>1;){E=[];for(let q=0,Y,te=T.length-1;q<te;q++)Y=utils.lerp(_,T[q],T[q+1]),W[X++]=Y,E.push(Y);T=E}return W}split(_,T){if(_===0&&T)return this.split(T).left;if(T===1)return this.split(_).right;const E=this.hull(_),W={left:this.order===2?new Bezier([E[0],E[3],E[5]]):new Bezier([E[0],E[4],E[7],E[9]]),right:this.order===2?new Bezier([E[5],E[4],E[2]]):new Bezier([E[9],E[8],E[6],E[3]]),span:E};return W.left._t1=utils.map(0,0,1,this._t1,this._t2),W.left._t2=utils.map(_,0,1,this._t1,this._t2),W.right._t1=utils.map(_,0,1,this._t1,this._t2),W.right._t2=utils.map(1,0,1,this._t1,this._t2),T?(T=utils.map(T,_,1,0,1),W.right.split(T).left):W}extrema(){const _={};let T=[];return this.dims.forEach((function(E){let W=function(q){return q[E]},X=this.dpoints[0].map(W);_[E]=utils.droots(X),this.order===3&&(X=this.dpoints[1].map(W),_[E]=_[E].concat(utils.droots(X))),_[E]=_[E].filter(function(q){return q>=0&&q<=1}),T=T.concat(_[E].sort(utils.numberSort))}).bind(this)),_.values=T.sort(utils.numberSort).filter(function(E,W){return T.indexOf(E)===W}),_}bbox(){const _=this.extrema(),T={};return this.dims.forEach((function(E){T[E]=utils.getminmax(this,E,_[E])}).bind(this)),T}overlaps(_){const T=this.bbox(),E=_.bbox();return utils.bboxoverlap(T,E)}offset(_,T){if(typeof T<"u"){const E=this.get(_),W=this.normal(_),X={c:E,n:W,x:E.x+W.x*T,y:E.y+W.y*T};return this._3d&&(X.z=E.z+W.z*T),X}if(this._linear){const E=this.normal(0),W=this.points.map(function(X){const q={x:X.x+_*E.x,y:X.y+_*E.y};return X.z&&E.z&&(q.z=X.z+_*E.z),q});return[new Bezier(W)]}return this.reduce().map(function(E){return E._linear?E.offset(_)[0]:E.scale(_)})}simple(){if(this.order===3){const W=utils.angle(this.points[0],this.points[3],this.points[1]),X=utils.angle(this.points[0],this.points[3],this.points[2]);if(W>0&&X<0||W<0&&X>0)return!1}const _=this.normal(0),T=this.normal(1);let E=_.x*T.x+_.y*T.y;return this._3d&&(E+=_.z*T.z),abs(acos(E))<pi/3}reduce(){let _,T=0,E=0,W=.01,X,q=[],Y=[],te=this.extrema().values;for(te.indexOf(0)===-1&&(te=[0].concat(te)),te.indexOf(1)===-1&&te.push(1),T=te[0],_=1;_<te.length;_++)E=te[_],X=this.split(T,E),X._t1=T,X._t2=E,q.push(X),T=E;return q.forEach(function(ne){for(T=0,E=0;E<=1;)for(E=T+W;E<=1+W;E+=W)if(X=ne.split(T,E),!X.simple()){if(E-=W,abs(T-E)<W)return[];X=ne.split(T,E),X._t1=utils.map(T,0,1,ne._t1,ne._t2),X._t2=utils.map(E,0,1,ne._t1,ne._t2),Y.push(X),T=E;break}T<1&&(X=ne.split(T,1),X._t1=utils.map(T,0,1,ne._t1,ne._t2),X._t2=ne._t2,Y.push(X))}),Y}translate(_,T,E){E=typeof E=="number"?E:T;const W=this.order;let X=this.points.map((q,Y)=>(1-Y/W)*T+Y/W*E);return new Bezier(this.points.map((q,Y)=>({x:q.x+_.x*X[Y],y:q.y+_.y*X[Y]})))}scale(_){const T=this.order;let E=!1;if(typeof _=="function"&&(E=_),E&&T===2)return this.raise().scale(E);const W=this.clockwise,X=this.points;if(this._linear)return this.translate(this.normal(0),E?E(0):_,E?E(1):_);const q=E?E(0):_,Y=E?E(1):_,te=[this.offset(0,10),this.offset(1,10)],ne=[],ae=utils.lli4(te[0],te[0].c,te[1],te[1].c);if(!ae)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(le){const ue=ne[le*T]=utils.copy(X[le*T]);ue.x+=(le?Y:q)*te[le].n.x,ue.y+=(le?Y:q)*te[le].n.y}),E?([0,1].forEach(function(le){if(!(T===2&&le)){var ue=X[le+1],ge={x:ue.x-ae.x,y:ue.y-ae.y},ye=E?E((le+1)/T):_;E&&!W&&(ye=-ye);var xe=sqrt(ge.x*ge.x+ge.y*ge.y);ge.x/=xe,ge.y/=xe,ne[le+1]={x:ue.x+ye*ge.x,y:ue.y+ye*ge.y}}}),new Bezier(ne)):([0,1].forEach(le=>{if(T===2&&le)return;const ue=ne[le*T],ge=this.derivative(le),ye={x:ue.x+ge.x,y:ue.y+ge.y};ne[le+1]=utils.lli4(ue,ye,ae,X[le+1])}),new Bezier(ne))}outline(_,T,E,W){if(T=T===void 0?_:T,this._linear){const We=this.normal(0),Ue=this.points[0],je=this.points[this.points.length-1];let ze,He,Le;E===void 0&&(E=_,W=T),ze={x:Ue.x+We.x*_,y:Ue.y+We.y*_},Le={x:je.x+We.x*E,y:je.y+We.y*E},He={x:(ze.x+Le.x)/2,y:(ze.y+Le.y)/2};const qe=[ze,He,Le];ze={x:Ue.x-We.x*T,y:Ue.y-We.y*T},Le={x:je.x-We.x*W,y:je.y-We.y*W},He={x:(ze.x+Le.x)/2,y:(ze.y+Le.y)/2};const Qe=[Le,He,ze],Ke=utils.makeline(Qe[2],qe[0]),Je=utils.makeline(qe[2],Qe[0]),pt=[Ke,new Bezier(qe),Je,new Bezier(Qe)];return new PolyBezier(pt)}const X=this.reduce(),q=X.length,Y=[];let te=[],ne,ae=0,le=this.length();const ue=typeof E<"u"&&typeof W<"u";function ge(We,Ue,je,ze,He){return function(Le){const qe=ze/je,Qe=(ze+He)/je,Ke=Ue-We;return utils.map(Le,0,1,We+qe*Ke,We+Qe*Ke)}}X.forEach(function(We){const Ue=We.length();ue?(Y.push(We.scale(ge(_,E,le,ae,Ue))),te.push(We.scale(ge(-T,-W,le,ae,Ue)))):(Y.push(We.scale(_)),te.push(We.scale(-T))),ae+=Ue}),te=te.map(function(We){return ne=We.points,ne[3]?We.points=[ne[3],ne[2],ne[1],ne[0]]:We.points=[ne[2],ne[1],ne[0]],We}).reverse();const ye=Y[0].points[0],xe=Y[q-1].points[Y[q-1].points.length-1],Te=te[q-1].points[te[q-1].points.length-1],Ae=te[0].points[0],Ie=utils.makeline(Te,ye),Ve=utils.makeline(xe,Ae),$e=[Ie].concat(Y).concat([Ve]).concat(te);return new PolyBezier($e)}outlineshapes(_,T,E){T=T||_;const W=this.outline(_,T).curves,X=[];for(let q=1,Y=W.length;q<Y/2;q++){const te=utils.makeshape(W[q],W[Y-q],E);te.startcap.virtual=q>1,te.endcap.virtual=q<Y/2-1,X.push(te)}return X}intersects(_,T){return _?_.p1&&_.p2?this.lineIntersects(_):(_ instanceof Bezier&&(_=_.reduce()),this.curveintersects(this.reduce(),_,T)):this.selfintersects(T)}lineIntersects(_){const T=min(_.p1.x,_.p2.x),E=min(_.p1.y,_.p2.y),W=max(_.p1.x,_.p2.x),X=max(_.p1.y,_.p2.y);return utils.roots(this.points,_).filter(q=>{var Y=this.get(q);return utils.between(Y.x,T,W)&&utils.between(Y.y,E,X)})}selfintersects(_){const T=this.reduce(),E=T.length-2,W=[];for(let X=0,q,Y,te;X<E;X++)Y=T.slice(X,X+1),te=T.slice(X+2),q=this.curveintersects(Y,te,_),W.push(...q);return W}curveintersects(_,T,E){const W=[];_.forEach(function(q){T.forEach(function(Y){q.overlaps(Y)&&W.push({left:q,right:Y})})});let X=[];return W.forEach(function(q){const Y=utils.pairiteration(q.left,q.right,E);Y.length>0&&(X=X.concat(Y))}),X}arcs(_){return _=_||.5,this._iterate(_,[])}_error(_,T,E,W){const X=(W-E)/4,q=this.get(E+X),Y=this.get(W-X),te=utils.dist(_,T),ne=utils.dist(_,q),ae=utils.dist(_,Y);return abs(ne-te)+abs(ae-te)}_iterate(_,T){let E=0,W=1,X;do{X=0,W=1;let q=this.get(E),Y,te,ne,ae,le=!1,ue=!1,ge,ye=W,xe=1;do if(ue=le,ae=ne,ye=(E+W)/2,Y=this.get(ye),te=this.get(W),ne=utils.getccenter(q,Y,te),ne.interval={start:E,end:W},le=this._error(ne,q,E,W)<=_,ge=ue&&!le,ge||(xe=W),le){if(W>=1){if(ne.interval.end=xe=1,ae=ne,W>1){let Ae={x:ne.x+ne.r*cos(ne.e),y:ne.y+ne.r*sin(ne.e)};ne.e+=utils.angle({x:ne.x,y:ne.y},Ae,this.get(1))}break}W=W+(W-E)/2}else W=ye;while(!ge&&X++<100);if(X>=100)break;ae=ae||ne,T.push(ae),E=xe}while(W<1);return T}}const _hoisted_1$5=createBaseVNode("p",{style:{width:"100px"}},"",-1),_hoisted_2$2=createBaseVNode("p",{style:{width:"100px"}},"",-1),vertex=`
attribute vec2 aPosition;
attribute vec3 aColor;
attribute vec2 aUV;

varying vec3 vColor;
varying vec2 vUV;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;

void main() {

    mat3 mvp = projectionMatrix * translationMatrix;
    gl_Position = vec4((mvp * vec3(aPosition, 1.0)).xy, 0.0, 1.0);

    vColor = aColor;
    vUV = aUV;
}
`,fragment=`
varying vec3 vColor;
varying vec2 vUV;

uniform sampler2D uTexture;

void main() {
    gl_FragColor = texture2D(uTexture, vUV) * vec4(vColor, 1.0);
}
`,_sfc_main$5={__name:"CurveRopePixi",async setup(B){let _,T;const E=ref$1(null);let W=null,X=-1,q=null,Y=null,te=null;const ne=ref$1([{value:0,label:"1"},{value:1,label:"2"},{value:2,label:"3"}]),ae=ref$1(2),le=ref$1(["t","",""]),ue=ref$1(""),ge=ref$1(!1);watch(ge,()=>{Ue()});const ye=ref$1(30);watch(ye,()=>{Ue()});const xe=[([_,T]=withAsyncContext(()=>Assets.load("./img/rope1.png")),_=await _,T(),_),([_,T]=withAsyncContext(()=>Assets.load("./img/rope2.png")),_=await _,T(),_),([_,T]=withAsyncContext(()=>Assets.load("./img/rope3.png")),_=await _,T(),_)];function Te(){return q.children.map(Le=>new Point(Le.x,Le.y))}function Ae(Le){xe[ae.value];let qe=[],Qe=[],Ke=[];const Je=new Bezier(...Le),pt=Je.getLUT(ye.value);for(let ut=0;ut<pt.length&&ut!=pt.length-1;ut++){const lt=pt[ut];Je.derivative(lt.t);const st=Je.normal(lt.t);st.x*=20,st.y*=20;const sr=pt[ut+1];Je.derivative(sr.t);const mt=Je.normal(sr.t);mt.x*=20,mt.y*=20;let Tr=[new Point(lt.x+st.x,lt.y+st.y),new Point(lt.x-st.x,lt.y-st.y),new Point(sr.x-mt.x,sr.y-mt.y),new Point(sr.x+mt.x,sr.y+mt.y)];qe.push(Tr[0].x,Tr[0].y),qe.push(Tr[1].x,Tr[1].y),qe.push(Tr[2].x,Tr[2].y),qe.push(Tr[0].x,Tr[0].y),qe.push(Tr[2].x,Tr[2].y),qe.push(Tr[3].x,Tr[3].y),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Ke.push(0,0),Ke.push(1,0),Ke.push(1,1),Ke.push(0,0),Ke.push(1,1),Ke.push(0,1)}return Ve(qe,Qe,Ke)}function Ie(Le){xe[ae.value];let qe=[],Qe=[],Ke=[];const Je=new Bezier(...Le),pt=Je.length(),ut=ye.value;let lt=Je.getLUT(300),st=pt/ut,sr=0,mt=0;for(let Tr=1;Tr<=ut;Tr++){let di=st*Tr;for(let Mi=mt+1;Mi<lt.length;Mi++){let Gr=lt[Mi-1],ci=lt[Mi];const gi=ci.x-Gr.x,fi=ci.y-Gr.y;if(sr+=Math.sqrt(gi*gi+fi*fi),sr>=di||Mi==lt.length-1){const ri=lt[mt],ot=Je.normal(ri.t);ot.x*=20,ot.y*=20;const rt=ci,gt=Je.normal(rt.t);gt.x*=20,gt.y*=20;let Or=[new Point(ri.x+ot.x,ri.y+ot.y),new Point(ri.x-ot.x,ri.y-ot.y),new Point(rt.x-gt.x,rt.y-gt.y),new Point(rt.x+gt.x,rt.y+gt.y)];mt=Mi,qe.push(Or[0].x,Or[0].y),qe.push(Or[1].x,Or[1].y),qe.push(Or[2].x,Or[2].y),qe.push(Or[0].x,Or[0].y),qe.push(Or[2].x,Or[2].y),qe.push(Or[3].x,Or[3].y),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Ke.push(0,0),Ke.push(1,0),Ke.push(1,1),Ke.push(0,0),Ke.push(1,1),Ke.push(0,1);break}}}return Ve(qe,Qe,Ke)}function Ve(Le,qe,Qe){const Je={uTexture:xe[ae.value]},pt=new Geometry().addAttribute("aPosition",Le,2).addAttribute("aColor",qe,3).addAttribute("aUV",Qe,2),ut=Shader.from(vertex,fragment,Je);return Y=new Mesh$1(pt,ut),Y}function $e(Le){let qe=0;for(let Qe=0;Qe<Le.length;Qe++){const Ke=Le[Qe];qe+=Ke.length()}return qe}function We(Le){xe[ae.value];let qe=[],Qe=[],Ke=[];const Je=new Bezier(...Le),pt=Je.offset(20),ut=Je.offset(-20),lt=[Je,pt,ut],st=[Je.length(),$e(pt),$e(ut)],sr=ye.value,mt=[st[0]/sr,st[1]/sr,st[2]/sr],Tr=new Map;function di(gi,fi){let ri=Tr.get(gi);if(ri||(ri=gi.getLUT(),Tr[gi]=ri),fi==0)return ri[0];let ot=0;for(let rt=1;rt<ri.length;rt++){const gt=ri[rt].x-ri[rt-1].x,Or=ri[rt].y-ri[rt-1].y,et=Math.sqrt(gt*gt+Or*Or);if(ot+=et,ot>=fi||rt==ri.length-1)return ri[rt]}}function Mi(gi,fi){const ri=lt[gi],ot=ri.map(et=>et.length());let rt=ri.length-1;for(let et=0;et<ot.length-1;et++)if(fi<=ot[et]){rt=et;break}else fi-=ot[et];let gt=ri[rt];return di(gt,fi)}let Gr=Mi(1,0),ci=Mi(2,0);for(let gi=1;gi<=sr;gi++){let fi=gi*mt[1],ri=gi*mt[2];const ot=Gr,rt=ci,gt=Mi(1,fi),Or=Mi(2,ri);let et=[new Point(rt.x,rt.y),new Point(ot.x,ot.y),new Point(gt.x,gt.y),new Point(Or.x,Or.y)];Gr=gt,ci=Or,qe.push(et[0].x,et[0].y),qe.push(et[1].x,et[1].y),qe.push(et[2].x,et[2].y),qe.push(et[0].x,et[0].y),qe.push(et[2].x,et[2].y),qe.push(et[3].x,et[3].y),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Qe.push(1,1,1),Ke.push(0,0),Ke.push(1,0),Ke.push(1,1),Ke.push(0,0),Ke.push(1,1),Ke.push(0,1)}return Ve(qe,Qe,Ke)}function Ue(){let Le=Te();if(Y&&(W.stage.removeChild(Y),Y=null),ue.value=="t"?Y=Ae(Le):ue.value==""?Y=Ie(Le):ue.value==""&&(Y=We(Le)),Y&&(Y.eventMode="none",W.stage.addChild(Y)),te&&(W.stage.removeChild(te),te=null),te=new Container,W.stage.addChild(te),te&&ge.value){const qe=new Graphics,Qe=Y.geometry.buffers[0].data;for(let Ke=0;Ke<Qe.length/12;Ke++){const Je=Ke*12,pt=[new Point(Qe[Je+0],Qe[Je+1]),new Point(Qe[Je+2],Qe[Je+3]),new Point(Qe[Je+4],Qe[Je+5]),new Point(Qe[Je+10],Qe[Je+11])];qe.lineStyle(1,11141120),qe.moveTo(pt[0].x,pt[0].y),qe.lineTo(pt[1].x,pt[1].y),qe.lineTo(pt[2].x,pt[2].y),qe.lineTo(pt[3].x,pt[3].y),qe.lineTo(pt[0].x,pt[0].y)}te.addChild(qe)}for(let qe=0;qe<Le.length;qe++){let Qe=q.children[qe];Qe.clear(),Qe.beginFill(44469,1),Qe.drawCircle(0,0,Qe.hitArea.radius),Qe.endFill(),qe===X&&(Qe.lineStyle(3,3751494,1),Qe.drawCircle(0,0,Qe.hitArea.radius))}}function je(Le){const qe=Le.data.global;for(let Qe=0;Qe<q.children.length;Qe++){const Ke=q.children[Qe];let Je=Ke.toLocal(qe);if(Je.x*Je.x+Je.y*Je.y<Ke.hitArea.radius*Ke.hitArea.radius){X=Qe;break}}Ue()}function ze(Le){X=-1,Ue()}function He(Le){if(X>=0){const{x:qe,y:Qe}=Le.data.global;let Ke=q.toLocal({x:qe,y:Qe});q.children[X].position.set(Ke.x,Ke.y),Ue()}}return watch(ue,()=>{Ue()}),watch(ae,()=>{Ue()}),onMounted(async()=>{W=new Application({background:"#eeeeee",resizeTo:E.value}),E.value.appendChild(W.view);const Le={x:W.screen.width/2,y:W.screen.height/2};W.stage.eventMode="static",W.stage.hitArea=W.screen,W.stage.on("pointerupoutside",ze),W.stage.on("pointerdown",je),W.stage.on("pointerup",ze),W.stage.on("pointermove",He);{q=new Container,W.stage.addChild(q);for(let Qe=0;Qe<4;Qe++){let Ke=new Graphics;q.addChild(Ke),Ke.hitArea=new Circle$1(0,0,30)}let qe=q.children.slice(q.children.length-4);qe[0].position.set(Le.x,Le.y+300),qe[1].position.set(Le.x-300,Le.y-100),qe[2].position.set(Le.x+300,Le.y+100),qe[3].position.set(Le.x,Le.y-300),Ue()}document.addEventListener("keydown",qe=>{qe.key>=1&&qe.key<=9&&xe[qe.key-1]&&(ae.value=qe.key-1,Ue())})}),(Le,qe)=>{const Qe=resolveComponent("Option"),Ke=resolveComponent("Select"),Je=resolveComponent("ListItem"),pt=resolveComponent("Checkbox"),ut=resolveComponent("InputNumber"),lt=resolveComponent("List"),st=resolveComponent("Col"),sr=resolveComponent("Row");return openBlock(),createBlock(sr,null,{default:withCtx(()=>[createVNode(st,{span:4},{default:withCtx(()=>[createVNode(lt,{style:{"padding-left":"20px"}},{default:withCtx(()=>[createVNode(Je,null,{default:withCtx(()=>[_hoisted_1$5,createVNode(Ke,{modelValue:ue.value,"onUpdate:modelValue":qe[0]||(qe[0]=mt=>ue.value=mt)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(le.value,mt=>(openBlock(),createBlock(Qe,{value:mt,key:mt},{default:withCtx(()=>[createTextVNode(toDisplayString(mt),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(Je,null,{default:withCtx(()=>[_hoisted_2$2,createVNode(Ke,{modelValue:ae.value,"onUpdate:modelValue":qe[1]||(qe[1]=mt=>ae.value=mt)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(ne.value,mt=>(openBlock(),createBlock(Qe,{value:mt.value,key:mt.value},{default:withCtx(()=>[createTextVNode(toDisplayString(mt.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(Je,null,{default:withCtx(()=>[createVNode(pt,{modelValue:ge.value,"onUpdate:modelValue":qe[2]||(qe[2]=mt=>ge.value=mt)},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["modelValue"])]),_:1}),createVNode(Je,null,{default:withCtx(()=>[createTextVNode("  "),createVNode(ut,{modelValue:ye.value,"onUpdate:modelValue":qe[3]||(qe[3]=mt=>ye.value=mt),min:1,max:100,step:10,"controls-outside":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),createVNode(st,{span:20},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"rootRef",ref:E,style:{width:"100%",height:"98vh"}},null,512)]),_:1})]),_:1})}}},GameLayer={BgLayer:0,LooseCube:1,EnermySnake:2,PlayerSnake:3};var Vo;let GameApp$1=(Vo=class{constructor(){Gn(this,"pixi",null);Gn(this,"gameContainer",null);Gn(this,"uiContainer",null);Gn(this,"ticker",null);Gn(this,"radius",1920/2);Gn(this,"gameState",null);Gn(this,"chineseFunnyNames",["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]);Gn(this,"rankList",[]);Gn(this,"playerRank",{name:"YOU",value:0});Gn(this,"layerContainers",[null,null,null,null]);Gn(this,"_inited",!1)}randomName(){return this.chineseFunnyNames[Math.floor(Math.random()*this.chineseFunnyNames.length)]}updateRankList(_,T){const E=this.rankList.findIndex(W=>W.name===_);E!==-1?this.rankList[E].value=T:this.rankList.push({name:_,value:T}),this.rankList.sort((W,X)=>X.value-W.value),this.rankList=this.rankList.slice(0,5)}static get instance(){return Vo._instance||(Vo._instance=new Vo),Vo._instance}init(_){this._inited||(this.pixi=createPixi(_),this.ticker=this.pixi.ticker,this.gameContainer=new Container,this.layerContainers=[new Container,new Container,new Container,new Container],this.layerContainers.forEach(T=>this.gameContainer.addChild(T)),this.pixi.stage.addChild(this.gameContainer),this.gameContainer.position.set(this.pixi.screen.width/2,this.pixi.screen.height/2),this.uiContainer=new Container,this.pixi.stage.addChild(this.uiContainer),this.uiContainer.position.set(this.pixi.screen.width/2,this.pixi.screen.height/2),this.ticker.add(this.update,this),this._inited=!0)}update(_){update()}get bgCircle(){return this.layerContainers[GameLayer.BgLayer].children[0]}get playerSnake(){return this.layerContainers[GameLayer.PlayerSnake].children[0]}get enemySnakes(){return this.layerContainers[GameLayer.EnermySnake].children}get looseCubes(){return this.layerContainers[GameLayer.LooseCube].children}destroy(){this._inited&&(this.ticker&&this.ticker.stop(),this.pixi&&this.pixi.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.gameContainer=null,this.uiContainer=null,this.layerContainers=[null,null,null,null],this.pixi=null,this.ticker=null,this._inited=!1)}getLayerContainer(_){return this.layerContainers[_]}clearAllGameObjects(){this.layerContainers.slice(1).forEach(_=>{_&&_.removeChildren()})}addGameObject(_,T){this.layerContainers[T]&&(this.layerContainers[T].addChild(_),_.onAdd&&_.onAdd())}removeGameObject(_){this.layerContainers.forEach(T=>{_.parent===T&&(T.removeChild(_),_.onDestroy&&_.onDestroy())})}setObjectLayer(_,T){this.removeGameObject(_),this.addGameObject(_,T)}addUI(_){this.uiContainer&&(this.uiContainer.addChild(_),_.onAdd&&_.onAdd())}removeUI(_){this.uiContainer&&_.parent===this.uiContainer&&(this.uiContainer.removeChild(_),_.onDestroy&&_.onDestroy())}clearUI(){this.uiContainer&&this.uiContainer.removeChildren()}},Gn(Vo,"_instance"),Vo);class BgCircle extends Container{constructor(){super(),this.graphics=new Graphics,this.addChild(this.graphics),this.stars=[]}init(){const _=GameApp$1.instance;this.radius=_.radius,this.lineWidth=5,this.lineColor=13421772,this.graphics.clear(),this.graphics.lineStyle(this.lineWidth,this.lineColor),this.graphics.drawCircle(0,0,this.radius),this.x=0,this.y=0,this._createStars()}_createStars(){for(const X of this.stars)this.removeChild(X);this.stars=[];const _=GameApp$1.instance,T=_.pixi.screen.width,E=_.pixi.screen.height,W=80;for(let X=0;X<W;X++)this._createStar(T,E)}_createStar(_,T){const E=Math.random()*this.radius-this.radius/2,W=Math.random()*this.radius-this.radius/2,X=Math.random()*.4+.4,q=Math.random()*.25+.05,Y=Sprite$1.from("game2048/star_small.png");Y.x=E,Y.y=W,Y.anchor.set(.5),Y.scale.set(X),Y.alpha=q,Y._baseAlpha=q,Y._maxTwinkle=Math.floor(Math.random()*7)+4,Y._twinkleCount=0,Y._twinkleTime=Math.random()*Math.PI*2,Y._twinkleSpeed=Math.random()*.001+1e-4,Y._lastSin=Math.sin(Y._twinkleTime),Y.alpha=Y._baseAlpha,this.addChildAt(Y,0),this.stars.push(Y)}_updateStars(_){const T=GameApp$1.instance,E=T.pixi.screen.width,W=T.pixi.screen.height;for(let X=this.stars.length-1;X>=0;X--){const q=this.stars[X];q._twinkleTime+=q._twinkleSpeed*_;const Y=Math.sin(q._twinkleTime);if(q.alpha=q._baseAlpha*Math.abs(Y),q._lastSin<0&&Y>=0&&(q._twinkleCount++,q._twinkleCount>=q._maxTwinkle)){this.removeChild(q),this.stars.splice(X,1),this._createStar(E,W);continue}q._lastSin=Y}}}var circlePoint$4=function(_,T,E,W,X){var q=W-_,Y=X-T;return q*q+Y*Y<=E*E},circleCircle=function(_,T,E,W,X,q){var Y=_-W,te=X-T,ne=E+q;return Y*Y+te*te<=ne*ne},lineCircle$3=function(_,T,E,W,X,q,Y){var te=[X-_,q-T],ne=[E-_,W-T],ae=dot(ne,ne),le=dot(te,ne),ue=le/ae;ue=ue<0?0:ue,ue=ue>1?1:ue;var ge=[ne[0]*ue+_-X,ne[1]*ue+T-q],ye=dot(ge,ge);return ye<=Y*Y};function dot(B,_){return B[0]*_[0]+B[1]*_[1]}var lineCircle$2=lineCircle$3,circleLine=function(_,T,E,W,X,q,Y){return lineCircle$2(W,X,q,Y,_,T,E)},boxCircle$2=function(_,T,E,W,X,q,Y){var te=E/2,ne=W/2,ae=Math.abs(X-(_+E/2)),le=Math.abs(q-(T+W/2));if(ae>te+Y||le>ne+Y)return!1;if(ae<=te||le<=ne)return!0;var ue=ae-te,ge=le-ne;return ue*ue+ge*ge<=Y*Y},boxCircle$1=boxCircle$2,circleBox=function(_,T,E,W,X,q,Y){return boxCircle$1(W,X,q,Y,_,T,E)};function distanceSquared(B,_,T,E){return Math.sqrt(Math.pow(B-T,2)+Math.pow(_-E,2))}var linePoint$2=function(_,T,E,W,X,q,Y){return Y=Y||1,Math.abs(distanceSquared(_,T,E,W)-(distanceSquared(_,T,X,q)+distanceSquared(E,W,X,q)))<=Y};const linePoint$1=linePoint$2;var polygonPoint$4=function(_,T,E,W){var X=_.length,q=!1,Y,te;for(Y=0,te=X-2;Y<X;Y+=2)_[Y+1]>E!=_[te+1]>E&&T<(_[te]-_[Y])*(E-_[Y+1])/(_[te+1]-_[Y+1])+_[Y]&&(q=!q),te=Y;if(q)return!0;for(Y=0;Y<X;Y+=2){var ne=_[Y],ae=_[Y+1],le,ue;if(Y===X-2?(le=_[0],ue=_[1]):(le=_[Y+2],ue=_[Y+3]),linePoint$1(ne,ae,le,ue,T,E,W))return!0}return!1},polygonPoint$3=polygonPoint$4,lineCircle$1=lineCircle$3,polygonCircle$1=function(_,T,E,W,X){if(polygonPoint$3(_,T,E,X))return!0;for(var q=_.length,Y=0;Y<q-2;Y+=2)if(lineCircle$1(_[Y],_[Y+1],_[Y+2],_[Y+3],T,E,W))return!0;return lineCircle$1(_[0],_[1],_[q-2],_[q-1],T,E,W)},polygonCircle=polygonCircle$1,circlePolygon=function(_,T,E,W,X){return polygonCircle(W,_,T,E,X)},MAX_ITERATIONS=10,innerPolygonCoef,outerPolygonCoef,initialized;function initialize(){innerPolygonCoef=[],outerPolygonCoef=[];for(var B=0;B<=MAX_ITERATIONS;B++){var _=4<<B;innerPolygonCoef[B]=.5/Math.cos(4*Math.acos(0)/_),outerPolygonCoef[B]=.5/(Math.cos(2*Math.acos(0)/_)*Math.cos(2*Math.acos(0)/_))}initialized=!0}function iterate(B,_,T,E,W,X,q){for(var Y=1;Y<=MAX_ITERATIONS;Y++){var te=(T+W)*innerPolygonCoef[Y],ne=(E+X)*innerPolygonCoef[Y],ae=B-te,le=_-ne;if(ae*ae+le*le<=q)return!0;var ue=W-te,ge=X-ne;if(ae*ue+le*ge>=0&&ae*ue+le*ge<=ue*ue+ge*ge&&(le*ue-ae*ge>=0||q*(ue*ue+ge*ge)>=(le*ue-ae*ge)*(le*ue-ae*ge)))return!0;var ye=T-te,xe=E-ne;if(ae*ye+le*xe>=0&&ae*ye+le*xe<=ye*ye+xe*xe&&(le*ye-ae*xe<=0||q*(ye*ye+xe*xe)>=(le*ye-ae*xe)*(le*ye-ae*xe)))return!0;var Te=(T+te)*outerPolygonCoef[Y],Ae=(E+ne)*outerPolygonCoef[Y];if((Te-B)*(Te-B)+(Ae-_)*(Ae-_)<q){W=te,X=ne;continue}var Ie=te-Te+te,Ve=ne-Ae+ne;if((Ie-B)*(Ie-B)+(Ve-_)*(Ve-_)<q){T=te,E=ne;continue}var $e=Te-te,We=Ae-ne;if(le*$e-ae*We<=0||q*($e*$e+We*We)>(le*$e-ae*We)*(le*$e-ae*We)){if(ae*$e+le*We>0){if(Math.abs(ae*$e+le*We)<=$e*$e+We*We||(B-Te)*(T-Te)+(_-Ae)*(E-Ae)>=0){W=te,X=ne;continue}}else if(-(ae*$e+le*We)<=$e*$e+We*We||(B-Ie)*(W-Ie)+(_-Ve)*(X-Ve)>=0){T=te,E=ne;continue}}return!1}return!1}function ellipseEllipse$1(B,_,T,E,W,X,q,Y){initialized||initialize();var te=Math.abs(W-B)*Y,ne=Math.abs(X-_)*q;T*=Y,E*=q;var ae=q*Y;return te*te+(E-ne)*(E-ne)<=ae*ae||(T-te)*(T-te)+ne*ne<=ae*ae||te*E+ne*T<=T*E||(te*E+ne*T-T*E)*(te*E+ne*T-T*E)<=ae*ae*(T*T+E*E)&&te*T-ne*E>=-E*E&&te*T-ne*E<=T*T?!0:(te-T)*(te-T)+(ne-E)*(ne-E)<=ae*ae||te<=T&&ne-ae<=E||ne<=E&&te-ae<=T?iterate(te,ne,T,0,0,E,ae*ae):!1}function ellipseCircle$2(B,_,T,E,W,X,q){initialized||initialize();var Y=Math.abs(W-B),te=Math.abs(X-_);return Y*Y+(E-te)*(E-te)<=q*q||(T-Y)*(T-Y)+te*te<=q*q||Y*E+te*T<=T*E||(Y*E+te*T-T*E)*(Y*E+te*T-T*E)<=q*q*(T*T+E*E)&&Y*T-te*E>=-E*E&&Y*T-te*E<=T*T?!0:(Y-T)*(Y-T)+(te-E)*(te-E)<=q*q||Y<=T&&te-q<=E||te<=E&&Y-q<=T?iterate(Y,te,T,0,0,E,q*q):!1}var ellipseHelper$2={ellipseCircle:ellipseCircle$2,ellipseEllipse:ellipseEllipse$1},ellipseHelper$1=ellipseHelper$2,ellipseCircle$1=function(_,T,E,W,X,q,Y){return ellipseHelper$1.ellipseCircle(_,T,E,W,X,q,Y)},ellipseCircle=ellipseCircle$1,circleEllipse=function(_,T,E,W,X,q,Y){return ellipseCircle(W,X,q,Y,_,T,E)},circlePoint$3=circlePoint$4,boxCircle=boxCircle$2,circleOutlineBox$1=function(_,T,E,W,X,q,Y,te){te=te||1;var ne=0;if(ne+=circlePoint$3(_,T,E,W,X)?1:0,ne+=circlePoint$3(_,T,E,W+q,X)?1:0,ne+=circlePoint$3(_,T,E,W,X+Y)?1:0,ne+=circlePoint$3(_,T,E,W+q,X+Y)?1:0,ne===0)return boxCircle(W,X,q,Y,_,T,E);if(ne>=1&&ne<=3)return!0;if(ne===4)return!circlePoint$3(_,T,E-te,W,X)||!circlePoint$3(_,T,E-te,W+q,X)||!circlePoint$3(_,T,E-te,W,X+Y)||!circlePoint$3(_,T,E-te,W+q,X+Y)},lineCircle=lineCircle$3,circlePoint$2=circlePoint$4,circleOutlineLine$1=function(_,T,E,W,X,q,Y,te){return te=te||1,lineCircle(W,X,q,Y,_,T,E)&&!(circlePoint$2(_,T,E-te,W,X)&&circlePoint$2(_,T,E-te,q,Y))},circlePoint$1=circlePoint$4,circleOutlinePoint$1=function(_,T,E,W,X,q){return q=q||1,circlePoint$1(_,T,E,W,X)&&!circlePoint$1(_,T,E-q,W,X)},lineToLine$1=function(_,T,E,W,X,q,Y,te){var ne=E-_,ae=W-T,le=Y-X,ue=te-q,ge=(-ae*(_-X)+ne*(T-q))/(-le*ae+ne*ue),ye=(le*(T-q)-ue*(_-X))/(-le*ae+ne*ue);return ge>=0&&ge<=1&&ye>=0&&ye<=1},polygonPoint$2=polygonPoint$4,lineLine$2=lineToLine$1,linePolygon$2=function(_,T,E,W,X,q){var Y=X.length;if(polygonPoint$2(X,_,T,q))return!0;for(var te=0;te<Y;te+=2){var ne=(te+2)%Y;if(lineLine$2(_,T,E,W,X[te],X[te+1],X[ne],X[ne+1]))return!0}return!1},linePolygon$1=linePolygon$2,polygonLine=function(_,T,E,W,X,q){return linePolygon$1(T,E,W,X,_,q)},polygonPolygon$2=function(_,T){for(var E=_,W=T,X=[E,W],q,Y,te,ne,ae,le,ue=0;ue<X.length;ue++)for(var ge=X[ue],ye=0;ye<ge.length;ye+=2){var xe=(ye+2)%ge.length,Te={x:ge[xe+1]-ge[ye+1],y:ge[ye]-ge[xe]};for(q=Y=null,le=0;le<E.length;le+=2)te=Te.x*E[le]+Te.y*E[le+1],(q===null||te<q)&&(q=te),(Y===null||te>Y)&&(Y=te);for(ne=ae=null,le=0;le<W.length;le+=2)te=Te.x*W[le]+Te.y*W[le+1],(ne===null||te<ne)&&(ne=te),(ae===null||te>ae)&&(ae=te);if(Y<ne||ae<q)return!1}return!0},polygonPolygon$1=polygonPolygon$2,polygonBox$1=function(_,T,E,W,X){var q=[T,E,T+W,E,T+W,E+X,T,E+X];return polygonPolygon$1(_,q)},ellipseLine$2=function(_,T,E,W,X,q,Y,te){X-=_,Y-=_,q-=T,te-=T;var ne=Math.pow(Y-X,2)/E/E+Math.pow(te-q,2)/W/W,ae=2*X*(Y-X)/E/E+2*q*(te-q)/W/W,le=X*X/E/E+q*q/W/W-1,ue=ae*ae-4*ne*le;if(ue===0){var ge=-ae/2/ne;return ge>=0&&ge<=1}else if(ue>0){var ye=Math.sqrt(ue),xe=(-ae+ye)/2/ne,Te=(-ae-ye)/2/ne;return xe>=0&&xe<=1||Te>=0&&Te<=1}else return!1},ellipseLine$1=ellipseLine$2,lineEllipse$1=function(_,T,E,W,X,q,Y,te){return ellipseLine$1(X,q,Y,te,_,T,E,W)},polygonPoint$1=polygonPoint$4,lineEllipse=lineEllipse$1,polygonEllipse$1=function(_,T,E,W,X){if(polygonPoint$1(_,T,E))return!0;for(var q=_.length,Y=0;Y<q-2;Y+=2)if(lineEllipse(_[Y],_[Y+1],_[Y+2],_[Y+3],T,E,W,X))return!0;return lineEllipse(_[0],_[1],_[q-2],_[q-1],T,E,W,X)},boxPoint$3=function(_,T,E,W,X,q){return X>=_&&X<=_+E&&q>=T&&q<=T+W},boxBox=function(_,T,E,W,X,q,Y,te){return _<X+Y&&_+E>X&&T<q+te&&T+W>q},lineToPolygon$1=function(_,T,E,W,X){const q=Math.atan2(W-T,E-_)-Math.PI/2,Y=X/2,te=Math.cos(q)*Y,ne=Math.sin(q)*Y;return[_-te,T-ne,E-te,W-ne,E+te,W+ne,_+te,T+ne]};const lineToPolygon=lineToPolygon$1,polygonPolygon=polygonPolygon$2,linePolygon=linePolygon$2,lineToLine=lineToLine$1;var lineLine$1=function(_,T,E,W,X,q,Y,te,ne,ae){return ne||ae?lineLineThickness(_,T,E,W,X,q,Y,te,ne,ae):lineToLine(_,T,E,W,X,q,Y,te)};function lineLineThickness(B,_,T,E,W,X,q,Y,te,ne){if(te&&ne)return polygonPolygon(lineToPolygon(B,_,T,E,te),lineToPolygon(W,X,q,Y,ne));if(te)return linePolygon(W,X,q,Y,lineToPolygon(B,_,T,E,te));if(ne)return linePolygon(B,_,T,E,lineToPolygon(W,X,q,Y,te))}var boxPoint$2=boxPoint$3,lineLine=lineLine$1,lineBox$1=function(_,T,E,W,X,q,Y,te){return boxPoint$2(X,q,Y,te,_,T)||boxPoint$2(X,q,Y,te,E,W)?!0:lineLine(_,T,E,W,X,q,X+Y,q)||lineLine(_,T,E,W,X+Y,q,X+Y,q+te)||lineLine(_,T,E,W,X,q+te,X+Y,q+te)||lineLine(_,T,E,W,X,q,X,q+te)},lineBox=lineBox$1,boxLine=function(_,T,E,W,X,q,Y,te){return lineBox(X,q,Y,te,_,T,E,W)},polygonBox=polygonBox$1,boxPolygon=function(_,T,E,W,X){return polygonBox(X,_,T,E,W)},ellipseLine=ellipseLine$2,boxPoint$1=boxPoint$3,ellipseBox$1=function(_,T,E,W,X,q,Y,te){return boxPoint$1(X,q,Y,te,_,T)||ellipseLine(_,T,E,W,X,q,X+Y,q)||ellipseLine(_,T,E,W,X,q+te,X+Y,q+te)||ellipseLine(_,T,E,W,X,q,X,q+te)||ellipseLine(_,T,E,W,X+Y,q,X+Y,q+te)},ellipseBox=ellipseBox$1,boxEllipse=function(_,T,E,W,X,q,Y,te){return ellipseBox(X,q,Y,te,_,T,E,W)},circleOutlineBox=circleOutlineBox$1,boxCircleOutline=function(_,T,E,W,X,q,Y,te){return circleOutlineBox(X,q,Y,_,T,E,W,te)},boxPoint=boxPoint$3,pointBox=function(_,T,E,W,X,q){return boxPoint(E,W,X,q,_,T)},polygonPoint=polygonPoint$4,pointPolygon=function(_,T,E,W){return polygonPoint(E,_,T,W)},circlePoint=circlePoint$4,pointCircle=function(_,T,E,W,X){return circlePoint(E,W,X,_,T)},linePoint=linePoint$2,pointLine=function(_,T,E,W,X,q){return linePoint(E,W,X,q,_,T)},ellipsePoint$1=function(_,T,E,W,X,q){var Y=Math.pow(X-_,2)/(E*E),te=Math.pow(q-T,2)/(W*W);return Y+te<=1},ellipsePoint=ellipsePoint$1,pointEllipse=function(_,T,E,W,X,q){return ellipsePoint(E,W,X,q,_,T)},circleOutlinePoint=circleOutlinePoint$1,pointCircleOutline=function(_,T,E,W,X,q){return circleOutlinePoint(_,T,E,W,X,q)},circleOutlineLine=circleOutlineLine$1,lineCircleOutline=function(_,T,E,W,X,q,Y,te){return circleOutlineLine(X,q,Y,_,T,E,W,te)},ellipseHelper=ellipseHelper$2,ellipseEllipse=function(_,T,E,W,X,q,Y,te){return ellipseHelper.ellipseEllipse(_,T,E,W,X,q,Y,te)},polygonEllipse=polygonEllipse$1,ellipsePolygon=function(_,T,E,W,X){return polygonEllipse(X,_,T,E,W)},intersects={circlePoint:circlePoint$4,circleCircle,circleLine,circleBox,circlePolygon,circleEllipse,circleOutlineBox:circleOutlineBox$1,circleOutlineLine:circleOutlineLine$1,circleOutlinePoint:circleOutlinePoint$1,polygonPoint:polygonPoint$4,polygonLine,polygonPolygon:polygonPolygon$2,polygonBox:polygonBox$1,polygonCircle:polygonCircle$1,polygonEllipse:polygonEllipse$1,boxPoint:boxPoint$3,boxBox,boxLine,boxPolygon,boxCircle:boxCircle$2,boxEllipse,boxCircleOutline,pointBox,pointPolygon,pointCircle,pointLine,pointEllipse,pointCircleOutline,lineLine:lineLine$1,lineBox:lineBox$1,linePolygon:linePolygon$2,lineCircle:lineCircle$3,linePoint:linePoint$2,lineEllipse:lineEllipse$1,lineCircleOutline,ellipsePoint:ellipsePoint$1,ellipseLine:ellipseLine$2,ellipseBox:ellipseBox$1,ellipseCircle:ellipseCircle$1,ellipseEllipse,ellipsePolygon};const go=class go extends Container{static getColorByValue(_){const T=Math.max(0,Math.min(go.COLOR_LIST.length-1,Math.log2(_)-1));return go.COLOR_LIST[T]}static getLightColorByValue(_,T=.5){const E=go.getColorByValue(_),W=E>>16&255,X=E>>8&255,q=E&255,Y=Math.round(W+(255-W)*T),te=Math.round(X+(255-X)*T),ne=Math.round(q+(255-q)*T);return Y<<16|te<<8|ne}constructor(_,T=0,E=0){super(),this.currentValue=_,this.speedRatio=1,this.snake=null,this.x=T,this.y=E,this.debugMode=!1,this.debugGraphics=null,this.selfAnchorX=1;const W=Texture$1.from("game2048/ship_E.png");W?this.shipSprite=new Sprite$1(W):(console.error("Ship_E texture not found. Make sure it is loaded."),this.shipSprite=new Graphics().beginFill(16711680).drawRect(-15,-15,30,30).endFill()),this.shipSprite.anchor.set(this.selfAnchorX,.5),this.addChild(this.shipSprite),this.shipSprite.tint=go.getLightColorByValue(this.currentValue),this.valueText=new Text$1(this.currentValue.toString(),{fontFamily:"Arial Black, Arial, Montserrat, Impact, sans-serif",fontSize:28,fontWeight:"bold",fill:go.getColorByValue(this.currentValue),align:"center",stroke:2236962,strokeThickness:6,dropShadow:!0,dropShadowColor:0,dropShadowBlur:4,dropShadowDistance:0}),this.valueText.anchor.set(.5),this.shipSprite.addChild(this.valueText),this.updateScaleByValue(this.currentValue),this.setValue(this.currentValue),this.rotation=0,this.setSnake(null)}setSnake(_){this.snake=_,_?(this.shipSprite.tint=go.getLightColorByValue(this.currentValue),this.valueText.style.fill=go.getColorByValue(this.currentValue)):(this.shipSprite.tint=13421772,this.valueText.style.fill=13421772)}updateScaleByValue(_){let T=1;_>=2&&(T=1+.1*(Math.log2(_)-1)),this.shipSprite.scale.set(T)}setValue(_){this.currentValue=_,this.valueText.text=_.toString();const T=go.getColorByValue(_);this.valueText.style.fill=T,this.updateScaleByValue(_),this.valueText.x=-25}getRealCenter(){return{x:(.5-this.selfAnchorX)*this.shipSprite.width,y:0}}get value(){return this.currentValue}getSize(){return this.shipSprite.width}getCollision(){const _=this.getSize(),{x:T,y:E}=this.getRealCenter(),W=this.toGlobal(new Point(T,E));return{centerX:W.x,centerY:W.y,radius:_/2}}updateDebugGraphics(){this.debugGraphics||(this.debugGraphics=new Graphics,this.addChild(this.debugGraphics)),this.debugGraphics.clear();const _=this.getCollision(),T=this.toLocal(new Point(_.centerX,_.centerY)),E=_.radius/this.shipSprite.scale.x;this.debugGraphics.lineStyle(2,16711680),this.debugGraphics.drawCircle(T.x,T.y,E),this.debugGraphics.beginFill(65280),this.debugGraphics.drawCircle(T.x,T.y,5),this.debugGraphics.endFill(),this.debugGraphics.beginFill(0),this.debugGraphics.drawCircle(0,0,5),this.debugGraphics.endFill()}clearDebugGraphics(){this.debugGraphics&&this.debugGraphics.clear()}toggleDebug(){this.debugMode=!this.debugMode,this.debugMode?this.updateDebugGraphics():this.clearDebugGraphics()}};Gn(go,"COLOR_LIST",[13421772,10079487,6737049,16764006,16750950,16737894,13395711,6724095,3394764,6750105,16777062,16777215]);let Cube=go;function shortestAngleDist(B,_){const T=Math.PI*2,E=(_-B)%T;return 2*E%T-E}function normalizeAnglePi(B){return B=B%(Math.PI*2),B>Math.PI&&(B-=Math.PI*2),B<-Math.PI&&(B+=Math.PI*2),B}class Snake extends Container{constructor(){super(),this.cubes=[],this.setBaseSpeed(3),this.speedRatio=1,this.pendingMerge=null,this.targetDirectionX=1,this.targetDirectionY=0,this.debugMode=!1,this.debugGraphics=null}setBaseSpeed(_){this.baseSpeed=_}onAdd(){GameApp$1.instance.ticker.add(this.update,this)}onDestroy(){GameApp$1.instance.ticker.remove(this.update,this)}get head(){return this.cubes[0]}setPosition(_,T){this.head.x=_,this.head.y=T}computeIdealCubePose(_,T){const E=T.getSize(),X=(_.getSize()+E)/4,q=_.x-Math.cos(_.rotation)*X,Y=_.y-Math.sin(_.rotation)*X;q-_.x,Y-_.y;let te=_.rotation;return{x:q,y:Y,rotation:te}}setName(_){this.name=_,this.updateName()}updateName(){this.head&&(this.nameTxt||(this.nameTxt=new Text$1(this.name||"",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:20,fill:16777062,stroke:2236962,strokeThickness:5,align:"center"}),this.nameTxt.anchor.set(.5,1),this.head.addChild(this.nameTxt),this.nameTxt.x=0,this.nameTxt.y=0,this.nameTxt.rotation=Math.PI/2,this.nameTxt.visible=!!this.name),this.nameTxt.text=this.name||"")}addCubes(_){_.forEach(T=>{this.addCube(T)})}addCube(_){let T=0,E=0,W=0,X=this.cubes.length;for(;X>0&&this.cubes[X-1].currentValue<_;)X--;const q=new Cube(_,0,0);if(this.cubes.length>0){let Y=X>0?this.cubes[X-1]:null,te=this.cubes[X]||null;if(Y){const ne=this.computeIdealCubePose(Y,q);T=ne.x,E=ne.y,W=ne.rotation}else te&&(T=te.x+Math.cos(te.rotation)*((te.getSize()+q.getSize())/4),E=te.y+Math.sin(te.rotation)*((te.getSize()+q.getSize())/4),W=te.rotation+Math.PI)}return q.x=T,q.y=E,q.rotation=W,q.setSnake(this),this.cubes.splice(X,0,q),this.addChild(q),this.updateCubeZOrder(),this.onHeadValueChanged(),this.updateName(),q}onHeadValueChanged(){}update(_){if(this.updateNormalMovement(_),this.pendingMerge)this.updateMergeAnimation(_);else if(this.mergeCooldown&&this.mergeCooldown>0){const T=_&&_.deltaMS?_.deltaMS:16;this.mergeCooldown-=T,this.mergeCooldown<0&&(this.mergeCooldown=0)}else this.mergeCubesIfPossible()}updateHeadDirectionStrategy(_){}get finalSpeed(){return this.baseSpeed*this.speedRatio}setHeadDirection(_,T){const E=Math.sqrt(_*_+T*T);E>1e-5?(this.targetDirectionX=_/E,this.targetDirectionY=T/E):(this.targetDirectionX=1,this.targetDirectionY=0)}updateHeadMovement(_){const T=this.head;(typeof this.targetDirectionX!="number"||typeof this.targetDirectionY!="number")&&(this.targetDirectionX=1,this.targetDirectionY=0);const E=Math.atan2(this.targetDirectionY,this.targetDirectionX),W=normalizeAnglePi(T.rotation),X=shortestAngleDist(W,E),q=.1;if(T.rotation+=X*q*_,T.rotation=normalizeAnglePi(T.rotation),T.x+=Math.cos(T.rotation)*this.finalSpeed*_,T.y+=Math.sin(T.rotation)*this.finalSpeed*_,this.gameApp&&typeof this.gameApp.radius=="number"){const Y=this.gameApp.radius;if(Math.sqrt(T.x*T.x+T.y*T.y)>Y){const ne=Math.atan2(T.y,T.x);T.x=Math.cos(ne)*Y,T.y=Math.sin(ne)*Y}}}updateNormalMovement(_){const T=_&&_.deltaTime?_.deltaTime:1;this.updateHeadDirectionStrategy(_),this.updateHeadMovement(T);let E=-1;this.pendingMerge&&this.pendingMerge.cubeB&&(E=this.cubes.indexOf(this.pendingMerge.cubeB)),this.updateSnakeLogic(T,E)}mergeCubesIfPossible(){if(!this.pendingMerge&&!(this.cubes.length<2))for(let _=0;_<this.cubes.length-1;_++){const T=this.cubes[_],E=this.cubes[_+1];if(T.currentValue===E.currentValue){this.pendingMerge={i:_,cubeA:T,cubeB:E,animTime:0,phase:1,hasMerged:!1};break}}}triggerMergeAnimation(_,T){T.speedRatio=2}updateMergeAnimation(_){const T=this.pendingMerge;if(!T||!T.cubeA||!T.cubeB){this.pendingMerge=null;return}const E=200,W=_&&_.deltaMS?_.deltaMS:16;T.animTime+=W,T._startX===void 0&&(T._startX=T.cubeB.x,T._startY=T.cubeB.y);const X=Math.min(T.animTime/E,1);if(T.cubeB.x=T._startX+(T.cubeA.x-T._startX)*X,T.cubeB.y=T._startY+(T.cubeA.y-T._startY)*X,T.cubeB.alpha=1-X,X>=1){T.cubeB&&T.cubeB.parent&&this.removeChild(T.cubeB);const q=this.cubes.indexOf(T.cubeB);q!==-1&&this.cubes.splice(q,1),T.cubeA.setValue(T.cubeA.currentValue*2),this.cubes.indexOf(T.cubeA)===0&&this.onHeadValueChanged(),this.pendingMerge=null,this.mergeCooldown=200}}updateSnakeLogic(_,T=-1){if(!(this.cubes.length<2)){this.debugMode&&this.debugGraphics.clear();for(let E=1;E<this.cubes.length;E++){if(E===T)continue;const W=this.cubes[E],X=this.cubes[E-1],Y=X.getSize()*.7,te=X.x-Math.cos(X.rotation)*Y,ne=X.y-Math.sin(X.rotation)*Y;this.debugMode&&(this.drawTargetPoint(te,ne,16711680),this.drawLine(W.x,W.y,te,ne,65280),this.drawLine(X.x,X.y,te,ne,255));const ae=this.finalSpeed*W.speedRatio*3;{const le=te-W.x,ue=ne-W.y,ge=Math.sqrt(le*le+ue*ue);if(ge>3){const ye=Math.min(ae*_,ge);W.x+=le/ge*ye,W.y+=ue/ge*ye;const xe=Math.atan2(ue,le),Ie=shortestAngleDist(normalizeAnglePi(W.rotation),xe)*.1,Ve=normalizeAnglePi(W.rotation+Ie);W.rotation=Ve}else{W.x=te,W.y=ne;const ye=X.rotation,Ae=shortestAngleDist(normalizeAnglePi(W.rotation),ye)*.1,Ie=normalizeAnglePi(W.rotation+Ae);W.rotation=Ie}}}}}updateCubeZOrder(){for(let _=0;_<this.cubes.length;_++)this.setChildIndex(this.cubes[_],this.cubes.length-1-_)}splitAt(_){const T=GameApp$1.instance,E=this.cubes.splice(_);for(const W of E)W.setSnake(null),T.addGameObject(W,GameLayer.LooseCube);_===0&&T.removeGameObject(this)}toggleDebug(){this.debugMode=!this.debugMode,this.debugMode?this.initDebugGraphics():this.clearDebugGraphics()}initDebugGraphics(){this.debugGraphics||(this.debugGraphics=new Graphics,this.addChild(this.debugGraphics))}clearDebugGraphics(){this.debugGraphics&&this.debugGraphics.clear()}drawTargetPoint(_,T,E=16711680){!this.debugMode||!this.debugGraphics||(this.debugGraphics.beginFill(E),this.debugGraphics.drawCircle(_,T,5),this.debugGraphics.endFill())}drawLine(_,T,E,W,X=65280){!this.debugMode||!this.debugGraphics||(this.debugGraphics.lineStyle(2,X),this.debugGraphics.moveTo(_,T),this.debugGraphics.lineTo(E,W))}}class PlayerSnake extends Snake{constructor(){super(),this.gameApp=GameApp$1.instance,this.speedRatio=1,this.targetDirectionX=0,this.targetDirectionY=0,this.lastMouseX=-1,this.lastMouseY=-1,this.setName("YOU"),this.isMousePressed=!1}onAdd(){super.onAdd()}onDestroy(){super.onDestroy()}handleMouseDown(_){_.button===0&&(this.isMousePressed=!0,this.speedRatio=3)}handleMouseUp(_){_.button===0&&(this.isMousePressed=!1,this.speedRatio=1)}updateHeadDirectionStrategy(){const _=this.head,T=this.gameApp.pixi.renderer.events.pointer.global,E=this.gameApp.gameContainer.toLocal(T),W=this.gameApp.gameContainer.toLocal(_.getGlobalPosition(new Point,!1)),X=1;if(Math.abs(E.x-this.lastMouseX)>X||Math.abs(E.y-this.lastMouseY)>X||this.lastMouseX===-1){const q=E.x-W.x,Y=E.y-W.y,te=Math.sqrt(q*q+Y*Y);te>.01&&this.setHeadDirection(q/te,Y/te),this.lastMouseX=E.x,this.lastMouseY=E.y}}onHeadValueChanged(){GameApp$1.instance.playerRank.value=this.head.value}}class EnermySnake extends Snake{constructor(){super(),this.state="wander",this.stateTimer=0,this.stateInterval=8e3,this.wanderTarget={x:0,y:0},this.setRandomWanderTarget(),this.setName(GameApp$1.instance.randomName())}get playerSnakeInstance(){return GameApp$1.instance.playerSnake}setRandomWanderTarget(){const E=GameApp$1.instance.radius-30,W=Math.random()*Math.PI*2,X=Math.random()*E;this.wanderTarget.x=Math.cos(W)*X,this.wanderTarget.y=Math.sin(W)*X}onHeadValueChanged(){GameApp$1.instance.updateRankList(this.name,this.head.value)}updateHeadDirectionStrategy(_){var E,W;if(this.stateTimer+=(_==null?void 0:_.deltaMS)||16,this.stateTimer>=this.stateInterval){this.stateTimer=0;const X=(E=this.playerSnakeInstance)==null?void 0:E.head;this.state==="wander"?X&&this.head.value>X.value?this.state="chase":(this.state="wander",this.setRandomWanderTarget()):(this.state="wander",this.setRandomWanderTarget())}const T=(W=this.playerSnakeInstance)==null?void 0:W.head;if(this.state==="chase"&&T&&this.head.value>T.value)this.setHeadDirection(T.x-this.head.x,T.y-this.head.y);else{this.setHeadDirection(this.wanderTarget.x-this.head.x,this.wanderTarget.y-this.head.y);const X=this.wanderTarget.x-this.head.x,q=this.wanderTarget.y-this.head.y;Math.sqrt(X*X+q*q)<30&&this.setRandomWanderTarget()}}}function checkSnakeCollisions(){const B=GameApp$1.instance,_=[B.playerSnake,...B.enemySnakes];for(const T of _){if(!T||!T.head)continue;const E=T.head,W=getAllCubesExcludeSnake(T);for(const X of W){const q=E.getCollision(),Y=X.getCollision();if(intersects.circleCircle(q.centerX,q.centerY,q.radius,Y.centerX,Y.centerY,Y.radius)){if(X.snake){const ne=X.snake,ae=ne?ne.cubes.indexOf(X):-1;ne&&ae!==-1&&(E.currentValue>X.currentValue?ne.splitAt(ae):E.currentValue<X.currentValue?T.splitAt(0):T===B.playerSnake?ne.splitAt(ae):T.splitAt(0))}else if(E.currentValue>=X.currentValue){T.addCube(X.currentValue),B.removeGameObject(X);break}break}}}}function getAllCubesExcludeSnake(B){const _=GameApp$1.instance,T=[];for(const E of _.looseCubes)T.push(E);for(const E of _.enemySnakes)if(E!==B)for(let W=0;W<E.cubes.length;W++)T.push(E.cubes[W]);return T}function appear(B){return new Promise(_=>{B.scale.set(0),new Tween(B.scale).to({x:1,y:1},280).easing(Easing.Back.Out).onComplete(()=>_()).start()})}function disappear(B){return new Promise(_=>{new Tween(B.scale).to({x:0,y:0},180).easing(Easing.Back.In).onComplete(()=>_()).start()})}function scaleOnce(B){return new Promise(_=>{B.scale.set(1),new Tween(B.scale).to({x:1.2,y:1.2},50).easing(Easing.Back.Out).chain(new Tween(B.scale).to({x:1,y:1},50).easing(Easing.Bounce.Out).onComplete(()=>_())).start()})}class FailScreen extends Container{constructor({onRestart:_=null}={}){super(),this.eventMode="static",this.onRestart=_,this.rankList=GameApp$1.instance.rankList,this.root=new Container,this.root.scale.set(.5),this.addChild(this.root),this.createMask(),this.createCard(),this.createTitle(),this.createRankList(),this.createRestartButton(),this.setupAnimations()}createMask(){const _=new Graphics;_.beginFill(0,.6);const T=GameApp$1.instance.pixi.screen.width,E=GameApp$1.instance.pixi.screen.height;_.drawRect(-T/2,-E/2,T,E),_.endFill(),this.root.addChild(_)}createCard(){const _=this.rankList.length,T=520,E=120,W=64,X=64,q=108,Y=56,te=_>0?_*W:W,ne=64,ae=X+q+32+Y+32+te+ne+E+X,le=Math.max(T,ae),ue=840,ge=new Graphics;ge.beginFill(16777215,.98),ge.drawRoundedRect(-ue/2,-le/2,ue,le,64),ge.endFill(),ge.x=0,ge.y=0,this.root.addChild(ge),this.content=new Container,this.content.x=0,this.content.y=-le/2,this.root.addChild(this.content),this.cardHeight=le,this.cardInnerPadding=X,this.titleHeight=q,this.rankTitleHeight=Y,this.rowHeight=W,this.btnHeightVal=E,this.rankToBtnGap=ne}createTitle(){const _=new Text$1("GAME OVER",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:96,fill:2236962,align:"center"});_.anchor.set(.5,0),_.x=0,_.y=this.cardInnerPadding,this.content.addChild(_);const T=new Text$1("",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:48,fill:6710886,align:"center"});T.anchor.set(.5,0),T.x=0,T.y=_.y+this.titleHeight+32,this.content.addChild(T),this.rankTitle=T}createRankList(){let _=this.rankList.slice();const T=GameApp$1.instance.playerRank;!_.some(Y=>Y.name===T.name)&&T.value>0&&_.push({name:T.name,value:T.value}),_.sort((Y,te)=>te.value-Y.value);const W=-180,X=0,q=180;_.forEach((Y,te)=>{const ne=Y.name===T.name,ae=new Text$1(`${te+1}`,{fontFamily:"Arial Black, Arial, sans-serif",fontSize:44,fill:ne?16737792:3355443,align:"center"});ae.anchor.set(.5,0),ae.x=W,ae.y=this.rankTitle.y+this.rankTitleHeight+32+te*this.rowHeight,this.content.addChild(ae);const le=new Text$1(Y.name,{fontFamily:"Arial Black, Arial, sans-serif",fontSize:44,fill:ne?16737792:3355443,align:"center"});le.anchor.set(.5,0),le.x=X,le.y=this.rankTitle.y+this.rankTitleHeight+32+te*this.rowHeight,this.content.addChild(le);const ue=new Text$1(`${Y.value}`,{fontFamily:"Arial Black, Arial, sans-serif",fontSize:44,fill:ne?16737792:3355443,align:"center"});ue.anchor.set(.5,0),ue.x=q,ue.y=this.rankTitle.y+this.rankTitleHeight+32+te*this.rowHeight,this.content.addChild(ue)})}createRestartButton(){const T=this.rankList.length>0?this.rankList.length*this.rowHeight:this.rowHeight,E=this.rankTitle.y+this.rankTitleHeight+32+T+this.rankToBtnGap,W=new Graphics;W.beginFill(2985200,1),W.drawRoundedRect(-360/2,-this.btnHeightVal/2,360,this.btnHeightVal,36),W.endFill(),W.x=0,W.y=E+this.btnHeightVal/2,this.content.addChild(W);const X=new Text$1("",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:56,fill:16777215,align:"center"});X.anchor.set(.5),X.x=0,X.y=0,W.addChild(X),makeButton(W,async()=>{await disappear(this),typeof this.onRestart=="function"&&this.onRestart(),this.removeFromParent()})}setupAnimations(){appear(this)}}class StartScreen extends Container{constructor({onStart:_=null}={}){super(),this.eventMode="static",this.onStart=_,this.counter=2,this.maxCounter=128,this.root=new Container,this.root.scale.set(.5),this.addChild(this.root),this.createCard(),this.createTitle(),this.createCounterButton(),this.createStartButton(),appear(this)}createCard(){const E=new Graphics;E.beginFill(16185078,.98),E.drawRoundedRect(-800/2,-800/2,800,800,32),E.endFill(),E.x=0,E.y=0,this.root.addChild(E),this.cardHeight=800}createTitle(){const _=new Text$1("2048 ",{fontFamily:"Arial",fontSize:120,fontWeight:"bold",fill:16777215,align:"center",dropShadow:!0,dropShadowColor:"#333",dropShadowBlur:8,dropShadowDistance:4});_.anchor.set(.5,0),_.x=0,_.y=-this.cardHeight/2+60,this.root.addChild(_)}createCounterButton(){const E=new Graphics;E.beginFill(16769126,1),E.drawRoundedRect(-240/2,-100/2,240,100,24),E.endFill(),E.x=-80,E.y=0,E.eventMode="static",E.cursor="pointer",E.hitArea=new Rectangle(-240/2-20,-100/2-20,280,140),this.root.addChild(E);const W=new Text$1("",{fontFamily:"Arial",fontSize:40,fill:3355443,fontWeight:"bold",align:"center"});W.anchor.set(.5,.5),W.x=0,W.y=0,E.addChild(W),this.counterText=new Text$1(this.counter.toString(),{fontFamily:"Arial",fontSize:48,fill:16769126,fontWeight:"bold",align:"center",dropShadow:!0,dropShadowColor:"#000",dropShadowBlur:6,dropShadowDistance:2}),this.counterText.anchor.set(.5,.5),this.counterText.x=E.x+240/2+40,this.counterText.y=E.y,this.root.addChild(this.counterText),makeButton(E,()=>{this.counter<this.maxCounter&&(this.counter*=2,this.counterText.text=this.counter.toString(),scaleOnce(this.counterText))})}createStartButton(){const E=new Graphics;E.beginFill(16735838,1),E.drawRoundedRect(-420/2,0,420,120,40),E.endFill(),E.x=0,E.y=this.cardHeight/2-120-60,E.eventMode="static",E.cursor="pointer",this.root.addChild(E);const W=new Text$1("",{fontFamily:"Arial",fontSize:64,fill:16777215,fontWeight:"bold",align:"center"});W.anchor.set(.5,.5),W.x=0,W.y=120/2,E.addChild(W),makeButton(E,async()=>{await disappear(this),this.removeFromParent(),this.onStart&&this.onStart(this.counter)})}}class SpeedBoostUI extends Container{constructor(){super(),this.progress=0,this.isActive=!1,this.timer=null,this.playerSnake=null,this.initUI(),this.init(),this.checkPlayerSnake()}init(){this.startTimer()}initUI(){this.labelText=new Text$1("",{fontFamily:"Arial Black, Arial, sans-serif",fontSize:32,fill:16777215,stroke:0,strokeThickness:4,align:"left"}),this.labelText.anchor.set(0,.5),this.labelText.x=0,this.labelText.y=0,this.addChild(this.labelText),this.progressBarBg=new Graphics,this.progressBarBg.beginFill(3355443),this.progressBarBg.drawRoundedRect(0,0,300,30,15),this.progressBarBg.endFill(),this.progressBarBg.x=this.labelText.width+15,this.progressBarBg.y=-15,this.addChild(this.progressBarBg),this.progressBarFill=new Graphics,this.progressBarFill.beginFill(65280),this.progressBarFill.drawRoundedRect(0,0,0,30,15),this.progressBarFill.endFill(),this.progressBarFill.x=this.labelText.width+15,this.progressBarFill.y=-15,this.addChild(this.progressBarFill),this.progressBarBorder=new Graphics,this.progressBarBorder.lineStyle(3,16777215),this.progressBarBorder.drawRoundedRect(0,0,300,30,15),this.progressBarBorder.x=this.labelText.width+15,this.progressBarBorder.y=-15,this.addChild(this.progressBarBorder)}updateProgressBar(){this.progressBarFill.clear(),this.isActive?(this.progressBarFill.beginFill(65280),this.labelText.text=""):(this.progressBarFill.beginFill(35071),this.labelText.text="");const _=this.progress/100*300;this.progressBarFill.drawRoundedRect(0,0,_,30,15),this.progressBarFill.endFill(),this.updateProgressBarPosition()}updateProgressBarPosition(){const _=this.labelText.width+15;this.progressBarBg.x=_,this.progressBarFill.x=_,this.progressBarBorder.x=_}getSize(){return{width:(this.labelText?this.labelText.width:0)+15+300,height:30}}checkPlayerSnake(){const _=setInterval(()=>{const T=GameApp$1.instance;T&&T.playerSnake&&T.playerSnake!==this.playerSnake&&(this.playerSnake=T.playerSnake)},1e3);this.checkInterval=_}startTimer(){this.timer=setInterval(()=>{const _=GameApp$1.instance;!_||_.gameState!=="playing"||(this.isActive?(this.progress-=2,this.updateProgressBar(),this.progress<=0&&this.deactivateSpeedBoost()):(this.progress+=1,this.updateProgressBar(),this.progress>=100&&this.activateSpeedBoost()))},100)}activateSpeedBoost(){this.isActive=!0,this.progress=100,this.playerSnake&&(this.playerSnake.speedRatio=2),this.updateProgressBar()}deactivateSpeedBoost(){this.playerSnake&&(this.playerSnake.speedRatio=1),this.isActive=!1,this.progress=0,this.updateProgressBar()}destroy(){this.timer&&(clearInterval(this.timer),this.timer=null),this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),super.destroy()}}const _hoisted_1$4={class:"game-container"},_sfc_main$4={__name:"Game2048",setup(B){const _=ref$1(null),T=GameApp$1.instance;let E=[],W=null;const X=["game2048/star_small.png","game2048/ship_E.png"],q=async $e=>{console.log(""),initDom(_.value,{designWidth:540,designHeight:960,isFullScreen:!0}),T.init(_.value),xe(),Y("init")};onUnmounted(()=>{le(),T.destroy()});function Y($e,We=2){T.gameState!==$e&&(T.gameState=$e,$e==="init"?te():$e==="playing"?ae(We):$e==="fail"&&setTimeout(ge,500))}function te(){T.addUI(new StartScreen({onStart:ne}))}function ne($e){Y("playing",$e)}function ae($e=2){le(),Te($e),Ie(),E.push(setInterval(Ie,5e3)),Ae(),E.push(setInterval(Ae,5e3)),W=new SpeedBoostUI,W.x=-W.getSize().width/2,W.y=T.pixi.screen.height/2-100,T.addUI(W),T.pixi.ticker.add(checkSnakeCollisions),T.pixi.ticker.add(ue),T.pixi.ticker.add(ye),window.addEventListener("keydown",Ve)}function le(){window.removeEventListener("keydown",Ve);for(const $e of E)clearInterval($e);E=[],W&&(W.destroy(),W=null),T.pixi.ticker.remove(checkSnakeCollisions),T.pixi.ticker.remove(ue),T.pixi.ticker.remove(ye),T.clearAllGameObjects(),T.clearUI()}function ue(){(!T.playerSnake||!T.playerSnake.cubes||T.playerSnake.cubes.length===0)&&Y("fail")}function ge(){T.addUI(new FailScreen({onRestart:()=>{le(),Y("init")}}))}function ye($e){if(T.playerSnake&&T.playerSnake.head){const We=T.playerSnake.head,Ue=T.gameContainer,je=T.pixi.screen.width/2,ze=T.pixi.screen.height/2,He=We.x,Le=We.y;Ue.position.set(je-He,ze-Le)}}function xe(){const $e=new BgCircle;$e.init(),T.addGameObject($e,GameLayer.BgLayer)}function Te($e=2){T.playerSnake&&(T.gameContainer.removeChild(T.playerSnake),typeof T.playerSnake.destroy=="function"&&T.playerSnake.destroy());const We=new PlayerSnake;We.addCube($e),T.addGameObject(We,GameLayer.PlayerSnake)}function Ae(){var We,Ue,je,ze,He,Le;if(T.enemySnakes.length<5){const Qe=(((Ue=(We=T.playerSnake)==null?void 0:We.head)==null?void 0:Ue.value)||2)*2,Ke=new EnermySnake;Ke.addCubes([Qe]);let Je=((ze=(je=T.playerSnake)==null?void 0:je.head)==null?void 0:ze.x)||0,pt=((Le=(He=T.playerSnake)==null?void 0:He.head)==null?void 0:Le.y)||0,ut=0,lt=0;const st=T.radius*.6;for(let sr=0;sr<10;sr++){ut=Math.random()*(T.radius*2)-T.radius,lt=Math.random()*(T.radius*2)-T.radius;const mt=ut-Je,Tr=lt-pt;if(Math.sqrt(mt*mt+Tr*Tr)>=st)break}Ke.setPosition(ut,lt),T.addGameObject(Ke,GameLayer.EnermySnake)}}function Ie(){for(;T.looseCubes.length<10;){const We=Math.random()<.8?2:4,Ue=new Cube(We),je=T.radius*.5,ze=Math.sqrt(Math.random()*(T.radius*T.radius-je*je)+je*je),He=Math.random()*Math.PI*2;Ue.x=Math.cos(He)*ze,Ue.y=Math.sin(He)*ze,Ue.rotation=Math.random()*Math.PI*2,T.addGameObject(Ue,GameLayer.LooseCube)}}function Ve($e){if($e.key==="f"){T.playerSnake.addCube(2);return}}return($e,We)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("canvas",{ref_key:"pixiContainer",ref:_},null,512),createVNode(PixiLoader,{textureUrls:X,onLoaded:q})]))}},_withScopeId=B=>(pushScopeId("data-v-455ca2b1"),B=B(),popScopeId(),B),_hoisted_1$3={class:"split-image-container"},_hoisted_2$1=_withScopeId(()=>createBaseVNode("h1",null,"",-1)),_hoisted_3$1=_withScopeId(()=>createBaseVNode("p",null,"plistpngpng",-1)),_hoisted_4$1={key:0},_sfc_main$3={__name:"SplitImage",setup(B){let _=ref$1(!1),T=null,E="",W=[],X=null,q=null,Y=null;async function te(){window.cv||await new Promise(xe=>{const Te=document.createElement("script");Te.src="https://cdn.jsdelivr.net/npm/opencv.js",Te.async=!0,Te.onload=()=>xe(),document.body.appendChild(Te)}),window.JSZip||await new Promise(xe=>{const Te=document.createElement("script");Te.src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js",Te.onload=()=>xe(),document.body.appendChild(Te)}),q=window.cv,Y=window.JSZip}function ne(){T&&(T.delete(),T=null),W=[],E=""}function ae(xe){function Te(Ie){const Ve=xe[Ie];for(let $e=0;$e<xe.length;++$e){if(Ie===$e)continue;const We=xe[$e];if(Ve.x>=We.x&&Ve.y>=We.y&&Ve.x+Ve.width<=We.x+We.width&&Ve.y+Ve.height<=We.y+We.height)return!0}return!1}const Ae=[];for(let Ie=0;Ie<xe.length;++Ie){const Ve=xe[Ie];Te(Ie)||Ve.width<3&&Ve.height<3||Ae.push(xe[Ie])}return Ae}function le(xe){ne(),X&&xe?(X.width=xe.width,X.height=xe.height):console.warn("canvas  eleSrc ");const Te=q.imread(xe);T=Te.clone();const Ae=new q.MatVector;q.split(Te,Ae);const Ie=Ae.get(3),Ve=new q.Mat;q.threshold(Ie,Ve,10,255,q.THRESH_BINARY);const $e=new q.MatVector,We=new q.Mat;q.findContours(Ve,$e,We,q.RETR_CCOMP,q.CHAIN_APPROX_SIMPLE);const Ue=new q.Scalar(255,0,0,255);q.copyMakeBorder(Te,Te,1,1,1,1,q.BORDER_CONSTANT,Ue);let je=[];for(let ze=0;ze<$e.size();++ze){let He=q.boundingRect($e.get(ze));je.push(He)}W=ae(je);for(let ze=0;ze<W.length;++ze){let He=W[ze],Le=new q.Point(He.x,He.y),qe=new q.Point(He.x+He.width,He.y+He.height);q.rectangle(Te,Le,qe,new q.Scalar(0,255,0,255),1)}E=`${W.length}`,q.imshow(X,Te),Te.delete(),Ae.delete(),Ve.delete(),$e.delete(),We.delete()}function ue(xe){if(!xe)return;const Te=new FileReader;Te.readAsDataURL(xe),Te.onloadend=function(){const Ae=new window.Image;Ae.src=this.result,Ae.onload=function(){le(Ae)}}}function ge(xe){return ue(xe),!1}function ye(){if(!T||!W.length)return;const xe=new Y;let Te=0;for(let Ae=0;Ae<W.length;++Ae){const Ie=W[Ae],Ve={x:Ie.x,y:Ie.y,width:Ie.width,height:Ie.height},$e=T.roi(Ve),We=`image${Ae+1}`,Ue=document.createElement("canvas");Ue.width=Ie.width,Ue.height=Ie.height,q.imshow(Ue,$e),Ue.toBlob(function(je){xe.file(We+".png",je),Te++,Te===W.length&&xe.generateAsync({type:"blob"}).then(function(ze){const He=document.createElement("a");He.href=URL.createObjectURL(ze),He.download="images.zip",He.click()})}),$e.delete()}}return onMounted(async()=>{await te(),X=document.getElementById("mycanvas"),window.cv&&window.cv.onRuntimeInitialized?window.cv.onRuntimeInitialized=()=>{_.value=!0,E=""}:_.value=!0,X&&(X.width=512,X.height=512)}),(xe,Te)=>{const Ae=resolveComponent("Upload"),Ie=resolveComponent("Button"),Ve=resolveComponent("Col"),$e=resolveComponent("Row");return openBlock(),createElementBlock("div",_hoisted_1$3,[_hoisted_2$1,_hoisted_3$1,createVNode($e,null,{default:withCtx(()=>[createVNode(Ve,null,{default:withCtx(()=>[createVNode(Ae,{"before-upload":ge,"show-upload-list":!1,disabled:!unref(_),accept:"image/*",action:""},{default:withCtx(()=>[createVNode(unref(viewuiplus_minExports.Button),{type:"primary",disabled:!unref(_)},{default:withCtx(()=>[createTextVNode("")]),_:1},8,["disabled"])]),_:1},8,["disabled"]),createVNode(Ie,{type:"success",onClick:ye,disabled:!unref(_)},{default:withCtx(()=>[createTextVNode("  ")]),_:1},8,["disabled"])]),_:1})]),_:1}),createBaseVNode("p",null,toDisplayString(unref(E)),1),createBaseVNode("div",null,[unref(_)?createCommentVNode("",!0):(openBlock(),createElementBlock("p",_hoisted_4$1,"...(20)")),createBaseVNode("canvas",{ref_key:"canvas",ref:X,id:"mycanvas"},null,512)])])}}},SplitImage=_export_sfc(_sfc_main$3,[["__scopeId","data-v-455ca2b1"]]);/**
 * Planck.js v1.3.0
 * @license The MIT license
 * @copyright Copyright (c) 2024 Erin Catto, Ali Shakiba
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(B,_){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,E){T.__proto__=E}||function(T,E){for(var W in E)Object.prototype.hasOwnProperty.call(E,W)&&(T[W]=E[W])},extendStatics(B,_)};function __extends(B,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");extendStatics(B,_);function T(){this.constructor=B}B.prototype=_===null?Object.create(_):(T.prototype=_.prototype,new T)}var __assign=function(){return __assign=Object.assign||function(_){for(var T,E=1,W=arguments.length;E<W;E++){T=arguments[E];for(var X in T)Object.prototype.hasOwnProperty.call(T,X)&&(_[X]=T[X])}return _},__assign.apply(this,arguments)},options=function(B,_){(B===null||typeof B>"u")&&(B={});var T=__assign({},B);for(var E in _)_.hasOwnProperty(E)&&typeof B[E]>"u"&&(T[E]=_[E]);if(typeof Object.getOwnPropertySymbols=="function")for(var W=Object.getOwnPropertySymbols(_),X=0;X<W.length;X++){var q=W[X];_.propertyIsEnumerable(q)&&typeof B[q]>"u"&&(T[q]=_[q])}return T},math_random=Math.random,EPSILON=1e-9,isFinite$1=Number.isFinite;function nextPowerOfTwo(B){return B|=B>>1,B|=B>>2,B|=B>>4,B|=B>>8,B|=B>>16,B+1}function isPowerOfTwo(B){return B>0&&(B&B-1)===0}function mod(B,_,T){return typeof _>"u"?(T=1,_=0):typeof T>"u"&&(T=_,_=0),T>_?(B=(B-_)%(T-_),B+(B<0?T:_)):(B=(B-T)%(_-T),B+(B<=0?_:T))}function clamp(B,_,T){return B<_?_:B>T?T:B}function random(B,_){return typeof B>"u"?(_=1,B=0):typeof _>"u"&&(_=B,B=0),B===_?B:math_random()*(_-B)+B}var math=Object.create(Math);math.EPSILON=EPSILON;math.isFinite=isFinite$1;math.nextPowerOfTwo=nextPowerOfTwo;math.isPowerOfTwo=isPowerOfTwo;math.mod=mod;math.clamp=clamp;math.random=random;var math_abs$9=Math.abs,math_sqrt$5=Math.sqrt,math_max$8=Math.max,math_min$8=Math.min,Vec2=function(){function B(_,T){if(!(this instanceof B))return new B(_,T);typeof _>"u"?(this.x=0,this.y=0):typeof _=="object"?(this.x=_.x,this.y=_.y):(this.x=_,this.y=T)}return B.prototype._serialize=function(){return{x:this.x,y:this.y}},B._deserialize=function(_){var T=Object.create(B.prototype);return T.x=_.x,T.y=_.y,T},B.zero=function(){var _=Object.create(B.prototype);return _.x=0,_.y=0,_},B.neo=function(_,T){var E=Object.create(B.prototype);return E.x=_,E.y=T,E},B.clone=function(_){return B.neo(_.x,_.y)},B.prototype.toString=function(){return JSON.stringify(this)},B.isValid=function(_){return _===null||typeof _>"u"?!1:Number.isFinite(_.x)&&Number.isFinite(_.y)},B.assert=function(_){},B.prototype.clone=function(){return B.clone(this)},B.prototype.setZero=function(){return this.x=0,this.y=0,this},B.prototype.set=function(_,T){return typeof _=="object"?(this.x=_.x,this.y=_.y):(this.x=_,this.y=T),this},B.prototype.setNum=function(_,T){return this.x=_,this.y=T,this},B.prototype.setVec2=function(_){return this.x=_.x,this.y=_.y,this},B.prototype.wSet=function(_,T,E,W){return typeof E<"u"||typeof W<"u"?this.setCombine(_,T,E,W):this.setMul(_,T)},B.prototype.setCombine=function(_,T,E,W){var X=_*T.x+E*W.x,q=_*T.y+E*W.y;return this.x=X,this.y=q,this},B.prototype.setMul=function(_,T){var E=_*T.x,W=_*T.y;return this.x=E,this.y=W,this},B.prototype.add=function(_){return this.x+=_.x,this.y+=_.y,this},B.prototype.wAdd=function(_,T,E,W){return typeof E<"u"||typeof W<"u"?this.addCombine(_,T,E,W):this.addMul(_,T)},B.prototype.addCombine=function(_,T,E,W){var X=_*T.x+E*W.x,q=_*T.y+E*W.y;return this.x+=X,this.y+=q,this},B.prototype.addMul=function(_,T){var E=_*T.x,W=_*T.y;return this.x+=E,this.y+=W,this},B.prototype.wSub=function(_,T,E,W){return typeof E<"u"||typeof W<"u"?this.subCombine(_,T,E,W):this.subMul(_,T)},B.prototype.subCombine=function(_,T,E,W){var X=_*T.x+E*W.x,q=_*T.y+E*W.y;return this.x-=X,this.y-=q,this},B.prototype.subMul=function(_,T){var E=_*T.x,W=_*T.y;return this.x-=E,this.y-=W,this},B.prototype.sub=function(_){return this.x-=_.x,this.y-=_.y,this},B.prototype.mul=function(_){return this.x*=_,this.y*=_,this},B.prototype.length=function(){return B.lengthOf(this)},B.prototype.lengthSquared=function(){return B.lengthSquared(this)},B.prototype.normalize=function(){var _=this.length();if(_<EPSILON)return 0;var T=1/_;return this.x*=T,this.y*=T,_},B.normalize=function(_){var T=B.lengthOf(_);if(T<EPSILON)return B.zero();var E=1/T;return B.neo(_.x*E,_.y*E)},B.lengthOf=function(_){return math_sqrt$5(_.x*_.x+_.y*_.y)},B.lengthSquared=function(_){return _.x*_.x+_.y*_.y},B.distance=function(_,T){var E=_.x-T.x,W=_.y-T.y;return math_sqrt$5(E*E+W*W)},B.distanceSquared=function(_,T){var E=_.x-T.x,W=_.y-T.y;return E*E+W*W},B.areEqual=function(_,T){return _===T||typeof T=="object"&&T!==null&&_.x===T.x&&_.y===T.y},B.skew=function(_){return B.neo(-_.y,_.x)},B.dot=function(_,T){return _.x*T.x+_.y*T.y},B.cross=function(_,T){return typeof T=="number"?B.neo(T*_.y,-T*_.x):typeof _=="number"?B.neo(-_*T.y,_*T.x):_.x*T.y-_.y*T.x},B.crossVec2Vec2=function(_,T){return _.x*T.y-_.y*T.x},B.crossVec2Num=function(_,T){return B.neo(T*_.y,-T*_.x)},B.crossNumVec2=function(_,T){return B.neo(-_*T.y,_*T.x)},B.addCross=function(_,T,E){if(typeof E=="number")return B.neo(E*T.y+_.x,-E*T.x+_.y);if(typeof T=="number")return B.neo(-T*E.y+_.x,T*E.x+_.y)},B.addCrossVec2Num=function(_,T,E){return B.neo(E*T.y+_.x,-E*T.x+_.y)},B.addCrossNumVec2=function(_,T,E){return B.neo(-T*E.y+_.x,T*E.x+_.y)},B.add=function(_,T){return B.neo(_.x+T.x,_.y+T.y)},B.wAdd=function(_,T,E,W){return typeof E<"u"||typeof W<"u"?B.combine(_,T,E,W):B.mulNumVec2(_,T)},B.combine=function(_,T,E,W){return B.zero().setCombine(_,T,E,W)},B.sub=function(_,T){return B.neo(_.x-T.x,_.y-T.y)},B.mul=function(_,T){if(typeof _=="object")return B.neo(_.x*T,_.y*T);if(typeof T=="object")return B.neo(_*T.x,_*T.y)},B.mulVec2Num=function(_,T){return B.neo(_.x*T,_.y*T)},B.mulNumVec2=function(_,T){return B.neo(_*T.x,_*T.y)},B.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},B.neg=function(_){return B.neo(-_.x,-_.y)},B.abs=function(_){return B.neo(math_abs$9(_.x),math_abs$9(_.y))},B.mid=function(_,T){return B.neo((_.x+T.x)*.5,(_.y+T.y)*.5)},B.upper=function(_,T){return B.neo(math_max$8(_.x,T.x),math_max$8(_.y,T.y))},B.lower=function(_,T){return B.neo(math_min$8(_.x,T.x),math_min$8(_.y,T.y))},B.prototype.clamp=function(_){var T=this.x*this.x+this.y*this.y;if(T>_*_){var E=_/math_sqrt$5(T);this.x*=E,this.y*=E}return this},B.clamp=function(_,T){var E=B.neo(_.x,_.y);return E.clamp(T),E},B.clampVec2=function(_,T,E){return{x:clamp(_.x,T==null?void 0:T.x,E==null?void 0:E.x),y:clamp(_.y,T==null?void 0:T.y,E==null?void 0:E.y)}},B.scaleFn=function(_,T){return function(E){return B.neo(E.x*_,E.y*T)}},B.translateFn=function(_,T){return function(E){return B.neo(E.x+_,E.y+T)}},B}(),math_max$7=Math.max,math_min$7=Math.min,AABB=function(){function B(_,T){if(!(this instanceof B))return new B(_,T);this.lowerBound=Vec2.zero(),this.upperBound=Vec2.zero(),typeof _=="object"&&this.lowerBound.setVec2(_),typeof T=="object"?this.upperBound.setVec2(T):typeof _=="object"&&this.upperBound.setVec2(_)}return B.prototype.isValid=function(){return B.isValid(this)},B.isValid=function(_){return _===null||typeof _>"u"?!1:Vec2.isValid(_.lowerBound)&&Vec2.isValid(_.upperBound)&&Vec2.sub(_.upperBound,_.lowerBound).lengthSquared()>=0},B.assert=function(_){},B.prototype.getCenter=function(){return Vec2.neo((this.lowerBound.x+this.upperBound.x)*.5,(this.lowerBound.y+this.upperBound.y)*.5)},B.prototype.getExtents=function(){return Vec2.neo((this.upperBound.x-this.lowerBound.x)*.5,(this.upperBound.y-this.lowerBound.y)*.5)},B.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},B.prototype.combine=function(_,T){T=T||this;var E=_.lowerBound,W=_.upperBound,X=T.lowerBound,q=T.upperBound,Y=math_min$7(E.x,X.x),te=math_min$7(E.y,X.y),ne=math_max$7(q.x,W.x),ae=math_max$7(q.y,W.y);this.lowerBound.setNum(Y,te),this.upperBound.setNum(ne,ae)},B.prototype.combinePoints=function(_,T){this.lowerBound.setNum(math_min$7(_.x,T.x),math_min$7(_.y,T.y)),this.upperBound.setNum(math_max$7(_.x,T.x),math_max$7(_.y,T.y))},B.prototype.set=function(_){this.lowerBound.setNum(_.lowerBound.x,_.lowerBound.y),this.upperBound.setNum(_.upperBound.x,_.upperBound.y)},B.prototype.contains=function(_){var T=!0;return T=T&&this.lowerBound.x<=_.lowerBound.x,T=T&&this.lowerBound.y<=_.lowerBound.y,T=T&&_.upperBound.x<=this.upperBound.x,T=T&&_.upperBound.y<=this.upperBound.y,T},B.prototype.extend=function(_){return B.extend(this,_),this},B.extend=function(_,T){return _.lowerBound.x-=T,_.lowerBound.y-=T,_.upperBound.x+=T,_.upperBound.y+=T,_},B.testOverlap=function(_,T){var E=T.lowerBound.x-_.upperBound.x,W=_.lowerBound.x-T.upperBound.x,X=T.lowerBound.y-_.upperBound.y,q=_.lowerBound.y-T.upperBound.y;return!(E>0||X>0||W>0||q>0)},B.areEqual=function(_,T){return Vec2.areEqual(_.lowerBound,T.lowerBound)&&Vec2.areEqual(_.upperBound,T.upperBound)},B.diff=function(_,T){var E=math_max$7(0,math_min$7(_.upperBound.x,T.upperBound.x)-math_max$7(T.lowerBound.x,_.lowerBound.x)),W=math_max$7(0,math_min$7(_.upperBound.y,T.upperBound.y)-math_max$7(T.lowerBound.y,_.lowerBound.y)),X=_.upperBound.x-_.lowerBound.x,q=_.upperBound.y-_.lowerBound.y,Y=T.upperBound.x-T.lowerBound.x,te=T.upperBound.y-T.lowerBound.y;return X*q+Y*te-E*W},B.prototype.rayCast=function(_,T){for(var E=-1/0,W=1/0,X=T.p1,q=Vec2.sub(T.p2,T.p1),Y=Vec2.abs(q),te=Vec2.zero(),ne="x";ne!==null;ne=ne==="x"?"y":null)if(Y.x<EPSILON){if(X[ne]<this.lowerBound[ne]||this.upperBound[ne]<X[ne])return!1}else{var ae=1/q[ne],le=(this.lowerBound[ne]-X[ne])*ae,ue=(this.upperBound[ne]-X[ne])*ae,ge=-1;if(le>ue){var ye=le;le=ue,ue=ye,ge=1}if(le>E&&(te.setZero(),te[ne]=ge,E=le),W=math_min$7(W,ue),E>W)return!1}return E<0||T.maxFraction<E?!1:(_.fraction=E,_.normal=te,!0)},B.prototype.toString=function(){return JSON.stringify(this)},B.combinePoints=function(_,T,E){return _.lowerBound.x=math_min$7(T.x,E.x),_.lowerBound.y=math_min$7(T.y,E.y),_.upperBound.x=math_max$7(T.x,E.x),_.upperBound.y=math_max$7(T.y,E.y),_},B.combinedPerimeter=function(_,T){var E=math_min$7(_.lowerBound.x,T.lowerBound.x),W=math_min$7(_.lowerBound.y,T.lowerBound.y),X=math_max$7(_.upperBound.x,T.upperBound.x),q=math_max$7(_.upperBound.y,T.upperBound.y);return 2*(X-E+q-W)},B}(),math_PI$6=Math.PI,Settings=function(){function B(){}return Object.defineProperty(B,"polygonRadius",{get:function(){return 2*B.linearSlop},enumerable:!1,configurable:!0}),B.lengthUnitsPerMeter=1,B.maxManifoldPoints=2,B.maxPolygonVertices=12,B.aabbExtension=.1,B.aabbMultiplier=2,B.linearSlop=.005,B.angularSlop=2/180*math_PI$6,B.maxSubSteps=8,B.maxTOIContacts=32,B.maxTOIIterations=20,B.maxDistanceIterations=20,B.velocityThreshold=1,B.maxLinearCorrection=.2,B.maxAngularCorrection=8/180*math_PI$6,B.maxTranslation=2,B.maxRotation=.5*math_PI$6,B.baumgarte=.2,B.toiBaugarte=.75,B.timeToSleep=.5,B.linearSleepTolerance=.01,B.angularSleepTolerance=2/180*math_PI$6,B}(),SettingsInternal=function(){function B(){}return Object.defineProperty(B,"maxManifoldPoints",{get:function(){return Settings.maxManifoldPoints},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxPolygonVertices",{get:function(){return Settings.maxPolygonVertices},enumerable:!1,configurable:!0}),Object.defineProperty(B,"aabbExtension",{get:function(){return Settings.aabbExtension*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"aabbMultiplier",{get:function(){return Settings.aabbMultiplier},enumerable:!1,configurable:!0}),Object.defineProperty(B,"linearSlop",{get:function(){return Settings.linearSlop*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"linearSlopSquared",{get:function(){return Settings.linearSlop*Settings.lengthUnitsPerMeter*Settings.linearSlop*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"angularSlop",{get:function(){return Settings.angularSlop},enumerable:!1,configurable:!0}),Object.defineProperty(B,"polygonRadius",{get:function(){return 2*Settings.linearSlop},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxSubSteps",{get:function(){return Settings.maxSubSteps},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxTOIContacts",{get:function(){return Settings.maxTOIContacts},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxTOIIterations",{get:function(){return Settings.maxTOIIterations},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxDistanceIterations",{get:function(){return Settings.maxDistanceIterations},enumerable:!1,configurable:!0}),Object.defineProperty(B,"velocityThreshold",{get:function(){return Settings.velocityThreshold*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxLinearCorrection",{get:function(){return Settings.maxLinearCorrection*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxAngularCorrection",{get:function(){return Settings.maxAngularCorrection},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxTranslation",{get:function(){return Settings.maxTranslation*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxTranslationSquared",{get:function(){return Settings.maxTranslation*Settings.lengthUnitsPerMeter*Settings.maxTranslation*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxRotation",{get:function(){return Settings.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(B,"maxRotationSquared",{get:function(){return Settings.maxRotation*Settings.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(B,"baumgarte",{get:function(){return Settings.baumgarte},enumerable:!1,configurable:!0}),Object.defineProperty(B,"toiBaugarte",{get:function(){return Settings.toiBaugarte},enumerable:!1,configurable:!0}),Object.defineProperty(B,"timeToSleep",{get:function(){return Settings.timeToSleep},enumerable:!1,configurable:!0}),Object.defineProperty(B,"linearSleepTolerance",{get:function(){return Settings.linearSleepTolerance*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"linearSleepToleranceSqr",{get:function(){return Settings.linearSleepTolerance*Settings.lengthUnitsPerMeter*Settings.linearSleepTolerance*Settings.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(B,"angularSleepTolerance",{get:function(){return Settings.angularSleepTolerance},enumerable:!1,configurable:!0}),Object.defineProperty(B,"angularSleepToleranceSqr",{get:function(){return Settings.angularSleepTolerance*Settings.angularSleepTolerance},enumerable:!1,configurable:!0}),B}(),Pool=function(){function B(_){this._list=[],this._max=1/0,this._hasCreateFn=!1,this._createCount=0,this._hasAllocateFn=!1,this._allocateCount=0,this._hasReleaseFn=!1,this._releaseCount=0,this._hasDisposeFn=!1,this._disposeCount=0,this._list=[],this._max=_.max||this._max,this._createFn=_.create,this._hasCreateFn=typeof this._createFn=="function",this._allocateFn=_.allocate,this._hasAllocateFn=typeof this._allocateFn=="function",this._releaseFn=_.release,this._hasReleaseFn=typeof this._releaseFn=="function",this._disposeFn=_.dispose,this._hasDisposeFn=typeof this._disposeFn=="function"}return B.prototype.max=function(_){return typeof _=="number"?(this._max=_,this):this._max},B.prototype.size=function(){return this._list.length},B.prototype.allocate=function(){var _;return this._list.length>0?_=this._list.shift():(this._createCount++,this._hasCreateFn?_=this._createFn():_={}),this._allocateCount++,this._hasAllocateFn&&this._allocateFn(_),_},B.prototype.release=function(_){this._list.length<this._max?(this._releaseCount++,this._hasReleaseFn&&this._releaseFn(_),this._list.push(_)):(this._disposeCount++,this._hasDisposeFn&&(_=this._disposeFn(_)))},B.prototype.toString=function(){return" +"+this._createCount+" >"+this._allocateCount+" <"+this._releaseCount+" -"+this._disposeCount+" ="+this._list.length+"/"+this._max},B}(),math_abs$8=Math.abs,math_max$6=Math.max,TreeNode=function(){function B(_){this.aabb=new AABB,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.id=_}return B.prototype.toString=function(){return this.id+": "+this.userData},B.prototype.isLeaf=function(){return this.child1==null},B}(),poolTreeNode=new Pool({create:function(){return new TreeNode},release:function(B){B.userData=null,B.parent=null,B.child1=null,B.child2=null,B.height=-1,B.id=void 0}}),DynamicTree=function(){function B(){this.inputPool=new Pool({create:function(){return{}},release:function(_){}}),this.stackPool=new Pool({create:function(){return[]},release:function(_){_.length=0}}),this.iteratorPool=new Pool({create:function(){return new Iterator},release:function(_){_.close()}}),this.m_root=null,this.m_nodes={},this.m_lastProxyId=0}return B.prototype.getUserData=function(_){var T=this.m_nodes[_];return T.userData},B.prototype.getFatAABB=function(_){var T=this.m_nodes[_];return T.aabb},B.prototype.allocateNode=function(){var _=poolTreeNode.allocate();return _.id=++this.m_lastProxyId,this.m_nodes[_.id]=_,_},B.prototype.freeNode=function(_){delete this.m_nodes[_.id],poolTreeNode.release(_)},B.prototype.createProxy=function(_,T){var E=this.allocateNode();return E.aabb.set(_),AABB.extend(E.aabb,SettingsInternal.aabbExtension),E.userData=T,E.height=0,this.insertLeaf(E),E.id},B.prototype.destroyProxy=function(_){var T=this.m_nodes[_];this.removeLeaf(T),this.freeNode(T)},B.prototype.moveProxy=function(_,T,E){var W=this.m_nodes[_];return W.aabb.contains(T)?!1:(this.removeLeaf(W),W.aabb.set(T),T=W.aabb,AABB.extend(T,SettingsInternal.aabbExtension),E.x<0?T.lowerBound.x+=E.x*SettingsInternal.aabbMultiplier:T.upperBound.x+=E.x*SettingsInternal.aabbMultiplier,E.y<0?T.lowerBound.y+=E.y*SettingsInternal.aabbMultiplier:T.upperBound.y+=E.y*SettingsInternal.aabbMultiplier,this.insertLeaf(W),!0)},B.prototype.insertLeaf=function(_){if(this.m_root==null){this.m_root=_,this.m_root.parent=null;return}for(var T=_.aabb,E=this.m_root;!E.isLeaf();){var W=E.child1,X=E.child2,q=E.aabb.getPerimeter(),Y=AABB.combinedPerimeter(E.aabb,T),te=2*Y,ne=2*(Y-q),ae=AABB.combinedPerimeter(T,W.aabb),le=ae+ne;if(!W.isLeaf()){var ue=W.aabb.getPerimeter();le-=ue}var ge=AABB.combinedPerimeter(T,X.aabb),ye=ge+ne;if(!X.isLeaf()){var ue=X.aabb.getPerimeter();ye-=ue}if(te<le&&te<ye)break;le<ye?E=W:E=X}var xe=E,Te=xe.parent,Ae=this.allocateNode();for(Ae.parent=Te,Ae.userData=null,Ae.aabb.combine(T,xe.aabb),Ae.height=xe.height+1,Te!=null?(Te.child1===xe?Te.child1=Ae:Te.child2=Ae,Ae.child1=xe,Ae.child2=_,xe.parent=Ae,_.parent=Ae):(Ae.child1=xe,Ae.child2=_,xe.parent=Ae,_.parent=Ae,this.m_root=Ae),E=_.parent;E!=null;){E=this.balance(E);var W=E.child1,X=E.child2;E.height=1+math_max$6(W.height,X.height),E.aabb.combine(W.aabb,X.aabb),E=E.parent}},B.prototype.removeLeaf=function(_){if(_===this.m_root){this.m_root=null;return}var T=_.parent,E=T.parent,W;if(T.child1===_?W=T.child2:W=T.child1,E!=null){E.child1===T?E.child1=W:E.child2=W,W.parent=E,this.freeNode(T);for(var X=E;X!=null;){X=this.balance(X);var q=X.child1,Y=X.child2;X.aabb.combine(q.aabb,Y.aabb),X.height=1+math_max$6(q.height,Y.height),X=X.parent}}else this.m_root=W,W.parent=null,this.freeNode(T)},B.prototype.balance=function(_){var T=_;if(T.isLeaf()||T.height<2)return _;var E=T.child1,W=T.child2,X=W.height-E.height;if(X>1){var q=W.child1,Y=W.child2;return W.child1=T,W.parent=T.parent,T.parent=W,W.parent!=null?W.parent.child1===_?W.parent.child1=W:W.parent.child2=W:this.m_root=W,q.height>Y.height?(W.child2=q,T.child2=Y,Y.parent=T,T.aabb.combine(E.aabb,Y.aabb),W.aabb.combine(T.aabb,q.aabb),T.height=1+math_max$6(E.height,Y.height),W.height=1+math_max$6(T.height,q.height)):(W.child2=Y,T.child2=q,q.parent=T,T.aabb.combine(E.aabb,q.aabb),W.aabb.combine(T.aabb,Y.aabb),T.height=1+math_max$6(E.height,q.height),W.height=1+math_max$6(T.height,Y.height)),W}if(X<-1){var te=E.child1,ne=E.child2;return E.child1=T,E.parent=T.parent,T.parent=E,E.parent!=null?E.parent.child1===T?E.parent.child1=E:E.parent.child2=E:this.m_root=E,te.height>ne.height?(E.child2=te,T.child1=ne,ne.parent=T,T.aabb.combine(W.aabb,ne.aabb),E.aabb.combine(T.aabb,te.aabb),T.height=1+math_max$6(W.height,ne.height),E.height=1+math_max$6(T.height,te.height)):(E.child2=ne,T.child1=te,te.parent=T,T.aabb.combine(W.aabb,te.aabb),E.aabb.combine(T.aabb,ne.aabb),T.height=1+math_max$6(W.height,te.height),E.height=1+math_max$6(T.height,ne.height)),E}return T},B.prototype.getHeight=function(){return this.m_root==null?0:this.m_root.height},B.prototype.getAreaRatio=function(){if(this.m_root==null)return 0;for(var _=this.m_root,T=_.aabb.getPerimeter(),E=0,W,X=this.iteratorPool.allocate().preorder(this.m_root);W=X.next();)W.height<0||(E+=W.aabb.getPerimeter());return this.iteratorPool.release(X),E/T},B.prototype.computeHeight=function(_){var T;if(typeof _<"u"?T=this.m_nodes[_]:T=this.m_root,T.isLeaf())return 0;var E=this.computeHeight(T.child1.id),W=this.computeHeight(T.child2.id);return 1+math_max$6(E,W)},B.prototype.validateStructure=function(_){if(_!=null){this.m_root;var T=_.child1,E=_.child2;_.isLeaf()||(this.validateStructure(T),this.validateStructure(E))}},B.prototype.validateMetrics=function(_){if(_!=null){var T=_.child1,E=_.child2;if(!_.isLeaf()){T.height,E.height;var W=new AABB;W.combine(T.aabb,E.aabb),this.validateMetrics(T),this.validateMetrics(E)}}},B.prototype.validate=function(){},B.prototype.getMaxBalance=function(){for(var _=0,T,E=this.iteratorPool.allocate().preorder(this.m_root);T=E.next();)if(!(T.height<=1)){var W=math_abs$8(T.child2.height-T.child1.height);_=math_max$6(_,W)}return this.iteratorPool.release(E),_},B.prototype.rebuildBottomUp=function(){for(var _=[],T=0,E,W=this.iteratorPool.allocate().preorder(this.m_root);E=W.next();)E.height<0||(E.isLeaf()?(E.parent=null,_[T]=E,++T):this.freeNode(E));for(this.iteratorPool.release(W);T>1;){for(var X=1/0,q=-1,Y=-1,te=0;te<T;++te)for(var ne=_[te].aabb,ae=te+1;ae<T;++ae){var le=_[ae].aabb,ue=AABB.combinedPerimeter(ne,le);ue<X&&(q=te,Y=ae,X=ue)}var ge=_[q],ye=_[Y],xe=this.allocateNode();xe.child1=ge,xe.child2=ye,xe.height=1+math_max$6(ge.height,ye.height),xe.aabb.combine(ge.aabb,ye.aabb),xe.parent=null,ge.parent=xe,ye.parent=xe,_[Y]=_[T-1],_[q]=xe,--T}this.m_root=_[0]},B.prototype.shiftOrigin=function(_){for(var T,E=this.iteratorPool.allocate().preorder(this.m_root);T=E.next();){var W=T.aabb;W.lowerBound.x-=_.x,W.lowerBound.y-=_.y,W.upperBound.x-=_.x,W.upperBound.y-=_.y}this.iteratorPool.release(E)},B.prototype.query=function(_,T){var E=this.stackPool.allocate();for(E.push(this.m_root);E.length>0;){var W=E.pop();if(W!=null&&AABB.testOverlap(W.aabb,_))if(W.isLeaf()){var X=T(W.id);if(X===!1)return}else E.push(W.child1),E.push(W.child2)}this.stackPool.release(E)},B.prototype.rayCast=function(_,T){var E=_.p1,W=_.p2,X=Vec2.sub(W,E);X.normalize();var q=Vec2.crossNumVec2(1,X),Y=Vec2.abs(q),te=_.maxFraction,ne=new AABB,ae=Vec2.combine(1-te,E,te,W);ne.combinePoints(E,ae);var le=this.stackPool.allocate(),ue=this.inputPool.allocate();for(le.push(this.m_root);le.length>0;){var ge=le.pop();if(ge!=null&&AABB.testOverlap(ge.aabb,ne)!==!1){var ye=ge.aabb.getCenter(),xe=ge.aabb.getExtents(),Te=math_abs$8(Vec2.dot(q,Vec2.sub(E,ye)))-Vec2.dot(Y,xe);if(!(Te>0))if(ge.isLeaf()){ue.p1=Vec2.clone(_.p1),ue.p2=Vec2.clone(_.p2),ue.maxFraction=te;var Ae=T(ue,ge.id);if(Ae===0)break;Ae>0&&(te=Ae,ae=Vec2.combine(1-te,E,te,W),ne.combinePoints(E,ae))}else le.push(ge.child1),le.push(ge.child2)}}this.stackPool.release(le),this.inputPool.release(ue)},B}(),Iterator=function(){function B(){this.parents=[],this.states=[]}return B.prototype.preorder=function(_){return this.parents.length=0,this.parents.push(_),this.states.length=0,this.states.push(0),this},B.prototype.next=function(){for(;this.parents.length>0;){var _=this.parents.length-1,T=this.parents[_];if(this.states[_]===0)return this.states[_]=1,T;if(this.states[_]===1&&(this.states[_]=2,T.child1))return this.parents.push(T.child1),this.states.push(1),T.child1;if(this.states[_]===2&&(this.states[_]=3,T.child2))return this.parents.push(T.child2),this.states.push(1),T.child2;this.parents.pop(),this.states.pop()}},B.prototype.close=function(){this.parents.length=0},B}(),math_max$5=Math.max,math_min$6=Math.min,BroadPhase=function(){function B(){var _=this;this.m_tree=new DynamicTree,this.m_moveBuffer=[],this.query=function(T,E){_.m_tree.query(T,E)},this.queryCallback=function(T){if(T===_.m_queryProxyId)return!0;var E=math_min$6(T,_.m_queryProxyId),W=math_max$5(T,_.m_queryProxyId),X=_.m_tree.getUserData(E),q=_.m_tree.getUserData(W);return _.m_callback(X,q),!0}}return B.prototype.getUserData=function(_){return this.m_tree.getUserData(_)},B.prototype.testOverlap=function(_,T){var E=this.m_tree.getFatAABB(_),W=this.m_tree.getFatAABB(T);return AABB.testOverlap(E,W)},B.prototype.getFatAABB=function(_){return this.m_tree.getFatAABB(_)},B.prototype.getProxyCount=function(){return this.m_moveBuffer.length},B.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},B.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},B.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},B.prototype.rayCast=function(_,T){this.m_tree.rayCast(_,T)},B.prototype.shiftOrigin=function(_){this.m_tree.shiftOrigin(_)},B.prototype.createProxy=function(_,T){var E=this.m_tree.createProxy(_,T);return this.bufferMove(E),E},B.prototype.destroyProxy=function(_){this.unbufferMove(_),this.m_tree.destroyProxy(_)},B.prototype.moveProxy=function(_,T,E){var W=this.m_tree.moveProxy(_,T,E);W&&this.bufferMove(_)},B.prototype.touchProxy=function(_){this.bufferMove(_)},B.prototype.bufferMove=function(_){this.m_moveBuffer.push(_)},B.prototype.unbufferMove=function(_){for(var T=0;T<this.m_moveBuffer.length;++T)this.m_moveBuffer[T]===_&&(this.m_moveBuffer[T]=null)},B.prototype.updatePairs=function(_){for(this.m_callback=_;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),this.m_queryProxyId!==null){var T=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(T,this.queryCallback)}},B}(),math_sin$2=Math.sin,math_cos$2=Math.cos,math_sqrt$4=Math.sqrt;function vec2(B,_){return{x:B,y:_}}function rotation(B){return{s:math_sin$2(B),c:math_cos$2(B)}}function setVec2(B,_,T){return B.x=_,B.y=T,B}function copyVec2(B,_){return B.x=_.x,B.y=_.y,B}function zeroVec2(B){return B.x=0,B.y=0,B}function negVec2(B){return B.x=-B.x,B.y=-B.y,B}function plusVec2(B,_){return B.x+=_.x,B.y+=_.y,B}function addVec2(B,_,T){return B.x=_.x+T.x,B.y=_.x+T.y,B}function minusVec2(B,_){return B.x-=_.x,B.y-=_.y,B}function subVec2(B,_,T){return B.x=_.x-T.x,B.y=_.y-T.y,B}function mulVec2(B,_){return B.x*=_,B.y*=_,B}function scaleVec2(B,_,T){return B.x=_*T.x,B.y=_*T.y,B}function plusScaleVec2(B,_,T){return B.x+=_*T.x,B.y+=_*T.y,B}function minusScaleVec2(B,_,T){return B.x-=_*T.x,B.y-=_*T.y,B}function combine2Vec2(B,_,T,E,W){return B.x=_*T.x+E*W.x,B.y=_*T.y+E*W.y,B}function combine3Vec2(B,_,T,E,W,X,q){return B.x=_*T.x+E*W.x+X*q.x,B.y=_*T.y+E*W.y+X*q.y,B}function normalizeVec2Length(B){var _=math_sqrt$4(B.x*B.x+B.y*B.y);if(_!==0){var T=1/_;B.x*=T,B.y*=T}return _}function normalizeVec2(B){var _=math_sqrt$4(B.x*B.x+B.y*B.y);if(_>0){var T=1/_;B.x*=T,B.y*=T}return B}function crossVec2Num(B,_,T){var E=T*_.y,W=-T*_.x;return B.x=E,B.y=W,B}function crossNumVec2(B,_,T){var E=-_*T.y,W=_*T.x;return B.x=E,B.y=W,B}function crossVec2Vec2(B,_){return B.x*_.y-B.y*_.x}function dotVec2(B,_){return B.x*_.x+B.y*_.y}function lengthSqrVec2(B){return B.x*B.x+B.y*B.y}function distVec2(B,_){var T=B.x-_.x,E=B.y-_.y;return math_sqrt$4(T*T+E*E)}function distSqrVec2(B,_){var T=B.x-_.x,E=B.y-_.y;return T*T+E*E}function setRotAngle(B,_){return B.c=math_cos$2(_),B.s=math_sin$2(_),B}function rotVec2(B,_,T){return B.x=_.c*T.x-_.s*T.y,B.y=_.s*T.x+_.c*T.y,B}function derotVec2(B,_,T){var E=_.c*T.x+_.s*T.y,W=-_.s*T.x+_.c*T.y;return B.x=E,B.y=W,B}function rerotVec2(B,_,T,E){var W=_.c*E.x+_.s*E.y,X=-_.s*E.x+_.c*E.y,q=T.c*W-T.s*X,Y=T.s*W+T.c*X;return B.x=q,B.y=Y,B}function transform(B,_,T){return{p:vec2(B,_),q:rotation(T)}}function copyTransform(B,_){return B.p.x=_.p.x,B.p.y=_.p.y,B.q.s=_.q.s,B.q.c=_.q.c,B}function transformVec2(B,_,T){var E=_.q.c*T.x-_.q.s*T.y+_.p.x,W=_.q.s*T.x+_.q.c*T.y+_.p.y;return B.x=E,B.y=W,B}function detransformVec2(B,_,T){var E=T.x-_.p.x,W=T.y-_.p.y,X=_.q.c*E+_.q.s*W,q=-_.q.s*E+_.q.c*W;return B.x=X,B.y=q,B}function retransformVec2(B,_,T,E){var W=_.q.c*E.x-_.q.s*E.y+_.p.x,X=_.q.s*E.x+_.q.c*E.y+_.p.y,q=W-T.p.x,Y=X-T.p.y,te=T.q.c*q+T.q.s*Y,ne=-T.q.s*q+T.q.c*Y;return B.x=te,B.y=ne,B}function detransformTransform(B,_,T){var E=_.q.c*T.q.c+_.q.s*T.q.s,W=_.q.c*T.q.s-_.q.s*T.q.c,X=_.q.c*(T.p.x-_.p.x)+_.q.s*(T.p.y-_.p.y),q=-_.q.s*(T.p.x-_.p.x)+_.q.c*(T.p.y-_.p.y);return B.q.c=E,B.q.s=W,B.p.x=X,B.p.y=q,B}var math_sin$1=Math.sin,math_cos$1=Math.cos,math_atan2$1=Math.atan2,Rot=function(){function B(_){if(!(this instanceof B))return new B(_);typeof _=="number"?this.setAngle(_):typeof _=="object"?this.setRot(_):this.setIdentity()}return B.neo=function(_){var T=Object.create(B.prototype);return T.setAngle(_),T},B.clone=function(_){var T=Object.create(B.prototype);return T.s=_.s,T.c=_.c,T},B.identity=function(){var _=Object.create(B.prototype);return _.s=0,_.c=1,_},B.isValid=function(_){return _===null||typeof _>"u"?!1:Number.isFinite(_.s)&&Number.isFinite(_.c)},B.assert=function(_){},B.prototype.setIdentity=function(){this.s=0,this.c=1},B.prototype.set=function(_){typeof _=="object"?(this.s=_.s,this.c=_.c):(this.s=math_sin$1(_),this.c=math_cos$1(_))},B.prototype.setRot=function(_){this.s=_.s,this.c=_.c},B.prototype.setAngle=function(_){this.s=math_sin$1(_),this.c=math_cos$1(_)},B.prototype.getAngle=function(){return math_atan2$1(this.s,this.c)},B.prototype.getXAxis=function(){return Vec2.neo(this.c,this.s)},B.prototype.getYAxis=function(){return Vec2.neo(-this.s,this.c)},B.mul=function(_,T){if("c"in T&&"s"in T){var E=B.identity();return E.s=_.s*T.c+_.c*T.s,E.c=_.c*T.c-_.s*T.s,E}else if("x"in T&&"y"in T)return Vec2.neo(_.c*T.x-_.s*T.y,_.s*T.x+_.c*T.y)},B.mulRot=function(_,T){var E=B.identity();return E.s=_.s*T.c+_.c*T.s,E.c=_.c*T.c-_.s*T.s,E},B.mulVec2=function(_,T){return Vec2.neo(_.c*T.x-_.s*T.y,_.s*T.x+_.c*T.y)},B.mulSub=function(_,T,E){var W=_.c*(T.x-E.x)-_.s*(T.y-E.y),X=_.s*(T.x-E.x)+_.c*(T.y-E.y);return Vec2.neo(W,X)},B.mulT=function(_,T){if("c"in T&&"s"in T){var E=B.identity();return E.s=_.c*T.s-_.s*T.c,E.c=_.c*T.c+_.s*T.s,E}else if("x"in T&&"y"in T)return Vec2.neo(_.c*T.x+_.s*T.y,-_.s*T.x+_.c*T.y)},B.mulTRot=function(_,T){var E=B.identity();return E.s=_.c*T.s-_.s*T.c,E.c=_.c*T.c+_.s*T.s,E},B.mulTVec2=function(_,T){return Vec2.neo(_.c*T.x+_.s*T.y,-_.s*T.x+_.c*T.y)},B}(),math_atan2=Math.atan2,math_PI$5=Math.PI,temp$7=vec2(0,0),Sweep=function(){function B(){this.localCenter=Vec2.zero(),this.c=Vec2.zero(),this.a=0,this.alpha0=0,this.c0=Vec2.zero(),this.a0=0}return B.prototype.recycle=function(){zeroVec2(this.localCenter),zeroVec2(this.c),this.a=0,this.alpha0=0,zeroVec2(this.c0),this.a0=0},B.prototype.setTransform=function(_){transformVec2(temp$7,_,this.localCenter),copyVec2(this.c,temp$7),copyVec2(this.c0,temp$7),this.a=this.a0=math_atan2(_.q.s,_.q.c)},B.prototype.setLocalCenter=function(_,T){copyVec2(this.localCenter,_),transformVec2(temp$7,T,this.localCenter),copyVec2(this.c,temp$7),copyVec2(this.c0,temp$7)},B.prototype.getTransform=function(_,T){T===void 0&&(T=0),setRotAngle(_.q,(1-T)*this.a0+T*this.a),combine2Vec2(_.p,1-T,this.c0,T,this.c),minusVec2(_.p,rotVec2(temp$7,_.q,this.localCenter))},B.prototype.advance=function(_){var T=(_-this.alpha0)/(1-this.alpha0);combine2Vec2(this.c0,T,this.c,1-T,this.c0),this.a0=T*this.a+(1-T)*this.a0,this.alpha0=_},B.prototype.forward=function(){this.a0=this.a,copyVec2(this.c0,this.c)},B.prototype.normalize=function(){var _=mod(this.a0,-math_PI$5,+math_PI$5);this.a-=this.a0-_,this.a0=_},B.prototype.set=function(_){copyVec2(this.localCenter,_.localCenter),copyVec2(this.c,_.c),this.a=_.a,this.alpha0=_.alpha0,copyVec2(this.c0,_.c0),this.a0=_.a0},B}(),Transform=function(){function B(_,T){if(!(this instanceof B))return new B(_,T);this.p=Vec2.zero(),this.q=Rot.identity(),typeof _<"u"&&this.p.setVec2(_),typeof T<"u"&&this.q.setAngle(T)}return B.clone=function(_){var T=Object.create(B.prototype);return T.p=Vec2.clone(_.p),T.q=Rot.clone(_.q),T},B.neo=function(_,T){var E=Object.create(B.prototype);return E.p=Vec2.clone(_),E.q=Rot.clone(T),E},B.identity=function(){var _=Object.create(B.prototype);return _.p=Vec2.zero(),_.q=Rot.identity(),_},B.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},B.prototype.set=function(_,T){typeof T>"u"?(this.p.set(_.p),this.q.set(_.q)):(this.p.set(_),this.q.set(T))},B.prototype.setNum=function(_,T){this.p.setVec2(_),this.q.setAngle(T)},B.prototype.setTransform=function(_){this.p.setVec2(_.p),this.q.setRot(_.q)},B.isValid=function(_){return _===null||typeof _>"u"?!1:Vec2.isValid(_.p)&&Rot.isValid(_.q)},B.assert=function(_){},B.mul=function(_,T){if(Array.isArray(T)){for(var E=[],W=0;W<T.length;W++)E[W]=B.mul(_,T[W]);return E}else{if("x"in T&&"y"in T)return B.mulVec2(_,T);if("p"in T&&"q"in T)return B.mulXf(_,T)}},B.mulAll=function(_,T){for(var E=[],W=0;W<T.length;W++)E[W]=B.mul(_,T[W]);return E},B.mulFn=function(_){return function(T){return B.mul(_,T)}},B.mulVec2=function(_,T){var E=_.q.c*T.x-_.q.s*T.y+_.p.x,W=_.q.s*T.x+_.q.c*T.y+_.p.y;return Vec2.neo(E,W)},B.mulXf=function(_,T){var E=B.identity();return E.q=Rot.mulRot(_.q,T.q),E.p=Vec2.add(Rot.mulVec2(_.q,T.p),_.p),E},B.mulT=function(_,T){if("x"in T&&"y"in T)return B.mulTVec2(_,T);if("p"in T&&"q"in T)return B.mulTXf(_,T)},B.mulTVec2=function(_,T){var E=T.x-_.p.x,W=T.y-_.p.y,X=_.q.c*E+_.q.s*W,q=-_.q.s*E+_.q.c*W;return Vec2.neo(X,q)},B.mulTXf=function(_,T){var E=B.identity();return E.q.setRot(Rot.mulTRot(_.q,T.q)),E.p.setVec2(Rot.mulTVec2(_.q,Vec2.sub(T.p,_.p))),E},B}(),Velocity=function(){function B(){this.v=Vec2.zero(),this.w=0}return B}(),math_sin=Math.sin,math_cos=Math.cos,Position=function(){function B(){this.c=Vec2.zero(),this.a=0}return B.prototype.getTransform=function(_,T){return _.q.c=math_cos(this.a),_.q.s=math_sin(this.a),_.p.x=this.c.x-(_.q.c*T.x-_.q.s*T.y),_.p.y=this.c.y-(_.q.s*T.x+_.q.c*T.y),_},B}();function getTransform(B,_,T,E){return B.q.c=math_cos(E),B.q.s=math_sin(E),B.p.x=T.x-(B.q.c*_.x-B.q.s*_.y),B.p.y=T.y-(B.q.s*_.x+B.q.c*_.y),B}var Shape=function(){function B(){this.style={},this.appData={}}return B.isValid=function(_){return _===null||typeof _>"u"?!1:typeof _.m_type=="string"&&typeof _.m_radius=="number"},B}(),synchronize_aabb1=new AABB,synchronize_aabb2=new AABB,displacement=vec2(0,0),FixtureDefDefault={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535},FixtureProxy=function(){function B(_,T){this.aabb=new AABB,this.fixture=_,this.childIndex=T}return B}(),Fixture=function(){function B(_,T,E){this.style={},this.appData={},T.shape?(E=T,T=T.shape):typeof E=="number"&&(E={density:E}),E=options(E,FixtureDefDefault),this.m_body=_,this.m_friction=E.friction,this.m_restitution=E.restitution,this.m_density=E.density,this.m_isSensor=E.isSensor,this.m_filterGroupIndex=E.filterGroupIndex,this.m_filterCategoryBits=E.filterCategoryBits,this.m_filterMaskBits=E.filterMaskBits,this.m_shape=T,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var W=this.m_shape.getChildCount(),X=0;X<W;++X)this.m_proxies[X]=new FixtureProxy(this,X);this.m_userData=E.userData,typeof E.style=="object"&&E.style!==null&&(this.style=E.style)}return B.prototype._reset=function(){var _=this.getBody(),T=_.m_world.m_broadPhase;this.destroyProxies(T),this.m_shape._reset&&this.m_shape._reset();for(var E=this.m_shape.getChildCount(),W=0;W<E;++W)this.m_proxies[W]=new FixtureProxy(this,W);this.createProxies(T,_.m_xf),_.resetMassData()},B.prototype._serialize=function(){return{friction:this.m_friction,restitution:this.m_restitution,density:this.m_density,isSensor:this.m_isSensor,filterGroupIndex:this.m_filterGroupIndex,filterCategoryBits:this.m_filterCategoryBits,filterMaskBits:this.m_filterMaskBits,shape:this.m_shape}},B._deserialize=function(_,T,E){var W=E(Shape,_.shape),X=W&&new B(T,W,_);return X},B.prototype.getType=function(){return this.m_shape.m_type},B.prototype.getShape=function(){return this.m_shape},B.prototype.isSensor=function(){return this.m_isSensor},B.prototype.setSensor=function(_){_!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=_)},B.prototype.getUserData=function(){return this.m_userData},B.prototype.setUserData=function(_){this.m_userData=_},B.prototype.getBody=function(){return this.m_body},B.prototype.getNext=function(){return this.m_next},B.prototype.getDensity=function(){return this.m_density},B.prototype.setDensity=function(_){this.m_density=_},B.prototype.getFriction=function(){return this.m_friction},B.prototype.setFriction=function(_){this.m_friction=_},B.prototype.getRestitution=function(){return this.m_restitution},B.prototype.setRestitution=function(_){this.m_restitution=_},B.prototype.testPoint=function(_){return this.m_shape.testPoint(this.m_body.getTransform(),_)},B.prototype.rayCast=function(_,T,E){return this.m_shape.rayCast(_,T,this.m_body.getTransform(),E)},B.prototype.getMassData=function(_){this.m_shape.computeMass(_,this.m_density)},B.prototype.getAABB=function(_){return this.m_proxies[_].aabb},B.prototype.createProxies=function(_,T){this.m_proxyCount=this.m_shape.getChildCount();for(var E=0;E<this.m_proxyCount;++E){var W=this.m_proxies[E];this.m_shape.computeAABB(W.aabb,T,E),W.proxyId=_.createProxy(W.aabb,W)}},B.prototype.destroyProxies=function(_){for(var T=0;T<this.m_proxyCount;++T){var E=this.m_proxies[T];_.destroyProxy(E.proxyId),E.proxyId=null}this.m_proxyCount=0},B.prototype.synchronize=function(_,T,E){for(var W=0;W<this.m_proxyCount;++W){var X=this.m_proxies[W];this.m_shape.computeAABB(synchronize_aabb1,T,X.childIndex),this.m_shape.computeAABB(synchronize_aabb2,E,X.childIndex),X.aabb.combine(synchronize_aabb1,synchronize_aabb2),subVec2(displacement,E.p,T.p),_.moveProxy(X.proxyId,X.aabb,displacement)}},B.prototype.setFilterData=function(_){this.m_filterGroupIndex=_.groupIndex,this.m_filterCategoryBits=_.categoryBits,this.m_filterMaskBits=_.maskBits,this.refilter()},B.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},B.prototype.setFilterGroupIndex=function(_){this.m_filterGroupIndex=_,this.refilter()},B.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},B.prototype.setFilterCategoryBits=function(_){this.m_filterCategoryBits=_,this.refilter()},B.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},B.prototype.setFilterMaskBits=function(_){this.m_filterMaskBits=_,this.refilter()},B.prototype.refilter=function(){if(this.m_body!=null){for(var _=this.m_body.getContactList();_;){var T=_.contact,E=T.getFixtureA(),W=T.getFixtureB();(E==this||W==this)&&T.flagForFiltering(),_=_.next}var X=this.m_body.getWorld();if(X!=null)for(var q=X.m_broadPhase,Y=0;Y<this.m_proxyCount;++Y)q.touchProxy(this.m_proxies[Y].proxyId)}},B.prototype.shouldCollide=function(_){if(_.m_filterGroupIndex===this.m_filterGroupIndex&&_.m_filterGroupIndex!==0)return _.m_filterGroupIndex>0;var T=(_.m_filterMaskBits&this.m_filterCategoryBits)!==0,E=(_.m_filterCategoryBits&this.m_filterMaskBits)!==0,W=T&&E;return W},B}(),STATIC="static",KINEMATIC="kinematic",DYNAMIC="dynamic",oldCenter=vec2(0,0),localCenter=vec2(0,0),shift=vec2(0,0),temp$6=vec2(0,0),xf$2=transform(0,0,0),BodyDefDefault={type:STATIC,position:Vec2.zero(),angle:0,linearVelocity:Vec2.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null},Body=function(){function B(_,T){this.style={},this.appData={},T=options(T,BodyDefDefault),this.m_world=_,this.m_awakeFlag=T.awake,this.m_autoSleepFlag=T.allowSleep,this.m_bulletFlag=T.bullet,this.m_fixedRotationFlag=T.fixedRotation,this.m_activeFlag=T.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=T.userData,this.m_type=T.type,this.m_type==DYNAMIC?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=Transform.identity(),this.m_xf.p.setVec2(T.position),this.m_xf.q.setAngle(T.angle),this.m_sweep=new Sweep,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new Velocity,this.c_position=new Position,this.m_force=Vec2.zero(),this.m_torque=0,this.m_linearVelocity=Vec2.clone(T.linearVelocity),this.m_angularVelocity=T.angularVelocity,this.m_linearDamping=T.linearDamping,this.m_angularDamping=T.angularDamping,this.m_gravityScale=T.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1,typeof T.style=="object"&&T.style!==null&&(this.style=T.style)}return B.prototype._serialize=function(){for(var _=[],T=this.m_fixtureList;T;T=T.m_next)_.push(T);return{type:this.m_type,bullet:this.m_bulletFlag,position:this.m_xf.p,angle:this.m_xf.q.getAngle(),linearVelocity:this.m_linearVelocity,angularVelocity:this.m_angularVelocity,fixtures:_}},B._deserialize=function(_,T,E){var W=new B(T,_);if(_.fixtures)for(var X=_.fixtures.length-1;X>=0;X--){var q=E(Fixture,_.fixtures[X],W);W._addFixture(q)}return W},B.prototype.isWorldLocked=function(){return!!(this.m_world&&this.m_world.isLocked())},B.prototype.getWorld=function(){return this.m_world},B.prototype.getNext=function(){return this.m_next},B.prototype.setUserData=function(_){this.m_userData=_},B.prototype.getUserData=function(){return this.m_userData},B.prototype.getFixtureList=function(){return this.m_fixtureList},B.prototype.getJointList=function(){return this.m_jointList},B.prototype.getContactList=function(){return this.m_contactList},B.prototype.isStatic=function(){return this.m_type==STATIC},B.prototype.isDynamic=function(){return this.m_type==DYNAMIC},B.prototype.isKinematic=function(){return this.m_type==KINEMATIC},B.prototype.setStatic=function(){return this.setType(STATIC),this},B.prototype.setDynamic=function(){return this.setType(DYNAMIC),this},B.prototype.setKinematic=function(){return this.setType(KINEMATIC),this},B.prototype.getType=function(){return this.m_type},B.prototype.setType=function(_){if(this.isWorldLocked()!=!0&&this.m_type!=_){this.m_type=_,this.resetMassData(),this.m_type==STATIC&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var T=this.m_contactList;T;){var E=T;T=T.next,this.m_world.destroyContact(E.contact)}this.m_contactList=null;for(var W=this.m_world.m_broadPhase,X=this.m_fixtureList;X;X=X.m_next)for(var q=0;q<X.m_proxyCount;++q)W.touchProxy(X.m_proxies[q].proxyId)}},B.prototype.isBullet=function(){return this.m_bulletFlag},B.prototype.setBullet=function(_){this.m_bulletFlag=!!_},B.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},B.prototype.setSleepingAllowed=function(_){this.m_autoSleepFlag=!!_,this.m_autoSleepFlag==!1&&this.setAwake(!0)},B.prototype.isAwake=function(){return this.m_awakeFlag},B.prototype.setAwake=function(_){_?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},B.prototype.isActive=function(){return this.m_activeFlag},B.prototype.setActive=function(_){if(_!=this.m_activeFlag)if(this.m_activeFlag=!!_,this.m_activeFlag){for(var T=this.m_world.m_broadPhase,E=this.m_fixtureList;E;E=E.m_next)E.createProxies(T,this.m_xf);this.m_world.m_newFixture=!0}else{for(var T=this.m_world.m_broadPhase,E=this.m_fixtureList;E;E=E.m_next)E.destroyProxies(T);for(var W=this.m_contactList;W;){var X=W;W=W.next,this.m_world.destroyContact(X.contact)}this.m_contactList=null}},B.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},B.prototype.setFixedRotation=function(_){this.m_fixedRotationFlag!=_&&(this.m_fixedRotationFlag=!!_,this.m_angularVelocity=0,this.resetMassData())},B.prototype.getTransform=function(){return this.m_xf},B.prototype.setTransform=function(_,T){if(this.isWorldLocked()!=!0){typeof T=="number"?this.m_xf.setNum(_,T):this.m_xf.setTransform(_),this.m_sweep.setTransform(this.m_xf);for(var E=this.m_world.m_broadPhase,W=this.m_fixtureList;W;W=W.m_next)W.synchronize(E,this.m_xf,this.m_xf);this.setAwake(!0)}},B.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)},B.prototype.synchronizeFixtures=function(){this.m_sweep.getTransform(xf$2,0);for(var _=this.m_world.m_broadPhase,T=this.m_fixtureList;T;T=T.m_next)T.synchronize(_,xf$2,this.m_xf)},B.prototype.advance=function(_){this.m_sweep.advance(_),copyVec2(this.m_sweep.c,this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},B.prototype.getPosition=function(){return this.m_xf.p},B.prototype.setPosition=function(_){this.setTransform(_,this.m_sweep.a)},B.prototype.getAngle=function(){return this.m_sweep.a},B.prototype.setAngle=function(_){this.setTransform(this.m_xf.p,_)},B.prototype.getWorldCenter=function(){return this.m_sweep.c},B.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},B.prototype.getLinearVelocity=function(){return this.m_linearVelocity},B.prototype.getLinearVelocityFromWorldPoint=function(_){var T=Vec2.sub(_,this.m_sweep.c);return Vec2.add(this.m_linearVelocity,Vec2.crossNumVec2(this.m_angularVelocity,T))},B.prototype.getLinearVelocityFromLocalPoint=function(_){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(_))},B.prototype.setLinearVelocity=function(_){this.m_type!=STATIC&&(Vec2.dot(_,_)>0&&this.setAwake(!0),this.m_linearVelocity.setVec2(_))},B.prototype.getAngularVelocity=function(){return this.m_angularVelocity},B.prototype.setAngularVelocity=function(_){this.m_type!=STATIC&&(_*_>0&&this.setAwake(!0),this.m_angularVelocity=_)},B.prototype.getLinearDamping=function(){return this.m_linearDamping},B.prototype.setLinearDamping=function(_){this.m_linearDamping=_},B.prototype.getAngularDamping=function(){return this.m_angularDamping},B.prototype.setAngularDamping=function(_){this.m_angularDamping=_},B.prototype.getGravityScale=function(){return this.m_gravityScale},B.prototype.setGravityScale=function(_){this.m_gravityScale=_},B.prototype.getMass=function(){return this.m_mass},B.prototype.getInertia=function(){return this.m_I+this.m_mass*Vec2.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},B.prototype.getMassData=function(_){_.mass=this.m_mass,_.I=this.getInertia(),copyVec2(_.center,this.m_sweep.localCenter)},B.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,zeroVec2(this.m_sweep.localCenter),this.isStatic()||this.isKinematic()){copyVec2(this.m_sweep.c0,this.m_xf.p),copyVec2(this.m_sweep.c,this.m_xf.p),this.m_sweep.a0=this.m_sweep.a;return}zeroVec2(localCenter);for(var _=this.m_fixtureList;_;_=_.m_next)if(_.m_density!=0){var T={mass:0,center:vec2(0,0),I:0};_.getMassData(T),this.m_mass+=T.mass,plusScaleVec2(localCenter,T.mass,T.center),this.m_I+=T.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,scaleVec2(localCenter,this.m_invMass,localCenter)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&this.m_fixedRotationFlag==!1?(this.m_I-=this.m_mass*dotVec2(localCenter,localCenter),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),copyVec2(oldCenter,this.m_sweep.c),this.m_sweep.setLocalCenter(localCenter,this.m_xf),subVec2(shift,this.m_sweep.c,oldCenter),crossNumVec2(temp$6,this.m_angularVelocity,shift),plusVec2(this.m_linearVelocity,temp$6)},B.prototype.setMassData=function(_){this.isWorldLocked()!=!0&&this.m_type==DYNAMIC&&(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=_.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,_.I>0&&this.m_fixedRotationFlag==!1&&(this.m_I=_.I-this.m_mass*dotVec2(_.center,_.center),this.m_invI=1/this.m_I),copyVec2(oldCenter,this.m_sweep.c),this.m_sweep.setLocalCenter(_.center,this.m_xf),subVec2(shift,this.m_sweep.c,oldCenter),crossNumVec2(temp$6,this.m_angularVelocity,shift),plusVec2(this.m_linearVelocity,temp$6))},B.prototype.applyForce=function(_,T,E){E===void 0&&(E=!0),this.m_type==DYNAMIC&&(E&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(_),this.m_torque+=Vec2.crossVec2Vec2(Vec2.sub(T,this.m_sweep.c),_)))},B.prototype.applyForceToCenter=function(_,T){T===void 0&&(T=!0),this.m_type==DYNAMIC&&(T&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(_))},B.prototype.applyTorque=function(_,T){T===void 0&&(T=!0),this.m_type==DYNAMIC&&(T&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=_))},B.prototype.applyLinearImpulse=function(_,T,E){E===void 0&&(E=!0),this.m_type==DYNAMIC&&(E&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,_),this.m_angularVelocity+=this.m_invI*Vec2.crossVec2Vec2(Vec2.sub(T,this.m_sweep.c),_)))},B.prototype.applyAngularImpulse=function(_,T){T===void 0&&(T=!0),this.m_type==DYNAMIC&&(T&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*_))},B.prototype.shouldCollide=function(_){if(this.m_type!=DYNAMIC&&_.m_type!=DYNAMIC)return!1;for(var T=this.m_jointList;T;T=T.next)if(T.other==_&&T.joint.m_collideConnected==!1)return!1;return!0},B.prototype._addFixture=function(_){if(this.isWorldLocked()==!0)return null;if(this.m_activeFlag){var T=this.m_world.m_broadPhase;_.createProxies(T,this.m_xf)}return _.m_next=this.m_fixtureList,this.m_fixtureList=_,_.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,_},B.prototype.createFixture=function(_,T){if(this.isWorldLocked()==!0)return null;var E=new Fixture(this,_,T);return this._addFixture(E),E},B.prototype.destroyFixture=function(_){if(this.isWorldLocked()!=!0){if(this.m_fixtureList===_)this.m_fixtureList=_.m_next;else for(var T=this.m_fixtureList;T!=null;){if(T.m_next===_){T.m_next=_.m_next;break}T=T.m_next}for(var E=this.m_contactList;E;){var W=E.contact;E=E.next;var X=W.getFixtureA(),q=W.getFixtureB();(_==X||_==q)&&this.m_world.destroyContact(W)}if(this.m_activeFlag){var Y=this.m_world.m_broadPhase;_.destroyProxies(Y)}_.m_body=null,_.m_next=null,this.m_world.publish("remove-fixture",_),this.resetMassData()}},B.prototype.getWorldPoint=function(_){return Transform.mulVec2(this.m_xf,_)},B.prototype.getWorldVector=function(_){return Rot.mulVec2(this.m_xf.q,_)},B.prototype.getLocalPoint=function(_){return Transform.mulTVec2(this.m_xf,_)},B.prototype.getLocalVector=function(_){return Rot.mulTVec2(this.m_xf.q,_)},B.STATIC="static",B.KINEMATIC="kinematic",B.DYNAMIC="dynamic",B}(),JointEdge=function(){function B(){this.other=null,this.joint=null,this.prev=null,this.next=null}return B}(),Joint=function(){function B(_,T,E){this.m_type="unknown-joint",this.m_prev=null,this.m_next=null,this.m_edgeA=new JointEdge,this.m_edgeB=new JointEdge,this.m_islandFlag=!1,this.style={},this.appData={},T="bodyA"in _?_.bodyA:T,E="bodyB"in _?_.bodyB:E,this.m_bodyA=T,this.m_bodyB=E,this.m_collideConnected=!!_.collideConnected,this.m_userData=_.userData,typeof _.style=="object"&&_.style!==null&&(this.style=_.style)}return B.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()},B.prototype.getType=function(){return this.m_type},B.prototype.getBodyA=function(){return this.m_bodyA},B.prototype.getBodyB=function(){return this.m_bodyB},B.prototype.getNext=function(){return this.m_next},B.prototype.getUserData=function(){return this.m_userData},B.prototype.setUserData=function(_){this.m_userData=_},B.prototype.getCollideConnected=function(){return this.m_collideConnected},B.prototype.shiftOrigin=function(_){},B.prototype._resetAnchors=function(_){return this._reset(_)},B}(),stats={gjkCalls:0,gjkIters:0,gjkMaxIters:0,toiTime:0,toiMaxTime:0,toiCalls:0,toiIters:0,toiMaxIters:0,toiRootIters:0,toiMaxRootIters:0,toString:function(B){B=typeof B=="string"?B:`
`;var _="";for(var T in this)typeof this[T]!="function"&&typeof this[T]!="object"&&(_+=T+": "+this[T]+B);return _}},now=function(){return Date.now()},diff=function(B){return Date.now()-B};const Timer={now,diff};var math_max$4=Math.max,temp$5=vec2(0,0),normal$4=vec2(0,0),e12=vec2(0,0),e13=vec2(0,0),e23=vec2(0,0),temp1=vec2(0,0),temp2=vec2(0,0);stats.gjkCalls=0;stats.gjkIters=0;stats.gjkMaxIters=0;var DistanceInput=function(){function B(){this.proxyA=new DistanceProxy,this.proxyB=new DistanceProxy,this.transformA=Transform.identity(),this.transformB=Transform.identity(),this.useRadii=!1}return B.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),this.useRadii=!1},B}(),DistanceOutput=function(){function B(){this.pointA=vec2(0,0),this.pointB=vec2(0,0),this.distance=0,this.iterations=0}return B.prototype.recycle=function(){zeroVec2(this.pointA),zeroVec2(this.pointB),this.distance=0,this.iterations=0},B}(),SimplexCache=function(){function B(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}return B.prototype.recycle=function(){this.metric=0,this.indexA.length=0,this.indexB.length=0,this.count=0},B}(),Distance=function(B,_,T){++stats.gjkCalls;var E=T.proxyA,W=T.proxyB,X=T.transformA,q=T.transformB;simplex.recycle(),simplex.readCache(_,E,X,W,q);for(var Y=simplex.m_v,te=SettingsInternal.maxDistanceIterations,ne=[],ae=[],le=0,ue=0;ue<te;){le=simplex.m_count;for(var ge=0;ge<le;++ge)ne[ge]=Y[ge].indexA,ae[ge]=Y[ge].indexB;if(simplex.solve(),simplex.m_count===3)break;var ye=simplex.getSearchDirection();if(lengthSqrVec2(ye)<EPSILON*EPSILON)break;var xe=Y[simplex.m_count];xe.indexA=E.getSupport(derotVec2(temp$5,X.q,scaleVec2(temp$5,-1,ye))),transformVec2(xe.wA,X,E.getVertex(xe.indexA)),xe.indexB=W.getSupport(derotVec2(temp$5,q.q,ye)),transformVec2(xe.wB,q,W.getVertex(xe.indexB)),subVec2(xe.w,xe.wB,xe.wA),++ue,++stats.gjkIters;for(var Te=!1,ge=0;ge<le;++ge)if(xe.indexA===ne[ge]&&xe.indexB===ae[ge]){Te=!0;break}if(Te)break;++simplex.m_count}if(stats.gjkMaxIters=math_max$4(stats.gjkMaxIters,ue),simplex.getWitnessPoints(B.pointA,B.pointB),B.distance=distVec2(B.pointA,B.pointB),B.iterations=ue,simplex.writeCache(_),T.useRadii){var Ae=E.m_radius,Ie=W.m_radius;if(B.distance>Ae+Ie&&B.distance>EPSILON)B.distance-=Ae+Ie,subVec2(normal$4,B.pointB,B.pointA),normalizeVec2(normal$4),plusScaleVec2(B.pointA,Ae,normal$4),minusScaleVec2(B.pointB,Ie,normal$4);else{var Ve=subVec2(temp$5,B.pointA,B.pointB);copyVec2(B.pointA,Ve),copyVec2(B.pointB,Ve),B.distance=0}}},DistanceProxy=function(){function B(){this.m_vertices=[],this.m_count=0,this.m_radius=0}return B.prototype.recycle=function(){this.m_vertices.length=0,this.m_count=0,this.m_radius=0},B.prototype.getVertexCount=function(){return this.m_count},B.prototype.getVertex=function(_){return this.m_vertices[_]},B.prototype.getSupport=function(_){for(var T=-1,E=-1/0,W=0;W<this.m_count;++W){var X=dotVec2(this.m_vertices[W],_);X>E&&(T=W,E=X)}return T},B.prototype.getSupportVertex=function(_){return this.m_vertices[this.getSupport(_)]},B.prototype.set=function(_,T){_.computeDistanceProxy(this,T)},B.prototype.setVertices=function(_,T,E){this.m_vertices=_,this.m_count=T,this.m_radius=E},B}(),SimplexVertex=function(){function B(){this.wA=vec2(0,0),this.indexA=0,this.wB=vec2(0,0),this.indexB=0,this.w=vec2(0,0),this.a=0}return B.prototype.recycle=function(){this.indexA=0,this.indexB=0,zeroVec2(this.wA),zeroVec2(this.wB),zeroVec2(this.w),this.a=0},B.prototype.set=function(_){this.indexA=_.indexA,this.indexB=_.indexB,copyVec2(this.wA,_.wA),copyVec2(this.wB,_.wB),copyVec2(this.w,_.w),this.a=_.a},B}(),searchDirection_reuse=vec2(0,0),closestPoint_reuse=vec2(0,0),Simplex=function(){function B(){this.m_v1=new SimplexVertex,this.m_v2=new SimplexVertex,this.m_v3=new SimplexVertex,this.m_v=[this.m_v1,this.m_v2,this.m_v3]}return B.prototype.recycle=function(){this.m_v1.recycle(),this.m_v2.recycle(),this.m_v3.recycle(),this.m_count=0},B.prototype.toString=function(){return this.m_count===3?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():this.m_count===2?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():this.m_count===1?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},B.prototype.readCache=function(_,T,E,W,X){this.m_count=_.count;for(var q=0;q<this.m_count;++q){var Y=this.m_v[q];Y.indexA=_.indexA[q],Y.indexB=_.indexB[q];var te=T.getVertex(Y.indexA),ne=W.getVertex(Y.indexB);transformVec2(Y.wA,E,te),transformVec2(Y.wB,X,ne),subVec2(Y.w,Y.wB,Y.wA),Y.a=0}if(this.m_count>1){var ae=_.metric,le=this.getMetric();(le<.5*ae||2*ae<le||le<EPSILON)&&(this.m_count=0)}if(this.m_count===0){var Y=this.m_v[0];Y.indexA=0,Y.indexB=0;var te=T.getVertex(0),ne=W.getVertex(0);transformVec2(Y.wA,E,te),transformVec2(Y.wB,X,ne),subVec2(Y.w,Y.wB,Y.wA),Y.a=1,this.m_count=1}},B.prototype.writeCache=function(_){_.metric=this.getMetric(),_.count=this.m_count;for(var T=0;T<this.m_count;++T)_.indexA[T]=this.m_v[T].indexA,_.indexB[T]=this.m_v[T].indexB},B.prototype.getSearchDirection=function(){var _=this.m_v1,T=this.m_v2;switch(this.m_v3,this.m_count){case 1:return setVec2(searchDirection_reuse,-_.w.x,-_.w.y);case 2:{subVec2(e12,T.w,_.w);var E=-crossVec2Vec2(e12,_.w);return E>0?setVec2(searchDirection_reuse,-e12.y,e12.x):setVec2(searchDirection_reuse,e12.y,-e12.x)}default:return zeroVec2(searchDirection_reuse)}},B.prototype.getClosestPoint=function(){var _=this.m_v1,T=this.m_v2;switch(this.m_v3,this.m_count){case 0:return zeroVec2(closestPoint_reuse);case 1:return copyVec2(closestPoint_reuse,_.w);case 2:return combine2Vec2(closestPoint_reuse,_.a,_.w,T.a,T.w);case 3:return zeroVec2(closestPoint_reuse);default:return zeroVec2(closestPoint_reuse)}},B.prototype.getWitnessPoints=function(_,T){var E=this.m_v1,W=this.m_v2,X=this.m_v3;switch(this.m_count){case 0:break;case 1:copyVec2(_,E.wA),copyVec2(T,E.wB);break;case 2:combine2Vec2(_,E.a,E.wA,W.a,W.wA),combine2Vec2(T,E.a,E.wB,W.a,W.wB);break;case 3:combine3Vec2(_,E.a,E.wA,W.a,W.wA,X.a,X.wA),copyVec2(T,_);break}},B.prototype.getMetric=function(){switch(this.m_count){case 0:return 0;case 1:return 0;case 2:return distVec2(this.m_v1.w,this.m_v2.w);case 3:return crossVec2Vec2(subVec2(temp1,this.m_v2.w,this.m_v1.w),subVec2(temp2,this.m_v3.w,this.m_v1.w));default:return 0}},B.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3();break}},B.prototype.solve2=function(){var _=this.m_v1.w,T=this.m_v2.w;subVec2(e12,T,_);var E=-dotVec2(_,e12);if(E<=0){this.m_v1.a=1,this.m_count=1;return}var W=dotVec2(T,e12);if(W<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}var X=1/(W+E);this.m_v1.a=W*X,this.m_v2.a=E*X,this.m_count=2},B.prototype.solve3=function(){var _=this.m_v1.w,T=this.m_v2.w,E=this.m_v3.w;subVec2(e12,T,_);var W=dotVec2(_,e12),X=dotVec2(T,e12),q=X,Y=-W;subVec2(e13,E,_);var te=dotVec2(_,e13),ne=dotVec2(E,e13),ae=ne,le=-te;subVec2(e23,E,T);var ue=dotVec2(T,e23),ge=dotVec2(E,e23),ye=ge,xe=-ue,Te=crossVec2Vec2(e12,e13),Ae=Te*crossVec2Vec2(T,E),Ie=Te*crossVec2Vec2(E,_),Ve=Te*crossVec2Vec2(_,T);if(Y<=0&&le<=0){this.m_v1.a=1,this.m_count=1;return}if(q>0&&Y>0&&Ve<=0){var $e=1/(q+Y);this.m_v1.a=q*$e,this.m_v2.a=Y*$e,this.m_count=2;return}if(ae>0&&le>0&&Ie<=0){var We=1/(ae+le);this.m_v1.a=ae*We,this.m_v3.a=le*We,this.m_count=2,this.m_v2.set(this.m_v3);return}if(q<=0&&xe<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}if(ae<=0&&ye<=0){this.m_v3.a=1,this.m_count=1,this.m_v1.set(this.m_v3);return}if(ye>0&&xe>0&&Ae<=0){var Ue=1/(ye+xe);this.m_v2.a=ye*Ue,this.m_v3.a=xe*Ue,this.m_count=2,this.m_v1.set(this.m_v3);return}var je=1/(Ae+Ie+Ve);this.m_v1.a=Ae*je,this.m_v2.a=Ie*je,this.m_v3.a=Ve*je,this.m_count=3},B}(),simplex=new Simplex,input$1=new DistanceInput,cache$1=new SimplexCache,output$1=new DistanceOutput,testOverlap=function(B,_,T,E,W,X){return input$1.recycle(),input$1.proxyA.set(B,_),input$1.proxyB.set(T,E),copyTransform(input$1.transformA,W),copyTransform(input$1.transformB,X),input$1.useRadii=!0,output$1.recycle(),cache$1.recycle(),Distance(output$1,cache$1,input$1),output$1.distance<10*EPSILON};Distance.testOverlap=testOverlap;Distance.Input=DistanceInput;Distance.Output=DistanceOutput;Distance.Proxy=DistanceProxy;Distance.Cache=SimplexCache;(function(){function B(){this.proxyA=new DistanceProxy,this.proxyB=new DistanceProxy,this.transformA=Transform.identity(),this.transformB=Transform.identity(),this.translationB=Vec2.zero()}return B.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),zeroVec2(this.translationB)},B})();var math_abs$7=Math.abs,math_max$3=Math.max,TOIInput=function(){function B(){this.proxyA=new DistanceProxy,this.proxyB=new DistanceProxy,this.sweepA=new Sweep,this.sweepB=new Sweep}return B.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.sweepA.recycle(),this.sweepB.recycle(),this.tMax=-1},B}(),TOIOutputState;(function(B){B[B.e_unset=-1]="e_unset",B[B.e_unknown=0]="e_unknown",B[B.e_failed=1]="e_failed",B[B.e_overlapped=2]="e_overlapped",B[B.e_touching=3]="e_touching",B[B.e_separated=4]="e_separated"})(TOIOutputState||(TOIOutputState={}));var TOIOutput=function(){function B(){this.state=TOIOutputState.e_unset,this.t=-1}return B.prototype.recycle=function(){this.state=TOIOutputState.e_unset,this.t=-1},B}();stats.toiTime=0;stats.toiMaxTime=0;stats.toiCalls=0;stats.toiIters=0;stats.toiMaxIters=0;stats.toiRootIters=0;stats.toiMaxRootIters=0;var distanceInput=new DistanceInput,distanceOutput=new DistanceOutput,cache=new SimplexCache,xfA$1=transform(0,0,0),xfB$1=transform(0,0,0),temp$4=vec2(0,0),pointA$2=vec2(0,0),pointB$2=vec2(0,0),normal$3=vec2(0,0),axisA=vec2(0,0),axisB=vec2(0,0),localPointA=vec2(0,0),localPointB=vec2(0,0),TimeOfImpact=function(B,_){var T=Timer.now();++stats.toiCalls,B.state=TOIOutputState.e_unknown,B.t=_.tMax;var E=_.proxyA,W=_.proxyB,X=_.sweepA,q=_.sweepB;X.normalize(),q.normalize();var Y=_.tMax,te=E.m_radius+W.m_radius,ne=math_max$3(SettingsInternal.linearSlop,te-3*SettingsInternal.linearSlop),ae=.25*SettingsInternal.linearSlop,le=0,ue=SettingsInternal.maxTOIIterations,ge=0;for(cache.recycle(),distanceInput.proxyA.setVertices(E.m_vertices,E.m_count,E.m_radius),distanceInput.proxyB.setVertices(W.m_vertices,W.m_count,W.m_radius),distanceInput.useRadii=!1;;){if(X.getTransform(xfA$1,le),q.getTransform(xfB$1,le),copyTransform(distanceInput.transformA,xfA$1),copyTransform(distanceInput.transformB,xfB$1),Distance(distanceOutput,cache,distanceInput),distanceOutput.distance<=0){B.state=TOIOutputState.e_overlapped,B.t=0;break}if(distanceOutput.distance<ne+ae){B.state=TOIOutputState.e_touching,B.t=le;break}separationFunction.initialize(cache,E,X,W,q,le);for(var ye=!1,xe=Y,Te=0;;){var Ae=separationFunction.findMinSeparation(xe);if(Ae>ne+ae){B.state=TOIOutputState.e_separated,B.t=Y,ye=!0;break}if(Ae>ne-ae){le=xe;break}var Ie=separationFunction.evaluate(le);if(Ie<ne-ae){B.state=TOIOutputState.e_failed,B.t=le,ye=!0;break}if(Ie<=ne+ae){B.state=TOIOutputState.e_touching,B.t=le,ye=!0;break}for(var Ve=0,$e=le,We=xe;;){var Ue=void 0;Ve&1?Ue=$e+(ne-Ie)*(We-$e)/(Ae-Ie):Ue=.5*($e+We),++Ve,++stats.toiRootIters;var je=separationFunction.evaluate(Ue);if(math_abs$7(je-ne)<ae){xe=Ue;break}if(je>ne?($e=Ue,Ie=je):(We=Ue,Ae=je),Ve===50)break}if(stats.toiMaxRootIters=math_max$3(stats.toiMaxRootIters,Ve),++Te,Te===SettingsInternal.maxPolygonVertices)break}if(++ge,++stats.toiIters,ye)break;if(ge===ue){B.state=TOIOutputState.e_failed,B.t=le;break}}stats.toiMaxIters=math_max$3(stats.toiMaxIters,ge);var ze=Timer.diff(T);stats.toiMaxTime=math_max$3(stats.toiMaxTime,ze),stats.toiTime+=ze,separationFunction.recycle()},SeparationFunctionType;(function(B){B[B.e_unset=-1]="e_unset",B[B.e_points=1]="e_points",B[B.e_faceA=2]="e_faceA",B[B.e_faceB=3]="e_faceB"})(SeparationFunctionType||(SeparationFunctionType={}));var SeparationFunction=function(){function B(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=SeparationFunctionType.e_unset,this.m_localPoint=vec2(0,0),this.m_axis=vec2(0,0),this.indexA=-1,this.indexB=-1}return B.prototype.recycle=function(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=SeparationFunctionType.e_unset,zeroVec2(this.m_localPoint),zeroVec2(this.m_axis),this.indexA=-1,this.indexB=-1},B.prototype.initialize=function(_,T,E,W,X,q){var Y=_.count;if(this.m_proxyA=T,this.m_proxyB=W,this.m_sweepA=E,this.m_sweepB=X,this.m_sweepA.getTransform(xfA$1,q),this.m_sweepB.getTransform(xfB$1,q),Y===1){this.m_type=SeparationFunctionType.e_points;var te=this.m_proxyA.getVertex(_.indexA[0]),ne=this.m_proxyB.getVertex(_.indexB[0]);transformVec2(pointA$2,xfA$1,te),transformVec2(pointB$2,xfB$1,ne),subVec2(this.m_axis,pointB$2,pointA$2);var ae=normalizeVec2Length(this.m_axis);return ae}else if(_.indexA[0]===_.indexA[1]){this.m_type=SeparationFunctionType.e_faceB;var le=W.getVertex(_.indexB[0]),ue=W.getVertex(_.indexB[1]);crossVec2Num(this.m_axis,subVec2(temp$4,ue,le),1),normalizeVec2(this.m_axis),rotVec2(normal$3,xfB$1.q,this.m_axis),combine2Vec2(this.m_localPoint,.5,le,.5,ue),transformVec2(pointB$2,xfB$1,this.m_localPoint);var ge=T.getVertex(_.indexA[0]),ye=Transform.mulVec2(xfA$1,ge),ae=dotVec2(ye,normal$3)-dotVec2(pointB$2,normal$3);return ae<0&&(negVec2(this.m_axis),ae=-ae),ae}else{this.m_type=SeparationFunctionType.e_faceA;var xe=this.m_proxyA.getVertex(_.indexA[0]),Te=this.m_proxyA.getVertex(_.indexA[1]);crossVec2Num(this.m_axis,subVec2(temp$4,Te,xe),1),normalizeVec2(this.m_axis),rotVec2(normal$3,xfA$1.q,this.m_axis),combine2Vec2(this.m_localPoint,.5,xe,.5,Te),transformVec2(pointA$2,xfA$1,this.m_localPoint);var Ae=this.m_proxyB.getVertex(_.indexB[0]);transformVec2(pointB$2,xfB$1,Ae);var ae=dotVec2(pointB$2,normal$3)-dotVec2(pointA$2,normal$3);return ae<0&&(negVec2(this.m_axis),ae=-ae),ae}},B.prototype.compute=function(_,T){switch(this.m_sweepA.getTransform(xfA$1,T),this.m_sweepB.getTransform(xfB$1,T),this.m_type){case SeparationFunctionType.e_points:{_&&(derotVec2(axisA,xfA$1.q,this.m_axis),derotVec2(axisB,xfB$1.q,scaleVec2(temp$4,-1,this.m_axis)),this.indexA=this.m_proxyA.getSupport(axisA),this.indexB=this.m_proxyB.getSupport(axisB)),copyVec2(localPointA,this.m_proxyA.getVertex(this.indexA)),copyVec2(localPointB,this.m_proxyB.getVertex(this.indexB)),transformVec2(pointA$2,xfA$1,localPointA),transformVec2(pointB$2,xfB$1,localPointB);var E=dotVec2(pointB$2,this.m_axis)-dotVec2(pointA$2,this.m_axis);return E}case SeparationFunctionType.e_faceA:{rotVec2(normal$3,xfA$1.q,this.m_axis),transformVec2(pointA$2,xfA$1,this.m_localPoint),_&&(derotVec2(axisB,xfB$1.q,scaleVec2(temp$4,-1,normal$3)),this.indexA=-1,this.indexB=this.m_proxyB.getSupport(axisB)),copyVec2(localPointB,this.m_proxyB.getVertex(this.indexB)),transformVec2(pointB$2,xfB$1,localPointB);var E=dotVec2(pointB$2,normal$3)-dotVec2(pointA$2,normal$3);return E}case SeparationFunctionType.e_faceB:{rotVec2(normal$3,xfB$1.q,this.m_axis),transformVec2(pointB$2,xfB$1,this.m_localPoint),_&&(derotVec2(axisA,xfA$1.q,scaleVec2(temp$4,-1,normal$3)),this.indexB=-1,this.indexA=this.m_proxyA.getSupport(axisA)),copyVec2(localPointA,this.m_proxyA.getVertex(this.indexA)),transformVec2(pointA$2,xfA$1,localPointA);var E=dotVec2(pointA$2,normal$3)-dotVec2(pointB$2,normal$3);return E}default:return _&&(this.indexA=-1,this.indexB=-1),0}},B.prototype.findMinSeparation=function(_){return this.compute(!0,_)},B.prototype.evaluate=function(_){return this.compute(!1,_)},B}(),separationFunction=new SeparationFunction;TimeOfImpact.Input=TOIInput;TimeOfImpact.Output=TOIOutput;var math_abs$6=Math.abs,math_sqrt$3=Math.sqrt,math_min$5=Math.min,TimeStep=function(){function B(){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}return B.prototype.reset=function(_){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=_,this.inv_dt=_==0?0:1/_,this.dtRatio=_*this.inv_dt0},B}(),s_subStep=new TimeStep,c=vec2(0,0),v=vec2(0,0),translation=vec2(0,0),input=new TOIInput,output=new TOIOutput,backup=new Sweep,backup1=new Sweep,backup2=new Sweep,ContactImpulse=function(){function B(_){this.contact=_,this.normals=[],this.tangents=[]}return B.prototype.recycle=function(){this.normals.length=0,this.tangents.length=0},Object.defineProperty(B.prototype,"normalImpulses",{get:function(){var _=this.contact,T=this.normals;T.length=0;for(var E=0;E<_.v_points.length;++E)T.push(_.v_points[E].normalImpulse);return T},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"tangentImpulses",{get:function(){var _=this.contact,T=this.tangents;T.length=0;for(var E=0;E<_.v_points.length;++E)T.push(_.v_points[E].tangentImpulse);return T},enumerable:!1,configurable:!0}),B}(),Solver=function(){function B(_){this.m_world=_,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}return B.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},B.prototype.addBody=function(_){this.m_bodies.push(_)},B.prototype.addContact=function(_){this.m_contacts.push(_)},B.prototype.addJoint=function(_){this.m_joints.push(_)},B.prototype.solveWorld=function(_){for(var T=this.m_world,E=T.m_bodyList;E;E=E.m_next)E.m_islandFlag=!1;for(var W=T.m_contactList;W;W=W.m_next)W.m_islandFlag=!1;for(var X=T.m_jointList;X;X=X.m_next)X.m_islandFlag=!1;for(var q=this.m_stack,Y=T.m_bodyList;Y;Y=Y.m_next)if(!Y.m_islandFlag&&!(Y.isAwake()==!1||Y.isActive()==!1)&&!Y.isStatic()){for(this.clear(),q.push(Y),Y.m_islandFlag=!0;q.length>0;){var E=q.pop();if(this.addBody(E),E.m_awakeFlag=!0,!E.isStatic()){for(var te=E.m_contactList;te;te=te.next){var ne=te.contact;if(!ne.m_islandFlag&&!(ne.isEnabled()==!1||ne.isTouching()==!1)){var ae=ne.m_fixtureA.m_isSensor,le=ne.m_fixtureB.m_isSensor;if(!(ae||le)){this.addContact(ne),ne.m_islandFlag=!0;var ue=te.other;ue.m_islandFlag||(q.push(ue),ue.m_islandFlag=!0)}}}for(var ge=E.m_jointList;ge;ge=ge.next)if(ge.joint.m_islandFlag!=!0){var ue=ge.other;ue.isActive()!=!1&&(this.addJoint(ge.joint),ge.joint.m_islandFlag=!0,!ue.m_islandFlag&&(q.push(ue),ue.m_islandFlag=!0))}}}this.solveIsland(_);for(var ye=0;ye<this.m_bodies.length;++ye){var E=this.m_bodies[ye];E.isStatic()&&(E.m_islandFlag=!1)}}},B.prototype.solveIsland=function(_){for(var T=this.m_world,E=T.m_gravity,W=T.m_allowSleep,X=_.dt,q=0;q<this.m_bodies.length;++q){var Y=this.m_bodies[q];copyVec2(c,Y.m_sweep.c);var te=Y.m_sweep.a;copyVec2(v,Y.m_linearVelocity);var ne=Y.m_angularVelocity;copyVec2(Y.m_sweep.c0,Y.m_sweep.c),Y.m_sweep.a0=Y.m_sweep.a,Y.isDynamic()&&(plusScaleVec2(v,X*Y.m_gravityScale,E),plusScaleVec2(v,X*Y.m_invMass,Y.m_force),ne+=X*Y.m_invI*Y.m_torque,scaleVec2(v,1/(1+X*Y.m_linearDamping),v),ne*=1/(1+X*Y.m_angularDamping)),copyVec2(Y.c_position.c,c),Y.c_position.a=te,copyVec2(Y.c_velocity.v,v),Y.c_velocity.w=ne}for(var q=0;q<this.m_contacts.length;++q){var ae=this.m_contacts[q];ae.initConstraint(_)}for(var q=0;q<this.m_contacts.length;++q){var ae=this.m_contacts[q];ae.initVelocityConstraint(_)}if(_.warmStarting)for(var q=0;q<this.m_contacts.length;++q){var ae=this.m_contacts[q];ae.warmStartConstraint(_)}for(var q=0;q<this.m_joints.length;++q){var le=this.m_joints[q];le.initVelocityConstraints(_)}for(var q=0;q<_.velocityIterations;++q){for(var ue=0;ue<this.m_joints.length;++ue){var le=this.m_joints[ue];le.solveVelocityConstraints(_)}for(var ue=0;ue<this.m_contacts.length;++ue){var ae=this.m_contacts[ue];ae.solveVelocityConstraint(_)}}for(var q=0;q<this.m_contacts.length;++q){var ae=this.m_contacts[q];ae.storeConstraintImpulses(_)}for(var q=0;q<this.m_bodies.length;++q){var Y=this.m_bodies[q];copyVec2(c,Y.c_position.c);var te=Y.c_position.a;copyVec2(v,Y.c_velocity.v);var ne=Y.c_velocity.w;scaleVec2(translation,X,v);var ge=lengthSqrVec2(translation);if(ge>SettingsInternal.maxTranslationSquared){var ye=SettingsInternal.maxTranslation/math_sqrt$3(ge);mulVec2(v,ye)}var xe=X*ne;if(xe*xe>SettingsInternal.maxRotationSquared){var ye=SettingsInternal.maxRotation/math_abs$6(xe);ne*=ye}plusScaleVec2(c,X,v),te+=X*ne,copyVec2(Y.c_position.c,c),Y.c_position.a=te,copyVec2(Y.c_velocity.v,v),Y.c_velocity.w=ne}for(var Te=!1,q=0;q<_.positionIterations;++q){for(var Ae=0,ue=0;ue<this.m_contacts.length;++ue){var ae=this.m_contacts[ue],Ie=ae.solvePositionConstraint(_);Ae=math_min$5(Ae,Ie)}for(var Ve=Ae>=-3*SettingsInternal.linearSlop,$e=!0,ue=0;ue<this.m_joints.length;++ue){var le=this.m_joints[ue],We=le.solvePositionConstraints(_);$e=$e&&We}if(Ve&&$e){Te=!0;break}}for(var q=0;q<this.m_bodies.length;++q){var Y=this.m_bodies[q];copyVec2(Y.m_sweep.c,Y.c_position.c),Y.m_sweep.a=Y.c_position.a,copyVec2(Y.m_linearVelocity,Y.c_velocity.v),Y.m_angularVelocity=Y.c_velocity.w,Y.synchronizeTransform()}if(this.postSolveIsland(),W){for(var Ue=1/0,je=SettingsInternal.linearSleepToleranceSqr,ze=SettingsInternal.angularSleepToleranceSqr,q=0;q<this.m_bodies.length;++q){var Y=this.m_bodies[q];Y.isStatic()||(Y.m_autoSleepFlag==!1||Y.m_angularVelocity*Y.m_angularVelocity>ze||lengthSqrVec2(Y.m_linearVelocity)>je?(Y.m_sleepTime=0,Ue=0):(Y.m_sleepTime+=X,Ue=math_min$5(Ue,Y.m_sleepTime)))}if(Ue>=SettingsInternal.timeToSleep&&Te)for(var q=0;q<this.m_bodies.length;++q){var Y=this.m_bodies[q];Y.setAwake(!1)}}},B.prototype.solveWorldTOI=function(_){var T=this.m_world;if(T.m_stepComplete){for(var E=T.m_bodyList;E;E=E.m_next)E.m_islandFlag=!1,E.m_sweep.alpha0=0;for(var W=T.m_contactList;W;W=W.m_next)W.m_toiFlag=!1,W.m_islandFlag=!1,W.m_toiCount=0,W.m_toi=1}for(;;){for(var X=null,q=1,Y=T.m_contactList;Y;Y=Y.m_next)if(Y.isEnabled()!=!1&&!(Y.m_toiCount>SettingsInternal.maxSubSteps)){var te=1;if(Y.m_toiFlag)te=Y.m_toi;else{var ne=Y.getFixtureA(),ae=Y.getFixtureB();if(ne.isSensor()||ae.isSensor())continue;var le=ne.getBody(),ue=ae.getBody(),ge=le.isAwake()&&!le.isStatic(),ye=ue.isAwake()&&!ue.isStatic();if(ge==!1&&ye==!1)continue;var xe=le.isBullet()||!le.isDynamic(),Te=ue.isBullet()||!ue.isDynamic();if(xe==!1&&Te==!1)continue;var Ae=le.m_sweep.alpha0;le.m_sweep.alpha0<ue.m_sweep.alpha0?(Ae=ue.m_sweep.alpha0,le.m_sweep.advance(Ae)):ue.m_sweep.alpha0<le.m_sweep.alpha0&&(Ae=le.m_sweep.alpha0,ue.m_sweep.advance(Ae));var Ie=Y.getChildIndexA(),Ve=Y.getChildIndexB();le.m_sweep,ue.m_sweep,input.proxyA.set(ne.getShape(),Ie),input.proxyB.set(ae.getShape(),Ve),input.sweepA.set(le.m_sweep),input.sweepB.set(ue.m_sweep),input.tMax=1,TimeOfImpact(output,input);var $e=output.t;output.state==TOIOutputState.e_touching?te=math_min$5(Ae+(1-Ae)*$e,1):te=1,Y.m_toi=te,Y.m_toiFlag=!0}te<q&&(X=Y,q=te)}if(X==null||1-10*EPSILON<q){T.m_stepComplete=!0;break}var We=X.getFixtureA(),Ue=X.getFixtureB(),je=We.getBody(),ze=Ue.getBody();if(backup1.set(je.m_sweep),backup2.set(ze.m_sweep),je.advance(q),ze.advance(q),X.update(T),X.m_toiFlag=!1,++X.m_toiCount,X.isEnabled()==!1||X.isTouching()==!1){X.setEnabled(!1),je.m_sweep.set(backup1),ze.m_sweep.set(backup2),je.synchronizeTransform(),ze.synchronizeTransform();continue}je.setAwake(!0),ze.setAwake(!0),this.clear(),this.addBody(je),this.addBody(ze),this.addContact(X),je.m_islandFlag=!0,ze.m_islandFlag=!0,X.m_islandFlag=!0;for(var He=[je,ze],Le=0;Le<He.length;++Le){var qe=He[Le];if(qe.isDynamic())for(var Qe=qe.m_contactList;Qe;Qe=Qe.next){var Ke=Qe.contact;if(!Ke.m_islandFlag){var Je=Qe.other;if(!(Je.isDynamic()&&!qe.isBullet()&&!Je.isBullet())){var pt=Ke.m_fixtureA.m_isSensor,ut=Ke.m_fixtureB.m_isSensor;if(!(pt||ut)){if(backup.set(Je.m_sweep),Je.m_islandFlag==!1&&Je.advance(q),Ke.update(T),Ke.isEnabled()==!1||Ke.isTouching()==!1){Je.m_sweep.set(backup),Je.synchronizeTransform();continue}Ke.m_islandFlag=!0,this.addContact(Ke),!Je.m_islandFlag&&(Je.m_islandFlag=!0,Je.isStatic()||Je.setAwake(!0),this.addBody(Je))}}}}}s_subStep.reset((1-q)*_.dt),s_subStep.dtRatio=1,s_subStep.positionIterations=20,s_subStep.velocityIterations=_.velocityIterations,s_subStep.warmStarting=!1,this.solveIslandTOI(s_subStep,je,ze);for(var Le=0;Le<this.m_bodies.length;++Le){var qe=this.m_bodies[Le];if(qe.m_islandFlag=!1,!!qe.isDynamic()){qe.synchronizeFixtures();for(var Qe=qe.m_contactList;Qe;Qe=Qe.next)Qe.contact.m_toiFlag=!1,Qe.contact.m_islandFlag=!1}}if(T.findNewContacts(),T.m_subStepping){T.m_stepComplete=!1;break}}},B.prototype.solveIslandTOI=function(_,T,E){for(var ae=0;ae<this.m_bodies.length;++ae){var W=this.m_bodies[ae];copyVec2(W.c_position.c,W.m_sweep.c),W.c_position.a=W.m_sweep.a,copyVec2(W.c_velocity.v,W.m_linearVelocity),W.c_velocity.w=W.m_angularVelocity}for(var ae=0;ae<this.m_contacts.length;++ae){var X=this.m_contacts[ae];X.initConstraint(_)}for(var ae=0;ae<_.positionIterations;++ae){for(var q=0,Y=0;Y<this.m_contacts.length;++Y){var X=this.m_contacts[Y],te=X.solvePositionConstraintTOI(_,T,E);q=math_min$5(q,te)}var ne=q>=-1.5*SettingsInternal.linearSlop;if(ne)break}var ae;copyVec2(T.m_sweep.c0,T.c_position.c),T.m_sweep.a0=T.c_position.a,copyVec2(E.m_sweep.c0,E.c_position.c),E.m_sweep.a0=E.c_position.a;for(var ae=0;ae<this.m_contacts.length;++ae){var X=this.m_contacts[ae];X.initVelocityConstraint(_)}for(var ae=0;ae<_.velocityIterations;++ae)for(var Y=0;Y<this.m_contacts.length;++Y){var X=this.m_contacts[Y];X.solveVelocityConstraint(_)}for(var le=_.dt,ae=0;ae<this.m_bodies.length;++ae){var W=this.m_bodies[ae];copyVec2(c,W.c_position.c);var ue=W.c_position.a;copyVec2(v,W.c_velocity.v);var ge=W.c_velocity.w;scaleVec2(translation,le,v);var ye=lengthSqrVec2(translation);if(ye>SettingsInternal.maxTranslationSquared){var xe=SettingsInternal.maxTranslation/math_sqrt$3(ye);mulVec2(v,xe)}var Te=le*ge;if(Te*Te>SettingsInternal.maxRotationSquared){var xe=SettingsInternal.maxRotation/math_abs$6(Te);ge*=xe}plusScaleVec2(c,le,v),ue+=le*ge,copyVec2(W.c_position.c,c),W.c_position.a=ue,copyVec2(W.c_velocity.v,v),W.c_velocity.w=ge,copyVec2(W.m_sweep.c,c),W.m_sweep.a=ue,copyVec2(W.m_linearVelocity,v),W.m_angularVelocity=ge,W.synchronizeTransform()}this.postSolveIsland()},B.prototype.postSolveIsland=function(){for(var _=0;_<this.m_contacts.length;++_){var T=this.m_contacts[_];this.m_world.postSolve(T,T.m_impulse)}},B}();Solver.TimeStep=TimeStep;var Mat22=function(){function B(_,T,E,W){typeof _=="object"&&_!==null?(this.ex=Vec2.clone(_),this.ey=Vec2.clone(T)):typeof _=="number"?(this.ex=Vec2.neo(_,E),this.ey=Vec2.neo(T,W)):(this.ex=Vec2.zero(),this.ey=Vec2.zero())}return B.prototype.toString=function(){return JSON.stringify(this)},B.isValid=function(_){return _===null||typeof _>"u"?!1:Vec2.isValid(_.ex)&&Vec2.isValid(_.ey)},B.assert=function(_){},B.prototype.set=function(_,T,E,W){typeof _=="number"&&typeof T=="number"&&typeof E=="number"&&typeof W=="number"?(this.ex.setNum(_,E),this.ey.setNum(T,W)):typeof _=="object"&&typeof T=="object"?(this.ex.setVec2(_),this.ey.setVec2(T)):typeof _=="object"&&(this.ex.setVec2(_.ex),this.ey.setVec2(_.ey))},B.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},B.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},B.prototype.getInverse=function(){var _=this.ex.x,T=this.ey.x,E=this.ex.y,W=this.ey.y,X=_*W-T*E;X!==0&&(X=1/X);var q=new B;return q.ex.x=X*W,q.ey.x=-X*T,q.ex.y=-X*E,q.ey.y=X*_,q},B.prototype.solve=function(_){var T=this.ex.x,E=this.ey.x,W=this.ex.y,X=this.ey.y,q=T*X-E*W;q!==0&&(q=1/q);var Y=Vec2.zero();return Y.x=q*(X*_.x-E*_.y),Y.y=q*(T*_.y-W*_.x),Y},B.mul=function(_,T){if(T&&"x"in T&&"y"in T){var E=_.ex.x*T.x+_.ey.x*T.y,W=_.ex.y*T.x+_.ey.y*T.y;return Vec2.neo(E,W)}else if(T&&"ex"in T&&"ey"in T){var X=_.ex.x*T.ex.x+_.ey.x*T.ex.y,q=_.ex.x*T.ey.x+_.ey.x*T.ey.y,Y=_.ex.y*T.ex.x+_.ey.y*T.ex.y,te=_.ex.y*T.ey.x+_.ey.y*T.ey.y;return new B(X,q,Y,te)}},B.mulVec2=function(_,T){var E=_.ex.x*T.x+_.ey.x*T.y,W=_.ex.y*T.x+_.ey.y*T.y;return Vec2.neo(E,W)},B.mulMat22=function(_,T){var E=_.ex.x*T.ex.x+_.ey.x*T.ex.y,W=_.ex.x*T.ey.x+_.ey.x*T.ey.y,X=_.ex.y*T.ex.x+_.ey.y*T.ex.y,q=_.ex.y*T.ey.x+_.ey.y*T.ey.y;return new B(E,W,X,q)},B.mulT=function(_,T){if(T&&"x"in T&&"y"in T)return Vec2.neo(Vec2.dot(T,_.ex),Vec2.dot(T,_.ey));if(T&&"ex"in T&&"ey"in T){var E=Vec2.neo(Vec2.dot(_.ex,T.ex),Vec2.dot(_.ey,T.ex)),W=Vec2.neo(Vec2.dot(_.ex,T.ey),Vec2.dot(_.ey,T.ey));return new B(E,W)}},B.mulTVec2=function(_,T){return Vec2.neo(Vec2.dot(T,_.ex),Vec2.dot(T,_.ey))},B.mulTMat22=function(_,T){var E=Vec2.neo(Vec2.dot(_.ex,T.ex),Vec2.dot(_.ey,T.ex)),W=Vec2.neo(Vec2.dot(_.ex,T.ey),Vec2.dot(_.ey,T.ey));return new B(E,W)},B.abs=function(_){return new B(Vec2.abs(_.ex),Vec2.abs(_.ey))},B.add=function(_,T){return new B(Vec2.add(_.ex,T.ex),Vec2.add(_.ey,T.ey))},B}(),math_sqrt$2=Math.sqrt,pointA$1=vec2(0,0),pointB$1=vec2(0,0),temp$3=vec2(0,0),cA$1=vec2(0,0),cB$1=vec2(0,0),dist=vec2(0,0),planePoint$2=vec2(0,0),clipPoint$1=vec2(0,0),ManifoldType;(function(B){B[B.e_unset=-1]="e_unset",B[B.e_circles=0]="e_circles",B[B.e_faceA=1]="e_faceA",B[B.e_faceB=2]="e_faceB"})(ManifoldType||(ManifoldType={}));var ContactFeatureType;(function(B){B[B.e_unset=-1]="e_unset",B[B.e_vertex=0]="e_vertex",B[B.e_face=1]="e_face"})(ContactFeatureType||(ContactFeatureType={}));var PointState;(function(B){B[B.nullState=0]="nullState",B[B.addState=1]="addState",B[B.persistState=2]="persistState",B[B.removeState=3]="removeState"})(PointState||(PointState={}));var ClipVertex=function(){function B(){this.v=vec2(0,0),this.id=new ContactID}return B.prototype.set=function(_){copyVec2(this.v,_.v),this.id.set(_.id)},B.prototype.recycle=function(){zeroVec2(this.v),this.id.recycle()},B}(),Manifold=function(){function B(){this.localNormal=vec2(0,0),this.localPoint=vec2(0,0),this.points=[new ManifoldPoint,new ManifoldPoint],this.pointCount=0}return B.prototype.set=function(_){this.type=_.type,copyVec2(this.localNormal,_.localNormal),copyVec2(this.localPoint,_.localPoint),this.pointCount=_.pointCount,this.points[0].set(_.points[0]),this.points[1].set(_.points[1])},B.prototype.recycle=function(){this.type=ManifoldType.e_unset,zeroVec2(this.localNormal),zeroVec2(this.localPoint),this.pointCount=0,this.points[0].recycle(),this.points[1].recycle()},B.prototype.getWorldManifold=function(_,T,E,W,X){if(this.pointCount==0)return _;_=_||new WorldManifold,_.pointCount=this.pointCount;var q=_.normal,Y=_.points,te=_.separations;switch(this.type){case ManifoldType.e_circles:{setVec2(q,1,0);var ne=this.points[0];transformVec2(pointA$1,T,this.localPoint),transformVec2(pointB$1,W,ne.localPoint),subVec2(dist,pointB$1,pointA$1);var ae=lengthSqrVec2(dist);if(ae>EPSILON*EPSILON){var le=math_sqrt$2(ae);scaleVec2(q,1/le,dist)}combine2Vec2(cA$1,1,pointA$1,E,q),combine2Vec2(cB$1,1,pointB$1,-X,q),combine2Vec2(Y[0],.5,cA$1,.5,cB$1),te[0]=dotVec2(subVec2(temp$3,cB$1,cA$1),q);break}case ManifoldType.e_faceA:{rotVec2(q,T.q,this.localNormal),transformVec2(planePoint$2,T,this.localPoint);for(var ue=0;ue<this.pointCount;++ue){var ne=this.points[ue];transformVec2(clipPoint$1,W,ne.localPoint),combine2Vec2(cA$1,1,clipPoint$1,E-dotVec2(subVec2(temp$3,clipPoint$1,planePoint$2),q),q),combine2Vec2(cB$1,1,clipPoint$1,-X,q),combine2Vec2(Y[ue],.5,cA$1,.5,cB$1),te[ue]=dotVec2(subVec2(temp$3,cB$1,cA$1),q)}break}case ManifoldType.e_faceB:{rotVec2(q,W.q,this.localNormal),transformVec2(planePoint$2,W,this.localPoint);for(var ue=0;ue<this.pointCount;++ue){var ne=this.points[ue];transformVec2(clipPoint$1,T,ne.localPoint),combine2Vec2(cB$1,1,clipPoint$1,X-dotVec2(subVec2(temp$3,clipPoint$1,planePoint$2),q),q),combine2Vec2(cA$1,1,clipPoint$1,-E,q),combine2Vec2(Y[ue],.5,cA$1,.5,cB$1),te[ue]=dotVec2(subVec2(temp$3,cA$1,cB$1),q)}negVec2(q);break}}return _},B.clipSegmentToLine=clipSegmentToLine,B.ClipVertex=ClipVertex,B.getPointStates=getPointStates,B.PointState=PointState,B}(),ManifoldPoint=function(){function B(){this.localPoint=vec2(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.id=new ContactID}return B.prototype.set=function(_){copyVec2(this.localPoint,_.localPoint),this.normalImpulse=_.normalImpulse,this.tangentImpulse=_.tangentImpulse,this.id.set(_.id)},B.prototype.recycle=function(){zeroVec2(this.localPoint),this.normalImpulse=0,this.tangentImpulse=0,this.id.recycle()},B}(),ContactID=function(){function B(){this.key=-1,this.indexA=-1,this.indexB=-1,this.typeA=ContactFeatureType.e_unset,this.typeB=ContactFeatureType.e_unset}return B.prototype.setFeatures=function(_,T,E,W){this.indexA=_,this.indexB=E,this.typeA=T,this.typeB=W,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},B.prototype.set=function(_){this.indexA=_.indexA,this.indexB=_.indexB,this.typeA=_.typeA,this.typeB=_.typeB,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},B.prototype.swapFeatures=function(){var _=this.indexA,T=this.indexB,E=this.typeA,W=this.typeB;this.indexA=T,this.indexB=_,this.typeA=W,this.typeB=E,this.key=this.indexA+this.indexB*4+this.typeA*16+this.typeB*64},B.prototype.recycle=function(){this.indexA=0,this.indexB=0,this.typeA=ContactFeatureType.e_unset,this.typeB=ContactFeatureType.e_unset,this.key=-1},B}(),WorldManifold=function(){function B(){this.normal=vec2(0,0),this.points=[vec2(0,0),vec2(0,0)],this.separations=[0,0],this.pointCount=0}return B.prototype.recycle=function(){zeroVec2(this.normal),zeroVec2(this.points[0]),zeroVec2(this.points[1]),this.separations[0]=0,this.separations[1]=0,this.pointCount=0},B}();function getPointStates(B,_,T,E){for(var W=0;W<T.pointCount;++W){var X=T.points[W].id;B[W]=PointState.removeState;for(var q=0;q<E.pointCount;++q)if(E.points[q].id.key===X.key){B[W]=PointState.persistState;break}}for(var W=0;W<E.pointCount;++W){var X=E.points[W].id;_[W]=PointState.addState;for(var q=0;q<T.pointCount;++q)if(T.points[q].id.key===X.key){_[W]=PointState.persistState;break}}}function clipSegmentToLine(B,_,T,E,W){var X=0,q=dotVec2(T,_[0].v)-E,Y=dotVec2(T,_[1].v)-E;if(q<=0&&B[X++].set(_[0]),Y<=0&&B[X++].set(_[1]),q*Y<0){var te=q/(q-Y);combine2Vec2(B[X].v,1-te,_[0].v,te,_[1].v),B[X].id.setFeatures(W,ContactFeatureType.e_vertex,_[0].id.indexB,ContactFeatureType.e_face),++X}return X}var math_sqrt$1=Math.sqrt,math_max$2=Math.max,math_min$4=Math.min,contactPool=new Pool({create:function(){return new Contact},release:function(B){B.recycle()}}),oldManifold=new Manifold,worldManifold=new WorldManifold,ContactEdge=function(){function B(_){this.prev=null,this.next=null,this.other=null,this.contact=_}return B.prototype.recycle=function(){this.prev=null,this.next=null,this.other=null},B}();function mixFriction(B,_){return math_sqrt$1(B*_)}function mixRestitution(B,_){return B>_?B:_}var s_registers=[],VelocityConstraintPoint=function(){function B(){this.rA=vec2(0,0),this.rB=vec2(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}return B.prototype.recycle=function(){zeroVec2(this.rA),zeroVec2(this.rB),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0},B}(),cA=vec2(0,0),vA=vec2(0,0),cB=vec2(0,0),vB=vec2(0,0),tangent$1=vec2(0,0),xfA=transform(0,0,0),xfB=transform(0,0,0),pointA=vec2(0,0),pointB=vec2(0,0),clipPoint=vec2(0,0),planePoint$1=vec2(0,0),rA=vec2(0,0),rB=vec2(0,0),P$1=vec2(0,0),normal$2=vec2(0,0),point=vec2(0,0),dv=vec2(0,0),dv1=vec2(0,0),dv2=vec2(0,0),b=vec2(0,0),a=vec2(0,0),x=vec2(0,0),d=vec2(0,0),P1=vec2(0,0),P2=vec2(0,0),temp$2=vec2(0,0),Contact=function(){function B(){this.m_nodeA=new ContactEdge(this),this.m_nodeB=new ContactEdge(this),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold=new Manifold,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse=new ContactImpulse(this),this.v_points=[new VelocityConstraintPoint,new VelocityConstraintPoint],this.v_normal=vec2(0,0),this.v_normalMass=new Mat22,this.v_K=new Mat22,this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0,this.p_localPoints=[vec2(0,0),vec2(0,0)],this.p_localNormal=vec2(0,0),this.p_localPoint=vec2(0,0),this.p_localCenterA=vec2(0,0),this.p_localCenterB=vec2(0,0),this.p_type=ManifoldType.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0}return B.prototype.initialize=function(_,T,E,W,X){this.m_fixtureA=_,this.m_fixtureB=E,this.m_indexA=T,this.m_indexB=W,this.m_evaluateFcn=X,this.m_friction=mixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=mixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},B.prototype.recycle=function(){this.m_nodeA.recycle(),this.m_nodeB.recycle(),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold.recycle(),this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse.recycle();for(var _=0,T=this.v_points;_<T.length;_++){var E=T[_];E.recycle()}zeroVec2(this.v_normal),this.v_normalMass.setZero(),this.v_K.setZero(),this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0;for(var W=0,X=this.p_localPoints;W<X.length;W++){var q=X[W];zeroVec2(q)}zeroVec2(this.p_localNormal),zeroVec2(this.p_localPoint),zeroVec2(this.p_localCenterA),zeroVec2(this.p_localCenterB),this.p_type=ManifoldType.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0},B.prototype.initConstraint=function(_){var T=this.m_fixtureA,E=this.m_fixtureB;if(!(T===null||E===null)){var W=T.m_body,X=E.m_body;if(!(W===null||X===null)){var q=T.m_shape,Y=E.m_shape;if(!(q===null||Y===null)){var te=this.m_manifold,ne=te.pointCount;this.v_invMassA=W.m_invMass,this.v_invMassB=X.m_invMass,this.v_invIA=W.m_invI,this.v_invIB=X.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=ne,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=W.m_invMass,this.p_invMassB=X.m_invMass,this.p_invIA=W.m_invI,this.p_invIB=X.m_invI,copyVec2(this.p_localCenterA,W.m_sweep.localCenter),copyVec2(this.p_localCenterB,X.m_sweep.localCenter),this.p_radiusA=q.m_radius,this.p_radiusB=Y.m_radius,this.p_type=te.type,copyVec2(this.p_localNormal,te.localNormal),copyVec2(this.p_localPoint,te.localPoint),this.p_pointCount=ne;for(var ae=0;ae<SettingsInternal.maxManifoldPoints;++ae)this.v_points[ae].recycle(),zeroVec2(this.p_localPoints[ae]);for(var ae=0;ae<ne;++ae){var le=te.points[ae],ue=this.v_points[ae];_.warmStarting&&(ue.normalImpulse=_.dtRatio*le.normalImpulse,ue.tangentImpulse=_.dtRatio*le.tangentImpulse),copyVec2(this.p_localPoints[ae],le.localPoint)}}}}},B.prototype.getManifold=function(){return this.m_manifold},B.prototype.getWorldManifold=function(_){var T=this.m_fixtureA,E=this.m_fixtureB;if(!(T===null||E===null)){var W=T.m_body,X=E.m_body;if(!(W===null||X===null)){var q=T.m_shape,Y=E.m_shape;if(!(q===null||Y===null))return this.m_manifold.getWorldManifold(_,W.getTransform(),q.m_radius,X.getTransform(),Y.m_radius)}}},B.prototype.setEnabled=function(_){this.m_enabledFlag=!!_},B.prototype.isEnabled=function(){return this.m_enabledFlag},B.prototype.isTouching=function(){return this.m_touchingFlag},B.prototype.getNext=function(){return this.m_next},B.prototype.getFixtureA=function(){return this.m_fixtureA},B.prototype.getFixtureB=function(){return this.m_fixtureB},B.prototype.getChildIndexA=function(){return this.m_indexA},B.prototype.getChildIndexB=function(){return this.m_indexB},B.prototype.flagForFiltering=function(){this.m_filterFlag=!0},B.prototype.setFriction=function(_){this.m_friction=_},B.prototype.getFriction=function(){return this.m_friction},B.prototype.resetFriction=function(){var _=this.m_fixtureA,T=this.m_fixtureB;_===null||T===null||(this.m_friction=mixFriction(_.m_friction,T.m_friction))},B.prototype.setRestitution=function(_){this.m_restitution=_},B.prototype.getRestitution=function(){return this.m_restitution},B.prototype.resetRestitution=function(){var _=this.m_fixtureA,T=this.m_fixtureB;_===null||T===null||(this.m_restitution=mixRestitution(_.m_restitution,T.m_restitution))},B.prototype.setTangentSpeed=function(_){this.m_tangentSpeed=_},B.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},B.prototype.evaluate=function(_,T,E){var W=this.m_fixtureA,X=this.m_fixtureB;W===null||X===null||this.m_evaluateFcn(_,T,W,this.m_indexA,E,X,this.m_indexB)},B.prototype.update=function(_){var T=this.m_fixtureA,E=this.m_fixtureB;if(!(T===null||E===null)){var W=T.m_body,X=E.m_body;if(!(W===null||X===null)){var q=T.m_shape,Y=E.m_shape;if(!(q===null||Y===null)){this.m_enabledFlag=!0;var te=!1,ne=this.m_touchingFlag,ae=T.m_isSensor,le=E.m_isSensor,ue=ae||le,ge=W.m_xf,ye=X.m_xf;if(ue)te=testOverlap(q,this.m_indexA,Y,this.m_indexB,ge,ye),this.m_manifold.pointCount=0;else{oldManifold.recycle(),oldManifold.set(this.m_manifold),this.m_manifold.recycle(),this.evaluate(this.m_manifold,ge,ye),te=this.m_manifold.pointCount>0;for(var xe=0;xe<this.m_manifold.pointCount;++xe){var Te=this.m_manifold.points[xe];Te.normalImpulse=0,Te.tangentImpulse=0;for(var Ae=0;Ae<oldManifold.pointCount;++Ae){var Ie=oldManifold.points[Ae];if(Ie.id.key===Te.id.key){Te.normalImpulse=Ie.normalImpulse,Te.tangentImpulse=Ie.tangentImpulse;break}}}te!==ne&&(W.setAwake(!0),X.setAwake(!0))}this.m_touchingFlag=te;var Ve=typeof _=="object"&&_!==null;!ne&&te&&Ve&&_.beginContact(this),ne&&!te&&Ve&&_.endContact(this),!ue&&te&&Ve&&oldManifold&&_.preSolve(this,oldManifold)}}}},B.prototype.solvePositionConstraint=function(_){return this._solvePositionConstraint(_,null,null)},B.prototype.solvePositionConstraintTOI=function(_,T,E){return this._solvePositionConstraint(_,T,E)},B.prototype._solvePositionConstraint=function(_,T,E){var W=T!==null&&E!==null,X=0,q=this.m_fixtureA,Y=this.m_fixtureB;if(q===null||Y===null)return X;var te=q.m_body,ne=Y.m_body;if(te===null||ne===null)return X;te.c_velocity,ne.c_velocity;var ae=te.c_position,le=ne.c_position,ue=this.p_localCenterA,ge=this.p_localCenterB,ye=0,xe=0;(!W||te===T||te===E)&&(ye=this.p_invMassA,xe=this.p_invIA);var Te=0,Ae=0;(!W||ne===T||ne===E)&&(Te=this.p_invMassB,Ae=this.p_invIB),copyVec2(cA,ae.c);var Ie=ae.a;copyVec2(cB,le.c);for(var Ve=le.a,$e=0;$e<this.p_pointCount;++$e){getTransform(xfA,ue,cA,Ie),getTransform(xfB,ge,cB,Ve);var We=void 0;switch(this.p_type){case ManifoldType.e_circles:{transformVec2(pointA,xfA,this.p_localPoint),transformVec2(pointB,xfB,this.p_localPoints[0]),subVec2(normal$2,pointB,pointA),normalizeVec2(normal$2),combine2Vec2(point,.5,pointA,.5,pointB),We=dotVec2(pointB,normal$2)-dotVec2(pointA,normal$2)-this.p_radiusA-this.p_radiusB;break}case ManifoldType.e_faceA:{rotVec2(normal$2,xfA.q,this.p_localNormal),transformVec2(planePoint$1,xfA,this.p_localPoint),transformVec2(clipPoint,xfB,this.p_localPoints[$e]),We=dotVec2(clipPoint,normal$2)-dotVec2(planePoint$1,normal$2)-this.p_radiusA-this.p_radiusB,copyVec2(point,clipPoint);break}case ManifoldType.e_faceB:{rotVec2(normal$2,xfB.q,this.p_localNormal),transformVec2(planePoint$1,xfB,this.p_localPoint),transformVec2(clipPoint,xfA,this.p_localPoints[$e]),We=dotVec2(clipPoint,normal$2)-dotVec2(planePoint$1,normal$2)-this.p_radiusA-this.p_radiusB,copyVec2(point,clipPoint),negVec2(normal$2);break}default:return X}subVec2(rA,point,cA),subVec2(rB,point,cB),X=math_min$4(X,We);var Ue=W?SettingsInternal.toiBaugarte:SettingsInternal.baumgarte,je=SettingsInternal.linearSlop,ze=SettingsInternal.maxLinearCorrection,He=clamp(Ue*(We+je),-ze,0),Le=crossVec2Vec2(rA,normal$2),qe=crossVec2Vec2(rB,normal$2),Qe=ye+Te+xe*Le*Le+Ae*qe*qe,Ke=Qe>0?-He/Qe:0;scaleVec2(P$1,Ke,normal$2),minusScaleVec2(cA,ye,P$1),Ie-=xe*crossVec2Vec2(rA,P$1),plusScaleVec2(cB,Te,P$1),Ve+=Ae*crossVec2Vec2(rB,P$1)}return copyVec2(ae.c,cA),ae.a=Ie,copyVec2(le.c,cB),le.a=Ve,X},B.prototype.initVelocityConstraint=function(_){var T=this.m_fixtureA,E=this.m_fixtureB;if(!(T===null||E===null)){var W=T.m_body,X=E.m_body;if(!(W===null||X===null)){var q=W.c_velocity,Y=X.c_velocity,te=W.c_position,ne=X.c_position,ae=this.p_radiusA,le=this.p_radiusB,ue=this.m_manifold,ge=this.v_invMassA,ye=this.v_invMassB,xe=this.v_invIA,Te=this.v_invIB,Ae=this.p_localCenterA,Ie=this.p_localCenterB;copyVec2(cA,te.c);var Ve=te.a;copyVec2(vA,q.v);var $e=q.w;copyVec2(cB,ne.c);var We=ne.a;copyVec2(vB,Y.v);var Ue=Y.w;getTransform(xfA,Ae,cA,Ve),getTransform(xfB,Ie,cB,We),worldManifold.recycle(),ue.getWorldManifold(worldManifold,xfA,ae,xfB,le),copyVec2(this.v_normal,worldManifold.normal);for(var je=0;je<this.v_pointCount;++je){var ze=this.v_points[je],He=worldManifold.points[je];subVec2(ze.rA,He,cA),subVec2(ze.rB,He,cB);var Le=crossVec2Vec2(ze.rA,this.v_normal),qe=crossVec2Vec2(ze.rB,this.v_normal),Qe=ge+ye+xe*Le*Le+Te*qe*qe;ze.normalMass=Qe>0?1/Qe:0,crossVec2Num(tangent$1,this.v_normal,1);var Ke=crossVec2Vec2(ze.rA,tangent$1),Je=crossVec2Vec2(ze.rB,tangent$1),pt=ge+ye+xe*Ke*Ke+Te*Je*Je;ze.tangentMass=pt>0?1/pt:0,ze.velocityBias=0;var ut=0;ut+=dotVec2(this.v_normal,vB),ut+=dotVec2(this.v_normal,crossNumVec2(temp$2,Ue,ze.rB)),ut-=dotVec2(this.v_normal,vA),ut-=dotVec2(this.v_normal,crossNumVec2(temp$2,$e,ze.rA)),ut<-SettingsInternal.velocityThreshold&&(ze.velocityBias=-this.v_restitution*ut)}if(this.v_pointCount==2&&_.blockSolve){var lt=this.v_points[0],st=this.v_points[1],sr=crossVec2Vec2(lt.rA,this.v_normal),mt=crossVec2Vec2(lt.rB,this.v_normal),Tr=crossVec2Vec2(st.rA,this.v_normal),di=crossVec2Vec2(st.rB,this.v_normal),Mi=ge+ye+xe*sr*sr+Te*mt*mt,Gr=ge+ye+xe*Tr*Tr+Te*di*di,ci=ge+ye+xe*sr*Tr+Te*mt*di,gi=1e3;if(Mi*Mi<gi*(Mi*Gr-ci*ci)){this.v_K.ex.setNum(Mi,ci),this.v_K.ey.setNum(ci,Gr);var fi=this.v_K.ex.x,ri=this.v_K.ey.x,ot=this.v_K.ex.y,rt=this.v_K.ey.y,gt=fi*rt-ri*ot;gt!==0&&(gt=1/gt),this.v_normalMass.ex.x=gt*rt,this.v_normalMass.ey.x=-gt*ri,this.v_normalMass.ex.y=-gt*ot,this.v_normalMass.ey.y=gt*fi}else this.v_pointCount=1}copyVec2(te.c,cA),te.a=Ve,copyVec2(q.v,vA),q.w=$e,copyVec2(ne.c,cB),ne.a=We,copyVec2(Y.v,vB),Y.w=Ue}}},B.prototype.warmStartConstraint=function(_){var T=this.m_fixtureA,E=this.m_fixtureB;if(!(T===null||E===null)){var W=T.m_body,X=E.m_body;if(!(W===null||X===null)){var q=W.c_velocity,Y=X.c_velocity;W.c_position,X.c_position;var te=this.v_invMassA,ne=this.v_invIA,ae=this.v_invMassB,le=this.v_invIB;copyVec2(vA,q.v);var ue=q.w;copyVec2(vB,Y.v);var ge=Y.w;copyVec2(normal$2,this.v_normal),crossVec2Num(tangent$1,normal$2,1);for(var ye=0;ye<this.v_pointCount;++ye){var xe=this.v_points[ye];combine2Vec2(P$1,xe.normalImpulse,normal$2,xe.tangentImpulse,tangent$1),ue-=ne*crossVec2Vec2(xe.rA,P$1),minusScaleVec2(vA,te,P$1),ge+=le*crossVec2Vec2(xe.rB,P$1),plusScaleVec2(vB,ae,P$1)}copyVec2(q.v,vA),q.w=ue,copyVec2(Y.v,vB),Y.w=ge}}},B.prototype.storeConstraintImpulses=function(_){for(var T=this.m_manifold,E=0;E<this.v_pointCount;++E)T.points[E].normalImpulse=this.v_points[E].normalImpulse,T.points[E].tangentImpulse=this.v_points[E].tangentImpulse},B.prototype.solveVelocityConstraint=function(_){var T=this.m_fixtureA,E=this.m_fixtureB;if(!(T===null||E===null)){var W=T.m_body,X=E.m_body;if(!(W===null||X===null)){var q=W.c_velocity;W.c_position;var Y=X.c_velocity;X.c_position;var te=this.v_invMassA,ne=this.v_invIA,ae=this.v_invMassB,le=this.v_invIB;copyVec2(vA,q.v);var ue=q.w;copyVec2(vB,Y.v);var ge=Y.w;copyVec2(normal$2,this.v_normal),crossVec2Num(tangent$1,normal$2,1);for(var ye=this.v_friction,xe=0;xe<this.v_pointCount;++xe){var Te=this.v_points[xe];zeroVec2(dv),plusVec2(dv,vB),plusVec2(dv,crossNumVec2(temp$2,ge,Te.rB)),minusVec2(dv,vA),minusVec2(dv,crossNumVec2(temp$2,ue,Te.rA));var Ae=dotVec2(dv,tangent$1)-this.v_tangentSpeed,Ie=Te.tangentMass*-Ae,Ve=ye*Te.normalImpulse,$e=clamp(Te.tangentImpulse+Ie,-Ve,Ve);Ie=$e-Te.tangentImpulse,Te.tangentImpulse=$e,scaleVec2(P$1,Ie,tangent$1),minusScaleVec2(vA,te,P$1),ue-=ne*crossVec2Vec2(Te.rA,P$1),plusScaleVec2(vB,ae,P$1),ge+=le*crossVec2Vec2(Te.rB,P$1)}if(this.v_pointCount==1||_.blockSolve==!1)for(var We=0;We<this.v_pointCount;++We){var Te=this.v_points[We];zeroVec2(dv),plusVec2(dv,vB),plusVec2(dv,crossNumVec2(temp$2,ge,Te.rB)),minusVec2(dv,vA),minusVec2(dv,crossNumVec2(temp$2,ue,Te.rA));var Ue=dotVec2(dv,normal$2),Ie=-Te.normalMass*(Ue-Te.velocityBias),$e=math_max$2(Te.normalImpulse+Ie,0);Ie=$e-Te.normalImpulse,Te.normalImpulse=$e,scaleVec2(P$1,Ie,normal$2),minusScaleVec2(vA,te,P$1),ue-=ne*crossVec2Vec2(Te.rA,P$1),plusScaleVec2(vB,ae,P$1),ge+=le*crossVec2Vec2(Te.rB,P$1)}else{var je=this.v_points[0],ze=this.v_points[1];setVec2(a,je.normalImpulse,ze.normalImpulse),zeroVec2(dv1),plusVec2(dv1,vB),plusVec2(dv1,crossNumVec2(temp$2,ge,je.rB)),minusVec2(dv1,vA),minusVec2(dv1,crossNumVec2(temp$2,ue,je.rA)),zeroVec2(dv2),plusVec2(dv2,vB),plusVec2(dv2,crossNumVec2(temp$2,ge,ze.rB)),minusVec2(dv2,vA),minusVec2(dv2,crossNumVec2(temp$2,ue,ze.rA));var He=dotVec2(dv1,normal$2),Le=dotVec2(dv2,normal$2);for(setVec2(b,He-je.velocityBias,Le-ze.velocityBias),b.x-=this.v_K.ex.x*a.x+this.v_K.ey.x*a.y,b.y-=this.v_K.ex.y*a.x+this.v_K.ey.y*a.y;;){if(zeroVec2(x),x.x=-(this.v_normalMass.ex.x*b.x+this.v_normalMass.ey.x*b.y),x.y=-(this.v_normalMass.ex.y*b.x+this.v_normalMass.ey.y*b.y),x.x>=0&&x.y>=0){subVec2(d,x,a),scaleVec2(P1,d.x,normal$2),scaleVec2(P2,d.y,normal$2),combine3Vec2(vA,-te,P1,-te,P2,1,vA),ue-=ne*(crossVec2Vec2(je.rA,P1)+crossVec2Vec2(ze.rA,P2)),combine3Vec2(vB,ae,P1,ae,P2,1,vB),ge+=le*(crossVec2Vec2(je.rB,P1)+crossVec2Vec2(ze.rB,P2)),je.normalImpulse=x.x,ze.normalImpulse=x.y;break}if(x.x=-je.normalMass*b.x,x.y=0,He=0,Le=this.v_K.ex.y*x.x+b.y,x.x>=0&&Le>=0){subVec2(d,x,a),scaleVec2(P1,d.x,normal$2),scaleVec2(P2,d.y,normal$2),combine3Vec2(vA,-te,P1,-te,P2,1,vA),ue-=ne*(crossVec2Vec2(je.rA,P1)+crossVec2Vec2(ze.rA,P2)),combine3Vec2(vB,ae,P1,ae,P2,1,vB),ge+=le*(crossVec2Vec2(je.rB,P1)+crossVec2Vec2(ze.rB,P2)),je.normalImpulse=x.x,ze.normalImpulse=x.y;break}if(x.x=0,x.y=-ze.normalMass*b.y,He=this.v_K.ey.x*x.y+b.x,Le=0,x.y>=0&&He>=0){subVec2(d,x,a),scaleVec2(P1,d.x,normal$2),scaleVec2(P2,d.y,normal$2),combine3Vec2(vA,-te,P1,-te,P2,1,vA),ue-=ne*(crossVec2Vec2(je.rA,P1)+crossVec2Vec2(ze.rA,P2)),combine3Vec2(vB,ae,P1,ae,P2,1,vB),ge+=le*(crossVec2Vec2(je.rB,P1)+crossVec2Vec2(ze.rB,P2)),je.normalImpulse=x.x,ze.normalImpulse=x.y;break}if(x.x=0,x.y=0,He=b.x,Le=b.y,He>=0&&Le>=0){subVec2(d,x,a),scaleVec2(P1,d.x,normal$2),scaleVec2(P2,d.y,normal$2),combine3Vec2(vA,-te,P1,-te,P2,1,vA),ue-=ne*(crossVec2Vec2(je.rA,P1)+crossVec2Vec2(ze.rA,P2)),combine3Vec2(vB,ae,P1,ae,P2,1,vB),ge+=le*(crossVec2Vec2(je.rB,P1)+crossVec2Vec2(ze.rB,P2)),je.normalImpulse=x.x,ze.normalImpulse=x.y;break}break}}copyVec2(q.v,vA),q.w=ue,copyVec2(Y.v,vB),Y.w=ge}}},B.addType=function(_,T,E){s_registers[_]=s_registers[_]||{},s_registers[_][T]=E},B.create=function(_,T,E,W){var X=_.m_shape.m_type,q=E.m_shape.m_type,Y=contactPool.allocate(),te;if(te=s_registers[X]&&s_registers[X][q])Y.initialize(_,T,E,W,te);else if(te=s_registers[q]&&s_registers[q][X])Y.initialize(E,W,_,T,te);else return null;_=Y.m_fixtureA,E=Y.m_fixtureB,T=Y.getChildIndexA(),W=Y.getChildIndexB();var ne=_.m_body,ae=E.m_body;return Y.m_nodeA.contact=Y,Y.m_nodeA.other=ae,Y.m_nodeA.prev=null,Y.m_nodeA.next=ne.m_contactList,ne.m_contactList!=null&&(ne.m_contactList.prev=Y.m_nodeA),ne.m_contactList=Y.m_nodeA,Y.m_nodeB.contact=Y,Y.m_nodeB.other=ne,Y.m_nodeB.prev=null,Y.m_nodeB.next=ae.m_contactList,ae.m_contactList!=null&&(ae.m_contactList.prev=Y.m_nodeB),ae.m_contactList=Y.m_nodeB,_.isSensor()==!1&&E.isSensor()==!1&&(ne.setAwake(!0),ae.setAwake(!0)),Y},B.destroy=function(_,T){var E=_.m_fixtureA,W=_.m_fixtureB;if(!(E===null||W===null)){var X=E.m_body,q=W.m_body;X===null||q===null||(_.isTouching()&&T.endContact(_),_.m_nodeA.prev&&(_.m_nodeA.prev.next=_.m_nodeA.next),_.m_nodeA.next&&(_.m_nodeA.next.prev=_.m_nodeA.prev),_.m_nodeA==X.m_contactList&&(X.m_contactList=_.m_nodeA.next),_.m_nodeB.prev&&(_.m_nodeB.prev.next=_.m_nodeB.next),_.m_nodeB.next&&(_.m_nodeB.next.prev=_.m_nodeB.prev),_.m_nodeB==q.m_contactList&&(q.m_contactList=_.m_nodeB.next),_.m_manifold.pointCount>0&&!E.m_isSensor&&!W.m_isSensor&&(X.setAwake(!0),q.setAwake(!0)),contactPool.release(_))}},B}(),DEFAULTS$b={gravity:Vec2.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3},World=function(){function B(_){if(!(this instanceof B))return new B(_);this.s_step=new TimeStep,_?Vec2.isValid(_)&&(_={gravity:_}):_={},_=options(_,DEFAULTS$b),this.m_solver=new Solver(this),this.m_broadPhase=new BroadPhase,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=_.allowSleep,this.m_gravity=Vec2.clone(_.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=_.warmStarting,this.m_continuousPhysics=_.continuousPhysics,this.m_subStepping=_.subStepping,this.m_blockSolve=_.blockSolve,this.m_velocityIterations=_.velocityIterations,this.m_positionIterations=_.positionIterations,this.m_t=0,this.m_step_callback=[]}return B.prototype._serialize=function(){for(var _=[],T=[],E=this.getBodyList();E;E=E.getNext())_.push(E);for(var W=this.getJointList();W;W=W.getNext())typeof W._serialize=="function"&&T.push(W);return{gravity:this.m_gravity,bodies:_,joints:T}},B._deserialize=function(_,T,E){if(!_)return new B;var W=new B(_.gravity);if(_.bodies)for(var X=_.bodies.length-1;X>=0;X-=1)W._addBody(E(Body,_.bodies[X],W));if(_.joints)for(var X=_.joints.length-1;X>=0;X--)W.createJoint(E(Joint,_.joints[X],W));return W},B.prototype.getBodyList=function(){return this.m_bodyList},B.prototype.getJointList=function(){return this.m_jointList},B.prototype.getContactList=function(){return this.m_contactList},B.prototype.getBodyCount=function(){return this.m_bodyCount},B.prototype.getJointCount=function(){return this.m_jointCount},B.prototype.getContactCount=function(){return this.m_contactCount},B.prototype.setGravity=function(_){this.m_gravity.set(_)},B.prototype.getGravity=function(){return this.m_gravity},B.prototype.isLocked=function(){return this.m_locked},B.prototype.setAllowSleeping=function(_){if(_!=this.m_allowSleep&&(this.m_allowSleep=_,this.m_allowSleep==!1))for(var T=this.m_bodyList;T;T=T.m_next)T.setAwake(!0)},B.prototype.getAllowSleeping=function(){return this.m_allowSleep},B.prototype.setWarmStarting=function(_){this.m_warmStarting=_},B.prototype.getWarmStarting=function(){return this.m_warmStarting},B.prototype.setContinuousPhysics=function(_){this.m_continuousPhysics=_},B.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},B.prototype.setSubStepping=function(_){this.m_subStepping=_},B.prototype.getSubStepping=function(){return this.m_subStepping},B.prototype.setAutoClearForces=function(_){this.m_clearForces=_},B.prototype.getAutoClearForces=function(){return this.m_clearForces},B.prototype.clearForces=function(){for(var _=this.m_bodyList;_;_=_.getNext())_.m_force.setZero(),_.m_torque=0},B.prototype.queryAABB=function(_,T){var E=this.m_broadPhase;this.m_broadPhase.query(_,function(W){var X=E.getUserData(W);return T(X.fixture)})},B.prototype.rayCast=function(_,T,E){var W=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:_,p2:T},function(X,q){var Y=W.getUserData(q),te=Y.fixture,ne=Y.childIndex,ae={},le=te.rayCast(ae,X,ne);if(le){var ue=ae.fraction,ge=Vec2.add(Vec2.mulNumVec2(1-ue,X.p1),Vec2.mulNumVec2(ue,X.p2));return E(te,ge,ae.normal,ue)}return X.maxFraction})},B.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},B.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},B.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},B.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},B.prototype.shiftOrigin=function(_){if(!this.isLocked()){for(var T=this.m_bodyList;T;T=T.m_next)T.m_xf.p.sub(_),T.m_sweep.c0.sub(_),T.m_sweep.c.sub(_);for(var E=this.m_jointList;E;E=E.m_next)E.shiftOrigin(_);this.m_broadPhase.shiftOrigin(_)}},B.prototype._addBody=function(_){this.isLocked()||(_.m_prev=null,_.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=_),this.m_bodyList=_,++this.m_bodyCount)},B.prototype.createBody=function(_,T){if(this.isLocked())return null;var E={};_&&(Vec2.isValid(_)?E={position:_,angle:T}:typeof _=="object"&&(E=_));var W=new Body(this,E);return this._addBody(W),W},B.prototype.createDynamicBody=function(_,T){var E={};return _&&(Vec2.isValid(_)?E={position:_,angle:T}:typeof _=="object"&&(E=_)),E.type="dynamic",this.createBody(E)},B.prototype.createKinematicBody=function(_,T){var E={};return _&&(Vec2.isValid(_)?E={position:_,angle:T}:typeof _=="object"&&(E=_)),E.type="kinematic",this.createBody(E)},B.prototype.destroyBody=function(_){if(!this.isLocked()){if(_.m_destroyed)return!1;for(var T=_.m_jointList;T;){var E=T;T=T.next,this.publish("remove-joint",E.joint),this.destroyJoint(E.joint),_.m_jointList=T}_.m_jointList=null;for(var W=_.m_contactList;W;){var X=W;W=W.next,this.destroyContact(X.contact),_.m_contactList=W}_.m_contactList=null;for(var q=_.m_fixtureList;q;){var Y=q;q=q.m_next,this.publish("remove-fixture",Y),Y.destroyProxies(this.m_broadPhase),_.m_fixtureList=q}return _.m_fixtureList=null,_.m_prev&&(_.m_prev.m_next=_.m_next),_.m_next&&(_.m_next.m_prev=_.m_prev),_==this.m_bodyList&&(this.m_bodyList=_.m_next),_.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",_),!0}},B.prototype.createJoint=function(_){if(this.isLocked())return null;if(_.m_prev=null,_.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=_),this.m_jointList=_,++this.m_jointCount,_.m_edgeA.joint=_,_.m_edgeA.other=_.m_bodyB,_.m_edgeA.prev=null,_.m_edgeA.next=_.m_bodyA.m_jointList,_.m_bodyA.m_jointList&&(_.m_bodyA.m_jointList.prev=_.m_edgeA),_.m_bodyA.m_jointList=_.m_edgeA,_.m_edgeB.joint=_,_.m_edgeB.other=_.m_bodyA,_.m_edgeB.prev=null,_.m_edgeB.next=_.m_bodyB.m_jointList,_.m_bodyB.m_jointList&&(_.m_bodyB.m_jointList.prev=_.m_edgeB),_.m_bodyB.m_jointList=_.m_edgeB,_.m_collideConnected==!1)for(var T=_.m_bodyB.getContactList();T;T=T.next)T.other==_.m_bodyA&&T.contact.flagForFiltering();return _},B.prototype.destroyJoint=function(_){if(!this.isLocked()){_.m_prev&&(_.m_prev.m_next=_.m_next),_.m_next&&(_.m_next.m_prev=_.m_prev),_==this.m_jointList&&(this.m_jointList=_.m_next);var T=_.m_bodyA,E=_.m_bodyB;if(T.setAwake(!0),E.setAwake(!0),_.m_edgeA.prev&&(_.m_edgeA.prev.next=_.m_edgeA.next),_.m_edgeA.next&&(_.m_edgeA.next.prev=_.m_edgeA.prev),_.m_edgeA==T.m_jointList&&(T.m_jointList=_.m_edgeA.next),_.m_edgeA.prev=null,_.m_edgeA.next=null,_.m_edgeB.prev&&(_.m_edgeB.prev.next=_.m_edgeB.next),_.m_edgeB.next&&(_.m_edgeB.next.prev=_.m_edgeB.prev),_.m_edgeB==E.m_jointList&&(E.m_jointList=_.m_edgeB.next),_.m_edgeB.prev=null,_.m_edgeB.next=null,--this.m_jointCount,_.m_collideConnected==!1)for(var W=E.getContactList();W;)W.other==T&&W.contact.flagForFiltering(),W=W.next;this.publish("remove-joint",_)}},B.prototype.step=function(_,T,E){if(this.publish("pre-step",_),(T|0)!==T&&(T=0),T=T||this.m_velocityIterations,E=E||this.m_positionIterations,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,this.s_step.reset(_),this.s_step.velocityIterations=T,this.s_step.positionIterations=E,this.s_step.warmStarting=this.m_warmStarting,this.s_step.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&_>0){this.m_solver.solveWorld(this.s_step);for(var W=this.m_bodyList;W;W=W.getNext())W.m_islandFlag!=!1&&(W.isStatic()||W.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&_>0&&this.m_solver.solveWorldTOI(this.s_step),this.m_clearForces&&this.clearForces(),this.m_locked=!1;for(var X;X=this.m_step_callback.shift();)X(this);this.publish("post-step",_)},B.prototype.queueUpdate=function(_){this.isLocked()?this.m_step_callback.push(_):_(this)},B.prototype.findNewContacts=function(){var _=this;this.m_broadPhase.updatePairs(function(T,E){return _.createContact(T,E)})},B.prototype.createContact=function(_,T){var E=_.fixture,W=T.fixture,X=_.childIndex,q=T.childIndex,Y=E.getBody(),te=W.getBody();if(Y!=te){for(var ne=te.getContactList();ne;){if(ne.other==Y){var ae=ne.contact.getFixtureA(),le=ne.contact.getFixtureB(),ue=ne.contact.getChildIndexA(),ge=ne.contact.getChildIndexB();if(ae==E&&le==W&&ue==X&&ge==q||ae==W&&le==E&&ue==q&&ge==X)return}ne=ne.next}if(te.shouldCollide(Y)!=!1&&W.shouldCollide(E)!=!1){var ye=Contact.create(E,X,W,q);ye!=null&&(ye.m_prev=null,this.m_contactList!=null&&(ye.m_next=this.m_contactList,this.m_contactList.m_prev=ye),this.m_contactList=ye,++this.m_contactCount)}}},B.prototype.updateContacts=function(){for(var _,T=this.m_contactList;_=T;){T=_.getNext();var E=_.getFixtureA(),W=_.getFixtureB(),X=_.getChildIndexA(),q=_.getChildIndexB(),Y=E.getBody(),te=W.getBody();if(_.m_filterFlag){if(te.shouldCollide(Y)==!1){this.destroyContact(_);continue}if(W.shouldCollide(E)==!1){this.destroyContact(_);continue}_.m_filterFlag=!1}var ne=Y.isAwake()&&!Y.isStatic(),ae=te.isAwake()&&!te.isStatic();if(!(ne==!1&&ae==!1)){var le=E.m_proxies[X].proxyId,ue=W.m_proxies[q].proxyId,ge=this.m_broadPhase.testOverlap(le,ue);if(ge==!1){this.destroyContact(_);continue}_.update(this)}}},B.prototype.destroyContact=function(_){_.m_prev&&(_.m_prev.m_next=_.m_next),_.m_next&&(_.m_next.m_prev=_.m_prev),_==this.m_contactList&&(this.m_contactList=_.m_next),Contact.destroy(_,this),--this.m_contactCount},B.prototype.on=function(_,T){return typeof _!="string"||typeof T!="function"?this:(this._listeners||(this._listeners={}),this._listeners[_]||(this._listeners[_]=[]),this._listeners[_].push(T),this)},B.prototype.off=function(_,T){if(typeof _!="string"||typeof T!="function")return this;var E=this._listeners&&this._listeners[_];if(!E||!E.length)return this;var W=E.indexOf(T);return W>=0&&E.splice(W,1),this},B.prototype.publish=function(_,T,E,W){var X=this._listeners&&this._listeners[_];if(!X||!X.length)return 0;for(var q=0;q<X.length;q++)X[q].call(this,T,E,W);return X.length},B.prototype.beginContact=function(_){this.publish("begin-contact",_)},B.prototype.endContact=function(_){this.publish("end-contact",_)},B.prototype.preSolve=function(_,T){this.publish("pre-solve",_,T)},B.prototype.postSolve=function(_,T){this.publish("post-solve",_,T)},B}(),Vec3=function(){function B(_,T,E){if(!(this instanceof B))return new B(_,T,E);typeof _>"u"?(this.x=0,this.y=0,this.z=0):typeof _=="object"?(this.x=_.x,this.y=_.y,this.z=_.z):(this.x=_,this.y=T,this.z=E)}return B.prototype._serialize=function(){return{x:this.x,y:this.y,z:this.z}},B._deserialize=function(_){var T=Object.create(B.prototype);return T.x=_.x,T.y=_.y,T.z=_.z,T},B.neo=function(_,T,E){var W=Object.create(B.prototype);return W.x=_,W.y=T,W.z=E,W},B.zero=function(){var _=Object.create(B.prototype);return _.x=0,_.y=0,_.z=0,_},B.clone=function(_){return B.neo(_.x,_.y,_.z)},B.prototype.toString=function(){return JSON.stringify(this)},B.isValid=function(_){return _===null||typeof _>"u"?!1:Number.isFinite(_.x)&&Number.isFinite(_.y)&&Number.isFinite(_.z)},B.assert=function(_){},B.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},B.prototype.set=function(_,T,E){return this.x=_,this.y=T,this.z=E,this},B.prototype.add=function(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this},B.prototype.sub=function(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this},B.prototype.mul=function(_){return this.x*=_,this.y*=_,this.z*=_,this},B.areEqual=function(_,T){return _===T||typeof _=="object"&&_!==null&&typeof T=="object"&&T!==null&&_.x===T.x&&_.y===T.y&&_.z===T.z},B.dot=function(_,T){return _.x*T.x+_.y*T.y+_.z*T.z},B.cross=function(_,T){return new B(_.y*T.z-_.z*T.y,_.z*T.x-_.x*T.z,_.x*T.y-_.y*T.x)},B.add=function(_,T){return new B(_.x+T.x,_.y+T.y,_.z+T.z)},B.sub=function(_,T){return new B(_.x-T.x,_.y-T.y,_.z-T.z)},B.mul=function(_,T){return new B(T*_.x,T*_.y,T*_.z)},B.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},B.neg=function(_){return new B(-_.x,-_.y,-_.z)},B}(),v1$2=vec2(0,0),v2$1=vec2(0,0),EdgeShape=function(B){__extends(_,B);function _(T,E){var W=this;return W instanceof _?(W=B.call(this)||this,W.m_type=_.TYPE,W.m_radius=SettingsInternal.polygonRadius,W.m_vertex1=T?Vec2.clone(T):Vec2.zero(),W.m_vertex2=E?Vec2.clone(E):Vec2.zero(),W.m_vertex0=Vec2.zero(),W.m_vertex3=Vec2.zero(),W.m_hasVertex0=!1,W.m_hasVertex3=!1,W):new _(T,E)}return _.prototype._serialize=function(){return{type:this.m_type,vertex1:this.m_vertex1,vertex2:this.m_vertex2,vertex0:this.m_vertex0,vertex3:this.m_vertex3,hasVertex0:this.m_hasVertex0,hasVertex3:this.m_hasVertex3}},_._deserialize=function(T){var E=new _(T.vertex1,T.vertex2);return E.m_hasVertex0&&E.setPrevVertex(T.vertex0),E.m_hasVertex3&&E.setNextVertex(T.vertex3),E},_.prototype._reset=function(){},_.prototype.getRadius=function(){return this.m_radius},_.prototype.getType=function(){return this.m_type},_.prototype.setNext=function(T){return this.setNextVertex(T)},_.prototype.setNextVertex=function(T){return T?(this.m_vertex3.setVec2(T),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},_.prototype.getNextVertex=function(){return this.m_vertex3},_.prototype.setPrev=function(T){return this.setPrevVertex(T)},_.prototype.setPrevVertex=function(T){return T?(this.m_vertex0.setVec2(T),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},_.prototype.getPrevVertex=function(){return this.m_vertex0},_.prototype._set=function(T,E){return this.m_vertex1.setVec2(T),this.m_vertex2.setVec2(E),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},_.prototype._clone=function(){var T=new _;return T.m_type=this.m_type,T.m_radius=this.m_radius,T.m_vertex1.setVec2(this.m_vertex1),T.m_vertex2.setVec2(this.m_vertex2),T.m_vertex0.setVec2(this.m_vertex0),T.m_vertex3.setVec2(this.m_vertex3),T.m_hasVertex0=this.m_hasVertex0,T.m_hasVertex3=this.m_hasVertex3,T},_.prototype.getChildCount=function(){return 1},_.prototype.testPoint=function(T,E){return!1},_.prototype.rayCast=function(T,E,W,X){var q=Rot.mulTVec2(W.q,Vec2.sub(E.p1,W.p)),Y=Rot.mulTVec2(W.q,Vec2.sub(E.p2,W.p)),te=Vec2.sub(Y,q),ne=this.m_vertex1,ae=this.m_vertex2,le=Vec2.sub(ae,ne),ue=Vec2.neo(le.y,-le.x);ue.normalize();var ge=Vec2.dot(ue,Vec2.sub(ne,q)),ye=Vec2.dot(ue,te);if(ye==0)return!1;var xe=ge/ye;if(xe<0||E.maxFraction<xe)return!1;var Te=Vec2.add(q,Vec2.mulNumVec2(xe,te)),Ae=Vec2.sub(ae,ne),Ie=Vec2.dot(Ae,Ae);if(Ie==0)return!1;var Ve=Vec2.dot(Vec2.sub(Te,ne),Ae)/Ie;return Ve<0||1<Ve?!1:(T.fraction=xe,ge>0?T.normal=Rot.mulVec2(W.q,ue).neg():T.normal=Rot.mulVec2(W.q,ue),!0)},_.prototype.computeAABB=function(T,E,W){transformVec2(v1$2,E,this.m_vertex1),transformVec2(v2$1,E,this.m_vertex2),AABB.combinePoints(T,v1$2,v2$1),AABB.extend(T,this.m_radius)},_.prototype.computeMass=function(T,E){T.mass=0,combine2Vec2(T.center,.5,this.m_vertex1,.5,this.m_vertex2),T.I=0},_.prototype.computeDistanceProxy=function(T){T.m_vertices[0]=this.m_vertex1,T.m_vertices[1]=this.m_vertex2,T.m_vertices.length=2,T.m_count=2,T.m_radius=this.m_radius},_.TYPE="edge",_}(Shape),Edge=EdgeShape,v1$1=vec2(0,0),v2=vec2(0,0),ChainShape=function(B){__extends(_,B);function _(T,E){var W=this;return W instanceof _?(W=B.call(this)||this,W.m_type=_.TYPE,W.m_radius=SettingsInternal.polygonRadius,W.m_vertices=[],W.m_count=0,W.m_prevVertex=null,W.m_nextVertex=null,W.m_hasPrevVertex=!1,W.m_hasNextVertex=!1,W.m_isLoop=!!E,T&&T.length&&(E?W._createLoop(T):W._createChain(T)),W):new _(T,E)}return _.prototype._serialize=function(){var T={type:this.m_type,vertices:this.m_isLoop?this.m_vertices.slice(0,this.m_vertices.length-1):this.m_vertices,isLoop:this.m_isLoop,hasPrevVertex:this.m_hasPrevVertex,hasNextVertex:this.m_hasNextVertex,prevVertex:null,nextVertex:null};return this.m_prevVertex&&(T.prevVertex=this.m_prevVertex),this.m_nextVertex&&(T.nextVertex=this.m_nextVertex),T},_._deserialize=function(T,E,W){var X=[];if(T.vertices)for(var q=0;q<T.vertices.length;q++)X.push(W(Vec2,T.vertices[q]));var Y=new _(X,T.isLoop);return T.prevVertex&&Y.setPrevVertex(T.prevVertex),T.nextVertex&&Y.setNextVertex(T.nextVertex),Y},_.prototype.getType=function(){return this.m_type},_.prototype.getRadius=function(){return this.m_radius},_.prototype._createLoop=function(T){if(!(T.length<3)){for(var E=1;E<T.length;++E)T[E-1],T[E];this.m_vertices=[],this.m_count=T.length+1;for(var E=0;E<T.length;++E)this.m_vertices[E]=Vec2.clone(T[E]);return this.m_vertices[T.length]=Vec2.clone(T[0]),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this}},_.prototype._createChain=function(T){for(var E=1;E<T.length;++E)T[E-1],T[E];this.m_vertices=[],this.m_count=T.length;for(var E=0;E<T.length;++E)this.m_vertices[E]=Vec2.clone(T[E]);return this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this},_.prototype._reset=function(){this.m_isLoop?this._createLoop(this.m_vertices.slice(0,this.m_vertices.length-1)):this._createChain(this.m_vertices)},_.prototype.setPrevVertex=function(T){this.m_prevVertex=T,this.m_hasPrevVertex=!0},_.prototype.getPrevVertex=function(){return this.m_prevVertex},_.prototype.setNextVertex=function(T){this.m_nextVertex=T,this.m_hasNextVertex=!0},_.prototype.getNextVertex=function(){return this.m_nextVertex},_.prototype._clone=function(){var T=new _;return T._createChain(this.m_vertices),T.m_type=this.m_type,T.m_radius=this.m_radius,T.m_prevVertex=this.m_prevVertex,T.m_nextVertex=this.m_nextVertex,T.m_hasPrevVertex=this.m_hasPrevVertex,T.m_hasNextVertex=this.m_hasNextVertex,T},_.prototype.getChildCount=function(){return this.m_count-1},_.prototype.getChildEdge=function(T,E){T.m_type=EdgeShape.TYPE,T.m_radius=this.m_radius,T.m_vertex1=this.m_vertices[E],T.m_vertex2=this.m_vertices[E+1],E>0?(T.m_vertex0=this.m_vertices[E-1],T.m_hasVertex0=!0):(T.m_vertex0=this.m_prevVertex,T.m_hasVertex0=this.m_hasPrevVertex),E<this.m_count-2?(T.m_vertex3=this.m_vertices[E+2],T.m_hasVertex3=!0):(T.m_vertex3=this.m_nextVertex,T.m_hasVertex3=this.m_hasNextVertex)},_.prototype.getVertex=function(T){return T<this.m_count?this.m_vertices[T]:this.m_vertices[0]},_.prototype.isLoop=function(){return this.m_isLoop},_.prototype.testPoint=function(T,E){return!1},_.prototype.rayCast=function(T,E,W,X){var q=new EdgeShape(this.getVertex(X),this.getVertex(X+1));return q.rayCast(T,E,W,0)},_.prototype.computeAABB=function(T,E,W){transformVec2(v1$1,E,this.getVertex(W)),transformVec2(v2,E,this.getVertex(W+1)),AABB.combinePoints(T,v1$1,v2)},_.prototype.computeMass=function(T,E){T.mass=0,zeroVec2(T.center),T.I=0},_.prototype.computeDistanceProxy=function(T,E){T.m_vertices[0]=this.getVertex(E),T.m_vertices[1]=this.getVertex(E+1),T.m_count=2,T.m_radius=this.m_radius},_.TYPE="chain",_}(Shape),math_max$1=Math.max,math_min$3=Math.min,temp$1=vec2(0,0),e$1=vec2(0,0),e1$1=vec2(0,0),e2$1=vec2(0,0),center=vec2(0,0),s=vec2(0,0),PolygonShape=function(B){__extends(_,B);function _(T){var E=this;return E instanceof _?(E=B.call(this)||this,E.m_type=_.TYPE,E.m_radius=SettingsInternal.polygonRadius,E.m_centroid=Vec2.zero(),E.m_vertices=[],E.m_normals=[],E.m_count=0,T&&T.length&&E._set(T),E):new _(T)}return _.prototype._serialize=function(){return{type:this.m_type,vertices:this.m_vertices}},_._deserialize=function(T,E,W){var X=[];if(T.vertices)for(var q=0;q<T.vertices.length;q++)X.push(W(Vec2,T.vertices[q]));var Y=new _(X);return Y},_.prototype.getType=function(){return this.m_type},_.prototype.getRadius=function(){return this.m_radius},_.prototype._clone=function(){var T=new _;T.m_type=this.m_type,T.m_radius=this.m_radius,T.m_count=this.m_count,T.m_centroid.setVec2(this.m_centroid);for(var E=0;E<this.m_count;E++)T.m_vertices.push(this.m_vertices[E].clone());for(var E=0;E<this.m_normals.length;E++)T.m_normals.push(this.m_normals[E].clone());return T},_.prototype.getChildCount=function(){return 1},_.prototype._reset=function(){this._set(this.m_vertices)},_.prototype._set=function(T){if(T.length<3){this._setAsBox(1,1);return}for(var E=math_min$3(T.length,SettingsInternal.maxPolygonVertices),W=[],X=0;X<E;++X){for(var q=T[X],Y=!0,te=0;te<W.length;++te)if(Vec2.distanceSquared(q,W[te])<.25*SettingsInternal.linearSlopSquared){Y=!1;break}Y&&W.push(Vec2.clone(q))}if(E=W.length,E<3){this._setAsBox(1,1);return}for(var ne=0,ae=W[0].x,X=1;X<E;++X){var le=W[X].x;(le>ae||le===ae&&W[X].y<W[ne].y)&&(ne=X,ae=le)}for(var ue=[],ge=0,ye=ne;;){ue[ge]=ye;for(var xe=0,te=1;te<E;++te){if(xe===ye){xe=te;continue}var Te=Vec2.sub(W[xe],W[ue[ge]]),q=Vec2.sub(W[te],W[ue[ge]]),Ae=Vec2.crossVec2Vec2(Te,q);Ae<0&&(xe=te),Ae===0&&q.lengthSquared()>Te.lengthSquared()&&(xe=te)}if(++ge,ye=xe,xe===ne)break}if(ge<3){this._setAsBox(1,1);return}this.m_count=ge,this.m_vertices=[];for(var X=0;X<ge;++X)this.m_vertices[X]=W[ue[X]];for(var X=0;X<ge;++X){var Ie=X,Ve=X+1<ge?X+1:0,$e=Vec2.sub(this.m_vertices[Ve],this.m_vertices[Ie]);this.m_normals[X]=Vec2.crossVec2Num($e,1),this.m_normals[X].normalize()}this.m_centroid=computeCentroid(this.m_vertices,ge)},_.prototype._setAsBox=function(T,E,W,X){if(this.m_vertices[0]=Vec2.neo(T,-E),this.m_vertices[1]=Vec2.neo(T,E),this.m_vertices[2]=Vec2.neo(-T,E),this.m_vertices[3]=Vec2.neo(-T,-E),this.m_normals[0]=Vec2.neo(1,0),this.m_normals[1]=Vec2.neo(0,1),this.m_normals[2]=Vec2.neo(-1,0),this.m_normals[3]=Vec2.neo(0,-1),this.m_count=4,W&&Vec2.isValid(W)){X=X||0,copyVec2(this.m_centroid,W);var q=Transform.identity();q.p.setVec2(W),q.q.setAngle(X);for(var Y=0;Y<this.m_count;++Y)this.m_vertices[Y]=Transform.mulVec2(q,this.m_vertices[Y]),this.m_normals[Y]=Rot.mulVec2(q.q,this.m_normals[Y])}},_.prototype.testPoint=function(T,E){for(var W=detransformVec2(temp$1,T,E),X=0;X<this.m_count;++X){var q=dotVec2(this.m_normals[X],W)-dotVec2(this.m_normals[X],this.m_vertices[X]);if(q>0)return!1}return!0},_.prototype.rayCast=function(T,E,W,X){for(var q=Rot.mulTVec2(W.q,Vec2.sub(E.p1,W.p)),Y=Rot.mulTVec2(W.q,Vec2.sub(E.p2,W.p)),te=Vec2.sub(Y,q),ne=0,ae=E.maxFraction,le=-1,ue=0;ue<this.m_count;++ue){var ge=Vec2.dot(this.m_normals[ue],Vec2.sub(this.m_vertices[ue],q)),ye=Vec2.dot(this.m_normals[ue],te);if(ye==0){if(ge<0)return!1}else ye<0&&ge<ne*ye?(ne=ge/ye,le=ue):ye>0&&ge<ae*ye&&(ae=ge/ye);if(ae<ne)return!1}return le>=0?(T.fraction=ne,T.normal=Rot.mulVec2(W.q,this.m_normals[le]),!0):!1},_.prototype.computeAABB=function(T,E,W){for(var X=1/0,q=1/0,Y=-1/0,te=-1/0,ne=0;ne<this.m_count;++ne){var ae=transformVec2(temp$1,E,this.m_vertices[ne]);X=math_min$3(X,ae.x),Y=math_max$1(Y,ae.x),q=math_min$3(q,ae.y),te=math_max$1(te,ae.y)}setVec2(T.lowerBound,X-this.m_radius,q-this.m_radius),setVec2(T.upperBound,Y+this.m_radius,te+this.m_radius)},_.prototype.computeMass=function(T,E){zeroVec2(center);var W=0,X=0;zeroVec2(s);for(var q=0;q<this.m_count;++q)plusVec2(s,this.m_vertices[q]);scaleVec2(s,1/this.m_count,s);for(var Y=1/3,q=0;q<this.m_count;++q){subVec2(e1$1,this.m_vertices[q],s),q+1<this.m_count?subVec2(e2$1,this.m_vertices[q+1],s):subVec2(e2$1,this.m_vertices[0],s);var te=crossVec2Vec2(e1$1,e2$1),ne=.5*te;W+=ne,combine2Vec2(temp$1,ne*Y,e1$1,ne*Y,e2$1),plusVec2(center,temp$1);var ae=e1$1.x,le=e1$1.y,ue=e2$1.x,ge=e2$1.y,ye=ae*ae+ue*ae+ue*ue,xe=le*le+ge*le+ge*ge;X+=.25*Y*te*(ye+xe)}T.mass=E*W,scaleVec2(center,1/W,center),addVec2(T.center,center,s),T.I=E*X,T.I+=T.mass*(dotVec2(T.center,T.center)-dotVec2(center,center))},_.prototype.validate=function(){for(var T=0;T<this.m_count;++T){var E=T,W=T<this.m_count-1?E+1:0,X=this.m_vertices[E];subVec2(e$1,this.m_vertices[W],X);for(var q=0;q<this.m_count;++q)if(!(q==E||q==W)){var Y=crossVec2Vec2(e$1,subVec2(temp$1,this.m_vertices[q],X));if(Y<0)return!1}}return!0},_.prototype.computeDistanceProxy=function(T){for(var E=0;E<this.m_count;++E)T.m_vertices[E]=this.m_vertices[E];T.m_vertices.length=this.m_count,T.m_count=this.m_count,T.m_radius=this.m_radius},_.TYPE="polygon",_}(Shape);function computeCentroid(B,_){for(var T=Vec2.zero(),E=0,W=Vec2.zero(),X,q=1/3,X=0;X<_;++X){var Y=W,te=B[X],ne=X+1<_?B[X+1]:B[0],ae=Vec2.sub(te,Y),le=Vec2.sub(ne,Y),ue=Vec2.crossVec2Vec2(ae,le),ge=.5*ue;E+=ge,combine3Vec2(temp$1,1,Y,1,te,1,ne),plusScaleVec2(T,ge*q,temp$1)}return T.mul(1/E),T}var math_sqrt=Math.sqrt,math_PI$4=Math.PI,temp=vec2(0,0),CircleShape=function(B){__extends(_,B);function _(T,E){var W=this;return W instanceof _?(W=B.call(this)||this,W.m_type=_.TYPE,W.m_p=Vec2.zero(),W.m_radius=1,typeof T=="object"&&Vec2.isValid(T)?(W.m_p.setVec2(T),typeof E=="number"&&(W.m_radius=E)):typeof T=="number"&&(W.m_radius=T),W):new _(T,E)}return _.prototype._serialize=function(){return{type:this.m_type,p:this.m_p,radius:this.m_radius}},_._deserialize=function(T){return new _(T.p,T.radius)},_.prototype._reset=function(){},_.prototype.getType=function(){return this.m_type},_.prototype.getRadius=function(){return this.m_radius},_.prototype.getCenter=function(){return this.m_p},_.prototype._clone=function(){var T=new _;return T.m_type=this.m_type,T.m_radius=this.m_radius,T.m_p=this.m_p.clone(),T},_.prototype.getChildCount=function(){return 1},_.prototype.testPoint=function(T,E){var W=transformVec2(temp,T,this.m_p);return distSqrVec2(E,W)<=this.m_radius*this.m_radius},_.prototype.rayCast=function(T,E,W,X){var q=Vec2.add(W.p,Rot.mulVec2(W.q,this.m_p)),Y=Vec2.sub(E.p1,q),te=Vec2.dot(Y,Y)-this.m_radius*this.m_radius,ne=Vec2.sub(E.p2,E.p1),ae=Vec2.dot(Y,ne),le=Vec2.dot(ne,ne),ue=ae*ae-le*te;if(ue<0||le<EPSILON)return!1;var ge=-(ae+math_sqrt(ue));return 0<=ge&&ge<=E.maxFraction*le?(ge/=le,T.fraction=ge,T.normal=Vec2.add(Y,Vec2.mulNumVec2(ge,ne)),T.normal.normalize(),!0):!1},_.prototype.computeAABB=function(T,E,W){var X=transformVec2(temp,E,this.m_p);setVec2(T.lowerBound,X.x-this.m_radius,X.y-this.m_radius),setVec2(T.upperBound,X.x+this.m_radius,X.y+this.m_radius)},_.prototype.computeMass=function(T,E){T.mass=E*math_PI$4*this.m_radius*this.m_radius,copyVec2(T.center,this.m_p),T.I=T.mass*(.5*this.m_radius*this.m_radius+lengthSqrVec2(this.m_p))},_.prototype.computeDistanceProxy=function(T){T.m_vertices[0]=this.m_p,T.m_vertices.length=1,T.m_count=1,T.m_radius=this.m_radius},_.TYPE="circle",_}(Shape),Circle=CircleShape,math_abs$5=Math.abs,math_PI$3=Math.PI,DEFAULTS$a={frequencyHz:0,dampingRatio:0},DistanceJoint=function(B){__extends(_,B);function _(T,E,W,X,q){var Y=this;if(!(Y instanceof _))return new _(T,E,W,X,q);if(W&&X&&"m_type"in X&&"x"in W&&"y"in W){var te=W;W=X,X=te}return T=options(T,DEFAULTS$a),Y=B.call(this,T,E,W)||this,E=Y.m_bodyA,W=Y.m_bodyB,Y.m_type=_.TYPE,Y.m_localAnchorA=Vec2.clone(X?E.getLocalPoint(X):T.localAnchorA||Vec2.zero()),Y.m_localAnchorB=Vec2.clone(q?W.getLocalPoint(q):T.localAnchorB||Vec2.zero()),Y.m_length=Number.isFinite(T.length)?T.length:Vec2.distance(E.getWorldPoint(Y.m_localAnchorA),W.getWorldPoint(Y.m_localAnchorB)),Y.m_frequencyHz=T.frequencyHz,Y.m_dampingRatio=T.dampingRatio,Y.m_impulse=0,Y.m_gamma=0,Y.m_bias=0,Y}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,length:this.m_length,impulse:this.m_impulse,gamma:this.m_gamma,bias:this.m_bias}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){T.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(T.anchorA)):T.localAnchorA&&this.m_localAnchorA.setVec2(T.localAnchorA),T.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(T.anchorB)):T.localAnchorB&&this.m_localAnchorB.setVec2(T.localAnchorB),T.length>0?this.m_length=+T.length:T.length<0||(T.anchorA||T.anchorA||T.anchorA||T.anchorA)&&(this.m_length=Vec2.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB))),Number.isFinite(T.frequencyHz)&&(this.m_frequencyHz=T.frequencyHz),Number.isFinite(T.dampingRatio)&&(this.m_dampingRatio=T.dampingRatio)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.setLength=function(T){this.m_length=T},_.prototype.getLength=function(){return this.m_length},_.prototype.setFrequency=function(T){this.m_frequencyHz=T},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(T){this.m_dampingRatio=T},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.mulNumVec2(this.m_impulse,this.m_u).mul(T)},_.prototype.getReactionTorque=function(T){return 0},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyA.c_velocity.v,q=this.m_bodyA.c_velocity.w,Y=this.m_bodyB.c_position.c,te=this.m_bodyB.c_position.a,ne=this.m_bodyB.c_velocity.v,ae=this.m_bodyB.c_velocity.w,le=Rot.neo(W),ue=Rot.neo(te);this.m_rA=Rot.mulVec2(le,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Rot.mulVec2(ue,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=Vec2.sub(Vec2.add(Y,this.m_rB),Vec2.add(E,this.m_rA));var ge=this.m_u.length();ge>SettingsInternal.linearSlop?this.m_u.mul(1/ge):this.m_u.setNum(0,0);var ye=Vec2.crossVec2Vec2(this.m_rA,this.m_u),xe=Vec2.crossVec2Vec2(this.m_rB,this.m_u),Te=this.m_invMassA+this.m_invIA*ye*ye+this.m_invMassB+this.m_invIB*xe*xe;if(this.m_mass=Te!=0?1/Te:0,this.m_frequencyHz>0){var Ae=ge-this.m_length,Ie=2*math_PI$3*this.m_frequencyHz,Ve=2*this.m_mass*this.m_dampingRatio*Ie,$e=this.m_mass*Ie*Ie,We=T.dt;this.m_gamma=We*(Ve+We*$e),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=Ae*We*$e*this.m_gamma,Te+=this.m_gamma,this.m_mass=Te!=0?1/Te:0}else this.m_gamma=0,this.m_bias=0;if(T.warmStarting){this.m_impulse*=T.dtRatio;var Ue=Vec2.mulNumVec2(this.m_impulse,this.m_u);X.subMul(this.m_invMassA,Ue),q-=this.m_invIA*Vec2.crossVec2Vec2(this.m_rA,Ue),ne.addMul(this.m_invMassB,Ue),ae+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,Ue)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(X),this.m_bodyA.c_velocity.w=q,this.m_bodyB.c_velocity.v.setVec2(ne),this.m_bodyB.c_velocity.w=ae},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=Vec2.add(E,Vec2.crossNumVec2(W,this.m_rA)),te=Vec2.add(X,Vec2.crossNumVec2(q,this.m_rB)),ne=Vec2.dot(this.m_u,te)-Vec2.dot(this.m_u,Y),ae=-this.m_mass*(ne+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=ae;var le=Vec2.mulNumVec2(ae,this.m_u);E.subMul(this.m_invMassA,le),W-=this.m_invIA*Vec2.crossVec2Vec2(this.m_rA,le),X.addMul(this.m_invMassB,le),q+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,le),this.m_bodyA.c_velocity.v.setVec2(E),this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v.setVec2(X),this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){if(this.m_frequencyHz>0)return!0;var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=Rot.neo(W),te=Rot.neo(q),ne=Rot.mulSub(Y,this.m_localAnchorA,this.m_localCenterA),ae=Rot.mulSub(te,this.m_localAnchorB,this.m_localCenterB),le=Vec2.sub(Vec2.add(X,ae),Vec2.add(E,ne)),ue=le.normalize(),ge=clamp(ue-this.m_length,-SettingsInternal.maxLinearCorrection,SettingsInternal.maxLinearCorrection),ye=-this.m_mass*ge,xe=Vec2.mulNumVec2(ye,le);return E.subMul(this.m_invMassA,xe),W-=this.m_invIA*Vec2.crossVec2Vec2(ne,xe),X.addMul(this.m_invMassB,xe),q+=this.m_invIB*Vec2.crossVec2Vec2(ae,xe),this.m_bodyA.c_position.c.setVec2(E),this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c.setVec2(X),this.m_bodyB.c_position.a=q,math_abs$5(ge)<SettingsInternal.linearSlop},_.TYPE="distance-joint",_}(Joint),DEFAULTS$9={maxForce:0,maxTorque:0},FrictionJoint=function(B){__extends(_,B);function _(T,E,W,X){var q=this;return q instanceof _?(T=options(T,DEFAULTS$9),q=B.call(this,T,E,W)||this,E=q.m_bodyA,W=q.m_bodyB,q.m_type=_.TYPE,q.m_localAnchorA=Vec2.clone(X?E.getLocalPoint(X):T.localAnchorA||Vec2.zero()),q.m_localAnchorB=Vec2.clone(X?W.getLocalPoint(X):T.localAnchorB||Vec2.zero()),q.m_linearImpulse=Vec2.zero(),q.m_angularImpulse=0,q.m_maxForce=T.maxForce,q.m_maxTorque=T.maxTorque,q):new _(T,E,W,X)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){T.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(T.anchorA)):T.localAnchorA&&this.m_localAnchorA.setVec2(T.localAnchorA),T.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(T.anchorB)):T.localAnchorB&&this.m_localAnchorB.setVec2(T.localAnchorB),Number.isFinite(T.maxForce)&&(this.m_maxForce=T.maxForce),Number.isFinite(T.maxTorque)&&(this.m_maxTorque=T.maxTorque)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.setMaxForce=function(T){this.m_maxForce=T},_.prototype.getMaxForce=function(){return this.m_maxForce},_.prototype.setMaxTorque=function(T){this.m_maxTorque=T},_.prototype.getMaxTorque=function(){return this.m_maxTorque},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.mulNumVec2(T,this.m_linearImpulse)},_.prototype.getReactionTorque=function(T){return T*this.m_angularImpulse},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.a,W=this.m_bodyA.c_velocity.v,X=this.m_bodyA.c_velocity.w,q=this.m_bodyB.c_position.a,Y=this.m_bodyB.c_velocity.v,te=this.m_bodyB.c_velocity.w,ne=Rot.neo(E),ae=Rot.neo(q);this.m_rA=Rot.mulVec2(ne,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Rot.mulVec2(ae,Vec2.sub(this.m_localAnchorB,this.m_localCenterB));var le=this.m_invMassA,ue=this.m_invMassB,ge=this.m_invIA,ye=this.m_invIB,xe=new Mat22;if(xe.ex.x=le+ue+ge*this.m_rA.y*this.m_rA.y+ye*this.m_rB.y*this.m_rB.y,xe.ex.y=-ge*this.m_rA.x*this.m_rA.y-ye*this.m_rB.x*this.m_rB.y,xe.ey.x=xe.ex.y,xe.ey.y=le+ue+ge*this.m_rA.x*this.m_rA.x+ye*this.m_rB.x*this.m_rB.x,this.m_linearMass=xe.getInverse(),this.m_angularMass=ge+ye,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),T.warmStarting){this.m_linearImpulse.mul(T.dtRatio),this.m_angularImpulse*=T.dtRatio;var Te=Vec2.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);W.subMul(le,Te),X-=ge*(Vec2.crossVec2Vec2(this.m_rA,Te)+this.m_angularImpulse),Y.addMul(ue,Te),te+=ye*(Vec2.crossVec2Vec2(this.m_rB,Te)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=W,this.m_bodyA.c_velocity.w=X,this.m_bodyB.c_velocity.v=Y,this.m_bodyB.c_velocity.w=te},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=this.m_invMassA,te=this.m_invMassB,ne=this.m_invIA,ae=this.m_invIB,le=T.dt;{var ue=q-W,ge=-this.m_angularMass*ue,ye=this.m_angularImpulse,xe=le*this.m_maxTorque;this.m_angularImpulse=clamp(this.m_angularImpulse+ge,-xe,xe),ge=this.m_angularImpulse-ye,W-=ne*ge,q+=ae*ge}{var ue=Vec2.sub(Vec2.add(X,Vec2.crossNumVec2(q,this.m_rB)),Vec2.add(E,Vec2.crossNumVec2(W,this.m_rA))),ge=Vec2.neg(Mat22.mulVec2(this.m_linearMass,ue)),ye=this.m_linearImpulse;this.m_linearImpulse.add(ge);var xe=le*this.m_maxForce;this.m_linearImpulse.lengthSquared()>xe*xe&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(xe)),ge=Vec2.sub(this.m_linearImpulse,ye),E.subMul(Y,ge),W-=ne*Vec2.crossVec2Vec2(this.m_rA,ge),X.addMul(te,ge),q+=ae*Vec2.crossVec2Vec2(this.m_rB,ge)}this.m_bodyA.c_velocity.v=E,this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v=X,this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){return!0},_.TYPE="friction-joint",_}(Joint),Mat33=function(){function B(_,T,E){typeof _=="object"&&_!==null?(this.ex=Vec3.clone(_),this.ey=Vec3.clone(T),this.ez=Vec3.clone(E)):(this.ex=Vec3.zero(),this.ey=Vec3.zero(),this.ez=Vec3.zero())}return B.prototype.toString=function(){return JSON.stringify(this)},B.isValid=function(_){return _===null||typeof _>"u"?!1:Vec3.isValid(_.ex)&&Vec3.isValid(_.ey)&&Vec3.isValid(_.ez)},B.assert=function(_){},B.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},B.prototype.solve33=function(_){var T=this.ey.y*this.ez.z-this.ey.z*this.ez.y,E=this.ey.z*this.ez.x-this.ey.x*this.ez.z,W=this.ey.x*this.ez.y-this.ey.y*this.ez.x,X=this.ex.x*T+this.ex.y*E+this.ex.z*W;X!==0&&(X=1/X);var q=new Vec3;return T=this.ey.y*this.ez.z-this.ey.z*this.ez.y,E=this.ey.z*this.ez.x-this.ey.x*this.ez.z,W=this.ey.x*this.ez.y-this.ey.y*this.ez.x,q.x=X*(_.x*T+_.y*E+_.z*W),T=_.y*this.ez.z-_.z*this.ez.y,E=_.z*this.ez.x-_.x*this.ez.z,W=_.x*this.ez.y-_.y*this.ez.x,q.y=X*(this.ex.x*T+this.ex.y*E+this.ex.z*W),T=this.ey.y*_.z-this.ey.z*_.y,E=this.ey.z*_.x-this.ey.x*_.z,W=this.ey.x*_.y-this.ey.y*_.x,q.z=X*(this.ex.x*T+this.ex.y*E+this.ex.z*W),q},B.prototype.solve22=function(_){var T=this.ex.x,E=this.ey.x,W=this.ex.y,X=this.ey.y,q=T*X-E*W;q!==0&&(q=1/q);var Y=Vec2.zero();return Y.x=q*(X*_.x-E*_.y),Y.y=q*(T*_.y-W*_.x),Y},B.prototype.getInverse22=function(_){var T=this.ex.x,E=this.ey.x,W=this.ex.y,X=this.ey.y,q=T*X-E*W;q!==0&&(q=1/q),_.ex.x=q*X,_.ey.x=-q*E,_.ex.z=0,_.ex.y=-q*W,_.ey.y=q*T,_.ey.z=0,_.ez.x=0,_.ez.y=0,_.ez.z=0},B.prototype.getSymInverse33=function(_){var T=Vec3.dot(this.ex,Vec3.cross(this.ey,this.ez));T!==0&&(T=1/T);var E=this.ex.x,W=this.ey.x,X=this.ez.x,q=this.ey.y,Y=this.ez.y,te=this.ez.z;_.ex.x=T*(q*te-Y*Y),_.ex.y=T*(X*Y-W*te),_.ex.z=T*(W*Y-X*q),_.ey.x=_.ex.y,_.ey.y=T*(E*te-X*X),_.ey.z=T*(X*W-E*Y),_.ez.x=_.ex.z,_.ez.y=_.ey.z,_.ez.z=T*(E*q-W*W)},B.mul=function(_,T){if(T&&"z"in T&&"y"in T&&"x"in T){var E=_.ex.x*T.x+_.ey.x*T.y+_.ez.x*T.z,W=_.ex.y*T.x+_.ey.y*T.y+_.ez.y*T.z,X=_.ex.z*T.x+_.ey.z*T.y+_.ez.z*T.z;return new Vec3(E,W,X)}else if(T&&"y"in T&&"x"in T){var E=_.ex.x*T.x+_.ey.x*T.y,W=_.ex.y*T.x+_.ey.y*T.y;return Vec2.neo(E,W)}},B.mulVec3=function(_,T){var E=_.ex.x*T.x+_.ey.x*T.y+_.ez.x*T.z,W=_.ex.y*T.x+_.ey.y*T.y+_.ez.y*T.z,X=_.ex.z*T.x+_.ey.z*T.y+_.ez.z*T.z;return new Vec3(E,W,X)},B.mulVec2=function(_,T){var E=_.ex.x*T.x+_.ey.x*T.y,W=_.ex.y*T.x+_.ey.y*T.y;return Vec2.neo(E,W)},B.add=function(_,T){return new B(Vec3.add(_.ex,T.ex),Vec3.add(_.ey,T.ey),Vec3.add(_.ez,T.ez))},B}(),math_abs$4=Math.abs,LimitState$2;(function(B){B[B.inactiveLimit=0]="inactiveLimit",B[B.atLowerLimit=1]="atLowerLimit",B[B.atUpperLimit=2]="atUpperLimit",B[B.equalLimits=3]="equalLimits"})(LimitState$2||(LimitState$2={}));var DEFAULTS$8={lowerAngle:0,upperAngle:0,maxMotorTorque:0,motorSpeed:0,enableLimit:!1,enableMotor:!1},RevoluteJoint=function(B){__extends(_,B);function _(T,E,W,X){var q=this,Y,te,ne,ae,le,ue;return q instanceof _?(T=T??{},q=B.call(this,T,E,W)||this,E=q.m_bodyA,W=q.m_bodyB,q.m_mass=new Mat33,q.m_limitState=LimitState$2.inactiveLimit,q.m_type=_.TYPE,Vec2.isValid(X)?q.m_localAnchorA=E.getLocalPoint(X):Vec2.isValid(T.localAnchorA)?q.m_localAnchorA=Vec2.clone(T.localAnchorA):q.m_localAnchorA=Vec2.zero(),Vec2.isValid(X)?q.m_localAnchorB=W.getLocalPoint(X):Vec2.isValid(T.localAnchorB)?q.m_localAnchorB=Vec2.clone(T.localAnchorB):q.m_localAnchorB=Vec2.zero(),Number.isFinite(T.referenceAngle)?q.m_referenceAngle=T.referenceAngle:q.m_referenceAngle=W.getAngle()-E.getAngle(),q.m_impulse=new Vec3,q.m_motorImpulse=0,q.m_lowerAngle=(Y=T.lowerAngle)!==null&&Y!==void 0?Y:DEFAULTS$8.lowerAngle,q.m_upperAngle=(te=T.upperAngle)!==null&&te!==void 0?te:DEFAULTS$8.upperAngle,q.m_maxMotorTorque=(ne=T.maxMotorTorque)!==null&&ne!==void 0?ne:DEFAULTS$8.maxMotorTorque,q.m_motorSpeed=(ae=T.motorSpeed)!==null&&ae!==void 0?ae:DEFAULTS$8.motorSpeed,q.m_enableLimit=(le=T.enableLimit)!==null&&le!==void 0?le:DEFAULTS$8.enableLimit,q.m_enableMotor=(ue=T.enableMotor)!==null&&ue!==void 0?ue:DEFAULTS$8.enableMotor,q):new _(T,E,W,X)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerAngle:this.m_lowerAngle,upperAngle:this.m_upperAngle,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){T.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(T.anchorA)):T.localAnchorA&&this.m_localAnchorA.setVec2(T.localAnchorA),T.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(T.anchorB)):T.localAnchorB&&this.m_localAnchorB.setVec2(T.localAnchorB),Number.isFinite(T.referenceAngle)&&(this.m_referenceAngle=T.referenceAngle),T.enableLimit!==void 0&&(this.m_enableLimit=T.enableLimit),Number.isFinite(T.lowerAngle)&&(this.m_lowerAngle=T.lowerAngle),Number.isFinite(T.upperAngle)&&(this.m_upperAngle=T.upperAngle),Number.isFinite(T.maxMotorTorque)&&(this.m_maxMotorTorque=T.maxMotorTorque),Number.isFinite(T.motorSpeed)&&(this.m_motorSpeed=T.motorSpeed),T.enableMotor!==void 0&&(this.m_enableMotor=T.enableMotor)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.getReferenceAngle=function(){return this.m_referenceAngle},_.prototype.getJointAngle=function(){var T=this.m_bodyA,E=this.m_bodyB;return E.m_sweep.a-T.m_sweep.a-this.m_referenceAngle},_.prototype.getJointSpeed=function(){var T=this.m_bodyA,E=this.m_bodyB;return E.m_angularVelocity-T.m_angularVelocity},_.prototype.isMotorEnabled=function(){return this.m_enableMotor},_.prototype.enableMotor=function(T){T!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=T)},_.prototype.getMotorTorque=function(T){return T*this.m_motorImpulse},_.prototype.setMotorSpeed=function(T){T!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=T)},_.prototype.getMotorSpeed=function(){return this.m_motorSpeed},_.prototype.setMaxMotorTorque=function(T){T!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=T)},_.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},_.prototype.isLimitEnabled=function(){return this.m_enableLimit},_.prototype.enableLimit=function(T){T!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=T,this.m_impulse.z=0)},_.prototype.getLowerLimit=function(){return this.m_lowerAngle},_.prototype.getUpperLimit=function(){return this.m_upperAngle},_.prototype.setLimits=function(T,E){(T!=this.m_lowerAngle||E!=this.m_upperAngle)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=T,this.m_upperAngle=E)},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.neo(this.m_impulse.x,this.m_impulse.y).mul(T)},_.prototype.getReactionTorque=function(T){return T*this.m_impulse.z},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.a,W=this.m_bodyA.c_velocity.v,X=this.m_bodyA.c_velocity.w,q=this.m_bodyB.c_position.a,Y=this.m_bodyB.c_velocity.v,te=this.m_bodyB.c_velocity.w,ne=Rot.neo(E),ae=Rot.neo(q);this.m_rA=Rot.mulVec2(ne,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Rot.mulVec2(ae,Vec2.sub(this.m_localAnchorB,this.m_localCenterB));var le=this.m_invMassA,ue=this.m_invMassB,ge=this.m_invIA,ye=this.m_invIB,xe=ge+ye===0;if(this.m_mass.ex.x=le+ue+this.m_rA.y*this.m_rA.y*ge+this.m_rB.y*this.m_rB.y*ye,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*ge-this.m_rB.y*this.m_rB.x*ye,this.m_mass.ez.x=-this.m_rA.y*ge-this.m_rB.y*ye,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=le+ue+this.m_rA.x*this.m_rA.x*ge+this.m_rB.x*this.m_rB.x*ye,this.m_mass.ez.y=this.m_rA.x*ge+this.m_rB.x*ye,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=ge+ye,this.m_motorMass=ge+ye,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(this.m_enableMotor==!1||xe)&&(this.m_motorImpulse=0),this.m_enableLimit&&xe==!1){var Te=q-E-this.m_referenceAngle;math_abs$4(this.m_upperAngle-this.m_lowerAngle)<2*SettingsInternal.angularSlop?this.m_limitState=LimitState$2.equalLimits:Te<=this.m_lowerAngle?(this.m_limitState!=LimitState$2.atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=LimitState$2.atLowerLimit):Te>=this.m_upperAngle?(this.m_limitState!=LimitState$2.atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=LimitState$2.atUpperLimit):(this.m_limitState=LimitState$2.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=LimitState$2.inactiveLimit;if(T.warmStarting){this.m_impulse.mul(T.dtRatio),this.m_motorImpulse*=T.dtRatio;var Ae=Vec2.neo(this.m_impulse.x,this.m_impulse.y);W.subMul(le,Ae),X-=ge*(Vec2.crossVec2Vec2(this.m_rA,Ae)+this.m_motorImpulse+this.m_impulse.z),Y.addMul(ue,Ae),te+=ye*(Vec2.crossVec2Vec2(this.m_rB,Ae)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=W,this.m_bodyA.c_velocity.w=X,this.m_bodyB.c_velocity.v=Y,this.m_bodyB.c_velocity.w=te},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=this.m_invMassA,te=this.m_invMassB,ne=this.m_invIA,ae=this.m_invIB,le=ne+ae===0;if(this.m_enableMotor&&this.m_limitState!=LimitState$2.equalLimits&&le==!1){var ue=q-W-this.m_motorSpeed,ge=-this.m_motorMass*ue,ye=this.m_motorImpulse,xe=T.dt*this.m_maxMotorTorque;this.m_motorImpulse=clamp(this.m_motorImpulse+ge,-xe,xe),ge=this.m_motorImpulse-ye,W-=ne*ge,q+=ae*ge}if(this.m_enableLimit&&this.m_limitState!=LimitState$2.inactiveLimit&&le==!1){var Te=Vec2.zero();Te.addCombine(1,X,1,Vec2.crossNumVec2(q,this.m_rB)),Te.subCombine(1,E,1,Vec2.crossNumVec2(W,this.m_rA));var Ae=q-W,ue=new Vec3(Te.x,Te.y,Ae),ge=Vec3.neg(this.m_mass.solve33(ue));if(this.m_limitState==LimitState$2.equalLimits)this.m_impulse.add(ge);else if(this.m_limitState==LimitState$2.atLowerLimit){var Ie=this.m_impulse.z+ge.z;if(Ie<0){var Ve=Vec2.combine(-1,Te,this.m_impulse.z,Vec2.neo(this.m_mass.ez.x,this.m_mass.ez.y)),$e=this.m_mass.solve22(Ve);ge.x=$e.x,ge.y=$e.y,ge.z=-this.m_impulse.z,this.m_impulse.x+=$e.x,this.m_impulse.y+=$e.y,this.m_impulse.z=0}else this.m_impulse.add(ge)}else if(this.m_limitState==LimitState$2.atUpperLimit){var Ie=this.m_impulse.z+ge.z;if(Ie>0){var Ve=Vec2.combine(-1,Te,this.m_impulse.z,Vec2.neo(this.m_mass.ez.x,this.m_mass.ez.y)),$e=this.m_mass.solve22(Ve);ge.x=$e.x,ge.y=$e.y,ge.z=-this.m_impulse.z,this.m_impulse.x+=$e.x,this.m_impulse.y+=$e.y,this.m_impulse.z=0}else this.m_impulse.add(ge)}var We=Vec2.neo(ge.x,ge.y);E.subMul(Y,We),W-=ne*(Vec2.crossVec2Vec2(this.m_rA,We)+ge.z),X.addMul(te,We),q+=ae*(Vec2.crossVec2Vec2(this.m_rB,We)+ge.z)}else{var ue=Vec2.zero();ue.addCombine(1,X,1,Vec2.crossNumVec2(q,this.m_rB)),ue.subCombine(1,E,1,Vec2.crossNumVec2(W,this.m_rA));var ge=this.m_mass.solve22(Vec2.neg(ue));this.m_impulse.x+=ge.x,this.m_impulse.y+=ge.y,E.subMul(Y,ge),W-=ne*Vec2.crossVec2Vec2(this.m_rA,ge),X.addMul(te,ge),q+=ae*Vec2.crossVec2Vec2(this.m_rB,ge)}this.m_bodyA.c_velocity.v=E,this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v=X,this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=Rot.neo(W),te=Rot.neo(q),ne=0,ae=0,le=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=LimitState$2.inactiveLimit&&le==!1){var ue=q-W-this.m_referenceAngle,ge=0;if(this.m_limitState==LimitState$2.equalLimits){var ye=clamp(ue-this.m_lowerAngle,-SettingsInternal.maxAngularCorrection,SettingsInternal.maxAngularCorrection);ge=-this.m_motorMass*ye,ne=math_abs$4(ye)}else if(this.m_limitState==LimitState$2.atLowerLimit){var ye=ue-this.m_lowerAngle;ne=-ye,ye=clamp(ye+SettingsInternal.angularSlop,-SettingsInternal.maxAngularCorrection,0),ge=-this.m_motorMass*ye}else if(this.m_limitState==LimitState$2.atUpperLimit){var ye=ue-this.m_upperAngle;ne=ye,ye=clamp(ye-SettingsInternal.angularSlop,0,SettingsInternal.maxAngularCorrection),ge=-this.m_motorMass*ye}W-=this.m_invIA*ge,q+=this.m_invIB*ge}{Y.setAngle(W),te.setAngle(q);var xe=Rot.mulVec2(Y,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),Te=Rot.mulVec2(te,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),ye=Vec2.zero();ye.addCombine(1,X,1,Te),ye.subCombine(1,E,1,xe),ae=ye.length();var Ae=this.m_invMassA,Ie=this.m_invMassB,Ve=this.m_invIA,$e=this.m_invIB,We=new Mat22;We.ex.x=Ae+Ie+Ve*xe.y*xe.y+$e*Te.y*Te.y,We.ex.y=-Ve*xe.x*xe.y-$e*Te.x*Te.y,We.ey.x=We.ex.y,We.ey.y=Ae+Ie+Ve*xe.x*xe.x+$e*Te.x*Te.x;var Ue=Vec2.neg(We.solve(ye));E.subMul(Ae,Ue),W-=Ve*Vec2.crossVec2Vec2(xe,Ue),X.addMul(Ie,Ue),q+=$e*Vec2.crossVec2Vec2(Te,Ue)}return this.m_bodyA.c_position.c.setVec2(E),this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c.setVec2(X),this.m_bodyB.c_position.a=q,ae<=SettingsInternal.linearSlop&&ne<=SettingsInternal.angularSlop},_.TYPE="revolute-joint",_}(Joint),math_abs$3=Math.abs,math_max=Math.max,math_min$2=Math.min,LimitState$1;(function(B){B[B.inactiveLimit=0]="inactiveLimit",B[B.atLowerLimit=1]="atLowerLimit",B[B.atUpperLimit=2]="atUpperLimit",B[B.equalLimits=3]="equalLimits"})(LimitState$1||(LimitState$1={}));var DEFAULTS$7={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0},PrismaticJoint=function(B){__extends(_,B);function _(T,E,W,X,q){var Y=this;return Y instanceof _?(T=options(T,DEFAULTS$7),Y=B.call(this,T,E,W)||this,E=Y.m_bodyA,W=Y.m_bodyB,Y.m_type=_.TYPE,Y.m_localAnchorA=Vec2.clone(X?E.getLocalPoint(X):T.localAnchorA||Vec2.zero()),Y.m_localAnchorB=Vec2.clone(X?W.getLocalPoint(X):T.localAnchorB||Vec2.zero()),Y.m_localXAxisA=Vec2.clone(q?E.getLocalVector(q):T.localAxisA||Vec2.neo(1,0)),Y.m_localXAxisA.normalize(),Y.m_localYAxisA=Vec2.crossNumVec2(1,Y.m_localXAxisA),Y.m_referenceAngle=Number.isFinite(T.referenceAngle)?T.referenceAngle:W.getAngle()-E.getAngle(),Y.m_impulse=new Vec3,Y.m_motorMass=0,Y.m_motorImpulse=0,Y.m_lowerTranslation=T.lowerTranslation,Y.m_upperTranslation=T.upperTranslation,Y.m_maxMotorForce=T.maxMotorForce,Y.m_motorSpeed=T.motorSpeed,Y.m_enableLimit=T.enableLimit,Y.m_enableMotor=T.enableMotor,Y.m_limitState=LimitState$1.inactiveLimit,Y.m_axis=Vec2.zero(),Y.m_perp=Vec2.zero(),Y.m_K=new Mat33,Y):new _(T,E,W,X,q)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerTranslation:this.m_lowerTranslation,upperTranslation:this.m_upperTranslation,maxMotorForce:this.m_maxMotorForce,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA,referenceAngle:this.m_referenceAngle}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E),T.localAxisA=Vec2.clone(T.localAxisA);var X=new _(T);return X},_.prototype._reset=function(T){T.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(T.anchorA)):T.localAnchorA&&this.m_localAnchorA.setVec2(T.localAnchorA),T.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(T.anchorB)):T.localAnchorB&&this.m_localAnchorB.setVec2(T.localAnchorB),T.localAxisA&&(this.m_localXAxisA.setVec2(T.localAxisA),this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1,T.localAxisA))),Number.isFinite(T.referenceAngle)&&(this.m_referenceAngle=T.referenceAngle),typeof T.enableLimit<"u"&&(this.m_enableLimit=!!T.enableLimit),Number.isFinite(T.lowerTranslation)&&(this.m_lowerTranslation=T.lowerTranslation),Number.isFinite(T.upperTranslation)&&(this.m_upperTranslation=T.upperTranslation),typeof T.enableMotor<"u"&&(this.m_enableMotor=!!T.enableMotor),Number.isFinite(T.maxMotorForce)&&(this.m_maxMotorForce=T.maxMotorForce),Number.isFinite(T.motorSpeed)&&(this.m_motorSpeed=T.motorSpeed)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.getLocalAxisA=function(){return this.m_localXAxisA},_.prototype.getReferenceAngle=function(){return this.m_referenceAngle},_.prototype.getJointTranslation=function(){var T=this.m_bodyA.getWorldPoint(this.m_localAnchorA),E=this.m_bodyB.getWorldPoint(this.m_localAnchorB),W=Vec2.sub(E,T),X=this.m_bodyA.getWorldVector(this.m_localXAxisA),q=Vec2.dot(W,X);return q},_.prototype.getJointSpeed=function(){var T=this.m_bodyA,E=this.m_bodyB,W=Rot.mulVec2(T.m_xf.q,Vec2.sub(this.m_localAnchorA,T.m_sweep.localCenter)),X=Rot.mulVec2(E.m_xf.q,Vec2.sub(this.m_localAnchorB,E.m_sweep.localCenter)),q=Vec2.add(T.m_sweep.c,W),Y=Vec2.add(E.m_sweep.c,X),te=Vec2.sub(Y,q),ne=Rot.mulVec2(T.m_xf.q,this.m_localXAxisA),ae=T.m_linearVelocity,le=E.m_linearVelocity,ue=T.m_angularVelocity,ge=E.m_angularVelocity,ye=Vec2.dot(te,Vec2.crossNumVec2(ue,ne))+Vec2.dot(ne,Vec2.sub(Vec2.addCrossNumVec2(le,ge,X),Vec2.addCrossNumVec2(ae,ue,W)));return ye},_.prototype.isLimitEnabled=function(){return this.m_enableLimit},_.prototype.enableLimit=function(T){T!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=T,this.m_impulse.z=0)},_.prototype.getLowerLimit=function(){return this.m_lowerTranslation},_.prototype.getUpperLimit=function(){return this.m_upperTranslation},_.prototype.setLimits=function(T,E){(T!=this.m_lowerTranslation||E!=this.m_upperTranslation)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=T,this.m_upperTranslation=E,this.m_impulse.z=0)},_.prototype.isMotorEnabled=function(){return this.m_enableMotor},_.prototype.enableMotor=function(T){T!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=T)},_.prototype.setMotorSpeed=function(T){T!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=T)},_.prototype.setMaxMotorForce=function(T){T!=this.m_maxMotorForce&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=T)},_.prototype.getMaxMotorForce=function(){return this.m_maxMotorForce},_.prototype.getMotorSpeed=function(){return this.m_motorSpeed},_.prototype.getMotorForce=function(T){return T*this.m_motorImpulse},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(T)},_.prototype.getReactionTorque=function(T){return T*this.m_impulse.y},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyA.c_velocity.v,q=this.m_bodyA.c_velocity.w,Y=this.m_bodyB.c_position.c,te=this.m_bodyB.c_position.a,ne=this.m_bodyB.c_velocity.v,ae=this.m_bodyB.c_velocity.w,le=Rot.neo(W),ue=Rot.neo(te),ge=Rot.mulVec2(le,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),ye=Rot.mulVec2(ue,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),xe=Vec2.zero();xe.addCombine(1,Y,1,ye),xe.subCombine(1,E,1,ge);var Te=this.m_invMassA,Ae=this.m_invMassB,Ie=this.m_invIA,Ve=this.m_invIB;this.m_axis=Rot.mulVec2(le,this.m_localXAxisA),this.m_a1=Vec2.crossVec2Vec2(Vec2.add(xe,ge),this.m_axis),this.m_a2=Vec2.crossVec2Vec2(ye,this.m_axis),this.m_motorMass=Te+Ae+Ie*this.m_a1*this.m_a1+Ve*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass);{this.m_perp=Rot.mulVec2(le,this.m_localYAxisA),this.m_s1=Vec2.crossVec2Vec2(Vec2.add(xe,ge),this.m_perp),this.m_s2=Vec2.crossVec2Vec2(ye,this.m_perp),Vec2.crossVec2Vec2(ge,this.m_perp);var $e=Te+Ae+Ie*this.m_s1*this.m_s1+Ve*this.m_s2*this.m_s2,We=Ie*this.m_s1+Ve*this.m_s2,Ue=Ie*this.m_s1*this.m_a1+Ve*this.m_s2*this.m_a2,je=Ie+Ve;je==0&&(je=1);var ze=Ie*this.m_a1+Ve*this.m_a2,He=Te+Ae+Ie*this.m_a1*this.m_a1+Ve*this.m_a2*this.m_a2;this.m_K.ex.set($e,We,Ue),this.m_K.ey.set(We,je,ze),this.m_K.ez.set(Ue,ze,He)}if(this.m_enableLimit){var Le=Vec2.dot(this.m_axis,xe);math_abs$3(this.m_upperTranslation-this.m_lowerTranslation)<2*SettingsInternal.linearSlop?this.m_limitState=LimitState$1.equalLimits:Le<=this.m_lowerTranslation?this.m_limitState!=LimitState$1.atLowerLimit&&(this.m_limitState=LimitState$1.atLowerLimit,this.m_impulse.z=0):Le>=this.m_upperTranslation?this.m_limitState!=LimitState$1.atUpperLimit&&(this.m_limitState=LimitState$1.atUpperLimit,this.m_impulse.z=0):(this.m_limitState=LimitState$1.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=LimitState$1.inactiveLimit,this.m_impulse.z=0;if(this.m_enableMotor==!1&&(this.m_motorImpulse=0),T.warmStarting){this.m_impulse.mul(T.dtRatio),this.m_motorImpulse*=T.dtRatio;var qe=Vec2.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),Qe=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,Ke=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;X.subMul(Te,qe),q-=Ie*Qe,ne.addMul(Ae,qe),ae+=Ve*Ke}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(X),this.m_bodyA.c_velocity.w=q,this.m_bodyB.c_velocity.v.setVec2(ne),this.m_bodyB.c_velocity.w=ae},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=this.m_invMassA,te=this.m_invMassB,ne=this.m_invIA,ae=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!=LimitState$1.equalLimits){var le=Vec2.dot(this.m_axis,Vec2.sub(X,E))+this.m_a2*q-this.m_a1*W,ue=this.m_motorMass*(this.m_motorSpeed-le),ge=this.m_motorImpulse,ye=T.dt*this.m_maxMotorForce;this.m_motorImpulse=clamp(this.m_motorImpulse+ue,-ye,ye),ue=this.m_motorImpulse-ge;var xe=Vec2.mulNumVec2(ue,this.m_axis),Te=ue*this.m_a1,Ae=ue*this.m_a2;E.subMul(Y,xe),W-=ne*Te,X.addMul(te,xe),q+=ae*Ae}var Ie=Vec2.zero();if(Ie.x+=Vec2.dot(this.m_perp,X)+this.m_s2*q,Ie.x-=Vec2.dot(this.m_perp,E)+this.m_s1*W,Ie.y=q-W,this.m_enableLimit&&this.m_limitState!=LimitState$1.inactiveLimit){var Ve=0;Ve+=Vec2.dot(this.m_axis,X)+this.m_a2*q,Ve-=Vec2.dot(this.m_axis,E)+this.m_a1*W;var le=new Vec3(Ie.x,Ie.y,Ve),$e=Vec3.clone(this.m_impulse),We=this.m_K.solve33(Vec3.neg(le));this.m_impulse.add(We),this.m_limitState==LimitState$1.atLowerLimit?this.m_impulse.z=math_max(this.m_impulse.z,0):this.m_limitState==LimitState$1.atUpperLimit&&(this.m_impulse.z=math_min$2(this.m_impulse.z,0));var Ue=Vec2.combine(-1,Ie,-(this.m_impulse.z-$e.z),Vec2.neo(this.m_K.ez.x,this.m_K.ez.y)),je=Vec2.add(this.m_K.solve22(Ue),Vec2.neo($e.x,$e.y));this.m_impulse.x=je.x,this.m_impulse.y=je.y,We=Vec3.sub(this.m_impulse,$e);var xe=Vec2.combine(We.x,this.m_perp,We.z,this.m_axis),Te=We.x*this.m_s1+We.y+We.z*this.m_a1,Ae=We.x*this.m_s2+We.y+We.z*this.m_a2;E.subMul(Y,xe),W-=ne*Te,X.addMul(te,xe),q+=ae*Ae}else{var We=this.m_K.solve22(Vec2.neg(Ie));this.m_impulse.x+=We.x,this.m_impulse.y+=We.y;var xe=Vec2.mulNumVec2(We.x,this.m_perp),Te=We.x*this.m_s1+We.y,Ae=We.x*this.m_s2+We.y;E.subMul(Y,xe),W-=ne*Te,X.addMul(te,xe),q+=ae*Ae}this.m_bodyA.c_velocity.v=E,this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v=X,this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=Rot.neo(W),te=Rot.neo(q),ne=this.m_invMassA,ae=this.m_invMassB,le=this.m_invIA,ue=this.m_invIB,ge=Rot.mulVec2(Y,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),ye=Rot.mulVec2(te,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),xe=Vec2.sub(Vec2.add(X,ye),Vec2.add(E,ge)),Te=Rot.mulVec2(Y,this.m_localXAxisA),Ae=Vec2.crossVec2Vec2(Vec2.add(xe,ge),Te),Ie=Vec2.crossVec2Vec2(ye,Te),Ve=Rot.mulVec2(Y,this.m_localYAxisA),$e=Vec2.crossVec2Vec2(Vec2.add(xe,ge),Ve),We=Vec2.crossVec2Vec2(ye,Ve),Ue=new Vec3,je=Vec2.zero();je.x=Vec2.dot(Ve,xe),je.y=q-W-this.m_referenceAngle;var ze=math_abs$3(je.x),He=math_abs$3(je.y),Le=SettingsInternal.linearSlop,qe=SettingsInternal.maxLinearCorrection,Qe=!1,Ke=0;if(this.m_enableLimit){var Je=Vec2.dot(Te,xe);math_abs$3(this.m_upperTranslation-this.m_lowerTranslation)<2*Le?(Ke=clamp(Je,-qe,qe),ze=math_max(ze,math_abs$3(Je)),Qe=!0):Je<=this.m_lowerTranslation?(Ke=clamp(Je-this.m_lowerTranslation+Le,-qe,0),ze=Math.max(ze,this.m_lowerTranslation-Je),Qe=!0):Je>=this.m_upperTranslation&&(Ke=clamp(Je-this.m_upperTranslation-Le,0,qe),ze=Math.max(ze,Je-this.m_upperTranslation),Qe=!0)}if(Qe){var pt=ne+ae+le*$e*$e+ue*We*We,ut=le*$e+ue*We,lt=le*$e*Ae+ue*We*Ie,st=le+ue;st==0&&(st=1);var sr=le*Ae+ue*Ie,mt=ne+ae+le*Ae*Ae+ue*Ie*Ie,Tr=new Mat33;Tr.ex.set(pt,ut,lt),Tr.ey.set(ut,st,sr),Tr.ez.set(lt,sr,mt);var di=new Vec3;di.x=je.x,di.y=je.y,di.z=Ke,Ue=Tr.solve33(Vec3.neg(di))}else{var pt=ne+ae+le*$e*$e+ue*We*We,ut=le*$e+ue*We,st=le+ue;st==0&&(st=1);var Tr=new Mat22;Tr.ex.setNum(pt,ut),Tr.ey.setNum(ut,st);var Mi=Tr.solve(Vec2.neg(je));Ue.x=Mi.x,Ue.y=Mi.y,Ue.z=0}var Gr=Vec2.combine(Ue.x,Ve,Ue.z,Te),ci=Ue.x*$e+Ue.y+Ue.z*Ae,gi=Ue.x*We+Ue.y+Ue.z*Ie;return E.subMul(ne,Gr),W-=le*ci,X.addMul(ae,Gr),q+=ue*gi,this.m_bodyA.c_position.c=E,this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c=X,this.m_bodyB.c_position.a=q,ze<=SettingsInternal.linearSlop&&He<=SettingsInternal.angularSlop},_.TYPE="prismatic-joint",_}(Joint),DEFAULTS$6={ratio:1},GearJoint=function(B){__extends(_,B);function _(T,E,W,X,q,Y){var te=this;if(!(te instanceof _))return new _(T,E,W,X,q,Y);T=options(T,DEFAULTS$6),te=B.call(this,T,E,W)||this,E=te.m_bodyA,W=te.m_bodyB,te.m_type=_.TYPE,te.m_joint1=X||T.joint1,te.m_joint2=q||T.joint2,te.m_ratio=Number.isFinite(Y)?Y:T.ratio,te.m_type1=te.m_joint1.getType(),te.m_type2=te.m_joint2.getType();var ne,ae;te.m_bodyC=te.m_joint1.getBodyA(),te.m_bodyA=te.m_joint1.getBodyB();var le=te.m_bodyA.m_xf,ue=te.m_bodyA.m_sweep.a,ge=te.m_bodyC.m_xf,ye=te.m_bodyC.m_sweep.a;if(te.m_type1===RevoluteJoint.TYPE){var xe=te.m_joint1;te.m_localAnchorC=xe.m_localAnchorA,te.m_localAnchorA=xe.m_localAnchorB,te.m_referenceAngleA=xe.m_referenceAngle,te.m_localAxisC=Vec2.zero(),ne=ue-ye-te.m_referenceAngleA}else{var Te=te.m_joint1;te.m_localAnchorC=Te.m_localAnchorA,te.m_localAnchorA=Te.m_localAnchorB,te.m_referenceAngleA=Te.m_referenceAngle,te.m_localAxisC=Te.m_localXAxisA;var Ae=te.m_localAnchorC,Ie=Rot.mulTVec2(ge.q,Vec2.add(Rot.mulVec2(le.q,te.m_localAnchorA),Vec2.sub(le.p,ge.p)));ne=Vec2.dot(Ie,te.m_localAxisC)-Vec2.dot(Ae,te.m_localAxisC)}te.m_bodyD=te.m_joint2.getBodyA(),te.m_bodyB=te.m_joint2.getBodyB();var Ve=te.m_bodyB.m_xf,$e=te.m_bodyB.m_sweep.a,We=te.m_bodyD.m_xf,Ue=te.m_bodyD.m_sweep.a;if(te.m_type2===RevoluteJoint.TYPE){var xe=te.m_joint2;te.m_localAnchorD=xe.m_localAnchorA,te.m_localAnchorB=xe.m_localAnchorB,te.m_referenceAngleB=xe.m_referenceAngle,te.m_localAxisD=Vec2.zero(),ae=$e-Ue-te.m_referenceAngleB}else{var Te=te.m_joint2;te.m_localAnchorD=Te.m_localAnchorA,te.m_localAnchorB=Te.m_localAnchorB,te.m_referenceAngleB=Te.m_referenceAngle,te.m_localAxisD=Te.m_localXAxisA;var je=te.m_localAnchorD,ze=Rot.mulTVec2(We.q,Vec2.add(Rot.mulVec2(Ve.q,te.m_localAnchorB),Vec2.sub(Ve.p,We.p)));ae=Vec2.dot(ze,te.m_localAxisD)-Vec2.dot(je,te.m_localAxisD)}return te.m_constant=ne+te.m_ratio*ae,te.m_impulse=0,te}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,joint1:this.m_joint1,joint2:this.m_joint2,ratio:this.m_ratio}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E),T.joint1=W(Joint,T.joint1,E),T.joint2=W(Joint,T.joint2,E);var X=new _(T);return X},_.prototype._reset=function(T){Number.isFinite(T.ratio)&&(this.m_ratio=T.ratio)},_.prototype.getJoint1=function(){return this.m_joint1},_.prototype.getJoint2=function(){return this.m_joint2},_.prototype.setRatio=function(T){this.m_ratio=T},_.prototype.getRatio=function(){return this.m_ratio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.mulNumVec2(this.m_impulse,this.m_JvAC).mul(T)},_.prototype.getReactionTorque=function(T){var E=this.m_impulse*this.m_JwA;return T*E},_.prototype.initVelocityConstraints=function(T){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var E=this.m_bodyA.c_position.a,W=this.m_bodyA.c_velocity.v,X=this.m_bodyA.c_velocity.w,q=this.m_bodyB.c_position.a,Y=this.m_bodyB.c_velocity.v,te=this.m_bodyB.c_velocity.w,ne=this.m_bodyC.c_position.a,ae=this.m_bodyC.c_velocity.v,le=this.m_bodyC.c_velocity.w,ue=this.m_bodyD.c_position.a,ge=this.m_bodyD.c_velocity.v,ye=this.m_bodyD.c_velocity.w,xe=Rot.neo(E),Te=Rot.neo(q),Ae=Rot.neo(ne),Ie=Rot.neo(ue);if(this.m_mass=0,this.m_type1==RevoluteJoint.TYPE)this.m_JvAC=Vec2.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var Ve=Rot.mulVec2(Ae,this.m_localAxisC),$e=Rot.mulSub(Ae,this.m_localAnchorC,this.m_lcC),We=Rot.mulSub(xe,this.m_localAnchorA,this.m_lcA);this.m_JvAC=Ve,this.m_JwC=Vec2.crossVec2Vec2($e,Ve),this.m_JwA=Vec2.crossVec2Vec2(We,Ve),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==RevoluteJoint.TYPE)this.m_JvBD=Vec2.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{var Ve=Rot.mulVec2(Ie,this.m_localAxisD),Ue=Rot.mulSub(Ie,this.m_localAnchorD,this.m_lcD),je=Rot.mulSub(Te,this.m_localAnchorB,this.m_lcB);this.m_JvBD=Vec2.mulNumVec2(this.m_ratio,Ve),this.m_JwD=this.m_ratio*Vec2.crossVec2Vec2(Ue,Ve),this.m_JwB=this.m_ratio*Vec2.crossVec2Vec2(je,Ve),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,T.warmStarting?(W.addMul(this.m_mA*this.m_impulse,this.m_JvAC),X+=this.m_iA*this.m_impulse*this.m_JwA,Y.addMul(this.m_mB*this.m_impulse,this.m_JvBD),te+=this.m_iB*this.m_impulse*this.m_JwB,ae.subMul(this.m_mC*this.m_impulse,this.m_JvAC),le-=this.m_iC*this.m_impulse*this.m_JwC,ge.subMul(this.m_mD*this.m_impulse,this.m_JvBD),ye-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.setVec2(W),this.m_bodyA.c_velocity.w=X,this.m_bodyB.c_velocity.v.setVec2(Y),this.m_bodyB.c_velocity.w=te,this.m_bodyC.c_velocity.v.setVec2(ae),this.m_bodyC.c_velocity.w=le,this.m_bodyD.c_velocity.v.setVec2(ge),this.m_bodyD.c_velocity.w=ye},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=this.m_bodyC.c_velocity.v,te=this.m_bodyC.c_velocity.w,ne=this.m_bodyD.c_velocity.v,ae=this.m_bodyD.c_velocity.w,le=Vec2.dot(this.m_JvAC,E)-Vec2.dot(this.m_JvAC,Y)+Vec2.dot(this.m_JvBD,X)-Vec2.dot(this.m_JvBD,ne);le+=this.m_JwA*W-this.m_JwC*te+(this.m_JwB*q-this.m_JwD*ae);var ue=-this.m_mass*le;this.m_impulse+=ue,E.addMul(this.m_mA*ue,this.m_JvAC),W+=this.m_iA*ue*this.m_JwA,X.addMul(this.m_mB*ue,this.m_JvBD),q+=this.m_iB*ue*this.m_JwB,Y.subMul(this.m_mC*ue,this.m_JvAC),te-=this.m_iC*ue*this.m_JwC,ne.subMul(this.m_mD*ue,this.m_JvBD),ae-=this.m_iD*ue*this.m_JwD,this.m_bodyA.c_velocity.v.setVec2(E),this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v.setVec2(X),this.m_bodyB.c_velocity.w=q,this.m_bodyC.c_velocity.v.setVec2(Y),this.m_bodyC.c_velocity.w=te,this.m_bodyD.c_velocity.v.setVec2(ne),this.m_bodyD.c_velocity.w=ae},_.prototype.solvePositionConstraints=function(T){var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=this.m_bodyC.c_position.c,te=this.m_bodyC.c_position.a,ne=this.m_bodyD.c_position.c,ae=this.m_bodyD.c_position.a,le=Rot.neo(W),ue=Rot.neo(q),ge=Rot.neo(te),ye=Rot.neo(ae),xe=0,Te,Ae,Ie,Ve,$e,We,Ue,je,ze=0;if(this.m_type1==RevoluteJoint.TYPE)Ie=Vec2.zero(),$e=1,Ue=1,ze+=this.m_iA+this.m_iC,Te=W-te-this.m_referenceAngleA;else{var He=Rot.mulVec2(ge,this.m_localAxisC),Le=Rot.mulSub(ge,this.m_localAnchorC,this.m_lcC),qe=Rot.mulSub(le,this.m_localAnchorA,this.m_lcA);Ie=He,Ue=Vec2.crossVec2Vec2(Le,He),$e=Vec2.crossVec2Vec2(qe,He),ze+=this.m_mC+this.m_mA+this.m_iC*Ue*Ue+this.m_iA*$e*$e;var Qe=Vec2.sub(this.m_localAnchorC,this.m_lcC),Ke=Rot.mulTVec2(ge,Vec2.add(qe,Vec2.sub(E,Y)));Te=Vec2.dot(Vec2.sub(Ke,Qe),this.m_localAxisC)}if(this.m_type2==RevoluteJoint.TYPE)Ve=Vec2.zero(),We=this.m_ratio,je=this.m_ratio,ze+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),Ae=q-ae-this.m_referenceAngleB;else{var He=Rot.mulVec2(ye,this.m_localAxisD),Je=Rot.mulSub(ye,this.m_localAnchorD,this.m_lcD),pt=Rot.mulSub(ue,this.m_localAnchorB,this.m_lcB);Ve=Vec2.mulNumVec2(this.m_ratio,He),je=this.m_ratio*Vec2.crossVec2Vec2(Je,He),We=this.m_ratio*Vec2.crossVec2Vec2(pt,He),ze+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*je*je+this.m_iB*We*We;var ut=Vec2.sub(this.m_localAnchorD,this.m_lcD),lt=Rot.mulTVec2(ye,Vec2.add(pt,Vec2.sub(X,ne)));Ae=Vec2.dot(lt,this.m_localAxisD)-Vec2.dot(ut,this.m_localAxisD)}var st=Te+this.m_ratio*Ae-this.m_constant,sr=0;return ze>0&&(sr=-st/ze),E.addMul(this.m_mA*sr,Ie),W+=this.m_iA*sr*$e,X.addMul(this.m_mB*sr,Ve),q+=this.m_iB*sr*We,Y.subMul(this.m_mC*sr,Ie),te-=this.m_iC*sr*Ue,ne.subMul(this.m_mD*sr,Ve),ae-=this.m_iD*sr*je,this.m_bodyA.c_position.c.setVec2(E),this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c.setVec2(X),this.m_bodyB.c_position.a=q,this.m_bodyC.c_position.c.setVec2(Y),this.m_bodyC.c_position.a=te,this.m_bodyD.c_position.c.setVec2(ne),this.m_bodyD.c_position.a=ae,xe<SettingsInternal.linearSlop},_.TYPE="gear-joint",_}(Joint),DEFAULTS$5={maxForce:1,maxTorque:1,correctionFactor:.3},MotorJoint=function(B){__extends(_,B);function _(T,E,W){var X=this;return X instanceof _?(T=options(T,DEFAULTS$5),X=B.call(this,T,E,W)||this,E=X.m_bodyA,W=X.m_bodyB,X.m_type=_.TYPE,X.m_linearOffset=Vec2.isValid(T.linearOffset)?Vec2.clone(T.linearOffset):E.getLocalPoint(W.getPosition()),X.m_angularOffset=Number.isFinite(T.angularOffset)?T.angularOffset:W.getAngle()-E.getAngle(),X.m_linearImpulse=Vec2.zero(),X.m_angularImpulse=0,X.m_maxForce=T.maxForce,X.m_maxTorque=T.maxTorque,X.m_correctionFactor=T.correctionFactor,X):new _(T,E,W)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,correctionFactor:this.m_correctionFactor,linearOffset:this.m_linearOffset,angularOffset:this.m_angularOffset}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){Number.isFinite(T.angularOffset)&&(this.m_angularOffset=T.angularOffset),Number.isFinite(T.maxForce)&&(this.m_maxForce=T.maxForce),Number.isFinite(T.maxTorque)&&(this.m_maxTorque=T.maxTorque),Number.isFinite(T.correctionFactor)&&(this.m_correctionFactor=T.correctionFactor),Vec2.isValid(T.linearOffset)&&this.m_linearOffset.set(T.linearOffset)},_.prototype.setMaxForce=function(T){this.m_maxForce=T},_.prototype.getMaxForce=function(){return this.m_maxForce},_.prototype.setMaxTorque=function(T){this.m_maxTorque=T},_.prototype.getMaxTorque=function(){return this.m_maxTorque},_.prototype.setCorrectionFactor=function(T){this.m_correctionFactor=T},_.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},_.prototype.setLinearOffset=function(T){(T.x!=this.m_linearOffset.x||T.y!=this.m_linearOffset.y)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset.set(T))},_.prototype.getLinearOffset=function(){return this.m_linearOffset},_.prototype.setAngularOffset=function(T){T!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=T)},_.prototype.getAngularOffset=function(){return this.m_angularOffset},_.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},_.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},_.prototype.getReactionForce=function(T){return Vec2.mulNumVec2(T,this.m_linearImpulse)},_.prototype.getReactionTorque=function(T){return T*this.m_angularImpulse},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyA.c_velocity.v,q=this.m_bodyA.c_velocity.w,Y=this.m_bodyB.c_position.c,te=this.m_bodyB.c_position.a,ne=this.m_bodyB.c_velocity.v,ae=this.m_bodyB.c_velocity.w,le=Rot.neo(W),ue=Rot.neo(te);this.m_rA=Rot.mulVec2(le,Vec2.sub(this.m_linearOffset,this.m_localCenterA)),this.m_rB=Rot.mulVec2(ue,Vec2.neg(this.m_localCenterB));var ge=this.m_invMassA,ye=this.m_invMassB,xe=this.m_invIA,Te=this.m_invIB,Ae=new Mat22;if(Ae.ex.x=ge+ye+xe*this.m_rA.y*this.m_rA.y+Te*this.m_rB.y*this.m_rB.y,Ae.ex.y=-xe*this.m_rA.x*this.m_rA.y-Te*this.m_rB.x*this.m_rB.y,Ae.ey.x=Ae.ex.y,Ae.ey.y=ge+ye+xe*this.m_rA.x*this.m_rA.x+Te*this.m_rB.x*this.m_rB.x,this.m_linearMass=Ae.getInverse(),this.m_angularMass=xe+Te,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=Vec2.zero(),this.m_linearError.addCombine(1,Y,1,this.m_rB),this.m_linearError.subCombine(1,E,1,this.m_rA),this.m_angularError=te-W-this.m_angularOffset,T.warmStarting){this.m_linearImpulse.mul(T.dtRatio),this.m_angularImpulse*=T.dtRatio;var Ie=Vec2.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);X.subMul(ge,Ie),q-=xe*(Vec2.crossVec2Vec2(this.m_rA,Ie)+this.m_angularImpulse),ne.addMul(ye,Ie),ae+=Te*(Vec2.crossVec2Vec2(this.m_rB,Ie)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=X,this.m_bodyA.c_velocity.w=q,this.m_bodyB.c_velocity.v=ne,this.m_bodyB.c_velocity.w=ae},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=this.m_invMassA,te=this.m_invMassB,ne=this.m_invIA,ae=this.m_invIB,le=T.dt,ue=T.inv_dt;{var ge=q-W+ue*this.m_correctionFactor*this.m_angularError,ye=-this.m_angularMass*ge,xe=this.m_angularImpulse,Te=le*this.m_maxTorque;this.m_angularImpulse=clamp(this.m_angularImpulse+ye,-Te,Te),ye=this.m_angularImpulse-xe,W-=ne*ye,q+=ae*ye}{var ge=Vec2.zero();ge.addCombine(1,X,1,Vec2.crossNumVec2(q,this.m_rB)),ge.subCombine(1,E,1,Vec2.crossNumVec2(W,this.m_rA)),ge.addMul(ue*this.m_correctionFactor,this.m_linearError);var ye=Vec2.neg(Mat22.mulVec2(this.m_linearMass,ge)),xe=Vec2.clone(this.m_linearImpulse);this.m_linearImpulse.add(ye);var Te=le*this.m_maxForce;this.m_linearImpulse.clamp(Te),ye=Vec2.sub(this.m_linearImpulse,xe),E.subMul(Y,ye),W-=ne*Vec2.crossVec2Vec2(this.m_rA,ye),X.addMul(te,ye),q+=ae*Vec2.crossVec2Vec2(this.m_rB,ye)}this.m_bodyA.c_velocity.v=E,this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v=X,this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){return!0},_.TYPE="motor-joint",_}(Joint),math_PI$2=Math.PI,DEFAULTS$4={maxForce:0,frequencyHz:5,dampingRatio:.7},MouseJoint=function(B){__extends(_,B);function _(T,E,W,X){var q=this;return q instanceof _?(T=options(T,DEFAULTS$4),q=B.call(this,T,E,W)||this,E=q.m_bodyA,W=q.m_bodyB,q.m_type=_.TYPE,Vec2.isValid(X)?q.m_targetA=Vec2.clone(X):Vec2.isValid(T.target)?q.m_targetA=Vec2.clone(T.target):q.m_targetA=Vec2.zero(),q.m_localAnchorB=Transform.mulTVec2(W.getTransform(),q.m_targetA),q.m_maxForce=T.maxForce,q.m_impulse=Vec2.zero(),q.m_frequencyHz=T.frequencyHz,q.m_dampingRatio=T.dampingRatio,q.m_beta=0,q.m_gamma=0,q.m_rB=Vec2.zero(),q.m_localCenterB=Vec2.zero(),q.m_invMassB=0,q.m_invIB=0,q.m_mass=new Mat22,q.m_C=Vec2.zero(),q):new _(T,E,W,X)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,target:this.m_targetA,maxForce:this.m_maxForce,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,_localAnchorB:this.m_localAnchorB}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E),T.target=Vec2.clone(T.target);var X=new _(T);return T._localAnchorB&&(X.m_localAnchorB=T._localAnchorB),X},_.prototype._reset=function(T){Number.isFinite(T.maxForce)&&(this.m_maxForce=T.maxForce),Number.isFinite(T.frequencyHz)&&(this.m_frequencyHz=T.frequencyHz),Number.isFinite(T.dampingRatio)&&(this.m_dampingRatio=T.dampingRatio)},_.prototype.setTarget=function(T){Vec2.areEqual(T,this.m_targetA)||(this.m_bodyB.setAwake(!0),this.m_targetA.set(T))},_.prototype.getTarget=function(){return this.m_targetA},_.prototype.setMaxForce=function(T){this.m_maxForce=T},_.prototype.getMaxForce=function(){return this.m_maxForce},_.prototype.setFrequency=function(T){this.m_frequencyHz=T},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(T){this.m_dampingRatio=T},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return Vec2.clone(this.m_targetA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.mulNumVec2(T,this.m_impulse)},_.prototype.getReactionTorque=function(T){return T*0},_.prototype.shiftOrigin=function(T){this.m_targetA.sub(T)},_.prototype.initVelocityConstraints=function(T){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyB.c_position,W=this.m_bodyB.c_velocity,X=E.c,q=E.a,Y=W.v,te=W.w,ne=Rot.neo(q),ae=this.m_bodyB.getMass(),le=2*math_PI$2*this.m_frequencyHz,ue=2*ae*this.m_dampingRatio*le,ge=ae*(le*le),ye=T.dt;this.m_gamma=ye*(ue+ye*ge),this.m_gamma!=0&&(this.m_gamma=1/this.m_gamma),this.m_beta=ye*ge*this.m_gamma,this.m_rB=Rot.mulVec2(ne,Vec2.sub(this.m_localAnchorB,this.m_localCenterB));var xe=new Mat22;xe.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,xe.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,xe.ey.x=xe.ex.y,xe.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=xe.getInverse(),this.m_C.setVec2(X),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),te*=.98,T.warmStarting?(this.m_impulse.mul(T.dtRatio),Y.addMul(this.m_invMassB,this.m_impulse),te+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),W.v.setVec2(Y),W.w=te},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyB.c_velocity,W=Vec2.clone(E.v),X=E.w,q=Vec2.crossNumVec2(X,this.m_rB);q.add(W),q.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),q.neg();var Y=Mat22.mulVec2(this.m_mass,q),te=Vec2.clone(this.m_impulse);this.m_impulse.add(Y);var ne=T.dt*this.m_maxForce;this.m_impulse.clamp(ne),Y=Vec2.sub(this.m_impulse,te),W.addMul(this.m_invMassB,Y),X+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,Y),E.v.setVec2(W),E.w=X},_.prototype.solvePositionConstraints=function(T){return!0},_.TYPE="mouse-joint",_}(Joint),math_abs$2=Math.abs,DEFAULTS$3={collideConnected:!0},PulleyJoint=function(B){__extends(_,B);function _(T,E,W,X,q,Y,te,ne){var ae=this;return ae instanceof _?(T=options(T,DEFAULTS$3),ae=B.call(this,T,E,W)||this,E=ae.m_bodyA,W=ae.m_bodyB,ae.m_type=_.TYPE,ae.m_groundAnchorA=Vec2.clone(X||T.groundAnchorA||Vec2.neo(-1,1)),ae.m_groundAnchorB=Vec2.clone(q||T.groundAnchorB||Vec2.neo(1,1)),ae.m_localAnchorA=Vec2.clone(Y?E.getLocalPoint(Y):T.localAnchorA||Vec2.neo(-1,0)),ae.m_localAnchorB=Vec2.clone(te?W.getLocalPoint(te):T.localAnchorB||Vec2.neo(1,0)),ae.m_lengthA=Number.isFinite(T.lengthA)?T.lengthA:Vec2.distance(Y,X),ae.m_lengthB=Number.isFinite(T.lengthB)?T.lengthB:Vec2.distance(te,q),ae.m_ratio=Number.isFinite(ne)?ne:T.ratio,ae.m_constant=ae.m_lengthA+ae.m_ratio*ae.m_lengthB,ae.m_impulse=0,ae):new _(T,E,W,X,q,Y,te,ne)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,groundAnchorA:this.m_groundAnchorA,groundAnchorB:this.m_groundAnchorB,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,lengthA:this.m_lengthA,lengthB:this.m_lengthB,ratio:this.m_ratio}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){Vec2.isValid(T.groundAnchorA)&&this.m_groundAnchorA.set(T.groundAnchorA),Vec2.isValid(T.groundAnchorB)&&this.m_groundAnchorB.set(T.groundAnchorB),Vec2.isValid(T.localAnchorA)?this.m_localAnchorA.set(T.localAnchorA):Vec2.isValid(T.anchorA)&&this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(T.anchorA)),Vec2.isValid(T.localAnchorB)?this.m_localAnchorB.set(T.localAnchorB):Vec2.isValid(T.anchorB)&&this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(T.anchorB)),Number.isFinite(T.lengthA)&&(this.m_lengthA=T.lengthA),Number.isFinite(T.lengthB)&&(this.m_lengthB=T.lengthB),Number.isFinite(T.ratio)&&(this.m_ratio=T.ratio)},_.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},_.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},_.prototype.getLengthA=function(){return this.m_lengthA},_.prototype.getLengthB=function(){return this.m_lengthB},_.prototype.getRatio=function(){return this.m_ratio},_.prototype.getCurrentLengthA=function(){var T=this.m_bodyA.getWorldPoint(this.m_localAnchorA),E=this.m_groundAnchorA;return Vec2.distance(T,E)},_.prototype.getCurrentLengthB=function(){var T=this.m_bodyB.getWorldPoint(this.m_localAnchorB),E=this.m_groundAnchorB;return Vec2.distance(T,E)},_.prototype.shiftOrigin=function(T){this.m_groundAnchorA.sub(T),this.m_groundAnchorB.sub(T)},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.mulNumVec2(this.m_impulse,this.m_uB).mul(T)},_.prototype.getReactionTorque=function(T){return 0},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyA.c_velocity.v,q=this.m_bodyA.c_velocity.w,Y=this.m_bodyB.c_position.c,te=this.m_bodyB.c_position.a,ne=this.m_bodyB.c_velocity.v,ae=this.m_bodyB.c_velocity.w,le=Rot.neo(W),ue=Rot.neo(te);this.m_rA=Rot.mulVec2(le,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Rot.mulVec2(ue,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=Vec2.sub(Vec2.add(E,this.m_rA),this.m_groundAnchorA),this.m_uB=Vec2.sub(Vec2.add(Y,this.m_rB),this.m_groundAnchorB);var ge=this.m_uA.length(),ye=this.m_uB.length();ge>10*SettingsInternal.linearSlop?this.m_uA.mul(1/ge):this.m_uA.setZero(),ye>10*SettingsInternal.linearSlop?this.m_uB.mul(1/ye):this.m_uB.setZero();var xe=Vec2.crossVec2Vec2(this.m_rA,this.m_uA),Te=Vec2.crossVec2Vec2(this.m_rB,this.m_uB),Ae=this.m_invMassA+this.m_invIA*xe*xe,Ie=this.m_invMassB+this.m_invIB*Te*Te;if(this.m_mass=Ae+this.m_ratio*this.m_ratio*Ie,this.m_mass>0&&(this.m_mass=1/this.m_mass),T.warmStarting){this.m_impulse*=T.dtRatio;var Ve=Vec2.mulNumVec2(-this.m_impulse,this.m_uA),$e=Vec2.mulNumVec2(-this.m_ratio*this.m_impulse,this.m_uB);X.addMul(this.m_invMassA,Ve),q+=this.m_invIA*Vec2.crossVec2Vec2(this.m_rA,Ve),ne.addMul(this.m_invMassB,$e),ae+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,$e)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=X,this.m_bodyA.c_velocity.w=q,this.m_bodyB.c_velocity.v=ne,this.m_bodyB.c_velocity.w=ae},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=Vec2.add(E,Vec2.crossNumVec2(W,this.m_rA)),te=Vec2.add(X,Vec2.crossNumVec2(q,this.m_rB)),ne=-Vec2.dot(this.m_uA,Y)-this.m_ratio*Vec2.dot(this.m_uB,te),ae=-this.m_mass*ne;this.m_impulse+=ae;var le=Vec2.mulNumVec2(-ae,this.m_uA),ue=Vec2.mulNumVec2(-this.m_ratio*ae,this.m_uB);E.addMul(this.m_invMassA,le),W+=this.m_invIA*Vec2.crossVec2Vec2(this.m_rA,le),X.addMul(this.m_invMassB,ue),q+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,ue),this.m_bodyA.c_velocity.v=E,this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v=X,this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=Rot.neo(W),te=Rot.neo(q),ne=Rot.mulVec2(Y,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),ae=Rot.mulVec2(te,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),le=Vec2.sub(Vec2.add(E,this.m_rA),this.m_groundAnchorA),ue=Vec2.sub(Vec2.add(X,this.m_rB),this.m_groundAnchorB),ge=le.length(),ye=ue.length();ge>10*SettingsInternal.linearSlop?le.mul(1/ge):le.setZero(),ye>10*SettingsInternal.linearSlop?ue.mul(1/ye):ue.setZero();var xe=Vec2.crossVec2Vec2(ne,le),Te=Vec2.crossVec2Vec2(ae,ue),Ae=this.m_invMassA+this.m_invIA*xe*xe,Ie=this.m_invMassB+this.m_invIB*Te*Te,Ve=Ae+this.m_ratio*this.m_ratio*Ie;Ve>0&&(Ve=1/Ve);var $e=this.m_constant-ge-this.m_ratio*ye,We=math_abs$2($e),Ue=-Ve*$e,je=Vec2.mulNumVec2(-Ue,le),ze=Vec2.mulNumVec2(-this.m_ratio*Ue,ue);return E.addMul(this.m_invMassA,je),W+=this.m_invIA*Vec2.crossVec2Vec2(ne,je),X.addMul(this.m_invMassB,ze),q+=this.m_invIB*Vec2.crossVec2Vec2(ae,ze),this.m_bodyA.c_position.c=E,this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c=X,this.m_bodyB.c_position.a=q,We<SettingsInternal.linearSlop},_.TYPE="pulley-joint",_}(Joint),math_min$1=Math.min,LimitState;(function(B){B[B.inactiveLimit=0]="inactiveLimit",B[B.atLowerLimit=1]="atLowerLimit",B[B.atUpperLimit=2]="atUpperLimit",B[B.equalLimits=3]="equalLimits"})(LimitState||(LimitState={}));var DEFAULTS$2={maxLength:0},RopeJoint=function(B){__extends(_,B);function _(T,E,W,X){var q=this;return q instanceof _?(T=options(T,DEFAULTS$2),q=B.call(this,T,E,W)||this,E=q.m_bodyA,W=q.m_bodyB,q.m_type=_.TYPE,q.m_localAnchorA=Vec2.clone(X?E.getLocalPoint(X):T.localAnchorA||Vec2.neo(-1,0)),q.m_localAnchorB=Vec2.clone(X?W.getLocalPoint(X):T.localAnchorB||Vec2.neo(1,0)),q.m_maxLength=T.maxLength,q.m_mass=0,q.m_impulse=0,q.m_length=0,q.m_state=LimitState.inactiveLimit,q):new _(T,E,W,X)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,maxLength:this.m_maxLength}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){Number.isFinite(T.maxLength)&&(this.m_maxLength=T.maxLength)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.setMaxLength=function(T){this.m_maxLength=T},_.prototype.getMaxLength=function(){return this.m_maxLength},_.prototype.getLimitState=function(){return this.m_state},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.mulNumVec2(this.m_impulse,this.m_u).mul(T)},_.prototype.getReactionTorque=function(T){return 0},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyA.c_velocity.v,q=this.m_bodyA.c_velocity.w,Y=this.m_bodyB.c_position.c,te=this.m_bodyB.c_position.a,ne=this.m_bodyB.c_velocity.v,ae=this.m_bodyB.c_velocity.w,le=Rot.neo(W),ue=Rot.neo(te);this.m_rA=Rot.mulSub(le,this.m_localAnchorA,this.m_localCenterA),this.m_rB=Rot.mulSub(ue,this.m_localAnchorB,this.m_localCenterB),this.m_u=Vec2.zero(),this.m_u.addCombine(1,Y,1,this.m_rB),this.m_u.subCombine(1,E,1,this.m_rA),this.m_length=this.m_u.length();var ge=this.m_length-this.m_maxLength;if(ge>0?this.m_state=LimitState.atUpperLimit:this.m_state=LimitState.inactiveLimit,this.m_length>SettingsInternal.linearSlop)this.m_u.mul(1/this.m_length);else{this.m_u.setZero(),this.m_mass=0,this.m_impulse=0;return}var ye=Vec2.crossVec2Vec2(this.m_rA,this.m_u),xe=Vec2.crossVec2Vec2(this.m_rB,this.m_u),Te=this.m_invMassA+this.m_invIA*ye*ye+this.m_invMassB+this.m_invIB*xe*xe;if(this.m_mass=Te!=0?1/Te:0,T.warmStarting){this.m_impulse*=T.dtRatio;var Ae=Vec2.mulNumVec2(this.m_impulse,this.m_u);X.subMul(this.m_invMassA,Ae),q-=this.m_invIA*Vec2.crossVec2Vec2(this.m_rA,Ae),ne.addMul(this.m_invMassB,Ae),ae+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,Ae)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(X),this.m_bodyA.c_velocity.w=q,this.m_bodyB.c_velocity.v.setVec2(ne),this.m_bodyB.c_velocity.w=ae},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=Vec2.addCrossNumVec2(E,W,this.m_rA),te=Vec2.addCrossNumVec2(X,q,this.m_rB),ne=this.m_length-this.m_maxLength,ae=Vec2.dot(this.m_u,Vec2.sub(te,Y));ne<0&&(ae+=T.inv_dt*ne);var le=-this.m_mass*ae,ue=this.m_impulse;this.m_impulse=math_min$1(0,this.m_impulse+le),le=this.m_impulse-ue;var ge=Vec2.mulNumVec2(le,this.m_u);E.subMul(this.m_invMassA,ge),W-=this.m_invIA*Vec2.crossVec2Vec2(this.m_rA,ge),X.addMul(this.m_invMassB,ge),q+=this.m_invIB*Vec2.crossVec2Vec2(this.m_rB,ge),this.m_bodyA.c_velocity.v=E,this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v=X,this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=Rot.neo(W),te=Rot.neo(q),ne=Rot.mulSub(Y,this.m_localAnchorA,this.m_localCenterA),ae=Rot.mulSub(te,this.m_localAnchorB,this.m_localCenterB),le=Vec2.zero();le.addCombine(1,X,1,ae),le.subCombine(1,E,1,ne);var ue=le.normalize(),ge=ue-this.m_maxLength;ge=clamp(ge,0,SettingsInternal.maxLinearCorrection);var ye=-this.m_mass*ge,xe=Vec2.mulNumVec2(ye,le);return E.subMul(this.m_invMassA,xe),W-=this.m_invIA*Vec2.crossVec2Vec2(ne,xe),X.addMul(this.m_invMassB,xe),q+=this.m_invIB*Vec2.crossVec2Vec2(ae,xe),this.m_bodyA.c_position.c.setVec2(E),this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c.setVec2(X),this.m_bodyB.c_position.a=q,ue-this.m_maxLength<SettingsInternal.linearSlop},_.TYPE="rope-joint",_}(Joint),math_abs$1=Math.abs,math_PI$1=Math.PI,DEFAULTS$1={frequencyHz:0,dampingRatio:0},WeldJoint=function(B){__extends(_,B);function _(T,E,W,X){var q=this;return q instanceof _?(T=options(T,DEFAULTS$1),q=B.call(this,T,E,W)||this,E=q.m_bodyA,W=q.m_bodyB,q.m_type=_.TYPE,q.m_localAnchorA=Vec2.clone(X?E.getLocalPoint(X):T.localAnchorA||Vec2.zero()),q.m_localAnchorB=Vec2.clone(X?W.getLocalPoint(X):T.localAnchorB||Vec2.zero()),q.m_referenceAngle=Number.isFinite(T.referenceAngle)?T.referenceAngle:W.getAngle()-E.getAngle(),q.m_frequencyHz=T.frequencyHz,q.m_dampingRatio=T.dampingRatio,q.m_impulse=new Vec3,q.m_bias=0,q.m_gamma=0,q.m_mass=new Mat33,q):new _(T,E,W,X)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){T.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(T.anchorA)):T.localAnchorA&&this.m_localAnchorA.setVec2(T.localAnchorA),T.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(T.anchorB)):T.localAnchorB&&this.m_localAnchorB.setVec2(T.localAnchorB),Number.isFinite(T.frequencyHz)&&(this.m_frequencyHz=T.frequencyHz),Number.isFinite(T.dampingRatio)&&(this.m_dampingRatio=T.dampingRatio)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.getReferenceAngle=function(){return this.m_referenceAngle},_.prototype.setFrequency=function(T){this.m_frequencyHz=T},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(T){this.m_dampingRatio=T},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.neo(this.m_impulse.x,this.m_impulse.y).mul(T)},_.prototype.getReactionTorque=function(T){return T*this.m_impulse.z},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_bodyA.c_position.a,W=this.m_bodyA.c_velocity.v,X=this.m_bodyA.c_velocity.w,q=this.m_bodyB.c_position.a,Y=this.m_bodyB.c_velocity.v,te=this.m_bodyB.c_velocity.w,ne=Rot.neo(E),ae=Rot.neo(q);this.m_rA=Rot.mulVec2(ne,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=Rot.mulVec2(ae,Vec2.sub(this.m_localAnchorB,this.m_localCenterB));var le=this.m_invMassA,ue=this.m_invMassB,ge=this.m_invIA,ye=this.m_invIB,xe=new Mat33;if(xe.ex.x=le+ue+this.m_rA.y*this.m_rA.y*ge+this.m_rB.y*this.m_rB.y*ye,xe.ey.x=-this.m_rA.y*this.m_rA.x*ge-this.m_rB.y*this.m_rB.x*ye,xe.ez.x=-this.m_rA.y*ge-this.m_rB.y*ye,xe.ex.y=xe.ey.x,xe.ey.y=le+ue+this.m_rA.x*this.m_rA.x*ge+this.m_rB.x*this.m_rB.x*ye,xe.ez.y=this.m_rA.x*ge+this.m_rB.x*ye,xe.ex.z=xe.ez.x,xe.ey.z=xe.ez.y,xe.ez.z=ge+ye,this.m_frequencyHz>0){xe.getInverse22(this.m_mass);var Te=ge+ye,Ae=Te>0?1/Te:0,Ie=q-E-this.m_referenceAngle,Ve=2*math_PI$1*this.m_frequencyHz,$e=2*Ae*this.m_dampingRatio*Ve,We=Ae*Ve*Ve,Ue=T.dt;this.m_gamma=Ue*($e+Ue*We),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=Ie*Ue*We*this.m_gamma,Te+=this.m_gamma,this.m_mass.ez.z=Te!=0?1/Te:0}else xe.ez.z==0?(xe.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(xe.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(T.warmStarting){this.m_impulse.mul(T.dtRatio);var je=Vec2.neo(this.m_impulse.x,this.m_impulse.y);W.subMul(le,je),X-=ge*(Vec2.crossVec2Vec2(this.m_rA,je)+this.m_impulse.z),Y.addMul(ue,je),te+=ye*(Vec2.crossVec2Vec2(this.m_rB,je)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=W,this.m_bodyA.c_velocity.w=X,this.m_bodyB.c_velocity.v=Y,this.m_bodyB.c_velocity.w=te},_.prototype.solveVelocityConstraints=function(T){var E=this.m_bodyA.c_velocity.v,W=this.m_bodyA.c_velocity.w,X=this.m_bodyB.c_velocity.v,q=this.m_bodyB.c_velocity.w,Y=this.m_invMassA,te=this.m_invMassB,ne=this.m_invIA,ae=this.m_invIB;if(this.m_frequencyHz>0){var le=q-W,ue=-this.m_mass.ez.z*(le+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=ue,W-=ne*ue,q+=ae*ue;var ge=Vec2.zero();ge.addCombine(1,X,1,Vec2.crossNumVec2(q,this.m_rB)),ge.subCombine(1,E,1,Vec2.crossNumVec2(W,this.m_rA));var ye=Vec2.neg(Mat33.mulVec2(this.m_mass,ge));this.m_impulse.x+=ye.x,this.m_impulse.y+=ye.y;var xe=Vec2.clone(ye);E.subMul(Y,xe),W-=ne*Vec2.crossVec2Vec2(this.m_rA,xe),X.addMul(te,xe),q+=ae*Vec2.crossVec2Vec2(this.m_rB,xe)}else{var ge=Vec2.zero();ge.addCombine(1,X,1,Vec2.crossNumVec2(q,this.m_rB)),ge.subCombine(1,E,1,Vec2.crossNumVec2(W,this.m_rA));var le=q-W,Te=new Vec3(ge.x,ge.y,le),Ae=Vec3.neg(Mat33.mulVec3(this.m_mass,Te));this.m_impulse.add(Ae);var xe=Vec2.neo(Ae.x,Ae.y);E.subMul(Y,xe),W-=ne*(Vec2.crossVec2Vec2(this.m_rA,xe)+Ae.z),X.addMul(te,xe),q+=ae*(Vec2.crossVec2Vec2(this.m_rB,xe)+Ae.z)}this.m_bodyA.c_velocity.v=E,this.m_bodyA.c_velocity.w=W,this.m_bodyB.c_velocity.v=X,this.m_bodyB.c_velocity.w=q},_.prototype.solvePositionConstraints=function(T){var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=Rot.neo(W),te=Rot.neo(q),ne=this.m_invMassA,ae=this.m_invMassB,le=this.m_invIA,ue=this.m_invIB,ge=Rot.mulVec2(Y,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),ye=Rot.mulVec2(te,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),xe,Te,Ae=new Mat33;if(Ae.ex.x=ne+ae+ge.y*ge.y*le+ye.y*ye.y*ue,Ae.ey.x=-ge.y*ge.x*le-ye.y*ye.x*ue,Ae.ez.x=-ge.y*le-ye.y*ue,Ae.ex.y=Ae.ey.x,Ae.ey.y=ne+ae+ge.x*ge.x*le+ye.x*ye.x*ue,Ae.ez.y=ge.x*le+ye.x*ue,Ae.ex.z=Ae.ez.x,Ae.ey.z=Ae.ez.y,Ae.ez.z=le+ue,this.m_frequencyHz>0){var Ie=Vec2.zero();Ie.addCombine(1,X,1,ye),Ie.subCombine(1,E,1,ge),xe=Ie.length(),Te=0;var Ve=Vec2.neg(Ae.solve22(Ie));E.subMul(ne,Ve),W-=le*Vec2.crossVec2Vec2(ge,Ve),X.addMul(ae,Ve),q+=ue*Vec2.crossVec2Vec2(ye,Ve)}else{var Ie=Vec2.zero();Ie.addCombine(1,X,1,ye),Ie.subCombine(1,E,1,ge);var $e=q-W-this.m_referenceAngle;xe=Ie.length(),Te=math_abs$1($e);var We=new Vec3(Ie.x,Ie.y,$e),Ue=new Vec3;if(Ae.ez.z>0)Ue=Vec3.neg(Ae.solve33(We));else{var je=Vec2.neg(Ae.solve22(Ie));Ue.set(je.x,je.y,0)}var Ve=Vec2.neo(Ue.x,Ue.y);E.subMul(ne,Ve),W-=le*(Vec2.crossVec2Vec2(ge,Ve)+Ue.z),X.addMul(ae,Ve),q+=ue*(Vec2.crossVec2Vec2(ye,Ve)+Ue.z)}return this.m_bodyA.c_position.c=E,this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c=X,this.m_bodyB.c_position.a=q,xe<=SettingsInternal.linearSlop&&Te<=SettingsInternal.angularSlop},_.TYPE="weld-joint",_}(Joint),math_abs=Math.abs,math_PI=Math.PI,DEFAULTS={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7},WheelJoint=function(B){__extends(_,B);function _(T,E,W,X,q){var Y=this;return Y instanceof _?(T=options(T,DEFAULTS),Y=B.call(this,T,E,W)||this,E=Y.m_bodyA,W=Y.m_bodyB,Y.m_ax=Vec2.zero(),Y.m_ay=Vec2.zero(),Y.m_type=_.TYPE,Y.m_localAnchorA=Vec2.clone(X?E.getLocalPoint(X):T.localAnchorA||Vec2.zero()),Y.m_localAnchorB=Vec2.clone(X?W.getLocalPoint(X):T.localAnchorB||Vec2.zero()),Vec2.isValid(q)?Y.m_localXAxisA=E.getLocalVector(q):Vec2.isValid(T.localAxisA)?Y.m_localXAxisA=Vec2.clone(T.localAxisA):Vec2.isValid(T.localAxis)?Y.m_localXAxisA=Vec2.clone(T.localAxis):Y.m_localXAxisA=Vec2.neo(1,0),Y.m_localYAxisA=Vec2.crossNumVec2(1,Y.m_localXAxisA),Y.m_mass=0,Y.m_impulse=0,Y.m_motorMass=0,Y.m_motorImpulse=0,Y.m_springMass=0,Y.m_springImpulse=0,Y.m_maxMotorTorque=T.maxMotorTorque,Y.m_motorSpeed=T.motorSpeed,Y.m_enableMotor=T.enableMotor,Y.m_frequencyHz=T.frequencyHz,Y.m_dampingRatio=T.dampingRatio,Y.m_bias=0,Y.m_gamma=0,Y):new _(T,E,W,X,q)}return _.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,enableMotor:this.m_enableMotor,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA}},_._deserialize=function(T,E,W){T=__assign({},T),T.bodyA=W(Body,T.bodyA,E),T.bodyB=W(Body,T.bodyB,E);var X=new _(T);return X},_.prototype._reset=function(T){T.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(T.anchorA)):T.localAnchorA&&this.m_localAnchorA.setVec2(T.localAnchorA),T.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(T.anchorB)):T.localAnchorB&&this.m_localAnchorB.setVec2(T.localAnchorB),T.localAxisA&&(this.m_localXAxisA.setVec2(T.localAxisA),this.m_localYAxisA.setVec2(Vec2.crossNumVec2(1,T.localAxisA))),T.enableMotor!==void 0&&(this.m_enableMotor=T.enableMotor),Number.isFinite(T.maxMotorTorque)&&(this.m_maxMotorTorque=T.maxMotorTorque),Number.isFinite(T.motorSpeed)&&(this.m_motorSpeed=T.motorSpeed),Number.isFinite(T.frequencyHz)&&(this.m_frequencyHz=T.frequencyHz),Number.isFinite(T.dampingRatio)&&(this.m_dampingRatio=T.dampingRatio)},_.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},_.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},_.prototype.getLocalAxisA=function(){return this.m_localXAxisA},_.prototype.getJointTranslation=function(){var T=this.m_bodyA,E=this.m_bodyB,W=T.getWorldPoint(this.m_localAnchorA),X=E.getWorldPoint(this.m_localAnchorB),q=Vec2.sub(X,W),Y=T.getWorldVector(this.m_localXAxisA),te=Vec2.dot(q,Y);return te},_.prototype.getJointSpeed=function(){var T=this.m_bodyA.m_angularVelocity,E=this.m_bodyB.m_angularVelocity;return E-T},_.prototype.isMotorEnabled=function(){return this.m_enableMotor},_.prototype.enableMotor=function(T){T!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=T)},_.prototype.setMotorSpeed=function(T){T!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=T)},_.prototype.getMotorSpeed=function(){return this.m_motorSpeed},_.prototype.setMaxMotorTorque=function(T){T!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=T)},_.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},_.prototype.getMotorTorque=function(T){return T*this.m_motorImpulse},_.prototype.setSpringFrequencyHz=function(T){this.m_frequencyHz=T},_.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},_.prototype.setSpringDampingRatio=function(T){this.m_dampingRatio=T},_.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(T){return Vec2.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(T)},_.prototype.getReactionTorque=function(T){return T*this.m_motorImpulse},_.prototype.initVelocityConstraints=function(T){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var E=this.m_invMassA,W=this.m_invMassB,X=this.m_invIA,q=this.m_invIB,Y=this.m_bodyA.c_position.c,te=this.m_bodyA.c_position.a,ne=this.m_bodyA.c_velocity.v,ae=this.m_bodyA.c_velocity.w,le=this.m_bodyB.c_position.c,ue=this.m_bodyB.c_position.a,ge=this.m_bodyB.c_velocity.v,ye=this.m_bodyB.c_velocity.w,xe=Rot.neo(te),Te=Rot.neo(ue),Ae=Rot.mulVec2(xe,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),Ie=Rot.mulVec2(Te,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),Ve=Vec2.zero();if(Ve.addCombine(1,le,1,Ie),Ve.subCombine(1,Y,1,Ae),this.m_ay=Rot.mulVec2(xe,this.m_localYAxisA),this.m_sAy=Vec2.crossVec2Vec2(Vec2.add(Ve,Ae),this.m_ay),this.m_sBy=Vec2.crossVec2Vec2(Ie,this.m_ay),this.m_mass=E+W+X*this.m_sAy*this.m_sAy+q*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=Rot.mulVec2(xe,this.m_localXAxisA),this.m_sAx=Vec2.crossVec2Vec2(Vec2.add(Ve,Ae),this.m_ax),this.m_sBx=Vec2.crossVec2Vec2(Ie,this.m_ax);var $e=E+W+X*this.m_sAx*this.m_sAx+q*this.m_sBx*this.m_sBx;if($e>0){this.m_springMass=1/$e;var We=Vec2.dot(Ve,this.m_ax),Ue=2*math_PI*this.m_frequencyHz,je=2*this.m_springMass*this.m_dampingRatio*Ue,ze=this.m_springMass*Ue*Ue,He=T.dt;this.m_gamma=He*(je+He*ze),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=We*He*ze*this.m_gamma,this.m_springMass=$e+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=X+q,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),T.warmStarting){this.m_impulse*=T.dtRatio,this.m_springImpulse*=T.dtRatio,this.m_motorImpulse*=T.dtRatio;var Le=Vec2.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),qe=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,Qe=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;ne.subMul(this.m_invMassA,Le),ae-=this.m_invIA*qe,ge.addMul(this.m_invMassB,Le),ye+=this.m_invIB*Qe}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(ne),this.m_bodyA.c_velocity.w=ae,this.m_bodyB.c_velocity.v.setVec2(ge),this.m_bodyB.c_velocity.w=ye},_.prototype.solveVelocityConstraints=function(T){var E=this.m_invMassA,W=this.m_invMassB,X=this.m_invIA,q=this.m_invIB,Y=this.m_bodyA.c_velocity.v,te=this.m_bodyA.c_velocity.w,ne=this.m_bodyB.c_velocity.v,ae=this.m_bodyB.c_velocity.w;{var le=Vec2.dot(this.m_ax,ne)-Vec2.dot(this.m_ax,Y)+this.m_sBx*ae-this.m_sAx*te,ue=-this.m_springMass*(le+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=ue;var ge=Vec2.mulNumVec2(ue,this.m_ax),ye=ue*this.m_sAx,xe=ue*this.m_sBx;Y.subMul(E,ge),te-=X*ye,ne.addMul(W,ge),ae+=q*xe}{var le=ae-te-this.m_motorSpeed,ue=-this.m_motorMass*le,Te=this.m_motorImpulse,Ae=T.dt*this.m_maxMotorTorque;this.m_motorImpulse=clamp(this.m_motorImpulse+ue,-Ae,Ae),ue=this.m_motorImpulse-Te,te-=X*ue,ae+=q*ue}{var le=Vec2.dot(this.m_ay,ne)-Vec2.dot(this.m_ay,Y)+this.m_sBy*ae-this.m_sAy*te,ue=-this.m_mass*le;this.m_impulse+=ue;var ge=Vec2.mulNumVec2(ue,this.m_ay),ye=ue*this.m_sAy,xe=ue*this.m_sBy;Y.subMul(E,ge),te-=X*ye,ne.addMul(W,ge),ae+=q*xe}this.m_bodyA.c_velocity.v.setVec2(Y),this.m_bodyA.c_velocity.w=te,this.m_bodyB.c_velocity.v.setVec2(ne),this.m_bodyB.c_velocity.w=ae},_.prototype.solvePositionConstraints=function(T){var E=this.m_bodyA.c_position.c,W=this.m_bodyA.c_position.a,X=this.m_bodyB.c_position.c,q=this.m_bodyB.c_position.a,Y=Rot.neo(W),te=Rot.neo(q),ne=Rot.mulVec2(Y,Vec2.sub(this.m_localAnchorA,this.m_localCenterA)),ae=Rot.mulVec2(te,Vec2.sub(this.m_localAnchorB,this.m_localCenterB)),le=Vec2.zero();le.addCombine(1,X,1,ae),le.subCombine(1,E,1,ne);var ue=Rot.mulVec2(Y,this.m_localYAxisA),ge=Vec2.crossVec2Vec2(Vec2.add(le,ne),ue),ye=Vec2.crossVec2Vec2(ae,ue),xe=Vec2.dot(le,ue),Te=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,Ae=Te!=0?-xe/Te:0,Ie=Vec2.mulNumVec2(Ae,ue),Ve=Ae*ge,$e=Ae*ye;return E.subMul(this.m_invMassA,Ie),W-=this.m_invIA*Ve,X.addMul(this.m_invMassB,Ie),q+=this.m_invIB*$e,this.m_bodyA.c_position.c.setVec2(E),this.m_bodyA.c_position.a=W,this.m_bodyB.c_position.c.setVec2(X),this.m_bodyB.c_position.a=q,math_abs(xe)<=SettingsInternal.linearSlop},_.TYPE="wheel-joint",_}(Joint),_a,SID=0,SERIALIZE_REF_TYPES={World,Body,Joint,Fixture,Shape},DESERIALIZE_BY_REF_TYPE={Vec2,Vec3,World,Body,Joint,Fixture,Shape},DESERIALIZE_BY_TYPE_FIELD=(_a={},_a[Body.STATIC]=Body,_a[Body.DYNAMIC]=Body,_a[Body.KINEMATIC]=Body,_a[ChainShape.TYPE]=ChainShape,_a[PolygonShape.TYPE]=PolygonShape,_a[EdgeShape.TYPE]=EdgeShape,_a[CircleShape.TYPE]=CircleShape,_a[DistanceJoint.TYPE]=DistanceJoint,_a[FrictionJoint.TYPE]=FrictionJoint,_a[GearJoint.TYPE]=GearJoint,_a[MotorJoint.TYPE]=MotorJoint,_a[MouseJoint.TYPE]=MouseJoint,_a[PrismaticJoint.TYPE]=PrismaticJoint,_a[PulleyJoint.TYPE]=PulleyJoint,_a[RevoluteJoint.TYPE]=RevoluteJoint,_a[RopeJoint.TYPE]=RopeJoint,_a[WeldJoint.TYPE]=WeldJoint,_a[WheelJoint.TYPE]=WheelJoint,_a),DEFAULT_OPTIONS={rootClass:World,preSerialize:function(B){return B},postSerialize:function(B,_){return B},preDeserialize:function(B){return B},postDeserialize:function(B,_){return B}},Serializer=function(){function B(_){var T=this;this.toJson=function(E){var W=T.options.preSerialize,X=T.options.postSerialize,q=[],Y=[E],te={};function ne(ye,xe){if(ye.__sid=ye.__sid||++SID,!te[ye.__sid]){Y.push(ye);var Te=q.length+Y.length,Ae={refIndex:Te,refType:xe};te[ye.__sid]=Ae}return te[ye.__sid]}function ae(ye){ye=W(ye);var xe=ye._serialize();return xe=X(xe,ye),xe}function le(ye,xe){if(xe===void 0&&(xe=!1),typeof ye!="object"||ye===null)return ye;if(typeof ye._serialize=="function"){if(!xe){for(var Te in SERIALIZE_REF_TYPES)if(ye instanceof SERIALIZE_REF_TYPES[Te])return ne(ye,Te)}ye=ae(ye)}if(Array.isArray(ye)){for(var Ae=[],Ie=0;Ie<ye.length;Ie++)Ae[Ie]=le(ye[Ie]);ye=Ae}else{var Ae={};for(var Ie in ye)ye.hasOwnProperty(Ie)&&(Ae[Ie]=le(ye[Ie]));ye=Ae}return ye}for(;Y.length;){var ue=Y.shift(),ge=le(ue,!0);q.push(ge)}return q},this.fromJson=function(E){var W=T.options.preDeserialize,X=T.options.postDeserialize,q=T.options.rootClass,Y={};function te(le,ue,ge){(!le||!le._deserialize)&&(le=DESERIALIZE_BY_TYPE_FIELD[ue.type]);var ye=le&&le._deserialize;if(ye){ue=W(ue);var xe=le._deserialize,Te=xe(ue,ge,ne);return Te=X(Te,ue),Te}}function ne(le,ue,ge){var ye=ue.refIndex&&ue.refType;if(!ye)return te(le,ue,ge);var xe=ue;DESERIALIZE_BY_REF_TYPE[xe.refType]&&(le=DESERIALIZE_BY_REF_TYPE[xe.refType]);var Te=xe.refIndex;if(!Y[Te]){var Ae=E[Te],Ie=te(le,Ae,ge);Y[Te]=Ie}return Y[Te]}var ae=te(q,E[0],null);return ae},this.options=__assign(__assign({},DEFAULT_OPTIONS),_)}return B}(),worldSerializer=new Serializer({rootClass:World});Serializer.fromJson=worldSerializer.fromJson;Serializer.toJson=worldSerializer.toJson;(function(){function B(){this.width=80,this.height=60,this.x=0,this.y=-10,this.scaleY=-1,this.hz=60,this.speed=1,this.background="#222222",this.activeKeys={},this.step=function(_,T){},this.keydown=function(_,T){},this.keyup=function(_,T){}}return B.mount=function(_){throw new Error("Not implemented")},B.start=function(_){var T=B.mount();return T.start(_),T},B.prototype.color=function(_,T,E){return _=_*256|0,T=T*256|0,E=E*256|0,"rgb("+_+", "+T+", "+E+")"},B})();(function(B){__extends(_,B);function _(T,E,W,X){var q=this;return q instanceof _?(q=B.call(this)||this,q._setAsBox(T,E,W,X),q):new _(T,E,W,X)}return _.TYPE="polygon",_})(PolygonShape);Contact.addType(CircleShape.TYPE,CircleShape.TYPE,CircleCircleContact);function CircleCircleContact(B,_,T,E,W,X,q){CollideCircles(B,T.getShape(),_,X.getShape(),W)}var pA=vec2(0,0),pB=vec2(0,0),CollideCircles=function(B,_,T,E,W){B.pointCount=0,transformVec2(pA,T,_.m_p),transformVec2(pB,W,E.m_p);var X=distSqrVec2(pB,pA),q=_.m_radius,Y=E.m_radius,te=q+Y;X>te*te||(B.type=ManifoldType.e_circles,copyVec2(B.localPoint,_.m_p),zeroVec2(B.localNormal),B.pointCount=1,copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(0,ContactFeatureType.e_vertex,0,ContactFeatureType.e_vertex))};Contact.addType(EdgeShape.TYPE,CircleShape.TYPE,EdgeCircleContact);Contact.addType(ChainShape.TYPE,CircleShape.TYPE,ChainCircleContact);function EdgeCircleContact(B,_,T,E,W,X,q){var Y=T.getShape(),te=X.getShape();CollideEdgeCircle(B,Y,_,te,W)}function ChainCircleContact(B,_,T,E,W,X,q){var Y=T.getShape(),te=new EdgeShape;Y.getChildEdge(te,E);var ne=te,ae=X.getShape();CollideEdgeCircle(B,ne,_,ae,W)}var e=vec2(0,0),e1=vec2(0,0),e2=vec2(0,0),Q=vec2(0,0),P=vec2(0,0),n$2=vec2(0,0),CollideEdgeCircle=function(B,_,T,E,W){B.pointCount=0,retransformVec2(Q,W,T,E.m_p);var X=_.m_vertex1,q=_.m_vertex2;subVec2(e,q,X);var Y=dotVec2(e,q)-dotVec2(e,Q),te=dotVec2(e,Q)-dotVec2(e,X),ne=_.m_radius+E.m_radius;if(te<=0){copyVec2(P,X);var ae=distSqrVec2(Q,X);if(ae>ne*ne)return;if(_.m_hasVertex0){var le=_.m_vertex0,ue=X;subVec2(e1,ue,le);var ge=dotVec2(e1,ue)-dotVec2(e1,Q);if(ge>0)return}B.type=ManifoldType.e_circles,zeroVec2(B.localNormal),copyVec2(B.localPoint,P),B.pointCount=1,copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(0,ContactFeatureType.e_vertex,0,ContactFeatureType.e_vertex);return}if(Y<=0){copyVec2(P,q);var ye=distSqrVec2(Q,P);if(ye>ne*ne)return;if(_.m_hasVertex3){var xe=_.m_vertex3,Te=q;subVec2(e2,xe,Te);var Ae=dotVec2(e2,Q)-dotVec2(e2,Te);if(Ae>0)return}B.type=ManifoldType.e_circles,zeroVec2(B.localNormal),copyVec2(B.localPoint,P),B.pointCount=1,copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(1,ContactFeatureType.e_vertex,0,ContactFeatureType.e_vertex);return}var Ie=lengthSqrVec2(e);combine2Vec2(P,Y/Ie,X,te/Ie,q);var Ve=distSqrVec2(Q,P);Ve>ne*ne||(crossNumVec2(n$2,1,e),dotVec2(n$2,Q)-dotVec2(n$2,X)<0&&negVec2(n$2),normalizeVec2(n$2),B.type=ManifoldType.e_faceA,copyVec2(B.localNormal,n$2),copyVec2(B.localPoint,X),B.pointCount=1,copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(0,ContactFeatureType.e_face,0,ContactFeatureType.e_vertex))},incidentEdge=[new ClipVertex,new ClipVertex],clipPoints1$1=[new ClipVertex,new ClipVertex],clipPoints2$1=[new ClipVertex,new ClipVertex],clipSegmentToLineNormal=vec2(0,0),v1=vec2(0,0),n$1=vec2(0,0),xf$1=transform(0,0,0),v11=vec2(0,0),v12=vec2(0,0),localTangent=vec2(0,0),localNormal=vec2(0,0),planePoint=vec2(0,0),tangent=vec2(0,0),normal$1=vec2(0,0),normal1$1=vec2(0,0);Contact.addType(PolygonShape.TYPE,PolygonShape.TYPE,PolygonContact);function PolygonContact(B,_,T,E,W,X,q){CollidePolygons(B,T.getShape(),_,X.getShape(),W)}function findMaxSeparation(B,_,T,E,W){var X=B.m_count,q=T.m_count,Y=B.m_normals,te=B.m_vertices,ne=T.m_vertices;detransformTransform(xf$1,E,_);for(var ae=0,le=-1/0,ue=0;ue<X;++ue){rotVec2(n$1,xf$1.q,Y[ue]),transformVec2(v1,xf$1,te[ue]);for(var ge=1/0,ye=0;ye<q;++ye){var xe=dotVec2(n$1,ne[ye])-dotVec2(n$1,v1);xe<ge&&(ge=xe)}ge>le&&(le=ge,ae=ue)}W.maxSeparation=le,W.bestIndex=ae}function findIncidentEdge(B,_,T,E,W,X){var q=_.m_normals,Y=W.m_count,te=W.m_vertices,ne=W.m_normals;rerotVec2(normal1$1,X.q,T.q,q[E]);for(var ae=0,le=1/0,ue=0;ue<Y;++ue){var ge=dotVec2(normal1$1,ne[ue]);ge<le&&(le=ge,ae=ue)}var ye=ae,xe=ye+1<Y?ye+1:0;transformVec2(B[0].v,X,te[ye]),B[0].id.setFeatures(E,ContactFeatureType.e_face,ye,ContactFeatureType.e_vertex),transformVec2(B[1].v,X,te[xe]),B[1].id.setFeatures(E,ContactFeatureType.e_face,xe,ContactFeatureType.e_vertex)}var maxSeparation={maxSeparation:0,bestIndex:0},CollidePolygons=function(B,_,T,E,W){B.pointCount=0;var X=_.m_radius+E.m_radius;findMaxSeparation(_,T,E,W,maxSeparation);var q=maxSeparation.bestIndex,Y=maxSeparation.maxSeparation;if(!(Y>X)){findMaxSeparation(E,W,_,T,maxSeparation);var te=maxSeparation.bestIndex,ne=maxSeparation.maxSeparation;if(!(ne>X)){var ae,le,ue,ge,ye,xe,Te=.1*SettingsInternal.linearSlop;ne>Y+Te?(ae=E,le=_,ue=W,ge=T,ye=te,B.type=ManifoldType.e_faceB,xe=!0):(ae=_,le=E,ue=T,ge=W,ye=q,B.type=ManifoldType.e_faceA,xe=!1),incidentEdge[0].recycle(),incidentEdge[1].recycle(),findIncidentEdge(incidentEdge,ae,ue,ye,le,ge);var Ae=ae.m_count,Ie=ae.m_vertices,Ve=ye,$e=ye+1<Ae?ye+1:0;copyVec2(v11,Ie[Ve]),copyVec2(v12,Ie[$e]),subVec2(localTangent,v12,v11),normalizeVec2(localTangent),crossVec2Num(localNormal,localTangent,1),combine2Vec2(planePoint,.5,v11,.5,v12),rotVec2(tangent,ue.q,localTangent),crossVec2Num(normal$1,tangent,1),transformVec2(v11,ue,v11),transformVec2(v12,ue,v12);var We=dotVec2(normal$1,v11),Ue=-dotVec2(tangent,v11)+X,je=dotVec2(tangent,v12)+X;clipPoints1$1[0].recycle(),clipPoints1$1[1].recycle(),clipPoints2$1[0].recycle(),clipPoints2$1[1].recycle(),setVec2(clipSegmentToLineNormal,-tangent.x,-tangent.y);var ze=clipSegmentToLine(clipPoints1$1,incidentEdge,clipSegmentToLineNormal,Ue,Ve);if(!(ze<2)){setVec2(clipSegmentToLineNormal,tangent.x,tangent.y);var He=clipSegmentToLine(clipPoints2$1,clipPoints1$1,clipSegmentToLineNormal,je,$e);if(!(He<2)){copyVec2(B.localNormal,localNormal),copyVec2(B.localPoint,planePoint);for(var Le=0,qe=0;qe<clipPoints2$1.length;++qe){var Qe=dotVec2(normal$1,clipPoints2$1[qe].v)-We;if(Qe<=X){var Ke=B.points[Le];detransformVec2(Ke.localPoint,ge,clipPoints2$1[qe].v),Ke.id.set(clipPoints2$1[qe].id),xe&&Ke.id.swapFeatures(),++Le}}B.pointCount=Le}}}}};Contact.addType(PolygonShape.TYPE,CircleShape.TYPE,PolygonCircleContact);function PolygonCircleContact(B,_,T,E,W,X,q){CollidePolygonCircle(B,T.getShape(),_,X.getShape(),W)}var cLocal=vec2(0,0),faceCenter=vec2(0,0),CollidePolygonCircle=function(B,_,T,E,W){B.pointCount=0,retransformVec2(cLocal,W,T,E.m_p);for(var X=0,q=-1/0,Y=_.m_radius+E.m_radius,te=_.m_count,ne=_.m_vertices,ae=_.m_normals,le=0;le<te;++le){var ue=dotVec2(ae[le],cLocal)-dotVec2(ae[le],ne[le]);if(ue>Y)return;ue>q&&(q=ue,X=le)}var ge=X,ye=ge+1<te?ge+1:0,xe=ne[ge],Te=ne[ye];if(q<EPSILON){B.pointCount=1,B.type=ManifoldType.e_faceA,copyVec2(B.localNormal,ae[X]),combine2Vec2(B.localPoint,.5,xe,.5,Te),copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(0,ContactFeatureType.e_vertex,0,ContactFeatureType.e_vertex);return}var Ae=dotVec2(cLocal,Te)-dotVec2(cLocal,xe)-dotVec2(xe,Te)+dotVec2(xe,xe),Ie=dotVec2(cLocal,xe)-dotVec2(cLocal,Te)-dotVec2(Te,xe)+dotVec2(Te,Te);if(Ae<=0){if(distSqrVec2(cLocal,xe)>Y*Y)return;B.pointCount=1,B.type=ManifoldType.e_faceA,subVec2(B.localNormal,cLocal,xe),normalizeVec2(B.localNormal),copyVec2(B.localPoint,xe),copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(0,ContactFeatureType.e_vertex,0,ContactFeatureType.e_vertex)}else if(Ie<=0){if(distSqrVec2(cLocal,Te)>Y*Y)return;B.pointCount=1,B.type=ManifoldType.e_faceA,subVec2(B.localNormal,cLocal,Te),normalizeVec2(B.localNormal),copyVec2(B.localPoint,Te),copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(0,ContactFeatureType.e_vertex,0,ContactFeatureType.e_vertex)}else{combine2Vec2(faceCenter,.5,xe,.5,Te);var Ve=dotVec2(cLocal,ae[ge])-dotVec2(faceCenter,ae[ge]);if(Ve>Y)return;B.pointCount=1,B.type=ManifoldType.e_faceA,copyVec2(B.localNormal,ae[ge]),copyVec2(B.localPoint,faceCenter),copyVec2(B.points[0].localPoint,E.m_p),B.points[0].id.setFeatures(0,ContactFeatureType.e_vertex,0,ContactFeatureType.e_vertex)}},math_min=Math.min;Contact.addType(EdgeShape.TYPE,PolygonShape.TYPE,EdgePolygonContact);Contact.addType(ChainShape.TYPE,PolygonShape.TYPE,ChainPolygonContact);function EdgePolygonContact(B,_,T,E,W,X,q){CollideEdgePolygon(B,T.getShape(),_,X.getShape(),W)}var edge_reuse=new EdgeShape;function ChainPolygonContact(B,_,T,E,W,X,q){var Y=T.getShape();Y.getChildEdge(edge_reuse,E),CollideEdgePolygon(B,edge_reuse,_,X.getShape(),W)}var EPAxisType;(function(B){B[B.e_unknown=-1]="e_unknown",B[B.e_edgeA=1]="e_edgeA",B[B.e_edgeB=2]="e_edgeB"})(EPAxisType||(EPAxisType={}));var VertexType;(function(B){B[B.e_isolated=0]="e_isolated",B[B.e_concave=1]="e_concave",B[B.e_convex=2]="e_convex"})(VertexType||(VertexType={}));var EPAxis=function(){function B(){}return B}(),TempPolygon=function(){function B(){this.vertices=[],this.normals=[],this.count=0;for(var _=0;_<SettingsInternal.maxPolygonVertices;_++)this.vertices.push(vec2(0,0)),this.normals.push(vec2(0,0))}return B}(),ReferenceFace=function(){function B(){this.v1=vec2(0,0),this.v2=vec2(0,0),this.normal=vec2(0,0),this.sideNormal1=vec2(0,0),this.sideNormal2=vec2(0,0)}return B.prototype.recycle=function(){zeroVec2(this.v1),zeroVec2(this.v2),zeroVec2(this.normal),zeroVec2(this.sideNormal1),zeroVec2(this.sideNormal2)},B}(),clipPoints1=[new ClipVertex,new ClipVertex],clipPoints2=[new ClipVertex,new ClipVertex],ie=[new ClipVertex,new ClipVertex],edgeAxis=new EPAxis,polygonAxis=new EPAxis,polygonBA=new TempPolygon,rf=new ReferenceFace,centroidB=vec2(0,0),edge0=vec2(0,0),edge1=vec2(0,0),edge2=vec2(0,0),xf=transform(0,0,0),normal=vec2(0,0),normal0=vec2(0,0),normal1=vec2(0,0),normal2=vec2(0,0),lowerLimit=vec2(0,0),upperLimit=vec2(0,0),perp=vec2(0,0),n=vec2(0,0),CollideEdgePolygon=function(B,_,T,E,W){detransformTransform(xf,T,W),transformVec2(centroidB,xf,E.m_centroid);var X=_.m_vertex0,q=_.m_vertex1,Y=_.m_vertex2,te=_.m_vertex3,ne=_.m_hasVertex0,ae=_.m_hasVertex3;subVec2(edge1,Y,q),normalizeVec2(edge1),setVec2(normal1,edge1.y,-edge1.x);var le=dotVec2(normal1,centroidB)-dotVec2(normal1,q),ue=0,ge=0,ye=!1,xe=!1;zeroVec2(normal0),zeroVec2(normal2),ne&&(subVec2(edge0,q,X),normalizeVec2(edge0),setVec2(normal0,edge0.y,-edge0.x),ye=crossVec2Vec2(edge0,edge1)>=0,ue=Vec2.dot(normal0,centroidB)-Vec2.dot(normal0,X)),ae&&(subVec2(edge2,te,Y),normalizeVec2(edge2),setVec2(normal2,edge2.y,-edge2.x),xe=Vec2.crossVec2Vec2(edge1,edge2)>0,ge=Vec2.dot(normal2,centroidB)-Vec2.dot(normal2,Y));var Te;zeroVec2(normal),zeroVec2(lowerLimit),zeroVec2(upperLimit),ne&&ae?ye&&xe?(Te=ue>=0||le>=0||ge>=0,Te?(copyVec2(normal,normal1),copyVec2(lowerLimit,normal0),copyVec2(upperLimit,normal2)):(scaleVec2(normal,-1,normal1),scaleVec2(lowerLimit,-1,normal1),scaleVec2(upperLimit,-1,normal1))):ye?(Te=ue>=0||le>=0&&ge>=0,Te?(copyVec2(normal,normal1),copyVec2(lowerLimit,normal0),copyVec2(upperLimit,normal1)):(scaleVec2(normal,-1,normal1),scaleVec2(lowerLimit,-1,normal2),scaleVec2(upperLimit,-1,normal1))):xe?(Te=ge>=0||ue>=0&&le>=0,Te?(copyVec2(normal,normal1),copyVec2(lowerLimit,normal1),copyVec2(upperLimit,normal2)):(scaleVec2(normal,-1,normal1),scaleVec2(lowerLimit,-1,normal1),scaleVec2(upperLimit,-1,normal0))):(Te=ue>=0&&le>=0&&ge>=0,Te?(copyVec2(normal,normal1),copyVec2(lowerLimit,normal1),copyVec2(upperLimit,normal1)):(scaleVec2(normal,-1,normal1),scaleVec2(lowerLimit,-1,normal2),scaleVec2(upperLimit,-1,normal0))):ne?ye?(Te=ue>=0||le>=0,Te?(copyVec2(normal,normal1),copyVec2(lowerLimit,normal0),scaleVec2(upperLimit,-1,normal1)):(scaleVec2(normal,-1,normal1),copyVec2(lowerLimit,normal1),scaleVec2(upperLimit,-1,normal1))):(Te=ue>=0&&le>=0,Te?(copyVec2(normal,normal1),copyVec2(lowerLimit,normal1),scaleVec2(upperLimit,-1,normal1)):(scaleVec2(normal,-1,normal1),copyVec2(lowerLimit,normal1),scaleVec2(upperLimit,-1,normal0))):ae?xe?(Te=le>=0||ge>=0,Te?(copyVec2(normal,normal1),scaleVec2(lowerLimit,-1,normal1),copyVec2(upperLimit,normal2)):(scaleVec2(normal,-1,normal1),scaleVec2(lowerLimit,-1,normal1),copyVec2(upperLimit,normal1))):(Te=le>=0&&ge>=0,Te?(copyVec2(normal,normal1),scaleVec2(lowerLimit,-1,normal1),copyVec2(upperLimit,normal1)):(scaleVec2(normal,-1,normal1),scaleVec2(lowerLimit,-1,normal2),copyVec2(upperLimit,normal1))):(Te=le>=0,Te?(copyVec2(normal,normal1),scaleVec2(lowerLimit,-1,normal1),scaleVec2(upperLimit,-1,normal1)):(scaleVec2(normal,-1,normal1),copyVec2(lowerLimit,normal1),copyVec2(upperLimit,normal1))),polygonBA.count=E.m_count;for(var Ae=0;Ae<E.m_count;++Ae)transformVec2(polygonBA.vertices[Ae],xf,E.m_vertices[Ae]),rotVec2(polygonBA.normals[Ae],xf.q,E.m_normals[Ae]);var Ie=E.m_radius+_.m_radius;B.pointCount=0;{edgeAxis.type=EPAxisType.e_edgeA,edgeAxis.index=Te?0:1,edgeAxis.separation=1/0;for(var Ae=0;Ae<polygonBA.count;++Ae){var Ve=polygonBA.vertices[Ae],$e=dotVec2(normal,Ve)-dotVec2(normal,q);$e<edgeAxis.separation&&(edgeAxis.separation=$e)}}if(edgeAxis.type!=EPAxisType.e_unknown&&!(edgeAxis.separation>Ie)){{polygonAxis.type=EPAxisType.e_unknown,polygonAxis.index=-1,polygonAxis.separation=-1/0,setVec2(perp,-normal.y,normal.x);for(var Ae=0;Ae<polygonBA.count;++Ae){scaleVec2(n,-1,polygonBA.normals[Ae]);var We=dotVec2(n,polygonBA.vertices[Ae])-dotVec2(n,q),Ue=dotVec2(n,polygonBA.vertices[Ae])-dotVec2(n,Y),$e=math_min(We,Ue);if($e>Ie){polygonAxis.type=EPAxisType.e_edgeB,polygonAxis.index=Ae,polygonAxis.separation=$e;break}if(dotVec2(n,perp)>=0){if(dotVec2(n,normal)-dotVec2(upperLimit,normal)<-SettingsInternal.angularSlop)continue}else if(dotVec2(n,normal)-dotVec2(lowerLimit,normal)<-SettingsInternal.angularSlop)continue;$e>polygonAxis.separation&&(polygonAxis.type=EPAxisType.e_edgeB,polygonAxis.index=Ae,polygonAxis.separation=$e)}}if(!(polygonAxis.type!=EPAxisType.e_unknown&&polygonAxis.separation>Ie)){var je=.98,ze=.001,He;if(polygonAxis.type==EPAxisType.e_unknown?He=edgeAxis:polygonAxis.separation>je*edgeAxis.separation+ze?He=polygonAxis:He=edgeAxis,ie[0].recycle(),ie[1].recycle(),He.type==EPAxisType.e_edgeA){B.type=ManifoldType.e_faceA;for(var Le=0,qe=dotVec2(normal,polygonBA.normals[0]),Ae=1;Ae<polygonBA.count;++Ae){var Qe=dotVec2(normal,polygonBA.normals[Ae]);Qe<qe&&(qe=Qe,Le=Ae)}var Ke=Le,Je=Ke+1<polygonBA.count?Ke+1:0;copyVec2(ie[0].v,polygonBA.vertices[Ke]),ie[0].id.setFeatures(0,ContactFeatureType.e_face,Ke,ContactFeatureType.e_vertex),copyVec2(ie[1].v,polygonBA.vertices[Je]),ie[1].id.setFeatures(0,ContactFeatureType.e_face,Je,ContactFeatureType.e_vertex),Te?(rf.i1=0,rf.i2=1,copyVec2(rf.v1,q),copyVec2(rf.v2,Y),copyVec2(rf.normal,normal1)):(rf.i1=1,rf.i2=0,copyVec2(rf.v1,Y),copyVec2(rf.v2,q),scaleVec2(rf.normal,-1,normal1))}else B.type=ManifoldType.e_faceB,copyVec2(ie[0].v,q),ie[0].id.setFeatures(0,ContactFeatureType.e_vertex,He.index,ContactFeatureType.e_face),copyVec2(ie[1].v,Y),ie[1].id.setFeatures(0,ContactFeatureType.e_vertex,He.index,ContactFeatureType.e_face),rf.i1=He.index,rf.i2=rf.i1+1<polygonBA.count?rf.i1+1:0,copyVec2(rf.v1,polygonBA.vertices[rf.i1]),copyVec2(rf.v2,polygonBA.vertices[rf.i2]),copyVec2(rf.normal,polygonBA.normals[rf.i1]);setVec2(rf.sideNormal1,rf.normal.y,-rf.normal.x),setVec2(rf.sideNormal2,-rf.sideNormal1.x,-rf.sideNormal1.y),rf.sideOffset1=dotVec2(rf.sideNormal1,rf.v1),rf.sideOffset2=dotVec2(rf.sideNormal2,rf.v2),clipPoints1[0].recycle(),clipPoints1[1].recycle(),clipPoints2[0].recycle(),clipPoints2[1].recycle();var pt=clipSegmentToLine(clipPoints1,ie,rf.sideNormal1,rf.sideOffset1,rf.i1);if(!(pt<SettingsInternal.maxManifoldPoints)){var ut=clipSegmentToLine(clipPoints2,clipPoints1,rf.sideNormal2,rf.sideOffset2,rf.i2);if(!(ut<SettingsInternal.maxManifoldPoints)){He.type==EPAxisType.e_edgeA?(copyVec2(B.localNormal,rf.normal),copyVec2(B.localPoint,rf.v1)):(copyVec2(B.localNormal,E.m_normals[rf.i1]),copyVec2(B.localPoint,E.m_vertices[rf.i1]));for(var lt=0,Ae=0;Ae<SettingsInternal.maxManifoldPoints;++Ae){var st=dotVec2(rf.normal,clipPoints2[Ae].v)-dotVec2(rf.normal,rf.v1);if(st<=Ie){var sr=B.points[lt];He.type==EPAxisType.e_edgeA?(detransformVec2(sr.localPoint,xf,clipPoints2[Ae].v),sr.id.set(clipPoints2[Ae].id)):(copyVec2(sr.localPoint,clipPoints2[Ae].v),sr.id.set(clipPoints2[Ae].id),sr.id.swapFeatures()),++lt}}B.pointCount=lt}}}}};(function(){function B(_,T){this._refMap={},this._map={},this._xmap={},this._data=[],this._entered=[],this._exited=[],this._key=_,this._listener=T}return B.prototype.update=function(_){if(!Array.isArray(_))throw"Invalid data: "+_;this._entered.length=0,this._exited.length=0,this._data.length=_.length;for(var T=0;T<_.length;T++)if(!(typeof _[T]!="object"||_[T]===null)){var E=_[T],W=this._key(E);this._map[W]?delete this._map[W]:this._entered.push(E),this._data[T]=E,this._xmap[W]=E}for(var W in this._map)this._exited.push(this._map[W]),delete this._map[W];var X=this._map;this._map=this._xmap,this._xmap=X;for(var T=0;T<this._exited.length;T++){var E=this._exited[T],q=this._key(E),Y=this._refMap[q];this._listener.exit(E,Y),delete this._refMap[q]}for(var T=0;T<this._entered.length;T++){var E=this._entered[T],q=this._key(E),Y=this._listener.enter(E);Y&&(this._refMap[q]=Y)}for(var T=0;T<this._data.length;T++)if(!(typeof _[T]!="object"||_[T]===null)){var E=this._data[T],q=this._key(E),Y=this._refMap[q];this._listener.update(E,Y)}this._entered.length=0,this._exited.length=0,this._data.length=0},B.prototype.ref=function(_){return this._refMap[this._key(_)]},B})();class AnimationManager{constructor(_){this.gameApp=_}playCellBreakAnim(_,T){if(!_||_.isDestroyed)return;const E=this.getCellCenter(_);this.createFlyingBubble(E,_,T);const W=this.createBubbles(E,_.color);this.animateBubbles(W),this.playScoreAnim(_,T.score)}getCellCenter(_){const T=_.getDisplayPoints();return T.length<3?{x:0,y:0}:{x:T.reduce((E,W)=>E+W.x,0)/T.length,y:T.reduce((E,W)=>E+W.y,0)/T.length}}createBubbles(_,T){const X=[];for(let q=0;q<12;q++){const Y=this.createSingleBubble(_,50,q,12,T);X.push(Y)}return X}createSingleBubble(_,T,E,W,X){const q=new Graphics;this.gameApp.effectGraphic.addChild(q);const Y=E/W*Math.PI*2,te=_.x+Math.cos(Y)*T,ne=_.y+Math.sin(Y)*T,ae=Math.random()*8+4;return q.beginFill(X,.8),q.drawCircle(0,0,ae),q.endFill(),q.position.set(te,ne),Object.assign(q,{originalX:te,originalY:ne,size:ae,diffusionAngle:Y,diffusionSpeed:Math.random()*.5+.5,alpha:1,scale:{x:1,y:1}}),q}animateBubbles(_){const E=Date.now(),W=()=>{const X=Date.now()-E,q=Math.min(X/500,1);_.forEach((Y,te)=>{this.updateBubble(Y,q,te)}),q<1?requestAnimationFrame(W):this.cleanupBubbles(_)};W()}updateBubble(_,T,E){if(T<=0){_.x=_.originalX,_.y=_.originalY,_.scale.set(1),_.alpha=1;return}const W=1-Math.pow(1-T,2),X=W*80*_.diffusionSpeed;_.x=_.originalX+Math.cos(_.diffusionAngle)*X,_.y=_.originalY+Math.sin(_.diffusionAngle)*X;const q=1+W*.8;_.scale.set(q),_.alpha=1-W}cleanupBubbles(_){_.forEach(T=>{T.parent&&T.parent.removeChild(T),T.destroy()})}playScoreAnim(_,T){const E=new Text$1(`+${T}`,{fontFamily:"Arial",fontSize:72,fill:16777215,stroke:0,strokeThickness:3,align:"center"}),W=this.getCellCenter(_);E.position.set(W.x,W.y),E.anchor.set(.5,.5),this.gameApp.effectGraphic.addChild(E),this.animateScore(E,W.y)}animateScore(_,T){const W=Date.now(),X=()=>{const q=Date.now()-W,Y=Math.min(q/1e3,1);_.y=T-Y*50,_.alpha=1-Y,Y<1?requestAnimationFrame(X):(_.parent&&_.parent.removeChild(_),_.destroy())};X()}playExplosionAnim(_,T=16711680){const E=this.createExplosionParticles(_,T);this.animateExplosion(E)}createExplosionParticles(_,T){const W=[];for(let X=0;X<20;X++){const q=new Graphics;this.gameApp.effectGraphic.addChild(q);const Y=Math.random()*6+3;q.beginFill(T,.9),q.drawCircle(0,0,Y),q.endFill(),q.position.set(_.x,_.y),Object.assign(q,{velocity:{x:(Math.random()-.5)*200,y:(Math.random()-.5)*200},life:1,decay:Math.random()*.02+.01,size:Y}),W.push(q)}return W}animateExplosion(_){const T=()=>{let E=!0;_.forEach(W=>{if(W.life>0){E=!1,W.x+=W.velocity.x*.016,W.y+=W.velocity.y*.016,W.velocity.x*=.98,W.velocity.y*=.98,W.life-=W.decay,W.alpha=W.life;const X=1+(1-W.life)*.5;W.scale.set(X)}}),E?this.cleanupParticles(_):requestAnimationFrame(T)};T()}cleanupParticles(_){_.forEach(T=>{T.parent&&T.parent.removeChild(T),T.destroy()})}createFlyingBubble(_,T,E){const W=E.colorIndex,X=this.getColorIndicatorPosition(W);if(!X)return;const q=new Graphics;this.gameApp.effectGraphic.addChild(q);const Y=24;q.beginFill(T.color,.9),q.drawCircle(0,0,Y),q.endFill(),q.position.set(_.x,_.y),this.animateFlyingBubble(q,_,X,E)}getColorIndicatorPosition(_){if(this.gameApp&&this.gameApp.uiManager&&this.gameApp.uiManager.levelColorIndicators){const T=this.gameApp.uiManager.levelColorIndicators[_];if(T){const E=T.toGlobal(new Point(0,0));return{x:E.x,y:E.y}}}return null}animateFlyingBubble(_,T,E,W){const q=Date.now(),Y=()=>{const te=Date.now()-q,ne=Math.min(te/800,1),ae=this.easeInOutQuad(ne);_.x=T.x+(E.x-T.x)*ae,_.y=T.y+(E.y-T.y)*ae;const le=50;_.y-=Math.sin(ne*Math.PI)*le;const ue=1+ne*.5;_.scale.set(ue),ne<1?requestAnimationFrame(Y):(this.playColorIndicatorHitEffect(W),_.parent&&_.parent.removeChild(_),_.destroy())};Y()}easeInOutQuad(_){return _<.5?2*_*_:-1+(4-2*_)*_}playColorIndicatorHitEffect(_){this.gameApp&&this.gameApp.uiManager&&this.gameApp.uiManager.playColorIndicatorHitEffect(_)}}const levelConfigs=[{id:1,name:"",description:"",targetScore:100,minMatchLength:3,colorIndex:[0,1],dropletCount:[3,3],collectCount:[3,3]},{id:2,name:"",description:"",targetScore:150,minMatchLength:3,colorIndex:[0,1,2],dropletCount:[4,4,4],collectCount:[4,4,4]},{id:3,name:"",description:"",targetScore:200,minMatchLength:3,colorIndex:[0,1,2,3],dropletCount:[5,5,5,5],collectCount:[5,5,5,5]},{id:4,name:"",description:"",targetScore:250,minMatchLength:4,colorIndex:[0,1,2,3,4],dropletCount:[6,6,6,6,6],collectCount:[6,6,6,6,6]},{id:5,name:"",description:"",targetScore:300,minMatchLength:4,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[8,8,8,8,8]},{id:6,name:"",description:"",targetScore:350,minMatchLength:4,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[10,10,10,10,10]},{id:7,name:"",description:"",targetScore:400,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[12,12,12,12,12]},{id:8,name:"",description:"",targetScore:450,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[15,15,15,15,15]},{id:9,name:"",description:"",targetScore:500,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[18,18,18,18,18]},{id:10,name:"",description:"",targetScore:600,minMatchLength:5,colorIndex:[0,1,2,3,4],dropletCount:null,collectCount:[20,20,20,20,20]}];function getLevelConfig(B){return levelConfigs.find(_=>_.id===B)||null}function getAllLevelConfigs(){return levelConfigs}class Cell extends Container{constructor(){super(),this.bodies=[],this.joints=[],this._colorIndex=0,this.ballSize=30,this.centerBody=null,this._isDestroyed=!1,this._highlighted=!1}setPoints(_){this.initBodies(_),this.initJoints()}getDisplayPoints(){if(this.bodies.length<3)return this.getBoundsForFewPoints();const _=this.bodies.reduce((W,X)=>W+X.getPosition().x,0)/this.bodies.length*gameApp$1.PPM,T=this.bodies.reduce((W,X)=>W+X.getPosition().y,0)/this.bodies.length*gameApp$1.PPM;let E=this.bodies.map(W=>{const X=W.getPosition(),q=X.x*gameApp$1.PPM,Y=X.y*gameApp$1.PPM,te=q-_,ne=Y-T,ae=Math.sqrt(te*te+ne*ne);if(ae<.001)return{x:q,y:Y+this.ballSize};const le=te/ae,ue=ne/ae;return{x:q+le*this.ballSize*1,y:Y+ue*this.ballSize*1}});return E.sort((W,X)=>{const q=Math.atan2(W.y-T,W.x-_),Y=Math.atan2(X.y-T,X.x-_);return q-Y}),E}distance(_,T){return Math.sqrt((T.x-_.x)**2+(T.y-_.y)**2)}getBoundsForFewPoints(){if(this.bodies.length===0)return[];if(this.bodies.length===1){const _=this.bodies[0].getPosition(),T={x:_.x*gameApp$1.PPM,y:_.y*gameApp$1.PPM},E=this.ballSize;return[{x:T.x-E,y:T.y-E},{x:T.x+E,y:T.y-E},{x:T.x+E,y:T.y+E},{x:T.x-E,y:T.y+E}]}if(this.bodies.length===2){const _=this.bodies[0].getPosition(),T=this.bodies[1].getPosition(),E={x:_.x*gameApp$1.PPM,y:_.y*gameApp$1.PPM},W={x:T.x*gameApp$1.PPM,y:T.y*gameApp$1.PPM},X=this.ballSize,q=W.x-E.x,Y=W.y-E.y,te=Math.sqrt(q*q+Y*Y);if(te===0)return[{x:E.x-X,y:E.y-X},{x:E.x+X,y:E.y-X},{x:E.x+X,y:E.y+X},{x:E.x-X,y:E.y+X}];const ne=-Y/te,ae=q/te;return[{x:E.x+ne*X,y:E.y+ae*X},{x:E.x-ne*X,y:E.y-ae*X},{x:W.x-ne*X,y:W.y-ae*X},{x:W.x+ne*X,y:W.y+ae*X}]}return[]}get colorIndex(){return this._colorIndex}set colorIndex(_){this._colorIndex=_}get color(){return gameApp$1.colors[this.colorIndex]}setHighlight(_){this._highlighted=_}get highlighted(){return this._highlighted||!1}initBodies(_){this.cleanupBodies(),_.forEach(T=>{const E=gameApp$1.physicsWorld.createBody({type:Body.DYNAMIC,position:new Vec2(T.x/gameApp$1.PPM,T.y/gameApp$1.PPM)}),W=new Circle(this.ballSize/gameApp$1.PPM);E.createFixture({shape:W,density:1,friction:.3,restitution:.5}),this.bodies.push(E)})}initJoints(){this.cleanupJoints();const _=this.bodies;if(!(_.length<2))for(let T=0;T<_.length;T++){const E=_[T],W=_[(T+1)%_.length],X=new DistanceJoint({bodyA:E,bodyB:W,localAnchorA:new Vec2(0,0),localAnchorB:new Vec2(0,0),frequencyHz:5,dampingRatio:.7});gameApp$1.physicsWorld.createJoint(X),this.joints.push(X)}}cleanupBodies(){this.bodies.forEach(_=>{_&&_.getWorld()&&_.getWorld().destroyBody(_)}),this.bodies=[]}cleanupJoints(){this.joints.forEach(_=>{_&&_.getWorld()&&_.getWorld().destroyJoint(_)}),this.joints=[]}destroy(){this.cleanupBodies(),this.cleanupJoints(),this._isDestroyed=!0}playBreakAnim(){gameApp$1.animationManager&&gameApp$1.animationManager.playCellBreakAnim(this)}get isDestroyed(){return this._isDestroyed}set isDestroyed(_){this._isDestroyed=_}}class LevelManager{constructor(_){this.gameApp=_,this.currentLevel=null,this.currentLevelConfig=null,this.colorPool={},this.cols=6,this.rows=6,this.preferedCellCount=this.cols*this.rows,this.levelState={currentScore:0,colorScores:{},timeRemaining:0,isCompleted:!1,isFailed:!1},this.scoreByColor={},this.isGameActive=!1,this.isLevelCompleted=!1,this.isGameEnded=!1}loadLevel(_){try{if(this.clearCurrentLevel(),this.currentLevelConfig=getLevelConfig(_),!this.currentLevelConfig)throw new Error(` ${_} `);this.currentLevelId=_,this.currentScore=0,this.countByColor={},this.scoreByColor={},this.isGameActive=!1,this.isLevelCompleted=!1,this.isGameEnded=!1,this.currentLevelConfig.colorIndex.forEach(T=>{this.countByColor[T]=0,this.scoreByColor[T]=0}),this.initColorPool(),this.checkAndGenerateCells(),this.startGame(),this.gameApp.uiManager&&this.gameApp.uiManager.initLevelInfoUI(),console.log(` ${_} `)}catch(T){console.error(":",T.message)}}clearCurrentLevel(){this.gameApp.cells&&this.gameApp.cells.children.concat([]).forEach(T=>{this.gameApp.removeCell(T)}),this.isGameActive=!1,this.isLevelCompleted=!1,this.isGameEnded=!1,this.currentLevelConfig=null,this.currentLevelId=null,this.colorPool=null}getColorPoolRemainCount(){return this.colorPool===null?null:Object.values(this.colorPool).reduce((_,T)=>_+T,0)}initColorPool(){const _=this.currentLevelConfig;_.dropletCount===null?this.colorPool=null:(this.colorPool={},_.colorIndex.forEach((T,E)=>{this.colorPool[T]=_.dropletCount[E]}))}generateCellsByCount(_){const T=this.gameApp.pixi.screen.width,E=this.gameApp.pixi.screen.height,W=150,X=Math.ceil(_/this.cols),Y=Math.ceil(_/X)*W,te=X*W,ne=(T-Y)/2,ae=(E-te)/2-50;for(let le=0;le<_;le++){const ue=Math.floor(le/this.cols),ge=le%this.cols,ye=ne+ge*W+W/2,xe=ae+ue*W+W/2,Te=this.getRandomColorFromPool();if(Te!==null){const Ae=[],Ie=Math.floor(W*.4),Ve=6;for(let We=0;We<Ve;We++){const Ue=We/Ve*Math.PI*2,je=ye+Math.cos(Ue)*Ie,ze=xe+Math.sin(Ue)*Ie;Ae.push({x:je,y:ze})}const $e=new Cell;$e.colorIndex=Te,$e.setPoints(Ae),this.gameApp.addCell($e)}}}getRandomColorFromPool(){if(this.colorPool===null){const W=this.currentLevelConfig.colorIndex,X=Math.floor(Math.random()*W.length);return W[X]}const _=Object.keys(this.colorPool).filter(W=>this.colorPool[W]>0);if(_.length===0)return null;const T=Math.floor(Math.random()*_.length),E=parseInt(_[T]);return this.colorPool[E]--,E}startGame(){this.isGameActive=!0}updateScore(_,T){if(!this.isGameActive||!this.currentLevelConfig||this.isLevelCompleted)return null;this.countByColor[T]||(this.countByColor[T]=0),this.countByColor[T]+=1,this.scoreByColor[T]||(this.scoreByColor[T]=0),this.scoreByColor[T]+=_,this.currentScore+=_;const E=this.checkLevelCompletion();return E&&!this.isLevelCompleted&&(this.isLevelCompleted=!0,this.isGameActive=!1,console.log("...")),{score:_,colorIndex:T,count:this.countByColor[T],currentScore:this.currentScore,levelCompleted:E,scoreByColor:{...this.scoreByColor}}}checkLevelCompletion(){if(!this.currentLevelConfig)return!1;const _=this.currentLevelConfig;let T=!0;return _.colorIndex.forEach((E,W)=>{const X=this.countByColor[E]||0,q=_.collectCount[W];X<q&&(T=!1)}),T}isLevelFinished(){return this.isLevelCompleted}isGameFinished(){return this.isGameEnded}canAcceptInput(){return this.isGameActive&&!this.isLevelCompleted&&!this.isGameEnded}endGame(_){if(this.isGameEnded)return;this.isGameEnded=!0,this.isGameActive=!1,this.isLevelCompleted=!0;const T={isWin:_,levelId:this.currentLevelId,levelName:this.currentLevelConfig.name,levelConfig:this.currentLevelConfig,currentScore:this.currentScore,targetScore:this.currentLevelConfig.targetScore,countByColor:{...this.countByColor},scoreByColor:{...this.scoreByColor},targetCounts:{...this.currentLevelConfig.collectCount}};this.gameApp.settlementManager.showSettlement(T),console.log(_?` ${this.currentLevelId} `:` ${this.currentLevelId} `)}getCurrentLevelInfo(){return this.currentLevelConfig?{id:this.currentLevelId,name:this.currentLevelConfig.name,description:this.currentLevelConfig.description,currentScore:this.currentScore,targetScore:this.currentLevelConfig.targetScore,countByColor:this.countByColor,isGameActive:this.isGameActive}:null}destroy(){this.clearCurrentLevel(),this.isGameActive=!1}checkAndGenerateCells(){const _=this.gameApp.cells.children.length,T=this.preferedCellCount-_;if(T<=0)return;let E=0;this.colorPool===null?E=T:E=Math.min(T,this.getColorPoolRemainCount()),E>0&&this.generateCellsByCount(E)}generateHexagonalGridLayout(){}calculateMaxScreenCapacity(){return this.cols*this.rows}}class DragManager{constructor(_){this.gameApp=_,this.isDragging=!1,this.currentDragCell=null,this.dragCellQueue=[],this.initDragSystem()}initDragSystem(){this.gameApp.cells.eventMode="static",this.gameApp.cells.hitArea=new Rectangle(0,0,this.gameApp.pixi.screen.width,this.gameApp.pixi.screen.height),this.gameApp.cells.on("pointerdown",this.startDrag.bind(this)),this.gameApp.cells.on("pointermove",this.updateDrag.bind(this)),this.gameApp.cells.on("pointerup",this.endDrag.bind(this)),this.gameApp.cells.on("pointerupoutside",this.endDrag.bind(this))}startDrag(_){if(!this.gameApp.levelManager.canAcceptInput())return;const T=_.global;this.isDragging=!0,this.currentDragCell=null,this.dragCellQueue=[],this.currentDragCell=this.findCellAtPoint(T),this.currentDragCell&&(this.dragCellQueue.push(this.currentDragCell),this.currentDragCell.setHighlight(!0))}updateDrag(_){if(!this.gameApp.levelManager.canAcceptInput())return;const T=_.global;if(!this.isDragging)return;const E=this.currentDragCell;if(this.currentDragCell=this.findCellAtPoint(T),this.currentDragCell&&this.currentDragCell!==E){const W=this.dragCellQueue.length>0?this.dragCellQueue[this.dragCellQueue.length-1]:null;W&&this.currentDragCell.colorIndex===W.colorIndex?this.dragCellQueue.includes(this.currentDragCell)||(this.dragCellQueue.push(this.currentDragCell),this.currentDragCell.setHighlight(!0)):(!W||this.currentDragCell&&!this.dragCellQueue.includes(this.currentDragCell))&&(this.clearDragQueue(),this.dragCellQueue.push(this.currentDragCell),this.currentDragCell.setHighlight(!0))}}endDrag(_){if(!this.isDragging||(this.isDragging=!1,this.currentDragCell=null,this.dragCellQueue.length===0))return;const T=this.dragCellQueue[0],E=this.countRemainingCellsOfColor(T.colorIndex);this.dragCellQueue.length>=3||E<3?this.processDragMatch():this.clearDragQueue()}clearDragQueue(){this.dragCellQueue.forEach(_=>{_&&!_.isDestroyed&&_.setHighlight(!1)}),this.dragCellQueue=[]}findCellAtPoint(_){for(let T=this.gameApp.cells.children.length-1;T>=0;T--){const E=this.gameApp.cells.children[T],W=E.getDisplayPoints();if(!E.isDestroyed&&this.isPointInPolygon([_.x,_.y],W.map(X=>[X.x,X.y])))return E}return null}isPointInPolygon(_,T){let E=!1;const W=_[0],X=_[1];for(let q=0,Y=T.length-1;q<T.length;Y=q++){const te=T[q][0],ne=T[q][1],ae=T[Y][0],le=T[Y][1];ne>X!=le>X&&W<(ae-te)*(X-ne)/(le-ne)+te&&(E=!E)}return E}processDragMatch(){this.dragCellQueue.forEach(T=>{T&&!T.isDestroyed&&(T.isRemoved=!0,T.setHighlight(!1))});let _=!1;this.dragCellQueue.forEach((T,E)=>{const W=E+1;setTimeout(()=>{if(T&&!T.isDestroyed&&T.isRemoved){const X=this.gameApp.levelManager.updateScore(W,T.colorIndex);X&&X.levelCompleted&&(_=!0),this.gameApp.animationManager.playCellBreakAnim(T,X),this.gameApp.removeCell(T)}},E*150)}),this.dragCellQueue=[],setTimeout(_?()=>{this.gameApp.levelManager.endGame(!0)}:()=>{this.gameApp.levelManager.checkAndGenerateCells()},500)}countRemainingCellsOfColor(_){let T=0;for(let E=0;E<this.gameApp.cells.children.length;E++){const W=this.gameApp.cells.children[E];!W.isDestroyed&&W.colorIndex===_&&T++}return T}destroy(){this.gameApp.cells&&(this.gameApp.cells.off("pointerdown",this.startDrag.bind(this)),this.gameApp.cells.off("pointermove",this.updateDrag.bind(this)),this.gameApp.cells.off("pointerup",this.endDrag.bind(this)),this.gameApp.cells.off("pointerupoutside",this.endDrag.bind(this)))}}class ColorIndicator extends Container{constructor(_,T){super(),this.color=_,this.collectCount=T,this.currentProgress=0,this.background=new Graphics,this.background.beginFill(_),this.background.drawCircle(0,0,60),this.background.endFill(),this.addChild(this.background),this.progressText=new Text$1("0/0",{fontFamily:"Arial",fontSize:40,fill:16777215,align:"center"}),this.progressText.anchor.set(.5,.5),this.addChild(this.progressText),this.updateProgress(0)}updateProgress(_){this.currentProgress=Math.min(_,this.collectCount),this.progressText.text=`${this.currentProgress}/${this.collectCount}`}playHitEffect(_){this.scale.set(1*.9);const E=new Graphics;E.beginFill(this.color,.5),E.drawCircle(0,0,70),E.endFill(),this.addChild(E),setTimeout(()=>{this.scale.set(1),this.children.includes(E)&&this.removeChild(E),console.log("playHitEffect",_),_.levelCompleted&&gameApp$1.levelManager.endGame(!0)},100),this.updateProgress(_.count)}}class UIManager{constructor(_){this.gameApp=_,this.levelInfoUI=null,this.levelInfoStaticText=null,this.levelColorIndicators=[]}initLevelInfoUI(){if(!this.gameApp.levelManager||!this.gameApp.levelManager.currentLevelConfig)return;const _=this.gameApp.levelManager.currentLevelConfig;this.levelInfoUI&&this.gameApp.ui.removeChild(this.levelInfoUI),this.levelInfoUI=new Container,this.gameApp.ui.addChild(this.levelInfoUI),this.levelInfoStaticText=new Text$1(`${_.id}`,{fontFamily:"Arial",fontSize:66,fill:16777215,align:"center"}),this.levelInfoStaticText.x=0,this.levelInfoStaticText.y=0,this.levelInfoStaticText.anchor.set(.5,.5),this.levelInfoUI.addChild(this.levelInfoStaticText),this.levelColorIndicators=[];const T=120,E=30,X=-(_.colorIndex.length*T+(_.colorIndex.length-1)*E)/2;_.colorIndex.forEach((q,Y)=>{const te=new ColorIndicator(this.gameApp.colors[q],_.collectCount[Y]);te.x=X+Y*(T+E)+T/2,te.y=120,this.levelInfoUI.addChild(te),this.levelColorIndicators.push(te)}),this.initLevelProgressUI(),this.levelInfoUI.x=this.gameApp.pixi.screen.width/2,this.levelInfoUI.y=120}initLevelProgressUI(){if(!this.levelInfoUI||!this.gameApp.levelManager||!this.gameApp.levelManager.currentLevelConfig)return;const _=this.gameApp.levelManager.currentLevelConfig,T=this.gameApp.levelManager.countByColor||{};_.colorIndex.forEach((E,W)=>{const X=T[E]||0;this.levelColorIndicators[W]&&this.levelColorIndicators[W].updateProgress(X)})}playColorIndicatorHitEffect(_){this.levelColorIndicators[_.colorIndex]&&this.levelColorIndicators[_.colorIndex].playHitEffect(_)}destroy(){this.levelInfoUI&&(this.gameApp.ui.removeChild(this.levelInfoUI),this.levelInfoUI=null),this.levelColorIndicators=[]}}class RenderManager{constructor(_){this.gameApp=_}clearCellGraphics(){this.gameApp.normalCellGraphic&&this.gameApp.normalCellGraphic.clear(),this.gameApp.highlightBorderGraphic&&this.gameApp.highlightBorderGraphic.clear(),this.gameApp.highlightCellGraphic&&this.gameApp.highlightCellGraphic.clear(),this.gameApp.effectGraphic&&this.gameApp.effectGraphic.clear()}drawAllCellGraphics(){this.gameApp.normalCellGraphic.clear(),this.gameApp.highlightBorderGraphic.clear(),this.gameApp.highlightCellGraphic.clear(),this.gameApp.cells.children.forEach(_=>{_.isDestroyed||this.drawCell(_)})}drawCell(_){const T=_.getDisplayPoints();if(T.length<3)return;const E="catmull";_.highlighted?(this.gameApp.highlightCellGraphic.lineStyle(0),this.gameApp.highlightCellGraphic.beginFill(_.color),this.drawPath(this.gameApp.highlightCellGraphic,T,E),this.gameApp.highlightCellGraphic.closePath(),this.gameApp.highlightCellGraphic.endFill(),this.gameApp.highlightBorderGraphic.lineStyle(20,16777215,1),this.gameApp.highlightBorderGraphic.beginFill(16777215,.1),this.drawPath(this.gameApp.highlightBorderGraphic,T,E),this.gameApp.highlightBorderGraphic.closePath(),this.gameApp.highlightBorderGraphic.endFill()):(this.gameApp.normalCellGraphic.lineStyle(0),this.gameApp.normalCellGraphic.beginFill(_.color),this.drawPath(this.gameApp.normalCellGraphic,T,E),this.gameApp.normalCellGraphic.closePath(),this.gameApp.normalCellGraphic.endFill())}drawPath(_,T,E){switch(E){case"line":this.drawLinePath(_,T);break;case"quadratic":this.drawQuadraticPath(_,T);break;case"cubic":this.drawCubicPath(_,T);break;case"smooth":this.drawSmoothPath(_,T);break;case"catmull":default:this.drawCatmullPath(_,T);break}}drawLinePath(_,T){_.moveTo(T[0].x,T[0].y);for(let E=1;E<T.length;E++)_.lineTo(T[E].x,T[E].y)}drawQuadraticPath(_,T){const E=T,W=E.length;if(W<3){this.drawLinePath(_,T);return}_.moveTo(E[0].x,E[0].y);for(let X=0;X<W;X++){const q=E[X],Y=E[(X+1)%W];E[(X+2)%W];const te=(q.x+Y.x)/2,ne=(q.y+Y.y)/2;_.quadraticCurveTo(te,ne,Y.x,Y.y)}}drawCubicPath(_,T){const E=T,W=E.length;if(W<4){this.drawQuadraticPath(_,T);return}_.moveTo(E[0].x,E[0].y);for(let X=0;X<W;X++){const q=E[X],Y=E[(X+1)%W],te=E[(X+2)%W];E[(X+3)%W];const ne=q.x+(Y.x-q.x)*.5,ae=q.y+(Y.y-q.y)*.5,le=Y.x+(te.x-Y.x)*.5,ue=Y.y+(te.y-Y.y)*.5;_.bezierCurveTo(ne,ae,le,ue,Y.x,Y.y)}}drawSmoothPath(_,T){const E=T,W=E.length;_.moveTo(E[0].x,E[0].y);for(let X=1;X<W;X++){const q=E[X-1],Y=E[X],te=E[(X+1)%W],ne=.3,ae=q.x+(Y.x-q.x)*(1-ne),le=q.y+(Y.y-q.y)*(1-ne),ue=Y.x+(te.x-Y.x)*ne,ge=Y.y+(te.y-Y.y)*ne;_.bezierCurveTo(ae,le,ue,ge,Y.x,Y.y)}}drawCatmullPath(_,T){const E=T,W=E.length;_.moveTo(E[0].x,E[0].y);const X=10;for(let q=0;q<W;q++){const Y=E[(q-1+W)%W],te=E[q],ne=E[(q+1)%W],ae=E[(q+2)%W];for(let le=1;le<=X;le++){const ue=le/X,ge=ue*ue,ye=ge*ue,xe=.5*(2*te.x+(-Y.x+ne.x)*ue+(2*Y.x-5*te.x+4*ne.x-ae.x)*ge+(-Y.x+3*te.x-3*ne.x+ae.x)*ye),Te=.5*(2*te.y+(-Y.y+ne.y)*ue+(2*Y.y-5*te.y+4*ne.y-ae.y)*ge+(-Y.y+3*te.y-3*ne.y+ae.y)*ye);_.lineTo(xe,Te)}}}destroy(){}}class SettlementManager{constructor(_){this.gameApp=_,this.container=null,this.isVisible=!1,this.settlementData=null,this.initSettlementContainer()}initSettlementContainer(){this.container=new Container,this.container.visible=!1,this.container.zIndex=1e3,this.gameApp.pixi.stage.addChild(this.container)}showSettlement(_){this.settlementData=_,this.isVisible=!0,this.clearSettlement(),this.createSettlementUI(),this.container.visible=!0,this.playShowAnimation()}hideSettlement(){this.isVisible=!1,this.container.visible=!1,this.clearSettlement()}clearSettlement(){for(;this.container.children.length>0;)this.container.removeChildAt(0)}createSettlementUI(){const _=this.gameApp.pixi.screen.width,T=this.gameApp.pixi.screen.height;this.calculateElementPositions(_,T),this.createBackgroundMask(_,T),this.createMainPanel(),this.createTitle(),this.createResultInfo(),this.createButtons(),this.playAnimationSequence()}calculateElementPositions(_,T){const E=this.settlementData.levelConfig.colorIndex.length,W=600,Y=E*(90+20),te=W+Y;this.panelConfig={width:Math.max(800,600+E*50),height:Math.max(1e3,te),x:(_-Math.max(800,600+E*50))/2,y:(T-Math.max(1e3,te))/2},this.fontConfig={title:Math.max(72,96-(E-2)*8),levelInfo:Math.max(36,48-(E-2)*4),score:Math.max(48,64-(E-2)*6),colorTitle:Math.max(40,52-(E-2)*4),colorCount:Math.max(36,48-(E-2)*4),colorScore:Math.max(32,44-(E-2)*4),button:Math.max(28,36-(E-2)*2),colorIndicator:Math.max(20,30-(E-2)*2),buttonWidth:Math.max(240,280-(E-2)*10),buttonHeight:Math.max(70,90-(E-2)*5)},this.titleConfig={x:this.panelConfig.x+this.panelConfig.width/2,y:this.panelConfig.y+50},this.infoContainerConfig={x:this.panelConfig.x+this.panelConfig.width/2,y:this.titleConfig.y+120},this.levelInfoConfig={y:0},this.scoreInfoConfig={y:80},this.colorCollectionConfig={y:180},this.calculateColorItemPositions(),this.calculateButtonPositions(_,T)}calculateColorItemPositions(){const _=this.settlementData.levelConfig.colorIndex.length;this.colorItemConfigs=[];const X=Math.max(70,Math.min(120,90-(_-2)*5));let q=100;for(let Y=0;Y<_;Y++){const te=-220-(_>3?(_-3)*20:0),ne=-60-(_>3?(_-3)*10:0),ae=140+(_>3?(_-3)*10:0);this.colorItemConfigs.push({y:q,colorIndicator:{x:te,y:q},collectText:{x:ne,y:q},scoreText:{x:ae,y:q}}),q+=X}}calculateButtonPositions(_,T){this.settlementData.levelConfig.colorIndex.length;const X=this.panelConfig.y+this.panelConfig.height-150-120,q=this.fontConfig.buttonWidth+40;this.buttonConfig={x:this.panelConfig.x+this.panelConfig.width/2,y:X,restartButton:{x:-q/2},nextButton:{x:q/2}}}createBackgroundMask(_,T){const E=new Graphics;E.beginFill(0,.7),E.drawRect(0,0,_,T),E.endFill(),E.eventMode="static",E.on("pointerdown",()=>{}),this.container.addChild(E)}createMainPanel(){const _=new Graphics;_.beginFill(2899536,.95),_.lineStyle(4,3447003,1),_.drawRoundedRect(this.panelConfig.x,this.panelConfig.y,this.panelConfig.width,this.panelConfig.height,20),_.endFill();const T=new Graphics;T.beginFill(3447003,.3),T.drawRoundedRect(this.panelConfig.x+10,this.panelConfig.y+10,this.panelConfig.width-20,80,15),T.endFill(),this.container.addChild(_),this.container.addChild(T)}createTitle(){const _=this.settlementData.isWin?"":"",T=this.settlementData.isWin?3066993:15158332,E=new Text$1(_,{fontFamily:"Arial",fontSize:this.fontConfig.title,fontWeight:"bold",fill:T,stroke:16777215,strokeThickness:3,align:"center"});E.anchor.set(.5,0),E.x=this.titleConfig.x,E.y=this.titleConfig.y,this.container.addChild(E)}createResultInfo(){const _=new Container;_.x=this.infoContainerConfig.x,_.y=this.infoContainerConfig.y;const T=new Text$1(` ${this.settlementData.levelId}: ${this.settlementData.levelName}`,{fontFamily:"Arial",fontSize:this.fontConfig.levelInfo,fill:16777215,align:"center"});T.anchor.set(.5,0),T.y=this.levelInfoConfig.y,_.addChild(T);const E=new Text$1(`: ${this.settlementData.currentScore}`,{fontFamily:"Arial",fontSize:this.fontConfig.score,fontWeight:"bold",fill:15965202,align:"center"});E.anchor.set(.5,0),E.y=this.scoreInfoConfig.y,E.alpha=0,_.addChild(E);const W=this.createColorCollectionInfo();W.alpha=0,_.addChild(W),this.animationElements={scoreText:E,colorContainer:W},this.container.addChild(_)}createColorCollectionInfo(){const _=new Container;_.y=this.colorCollectionConfig.y;const T=new Text$1(":",{fontFamily:"Arial",fontSize:this.fontConfig.colorTitle,fontWeight:"bold",fill:16777215,align:"center"});T.anchor.set(.5,0),_.addChild(T);const E=this.gameApp.colors;return this.colorElements=[],this.settlementData.levelConfig.colorIndex.forEach((W,X)=>{const q=E[W],Y=this.settlementData.countByColor[W]||0,te=this.settlementData.targetCounts[X],ne=this.settlementData.scoreByColor[W]||0,ae=this.colorItemConfigs[X],le=new Container;le.alpha=0;const ue=new Graphics;ue.beginFill(q),ue.drawCircle(0,0,this.fontConfig.colorIndicator),ue.endFill(),ue.x=ae.colorIndicator.x,ue.y=ae.colorIndicator.y;const ge=new Text$1(`${Y}/${te}`,{fontFamily:"Arial",fontSize:this.fontConfig.colorCount,fill:Y>=te?3066993:16777215,align:"center"});ge.anchor.set(.5,.5),ge.x=ae.collectText.x,ge.y=ae.collectText.y;const ye=new Text$1(`+${ne}`,{fontFamily:"Arial",fontSize:this.fontConfig.colorScore,fill:15965202,align:"center"});ye.anchor.set(.5,.5),ye.x=ae.scoreText.x,ye.y=ae.scoreText.y,le.addChild(ue),le.addChild(ge),le.addChild(ye),_.addChild(le),this.colorElements.push(le)}),_}createButtons(){const _=new Container;_.x=this.buttonConfig.x,_.y=this.buttonConfig.y,_.alpha=0;const T=this.createButton("",15158332,()=>{this.onRestartClick()});T.x=this.buttonConfig.restartButton.x,_.addChild(T);const E=getAllLevelConfigs().length;if(this.settlementData.isWin&&this.settlementData.levelId<E){const W=this.createButton("",3066993,()=>{this.onNextLevelClick()});W.x=this.buttonConfig.nextButton.x,_.addChild(W)}this.buttonContainer=_,this.container.addChild(_)}createButton(_,T,E){const W=new Container;W.eventMode="static";const X=new Graphics;X.beginFill(T),X.lineStyle(3,16777215,1),X.drawRoundedRect(-this.fontConfig.buttonWidth/2,-this.fontConfig.buttonHeight/2,this.fontConfig.buttonWidth,this.fontConfig.buttonHeight,20),X.endFill();const q=new Text$1(_,{fontFamily:"Arial",fontSize:this.fontConfig.button,fontWeight:"bold",fill:16777215,align:"center"});return q.anchor.set(.5,.5),W.addChild(X),W.addChild(q),W.on("pointerdown",E),W.on("pointerover",()=>{X.tint=13421772}),W.on("pointerout",()=>{X.tint=16777215}),W}playAnimationSequence(){this.playShowAnimation(()=>{this.playColorAnimations(()=>{this.playTotalAnimations(()=>{this.showButtons()})})})}playShowAnimation(_){this.container.alpha=0,this.container.scale.set(.8);let T=0;const E=()=>{T+=.08,T>=1&&(T=1,this.gameApp.pixi.ticker.remove(E),_&&_());const W=1-Math.pow(1-T,3);this.container.alpha=W,this.container.scale.set(.8+(1-.8)*W)};this.gameApp.pixi.ticker.add(E)}playColorAnimations(_){let T=0;const E=()=>{if(T>=this.colorElements.length){_&&_();return}const W=this.colorElements[T];W.alpha=0,W.scale.set(.5);let X=0;const q=()=>{X+=.15,X>=1&&(X=1,this.gameApp.pixi.ticker.remove(q),T++,setTimeout(E,100));const Y=1-Math.pow(1-X,2);W.alpha=Y,W.scale.set(.5+(1-.5)*Y)};this.gameApp.pixi.ticker.add(q)};E()}playTotalAnimations(_){if(this.animationElements.scoreText){this.animationElements.scoreText.alpha=0,this.animationElements.scoreText.scale.set(.8);let T=0;const E=()=>{if(T+=.12,T>=1){T=1,this.gameApp.pixi.ticker.remove(E),this.animationElements.colorContainer.alpha=0,this.animationElements.colorContainer.scale.set(.8);let X=0;const q=()=>{X+=.12,X>=1&&(X=1,this.gameApp.pixi.ticker.remove(q),_&&_());const Y=1-Math.pow(1-X,2);this.animationElements.colorContainer.alpha=Y,this.animationElements.colorContainer.scale.set(.8+(1-.8)*Y)};this.gameApp.pixi.ticker.add(q)}const W=1-Math.pow(1-T,2);this.animationElements.scoreText.alpha=W,this.animationElements.scoreText.scale.set(.8+(1-.8)*W)};this.gameApp.pixi.ticker.add(E)}else _&&_()}showButtons(){if(this.buttonContainer){this.buttonContainer.alpha=0,this.buttonContainer.scale.set(.8);let _=0;const T=()=>{_+=.12,_>=1&&(_=1,this.gameApp.pixi.ticker.remove(T));const E=1-Math.pow(1-_,2);this.buttonContainer.alpha=E,this.buttonContainer.scale.set(.8+(1-.8)*E)};this.gameApp.pixi.ticker.add(T)}}onRestartClick(){this.hideSettlement(),this.gameApp.levelManager.loadLevel(this.settlementData.levelId)}onNextLevelClick(){this.hideSettlement();const _=this.settlementData.levelId+1;this.gameApp.levelManager.loadLevel(_)}destroy(){this.hideSettlement(),this.container&&this.container.parent&&this.container.parent.removeChild(this.container),this.container=null}}class GameApp{constructor(){Gn(this,"pixi",null);Gn(this,"cells",null);Gn(this,"physicsWorld",null);Gn(this,"timeStep",1/60);Gn(this,"velocityIterations",8);Gn(this,"positionIterations",3);Gn(this,"PPM",50);Gn(this,"colors",[4886754,8311585,16098851,15158332,10181046,1752220,15105570,3447003,3066993,15965202,15277667,48340]);Gn(this,"animationManager",null);Gn(this,"levelManager",null);Gn(this,"dragManager",null);Gn(this,"uiManager",null);Gn(this,"renderManager",null);Gn(this,"settlementManager",null);Gn(this,"normalCellGraphic",null);Gn(this,"highlightBorderGraphic",null);Gn(this,"highlightCellGraphic",null);Gn(this,"effectGraphic",null);Gn(this,"ui",null)}init(_){this.pixi=new Application({width:_.clientWidth,height:_.clientHeight,view:_}),this.initRenderLayers(),this.initPlanck(),this.initBounds(),this.pixi.ticker.add(this.updatePhysics.bind(this)),this.renderManager=new RenderManager(this),this.animationManager=new AnimationManager(this),this.levelManager=new LevelManager(this),this.dragManager=new DragManager(this),this.uiManager=new UIManager(this),this.settlementManager=new SettlementManager(this)}initRenderLayers(){this.cells=new Container,this.pixi.stage.addChild(this.cells),this.normalCellGraphic=new Graphics,this.pixi.stage.addChild(this.normalCellGraphic),this.highlightBorderGraphic=new Graphics,this.pixi.stage.addChild(this.highlightBorderGraphic),this.highlightCellGraphic=new Graphics,this.pixi.stage.addChild(this.highlightCellGraphic),this.effectGraphic=new Graphics,this.pixi.stage.addChild(this.effectGraphic),this.ui=new Container,this.pixi.stage.addChild(this.ui)}initPlanck(){this.physicsWorld=new World({gravity:new Vec2(0,9.8)})}updatePhysics(){this.physicsWorld.step(1/60,1,0),this.renderManager.drawAllCellGraphics()}initBounds(){const _=this.pixi.screen.width,T=this.pixi.screen.height,E=this.physicsWorld.createBody();E.createFixture(new Edge(new Vec2(0,0),new Vec2(_/this.PPM,0))),E.createFixture(new Edge(new Vec2(0,T/this.PPM),new Vec2(_/this.PPM,T/this.PPM))),E.createFixture(new Edge(new Vec2(0,0),new Vec2(0,T/this.PPM))),E.createFixture(new Edge(new Vec2(_/this.PPM,0),new Vec2(_/this.PPM,T/this.PPM))),this.bounds=E}getBounds(){return this.bounds}isInBounds(_){if(!this.bounds||!_)return!0;const T=_.getPosition(),E=this.pixi.screen.width,W=this.pixi.screen.height;return T.x*this.PPM>=0&&T.x*this.PPM<=E&&T.y*this.PPM>=0&&T.y*this.PPM<=W}addBody(_){return _}removeBody(_){_&&_.getWorld()&&_.getWorld().destroyBody(_)}addJoint(_){return _}removeJoint(_){_&&_.getWorld()&&_.getWorld().destroyJoint(_)}addConstraint(_){return this.addJoint(_)}removeConstraint(_){return this.removeJoint(_)}addCell(_){_&&this.cells.addChild(_)}removeCell(_){!_||_.isDestroyed||(_.isDestroyed=!0,_.bodies.forEach(T=>{this.physicsWorld.destroyBody(T)}),_.joints.forEach(T=>{this.physicsWorld.destroyJoint(T)}),this.cells.removeChild(_))}findAndRemoveMatches(_){if(!_)return;const T=this.cells.children.concat([]),E=[_],W=[_],X=new Set([_]);for(;E.length>0;){const q=E.pop();for(const Y of T)X.has(Y)||this.areCellsConnected(q,Y)&&q.colorIndex===Y.colorIndex&&(X.add(Y),W.push(Y),E.push(Y))}W.length>=2&&W.forEach(q=>this.removeCell(q))}areCellsConnected(_,T){const E=_.bodies,W=T.bodies;for(const X of E)for(const q of W)if(X===q)return!0;return!1}initDom(_,T={}){initDom(_,T)}destroy(){this.pixi&&this.pixi.ticker&&this.pixi.ticker.remove(this.updatePhysics),this.dragManager&&this.dragManager.destroy(),this.uiManager&&this.uiManager.destroy(),this.renderManager&&this.renderManager.destroy(),this.settlementManager&&this.settlementManager.destroy(),this.cells&&(this.cells.destroy(),this.cells=null),this.ui&&(this.ui.destroy(),this.ui=null),this.normalCellGraphic&&(this.normalCellGraphic.destroy(),this.normalCellGraphic=null),this.highlightBorderGraphic&&(this.highlightBorderGraphic.destroy(),this.highlightBorderGraphic=null),this.highlightCellGraphic&&(this.highlightCellGraphic.destroy(),this.highlightCellGraphic=null),this.effectGraphic&&(this.effectGraphic.destroy(),this.effectGraphic=null),this.physicsWorld&&(this.physicsWorld=null),this.bounds&&(this.bounds&&this.bounds.getWorld()&&this.bounds.getWorld().destroyBody(this.bounds),this.bounds=null),this.pixi&&(this.pixi.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.pixi=null)}}const gameApp=new GameApp,gameApp$1=gameApp,_hoisted_1$2={class:"game-container"},_sfc_main$2={__name:"GameMatch",setup(B){const _=ref$1(null);onMounted(()=>{T(),gameApp$1.levelManager.loadLevel(1)});function T(){window.gameApp=gameApp$1;const E={designWidth:1080,designHeight:1920};gameApp$1.initDom(_.value,E),gameApp$1.init(_.value)}return onUnmounted(()=>{gameApp$1.destroy()}),(E,W)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("canvas",{ref_key:"pixiContainer",ref:_},null,512)]))}};class TetrisTile extends Container{constructor(_,T){super(),this.game=_}init(_){this.colorIndex=_,this.gameView=this.game.currentView;let T="tetris/tile"+(_+1)+".png",E=this.game.textures[T];this.image=new Sprite$1(E),this.image.anchor.set(.5,.5),this.addChild(this.image)}get MoveTween(){return this.moveTween}set MoveTween(_){this.moveTween=_}animateToPosition(_,T){this.MoveTween&&(this.MoveTween.stop(),this.MoveTween=null);const E=this.position.x,W=this.position.y,X={x:E,y:W},q=new Tween(X).to(_,T).easing(Easing.Quadratic.Out).onUpdate(()=>{this.position.x=X.x,this.position.y=X.y}).onComplete(()=>{this.MoveTween=null}).start();this.MoveTween=q}playBreakAnim(){const X=this.position.x,q=this.position.y,Y="tetris/tile"+(this.colorIndex+1)+".png",te=this.game.textures[Y];for(let ne=0;ne<6;ne++){const ae=Math.random()*Math.PI*2,le=40+Math.random()*60,ue=X+Math.cos(ae)*le,ge=q+Math.sin(ae)*le,ye=(Math.random()-.5)*.01,xe=.6+Math.random()*.4,Te=xe*.3,Ae=600*(.7+Math.random()*.6),Ie=this.gameView.getParticle(te);Ie.x=X,Ie.y=q,Ie.alpha=1,Ie.scale.set(xe),Ie.rotation=Math.random()*Math.PI*2,this.gameView.addChild(Ie);const Ve={x:X,y:q,alpha:1,scale:xe,rotation:Ie.rotation};new Tween(Ve).to({x:ue,y:ge,alpha:0,scale:Te,rotation:Ie.rotation+ye*Ae},Ae).easing(Easing.Quadratic.Out).onUpdate(()=>{Ie.x=Ve.x,Ie.y=Ve.y,Ie.alpha=Ve.alpha,Ie.scale.set(Ve.scale),Ie.rotation=Ve.rotation}).onComplete(()=>{this.gameView.returnParticle(Ie)}).start()}}}const TetrisShapeType={I:"I",J:"J",L:"L",O:"O",S:"S",T:"T",Z:"Z"},TetrisShapeCount=7,TetrisShapeDef={I:{rotations:{0:[[1,1,1,1]],R:[[1],[1],[1],[1]],2:[[1,1,1,1]],L:[[1],[1],[1],[1]]},kickTable:{"0->R":[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],"R->0":[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],"R->2":[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],"2->R":[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],"2->L":[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],"L->2":[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],"L->0":[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],"0->L":[[0,0],[-1,0],[2,0],[-1,2],[2,-1]]}},J:{rotations:{0:[[1,0,0],[1,1,1]],R:[[1,1],[1,0],[1,0]],2:[[1,1,1],[0,0,1]],L:[[0,1],[0,1],[1,1]]},kickTable:{"0->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"R->0":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"R->2":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"2->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"2->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]],"L->2":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"L->0":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"0->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]]}},L:{rotations:{0:[[0,0,1],[1,1,1]],R:[[1,0],[1,0],[1,1]],2:[[1,1,1],[1,0,0]],L:[[1,1],[0,1],[0,1]]},kickTable:{"0->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"R->0":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"R->2":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"2->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"2->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]],"L->2":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"L->0":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"0->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]]}},O:{rotations:{0:[[1,1],[1,1]],R:[[1,1],[1,1]],2:[[1,1],[1,1]],L:[[1,1],[1,1]]},kickTable:{}},S:{rotations:{0:[[0,1,1],[1,1,0]],R:[[1,0],[1,1],[0,1]],2:[[0,1,1],[1,1,0]],L:[[1,0],[1,1],[0,1]]},kickTable:{"0->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"R->0":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"R->2":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"2->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"2->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]],"L->2":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"L->0":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"0->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]]}},T:{rotations:{0:[[0,1,0],[1,1,1]],R:[[1,0],[1,1],[1,0]],2:[[1,1,1],[0,1,0]],L:[[0,1],[1,1],[0,1]]},kickTable:{"0->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"R->0":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"R->2":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"2->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"2->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]],"L->2":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"L->0":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"0->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]]}},Z:{rotations:{0:[[1,1,0],[0,1,1]],R:[[0,1],[1,1],[1,0]],2:[[1,1,0],[0,1,1]],L:[[0,1],[1,1],[1,0]]},kickTable:{"0->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"R->0":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"R->2":[[0,0],[1,0],[1,-1],[0,2],[1,2]],"2->R":[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],"2->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]],"L->2":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"L->0":[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],"0->L":[[0,0],[1,0],[1,1],[0,-2],[1,-2]]}}};class RandGenerator{constructor(_){this.seed=_||Date.now(),this.state=this.seed}next(){return this.state=this.state*1103515245+12345&2147483647,this.state}nextInt(_){return this.next()%_}nextIntRange(_,T){return _+this.nextInt(T-_)}nextFloat(){return this.next()/2147483647}reset(_){_!==void 0&&(this.seed=_),this.state=this.seed}}class TetrisButton extends Container{constructor(_,T,E){super(),this.game=_,this.title=T,this.callback=E,this.init()}init(){const _=this.game.textures["tetris/button.png"];if(!_){console.warn("button.png texture not found");return}this.bgSprite=new Sprite$1(_),this.bgSprite.anchor.set(.5,.5),this.bgSprite.position.set(0,0),this.addChild(this.bgSprite);const T=new TextStyle({fontFamily:"Comic Sans MS, Marker Felt, Chalkduster, cursive",fontSize:24,fill:0,fontWeight:"bold",align:"center"});this.text=new Text$1(this.title,T),this.text.anchor.set(.5,.5),this.text.position.set(0,0),this.addChild(this.text),this.enabledCount=1,this.updateEnabledState(),this.on("pointerdown",this.onButtonDown.bind(this)),this.on("pointerup",this.onButtonUp.bind(this)),this.on("pointerupoutside",this.onButtonUp.bind(this)),this.on("pointertap",this.onButtonClick.bind(this)),this.on("touchstart",this.onButtonDown.bind(this)),this.on("touchend",this.onButtonUp.bind(this)),this.on("touchendoutside",this.onButtonUp.bind(this)),this.on("tap",this.onButtonClick.bind(this))}setEnabled(_){_?this.enabledCount++:this.enabledCount--,this.updateEnabledState()}updateEnabledState(){const _=this.enabledCount>0;this.eventMode=_?"static":"none",this.cursor=_?"pointer":"default",this.bgSprite&&(this.bgSprite.tint=_?16777215:8421504),this.text&&(this.text.style.fill=_?0:6710886)}onButtonDown(){this.scale.set(.9)}onButtonUp(){this.scale.set(1)}onButtonClick(){this.callback&&this.callback()}}class TetrisGameView extends Container{constructor(_){super(),this.game=_}init(){this.initBg(),this.initBgCenter(),this.initGameLogic(),this.initNextShapePreview(),this.initInfoDisplay(),this.tagUpdate=this.update.bind(this),this.game.pixi.ticker.add(this.tagUpdate,this),this.initKeyboard()}initGameLogic(){this.rowCount=20,this.colCount=10,this.tileSize=25,this.extraTopRowCount=6,this.speedLevel=1,this.dropSpeedTimer=0,this.dropPaused=!1,this.isDead=!1,this.score=0,this.linesCleared=0,this.tiles=[];for(let _=0;_<this.rowCount+this.extraTopRowCount;_++){this.tiles[_]=[];for(let T=0;T<this.colCount;T++)this.tiles[_][T]=null}this.particlePool=[],this.particlePoolSize=100,this.initParticlePool(),this.shapeGenerator=new RandGenerator(this.game.GameStartOption.ShapeGeneratorSeed),this.nextShapInfos=[],this.initShapeQueue()}dropSpeed(){return 500-(this.speedLevel-1)*400/9}get moveAnimationDuration(){return this.dropSpeed()/3}initShapeQueue(){this.nextShapInfos=[],this.getNextShapeInfo()}getNextShapeInfo(){const _=this.nextShapInfos.shift(),T=Object.values(TetrisShapeType);for(;this.nextShapInfos.length<2;){let E=this.shapeGenerator.nextInt(TetrisShapeCount);const W=T[E],X=E;this.nextShapInfos.push({shapeType:W,colorIndex:X})}return this.updateNextShapePreview(),_}switchNextShapeInfo(){if(this.nextShapInfos.length>=2){const _=this.nextShapInfos[0];this.nextShapInfos[0]=this.nextShapInfos[1],this.nextShapInfos[1]=_,this.updateNextShapePreview()}}initKeyboard(){this.onKeyDown=_=>{if(this.isDead)return;const T=_.key.toLowerCase();if(T===" "){_.preventDefault(),this.dropPaused=!this.dropPaused;return}if(T==="f"){this.switchNextShapeInfo();return}this.dropInfo&&(T==="w"||_.key==="ArrowUp"?this.handleRotate():T==="s"||_.key==="ArrowDown"?this.handleDrop():T==="a"||_.key==="ArrowLeft"?this.handleMoveLeft():T==="d"||_.key==="ArrowRight"?this.handleMoveRight():T==="q"&&this.playBreakAnim())},window.addEventListener("keydown",this.onKeyDown)}handleRotate(){if(!this.dropInfo)return;const _=[0,"R",2,"L"],T=_.indexOf(this.dropInfo.rotation),E=_[(T+1)%4];this.tryRotate(this.dropInfo.rotation,E)}tryRotate(_,T){const E=TetrisShapeDef[this.dropInfo.shapeType],W=E.rotations[_],X=E.rotations[T],q=`${_}->${T}`,Y=E.kickTable[q]||[[0,0]],te=this.getShapeBaseRC(),ne=[];for(let ge=0;ge<W.length;ge++)for(let ye=0;ye<W[ge].length;ye++)W[ge][ye]>0&&ne.push({r:ge,c:ye});const ae=[];for(let ge=0;ge<X.length;ge++)for(let ye=0;ye<X[ge].length;ye++)X[ge][ye]>0&&ae.push({r:ge,c:ye});if(ne.length!==ae.length)return!1;const le=Math.min(...ne.map(ge=>ge.r)),ue=Math.min(...ne.map(ge=>ge.c));Math.min(...ae.map(ge=>ge.r)),Math.min(...ae.map(ge=>ge.c));for(let ge=0;ge<Y.length;ge++){const ye=Y[ge],xe=[];for(let Te=0;Te<ae.length;Te++){const Ae=ae[Te],Ie={r:te.r-le+Ae.r+ye[1],c:te.c-ue+Ae.c+ye[0]};xe.push(Ie)}if(this.isValidPosition(xe))return this.applyRotation(xe,T),!0}return!1}getShapeBaseRC(){let _=1/0,T=1/0;for(let E=0;E<this.dropInfo.rcs.length;E++)_=Math.min(_,this.dropInfo.rcs[E].r),T=Math.min(T,this.dropInfo.rcs[E].c);return{r:_,c:T}}getFirstTilePosition(_){for(let T=0;T<_.length;T++)for(let E=0;E<_[T].length;E++)if(_[T][E]>0)return{r:T,c:E};return{r:0,c:0}}isValidPosition(_){for(let T=0;T<_.length;T++){const E=_[T];if(E.r<0||E.r>=this.rowCount+this.extraTopRowCount||E.c<0||E.c>=this.colCount||this.tiles[E.r]&&this.tiles[E.r][E.c])return!1}return!0}applyRotation(_,T){for(let E=0;E<this.dropInfo.rcs.length;E++){const W=_[E],X=this.dropInfo.tiles[E];this.dropInfo.rcs[E]=W;const q=this.getPosByRC(W.r,W.c);X.animateToPosition(q,this.moveAnimationDuration)}this.dropInfo.rotation=T,this.updateDropIndicator()}handleDrop(){if(!this.dropInfo)return;const _=this.getDropLandingRCs();if(_.length===0)return;let T=1/0;for(let E=0;E<this.dropInfo.rcs.length;E++){const W=this.dropInfo.rcs[E].r,X=_[E].r,q=W-X;T=Math.min(T,q)}if(T>200){for(let E=0;E<this.dropInfo.rcs.length;E++){this.dropInfo.rcs[E].r;const X=_[E].r+1,q=this.dropInfo.tiles[E];this.dropInfo.rcs[E].r=X;const Y=this.getPosByRC(X,this.dropInfo.rcs[E].c);q.animateToPosition(Y,this.moveAnimationDuration)}this.updateDropIndicator(),this.dropSpeedTimer=0}else if(T>0){for(let E=0;E<this.dropInfo.rcs.length;E++){const W=_[E],X=this.dropInfo.tiles[E];this.dropInfo.rcs[E]=W;const q=this.getPosByRC(W.r,W.c);X.animateToPosition(q,this.moveAnimationDuration)}this.updateDropIndicator(),this.dropSpeedTimer=0}}handleMoveLeft(){this.canMoveLeft()&&this.moveDropingInfo({r:0,c:-1})}handleMoveRight(){this.canMoveRight()&&this.moveDropingInfo({r:0,c:1})}canMoveLeft(){if(!this.dropInfo)return!1;for(let _=0;_<this.dropInfo.rcs.length;_++){let T=this.dropInfo.rcs[_];if(T.c<=0||this.tiles[T.r][T.c-1])return!1}return!0}canMoveRight(){if(!this.dropInfo)return!1;for(let _=0;_<this.dropInfo.rcs.length;_++){let T=this.dropInfo.rcs[_];if(T.c>=this.colCount-1||this.tiles[T.r][T.c+1])return!1}return!0}update(){const _=this.game.pixi.ticker.deltaMS;this.dropPaused||(this.dropSpeedTimer+=_,this.dropSpeedTimer>=this.dropSpeed()&&(this.dropSpeedTimer=0,this.checkTotalDrop()))}checkTotalDrop(){this.isAtBottom(this.dropInfo)?this.removeDropingShape():this.dropInfo?this.doDrop():this.createNewShape()}removeDropingShape(){for(let T=0;T<this.dropInfo.rcs.length;T++){let E=this.dropInfo.rcs[T];this.tiles[E.r][E.c]=this.dropInfo.tiles[T]}const _=[];for(let T=0;T<this.dropInfo.rcs.length;T++){const E=this.dropInfo.rcs[T].r;E>=0&&E<this.rowCount&&(_.includes(E)||_.push(E))}if(this.dropInfo.previewSprites){for(let T=0;T<this.dropInfo.previewSprites.length;T++)this.removeChild(this.dropInfo.previewSprites[T]);this.dropInfo.previewSprites=null}this.dropInfo=null,this.checkBreakLine(_),!this.isDead&&this.checkDead(_)&&this.onDead()}checkBreakLine(_){const T=[];for(let E=0;E<_.length;E++){const W=_[E];let X=!0;for(let q=0;q<this.colCount;q++)if(!this.tiles[W][q]){X=!1;break}X&&T.push(W)}if(T.length!==0){this.dropPaused=!0;for(let E=0;E<T.length;E++){const W=T[E];for(let X=0;X<this.colCount;X++){const q=this.tiles[W][X];q&&q.playBreakAnim()}}setTimeout(()=>{this.removeFullRows(T)},100)}}removeFullRows(_){const T=_.length,E=this.linesCleared;this.linesCleared+=T;const W=Math.floor(E/10),X=Math.floor(this.linesCleared/10);X>W&&this.speedLevel<10&&(this.speedLevel=Math.min(this.speedLevel+(X-W),10));let q=1e3;T===1?q=100:T===2?q=200:T===3?q=600:T===4&&(q=800),this.score+=q,this.updateInfoDisplay();for(let te=0;te<_.length;te++){const ne=_[te];for(let ae=0;ae<this.colCount;ae++){const le=this.tiles[ne][ae];le&&le.parent&&le.parent.removeChild(le),this.tiles[ne][ae]=null}}const Y=new Set(_);for(let te=0;te<this.rowCount+this.extraTopRowCount;te++){if(Y.has(te))continue;let ne=0;for(let ae=0;ae<te;ae++)Y.has(ae)&&ne++;if(ne!==0)for(let ae=0;ae<this.colCount;ae++){const le=this.tiles[te][ae];if(le){const ue=te-ne;this.tiles[ue][ae]=le,this.tiles[te][ae]=null;const ge=this.getPosByRC(ue,ae);le.animateToPosition(ge,this.moveAnimationDuration)}}}setTimeout(()=>{this.dropPaused=!1},this.moveAnimationDuration)}doDrop(){this.moveDropingInfo({r:-1,c:0})}moveDropingInfo(_){for(let T=0;T<this.dropInfo.rcs.length;T++){let E=this.dropInfo.rcs[T];const W=this.dropInfo.tiles[T];E.r+=_.r,E.c+=_.c;const X=this.getPosByRC(E.r,E.c);W.animateToPosition(X,this.moveAnimationDuration)}this.updateDropIndicator()}createNewShape(){this.dropInfo={};const _=this.getNextShapeInfo();this.dropInfo.shapeType=_.shapeType,this.dropInfo.rotation=0,this.dropInfo.rcs=[],this.dropInfo.tiles=[];let E=TetrisShapeDef[this.dropInfo.shapeType].rotations[0],W=0;for(let ue=0;ue<E.length;ue++)for(let ge=0;ge<E[ue].length;ge++)E[ue][ge]>0&&(W=Math.max(W,ue));let X=Math.floor((this.colCount-E[0].length)/2),q=[];for(let ue=0;ue<E.length;ue++)for(let ge=0;ge<E[ue].length;ge++)E[ue][ge]>0&&q.push({r:ue,c:ge});let Y=this.rowCount-1-W,te=q.map(ue=>({r:Y+ue.r,c:X+ue.c}));for(;!this.isValidPosition(te)&&Y<this.rowCount+this.extraTopRowCount-1;)Y++,te=q.map(ue=>({r:Y+ue.r,c:X+ue.c}));if(!this.isValidPosition(te)){this.isDead||this.onDead();return}let ne=_.colorIndex;this.dropInfo.previewSprites=[];const ae="tetris/tile"+(ne+1)+".png",le=this.game.textures[ae];for(let ue=0;ue<E.length;ue++)for(let ge=0;ge<E[ue].length;ge++)if(E[ue][ge]>0){let xe=new TetrisTile(this.game);xe.init(ne),this.addChild(xe);let Te=this.getPosByRC(Y+ue,X+ge);xe.position.set(Te.x,Te.y),this.dropInfo.rcs.push({r:Y+ue,c:X+ge}),this.dropInfo.tiles.push(xe);const Ae=new Sprite$1(le);Ae.anchor.set(.5,.5),Ae.alpha=.1,Ae.tint=0,this.addChild(Ae),this.dropInfo.previewSprites.push(Ae)}this.updateDropIndicator()}checkDead(_){const T=[20,21,22,23],E=_.filter(X=>T.includes(X)),W=E.length>0?E:T;for(let X=0;X<W.length;X++){const q=W[X];for(let Y=0;Y<this.colCount;Y++)if(this.tiles[q]&&this.tiles[q][Y])return!0}return!1}onDead(){this.isDead=!0,this.dropPaused=!0,setTimeout(()=>{this.playDeadAppearAnim()},500)}playDeadAppearAnim(){const _=this.game.textures["tetris/bg_center_up.png"],T=this.game.textures["tetris/circle.png"];if(!T||!_)return;this.deadMaskGraphics=new Graphics,this.deadMaskGraphics.beginFill(0,.5),this.deadMaskGraphics.drawRoundedRect(-_.width/2,-_.height/2,_.width,_.height,10),this.deadMaskGraphics.endFill(),this.deadMaskGraphics.position.set(0,0),this.deadMaskGraphics.alpha=0,this.addChild(this.deadMaskGraphics),new Tween({alpha:0}).to({alpha:1},250).onUpdate(te=>{this.deadMaskGraphics.alpha=te.alpha}).start(),this.deadContainer=new Container,this.deadContainer.position.set(0,0);const W=new Sprite$1(T);W.anchor.set(.5,.5),W.position.set(0,0),this.deadContainer.addChild(W);const X=new TextStyle({fontFamily:"Comic Sans MS, Marker Felt, Chalkduster, cursive",fontSize:64,fill:16766720,fontWeight:"bold",align:"center"}),q=new Text$1("DEAD",X);q.anchor.set(.5,.5),q.position.set(0,0),this.deadContainer.addChild(q);const Y=new TetrisButton(this.game,"Return Main",()=>{this.game.replaceView("TetrisStartView")});Y.position.set(0,150),this.deadContainer.addChild(Y),Y.setEnabled(!1),this.deadContainer.alpha=0,this.deadContainer.scale.set(.1),this.addChild(this.deadContainer),new Tween({scale:.1}).to({scale:1},800).easing(Easing.Elastic.Out).onUpdate(te=>{this.deadContainer.scale.set(te.scale)}).onComplete(()=>{Y.setEnabled(!0)}).start(),new Tween({alpha:0}).to({alpha:1},250).onUpdate(te=>{this.deadContainer.alpha=te.alpha}).start()}restartGame(){if(this.dropInfo){if(this.dropInfo.tiles)for(let _=0;_<this.dropInfo.tiles.length;_++)this.dropInfo.tiles[_].parent&&this.dropInfo.tiles[_].parent.removeChild(this.dropInfo.tiles[_]);if(this.dropInfo.previewSprites)for(let _=0;_<this.dropInfo.previewSprites.length;_++)this.dropInfo.previewSprites[_].parent&&this.removeChild(this.dropInfo.previewSprites[_]);this.dropInfo=null}for(let _=0;_<this.rowCount+this.extraTopRowCount;_++)for(let T=0;T<this.colCount;T++)this.tiles[_]&&this.tiles[_][T]&&this.tiles[_][T].parent&&this.tiles[_][T].parent.removeChild(this.tiles[_][T]);this.deadContainer&&(this.deadContainer.parent&&this.removeChild(this.deadContainer),this.deadContainer=null),this.deadMaskGraphics&&(this.deadMaskGraphics.parent&&this.removeChild(this.deadMaskGraphics),this.deadMaskGraphics=null),this.initGameLogic(),this.updateInfoDisplay()}getPosByRC(_,T){let E={x:T*this.tileSize,y:-_*this.tileSize};return E.x+=this.tileSize/2,E.y-=this.tileSize/2,E.x-=this.colCount*this.tileSize/2,E.y+=this.rowCount*this.tileSize/2,E}isAtBottom(_){if(_||(_=this.dropInfo),!_)return!1;for(let T=0;T<_.rcs.length;T++){let E=_.rcs[T];if(E.r==0)return!0;let W=this.getNextTileRCByRC(E);if(W&&E.r-W.r==1)return!0}return!1}getDropLandingRCs(){if(!this.dropInfo)return[];const _=this.dropInfo.rcs.map(W=>({r:W.r,c:W.c}));let T=0;for(;;){const W=_.map(q=>({r:q.r-T-1,c:q.c}));let X=!0;for(let q=0;q<W.length;q++){const Y=W[q];if(Y.r<0){X=!1;break}if(this.tiles[Y.r]&&this.tiles[Y.r][Y.c]){X=!1;break}}if(!X)break;T++}return _.map(W=>({r:W.r-T,c:W.c}))}updateDropIndicator(){if(!this.dropInfo||!this.dropInfo.previewSprites)return;const _=this.getDropLandingRCs();for(let T=0;T<this.dropInfo.previewSprites.length;T++){const E=this.dropInfo.previewSprites[T],W=_[T],X=this.getPosByRC(W.r,W.c);E.position.set(X.x,X.y)}}getNextTileRCByRC(_){for(let T=_.r-1;T>=0;T--)if(this.tiles[T]&&this.tiles[T][_.c])return{r:T,c:_.c};return null}initBg(){const _=this.game.textures["tetris/bg_total.png"],T=this.game.pixi.screen.width,E=this.game.pixi.screen.height,W=50,X=50,q=50,Y=50;this.bg=new Container;const te=_.width,ne=_.height,ae=te-W-q,le=ne-X-Y,ue=T,ge=E,ye=(ue-W-q)/ae,xe=(ge-X-Y)/le,Te={topLeft:new Rectangle(0,0,W,X),topRight:new Rectangle(te-q,0,q,X),bottomLeft:new Rectangle(0,ne-Y,W,Y),bottomRight:new Rectangle(te-q,ne-Y,q,Y),top:new Rectangle(W,0,ae,X),bottom:new Rectangle(W,ne-Y,ae,Y),left:new Rectangle(0,X,W,le),right:new Rectangle(te-q,X,q,le),center:new Rectangle(W,X,ae,le)};let Ae=-ue/2,Ie=-ge/2;this.addSprite(_,Te.topLeft,Ae,Ie,W,X),this.addSprite(_,Te.top,Ae+W,Ie,ae*ye,X),this.addSprite(_,Te.topRight,Ae+ue-q,Ie,q,X),Ie+=X,this.addSprite(_,Te.left,Ae,Ie,W,le*xe),this.addSprite(_,Te.center,Ae+W,Ie,ae*ye,le*xe),this.addSprite(_,Te.right,Ae+ue-q,Ie,q,le*xe),Ie+=le*xe,this.addSprite(_,Te.bottomLeft,Ae,Ie,W,Y),this.addSprite(_,Te.bottom,Ae+W,Ie,ae*ye,Y),this.addSprite(_,Te.bottomRight,Ae+ue-q,Ie,q,Y),this.addChild(this.bg)}initBgCenter(){const _=this.game.textures["tetris/bg_center_up.png"];this.bgCenterUp=new Sprite$1(_),this.bgCenterUp.anchor.set(.5,.5),this.bgCenterUp.x=0,this.bgCenterUp.y=0,this.addChild(this.bgCenterUp)}initInfoDisplay(){this.infoDisplayContainer=new Container,this.infoDisplayContainer.position.set(125,-150),this.addChild(this.infoDisplayContainer);const _=this.game.textures["tetris/bg_r_1.png"];this.infoDisplayBg=new Sprite$1(_),this.infoDisplayBg.anchor.set(0,0),this.infoDisplayContainer.addChild(this.infoDisplayBg);const T=new TextStyle({fontFamily:"Comic Sans MS, Marker Felt, Chalkduster, cursive",fontSize:16,fill:0,align:"left"});this.infoDisplayConfigs=[{title:"Speed:",getValue:()=>this.speedLevel,valueLabel:null},{title:"Lines:",getValue:()=>this.linesCleared,valueLabel:null},{title:"Score:",getValue:()=>this.score,valueLabel:null}],this.infoDisplayConfigs.forEach((E,W)=>{const X=14+W*24,q=new Text$1(E.title,T);q.anchor.set(1,0),q.x=60,q.y=X,this.infoDisplayContainer.addChild(q);const Y=new Text$1("0",T);Y.anchor.set(0,0),Y.x=64,Y.y=X,this.infoDisplayContainer.addChild(Y),E.valueLabel=Y,this.animRollNum(Y,E.getValue())})}animRollNum(_,T){if(!_.animState){_.animState={current:T,target:T,tween:null},_.text=T.toString();return}const E=_.animState;if(E.target===T)return;E.target=T,E.tween&&E.tween.stop();const W=E.current;E.tween=new Tween({value:W}).to({value:T},200).onUpdate(X=>{const q=Math.round(X.value);E.current=q,_.text=q.toString()}).onComplete(()=>{E.current=T,_.text=T.toString()}).start()}updateInfoDisplay(){this.infoDisplayContainer&&this.infoDisplayConfigs.forEach(_=>{this.animRollNum(_.valueLabel,_.getValue())})}initNextShapePreview(){this.nextShapePreviewContainer=new Container;const _=this.bgCenterUp.x+this.bgCenterUp.width/2,T=this.game.textures["tetris/bg_r_1.png"];this.nextShapePreviewBg=new Sprite$1(T),this.nextShapePreviewBg.anchor.set(0,.5),this.nextShapePreviewBg.x=_,this.nextShapePreviewBg.y=-200,this.nextShapePreviewContainer.addChild(this.nextShapePreviewBg),this.nextShapePreviewTiles=[[],[]],this.addChild(this.nextShapePreviewContainer),this.updateNextShapePreview()}updateNextShapePreview(){if(!this.nextShapePreviewContainer||this.nextShapePreviewTiles.length<2)return;for(let le=0;le<2;le++){for(let ue=0;ue<this.nextShapePreviewTiles[le].length;ue++)this.nextShapePreviewTiles[le][ue].parent&&this.nextShapePreviewTiles[le][ue].parent.removeChild(this.nextShapePreviewTiles[le][ue]);this.nextShapePreviewTiles[le]=[]}if(this.nextShapInfos.length<2)return;const _=this.nextShapePreviewBg.x,T=this.nextShapePreviewBg.width,E=this.nextShapePreviewBg.y,W=15,X=_+T*.25,q=E,Y=this.nextShapInfos[0];this.renderShapePreview(Y,X,q,W,1,0);const te=_+T*.75,ne=E,ae=this.nextShapInfos[1];this.renderShapePreview(ae,te,ne,W,.5,1)}renderShapePreview(_,T,E,W,X,q){if(!_)return;const te=TetrisShapeDef[_.shapeType].rotations[0];let ne=1/0,ae=-1/0,le=1/0,ue=-1/0;for(let Ve=0;Ve<te.length;Ve++)for(let $e=0;$e<te[Ve].length;$e++)te[Ve][$e]>0&&(ne=Math.min(ne,Ve),ae=Math.max(ae,Ve),le=Math.min(le,$e),ue=Math.max(ue,$e));const ge=(ue-le+1)*W,ye=(ae-ne+1)*W,xe=-ge/2+W/2,Te=-ye/2+W/2,Ae="tetris/tile"+(_.colorIndex+1)+".png",Ie=this.game.textures[Ae];for(let Ve=0;Ve<te.length;Ve++)for(let $e=0;$e<te[Ve].length;$e++)if(te[Ve][$e]>0){const We=new Sprite$1(Ie);We.anchor.set(.5,.5),We.alpha=X,We.width=W,We.height=W;const Ue=T+xe+($e-le)*W,je=E+Te-(Ve-ne)*W;We.position.set(Ue,je),this.nextShapePreviewContainer.addChild(We),this.nextShapePreviewTiles[q].push(We)}}addSprite(_,T,E,W,X,q){const Y=new Sprite$1(new Texture$1(_.baseTexture,T));Y.x=E,Y.y=W,Y.width=X,Y.height=q,this.bg.addChild(Y)}initParticlePool(){for(let _=0;_<this.particlePoolSize;_++){const T=new Sprite$1;T.anchor.set(.5,.5),T.visible=!1,this.particlePool.push(T)}}getParticle(_){let T=this.particlePool.pop();return T||(T=new Sprite$1,T.anchor.set(.5,.5)),T.texture=_,T.visible=!0,T.alpha=1,T.scale.set(1),T.rotation=0,T}returnParticle(_){_&&(_.visible=!1,_.alpha=1,_.scale.set(1),_.rotation=0,_.parent&&_.parent.removeChild(_),this.particlePool.push(_))}playBreakAnim(){if(!(!this.dropInfo||!this.dropInfo.tiles))for(let _=0;_<this.dropInfo.tiles.length;_++)this.dropInfo.tiles[_].playBreakAnim()}safeRemoveSelf(){this.dropInfo&&this.dropInfo.tiles&&this.dropInfo.tiles.forEach(_=>{_.MoveTween&&(_.MoveTween.stop(),_.MoveTween=null)});for(let _=0;_<this.tiles.length;_++)for(let T=0;T<this.tiles[_].length;T++){const E=this.tiles[_][T];E&&E.MoveTween&&(E.MoveTween.stop(),E.MoveTween=null)}window.removeEventListener("keydown",this.onKeyDown),this.game.pixi.ticker.remove(this.tagUpdate),this.parent.removeChild(this)}}var play={exports:{}};(function(module,exports){var define_process_env_default={};(function(B,_){_(exports)})(commonjsGlobal,function(exports){var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function unwrapExports(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}function createCommonjsModule(B,_){return _={exports:{}},B(_,_.exports),_.exports}var runtime=createCommonjsModule(function(B){(function(_){var T=Object.prototype,E=T.hasOwnProperty,W,X=typeof Symbol=="function"?Symbol:{},q=X.iterator||"@@iterator",Y=X.asyncIterator||"@@asyncIterator",te=X.toStringTag||"@@toStringTag",ne=_.regeneratorRuntime;if(ne){B.exports=ne;return}ne=_.regeneratorRuntime=B.exports;function ae(lt,st,sr,mt){var Tr=st&&st.prototype instanceof Ae?st:Ae,di=Object.create(Tr.prototype),Mi=new Je(mt||[]);return di._invoke=Le(lt,sr,Mi),di}ne.wrap=ae;function le(lt,st,sr){try{return{type:"normal",arg:lt.call(st,sr)}}catch(mt){return{type:"throw",arg:mt}}}var ue="suspendedStart",ge="suspendedYield",ye="executing",xe="completed",Te={};function Ae(){}function Ie(){}function Ve(){}var $e={};$e[q]=function(){return this};var We=Object.getPrototypeOf,Ue=We&&We(We(pt([])));Ue&&Ue!==T&&E.call(Ue,q)&&($e=Ue);var je=Ve.prototype=Ae.prototype=Object.create($e);Ie.prototype=je.constructor=Ve,Ve.constructor=Ie,Ve[te]=Ie.displayName="GeneratorFunction";function ze(lt){["next","throw","return"].forEach(function(st){lt[st]=function(sr){return this._invoke(st,sr)}})}ne.isGeneratorFunction=function(lt){var st=typeof lt=="function"&&lt.constructor;return st?st===Ie||(st.displayName||st.name)==="GeneratorFunction":!1},ne.mark=function(lt){return Object.setPrototypeOf?Object.setPrototypeOf(lt,Ve):(lt.__proto__=Ve,te in lt||(lt[te]="GeneratorFunction")),lt.prototype=Object.create(je),lt},ne.awrap=function(lt){return{__await:lt}};function He(lt){function st(Tr,di,Mi,Gr){var ci=le(lt[Tr],lt,di);if(ci.type==="throw")Gr(ci.arg);else{var gi=ci.arg,fi=gi.value;return fi&&typeof fi=="object"&&E.call(fi,"__await")?Promise.resolve(fi.__await).then(function(ri){st("next",ri,Mi,Gr)},function(ri){st("throw",ri,Mi,Gr)}):Promise.resolve(fi).then(function(ri){gi.value=ri,Mi(gi)},Gr)}}var sr;function mt(Tr,di){function Mi(){return new Promise(function(Gr,ci){st(Tr,di,Gr,ci)})}return sr=sr?sr.then(Mi,Mi):Mi()}this._invoke=mt}ze(He.prototype),He.prototype[Y]=function(){return this},ne.AsyncIterator=He,ne.async=function(lt,st,sr,mt){var Tr=new He(ae(lt,st,sr,mt));return ne.isGeneratorFunction(st)?Tr:Tr.next().then(function(di){return di.done?di.value:Tr.next()})};function Le(lt,st,sr){var mt=ue;return function(di,Mi){if(mt===ye)throw new Error("Generator is already running");if(mt===xe){if(di==="throw")throw Mi;return ut()}for(sr.method=di,sr.arg=Mi;;){var Gr=sr.delegate;if(Gr){var ci=qe(Gr,sr);if(ci){if(ci===Te)continue;return ci}}if(sr.method==="next")sr.sent=sr._sent=sr.arg;else if(sr.method==="throw"){if(mt===ue)throw mt=xe,sr.arg;sr.dispatchException(sr.arg)}else sr.method==="return"&&sr.abrupt("return",sr.arg);mt=ye;var gi=le(lt,st,sr);if(gi.type==="normal"){if(mt=sr.done?xe:ge,gi.arg===Te)continue;return{value:gi.arg,done:sr.done}}else gi.type==="throw"&&(mt=xe,sr.method="throw",sr.arg=gi.arg)}}}function qe(lt,st){var sr=lt.iterator[st.method];if(sr===W){if(st.delegate=null,st.method==="throw"){if(lt.iterator.return&&(st.method="return",st.arg=W,qe(lt,st),st.method==="throw"))return Te;st.method="throw",st.arg=new TypeError("The iterator does not provide a 'throw' method")}return Te}var mt=le(sr,lt.iterator,st.arg);if(mt.type==="throw")return st.method="throw",st.arg=mt.arg,st.delegate=null,Te;var Tr=mt.arg;if(!Tr)return st.method="throw",st.arg=new TypeError("iterator result is not an object"),st.delegate=null,Te;if(Tr.done)st[lt.resultName]=Tr.value,st.next=lt.nextLoc,st.method!=="return"&&(st.method="next",st.arg=W);else return Tr;return st.delegate=null,Te}ze(je),je[te]="Generator",je[q]=function(){return this},je.toString=function(){return"[object Generator]"};function Qe(lt){var st={tryLoc:lt[0]};1 in lt&&(st.catchLoc=lt[1]),2 in lt&&(st.finallyLoc=lt[2],st.afterLoc=lt[3]),this.tryEntries.push(st)}function Ke(lt){var st=lt.completion||{};st.type="normal",delete st.arg,lt.completion=st}function Je(lt){this.tryEntries=[{tryLoc:"root"}],lt.forEach(Qe,this),this.reset(!0)}ne.keys=function(lt){var st=[];for(var sr in lt)st.push(sr);return st.reverse(),function mt(){for(;st.length;){var Tr=st.pop();if(Tr in lt)return mt.value=Tr,mt.done=!1,mt}return mt.done=!0,mt}};function pt(lt){if(lt){var st=lt[q];if(st)return st.call(lt);if(typeof lt.next=="function")return lt;if(!isNaN(lt.length)){var sr=-1,mt=function Tr(){for(;++sr<lt.length;)if(E.call(lt,sr))return Tr.value=lt[sr],Tr.done=!1,Tr;return Tr.value=W,Tr.done=!0,Tr};return mt.next=mt}}return{next:ut}}ne.values=pt;function ut(){return{value:W,done:!0}}Je.prototype={constructor:Je,reset:function(lt){if(this.prev=0,this.next=0,this.sent=this._sent=W,this.done=!1,this.delegate=null,this.method="next",this.arg=W,this.tryEntries.forEach(Ke),!lt)for(var st in this)st.charAt(0)==="t"&&E.call(this,st)&&!isNaN(+st.slice(1))&&(this[st]=W)},stop:function(){this.done=!0;var lt=this.tryEntries[0],st=lt.completion;if(st.type==="throw")throw st.arg;return this.rval},dispatchException:function(lt){if(this.done)throw lt;var st=this;function sr(ci,gi){return di.type="throw",di.arg=lt,st.next=ci,gi&&(st.method="next",st.arg=W),!!gi}for(var mt=this.tryEntries.length-1;mt>=0;--mt){var Tr=this.tryEntries[mt],di=Tr.completion;if(Tr.tryLoc==="root")return sr("end");if(Tr.tryLoc<=this.prev){var Mi=E.call(Tr,"catchLoc"),Gr=E.call(Tr,"finallyLoc");if(Mi&&Gr){if(this.prev<Tr.catchLoc)return sr(Tr.catchLoc,!0);if(this.prev<Tr.finallyLoc)return sr(Tr.finallyLoc)}else if(Mi){if(this.prev<Tr.catchLoc)return sr(Tr.catchLoc,!0)}else if(Gr){if(this.prev<Tr.finallyLoc)return sr(Tr.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(lt,st){for(var sr=this.tryEntries.length-1;sr>=0;--sr){var mt=this.tryEntries[sr];if(mt.tryLoc<=this.prev&&E.call(mt,"finallyLoc")&&this.prev<mt.finallyLoc){var Tr=mt;break}}Tr&&(lt==="break"||lt==="continue")&&Tr.tryLoc<=st&&st<=Tr.finallyLoc&&(Tr=null);var di=Tr?Tr.completion:{};return di.type=lt,di.arg=st,Tr?(this.method="next",this.next=Tr.finallyLoc,Te):this.complete(di)},complete:function(lt,st){if(lt.type==="throw")throw lt.arg;return lt.type==="break"||lt.type==="continue"?this.next=lt.arg:lt.type==="return"?(this.rval=this.arg=lt.arg,this.method="return",this.next="end"):lt.type==="normal"&&st&&(this.next=st),Te},finish:function(lt){for(var st=this.tryEntries.length-1;st>=0;--st){var sr=this.tryEntries[st];if(sr.finallyLoc===lt)return this.complete(sr.completion,sr.afterLoc),Ke(sr),Te}},catch:function(lt){for(var st=this.tryEntries.length-1;st>=0;--st){var sr=this.tryEntries[st];if(sr.tryLoc===lt){var mt=sr.completion;if(mt.type==="throw"){var Tr=mt.arg;Ke(sr)}return Tr}}throw new Error("illegal catch attempt")},delegateYield:function(lt,st,sr){return this.delegate={iterator:pt(lt),resultName:st,nextLoc:sr},this.method==="next"&&(this.arg=W),Te}}})(function(){return this}()||Function("return this")())}),g=function(){return this}()||Function("return this")(),hadRuntime=g.regeneratorRuntime&&Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime")>=0,oldRuntime=hadRuntime&&g.regeneratorRuntime;g.regeneratorRuntime=void 0;var runtimeModule=runtime;if(hadRuntime)g.regeneratorRuntime=oldRuntime;else try{delete g.regeneratorRuntime}catch{g.regeneratorRuntime=void 0}var regenerator=runtimeModule,ceil=Math.ceil,floor=Math.floor,_toInteger=function(B){return isNaN(B=+B)?0:(B>0?floor:ceil)(B)},_defined=function(B){if(B==null)throw TypeError("Can't call method on  "+B);return B},_stringAt=function(B){return function(_,T){var E=String(_defined(_)),W=_toInteger(T),X=E.length,q,Y;return W<0||W>=X?"":(q=E.charCodeAt(W),q<55296||q>56319||W+1===X||(Y=E.charCodeAt(W+1))<56320||Y>57343?E.charAt(W):E.slice(W,W+2))}},_library=!0,_global=createCommonjsModule(function(B){var _=B.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=_)}),_core=createCommonjsModule(function(B){var _=B.exports={version:"2.6.12"};typeof __e=="number"&&(__e=_)});_core.version;var _aFunction=function(B){if(typeof B!="function")throw TypeError(B+" is not a function!");return B},_ctx=function(B,_,T){if(_aFunction(B),_===void 0)return B;switch(T){case 1:return function(E){return B.call(_,E)};case 2:return function(E,W){return B.call(_,E,W)};case 3:return function(E,W,X){return B.call(_,E,W,X)}}return function(){return B.apply(_,arguments)}},_isObject=function(B){return typeof B=="object"?B!==null:typeof B=="function"},_anObject=function(B){if(!_isObject(B))throw TypeError(B+" is not an object!");return B},_fails=function(B){try{return!!B()}catch{return!0}},_descriptors=!_fails(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),document$2=_global.document,is=_isObject(document$2)&&_isObject(document$2.createElement),_domCreate=function(B){return is?document$2.createElement(B):{}},_ie8DomDefine=!_descriptors&&!_fails(function(){return Object.defineProperty(_domCreate("div"),"a",{get:function(){return 7}}).a!=7}),_toPrimitive=function(B,_){if(!_isObject(B))return B;var T,E;if(typeof(T=B.toString)=="function"&&!_isObject(E=T.call(B))||typeof(T=B.valueOf)=="function"&&!_isObject(E=T.call(B)))return E;throw TypeError("Can't convert object to primitive value")},dP$1=Object.defineProperty,f$7=_descriptors?Object.defineProperty:function(_,T,E){if(_anObject(_),T=_toPrimitive(T),_anObject(E),_ie8DomDefine)try{return dP$1(_,T,E)}catch{}if("get"in E||"set"in E)throw TypeError("Accessors not supported!");return"value"in E&&(_[T]=E.value),_},_objectDp={f:f$7},_propertyDesc=function(B,_){return{enumerable:!(B&1),configurable:!(B&2),writable:!(B&4),value:_}},_hide=_descriptors?function(B,_,T){return _objectDp.f(B,_,_propertyDesc(1,T))}:function(B,_,T){return B[_]=T,B},hasOwnProperty={}.hasOwnProperty,_has=function(B,_){return hasOwnProperty.call(B,_)},PROTOTYPE$2="prototype",$export=function(B,_,T){var E=B&$export.F,W=B&$export.G,X=B&$export.S,q=B&$export.P,Y=B&$export.B,te=B&$export.W,ne=W?_core:_core[_]||(_core[_]={}),ae=ne[PROTOTYPE$2],le=W?_global:X?_global[_]:(_global[_]||{})[PROTOTYPE$2],ue,ge,ye;W&&(T=_);for(ue in T)ge=!E&&le&&le[ue]!==void 0,!(ge&&_has(ne,ue))&&(ye=ge?le[ue]:T[ue],ne[ue]=W&&typeof le[ue]!="function"?T[ue]:Y&&ge?_ctx(ye,_global):te&&le[ue]==ye?function(xe){var Te=function(Ae,Ie,Ve){if(this instanceof xe){switch(arguments.length){case 0:return new xe;case 1:return new xe(Ae);case 2:return new xe(Ae,Ie)}return new xe(Ae,Ie,Ve)}return xe.apply(this,arguments)};return Te[PROTOTYPE$2]=xe[PROTOTYPE$2],Te}(ye):q&&typeof ye=="function"?_ctx(Function.call,ye):ye,q&&((ne.virtual||(ne.virtual={}))[ue]=ye,B&$export.R&&ae&&!ae[ue]&&_hide(ae,ue,ye)))};$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,_redefine=_hide,_iterators={},toString$1={}.toString,_cof=function(B){return toString$1.call(B).slice(8,-1)},_iobject=Object("z").propertyIsEnumerable(0)?Object:function(B){return _cof(B)=="String"?B.split(""):Object(B)},_toIobject=function(B){return _iobject(_defined(B))},min$1=Math.min,_toLength=function(B){return B>0?min$1(_toInteger(B),9007199254740991):0},max=Math.max,min=Math.min,_toAbsoluteIndex=function(B,_){return B=_toInteger(B),B<0?max(B+_,0):min(B,_)},_arrayIncludes=function(B){return function(_,T,E){for(var W=_toIobject(_),X=_toLength(W.length),q=_toAbsoluteIndex(E,X);X>q;q++)if(q in W&&W[q]===T)return q||0;return-1}},_shared=createCommonjsModule(function(B){var _="__core-js_shared__",T=_global[_]||(_global[_]={});(B.exports=function(E,W){return T[E]||(T[E]=W!==void 0?W:{})})("versions",[]).push({version:_core.version,mode:"pure",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})}),id=0,px=Math.random(),_uid=function(B){return"Symbol(".concat(B===void 0?"":B,")_",(++id+px).toString(36))},shared=_shared("keys"),_sharedKey=function(B){return shared[B]||(shared[B]=_uid(B))},arrayIndexOf=_arrayIncludes(),IE_PROTO$2=_sharedKey("IE_PROTO"),_objectKeysInternal=function(B,_){var T=_toIobject(B),E=0,W=[],X;for(X in T)X!=IE_PROTO$2&&_has(T,X)&&W.push(X);for(;_.length>E;)_has(T,X=_[E++])&&(~arrayIndexOf(W,X)||W.push(X));return W},_enumBugKeys="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),_objectKeys=Object.keys||function(_){return _objectKeysInternal(_,_enumBugKeys)},_objectDps=_descriptors?Object.defineProperties:function(_,T){_anObject(_);for(var E=_objectKeys(T),W=E.length,X=0,q;W>X;)_objectDp.f(_,q=E[X++],T[q]);return _},document$1=_global.document,_html=document$1&&document$1.documentElement,IE_PROTO$1=_sharedKey("IE_PROTO"),Empty=function(){},PROTOTYPE$1="prototype",createDict=function(){var B=_domCreate("iframe"),_=_enumBugKeys.length,T="<",E=">",W;for(B.style.display="none",_html.appendChild(B),B.src="javascript:",W=B.contentWindow.document,W.open(),W.write(T+"script"+E+"document.F=Object"+T+"/script"+E),W.close(),createDict=W.F;_--;)delete createDict[PROTOTYPE$1][_enumBugKeys[_]];return createDict()},_objectCreate=Object.create||function(_,T){var E;return _!==null?(Empty[PROTOTYPE$1]=_anObject(_),E=new Empty,Empty[PROTOTYPE$1]=null,E[IE_PROTO$1]=_):E=createDict(),T===void 0?E:_objectDps(E,T)},_wks=createCommonjsModule(function(B){var _=_shared("wks"),T=_global.Symbol,E=typeof T=="function",W=B.exports=function(X){return _[X]||(_[X]=E&&T[X]||(E?T:_uid)("Symbol."+X))};W.store=_}),def=_objectDp.f,TAG$1=_wks("toStringTag"),_setToStringTag=function(B,_,T){B&&!_has(B=T?B:B.prototype,TAG$1)&&def(B,TAG$1,{configurable:!0,value:_})},IteratorPrototype={};_hide(IteratorPrototype,_wks("iterator"),function(){return this});var _iterCreate=function(B,_,T){B.prototype=_objectCreate(IteratorPrototype,{next:_propertyDesc(1,T)}),_setToStringTag(B,_+" Iterator")},_toObject=function(B){return Object(_defined(B))},IE_PROTO=_sharedKey("IE_PROTO"),ObjectProto$1=Object.prototype,_objectGpo=Object.getPrototypeOf||function(B){return B=_toObject(B),_has(B,IE_PROTO)?B[IE_PROTO]:typeof B.constructor=="function"&&B instanceof B.constructor?B.constructor.prototype:B instanceof Object?ObjectProto$1:null},ITERATOR$4=_wks("iterator"),BUGGY=!([].keys&&"next"in[].keys()),FF_ITERATOR="@@iterator",KEYS="keys",VALUES="values",returnThis=function(){return this},_iterDefine=function(B,_,T,E,W,X,q){_iterCreate(T,_,E);var Y=function(Ie){if(!BUGGY&&Ie in le)return le[Ie];switch(Ie){case KEYS:return function(){return new T(this,Ie)};case VALUES:return function(){return new T(this,Ie)}}return function(){return new T(this,Ie)}},te=_+" Iterator",ne=W==VALUES,ae=!1,le=B.prototype,ue=le[ITERATOR$4]||le[FF_ITERATOR]||W&&le[W],ge=ue||Y(W),ye=W?ne?Y("entries"):ge:void 0,xe=_=="Array"&&le.entries||ue,Te,Ae;return xe&&(Ae=_objectGpo(xe.call(new B)),Ae!==Object.prototype&&Ae.next&&_setToStringTag(Ae,te,!0)),ne&&ue&&ue.name!==VALUES&&(ae=!0,ge=function(){return ue.call(this)}),_iterators[_]=ge,_iterators[te]=returnThis,W&&(Te={values:ne?ge:Y(VALUES),keys:Y(KEYS),entries:ye},_export(_export.P+_export.F*(BUGGY||ae),_,Te)),Te},$at=_stringAt();_iterDefine(String,"String",function(B){this._t=String(B),this._i=0},function(){var B=this._t,_=this._i,T;return _>=B.length?{value:void 0,done:!0}:(T=$at(B,_),this._i+=T.length,{value:T,done:!1})});var _iterStep=function(B,_){return{value:_,done:!!B}};_iterDefine(Array,"Array",function(B,_){this._t=_toIobject(B),this._i=0,this._k=_},function(){var B=this._t,_=this._k,T=this._i++;return!B||T>=B.length?(this._t=void 0,_iterStep(1)):_=="keys"?_iterStep(0,T):_=="values"?_iterStep(0,B[T]):_iterStep(0,[T,B[T]])},"values"),_iterators.Arguments=_iterators.Array;for(var TO_STRING_TAG=_wks("toStringTag"),DOMIterables="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),i=0;i<DOMIterables.length;i++){var NAME=DOMIterables[i],Collection=_global[NAME],proto=Collection&&Collection.prototype;proto&&!proto[TO_STRING_TAG]&&_hide(proto,TO_STRING_TAG,NAME),_iterators[NAME]=_iterators.Array}var TAG=_wks("toStringTag"),ARG=_cof(function(){return arguments}())=="Arguments",tryGet=function(B,_){try{return B[_]}catch{}},_classof=function(B){var _,T,E;return B===void 0?"Undefined":B===null?"Null":typeof(T=tryGet(_=Object(B),TAG))=="string"?T:ARG?_cof(_):(E=_cof(_))=="Object"&&typeof _.callee=="function"?"Arguments":E},_anInstance=function(B,_,T,E){if(!(B instanceof _)||E in B)throw TypeError(T+": incorrect invocation!");return B},_iterCall=function(B,_,T,E){try{return E?_(_anObject(T)[0],T[1]):_(T)}catch(X){var W=B.return;throw W!==void 0&&_anObject(W.call(B)),X}},ITERATOR$3=_wks("iterator"),ArrayProto=Array.prototype,_isArrayIter=function(B){return B!==void 0&&(_iterators.Array===B||ArrayProto[ITERATOR$3]===B)},ITERATOR$2=_wks("iterator"),core_getIteratorMethod=_core.getIteratorMethod=function(B){if(B!=null)return B[ITERATOR$2]||B["@@iterator"]||_iterators[_classof(B)]},_forOf=createCommonjsModule(function(B){var _={},T={},E=B.exports=function(W,X,q,Y,te){var ne=te?function(){return W}:core_getIteratorMethod(W),ae=_ctx(q,Y,X?2:1),le=0,ue,ge,ye,xe;if(typeof ne!="function")throw TypeError(W+" is not iterable!");if(_isArrayIter(ne)){for(ue=_toLength(W.length);ue>le;le++)if(xe=X?ae(_anObject(ge=W[le])[0],ge[1]):ae(W[le]),xe===_||xe===T)return xe}else for(ye=ne.call(W);!(ge=ye.next()).done;)if(xe=_iterCall(ye,ae,ge.value,X),xe===_||xe===T)return xe};E.BREAK=_,E.RETURN=T}),SPECIES$1=_wks("species"),_speciesConstructor=function(B,_){var T=_anObject(B).constructor,E;return T===void 0||(E=_anObject(T)[SPECIES$1])==null?_:_aFunction(E)},_invoke=function(B,_,T){var E=T===void 0;switch(_.length){case 0:return E?B():B.call(T);case 1:return E?B(_[0]):B.call(T,_[0]);case 2:return E?B(_[0],_[1]):B.call(T,_[0],_[1]);case 3:return E?B(_[0],_[1],_[2]):B.call(T,_[0],_[1],_[2]);case 4:return E?B(_[0],_[1],_[2],_[3]):B.call(T,_[0],_[1],_[2],_[3])}return B.apply(T,_)},process$3=_global.process,setTask=_global.setImmediate,clearTask=_global.clearImmediate,MessageChannel=_global.MessageChannel,Dispatch=_global.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run=function(){var B=+this;if(queue.hasOwnProperty(B)){var _=queue[B];delete queue[B],_()}},listener=function(B){run.call(B.data)};(!setTask||!clearTask)&&(setTask=function(_){for(var T=[],E=1;arguments.length>E;)T.push(arguments[E++]);return queue[++counter]=function(){_invoke(typeof _=="function"?_:Function(_),T)},defer(counter),counter},clearTask=function(_){delete queue[_]},_cof(process$3)=="process"?defer=function(B){process$3.nextTick(_ctx(run,B,1))}:Dispatch&&Dispatch.now?defer=function(B){Dispatch.now(_ctx(run,B,1))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=_ctx(port.postMessage,port,1)):_global.addEventListener&&typeof postMessage=="function"&&!_global.importScripts?(defer=function(B){_global.postMessage(B+"","*")},_global.addEventListener("message",listener,!1)):ONREADYSTATECHANGE in _domCreate("script")?defer=function(B){_html.appendChild(_domCreate("script"))[ONREADYSTATECHANGE]=function(){_html.removeChild(this),run.call(B)}}:defer=function(B){setTimeout(_ctx(run,B,1),0)});var _task={set:setTask,clear:clearTask},macrotask=_task.set,Observer=_global.MutationObserver||_global.WebKitMutationObserver,process$2=_global.process,Promise$1=_global.Promise,isNode$1=_cof(process$2)=="process",_microtask=function(){var B,_,T,E=function(){var Y,te;for(isNode$1&&(Y=process$2.domain)&&Y.exit();B;){te=B.fn,B=B.next;try{te()}catch(ne){throw B?T():_=void 0,ne}}_=void 0,Y&&Y.enter()};if(isNode$1)T=function(){process$2.nextTick(E)};else if(Observer&&!(_global.navigator&&_global.navigator.standalone)){var W=!0,X=document.createTextNode("");new Observer(E).observe(X,{characterData:!0}),T=function(){X.data=W=!W}}else if(Promise$1&&Promise$1.resolve){var q=Promise$1.resolve(void 0);T=function(){q.then(E)}}else T=function(){macrotask.call(_global,E)};return function(Y){var te={fn:Y,next:void 0};_&&(_.next=te),B||(B=te,T()),_=te}};function PromiseCapability(B){var _,T;this.promise=new B(function(E,W){if(_!==void 0||T!==void 0)throw TypeError("Bad Promise constructor");_=E,T=W}),this.resolve=_aFunction(_),this.reject=_aFunction(T)}var f$6=function(B){return new PromiseCapability(B)},_newPromiseCapability={f:f$6},_perform=function(B){try{return{e:!1,v:B()}}catch(_){return{e:!0,v:_}}},navigator$1=_global.navigator,_userAgent=navigator$1&&navigator$1.userAgent||"",_promiseResolve=function(B,_){if(_anObject(B),_isObject(_)&&_.constructor===B)return _;var T=_newPromiseCapability.f(B),E=T.resolve;return E(_),T.promise},_redefineAll=function(B,_,T){for(var E in _)_hide(B,E,_[E]);return B},SPECIES=_wks("species"),_setSpecies=function(B){var _=typeof _core[B]=="function"?_core[B]:_global[B];_descriptors&&_&&!_[SPECIES]&&_objectDp.f(_,SPECIES,{configurable:!0,get:function(){return this}})},ITERATOR$1=_wks("iterator"),SAFE_CLOSING=!1;try{var riter=[7][ITERATOR$1]();riter.return=function(){SAFE_CLOSING=!0},Array.from(riter,function(){throw 2})}catch(B){}var _iterDetect=function(B,_){if(!SAFE_CLOSING)return!1;var T=!1;try{var E=[7],W=E[ITERATOR$1]();W.next=function(){return{done:T=!0}},E[ITERATOR$1]=function(){return W},B(E)}catch{}return T},task=_task.set,microtask=_microtask(),PROMISE="Promise",TypeError$1=_global.TypeError,process$1=_global.process,versions=process$1&&process$1.versions,v8=versions&&versions.v8||"",$Promise=_global[PROMISE],isNode=_classof(process$1)=="process",empty=function(){},Internal,newGenericPromiseCapability,OwnPromiseCapability,Wrapper,newPromiseCapability=newGenericPromiseCapability=_newPromiseCapability.f,USE_NATIVE$1=!!function(){try{var B=$Promise.resolve(1),_=(B.constructor={})[_wks("species")]=function(T){T(empty,empty)};return(isNode||typeof PromiseRejectionEvent=="function")&&B.then(empty)instanceof _&&v8.indexOf("6.6")!==0&&_userAgent.indexOf("Chrome/66")===-1}catch{}}(),isThenable=function(B){var _;return _isObject(B)&&typeof(_=B.then)=="function"?_:!1},notify=function(B,_){if(!B._n){B._n=!0;var T=B._c;microtask(function(){for(var E=B._v,W=B._s==1,X=0,q=function(Y){var te=W?Y.ok:Y.fail,ne=Y.resolve,ae=Y.reject,le=Y.domain,ue,ge,ye;try{te?(W||(B._h==2&&onHandleUnhandled(B),B._h=1),te===!0?ue=E:(le&&le.enter(),ue=te(E),le&&(le.exit(),ye=!0)),ue===Y.promise?ae(TypeError$1("Promise-chain cycle")):(ge=isThenable(ue))?ge.call(ue,ne,ae):ne(ue)):ae(E)}catch(xe){le&&!ye&&le.exit(),ae(xe)}};T.length>X;)q(T[X++]);B._c=[],B._n=!1,_&&!B._h&&onUnhandled(B)})}},onUnhandled=function(B){task.call(_global,function(){var _=B._v,T=isUnhandled(B),E,W,X;if(T&&(E=_perform(function(){isNode?process$1.emit("unhandledRejection",_,B):(W=_global.onunhandledrejection)?W({promise:B,reason:_}):(X=_global.console)&&X.error&&X.error("Unhandled promise rejection",_)}),B._h=isNode||isUnhandled(B)?2:1),B._a=void 0,T&&E.e)throw E.v})},isUnhandled=function(B){return B._h!==1&&(B._a||B._c).length===0},onHandleUnhandled=function(B){task.call(_global,function(){var _;isNode?process$1.emit("rejectionHandled",B):(_=_global.onrejectionhandled)&&_({promise:B,reason:B._v})})},$reject=function(B){var _=this;_._d||(_._d=!0,_=_._w||_,_._v=B,_._s=2,_._a||(_._a=_._c.slice()),notify(_,!0))},$resolve=function(B){var _=this,T;if(!_._d){_._d=!0,_=_._w||_;try{if(_===B)throw TypeError$1("Promise can't be resolved itself");(T=isThenable(B))?microtask(function(){var E={_w:_,_d:!1};try{T.call(B,_ctx($resolve,E,1),_ctx($reject,E,1))}catch(W){$reject.call(E,W)}}):(_._v=B,_._s=1,notify(_,!1))}catch(E){$reject.call({_w:_,_d:!1},E)}}};USE_NATIVE$1||($Promise=function(_){_anInstance(this,$Promise,PROMISE,"_h"),_aFunction(_),Internal.call(this);try{_(_ctx($resolve,this,1),_ctx($reject,this,1))}catch(T){$reject.call(this,T)}},Internal=function(_){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},Internal.prototype=_redefineAll($Promise.prototype,{then:function(_,T){var E=newPromiseCapability(_speciesConstructor(this,$Promise));return E.ok=typeof _=="function"?_:!0,E.fail=typeof T=="function"&&T,E.domain=isNode?process$1.domain:void 0,this._c.push(E),this._a&&this._a.push(E),this._s&&notify(this,!1),E.promise},catch:function(B){return this.then(void 0,B)}}),OwnPromiseCapability=function(){var B=new Internal;this.promise=B,this.resolve=_ctx($resolve,B,1),this.reject=_ctx($reject,B,1)},_newPromiseCapability.f=newPromiseCapability=function(B){return B===$Promise||B===Wrapper?new OwnPromiseCapability(B):newGenericPromiseCapability(B)}),_export(_export.G+_export.W+_export.F*!USE_NATIVE$1,{Promise:$Promise}),_setToStringTag($Promise,PROMISE),_setSpecies(PROMISE),Wrapper=_core[PROMISE],_export(_export.S+_export.F*!USE_NATIVE$1,PROMISE,{reject:function(_){var T=newPromiseCapability(this),E=T.reject;return E(_),T.promise}}),_export(_export.S+_export.F*_library,PROMISE,{resolve:function(_){return _promiseResolve(this===Wrapper?$Promise:this,_)}}),_export(_export.S+_export.F*!(USE_NATIVE$1&&_iterDetect(function(B){$Promise.all(B).catch(empty)})),PROMISE,{all:function(_){var T=this,E=newPromiseCapability(T),W=E.resolve,X=E.reject,q=_perform(function(){var Y=[],te=0,ne=1;_forOf(_,!1,function(ae){var le=te++,ue=!1;Y.push(void 0),ne++,T.resolve(ae).then(function(ge){ue||(ue=!0,Y[le]=ge,--ne||W(Y))},X)}),--ne||W(Y)});return q.e&&X(q.v),E.promise},race:function(_){var T=this,E=newPromiseCapability(T),W=E.reject,X=_perform(function(){_forOf(_,!1,function(q){T.resolve(q).then(E.resolve,W)})});return X.e&&W(X.v),E.promise}}),_export(_export.P+_export.R,"Promise",{finally:function(B){var _=_speciesConstructor(this,_core.Promise||_global.Promise),T=typeof B=="function";return this.then(T?function(E){return _promiseResolve(_,B()).then(function(){return E})}:B,T?function(E){return _promiseResolve(_,B()).then(function(){throw E})}:B)}}),_export(_export.S,"Promise",{try:function(B){var _=_newPromiseCapability.f(this),T=_perform(B);return(T.e?_.reject:_.resolve)(T.v),_.promise}});var promise$1=_core.Promise,promise=createCommonjsModule(function(B){B.exports={default:promise$1,__esModule:!0}}),_Promise=unwrapExports(promise),asyncToGenerator=createCommonjsModule(function(B,_){_.__esModule=!0;var T=E(promise);function E(W){return W&&W.__esModule?W:{default:W}}_.default=function(W){return function(){var X=W.apply(this,arguments);return new T.default(function(q,Y){function te(ne,ae){try{var le=X[ne](ae),ue=le.value}catch(ge){Y(ge);return}if(le.done)q(ue);else return T.default.resolve(ue).then(function(ge){te("next",ge)},function(ge){te("throw",ge)})}return te("next")})}}}),_asyncToGenerator=unwrapExports(asyncToGenerator),_objectSap=function(B,_){var T=(_core.Object||{})[B]||Object[B],E={};E[B]=_(T),_export(_export.S+_export.F*_fails(function(){T(1)}),"Object",E)};_objectSap("getPrototypeOf",function(){return function(_){return _objectGpo(_toObject(_))}});var getPrototypeOf$1=_core.Object.getPrototypeOf,getPrototypeOf=createCommonjsModule(function(B){B.exports={default:getPrototypeOf$1,__esModule:!0}}),_Object$getPrototypeOf=unwrapExports(getPrototypeOf),classCallCheck=createCommonjsModule(function(B,_){_.__esModule=!0,_.default=function(T,E){if(!(T instanceof E))throw new TypeError("Cannot call a class as a function")}}),_classCallCheck=unwrapExports(classCallCheck);_export(_export.S+_export.F*!_descriptors,"Object",{defineProperty:_objectDp.f});var $Object$2=_core.Object,defineProperty$3=function(_,T,E){return $Object$2.defineProperty(_,T,E)},defineProperty$2=createCommonjsModule(function(B){B.exports={default:defineProperty$3,__esModule:!0}});unwrapExports(defineProperty$2);var createClass=createCommonjsModule(function(B,_){_.__esModule=!0;var T=E(defineProperty$2);function E(W){return W&&W.__esModule?W:{default:W}}_.default=function(){function W(X,q){for(var Y=0;Y<q.length;Y++){var te=q[Y];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),(0,T.default)(X,te.key,te)}}return function(X,q,Y){return q&&W(X.prototype,q),Y&&W(X,Y),X}}()}),_createClass=unwrapExports(createClass),f$5=_wks,_wksExt={f:f$5},iterator$1=_wksExt.f("iterator"),iterator=createCommonjsModule(function(B){B.exports={default:iterator$1,__esModule:!0}});unwrapExports(iterator);var _meta=createCommonjsModule(function(B){var _=_uid("meta"),T=_objectDp.f,E=0,W=Object.isExtensible||function(){return!0},X=!_fails(function(){return W(Object.preventExtensions({}))}),q=function(le){T(le,_,{value:{i:"O"+ ++E,w:{}}})},Y=function(le,ue){if(!_isObject(le))return typeof le=="symbol"?le:(typeof le=="string"?"S":"P")+le;if(!_has(le,_)){if(!W(le))return"F";if(!ue)return"E";q(le)}return le[_].i},te=function(le,ue){if(!_has(le,_)){if(!W(le))return!0;if(!ue)return!1;q(le)}return le[_].w},ne=function(le){return X&&ae.NEED&&W(le)&&!_has(le,_)&&q(le),le},ae=B.exports={KEY:_,NEED:!1,fastKey:Y,getWeak:te,onFreeze:ne}});_meta.KEY,_meta.NEED,_meta.fastKey,_meta.getWeak,_meta.onFreeze;var defineProperty$1=_objectDp.f,_wksDefine=function(B){var _=_core.Symbol||(_core.Symbol={});B.charAt(0)!="_"&&!(B in _)&&defineProperty$1(_,B,{value:_wksExt.f(B)})},f$4=Object.getOwnPropertySymbols,_objectGops={f:f$4},f$3={}.propertyIsEnumerable,_objectPie={f:f$3},_enumKeys=function(B){var _=_objectKeys(B),T=_objectGops.f;if(T)for(var E=T(B),W=_objectPie.f,X=0,q;E.length>X;)W.call(B,q=E[X++])&&_.push(q);return _},_isArray=Array.isArray||function(_){return _cof(_)=="Array"},hiddenKeys=_enumBugKeys.concat("length","prototype"),f$2=Object.getOwnPropertyNames||function(_){return _objectKeysInternal(_,hiddenKeys)},_objectGopn={f:f$2},gOPN$1=_objectGopn.f,toString={}.toString,windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(B){try{return gOPN$1(B)}catch{return windowNames.slice()}},f$1=function(_){return windowNames&&toString.call(_)=="[object Window]"?getWindowNames(_):gOPN$1(_toIobject(_))},_objectGopnExt={f:f$1},gOPD$1=Object.getOwnPropertyDescriptor,f=_descriptors?gOPD$1:function(_,T){if(_=_toIobject(_),T=_toPrimitive(T),_ie8DomDefine)try{return gOPD$1(_,T)}catch{}if(_has(_,T))return _propertyDesc(!_objectPie.f.call(_,T),_[T])},_objectGopd={f},META=_meta.KEY,gOPD=_objectGopd.f,dP=_objectDp.f,gOPN=_objectGopnExt.f,$Symbol=_global.Symbol,$JSON$1=_global.JSON,_stringify=$JSON$1&&$JSON$1.stringify,PROTOTYPE="prototype",HIDDEN=_wks("_hidden"),TO_PRIMITIVE=_wks("toPrimitive"),isEnum$1={}.propertyIsEnumerable,SymbolRegistry=_shared("symbol-registry"),AllSymbols=_shared("symbols"),OPSymbols=_shared("op-symbols"),ObjectProto=Object[PROTOTYPE],USE_NATIVE=typeof $Symbol=="function"&&!!_objectGops.f,QObject=_global.QObject,setter=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild,setSymbolDesc=_descriptors&&_fails(function(){return _objectCreate(dP({},"a",{get:function(){return dP(this,"a",{value:7}).a}})).a!=7})?function(B,_,T){var E=gOPD(ObjectProto,_);E&&delete ObjectProto[_],dP(B,_,T),E&&B!==ObjectProto&&dP(ObjectProto,_,E)}:dP,wrap=function(B){var _=AllSymbols[B]=_objectCreate($Symbol[PROTOTYPE]);return _._k=B,_},isSymbol=USE_NATIVE&&typeof $Symbol.iterator=="symbol"?function(B){return typeof B=="symbol"}:function(B){return B instanceof $Symbol},$defineProperty=function(_,T,E){return _===ObjectProto&&$defineProperty(OPSymbols,T,E),_anObject(_),T=_toPrimitive(T),_anObject(E),_has(AllSymbols,T)?(E.enumerable?(_has(_,HIDDEN)&&_[HIDDEN][T]&&(_[HIDDEN][T]=!1),E=_objectCreate(E,{enumerable:_propertyDesc(0,!1)})):(_has(_,HIDDEN)||dP(_,HIDDEN,_propertyDesc(1,{})),_[HIDDEN][T]=!0),setSymbolDesc(_,T,E)):dP(_,T,E)},$defineProperties=function(_,T){_anObject(_);for(var E=_enumKeys(T=_toIobject(T)),W=0,X=E.length,q;X>W;)$defineProperty(_,q=E[W++],T[q]);return _},$create=function(_,T){return T===void 0?_objectCreate(_):$defineProperties(_objectCreate(_),T)},$propertyIsEnumerable=function(_){var T=isEnum$1.call(this,_=_toPrimitive(_));return this===ObjectProto&&_has(AllSymbols,_)&&!_has(OPSymbols,_)?!1:T||!_has(this,_)||!_has(AllSymbols,_)||_has(this,HIDDEN)&&this[HIDDEN][_]?T:!0},$getOwnPropertyDescriptor$1=function(_,T){if(_=_toIobject(_),T=_toPrimitive(T),!(_===ObjectProto&&_has(AllSymbols,T)&&!_has(OPSymbols,T))){var E=gOPD(_,T);return E&&_has(AllSymbols,T)&&!(_has(_,HIDDEN)&&_[HIDDEN][T])&&(E.enumerable=!0),E}},$getOwnPropertyNames=function(_){for(var T=gOPN(_toIobject(_)),E=[],W=0,X;T.length>W;)!_has(AllSymbols,X=T[W++])&&X!=HIDDEN&&X!=META&&E.push(X);return E},$getOwnPropertySymbols=function(_){for(var T=_===ObjectProto,E=gOPN(T?OPSymbols:_toIobject(_)),W=[],X=0,q;E.length>X;)_has(AllSymbols,q=E[X++])&&(!T||_has(ObjectProto,q))&&W.push(AllSymbols[q]);return W};USE_NATIVE||($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var _=_uid(arguments.length>0?arguments[0]:void 0),T=function(E){this===ObjectProto&&T.call(OPSymbols,E),_has(this,HIDDEN)&&_has(this[HIDDEN],_)&&(this[HIDDEN][_]=!1),setSymbolDesc(this,_,_propertyDesc(1,E))};return _descriptors&&setter&&setSymbolDesc(ObjectProto,_,{configurable:!0,set:T}),wrap(_)},_redefine($Symbol[PROTOTYPE],"toString",function(){return this._k}),_objectGopd.f=$getOwnPropertyDescriptor$1,_objectDp.f=$defineProperty,_objectGopn.f=_objectGopnExt.f=$getOwnPropertyNames,_objectPie.f=$propertyIsEnumerable,_objectGops.f=$getOwnPropertySymbols,_descriptors&&!_library&&_redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable),_wksExt.f=function(B){return wrap(_wks(B))}),_export(_export.G+_export.W+_export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)_wks(es6Symbols[j++]);for(var wellKnownSymbols=_objectKeys(_wks.store),k=0;wellKnownSymbols.length>k;)_wksDefine(wellKnownSymbols[k++]);_export(_export.S+_export.F*!USE_NATIVE,"Symbol",{for:function(B){return _has(SymbolRegistry,B+="")?SymbolRegistry[B]:SymbolRegistry[B]=$Symbol(B)},keyFor:function(_){if(!isSymbol(_))throw TypeError(_+" is not a symbol!");for(var T in SymbolRegistry)if(SymbolRegistry[T]===_)return T},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),_export(_export.S+_export.F*!USE_NATIVE,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor$1,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});var FAILS_ON_PRIMITIVES=_fails(function(){_objectGops.f(1)});_export(_export.S+_export.F*FAILS_ON_PRIMITIVES,"Object",{getOwnPropertySymbols:function(_){return _objectGops.f(_toObject(_))}}),$JSON$1&&_export(_export.S+_export.F*(!USE_NATIVE||_fails(function(){var B=$Symbol();return _stringify([B])!="[null]"||_stringify({a:B})!="{}"||_stringify(Object(B))!="{}"})),"JSON",{stringify:function(_){for(var T=[_],E=1,W,X;arguments.length>E;)T.push(arguments[E++]);if(X=W=T[1],!(!_isObject(W)&&_===void 0||isSymbol(_)))return _isArray(W)||(W=function(q,Y){if(typeof X=="function"&&(Y=X.call(this,q,Y)),!isSymbol(Y))return Y}),T[1]=W,_stringify.apply($JSON$1,T)}}),$Symbol[PROTOTYPE][TO_PRIMITIVE]||_hide($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf),_setToStringTag($Symbol,"Symbol"),_setToStringTag(Math,"Math",!0),_setToStringTag(_global.JSON,"JSON",!0),_wksDefine("asyncIterator"),_wksDefine("observable");var symbol$1=_core.Symbol,symbol=createCommonjsModule(function(B){B.exports={default:symbol$1,__esModule:!0}});unwrapExports(symbol);var _typeof_1=createCommonjsModule(function(B,_){_.__esModule=!0;var T=X(iterator),E=X(symbol),W=typeof E.default=="function"&&typeof T.default=="symbol"?function(q){return typeof q}:function(q){return q&&typeof E.default=="function"&&q.constructor===E.default&&q!==E.default.prototype?"symbol":typeof q};function X(q){return q&&q.__esModule?q:{default:q}}_.default=typeof E.default=="function"&&W(T.default)==="symbol"?function(q){return typeof q>"u"?"undefined":W(q)}:function(q){return q&&typeof E.default=="function"&&q.constructor===E.default&&q!==E.default.prototype?"symbol":typeof q>"u"?"undefined":W(q)}}),_typeof=unwrapExports(_typeof_1),possibleConstructorReturn=createCommonjsModule(function(B,_){_.__esModule=!0;var T=E(_typeof_1);function E(W){return W&&W.__esModule?W:{default:W}}_.default=function(W,X){if(!W)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return X&&((typeof X>"u"?"undefined":(0,T.default)(X))==="object"||typeof X=="function")?X:W}}),_possibleConstructorReturn=unwrapExports(possibleConstructorReturn),check=function(B,_){if(_anObject(B),!_isObject(_)&&_!==null)throw TypeError(_+": can't set as prototype!")},_setProto={set:Object.setPrototypeOf||("__proto__"in{}?function(B,_,T){try{T=_ctx(Function.call,_objectGopd.f(Object.prototype,"__proto__").set,2),T(B,[]),_=!(B instanceof Array)}catch{_=!0}return function(W,X){return check(W,X),_?W.__proto__=X:T(W,X),W}}({},!1):void 0),check};_export(_export.S,"Object",{setPrototypeOf:_setProto.set});var setPrototypeOf$1=_core.Object.setPrototypeOf,setPrototypeOf=createCommonjsModule(function(B){B.exports={default:setPrototypeOf$1,__esModule:!0}}),_Object$setPrototypeOf=unwrapExports(setPrototypeOf);_export(_export.S,"Object",{create:_objectCreate});var $Object$1=_core.Object,create$1=function(_,T){return $Object$1.create(_,T)},create=createCommonjsModule(function(B){B.exports={default:create$1,__esModule:!0}}),_Object$create=unwrapExports(create),inherits$1=createCommonjsModule(function(B,_){_.__esModule=!0;var T=X(setPrototypeOf),E=X(create),W=X(_typeof_1);function X(q){return q&&q.__esModule?q:{default:q}}_.default=function(q,Y){if(typeof Y!="function"&&Y!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof Y>"u"?"undefined":(0,W.default)(Y)));q.prototype=(0,E.default)(Y&&Y.prototype,{constructor:{value:q,enumerable:!1,writable:!0,configurable:!0}}),Y&&(T.default?(0,T.default)(q,Y):q.__proto__=Y)}}),_inherits=unwrapExports(inherits$1),eventemitter3=createCommonjsModule(function(B){var _=Object.prototype.hasOwnProperty,T="~";function E(){}Object.create&&(E.prototype=Object.create(null),new E().__proto__||(T=!1));function W(te,ne,ae){this.fn=te,this.context=ne,this.once=ae||!1}function X(te,ne,ae,le,ue){if(typeof ae!="function")throw new TypeError("The listener must be a function");var ge=new W(ae,le||te,ue),ye=T?T+ne:ne;return te._events[ye]?te._events[ye].fn?te._events[ye]=[te._events[ye],ge]:te._events[ye].push(ge):(te._events[ye]=ge,te._eventsCount++),te}function q(te,ne){--te._eventsCount===0?te._events=new E:delete te._events[ne]}function Y(){this._events=new E,this._eventsCount=0}Y.prototype.eventNames=function(){var ne=[],ae,le;if(this._eventsCount===0)return ne;for(le in ae=this._events)_.call(ae,le)&&ne.push(T?le.slice(1):le);return Object.getOwnPropertySymbols?ne.concat(Object.getOwnPropertySymbols(ae)):ne},Y.prototype.listeners=function(ne){var ae=T?T+ne:ne,le=this._events[ae];if(!le)return[];if(le.fn)return[le.fn];for(var ue=0,ge=le.length,ye=new Array(ge);ue<ge;ue++)ye[ue]=le[ue].fn;return ye},Y.prototype.listenerCount=function(ne){var ae=T?T+ne:ne,le=this._events[ae];return le?le.fn?1:le.length:0},Y.prototype.emit=function(ne,ae,le,ue,ge,ye){var xe=T?T+ne:ne;if(!this._events[xe])return!1;var Te=this._events[xe],Ae=arguments.length,Ie,Ve;if(Te.fn){switch(Te.once&&this.removeListener(ne,Te.fn,void 0,!0),Ae){case 1:return Te.fn.call(Te.context),!0;case 2:return Te.fn.call(Te.context,ae),!0;case 3:return Te.fn.call(Te.context,ae,le),!0;case 4:return Te.fn.call(Te.context,ae,le,ue),!0;case 5:return Te.fn.call(Te.context,ae,le,ue,ge),!0;case 6:return Te.fn.call(Te.context,ae,le,ue,ge,ye),!0}for(Ve=1,Ie=new Array(Ae-1);Ve<Ae;Ve++)Ie[Ve-1]=arguments[Ve];Te.fn.apply(Te.context,Ie)}else{var $e=Te.length,We;for(Ve=0;Ve<$e;Ve++)switch(Te[Ve].once&&this.removeListener(ne,Te[Ve].fn,void 0,!0),Ae){case 1:Te[Ve].fn.call(Te[Ve].context);break;case 2:Te[Ve].fn.call(Te[Ve].context,ae);break;case 3:Te[Ve].fn.call(Te[Ve].context,ae,le);break;case 4:Te[Ve].fn.call(Te[Ve].context,ae,le,ue);break;default:if(!Ie)for(We=1,Ie=new Array(Ae-1);We<Ae;We++)Ie[We-1]=arguments[We];Te[Ve].fn.apply(Te[Ve].context,Ie)}}return!0},Y.prototype.on=function(ne,ae,le){return X(this,ne,ae,le,!1)},Y.prototype.once=function(ne,ae,le){return X(this,ne,ae,le,!0)},Y.prototype.removeListener=function(ne,ae,le,ue){var ge=T?T+ne:ne;if(!this._events[ge])return this;if(!ae)return q(this,ge),this;var ye=this._events[ge];if(ye.fn)ye.fn===ae&&(!ue||ye.once)&&(!le||ye.context===le)&&q(this,ge);else{for(var xe=0,Te=[],Ae=ye.length;xe<Ae;xe++)(ye[xe].fn!==ae||ue&&!ye[xe].once||le&&ye[xe].context!==le)&&Te.push(ye[xe]);Te.length?this._events[ge]=Te.length===1?Te[0]:Te:q(this,ge)}return this},Y.prototype.removeAllListeners=function(ne){var ae;return ne?(ae=T?T+ne:ne,this._events[ae]&&q(this,ae)):(this._events=new E,this._eventsCount=0),this},Y.prototype.off=Y.prototype.removeListener,Y.prototype.addListener=Y.prototype.on,Y.prefixed=T,Y.EventEmitter=Y,B.exports=Y}),ReceiverGroup={Others:0,All:1,MasterClient:2},$JSON=_core.JSON||(_core.JSON={stringify:JSON.stringify}),stringify$1=function(_){return $JSON.stringify.apply($JSON,arguments)},stringify=createCommonjsModule(function(B){B.exports={default:stringify$1,__esModule:!0}}),_JSON$stringify=unwrapExports(stringify),componentEmitter=createCommonjsModule(function(B){B.exports=_;function _(E){if(E)return T(E)}function T(E){for(var W in _.prototype)E[W]=_.prototype[W];return E}_.prototype.on=_.prototype.addEventListener=function(E,W){return this._callbacks=this._callbacks||{},(this._callbacks["$"+E]=this._callbacks["$"+E]||[]).push(W),this},_.prototype.once=function(E,W){function X(){this.off(E,X),W.apply(this,arguments)}return X.fn=W,this.on(E,X),this},_.prototype.off=_.prototype.removeListener=_.prototype.removeAllListeners=_.prototype.removeEventListener=function(E,W){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var X=this._callbacks["$"+E];if(!X)return this;if(arguments.length==1)return delete this._callbacks["$"+E],this;for(var q,Y=0;Y<X.length;Y++)if(q=X[Y],q===W||q.fn===W){X.splice(Y,1);break}return X.length===0&&delete this._callbacks["$"+E],this},_.prototype.emit=function(E){this._callbacks=this._callbacks||{};for(var W=new Array(arguments.length-1),X=this._callbacks["$"+E],q=1;q<arguments.length;q++)W[q-1]=arguments[q];if(X){X=X.slice(0);for(var q=0,Y=X.length;q<Y;++q)X[q].apply(this,W)}return this},_.prototype.listeners=function(E){return this._callbacks=this._callbacks||{},this._callbacks["$"+E]||[]},_.prototype.hasListeners=function(E){return!!this.listeners(E).length}});function isObject(B){return B!==null&&typeof B=="object"}var isObject_1=isObject,requestBase=RequestBase;function RequestBase(B){if(B)return mixin$1(B)}function mixin$1(B){for(var _ in RequestBase.prototype)B[_]=RequestBase.prototype[_];return B}RequestBase.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,this},RequestBase.prototype.parse=function(_){return this._parser=_,this},RequestBase.prototype.responseType=function(B){return this._responseType=B,this},RequestBase.prototype.serialize=function(_){return this._serializer=_,this},RequestBase.prototype.timeout=function(_){if(!_||typeof _!="object")return this._timeout=_,this._responseTimeout=0,this;for(var T in _)switch(T){case"deadline":this._timeout=_.deadline;break;case"response":this._responseTimeout=_.response;break;default:console.warn("Unknown timeout option",T)}return this},RequestBase.prototype.retry=function(_,T){return(arguments.length===0||_===!0)&&(_=1),_<=0&&(_=0),this._maxRetries=_,this._retries=0,this._retryCallback=T,this};var ERROR_CODES=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];RequestBase.prototype._shouldRetry=function(B,_){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{var T=this._retryCallback(B,_);if(T===!0)return!0;if(T===!1)return!1}catch(E){console.error(E)}return!!(_&&_.status&&_.status>=500&&_.status!=501||B&&(B.code&&~ERROR_CODES.indexOf(B.code)||B.timeout&&B.code=="ECONNABORTED"||B.crossDomain))},RequestBase.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this._end()},RequestBase.prototype.then=function(_,T){if(!this._fullfilledPromise){var E=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise(function(W,X){E.end(function(q,Y){q?X(q):W(Y)})})}return this._fullfilledPromise.then(_,T)},RequestBase.prototype.catch=function(B){return this.then(void 0,B)},RequestBase.prototype.use=function(_){return _(this),this},RequestBase.prototype.ok=function(B){if(typeof B!="function")throw Error("Callback required");return this._okCallback=B,this},RequestBase.prototype._isResponseOK=function(B){return B?this._okCallback?this._okCallback(B):B.status>=200&&B.status<300:!1},RequestBase.prototype.get=function(B){return this._header[B.toLowerCase()]},RequestBase.prototype.getHeader=RequestBase.prototype.get,RequestBase.prototype.set=function(B,_){if(isObject_1(B)){for(var T in B)this.set(T,B[T]);return this}return this._header[B.toLowerCase()]=_,this.header[B]=_,this},RequestBase.prototype.unset=function(B){return delete this._header[B.toLowerCase()],delete this.header[B],this},RequestBase.prototype.field=function(B,_){if(B==null)throw new Error(".field(name, val) name can not be empty");if(this._data&&console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()"),isObject_1(B)){for(var T in B)this.field(T,B[T]);return this}if(Array.isArray(_)){for(var E in _)this.field(B,_[E]);return this}if(_==null)throw new Error(".field(name, val) val can not be empty");return typeof _=="boolean"&&(_=""+_),this._getFormData().append(B,_),this},RequestBase.prototype.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},RequestBase.prototype._auth=function(B,_,T,E){switch(T.type){case"basic":this.set("Authorization","Basic "+E(B+":"+_));break;case"auto":this.username=B,this.password=_;break;case"bearer":this.set("Authorization","Bearer "+B);break}return this},RequestBase.prototype.withCredentials=function(B){return B==null&&(B=!0),this._withCredentials=B,this},RequestBase.prototype.redirects=function(B){return this._maxRedirects=B,this},RequestBase.prototype.maxResponseSize=function(B){if(typeof B!="number")throw TypeError("Invalid argument");return this._maxResponseSize=B,this},RequestBase.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},RequestBase.prototype.send=function(B){var _=isObject_1(B),T=this._header["content-type"];if(this._formData&&console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()"),_&&!this._data)Array.isArray(B)?this._data=[]:this._isHost(B)||(this._data={});else if(B&&this._data&&this._isHost(this._data))throw Error("Can't merge these send calls");if(_&&isObject_1(this._data))for(var E in B)this._data[E]=B[E];else typeof B=="string"?(T||this.type("form"),T=this._header["content-type"],T=="application/x-www-form-urlencoded"?this._data=this._data?this._data+"&"+B:B:this._data=(this._data||"")+B):this._data=B;return!_||this._isHost(B)?this:(T||this.type("json"),this)},RequestBase.prototype.sortQuery=function(B){return this._sort=typeof B>"u"?!0:B,this},RequestBase.prototype._finalizeQueryString=function(){var B=this._query.join("&");if(B&&(this.url+=(this.url.indexOf("?")>=0?"&":"?")+B),this._query.length=0,this._sort){var _=this.url.indexOf("?");if(_>=0){var T=this.url.substring(_+1).split("&");typeof this._sort=="function"?T.sort(this._sort):T.sort(),this.url=this.url.substring(0,_)+"?"+T.join("&")}}},RequestBase.prototype._appendQueryString=function(){console.trace("Unsupported")},RequestBase.prototype._timeoutError=function(B,_,T){if(!this._aborted){var E=new Error(B+_+"ms exceeded");E.timeout=_,E.code="ECONNABORTED",E.errno=T,this.timedout=!0,this.abort(),this.callback(E)}},RequestBase.prototype._setTimeouts=function(){var B=this;this._timeout&&!this._timer&&(this._timer=setTimeout(function(){B._timeoutError("Timeout of ",B._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(function(){B._timeoutError("Response timeout of ",B._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};var type=function(B){return B.split(/ *; */).shift()},params=function(B){return B.split(/ *; */).reduce(function(_,T){var E=T.split(/ *= */),W=E.shift(),X=E.shift();return W&&X&&(_[W]=X),_},{})},parseLinks=function(B){return B.split(/ *, */).reduce(function(_,T){var E=T.split(/ *; */),W=E[0].slice(1,-1),X=E[1].split(/ *= */)[1].slice(1,-1);return _[X]=W,_},{})},cleanHeader=function(B,_){return delete B["content-type"],delete B["content-length"],delete B["transfer-encoding"],delete B.host,_&&(delete B.authorization,delete B.cookie),B},utils={type,params,parseLinks,cleanHeader},responseBase=ResponseBase;function ResponseBase(B){if(B)return mixin(B)}function mixin(B){for(var _ in ResponseBase.prototype)B[_]=ResponseBase.prototype[_];return B}ResponseBase.prototype.get=function(B){return this.header[B.toLowerCase()]},ResponseBase.prototype._setHeaderProperties=function(B){var _=B["content-type"]||"";this.type=utils.type(_);var T=utils.params(_);for(var E in T)this[E]=T[E];this.links={};try{B.link&&(this.links=utils.parseLinks(B.link))}catch{}},ResponseBase.prototype._setStatusProperties=function(B){var _=B/100|0;this.status=this.statusCode=B,this.statusType=_,this.info=_==1,this.ok=_==2,this.redirect=_==3,this.clientError=_==4,this.serverError=_==5,this.error=_==4||_==5?this.toError():!1,this.created=B==201,this.accepted=B==202,this.noContent=B==204,this.badRequest=B==400,this.unauthorized=B==401,this.notAcceptable=B==406,this.forbidden=B==403,this.notFound=B==404,this.unprocessableEntity=B==422};function Agent(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(B){Agent.prototype[B]=function(){return this._defaults.push({fn:B,arguments}),this}}),Agent.prototype._setDefaults=function(B){this._defaults.forEach(function(_){B[_.fn].apply(B,_.arguments)})};var agentBase=Agent,client=createCommonjsModule(function(B,_){var T;typeof window<"u"?T=window:typeof self<"u"?T=self:(console.warn("Using browser-only version of superagent in non-browser environment"),T=commonjsGlobal$1);function E(){}var W=_=B.exports=function(ye,xe){return typeof xe=="function"?new _.Request("GET",ye).end(xe):arguments.length==1?new _.Request("GET",ye):new _.Request(ye,xe)};_.Request=ue,W.getXHR=function(){if(T.XMLHttpRequest&&(!T.location||T.location.protocol!="file:"||!T.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch{}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch{}throw Error("Browser-only version of superagent could not find XHR")};var X="".trim?function(ye){return ye.trim()}:function(ye){return ye.replace(/(^\s*|\s*$)/g,"")};function q(ye){if(!isObject_1(ye))return ye;var xe=[];for(var Te in ye)Y(xe,Te,ye[Te]);return xe.join("&")}function Y(ye,xe,Te){if(Te!=null)if(Array.isArray(Te))Te.forEach(function(Ie){Y(ye,xe,Ie)});else if(isObject_1(Te))for(var Ae in Te)Y(ye,xe+"["+Ae+"]",Te[Ae]);else ye.push(encodeURIComponent(xe)+"="+encodeURIComponent(Te));else Te===null&&ye.push(encodeURIComponent(xe))}W.serializeObject=q;function te(ye){for(var xe={},Te=ye.split("&"),Ae,Ie,Ve=0,$e=Te.length;Ve<$e;++Ve)Ae=Te[Ve],Ie=Ae.indexOf("="),Ie==-1?xe[decodeURIComponent(Ae)]="":xe[decodeURIComponent(Ae.slice(0,Ie))]=decodeURIComponent(Ae.slice(Ie+1));return xe}W.parseString=te,W.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},W.serialize={"application/x-www-form-urlencoded":q,"application/json":JSON.stringify},W.parse={"application/x-www-form-urlencoded":te,"application/json":JSON.parse};function ne(ye){for(var xe=ye.split(/\r?\n/),Te={},Ae,Ie,Ve,$e,We=0,Ue=xe.length;We<Ue;++We)Ie=xe[We],Ae=Ie.indexOf(":"),Ae!==-1&&(Ve=Ie.slice(0,Ae).toLowerCase(),$e=X(Ie.slice(Ae+1)),Te[Ve]=$e);return Te}function ae(ye){return/[\/+]json($|[^-\w])/.test(ye)}function le(ye){this.req=ye,this.xhr=this.req.xhr,this.text=this.req.method!="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType>"u"?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;var xe=this.xhr.status;xe===1223&&(xe=204),this._setStatusProperties(xe),this.header=this.headers=ne(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.text===null&&ye._responseType?this.body=this.xhr.response:this.body=this.req.method!="HEAD"?this._parseBody(this.text?this.text:this.xhr.response):null}responseBase(le.prototype),le.prototype._parseBody=function(ye){var xe=W.parse[this.type];return this.req._parser?this.req._parser(this,ye):(!xe&&ae(this.type)&&(xe=W.parse["application/json"]),xe&&ye&&(ye.length||ye instanceof Object)?xe(ye):null)},le.prototype.toError=function(){var ye=this.req,xe=ye.method,Te=ye.url,Ae="cannot "+xe+" "+Te+" ("+this.status+")",Ie=new Error(Ae);return Ie.status=this.status,Ie.method=xe,Ie.url=Te,Ie},W.Response=le;function ue(ye,xe){var Te=this;this._query=this._query||[],this.method=ye,this.url=xe,this.header={},this._header={},this.on("end",function(){var Ae=null,Ie=null;try{Ie=new le(Te)}catch($e){return Ae=new Error("Parser is unable to parse the response"),Ae.parse=!0,Ae.original=$e,Te.xhr?(Ae.rawResponse=typeof Te.xhr.responseType>"u"?Te.xhr.responseText:Te.xhr.response,Ae.status=Te.xhr.status?Te.xhr.status:null,Ae.statusCode=Ae.status):(Ae.rawResponse=null,Ae.status=null),Te.callback(Ae)}Te.emit("response",Ie);var Ve;try{Te._isResponseOK(Ie)||(Ve=new Error(Ie.statusText||"Unsuccessful HTTP response"))}catch($e){Ve=$e}Ve?(Ve.original=Ae,Ve.response=Ie,Ve.status=Ie.status,Te.callback(Ve,Ie)):Te.callback(null,Ie)})}componentEmitter(ue.prototype),requestBase(ue.prototype),ue.prototype.type=function(ye){return this.set("Content-Type",W.types[ye]||ye),this},ue.prototype.accept=function(ye){return this.set("Accept",W.types[ye]||ye),this},ue.prototype.auth=function(ye,xe,Te){arguments.length===1&&(xe=""),typeof xe=="object"&&xe!==null&&(Te=xe,xe=""),Te||(Te={type:typeof btoa=="function"?"basic":"auto"});var Ae=function(Ie){if(typeof btoa=="function")return btoa(Ie);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(ye,xe,Te,Ae)},ue.prototype.query=function(ye){return typeof ye!="string"&&(ye=q(ye)),ye&&this._query.push(ye),this},ue.prototype.attach=function(ye,xe,Te){if(xe){if(this._data)throw Error("superagent can't mix .send() and .attach()");this._getFormData().append(ye,xe,Te||xe.name)}return this},ue.prototype._getFormData=function(){return this._formData||(this._formData=new T.FormData),this._formData},ue.prototype.callback=function(ye,xe){if(this._shouldRetry(ye,xe))return this._retry();var Te=this._callback;this.clearTimeout(),ye&&(this._maxRetries&&(ye.retries=this._retries-1),this.emit("error",ye)),Te(ye,xe)},ue.prototype.crossDomainError=function(){var ye=new Error(`Request has been terminated
Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.`);ye.crossDomain=!0,ye.status=this.status,ye.method=this.method,ye.url=this.url,this.callback(ye)},ue.prototype.buffer=ue.prototype.ca=ue.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},ue.prototype.pipe=ue.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")},ue.prototype._isHost=function(xe){return xe&&typeof xe=="object"&&!Array.isArray(xe)&&Object.prototype.toString.call(xe)!=="[object Object]"},ue.prototype.end=function(ye){return this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=ye||E,this._finalizeQueryString(),this._end()},ue.prototype._end=function(){var ye=this,xe=this.xhr=W.getXHR(),Te=this._formData||this._data;this._setTimeouts(),xe.onreadystatechange=function(){var We=xe.readyState;if(We>=2&&ye._responseTimeoutTimer&&clearTimeout(ye._responseTimeoutTimer),We==4){var Ue;try{Ue=xe.status}catch{Ue=0}if(!Ue)return ye.timedout||ye._aborted?void 0:ye.crossDomainError();ye.emit("end")}};var Ae=function(We,Ue){Ue.total>0&&(Ue.percent=Ue.loaded/Ue.total*100),Ue.direction=We,ye.emit("progress",Ue)};if(this.hasListeners("progress"))try{xe.onprogress=Ae.bind(null,"download"),xe.upload&&(xe.upload.onprogress=Ae.bind(null,"upload"))}catch{}try{this.username&&this.password?xe.open(this.method,this.url,!0,this.username,this.password):xe.open(this.method,this.url,!0)}catch(We){return this.callback(We)}if(this._withCredentials&&(xe.withCredentials=!0),!this._formData&&this.method!="GET"&&this.method!="HEAD"&&typeof Te!="string"&&!this._isHost(Te)){var Ie=this._header["content-type"],Ve=this._serializer||W.serialize[Ie?Ie.split(";")[0]:""];!Ve&&ae(Ie)&&(Ve=W.serialize["application/json"]),Ve&&(Te=Ve(Te))}for(var $e in this.header)this.header[$e]!=null&&this.header.hasOwnProperty($e)&&xe.setRequestHeader($e,this.header[$e]);return this._responseType&&(xe.responseType=this._responseType),this.emit("request",this),xe.send(typeof Te<"u"?Te:null),this},W.agent=function(){return new agentBase},["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(ye){agentBase.prototype[ye.toLowerCase()]=function(xe,Te){var Ae=new W.Request(ye,xe);return this._setDefaults(Ae),Te&&Ae.end(Te),Ae}}),agentBase.prototype.del=agentBase.prototype.delete,W.get=function(ye,xe,Te){var Ae=W("GET",ye);return typeof xe=="function"&&(Te=xe,xe=null),xe&&Ae.query(xe),Te&&Ae.end(Te),Ae},W.head=function(ye,xe,Te){var Ae=W("HEAD",ye);return typeof xe=="function"&&(Te=xe,xe=null),xe&&Ae.query(xe),Te&&Ae.end(Te),Ae},W.options=function(ye,xe,Te){var Ae=W("OPTIONS",ye);return typeof xe=="function"&&(Te=xe,xe=null),xe&&Ae.send(xe),Te&&Ae.end(Te),Ae};function ge(ye,xe,Te){var Ae=W("DELETE",ye);return typeof xe=="function"&&(Te=xe,xe=null),xe&&Ae.send(xe),Te&&Ae.end(Te),Ae}W.del=ge,W.delete=ge,W.patch=function(ye,xe,Te){var Ae=W("PATCH",ye);return typeof xe=="function"&&(Te=xe,xe=null),xe&&Ae.send(xe),Te&&Ae.end(Te),Ae},W.post=function(ye,xe,Te){var Ae=W("POST",ye);return typeof xe=="function"&&(Te=xe,xe=null),xe&&Ae.send(xe),Te&&Ae.end(Te),Ae},W.put=function(ye,xe,Te){var Ae=W("PUT",ye);return typeof xe=="function"&&(Te=xe,xe=null),xe&&Ae.send(xe),Te&&Ae.end(Te),Ae}});client.Request;var $assign=Object.assign,_objectAssign=!$assign||_fails(function(){var B={},_={},T=Symbol(),E="abcdefghijklmnopqrst";return B[T]=7,E.split("").forEach(function(W){_[W]=W}),$assign({},B)[T]!=7||Object.keys($assign({},_)).join("")!=E})?function(_,T){for(var E=_toObject(_),W=arguments.length,X=1,q=_objectGops.f,Y=_objectPie.f;W>X;)for(var te=_iobject(arguments[X++]),ne=q?_objectKeys(te).concat(q(te)):_objectKeys(te),ae=ne.length,le=0,ue;ae>le;)ue=ne[le++],(!_descriptors||Y.call(te,ue))&&(E[ue]=te[ue]);return E}:$assign;_export(_export.S+_export.F,"Object",{assign:_objectAssign});var assign$1=_core.Object.assign,assign=createCommonjsModule(function(B){B.exports={default:assign$1,__esModule:!0}}),_Object$assign=unwrapExports(assign),defineProperty=createCommonjsModule(function(B,_){_.__esModule=!0;var T=E(defineProperty$2);function E(W){return W&&W.__esModule?W:{default:W}}_.default=function(W,X,q){return X in W?(0,T.default)(W,X,{value:q,enumerable:!0,configurable:!0,writable:!0}):W[X]=q,W}}),_defineProperty=unwrapExports(defineProperty),s=1e3,m=s*60,h=m*60,d$1=h*24,w=d$1*7,y=d$1*365.25,ms=function(B,_){_=_||{};var T=typeof B;if(T==="string"&&B.length>0)return parse(B);if(T==="number"&&isFinite(B))return _.long?fmtLong(B):fmtShort(B);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(B))};function parse(B){if(B=String(B),!(B.length>100)){var _=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(B);if(_){var T=parseFloat(_[1]),E=(_[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return T*y;case"weeks":case"week":case"w":return T*w;case"days":case"day":case"d":return T*d$1;case"hours":case"hour":case"hrs":case"hr":case"h":return T*h;case"minutes":case"minute":case"mins":case"min":case"m":return T*m;case"seconds":case"second":case"secs":case"sec":case"s":return T*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return T;default:return}}}}function fmtShort(B){var _=Math.abs(B);return _>=d$1?Math.round(B/d$1)+"d":_>=h?Math.round(B/h)+"h":_>=m?Math.round(B/m)+"m":_>=s?Math.round(B/s)+"s":B+"ms"}function fmtLong(B){var _=Math.abs(B);return _>=d$1?plural(B,_,d$1,"day"):_>=h?plural(B,_,h,"hour"):_>=m?plural(B,_,m,"minute"):_>=s?plural(B,_,s,"second"):B+" ms"}function plural(B,_,T,E){var W=_>=T*1.5;return Math.round(B/T)+" "+E+(W?"s":"")}function setup(B){T.debug=T,T.default=T,T.coerce=te,T.disable=q,T.enable=X,T.enabled=Y,T.humanize=ms,Object.keys(B).forEach(function(ne){T[ne]=B[ne]}),T.instances=[],T.names=[],T.skips=[],T.formatters={};function _(ne){for(var ae=0,le=0;le<ne.length;le++)ae=(ae<<5)-ae+ne.charCodeAt(le),ae|=0;return T.colors[Math.abs(ae)%T.colors.length]}T.selectColor=_;function T(ne){var ae;function le(){if(le.enabled){for(var ue=arguments.length,ge=new Array(ue),ye=0;ye<ue;ye++)ge[ye]=arguments[ye];var xe=le,Te=Number(new Date),Ae=Te-(ae||Te);xe.diff=Ae,xe.prev=ae,xe.curr=Te,ae=Te,ge[0]=T.coerce(ge[0]),typeof ge[0]!="string"&&ge.unshift("%O");var Ie=0;ge[0]=ge[0].replace(/%([a-zA-Z%])/g,function($e,We){if($e==="%%")return $e;Ie++;var Ue=T.formatters[We];if(typeof Ue=="function"){var je=ge[Ie];$e=Ue.call(xe,je),ge.splice(Ie,1),Ie--}return $e}),T.formatArgs.call(xe,ge);var Ve=xe.log||T.log;Ve.apply(xe,ge)}}return le.namespace=ne,le.enabled=T.enabled(ne),le.useColors=T.useColors(),le.color=_(ne),le.destroy=E,le.extend=W,typeof T.init=="function"&&T.init(le),T.instances.push(le),le}function E(){var ne=T.instances.indexOf(this);return ne!==-1?(T.instances.splice(ne,1),!0):!1}function W(ne,ae){return T(this.namespace+(typeof ae>"u"?":":ae)+ne)}function X(ne){T.save(ne),T.names=[],T.skips=[];var ae,le=(typeof ne=="string"?ne:"").split(/[\s,]+/),ue=le.length;for(ae=0;ae<ue;ae++)le[ae]&&(ne=le[ae].replace(/\*/g,".*?"),ne[0]==="-"?T.skips.push(new RegExp("^"+ne.substr(1)+"$")):T.names.push(new RegExp("^"+ne+"$")));for(ae=0;ae<T.instances.length;ae++){var ge=T.instances[ae];ge.enabled=T.enabled(ge.namespace)}}function q(){T.enable("")}function Y(ne){if(ne[ne.length-1]==="*")return!0;var ae,le;for(ae=0,le=T.skips.length;ae<le;ae++)if(T.skips[ae].test(ne))return!1;for(ae=0,le=T.names.length;ae<le;ae++)if(T.names[ae].test(ne))return!0;return!1}function te(ne){return ne instanceof Error?ne.stack||ne.message:ne}return T.enable(T.load()),T}var common=setup,browser$1=createCommonjsModule(function(B,_){function T(ae){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(ue){return typeof ue}:T=function(ue){return ue&&typeof Symbol=="function"&&ue.constructor===Symbol&&ue!==Symbol.prototype?"symbol":typeof ue},T(ae)}_.log=X,_.formatArgs=W,_.save=q,_.load=Y,_.useColors=E,_.storage=te(),_.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function E(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function W(ae){if(ae[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+ae[0]+(this.useColors?"%c ":" ")+"+"+B.exports.humanize(this.diff),!!this.useColors){var le="color: "+this.color;ae.splice(1,0,le,"color: inherit");var ue=0,ge=0;ae[0].replace(/%[a-zA-Z%]/g,function(ye){ye!=="%%"&&(ue++,ye==="%c"&&(ge=ue))}),ae.splice(ge,0,le)}}function X(){var ae;return(typeof console>"u"?"undefined":T(console))==="object"&&console.log&&(ae=console).log.apply(ae,arguments)}function q(ae){try{ae?_.storage.setItem("debug",ae):_.storage.removeItem("debug")}catch{}}function Y(){var ae;try{ae=_.storage.getItem("debug")}catch{}return!ae&&typeof process<"u"&&"env"in process&&(ae=define_process_env_default.DEBUG),ae}function te(){try{return localStorage}catch{}}B.exports=common(_);var ne=B.exports.formatters;ne.j=function(ae){try{return JSON.stringify(ae)}catch(le){return"[UnexpectedJSONParseError]: "+le.message}}});browser$1.log,browser$1.formatArgs,browser$1.save,browser$1.load,browser$1.useColors,browser$1.storage,browser$1.colors;var _logger,d=browser$1("Play"),LogLevel={Debug:"Debug",Warn:"Warn",Error:"Error"},logger=(_logger={},_defineProperty(_logger,LogLevel.Debug,d),_defineProperty(_logger,LogLevel.Warn,console.warn.bind(console)),_defineProperty(_logger,LogLevel.Error,console.error.bind(console)),_logger);function setLogger(B){_Object$assign(logger,B)}function debug(B){var _="[DEBUG] "+B;logger[LogLevel.Debug](_)}function error(B){var _="[ERROR] "+B;logger[LogLevel.Error](_)}var isWeapp=(typeof wx>"u"?"undefined":_typeof(wx))==="object"&&typeof wx.connectSocket=="function",tap=function(_){return function(T){return _(T),T}};function getFallbackRouter(B){var _=B.slice(0,8).toLowerCase();return"https://"+_+".play.lncldglobal.com/1/multiplayer/router/route"}var AppRouter=function(){function B(_){var T=_.appId,E=_.server;_classCallCheck(this,B),this._appId=T,this._playServer=E,this._url=null,this._serverValidTimestamp=0}return _createClass(B,[{key:"fetch",value:function(){if(this._playServer!==void 0)return _Promise.resolve(this._playServer+"/1/multiplayer/router/authorize");var T=Date.now();return T<this._serverValidTimestamp?(debug("get app router from cache: "+this._url),_Promise.resolve(this._url)):this._fetch()}},{key:"_fetch",value:function(){var T=this;return new _Promise(function(){var E=_asyncToGenerator(regenerator.mark(function W(X,q){var Y,te,ne,ae,le,ue,ge,ye;return regenerator.wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return Y="https://app-router.leancloud.cn/2/route",te={appId:T._appId},Te.prev=2,Te.next=5,client.get(Y).query(te);case 5:ne=Te.sent,ae=JSON.parse(ne.text),le=ae.ttl,ue=ae.play_server,ge=ae.multiplayer_router_server,ye=ge||ue,ye===void 0&&q(new Error("router server is null")),T._url="https://"+ye+"/1/multiplayer/router/authorize",T._serverValidTimestamp=Date.now()+le*1e3,debug("server valid timestamp: "+T._serverValidTimestamp),debug("get app router from server: "+T._url),X(T._url),Te.next=23;break;case 17:Te.prev=17,Te.t0=Te.catch(2),T._url=getFallbackRouter(T._appId),debug("fallback router: "+T._url),T._serverValidTimestamp=Date.now()+108e5,X(T._url);case 23:case"end":return Te.stop()}},W,T,[[2,17]])}));return function(W,X){return E.apply(this,arguments)}}())}}]),B}(),GameRouter=function(){function B(_,T,E,W,X){_classCallCheck(this,B),this._appId=_,this._appKey=T,this._userId=E,this._server=W,this._feature=X,this._appRouter=new AppRouter({appId:_,server:W}),this._sessionToken=null,this._url=null,this._serverValidTimeStamp=0}return _createClass(B,[{key:"authorize",value:function(){var T=this;return this._isValid()?_Promise.resolve({url:this._url,sessionToken:this._sessionToken}):new _Promise(function(){var E=_asyncToGenerator(regenerator.mark(function W(X,q){var Y,te,ne,ae,le,ue,ge;return regenerator.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.prev=0,xe.next=3,T._appRouter.fetch();case 3:return Y=xe.sent,debug(Y),te={},isWeapp&&(te.feature="wechat"),T._feature&&(te.feature=T._feature),xe.next=10,client.post(Y).set(T._getHeaders()).send(te);case 10:ne=xe.sent,debug(ne.text),ae=JSON.parse(ne.text),le=ae.sessionToken,ue=ae.lobbyAddr,ge=ae.ttl,T._sessionToken=le,T._url=ue,T._serverValidTimeStamp=Date.now()+ge*1e3,X({url:T._url,sessionToken:T._sessionToken}),xe.next=23;break;case 19:xe.prev=19,xe.t0=xe.catch(0),error(_JSON$stringify(xe.t0)),q(xe.t0);case 23:case"end":return xe.stop()}},W,T,[[0,19]])}));return function(W,X){return E.apply(this,arguments)}}())}},{key:"_isValid",value:function(){return this._sessionToken!=null&&this._url!=null&&Date.now()<this._serverValidTimeStamp}},{key:"_getHeaders",value:function(){return{"X-LC-ID":this._appId,"X-LC-KEY":this._appKey,"X-LC-PLAY-USER-ID":this._userId,"Content-Type":"application/json"}}}]),B}(),version="1.0.2",protocolVersion="0",_createProperty=function(B,_,T){_ in B?_objectDp.f(B,_,_propertyDesc(0,T)):B[_]=T};_export(_export.S+_export.F*!_iterDetect(function(B){Array.from(B)}),"Array",{from:function(_){var T=_toObject(_),E=typeof this=="function"?this:Array,W=arguments.length,X=W>1?arguments[1]:void 0,q=X!==void 0,Y=0,te=core_getIteratorMethod(T),ne,ae,le,ue;if(q&&(X=_ctx(X,W>2?arguments[2]:void 0,2)),te!=null&&!(E==Array&&_isArrayIter(te)))for(ue=te.call(T),ae=new E;!(le=ue.next()).done;Y++)_createProperty(ae,Y,q?_iterCall(ue,X,[le.value,Y],!0):le.value);else for(ne=_toLength(T.length),ae=new E(ne);ne>Y;Y++)_createProperty(ae,Y,q?X(T[Y],Y):T[Y]);return ae.length=Y,ae}});var from_1$1=_core.Array.from,from_1=createCommonjsModule(function(B){B.exports={default:from_1$1,__esModule:!0}}),_Array$from=unwrapExports(from_1),arraySlice=[].slice,factories={},construct$2=function(B,_,T){if(!(_ in factories)){for(var E=[],W=0;W<_;W++)E[W]="a["+W+"]";factories[_]=Function("F,a","return new F("+E.join(",")+")")}return factories[_](B,T)},_bind=Function.bind||function(_){var T=_aFunction(this),E=arraySlice.call(arguments,1),W=function(){var X=E.concat(arraySlice.call(arguments));return this instanceof W?construct$2(T,X.length,X):_invoke(T,X,_)};return _isObject(T.prototype)&&(W.prototype=T.prototype),W},rConstruct=(_global.Reflect||{}).construct,NEW_TARGET_BUG=_fails(function(){function B(){}return!(rConstruct(function(){},[],B)instanceof B)}),ARGS_BUG=!_fails(function(){rConstruct(function(){})});_export(_export.S+_export.F*(NEW_TARGET_BUG||ARGS_BUG),"Reflect",{construct:function(_,T){_aFunction(_),_anObject(T);var E=arguments.length<3?_:_aFunction(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return rConstruct(_,T,E);if(_==E){switch(T.length){case 0:return new _;case 1:return new _(T[0]);case 2:return new _(T[0],T[1]);case 3:return new _(T[0],T[1],T[2]);case 4:return new _(T[0],T[1],T[2],T[3])}var W=[null];return W.push.apply(W,T),new(_bind.apply(_,W))}var X=E.prototype,q=_objectCreate(_isObject(X)?X:Object.prototype),Y=Function.apply.call(_,q,T);return _isObject(Y)?Y:q}});var construct$1=_core.Reflect.construct,construct=createCommonjsModule(function(B){B.exports={default:construct$1,__esModule:!0}}),_Reflect$construct=unwrapExports(construct);function _extendableBuiltin(B){function _(){var T=_Reflect$construct(B,_Array$from(arguments));return _Object$setPrototypeOf(T,_Object$getPrototypeOf(this)),T}return _.prototype=_Object$create(B.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),_Object$setPrototypeOf?_Object$setPrototypeOf(_,B):_.__proto__=B,_}var PLAY_ERRPR="PlayError",PlayError=function(B){_inherits(_,B);function _(T,E){_classCallCheck(this,_);var W=_possibleConstructorReturn(this,(_.__proto__||_Object$getPrototypeOf(_)).call(this,PLAY_ERRPR+": "+T+" - "+E));return W.name=PLAY_ERRPR,W.code=T,W.detail=E,W}return _}(_extendableBuiltin(Error)),SESSION_TOKEN_KEY="X-LC-PLAY-MULTIPLAYER-SESSION-TOKEN";function _tapError(B){if(error(_JSON$stringify(B)),B.response.text){var _=JSON.parse(B.response.text),T=_.reasonCode,E=_.detail;return new PlayError(T,E)}return B}var LobbyService=function(){function B(_){_classCallCheck(this,B),this._client=_;var T=this._client,E=T._appId,W=T._appKey,X=T._userId,q=T._playServer,Y=T._feature;this._gameRouter=new GameRouter(E,W,X,q,Y),this._defaultHeaders={"X-LC-ID":E,"X-LC-KEY":W,"X-LC-PLAY-USER-ID":X,"Content-Type":"application/json"}}return _createClass(B,[{key:"authorize",value:function(){return this._gameRouter.authorize()}},{key:"createRoom",value:function(T){var E=this;return new _Promise(function(){var W=_asyncToGenerator(regenerator.mark(function X(q,Y){var te,ne,ae,le,ue,ge,ye,xe,Te,Ae,Ie,Ve,$e;return regenerator.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return Ue.prev=0,Ue.next=3,E._gameRouter.authorize();case 3:return te=Ue.sent,ne=te.url,ae=te.sessionToken,le="/1/multiplayer/lobby/room",ue=""+ne+le,debug(ue),ge=E._client,ye=ge._gameVersion,xe=ge._insecure,Te={gameVersion:ye,sdkVersion:version,protocolVersion,useInsecureAddr:xe},T&&(Te.cid=T),Ue.next=14,client.post(ue).set(E._defaultHeaders).set(SESSION_TOKEN_KEY,ae).send(Te);case 14:Ae=Ue.sent,debug(Ae.text),Ie=JSON.parse(Ae.text),Ve=Ie.cid,$e=Ie.addr,q({cid:Ve,addr:$e}),Ue.next=23;break;case 20:Ue.prev=20,Ue.t0=Ue.catch(0),Y(_tapError(Ue.t0));case 23:case"end":return Ue.stop()}},X,E,[[0,20]])}));return function(X,q){return W.apply(this,arguments)}}())}},{key:"joinRoom",value:function(T){var E=this,W=T.roomName,X=T.expectedUserIds,q=T.rejoin,Y=T.createOnNotFound;return new _Promise(function(){var te=_asyncToGenerator(regenerator.mark(function ne(ae,le){var ue,ge,ye,xe,Te,Ae,Ie,Ve,$e,We,Ue,je,ze,He;return regenerator.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.prev=0,qe.next=3,E._gameRouter.authorize();case 3:return ue=qe.sent,ge=ue.url,ye=ue.sessionToken,xe="/1/multiplayer/lobby/room/"+W,Te=""+ge+xe,Ae=E._client,Ie=Ae._gameVersion,Ve=Ae._insecure,$e={cid:W,gameVersion:Ie,sdkVersion:version,protocolVersion,useInsecureAddr:Ve},X&&($e.expectMembers=X),q!==void 0&&($e.rejoin=q),Y!==void 0&&($e.createOnNotFound=Y),debug(_JSON$stringify($e)),qe.next=16,client.post(Te).set(E._defaultHeaders).set(SESSION_TOKEN_KEY,ye).send($e);case 16:We=qe.sent,debug(We.text),Ue=JSON.parse(We.text),je=Ue.cid,ze=Ue.addr,He=Ue.roomCreated,ae({cid:je,addr:ze,roomCreated:He}),qe.next=25;break;case 22:qe.prev=22,qe.t0=qe.catch(0),le(_tapError(qe.t0));case 25:case"end":return qe.stop()}},ne,E,[[0,22]])}));return function(ne,ae){return te.apply(this,arguments)}}())}},{key:"joinRandomRoom",value:function(T,E){var W=this;return new _Promise(function(){var X=_asyncToGenerator(regenerator.mark(function q(Y,te){var ne,ae,le,ue,ge,ye,xe,Te,Ae,Ie,Ve,$e,We;return regenerator.wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return je.prev=0,je.next=3,W._gameRouter.authorize();case 3:return ne=je.sent,ae=ne.url,le=ne.sessionToken,ue="/1/multiplayer/lobby/match/room",ge=""+ae+ue,ye=W._client,xe=ye._gameVersion,Te=ye._insecure,Ae={gameVersion:xe,sdkVersion:version,protocolVersion,useInsecureAddr:Te},T&&(Ae.expectAttr=T),E&&(Ae.expectMembers=E),je.next=14,client.post(ge).set(W._defaultHeaders).set(SESSION_TOKEN_KEY,le).send(Ae);case 14:Ie=je.sent,debug(Ie.text),Ve=JSON.parse(Ie.text),$e=Ve.cid,We=Ve.addr,Y({cid:$e,addr:We}),je.next=23;break;case 20:je.prev=20,je.t0=je.catch(0),te(_tapError(je.t0));case 23:case"end":return je.stop()}},q,W,[[0,20]])}));return function(q,Y){return X.apply(this,arguments)}}())}},{key:"matchRandom",value:function(T,E,W){var X=this;if(typeof T!="string")throw new TypeError(T+" is not a string");if(E!==null&&(typeof E>"u"?"undefined":_typeof(E))!=="object")throw new TypeError(E+" is not an object");if(W!==null&&!Array.isArray(W))throw new TypeError(W+" is not an array with string");return new _Promise(function(){var q=_asyncToGenerator(regenerator.mark(function Y(te,ne){var ae,le,ue,ge,ye,xe,Te,Ae,Ie,Ve,$e,We,Ue;return regenerator.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.prev=0,ze.next=3,X._gameRouter.authorize();case 3:return ae=ze.sent,le=ae.url,ue=ae.sessionToken,ge="/1/multiplayer/lobby/match/room",ye=""+le+ge,xe=X._client,Te=xe._gameVersion,Ae=xe._insecure,Ie={gameVersion:Te,sdkVersion:version,protocolVersion,piggybackPeerId:T,useInsecureAddr:Ae},E&&(Ie.expectAttr=E),W&&(Ie.expectMembers=W),ze.next=14,client.post(ye).set(X._defaultHeaders).set(SESSION_TOKEN_KEY,ue).send(Ie);case 14:Ve=ze.sent,debug(Ve.text),$e=JSON.parse(Ve.text),We=$e.cid,Ue=$e.addr,te({roomName:We,addr:Ue}),ze.next=23;break;case 20:ze.prev=20,ze.t0=ze.catch(0),ne(_tapError(ze.t0));case 23:case"end":return ze.stop()}},Y,X,[[0,20]])}));return function(Y,te){return q.apply(this,arguments)}}())}}]),B}(),isEnum=_objectPie.f,_objectToArray=function(B){return function(_){for(var T=_toIobject(_),E=_objectKeys(T),W=E.length,X=0,q=[],Y;W>X;)Y=E[X++],(!_descriptors||isEnum.call(T,Y))&&q.push(B?[Y,T[Y]]:T[Y]);return q}},$values=_objectToArray(!1);_export(_export.S,"Object",{values:function(_){return $values(_)}});var values$1=_core.Object.values,values=createCommonjsModule(function(B){B.exports={default:values$1,__esModule:!0}}),_Object$values=unwrapExports(values),stateMachine=createCommonjsModule(function(B,_){(function(E,W){B.exports=W()})(commonjsGlobal$1,function(){return function(T){var E={};function W(X){if(E[X])return E[X].exports;var q=E[X]={i:X,l:!1,exports:{}};return T[X].call(q.exports,q,q.exports,W),q.l=!0,q.exports}return W.m=T,W.c=E,W.i=function(X){return X},W.d=function(X,q,Y){W.o(X,q)||Object.defineProperty(X,q,{configurable:!1,enumerable:!0,get:Y})},W.n=function(X){var q=X&&X.__esModule?function(){return X.default}:function(){return X};return W.d(q,"a",q),q},W.o=function(X,q){return Object.prototype.hasOwnProperty.call(X,q)},W.p="",W(W.s=5)}([function(T,E,W){T.exports=function(X,q){var Y,te,ne;for(Y=1;Y<arguments.length;Y++){te=arguments[Y];for(ne in te)te.hasOwnProperty(ne)&&(X[ne]=te[ne])}return X}},function(T,E,W){var X=W(0);T.exports={build:function(q,Y){var te,ne,ae,le=Y.plugins;for(te=0,ne=le.length;te<ne;te++)ae=le[te],ae.methods&&X(q,ae.methods),ae.properties&&Object.defineProperties(q,ae.properties)},hook:function(q,Y,te){var ne,ae,le,ue,ge=q.config.plugins,ye=[q.context];for(te&&(ye=ye.concat(te)),ne=0,ae=ge.length;ne<ae;ne++)ue=ge[ne],le=ge[ne][Y],le&&le.apply(ue,ye)}}},function(T,E,W){function X(q){if(q.length===0)return q;var Y,te,ne=q.split(/[_-]/);if(ne.length===1&&ne[0][0].toLowerCase()===ne[0][0])return q;for(te=ne[0].toLowerCase(),Y=1;Y<ne.length;Y++)te=te+ne[Y].charAt(0).toUpperCase()+ne[Y].substring(1).toLowerCase();return te}X.prepended=function(q,Y){return Y=X(Y),q+Y[0].toUpperCase()+Y.substring(1)},T.exports=X},function(T,E,W){var X=W(0),q=W(2);function Y(te,ne){te=te||{},this.options=te,this.defaults=ne.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(te.init),this.data=this.configureData(te.data),this.methods=this.configureMethods(te.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(te.transitions||[]),this.plugins=this.configurePlugins(te.plugins,ne.plugin)}X(Y.prototype,{addState:function(te){this.map[te]||(this.states.push(te),this.addStateLifecycleNames(te),this.map[te]={})},addStateLifecycleNames:function(te){this.lifecycle.onEnter[te]=q.prepended("onEnter",te),this.lifecycle.onLeave[te]=q.prepended("onLeave",te),this.lifecycle.on[te]=q.prepended("on",te)},addTransition:function(te){this.transitions.indexOf(te)<0&&(this.transitions.push(te),this.addTransitionLifecycleNames(te))},addTransitionLifecycleNames:function(te){this.lifecycle.onBefore[te]=q.prepended("onBefore",te),this.lifecycle.onAfter[te]=q.prepended("onAfter",te),this.lifecycle.on[te]=q.prepended("on",te)},mapTransition:function(te){var ne=te.name,ae=te.from,le=te.to;return this.addState(ae),typeof le!="function"&&this.addState(le),this.addTransition(ne),this.map[ae][ne]=te,te},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(te){return typeof te=="string"?this.mapTransition(X({},this.defaults.init,{to:te,active:!0})):typeof te=="object"?this.mapTransition(X({},this.defaults.init,te,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(te){return typeof te=="function"?te:typeof te=="object"?function(){return te}:function(){return{}}},configureMethods:function(te){return te||{}},configurePlugins:function(te,ne){te=te||[];var ae,le,ue;for(ae=0,le=te.length;ae<le;ae++)ue=te[ae],typeof ue=="function"&&(te[ae]=ue=ue()),ue.configure&&ue.configure(this);return te},configureTransitions:function(te){var ne,ae,le,ue,ge,ye=this.defaults.wildcard;for(ae=0;ae<te.length;ae++)for(le=te[ae],ue=Array.isArray(le.from)?le.from:[le.from||ye],ge=le.to||ye,ne=0;ne<ue.length;ne++)this.mapTransition({name:le.name,from:ue[ne],to:ge})},transitionFor:function(te,ne){var ae=this.defaults.wildcard;return this.map[te][ne]||this.map[ae][ne]},transitionsFor:function(te){var ne=this.defaults.wildcard;return Object.keys(this.map[te]).concat(Object.keys(this.map[ne]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),T.exports=Y},function(T,E,W){var X=W(0),q=W(6),Y=W(1),te=[null,[]];function ne(ae,le){this.context=ae,this.config=le,this.state=le.init.from,this.observers=[ae]}X(ne.prototype,{init:function(ae){if(X(this.context,this.config.data.apply(this.context,ae)),Y.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(ae){return Array.isArray(ae)?ae.indexOf(this.state)>=0:this.state===ae},isPending:function(){return this.pending},can:function(ae){return!this.isPending()&&!!this.seek(ae)},cannot:function(ae){return!this.can(ae)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(ae,le){var ue=this.config.defaults.wildcard,ge=this.config.transitionFor(this.state,ae),ye=ge&&ge.to;return typeof ye=="function"?ye.apply(this.context,le):ye===ue?this.state:ye},fire:function(ae,le){return this.transit(ae,this.state,this.seek(ae,le),le)},transit:function(ae,le,ue,ge){var ye=this.config.lifecycle,xe=this.config.options.observeUnchangedState||le!==ue;return ue?this.isPending()?this.context.onPendingTransition(ae,le,ue):(this.config.addState(ue),this.beginTransit(),ge.unshift({transition:ae,from:le,to:ue,fsm:this.context}),this.observeEvents([this.observersForEvent(ye.onBefore.transition),this.observersForEvent(ye.onBefore[ae]),xe?this.observersForEvent(ye.onLeave.state):te,xe?this.observersForEvent(ye.onLeave[le]):te,this.observersForEvent(ye.on.transition),xe?["doTransit",[this]]:te,xe?this.observersForEvent(ye.onEnter.state):te,xe?this.observersForEvent(ye.onEnter[ue]):te,xe?this.observersForEvent(ye.on[ue]):te,this.observersForEvent(ye.onAfter.transition),this.observersForEvent(ye.onAfter[ae]),this.observersForEvent(ye.on[ae])],ge)):this.context.onInvalidTransition(ae,le,ue)},beginTransit:function(){this.pending=!0},endTransit:function(ae){return this.pending=!1,ae},failTransit:function(ae){throw this.pending=!1,ae},doTransit:function(ae){this.state=ae.to},observe:function(ae){if(ae.length===2){var le={};le[ae[0]]=ae[1],this.observers.push(le)}else this.observers.push(ae[0])},observersForEvent:function(ae){for(var le=0,ue=this.observers.length,ge,ye=[];le<ue;le++)ge=this.observers[le],ge[ae]&&ye.push(ge);return[ae,ye,!0]},observeEvents:function(ae,le,ue,ge){if(ae.length===0)return this.endTransit(ge===void 0?!0:ge);var ye=ae[0][0],xe=ae[0][1],Te=ae[0][2];if(le[0].event=ye,ye&&Te&&ye!==ue&&Y.hook(this,"lifecycle",le),xe.length===0)return ae.shift(),this.observeEvents(ae,le,ye,ge);var Ae=xe.shift(),Ie=Ae[ye].apply(Ae,le);return Ie&&typeof Ie.then=="function"?Ie.then(this.observeEvents.bind(this,ae,le,ye)).catch(this.failTransit.bind(this)):Ie===!1?this.endTransit(!1):this.observeEvents(ae,le,ye,Ie)},onInvalidTransition:function(ae,le,ue){throw new q("transition is invalid in current state",ae,le,ue,this.state)},onPendingTransition:function(ae,le,ue){throw new q("transition is invalid while previous transition is still in progress",ae,le,ue,this.state)}}),T.exports=ne},function(T,E,W){var X=W(0),q=W(2),Y=W(1),te=W(3),ne=W(4),ae={is:function(Te){return this._fsm.is(Te)},can:function(Te){return this._fsm.can(Te)},cannot:function(Te){return this._fsm.cannot(Te)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(Te,Ae,Ie){return this._fsm.onInvalidTransition(Te,Ae,Ie)},onPendingTransition:function(Te,Ae,Ie){return this._fsm.onPendingTransition(Te,Ae,Ie)}},le={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(Te){throw Error("use transitions to change state")}}};function ue(Te){return ye(this||{},Te)}function ge(){var Te,Ae;typeof arguments[0]=="function"?(Te=arguments[0],Ae=arguments[1]||{}):(Te=function(){this._fsm.apply(this,arguments)},Ae=arguments[0]||{});var Ie=new te(Ae,ue);return xe(Te.prototype,Ie),Te.prototype._fsm.config=Ie,Te}function ye(Te,Ae){var Ie=new te(Ae,ue);return xe(Te,Ie),Te._fsm(),Te}function xe(Te,Ae){if(typeof Te!="object"||Array.isArray(Te))throw Error("StateMachine can only be applied to objects");Y.build(Te,Ae),Object.defineProperties(Te,le),X(Te,ae),X(Te,Ae.methods),Ae.allTransitions().forEach(function(Ie){Te[q(Ie)]=function(){return this._fsm.fire(Ie,[].slice.call(arguments))}}),Te._fsm=function(){this._fsm=new ne(this,Ae),this._fsm.init(arguments)}}ue.version="3.0.1",ue.factory=ge,ue.apply=ye,ue.defaults={wildcard:"*",init:{name:"init",from:"none"}},T.exports=ue},function(T,E,W){T.exports=function(X,q,Y,te,ne){this.message=X,this.transition=q,this.from=Y,this.to=te,this.current=ne}}])})}),StateMachine=unwrapExports(stateMachine),ITERATOR=_wks("iterator"),core_isIterable=_core.isIterable=function(B){var _=Object(B);return _[ITERATOR]!==void 0||"@@iterator"in _||_iterators.hasOwnProperty(_classof(_))},isIterable$1=core_isIterable,isIterable=createCommonjsModule(function(B){B.exports={default:isIterable$1,__esModule:!0}});unwrapExports(isIterable);var core_getIterator=_core.getIterator=function(B){var _=core_getIteratorMethod(B);if(typeof _!="function")throw TypeError(B+" is not iterable!");return _anObject(_.call(B))},getIterator$1=core_getIterator,getIterator=createCommonjsModule(function(B){B.exports={default:getIterator$1,__esModule:!0}});unwrapExports(getIterator);var slicedToArray=createCommonjsModule(function(B,_){_.__esModule=!0;var T=W(isIterable),E=W(getIterator);function W(X){return X&&X.__esModule?X:{default:X}}_.default=function(){function X(q,Y){var te=[],ne=!0,ae=!1,le=void 0;try{for(var ue=(0,E.default)(q),ge;!(ne=(ge=ue.next()).done)&&(te.push(ge.value),!(Y&&te.length===Y));ne=!0);}catch(ye){ae=!0,le=ye}finally{try{!ne&&ue.return&&ue.return()}finally{if(ae)throw le}}return te}return function(q,Y){if(Array.isArray(q))return q;if((0,T.default)(Object(q)))return X(q,Y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),_slicedToArray=unwrapExports(slicedToArray),$entries=_objectToArray(!0);_export(_export.S,"Object",{entries:function(_){return $entries(_)}});var entries$1=_core.Object.entries,entries=createCommonjsModule(function(B){B.exports={default:entries$1,__esModule:!0}}),_Object$entries=unwrapExports(entries),$jscomp=$jscomp||{};$jscomp.scope={},$jscomp.findInternal=function(B,_,T){B instanceof String&&(B=String(B));for(var E=B.length,W=0;W<E;W++){var X=B[W];if(_.call(T,X,W,B))return{i:W,v:X}}return{i:-1,v:void 0}},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.defineProperty=$jscomp.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(B,_,T){B!=Array.prototype&&B!=Object.prototype&&(B[_]=T.value)},$jscomp.getGlobal=function(B){return typeof window<"u"&&window===B?B:typeof commonjsGlobal$1<"u"&&commonjsGlobal$1!=null?commonjsGlobal$1:B},$jscomp.global=$jscomp.getGlobal(commonjsGlobal$1),$jscomp.polyfill=function(B,_,T,E){if(_){for(T=$jscomp.global,B=B.split("."),E=0;E<B.length-1;E++){var W=B[E];W in T||(T[W]={}),T=T[W]}B=B[B.length-1],E=T[B],_=_(E),_!=E&&_!=null&&$jscomp.defineProperty(T,B,{configurable:!0,writable:!0,value:_})}},$jscomp.polyfill("Array.prototype.findIndex",function(B){return B||function(_,T){return $jscomp.findInternal(this,_,T).i}},"es6","es3"),$jscomp.checkStringArgs=function(B,_,T){if(B==null)throw new TypeError("The 'this' value for String.prototype."+T+" must not be null or undefined");if(_ instanceof RegExp)throw new TypeError("First argument to String.prototype."+T+" must not be a regular expression");return B+""},$jscomp.polyfill("String.prototype.endsWith",function(B){return B||function(_,T){var E=$jscomp.checkStringArgs(this,_,"endsWith");_+="",T===void 0&&(T=E.length),T=Math.max(0,Math.min(T|0,E.length));for(var W=_.length;0<W&&0<T;)if(E[--T]!=_[--W])return!1;return 0>=W}},"es6","es3"),$jscomp.polyfill("Array.prototype.find",function(B){return B||function(_,T){return $jscomp.findInternal(this,_,T).v}},"es6","es3"),$jscomp.polyfill("String.prototype.startsWith",function(B){return B||function(_,T){var E=$jscomp.checkStringArgs(this,_,"startsWith");_+="";var W=E.length,X=_.length;T=Math.max(0,Math.min(T|0,E.length));for(var q=0;q<X&&T<W;)if(E[T++]!=_[q++])return!1;return q>=X}},"es6","es3"),$jscomp.polyfill("String.prototype.repeat",function(B){return B||function(_){var T=$jscomp.checkStringArgs(this,null,"repeat");if(0>_||1342177279<_)throw new RangeError("Invalid count value");_|=0;for(var E="";_;)_&1&&(E+=T),(_>>>=1)&&(T+=T);return E}},"es6","es3");var COMPILED$1=!0,goog=goog||{};goog.global=commonjsGlobal$1||self,goog.isDef=function(B){return B!==void 0},goog.isString=function(B){return typeof B=="string"},goog.isBoolean=function(B){return typeof B=="boolean"},goog.isNumber=function(B){return typeof B=="number"},goog.exportPath_=function(B,_,T){B=B.split("."),T=T||goog.global,B[0]in T||typeof T.execScript>"u"||T.execScript("var "+B[0]);for(var E;B.length&&(E=B.shift());)!B.length&&goog.isDef(_)?T[E]=_:T=T[E]&&T[E]!==Object.prototype[E]?T[E]:T[E]={}},goog.define=function(B,_){return _},goog.FEATURESET_YEAR=2012,goog.DEBUG=!0,goog.LOCALE="en",goog.TRUSTED_SITE=!0,goog.STRICT_MODE_COMPATIBLE=!1,goog.DISALLOW_TEST_ONLY_CODE=!goog.DEBUG,goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1,goog.provide=function(B){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");goog.constructNamespace_(B)},goog.constructNamespace_=function(B,_){goog.exportPath_(B,_)},goog.getScriptNonce=function(B){return B&&B!=goog.global?goog.getScriptNonce_(B.document):(goog.cspNonce_===null&&(goog.cspNonce_=goog.getScriptNonce_(goog.global.document)),goog.cspNonce_)},goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/,goog.cspNonce_=null,goog.getScriptNonce_=function(B){return(B=B.querySelector&&B.querySelector("script[nonce]"))&&(B=B.nonce||B.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(B)?B:""},goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/,goog.module=function(B){if(!goog.isString(B)||!B||B.search(goog.VALID_MODULE_RE_)==-1)throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+B+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=B},goog.module.get=function(B){return goog.module.getInternal_(B)},goog.module.getInternal_=function(B){return null},goog.ModuleType={ES6:"es6",GOOG:"goog"},goog.moduleLoaderState_=null,goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()},goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG},goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var B=goog.global.$jscomp;return B?typeof B.getCurrentModulePath!="function"?!1:!!B.getCurrentModulePath():!1},goog.module.declareLegacyNamespace=function(){goog.moduleLoaderState_.declareLegacyNamespace=!0},goog.declareModuleId=function(B){if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=B;else{var _=goog.global.$jscomp;if(!_||typeof _.getCurrentModulePath!="function")throw Error('Module with namespace "'+B+'" has been loaded incorrectly.');_=_.require(_.getCurrentModulePath()),goog.loadedModules_[B]={exports:_,type:goog.ModuleType.ES6,moduleId:B}}},goog.setTestOnly=function(B){if(goog.DISALLOW_TEST_ONLY_CODE)throw B=B||"",Error("Importing test-only code into non-debug environment"+(B?": "+B:"."))},goog.forwardDeclare=function(B){},goog.getObjectByName=function(B,_){B=B.split("."),_=_||goog.global;for(var T=0;T<B.length;T++)if(_=_[B[T]],!goog.isDefAndNotNull(_))return null;return _},goog.globalize=function(B,_){_=_||goog.global;for(var T in B)_[T]=B[T]},goog.addDependency=function(B,_,T,E){},goog.ENABLE_DEBUG_LOADER=!0,goog.logToConsole_=function(B){goog.global.console&&goog.global.console.error(B)},goog.require=function(B){},goog.requireType=function(B){return{}},goog.basePath="",goog.nullFunction=function(){},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(B){B.instance_=void 0,B.getInstance=function(){return B.instance_?B.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=B),B.instance_=new B)}},goog.instantiatedSingletons_=[],goog.LOAD_MODULE_USING_EVAL=!0,goog.SEAL_MODULE_EXPORTS=goog.DEBUG,goog.loadedModules_={},goog.DEPENDENCIES_ENABLED=!COMPILED$1,goog.TRANSPILE="detect",goog.ASSUME_ES_MODULES_TRANSPILED=!1,goog.TRANSPILE_TO_LANGUAGE="",goog.TRANSPILER="transpile.js",goog.hasBadLetScoping=null,goog.useSafari10Workaround=function(){if(goog.hasBadLetScoping==null){try{var a=!eval('"use strict";let x = 1; function f() { return typeof x; };f() == "number";')}catch(B){a=!1}goog.hasBadLetScoping=a}return goog.hasBadLetScoping},goog.workaroundSafari10EvalBug=function(B){return"(function(){"+B+`
;})();
`},goog.loadModule=function(B){var _=goog.moduleLoaderState_;try{if(goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG},goog.isFunction(B))var T=B.call(void 0,{});else if(goog.isString(B))goog.useSafari10Workaround()&&(B=goog.workaroundSafari10EvalBug(B)),T=goog.loadModuleFromSource_.call(void 0,B);else throw Error("Invalid module definition");var E=goog.moduleLoaderState_.moduleName;if(goog.isString(E)&&E)goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(E,T):goog.SEAL_MODULE_EXPORTS&&Object.seal&&typeof T=="object"&&T!=null&&Object.seal(T),goog.loadedModules_[E]={exports:T,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName};else throw Error('Invalid module name "'+E+'"')}finally{goog.moduleLoaderState_=_}},goog.loadModuleFromSource_=function(a){return eval(a),{}},goog.normalizePath_=function(B){B=B.split("/");for(var _=0;_<B.length;)B[_]=="."?B.splice(_,1):_&&B[_]==".."&&B[_-1]&&B[_-1]!=".."?B.splice(--_,2):_++;return B.join("/")},goog.loadFileSync_=function(B){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(B);try{var _=new goog.global.XMLHttpRequest;return _.open("get",B,!1),_.send(),_.status==0||_.status==200?_.responseText:null}catch{return null}},goog.transpile_=function(B,_,T){var E=goog.global.$jscomp;E||(goog.global.$jscomp=E={});var W=E.transpile;if(!W){var X=goog.basePath+goog.TRANSPILER,q=goog.loadFileSync_(X);if(q){if((function(){(0,eval)(q+`
//# sourceURL=`+X)}).call(goog.global),goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=goog.global.$gwtExport.$jscomp.transpile,E=goog.global.$jscomp,W=E.transpile}}return W||(W=E.transpile=function(Y,te){return goog.logToConsole_(te+" requires transpilation but no transpiler was found."),Y}),W(B,_,T)},goog.typeOf=function(B){var _=typeof B;if(_=="object")if(B){if(B instanceof Array)return"array";if(B instanceof Object)return _;var T=Object.prototype.toString.call(B);if(T=="[object Window]")return"object";if(T=="[object Array]"||typeof B.length=="number"&&typeof B.splice<"u"&&typeof B.propertyIsEnumerable<"u"&&!B.propertyIsEnumerable("splice"))return"array";if(T=="[object Function]"||typeof B.call<"u"&&typeof B.propertyIsEnumerable<"u"&&!B.propertyIsEnumerable("call"))return"function"}else return"null";else if(_=="function"&&typeof B.call>"u")return"object";return _},goog.isNull=function(B){return B===null},goog.isDefAndNotNull=function(B){return B!=null},goog.isArray=function(B){return goog.typeOf(B)=="array"},goog.isArrayLike=function(B){var _=goog.typeOf(B);return _=="array"||_=="object"&&typeof B.length=="number"},goog.isDateLike=function(B){return goog.isObject(B)&&typeof B.getFullYear=="function"},goog.isFunction=function(B){return goog.typeOf(B)=="function"},goog.isObject=function(B){var _=typeof B;return _=="object"&&B!=null||_=="function"},goog.getUid=function(B){return B[goog.UID_PROPERTY_]||(B[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(B){return!!B[goog.UID_PROPERTY_]},goog.removeUid=function(B){B!==null&&"removeAttribute"in B&&B.removeAttribute(goog.UID_PROPERTY_);try{delete B[goog.UID_PROPERTY_]}catch{}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(B){var _=goog.typeOf(B);if(_=="object"||_=="array"){if(typeof B.clone=="function")return B.clone();_=_=="array"?[]:{};for(var T in B)_[T]=goog.cloneObject(B[T]);return _}return B},goog.bindNative_=function(B,_,T){return B.call.apply(B.bind,arguments)},goog.bindJs_=function(B,_,T){if(!B)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,E),B.apply(_,W)}}return function(){return B.apply(_,arguments)}},goog.bind=function(B,_,T){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(B,_){var T=Array.prototype.slice.call(arguments,1);return function(){var E=T.slice();return E.push.apply(E,arguments),B.apply(this,E)}},goog.mixin=function(B,_){for(var T in _)B[T]=_[T]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(B){if(goog.global.execScript)goog.global.execScript(B,"JavaScript");else if(goog.global.eval){if(goog.evalWorksForGlobals_==null){try{goog.global.eval("var _evalTest_ = 1;")}catch{}if(typeof goog.global._evalTest_<"u"){try{delete goog.global._evalTest_}catch{}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1}if(goog.evalWorksForGlobals_)goog.global.eval(B);else{var _=goog.global.document,T=_.createElement("SCRIPT");T.type="text/javascript",T.defer=!1,T.appendChild(_.createTextNode(B)),_.head.appendChild(T),_.head.removeChild(T)}}else throw Error("goog.globalEval not available")},goog.evalWorksForGlobals_=null,goog.getCssName=function(B,_){if(String(B).charAt(0)==".")throw Error('className passed in goog.getCssName must not start with ".". You passed: '+B);var T=function(W){return goog.cssNameMapping_[W]||W},E=function(W){W=W.split("-");for(var X=[],q=0;q<W.length;q++)X.push(T(W[q]));return X.join("-")};return E=goog.cssNameMapping_?goog.cssNameMappingStyle_=="BY_WHOLE"?T:E:function(W){return W},B=_?B+"-"+E(_):E(B),goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(B):B},goog.setCssNameMapping=function(B,_){goog.cssNameMapping_=B,goog.cssNameMappingStyle_=_},goog.getMsg=function(B,_,T){return T&&T.html&&(B=B.replace(/</g,"&lt;")),_&&(B=B.replace(/\{\$([^}]+)}/g,function(E,W){return _!=null&&W in _?_[W]:E})),B},goog.getMsgWithFallback=function(B,_){return B},goog.exportSymbol=function(B,_,T){goog.exportPath_(B,_,T)},goog.exportProperty=function(B,_,T){B[_]=T},goog.inherits=function(B,_){function T(){}T.prototype=_.prototype,B.superClass_=_.prototype,B.prototype=new T,B.prototype.constructor=B,B.base=function(E,W,X){for(var q=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)q[Y-2]=arguments[Y];return _.prototype[W].apply(E,q)}},goog.base=function(B,_,T){var E=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!E)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(typeof E.superClass_<"u"){for(var W=Array(arguments.length-1),X=1;X<arguments.length;X++)W[X-1]=arguments[X];return E.superClass_.constructor.apply(B,W)}if(typeof _!="string"&&typeof _!="symbol")throw Error("method names provided to goog.base must be a string or a symbol");for(W=Array(arguments.length-2),X=2;X<arguments.length;X++)W[X-2]=arguments[X];X=!1;for(var q=B.constructor.prototype;q;q=Object.getPrototypeOf(q))if(q[_]===E)X=!0;else if(X)return q[_].apply(B,W);if(B[_]===E)return B.constructor.prototype[_].apply(B,W);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(B){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");B.call(goog.global)},goog.defineClass=function(B,_){var T=_.constructor,E=_.statics;return T&&T!=Object.prototype.constructor||(T=function(){throw Error("cannot instantiate an interface (no constructor defined).")}),T=goog.defineClass.createSealingConstructor_(T,B),B&&goog.inherits(T,B),delete _.constructor,delete _.statics,goog.defineClass.applyProperties_(T.prototype,_),E!=null&&(E instanceof Function?E(T):goog.defineClass.applyProperties_(T,E)),T},goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG,goog.defineClass.createSealingConstructor_=function(B,_){if(!goog.defineClass.SEAL_CLASS_INSTANCES)return B;var T=!goog.defineClass.isUnsealable_(_),E=function(){var W=B.apply(this,arguments)||this;return W[goog.UID_PROPERTY_]=W[goog.UID_PROPERTY_],this.constructor===E&&T&&Object.seal instanceof Function&&Object.seal(W),W};return E},goog.defineClass.isUnsealable_=function(B){return B&&B.prototype&&B.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.defineClass.applyProperties_=function(B,_){for(var T in _)Object.prototype.hasOwnProperty.call(_,T)&&(B[T]=_[T]);for(var E=0;E<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;E++)T=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[E],Object.prototype.hasOwnProperty.call(_,T)&&(B[T]=_[T])},goog.tagUnsealableClass=function(B){},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",goog.TRUSTED_TYPES_POLICY_NAME="",goog.identity_=function(B){return B},goog.createTrustedTypesPolicy=function(B){var _=null;if(typeof TrustedTypes>"u"||!TrustedTypes.createPolicy)return _;try{_=TrustedTypes.createPolicy(B,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_,createURL:goog.identity_})}catch(T){goog.logToConsole_(T.message)}return _},goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null,goog.object={},goog.object.is=function(B,_){return B===_?B!==0||1/B===1/_:B!==B&&_!==_},goog.object.forEach=function(B,_,T){for(var E in B)_.call(T,B[E],E,B)},goog.object.filter=function(B,_,T){var E={},W;for(W in B)_.call(T,B[W],W,B)&&(E[W]=B[W]);return E},goog.object.map=function(B,_,T){var E={},W;for(W in B)E[W]=_.call(T,B[W],W,B);return E},goog.object.some=function(B,_,T){for(var E in B)if(_.call(T,B[E],E,B))return!0;return!1},goog.object.every=function(B,_,T){for(var E in B)if(!_.call(T,B[E],E,B))return!1;return!0},goog.object.getCount=function(B){var _=0,T;for(T in B)_++;return _},goog.object.getAnyKey=function(B){for(var _ in B)return _},goog.object.getAnyValue=function(B){for(var _ in B)return B[_]},goog.object.contains=function(B,_){return goog.object.containsValue(B,_)},goog.object.getValues=function(B){var _=[],T=0,E;for(E in B)_[T++]=B[E];return _},goog.object.getKeys=function(B){var _=[],T=0,E;for(E in B)_[T++]=E;return _},goog.object.getValueByKeys=function(B,_){var T=goog.isArrayLike(_),E=T?_:arguments;for(T=T?0:1;T<E.length;T++){if(B==null)return;B=B[E[T]]}return B},goog.object.containsKey=function(B,_){return B!==null&&_ in B},goog.object.containsValue=function(B,_){for(var T in B)if(B[T]==_)return!0;return!1},goog.object.findKey=function(B,_,T){for(var E in B)if(_.call(T,B[E],E,B))return E},goog.object.findValue=function(B,_,T){return(_=goog.object.findKey(B,_,T))&&B[_]},goog.object.isEmpty=function(B){for(var _ in B)return!1;return!0},goog.object.clear=function(B){for(var _ in B)delete B[_]},goog.object.remove=function(B,_){var T;return(T=_ in B)&&delete B[_],T},goog.object.add=function(B,_,T){if(B!==null&&_ in B)throw Error('The object already contains the key "'+_+'"');goog.object.set(B,_,T)},goog.object.get=function(B,_,T){return B!==null&&_ in B?B[_]:T},goog.object.set=function(B,_,T){B[_]=T},goog.object.setIfUndefined=function(B,_,T){return _ in B?B[_]:B[_]=T},goog.object.setWithReturnValueIfNotSet=function(B,_,T){return _ in B?B[_]:(T=T(),B[_]=T)},goog.object.equals=function(B,_){for(var T in B)if(!(T in _)||B[T]!==_[T])return!1;for(var E in _)if(!(E in B))return!1;return!0},goog.object.clone=function(B){var _={},T;for(T in B)_[T]=B[T];return _},goog.object.unsafeClone=function(B){var _=goog.typeOf(B);if(_=="object"||_=="array"){if(goog.isFunction(B.clone))return B.clone();_=_=="array"?[]:{};for(var T in B)_[T]=goog.object.unsafeClone(B[T]);return _}return B},goog.object.transpose=function(B){var _={},T;for(T in B)_[B[T]]=T;return _},goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),goog.object.extend=function(B,_){for(var T,E,W=1;W<arguments.length;W++){E=arguments[W];for(T in E)B[T]=E[T];for(var X=0;X<goog.object.PROTOTYPE_FIELDS_.length;X++)T=goog.object.PROTOTYPE_FIELDS_[X],Object.prototype.hasOwnProperty.call(E,T)&&(B[T]=E[T])}},goog.object.create=function(B){var _=arguments.length;if(_==1&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(_%2)throw Error("Uneven number of arguments");for(var T={},E=0;E<_;E+=2)T[arguments[E]]=arguments[E+1];return T},goog.object.createSet=function(B){var _=arguments.length;if(_==1&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var T={},E=0;E<_;E++)T[arguments[E]]=!0;return T},goog.object.createImmutableView=function(B){var _=B;return Object.isFrozen&&!Object.isFrozen(B)&&(_=Object.create(B),Object.freeze(_)),_},goog.object.isImmutableView=function(B){return!!Object.isFrozen&&Object.isFrozen(B)},goog.object.getAllPropertyNames=function(B,_,T){if(!B)return[];if(!Object.getOwnPropertyNames||!Object.getPrototypeOf)return goog.object.getKeys(B);for(var E={};B&&(B!==Object.prototype||_)&&(B!==Function.prototype||T);){for(var W=Object.getOwnPropertyNames(B),X=0;X<W.length;X++)E[W[X]]=!0;B=Object.getPrototypeOf(B)}return goog.object.getKeys(E)},goog.object.getSuperClass=function(B){return(B=Object.getPrototypeOf(B.prototype))&&B.constructor},goog.debug={},goog.debug.Error=function(B){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var _=Error().stack;_&&(this.stack=_)}B&&(this.message=String(B)),this.reportErrorToServer=!0},goog.inherits(goog.debug.Error,Error),goog.debug.Error.prototype.name="CustomError",goog.dom={},goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},goog.asserts={},goog.asserts.ENABLE_ASSERTS=goog.DEBUG,goog.asserts.AssertionError=function(B,_){goog.debug.Error.call(this,goog.asserts.subs_(B,_)),this.messagePattern=B},goog.inherits(goog.asserts.AssertionError,goog.debug.Error),goog.asserts.AssertionError.prototype.name="AssertionError",goog.asserts.DEFAULT_ERROR_HANDLER=function(B){throw B},goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER,goog.asserts.subs_=function(B,_){B=B.split("%s");for(var T="",E=B.length-1,W=0;W<E;W++)T+=B[W]+(W<_.length?_[W]:"%s");return T+B[E]},goog.asserts.doAssertFailure_=function(B,_,T,E){var W="Assertion failed";if(T){W+=": "+T;var X=E}else B&&(W+=": "+B,X=_);B=new goog.asserts.AssertionError(""+W,X||[]),goog.asserts.errorHandler_(B)},goog.asserts.setErrorHandler=function(B){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=B)},goog.asserts.assert=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&!B&&goog.asserts.doAssertFailure_("",null,_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertExists=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&B==null&&goog.asserts.doAssertFailure_("Expected to exist: %s.",[B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.fail=function(B,_){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(B?": "+B:""),Array.prototype.slice.call(arguments,1)))},goog.asserts.assertNumber=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(B)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(B),B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertString=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&!goog.isString(B)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(B),B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertFunction=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(B)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(B),B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertObject=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&!goog.isObject(B)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(B),B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertArray=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&!goog.isArray(B)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(B),B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertBoolean=function(B,_,T){return goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(B)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(B),B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertElement=function(B,_,T){return!goog.asserts.ENABLE_ASSERTS||goog.isObject(B)&&B.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(B),B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertInstanceof=function(B,_,T,E){return!goog.asserts.ENABLE_ASSERTS||B instanceof _||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(_),goog.asserts.getType_(B)],T,Array.prototype.slice.call(arguments,3)),B},goog.asserts.assertFinite=function(B,_,T){return!goog.asserts.ENABLE_ASSERTS||typeof B=="number"&&isFinite(B)||goog.asserts.doAssertFailure_("Expected %s to be a finite number but it is not.",[B],_,Array.prototype.slice.call(arguments,2)),B},goog.asserts.assertObjectPrototypeIsIntact=function(){for(var B in Object.prototype)goog.asserts.fail(B+" should not be enumerable in Object.prototype.")},goog.asserts.getType_=function(B){return B instanceof Function?B.displayName||B.name||"unknown type name":B instanceof Object?B.constructor.displayName||B.constructor.name||Object.prototype.toString.call(B):B===null?"null":typeof B};var jspb={BinaryConstants:{},ConstBinaryMessage:function(){},BinaryMessage:function(){}};jspb.BinaryConstants.FieldType={INVALID:-1,DOUBLE:1,FLOAT:2,INT64:3,UINT64:4,INT32:5,FIXED64:6,FIXED32:7,BOOL:8,STRING:9,GROUP:10,MESSAGE:11,BYTES:12,UINT32:13,ENUM:14,SFIXED32:15,SFIXED64:16,SINT32:17,SINT64:18,FHASH64:30,VHASH64:31},jspb.BinaryConstants.WireType={INVALID:-1,VARINT:0,FIXED64:1,DELIMITED:2,START_GROUP:3,END_GROUP:4,FIXED32:5},jspb.BinaryConstants.FieldTypeToWireType=function(B){var _=jspb.BinaryConstants.FieldType,T=jspb.BinaryConstants.WireType;switch(B){case _.INT32:case _.INT64:case _.UINT32:case _.UINT64:case _.SINT32:case _.SINT64:case _.BOOL:case _.ENUM:case _.VHASH64:return T.VARINT;case _.DOUBLE:case _.FIXED64:case _.SFIXED64:case _.FHASH64:return T.FIXED64;case _.STRING:case _.MESSAGE:case _.BYTES:return T.DELIMITED;case _.FLOAT:case _.FIXED32:case _.SFIXED32:return T.FIXED32;default:return T.INVALID}},jspb.BinaryConstants.INVALID_FIELD_NUMBER=-1,jspb.BinaryConstants.FLOAT32_EPS=1401298464324817e-60,jspb.BinaryConstants.FLOAT32_MIN=11754943508222875e-54,jspb.BinaryConstants.FLOAT32_MAX=34028234663852886e22,jspb.BinaryConstants.FLOAT64_EPS=5e-324,jspb.BinaryConstants.FLOAT64_MIN=22250738585072014e-324,jspb.BinaryConstants.FLOAT64_MAX=17976931348623157e292,jspb.BinaryConstants.TWO_TO_20=1048576,jspb.BinaryConstants.TWO_TO_23=8388608,jspb.BinaryConstants.TWO_TO_31=2147483648,jspb.BinaryConstants.TWO_TO_32=4294967296,jspb.BinaryConstants.TWO_TO_52=4503599627370496,jspb.BinaryConstants.TWO_TO_63=9223372036854776e3,jspb.BinaryConstants.TWO_TO_64=18446744073709552e3,jspb.BinaryConstants.ZERO_HASH="\0\0\0\0\0\0\0\0",goog.array={},goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE,goog.array.ASSUME_NATIVE_FUNCTIONS=2012<goog.FEATURESET_YEAR,goog.array.peek=function(B){return B[B.length-1]},goog.array.last=goog.array.peek,goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.indexOf)?function(B,_,T){return goog.asserts.assert(B.length!=null),Array.prototype.indexOf.call(B,_,T)}:function(B,_,T){if(T=T==null?0:0>T?Math.max(0,B.length+T):T,goog.isString(B))return goog.isString(_)&&_.length==1?B.indexOf(_,T):-1;for(;T<B.length;T++)if(T in B&&B[T]===_)return T;return-1},goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.lastIndexOf)?function(B,_,T){return goog.asserts.assert(B.length!=null),Array.prototype.lastIndexOf.call(B,_,T??B.length-1)}:function(B,_,T){if(T=T??B.length-1,0>T&&(T=Math.max(0,B.length+T)),goog.isString(B))return goog.isString(_)&&_.length==1?B.lastIndexOf(_,T):-1;for(;0<=T;T--)if(T in B&&B[T]===_)return T;return-1},goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.forEach)?function(B,_,T){goog.asserts.assert(B.length!=null),Array.prototype.forEach.call(B,_,T)}:function(B,_,T){for(var E=B.length,W=goog.isString(B)?B.split(""):B,X=0;X<E;X++)X in W&&_.call(T,W[X],X,B)},goog.array.forEachRight=function(B,_,T){var E=B.length,W=goog.isString(B)?B.split(""):B;for(--E;0<=E;--E)E in W&&_.call(T,W[E],E,B)},goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.filter)?function(B,_,T){return goog.asserts.assert(B.length!=null),Array.prototype.filter.call(B,_,T)}:function(B,_,T){for(var E=B.length,W=[],X=0,q=goog.isString(B)?B.split(""):B,Y=0;Y<E;Y++)if(Y in q){var te=q[Y];_.call(T,te,Y,B)&&(W[X++]=te)}return W},goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.map)?function(B,_,T){return goog.asserts.assert(B.length!=null),Array.prototype.map.call(B,_,T)}:function(B,_,T){for(var E=B.length,W=Array(E),X=goog.isString(B)?B.split(""):B,q=0;q<E;q++)q in X&&(W[q]=_.call(T,X[q],q,B));return W},goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduce)?function(B,_,T,E){return goog.asserts.assert(B.length!=null),E&&(_=goog.bind(_,E)),Array.prototype.reduce.call(B,_,T)}:function(B,_,T,E){var W=T;return goog.array.forEach(B,function(X,q){W=_.call(E,W,X,q,B)}),W},goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.reduceRight)?function(B,_,T,E){return goog.asserts.assert(B.length!=null),goog.asserts.assert(_!=null),E&&(_=goog.bind(_,E)),Array.prototype.reduceRight.call(B,_,T)}:function(B,_,T,E){var W=T;return goog.array.forEachRight(B,function(X,q){W=_.call(E,W,X,q,B)}),W},goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.some)?function(B,_,T){return goog.asserts.assert(B.length!=null),Array.prototype.some.call(B,_,T)}:function(B,_,T){for(var E=B.length,W=goog.isString(B)?B.split(""):B,X=0;X<E;X++)if(X in W&&_.call(T,W[X],X,B))return!0;return!1},goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||Array.prototype.every)?function(B,_,T){return goog.asserts.assert(B.length!=null),Array.prototype.every.call(B,_,T)}:function(B,_,T){for(var E=B.length,W=goog.isString(B)?B.split(""):B,X=0;X<E;X++)if(X in W&&!_.call(T,W[X],X,B))return!1;return!0},goog.array.count=function(B,_,T){var E=0;return goog.array.forEach(B,function(W,X,q){_.call(T,W,X,q)&&++E},T),E},goog.array.find=function(B,_,T){return _=goog.array.findIndex(B,_,T),0>_?null:goog.isString(B)?B.charAt(_):B[_]},goog.array.findIndex=function(B,_,T){for(var E=B.length,W=goog.isString(B)?B.split(""):B,X=0;X<E;X++)if(X in W&&_.call(T,W[X],X,B))return X;return-1},goog.array.findRight=function(B,_,T){return _=goog.array.findIndexRight(B,_,T),0>_?null:goog.isString(B)?B.charAt(_):B[_]},goog.array.findIndexRight=function(B,_,T){var E=B.length,W=goog.isString(B)?B.split(""):B;for(--E;0<=E;E--)if(E in W&&_.call(T,W[E],E,B))return E;return-1},goog.array.contains=function(B,_){return 0<=goog.array.indexOf(B,_)},goog.array.isEmpty=function(B){return B.length==0},goog.array.clear=function(B){if(!goog.isArray(B))for(var _=B.length-1;0<=_;_--)delete B[_];B.length=0},goog.array.insert=function(B,_){goog.array.contains(B,_)||B.push(_)},goog.array.insertAt=function(B,_,T){goog.array.splice(B,T,0,_)},goog.array.insertArrayAt=function(B,_,T){goog.partial(goog.array.splice,B,T,0).apply(null,_)},goog.array.insertBefore=function(B,_,T){var E;arguments.length==2||0>(E=goog.array.indexOf(B,T))?B.push(_):goog.array.insertAt(B,_,E)},goog.array.remove=function(B,_){_=goog.array.indexOf(B,_);var T;return(T=0<=_)&&goog.array.removeAt(B,_),T},goog.array.removeLast=function(B,_){return _=goog.array.lastIndexOf(B,_),0<=_?(goog.array.removeAt(B,_),!0):!1},goog.array.removeAt=function(B,_){return goog.asserts.assert(B.length!=null),Array.prototype.splice.call(B,_,1).length==1},goog.array.removeIf=function(B,_,T){return _=goog.array.findIndex(B,_,T),0<=_?(goog.array.removeAt(B,_),!0):!1},goog.array.removeAllIf=function(B,_,T){var E=0;return goog.array.forEachRight(B,function(W,X){_.call(T,W,X,B)&&goog.array.removeAt(B,X)&&E++}),E},goog.array.concat=function(B){return Array.prototype.concat.apply([],arguments)},goog.array.join=function(B){return Array.prototype.concat.apply([],arguments)},goog.array.toArray=function(B){var _=B.length;if(0<_){for(var T=Array(_),E=0;E<_;E++)T[E]=B[E];return T}return[]},goog.array.clone=goog.array.toArray,goog.array.extend=function(B,_){for(var T=1;T<arguments.length;T++){var E=arguments[T];if(goog.isArrayLike(E)){var W=B.length||0,X=E.length||0;B.length=W+X;for(var q=0;q<X;q++)B[W+q]=E[q]}else B.push(E)}},goog.array.splice=function(B,_,T,E){return goog.asserts.assert(B.length!=null),Array.prototype.splice.apply(B,goog.array.slice(arguments,1))},goog.array.slice=function(B,_,T){return goog.asserts.assert(B.length!=null),2>=arguments.length?Array.prototype.slice.call(B,_):Array.prototype.slice.call(B,_,T)},goog.array.removeDuplicates=function(B,_,T){_=_||B;var E=function(te){return goog.isObject(te)?"o"+goog.getUid(te):(typeof te).charAt(0)+te};T=T||E,E={};for(var W=0,X=0;X<B.length;){var q=B[X++],Y=T(q);Object.prototype.hasOwnProperty.call(E,Y)||(E[Y]=!0,_[W++]=q)}_.length=W},goog.array.binarySearch=function(B,_,T){return goog.array.binarySearch_(B,T||goog.array.defaultCompare,!1,_)},goog.array.binarySelect=function(B,_,T){return goog.array.binarySearch_(B,_,!0,void 0,T)},goog.array.binarySearch_=function(B,_,T,E,W){for(var X=0,q=B.length,Y;X<q;){var te=X+q>>1,ne=T?_.call(W,B[te],te,B):_(E,B[te]);0<ne?X=te+1:(q=te,Y=!ne)}return Y?X:~X},goog.array.sort=function(B,_){B.sort(_||goog.array.defaultCompare)},goog.array.stableSort=function(B,_){for(var T=Array(B.length),E=0;E<B.length;E++)T[E]={index:E,value:B[E]};var W=_||goog.array.defaultCompare;for(goog.array.sort(T,function(X,q){return W(X.value,q.value)||X.index-q.index}),E=0;E<B.length;E++)B[E]=T[E].value},goog.array.sortByKey=function(B,_,T){var E=T||goog.array.defaultCompare;goog.array.sort(B,function(W,X){return E(_(W),_(X))})},goog.array.sortObjectsByKey=function(B,_,T){goog.array.sortByKey(B,function(E){return E[_]},T)},goog.array.isSorted=function(B,_,T){_=_||goog.array.defaultCompare;for(var E=1;E<B.length;E++){var W=_(B[E-1],B[E]);if(0<W||W==0&&T)return!1}return!0},goog.array.equals=function(B,_,T){if(!goog.isArrayLike(B)||!goog.isArrayLike(_)||B.length!=_.length)return!1;var E=B.length;T=T||goog.array.defaultCompareEquality;for(var W=0;W<E;W++)if(!T(B[W],_[W]))return!1;return!0},goog.array.compare3=function(B,_,T){T=T||goog.array.defaultCompare;for(var E=Math.min(B.length,_.length),W=0;W<E;W++){var X=T(B[W],_[W]);if(X!=0)return X}return goog.array.defaultCompare(B.length,_.length)},goog.array.defaultCompare=function(B,_){return B>_?1:B<_?-1:0},goog.array.inverseDefaultCompare=function(B,_){return-goog.array.defaultCompare(B,_)},goog.array.defaultCompareEquality=function(B,_){return B===_},goog.array.binaryInsert=function(B,_,T){return T=goog.array.binarySearch(B,_,T),0>T?(goog.array.insertAt(B,_,-(T+1)),!0):!1},goog.array.binaryRemove=function(B,_,T){return _=goog.array.binarySearch(B,_,T),0<=_?goog.array.removeAt(B,_):!1},goog.array.bucket=function(B,_,T){for(var E={},W=0;W<B.length;W++){var X=B[W],q=_.call(T,X,W,B);goog.isDef(q)&&(E[q]||(E[q]=[])).push(X)}return E},goog.array.toObject=function(B,_,T){var E={};return goog.array.forEach(B,function(W,X){E[_.call(T,W,X,B)]=W}),E},goog.array.range=function(B,_,T){var E=[],W=0,X=B;if(T=T||1,_!==void 0&&(W=B,X=_),0>T*(X-W))return[];if(0<T)for(B=W;B<X;B+=T)E.push(B);else for(B=W;B>X;B+=T)E.push(B);return E},goog.array.repeat=function(B,_){for(var T=[],E=0;E<_;E++)T[E]=B;return T},goog.array.flatten=function(B){for(var _=[],T=0;T<arguments.length;T++){var E=arguments[T];if(goog.isArray(E))for(var W=0;W<E.length;W+=8192){var X=goog.array.slice(E,W,W+8192);X=goog.array.flatten.apply(null,X);for(var q=0;q<X.length;q++)_.push(X[q])}else _.push(E)}return _},goog.array.rotate=function(B,_){return goog.asserts.assert(B.length!=null),B.length&&(_%=B.length,0<_?Array.prototype.unshift.apply(B,B.splice(-_,_)):0>_&&Array.prototype.push.apply(B,B.splice(0,-_))),B},goog.array.moveItem=function(B,_,T){goog.asserts.assert(0<=_&&_<B.length),goog.asserts.assert(0<=T&&T<B.length),_=Array.prototype.splice.call(B,_,1),Array.prototype.splice.call(B,T,0,_[0])},goog.array.zip=function(B){if(!arguments.length)return[];for(var _=[],T=arguments[0].length,E=1;E<arguments.length;E++)arguments[E].length<T&&(T=arguments[E].length);for(E=0;E<T;E++){for(var W=[],X=0;X<arguments.length;X++)W.push(arguments[X][E]);_.push(W)}return _},goog.array.shuffle=function(B,_){_=_||Math.random;for(var T=B.length-1;0<T;T--){var E=Math.floor(_()*(T+1)),W=B[T];B[T]=B[E],B[E]=W}},goog.array.copyByIndex=function(B,_){var T=[];return goog.array.forEach(_,function(E){T.push(B[E])}),T},goog.array.concatMap=function(B,_,T){return goog.array.concat.apply([],goog.array.map(B,_,T))},goog.crypt={},goog.crypt.stringToByteArray=function(B){for(var _=[],T=0,E=0;E<B.length;E++){var W=B.charCodeAt(E);255<W&&(_[T++]=W&255,W>>=8),_[T++]=W}return _},goog.crypt.byteArrayToString=function(B){if(8192>=B.length)return String.fromCharCode.apply(null,B);for(var _="",T=0;T<B.length;T+=8192){var E=goog.array.slice(B,T,T+8192);_+=String.fromCharCode.apply(null,E)}return _},goog.crypt.byteArrayToHex=function(B,_){return goog.array.map(B,function(T){return T=T.toString(16),1<T.length?T:"0"+T}).join(_||"")},goog.crypt.hexToByteArray=function(B){goog.asserts.assert(B.length%2==0,"Key string length must be multiple of 2");for(var _=[],T=0;T<B.length;T+=2)_.push(parseInt(B.substring(T,T+2),16));return _},goog.crypt.stringToUtf8ByteArray=function(B){for(var _=[],T=0,E=0;E<B.length;E++){var W=B.charCodeAt(E);128>W?_[T++]=W:(2048>W?_[T++]=W>>6|192:((W&64512)==55296&&E+1<B.length&&(B.charCodeAt(E+1)&64512)==56320?(W=65536+((W&1023)<<10)+(B.charCodeAt(++E)&1023),_[T++]=W>>18|240,_[T++]=W>>12&63|128):_[T++]=W>>12|224,_[T++]=W>>6&63|128),_[T++]=W&63|128)}return _},goog.crypt.utf8ByteArrayToString=function(B){for(var _=[],T=0,E=0;T<B.length;){var W=B[T++];if(128>W)_[E++]=String.fromCharCode(W);else if(191<W&&224>W){var X=B[T++];_[E++]=String.fromCharCode((W&31)<<6|X&63)}else if(239<W&&365>W){X=B[T++];var q=B[T++],Y=B[T++];W=((W&7)<<18|(X&63)<<12|(q&63)<<6|Y&63)-65536,_[E++]=String.fromCharCode(55296+(W>>10)),_[E++]=String.fromCharCode(56320+(W&1023))}else X=B[T++],q=B[T++],_[E++]=String.fromCharCode((W&15)<<12|(X&63)<<6|q&63)}return _.join("")},goog.crypt.xorByteArray=function(B,_){goog.asserts.assert(B.length==_.length,"XOR array lengths must match");for(var T=[],E=0;E<B.length;E++)T.push(B[E]^_[E]);return T},goog.dom.asserts={},goog.dom.asserts.assertIsLocation=function(B){if(goog.asserts.ENABLE_ASSERTS){var _=goog.dom.asserts.getWindow_(B);_&&(!B||!(B instanceof _.Location)&&B instanceof _.Element)&&goog.asserts.fail("Argument is not a Location (or a non-Element mock); got: %s",goog.dom.asserts.debugStringForType_(B))}return B},goog.dom.asserts.assertIsElementType_=function(B,_){if(goog.asserts.ENABLE_ASSERTS){var T=goog.dom.asserts.getWindow_(B);T&&typeof T[_]<"u"&&(B&&(B instanceof T[_]||!(B instanceof T.Location||B instanceof T.Element))||goog.asserts.fail("Argument is not a %s (or a non-Element, non-Location mock); got: %s",_,goog.dom.asserts.debugStringForType_(B)))}return B},goog.dom.asserts.assertIsHTMLAnchorElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLAnchorElement")},goog.dom.asserts.assertIsHTMLButtonElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLButtonElement")},goog.dom.asserts.assertIsHTMLLinkElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLLinkElement")},goog.dom.asserts.assertIsHTMLImageElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLImageElement")},goog.dom.asserts.assertIsHTMLAudioElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLAudioElement")},goog.dom.asserts.assertIsHTMLVideoElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLVideoElement")},goog.dom.asserts.assertIsHTMLInputElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLInputElement")},goog.dom.asserts.assertIsHTMLTextAreaElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLTextAreaElement")},goog.dom.asserts.assertIsHTMLCanvasElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLCanvasElement")},goog.dom.asserts.assertIsHTMLEmbedElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLEmbedElement")},goog.dom.asserts.assertIsHTMLFormElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLFormElement")},goog.dom.asserts.assertIsHTMLFrameElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLFrameElement")},goog.dom.asserts.assertIsHTMLIFrameElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLIFrameElement")},goog.dom.asserts.assertIsHTMLObjectElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLObjectElement")},goog.dom.asserts.assertIsHTMLScriptElement=function(B){return goog.dom.asserts.assertIsElementType_(B,"HTMLScriptElement")},goog.dom.asserts.debugStringForType_=function(B){if(goog.isObject(B))try{return B.constructor.displayName||B.constructor.name||Object.prototype.toString.call(B)}catch{return"<object could not be stringified>"}else return B===void 0?"undefined":B===null?"null":typeof B},goog.dom.asserts.getWindow_=function(B){try{var _=B&&B.ownerDocument,T=_&&(_.defaultView||_.parentWindow);if(T=T||goog.global,T.Element&&T.Location)return T}catch{}return null},goog.functions={},goog.functions.constant=function(B){return function(){return B}},goog.functions.FALSE=function(){return!1},goog.functions.TRUE=function(){return!0},goog.functions.NULL=function(){return null},goog.functions.identity=function(B,_){return B},goog.functions.error=function(B){return function(){throw Error(B)}},goog.functions.fail=function(B){return function(){throw B}},goog.functions.lock=function(B,_){return _=_||0,function(){return B.apply(this,Array.prototype.slice.call(arguments,0,_))}},goog.functions.nth=function(B){return function(){return arguments[B]}},goog.functions.partialRight=function(B,_){var T=Array.prototype.slice.call(arguments,1);return function(){var E=Array.prototype.slice.call(arguments);return E.push.apply(E,T),B.apply(this,E)}},goog.functions.withReturnValue=function(B,_){return goog.functions.sequence(B,goog.functions.constant(_))},goog.functions.equalTo=function(B,_){return function(T){return _?B==T:B===T}},goog.functions.compose=function(B,_){var T=arguments,E=T.length;return function(){var W;E&&(W=T[E-1].apply(this,arguments));for(var X=E-2;0<=X;X--)W=T[X].call(this,W);return W}},goog.functions.sequence=function(B){var _=arguments,T=_.length;return function(){for(var E,W=0;W<T;W++)E=_[W].apply(this,arguments);return E}},goog.functions.and=function(B){var _=arguments,T=_.length;return function(){for(var E=0;E<T;E++)if(!_[E].apply(this,arguments))return!1;return!0}},goog.functions.or=function(B){var _=arguments,T=_.length;return function(){for(var E=0;E<T;E++)if(_[E].apply(this,arguments))return!0;return!1}},goog.functions.not=function(B){return function(){return!B.apply(this,arguments)}},goog.functions.create=function(B,_){var T=function(){};return T.prototype=B.prototype,T=new T,B.apply(T,Array.prototype.slice.call(arguments,1)),T},goog.functions.CACHE_RETURN_VALUE=!0,goog.functions.cacheReturnValue=function(B){var _=!1,T;return function(){return goog.functions.CACHE_RETURN_VALUE?(_||(T=B(),_=!0),T):B()}},goog.functions.once=function(B){var _=B;return function(){if(_){var T=_;_=null,T()}}},goog.functions.debounce=function(B,_,T){var E=0;return function(W){goog.global.clearTimeout(E);var X=arguments;E=goog.global.setTimeout(function(){B.apply(T,X)},_)}},goog.functions.throttle=function(B,_,T){var E=0,W=!1,X=[],q=function(){E=0,W&&(W=!1,Y())},Y=function(){E=goog.global.setTimeout(q,_),B.apply(T,X)};return function(te){X=arguments,E?W=!0:Y()}},goog.functions.rateLimit=function(B,_,T){var E=0,W=function(){E=0};return function(X){E||(E=goog.global.setTimeout(W,_),B.apply(T,arguments))}},goog.dom.HtmlElement=function(){},goog.dom.TagName=function(B){this.tagName_=B},goog.dom.TagName.prototype.toString=function(){return this.tagName_},goog.dom.TagName.A=new goog.dom.TagName("A"),goog.dom.TagName.ABBR=new goog.dom.TagName("ABBR"),goog.dom.TagName.ACRONYM=new goog.dom.TagName("ACRONYM"),goog.dom.TagName.ADDRESS=new goog.dom.TagName("ADDRESS"),goog.dom.TagName.APPLET=new goog.dom.TagName("APPLET"),goog.dom.TagName.AREA=new goog.dom.TagName("AREA"),goog.dom.TagName.ARTICLE=new goog.dom.TagName("ARTICLE"),goog.dom.TagName.ASIDE=new goog.dom.TagName("ASIDE"),goog.dom.TagName.AUDIO=new goog.dom.TagName("AUDIO"),goog.dom.TagName.B=new goog.dom.TagName("B"),goog.dom.TagName.BASE=new goog.dom.TagName("BASE"),goog.dom.TagName.BASEFONT=new goog.dom.TagName("BASEFONT"),goog.dom.TagName.BDI=new goog.dom.TagName("BDI"),goog.dom.TagName.BDO=new goog.dom.TagName("BDO"),goog.dom.TagName.BIG=new goog.dom.TagName("BIG"),goog.dom.TagName.BLOCKQUOTE=new goog.dom.TagName("BLOCKQUOTE"),goog.dom.TagName.BODY=new goog.dom.TagName("BODY"),goog.dom.TagName.BR=new goog.dom.TagName("BR"),goog.dom.TagName.BUTTON=new goog.dom.TagName("BUTTON"),goog.dom.TagName.CANVAS=new goog.dom.TagName("CANVAS"),goog.dom.TagName.CAPTION=new goog.dom.TagName("CAPTION"),goog.dom.TagName.CENTER=new goog.dom.TagName("CENTER"),goog.dom.TagName.CITE=new goog.dom.TagName("CITE"),goog.dom.TagName.CODE=new goog.dom.TagName("CODE"),goog.dom.TagName.COL=new goog.dom.TagName("COL"),goog.dom.TagName.COLGROUP=new goog.dom.TagName("COLGROUP"),goog.dom.TagName.COMMAND=new goog.dom.TagName("COMMAND"),goog.dom.TagName.DATA=new goog.dom.TagName("DATA"),goog.dom.TagName.DATALIST=new goog.dom.TagName("DATALIST"),goog.dom.TagName.DD=new goog.dom.TagName("DD"),goog.dom.TagName.DEL=new goog.dom.TagName("DEL"),goog.dom.TagName.DETAILS=new goog.dom.TagName("DETAILS"),goog.dom.TagName.DFN=new goog.dom.TagName("DFN"),goog.dom.TagName.DIALOG=new goog.dom.TagName("DIALOG"),goog.dom.TagName.DIR=new goog.dom.TagName("DIR"),goog.dom.TagName.DIV=new goog.dom.TagName("DIV"),goog.dom.TagName.DL=new goog.dom.TagName("DL"),goog.dom.TagName.DT=new goog.dom.TagName("DT"),goog.dom.TagName.EM=new goog.dom.TagName("EM"),goog.dom.TagName.EMBED=new goog.dom.TagName("EMBED"),goog.dom.TagName.FIELDSET=new goog.dom.TagName("FIELDSET"),goog.dom.TagName.FIGCAPTION=new goog.dom.TagName("FIGCAPTION"),goog.dom.TagName.FIGURE=new goog.dom.TagName("FIGURE"),goog.dom.TagName.FONT=new goog.dom.TagName("FONT"),goog.dom.TagName.FOOTER=new goog.dom.TagName("FOOTER"),goog.dom.TagName.FORM=new goog.dom.TagName("FORM"),goog.dom.TagName.FRAME=new goog.dom.TagName("FRAME"),goog.dom.TagName.FRAMESET=new goog.dom.TagName("FRAMESET"),goog.dom.TagName.H1=new goog.dom.TagName("H1"),goog.dom.TagName.H2=new goog.dom.TagName("H2"),goog.dom.TagName.H3=new goog.dom.TagName("H3"),goog.dom.TagName.H4=new goog.dom.TagName("H4"),goog.dom.TagName.H5=new goog.dom.TagName("H5"),goog.dom.TagName.H6=new goog.dom.TagName("H6"),goog.dom.TagName.HEAD=new goog.dom.TagName("HEAD"),goog.dom.TagName.HEADER=new goog.dom.TagName("HEADER"),goog.dom.TagName.HGROUP=new goog.dom.TagName("HGROUP"),goog.dom.TagName.HR=new goog.dom.TagName("HR"),goog.dom.TagName.HTML=new goog.dom.TagName("HTML"),goog.dom.TagName.I=new goog.dom.TagName("I"),goog.dom.TagName.IFRAME=new goog.dom.TagName("IFRAME"),goog.dom.TagName.IMG=new goog.dom.TagName("IMG"),goog.dom.TagName.INPUT=new goog.dom.TagName("INPUT"),goog.dom.TagName.INS=new goog.dom.TagName("INS"),goog.dom.TagName.ISINDEX=new goog.dom.TagName("ISINDEX"),goog.dom.TagName.KBD=new goog.dom.TagName("KBD"),goog.dom.TagName.KEYGEN=new goog.dom.TagName("KEYGEN"),goog.dom.TagName.LABEL=new goog.dom.TagName("LABEL"),goog.dom.TagName.LEGEND=new goog.dom.TagName("LEGEND"),goog.dom.TagName.LI=new goog.dom.TagName("LI"),goog.dom.TagName.LINK=new goog.dom.TagName("LINK"),goog.dom.TagName.MAIN=new goog.dom.TagName("MAIN"),goog.dom.TagName.MAP=new goog.dom.TagName("MAP"),goog.dom.TagName.MARK=new goog.dom.TagName("MARK"),goog.dom.TagName.MATH=new goog.dom.TagName("MATH"),goog.dom.TagName.MENU=new goog.dom.TagName("MENU"),goog.dom.TagName.MENUITEM=new goog.dom.TagName("MENUITEM"),goog.dom.TagName.META=new goog.dom.TagName("META"),goog.dom.TagName.METER=new goog.dom.TagName("METER"),goog.dom.TagName.NAV=new goog.dom.TagName("NAV"),goog.dom.TagName.NOFRAMES=new goog.dom.TagName("NOFRAMES"),goog.dom.TagName.NOSCRIPT=new goog.dom.TagName("NOSCRIPT"),goog.dom.TagName.OBJECT=new goog.dom.TagName("OBJECT"),goog.dom.TagName.OL=new goog.dom.TagName("OL"),goog.dom.TagName.OPTGROUP=new goog.dom.TagName("OPTGROUP"),goog.dom.TagName.OPTION=new goog.dom.TagName("OPTION"),goog.dom.TagName.OUTPUT=new goog.dom.TagName("OUTPUT"),goog.dom.TagName.P=new goog.dom.TagName("P"),goog.dom.TagName.PARAM=new goog.dom.TagName("PARAM"),goog.dom.TagName.PICTURE=new goog.dom.TagName("PICTURE"),goog.dom.TagName.PRE=new goog.dom.TagName("PRE"),goog.dom.TagName.PROGRESS=new goog.dom.TagName("PROGRESS"),goog.dom.TagName.Q=new goog.dom.TagName("Q"),goog.dom.TagName.RP=new goog.dom.TagName("RP"),goog.dom.TagName.RT=new goog.dom.TagName("RT"),goog.dom.TagName.RTC=new goog.dom.TagName("RTC"),goog.dom.TagName.RUBY=new goog.dom.TagName("RUBY"),goog.dom.TagName.S=new goog.dom.TagName("S"),goog.dom.TagName.SAMP=new goog.dom.TagName("SAMP"),goog.dom.TagName.SCRIPT=new goog.dom.TagName("SCRIPT"),goog.dom.TagName.SECTION=new goog.dom.TagName("SECTION"),goog.dom.TagName.SELECT=new goog.dom.TagName("SELECT"),goog.dom.TagName.SMALL=new goog.dom.TagName("SMALL"),goog.dom.TagName.SOURCE=new goog.dom.TagName("SOURCE"),goog.dom.TagName.SPAN=new goog.dom.TagName("SPAN"),goog.dom.TagName.STRIKE=new goog.dom.TagName("STRIKE"),goog.dom.TagName.STRONG=new goog.dom.TagName("STRONG"),goog.dom.TagName.STYLE=new goog.dom.TagName("STYLE"),goog.dom.TagName.SUB=new goog.dom.TagName("SUB"),goog.dom.TagName.SUMMARY=new goog.dom.TagName("SUMMARY"),goog.dom.TagName.SUP=new goog.dom.TagName("SUP"),goog.dom.TagName.SVG=new goog.dom.TagName("SVG"),goog.dom.TagName.TABLE=new goog.dom.TagName("TABLE"),goog.dom.TagName.TBODY=new goog.dom.TagName("TBODY"),goog.dom.TagName.TD=new goog.dom.TagName("TD"),goog.dom.TagName.TEMPLATE=new goog.dom.TagName("TEMPLATE"),goog.dom.TagName.TEXTAREA=new goog.dom.TagName("TEXTAREA"),goog.dom.TagName.TFOOT=new goog.dom.TagName("TFOOT"),goog.dom.TagName.TH=new goog.dom.TagName("TH"),goog.dom.TagName.THEAD=new goog.dom.TagName("THEAD"),goog.dom.TagName.TIME=new goog.dom.TagName("TIME"),goog.dom.TagName.TITLE=new goog.dom.TagName("TITLE"),goog.dom.TagName.TR=new goog.dom.TagName("TR"),goog.dom.TagName.TRACK=new goog.dom.TagName("TRACK"),goog.dom.TagName.TT=new goog.dom.TagName("TT"),goog.dom.TagName.U=new goog.dom.TagName("U"),goog.dom.TagName.UL=new goog.dom.TagName("UL"),goog.dom.TagName.VAR=new goog.dom.TagName("VAR"),goog.dom.TagName.VIDEO=new goog.dom.TagName("VIDEO"),goog.dom.TagName.WBR=new goog.dom.TagName("WBR"),goog.dom.tags={},goog.dom.tags.VOID_TAGS_={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},goog.dom.tags.isVoidTag=function(B){return goog.dom.tags.VOID_TAGS_[B]===!0},goog.html={},goog.html.trustedtypes={},goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#html"):null,goog.string={},goog.string.TypedString=function(){},goog.string.Const=function(B,_){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_=B===goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_&&_||"",this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_},goog.string.Const.prototype.implementsGoogStringTypedString=!0,goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_},goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"},goog.string.Const.unwrap=function(B){return B instanceof goog.string.Const&&B.constructor===goog.string.Const&&B.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_?B.stringConstValueWithSecurityContract__googStringSecurityPrivate_:(goog.asserts.fail("expected object of type Const, got '"+B+"'"),"type_error:Const")},goog.string.Const.from=function(B){return new goog.string.Const(goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_,B)},goog.string.Const.TYPE_MARKER_={},goog.string.Const.GOOG_STRING_CONSTRUCTOR_TOKEN_PRIVATE_={},goog.string.Const.EMPTY=goog.string.Const.from(""),goog.html.SafeScript=function(){this.privateDoNotAccessOrElseSafeScriptWrappedValue_="",this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeScript.prototype.implementsGoogStringTypedString=!0,goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeScript.fromConstant=function(B){return B=goog.string.Const.unwrap(B),B.length===0?goog.html.SafeScript.EMPTY:goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(B)},goog.html.SafeScript.fromConstantAndArgs=function(B,_){for(var T=[],E=1;E<arguments.length;E++)T.push(goog.html.SafeScript.stringify_(arguments[E]));return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse("("+goog.string.Const.unwrap(B)+")("+T.join(", ")+");")},goog.html.SafeScript.fromJson=function(B){return goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(goog.html.SafeScript.stringify_(B))},goog.html.SafeScript.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_.toString()},goog.DEBUG&&(goog.html.SafeScript.prototype.toString=function(){return"SafeScript{"+this.privateDoNotAccessOrElseSafeScriptWrappedValue_+"}"}),goog.html.SafeScript.unwrap=function(B){return goog.html.SafeScript.unwrapTrustedScript(B).toString()},goog.html.SafeScript.unwrapTrustedScript=function(B){return B instanceof goog.html.SafeScript&&B.constructor===goog.html.SafeScript&&B.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeScript.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?B.privateDoNotAccessOrElseSafeScriptWrappedValue_:(goog.asserts.fail("expected object of type SafeScript, got '"+B+"' of type "+goog.typeOf(B)),"type_error:SafeScript")},goog.html.SafeScript.stringify_=function(B){return JSON.stringify(B).replace(/</g,"\\x3c")},goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse=function(B){return new goog.html.SafeScript().initSecurityPrivateDoNotAccessOrElse_(B)},goog.html.SafeScript.prototype.initSecurityPrivateDoNotAccessOrElse_=function(B){return this.privateDoNotAccessOrElseSafeScriptWrappedValue_=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY?goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createScript(B):B,this},goog.html.SafeScript.EMPTY=goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(""),goog.fs={},goog.fs.url={},goog.fs.url.createObjectUrl=function(B){return goog.fs.url.getUrlObject_().createObjectURL(B)},goog.fs.url.revokeObjectUrl=function(B){goog.fs.url.getUrlObject_().revokeObjectURL(B)},goog.fs.url.getUrlObject_=function(){var B=goog.fs.url.findUrlObject_();if(B!=null)return B;throw Error("This browser doesn't seem to support blob URLs")},goog.fs.url.findUrlObject_=function(){return goog.isDef(goog.global.URL)&&goog.isDef(goog.global.URL.createObjectURL)?goog.global.URL:goog.isDef(goog.global.webkitURL)&&goog.isDef(goog.global.webkitURL.createObjectURL)?goog.global.webkitURL:goog.isDef(goog.global.createObjectURL)?goog.global:null},goog.fs.url.browserSupportsObjectUrls=function(){return goog.fs.url.findUrlObject_()!=null},goog.i18n={},goog.i18n.bidi={},goog.i18n.bidi.FORCE_RTL=!1,goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||(goog.LOCALE.substring(0,2).toLowerCase()=="ar"||goog.LOCALE.substring(0,2).toLowerCase()=="fa"||goog.LOCALE.substring(0,2).toLowerCase()=="he"||goog.LOCALE.substring(0,2).toLowerCase()=="iw"||goog.LOCALE.substring(0,2).toLowerCase()=="ps"||goog.LOCALE.substring(0,2).toLowerCase()=="sd"||goog.LOCALE.substring(0,2).toLowerCase()=="ug"||goog.LOCALE.substring(0,2).toLowerCase()=="ur"||goog.LOCALE.substring(0,2).toLowerCase()=="yi")&&(goog.LOCALE.length==2||goog.LOCALE.substring(2,3)=="-"||goog.LOCALE.substring(2,3)=="_")||3<=goog.LOCALE.length&&goog.LOCALE.substring(0,3).toLowerCase()=="ckb"&&(goog.LOCALE.length==3||goog.LOCALE.substring(3,4)=="-"||goog.LOCALE.substring(3,4)=="_")||7<=goog.LOCALE.length&&(goog.LOCALE.substring(2,3)=="-"||goog.LOCALE.substring(2,3)=="_")&&(goog.LOCALE.substring(3,7).toLowerCase()=="adlm"||goog.LOCALE.substring(3,7).toLowerCase()=="arab"||goog.LOCALE.substring(3,7).toLowerCase()=="hebr"||goog.LOCALE.substring(3,7).toLowerCase()=="nkoo"||goog.LOCALE.substring(3,7).toLowerCase()=="rohg"||goog.LOCALE.substring(3,7).toLowerCase()=="thaa")||8<=goog.LOCALE.length&&(goog.LOCALE.substring(3,4)=="-"||goog.LOCALE.substring(3,4)=="_")&&(goog.LOCALE.substring(4,8).toLowerCase()=="adlm"||goog.LOCALE.substring(4,8).toLowerCase()=="arab"||goog.LOCALE.substring(4,8).toLowerCase()=="hebr"||goog.LOCALE.substring(4,8).toLowerCase()=="nkoo"||goog.LOCALE.substring(4,8).toLowerCase()=="rohg"||goog.LOCALE.substring(4,8).toLowerCase()=="thaa"),goog.i18n.bidi.Format={LRE:"",RLE:"",PDF:"",LRM:"",RLM:""},goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0},goog.i18n.bidi.RIGHT="right",goog.i18n.bidi.LEFT="left",goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT,goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,goog.i18n.bidi.toDir=function(B,_){return typeof B=="number"?0<B?goog.i18n.bidi.Dir.LTR:0>B?goog.i18n.bidi.Dir.RTL:_?null:goog.i18n.bidi.Dir.NEUTRAL:B==null?null:B?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.ltrChars_="A-Za-z------\uD801\uD804-\uD839\uD83C-\uDBFF---",goog.i18n.bidi.rtlChars_="--\uD802-\uD803\uD83A-\uD83B--",goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g,goog.i18n.bidi.stripHtmlIfNeeded_=function(B,_){return _?B.replace(goog.i18n.bidi.htmlSkipReg_,""):B},goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.hasAnyRtl=function(B,_){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(B,_))},goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl,goog.i18n.bidi.hasAnyLtr=function(B,_){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(B,_))},goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.isRtlChar=function(B){return goog.i18n.bidi.rtlRe_.test(B)},goog.i18n.bidi.isLtrChar=function(B){return goog.i18n.bidi.ltrRe_.test(B)},goog.i18n.bidi.isNeutralChar=function(B){return!goog.i18n.bidi.isLtrChar(B)&&!goog.i18n.bidi.isRtlChar(B)},goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]"),goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]"),goog.i18n.bidi.startsWithRtl=function(B,_){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(B,_))},goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl,goog.i18n.bidi.startsWithLtr=function(B,_){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(B,_))},goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr,goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/,goog.i18n.bidi.isNeutralText=function(B,_){return B=goog.i18n.bidi.stripHtmlIfNeeded_(B,_),goog.i18n.bidi.isRequiredLtrRe_.test(B)||!goog.i18n.bidi.hasAnyLtr(B)&&!goog.i18n.bidi.hasAnyRtl(B)},goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$"),goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$"),goog.i18n.bidi.endsWithLtr=function(B,_){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(B,_))},goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr,goog.i18n.bidi.endsWithRtl=function(B,_){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(B,_))},goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl,goog.i18n.bidi.rtlLocalesRe_=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i,goog.i18n.bidi.isRtlLanguage=function(B){return goog.i18n.bidi.rtlLocalesRe_.test(B)},goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g,goog.i18n.bidi.guardBracketInText=function(B,_){return _=(_===void 0?goog.i18n.bidi.hasAnyRtl(B):_)?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM,B.replace(goog.i18n.bidi.bracketGuardTextRe_,_+"$&"+_)},goog.i18n.bidi.enforceRtlInHtml=function(B){return B.charAt(0)=="<"?B.replace(/<\w+/,"$& dir=rtl"):`
<span dir=rtl>`+B+"</span>"},goog.i18n.bidi.enforceRtlInText=function(B){return goog.i18n.bidi.Format.RLE+B+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.enforceLtrInHtml=function(B){return B.charAt(0)=="<"?B.replace(/<\w+/,"$& dir=ltr"):`
<span dir=ltr>`+B+"</span>"},goog.i18n.bidi.enforceLtrInText=function(B){return goog.i18n.bidi.Format.LRE+B+goog.i18n.bidi.Format.PDF},goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g,goog.i18n.bidi.leftRe_=/left/gi,goog.i18n.bidi.rightRe_=/right/gi,goog.i18n.bidi.tempRe_=/%%%%/g,goog.i18n.bidi.mirrorCSS=function(B){return B.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)},goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g,goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g,goog.i18n.bidi.normalizeHebrewQuote=function(B){return B.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1")},goog.i18n.bidi.wordSeparatorRe_=/\s+/,goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/,goog.i18n.bidi.rtlDetectionThreshold_=.4,goog.i18n.bidi.estimateDirection=function(B,_){var T=0,E=0,W=!1;for(B=goog.i18n.bidi.stripHtmlIfNeeded_(B,_).split(goog.i18n.bidi.wordSeparatorRe_),_=0;_<B.length;_++){var X=B[_];goog.i18n.bidi.startsWithRtl(X)?(T++,E++):goog.i18n.bidi.isRequiredLtrRe_.test(X)?W=!0:goog.i18n.bidi.hasAnyLtr(X)?E++:goog.i18n.bidi.hasNumeralsRe_.test(X)&&(W=!0)}return E==0?W?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:T/E>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.bidi.detectRtlDirectionality=function(B,_){return goog.i18n.bidi.estimateDirection(B,_)==goog.i18n.bidi.Dir.RTL},goog.i18n.bidi.setElementDirAndAlign=function(B,_){B&&(_=goog.i18n.bidi.toDir(_))&&(B.style.textAlign=_==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,B.dir=_==goog.i18n.bidi.Dir.RTL?"rtl":"ltr")},goog.i18n.bidi.setElementDirByTextDirectionality=function(B,_){switch(goog.i18n.bidi.estimateDirection(_)){case goog.i18n.bidi.Dir.LTR:B.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:B.dir="rtl";break;default:B.removeAttribute("dir")}},goog.i18n.bidi.DirectionalString=function(){},goog.html.TrustedResourceUrl=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="",this.trustedURL_=null,this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=!0,goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_.toString()},goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.html.TrustedResourceUrl.prototype.cloneWithParams=function(B,_){var T=goog.html.TrustedResourceUrl.unwrap(this);T=goog.html.TrustedResourceUrl.URL_PARAM_PARSER_.exec(T);var E=T[3]||"";return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(T[1]+goog.html.TrustedResourceUrl.stringifyParams_("?",T[2]||"",B)+goog.html.TrustedResourceUrl.stringifyParams_("#",E,_))},goog.DEBUG&&(goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"}),goog.html.TrustedResourceUrl.unwrap=function(B){return goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(B).toString()},goog.html.TrustedResourceUrl.unwrapTrustedScriptURL=function(B){return B instanceof goog.html.TrustedResourceUrl&&B.constructor===goog.html.TrustedResourceUrl&&B.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?B.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_:(goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+B+"' of type "+goog.typeOf(B)),"type_error:TrustedResourceUrl")},goog.html.TrustedResourceUrl.unwrapTrustedURL=function(B){return B.trustedURL_?B.trustedURL_:goog.html.TrustedResourceUrl.unwrap(B)},goog.html.TrustedResourceUrl.format=function(B,_){var T=goog.string.Const.unwrap(B);if(!goog.html.TrustedResourceUrl.BASE_URL_.test(T))throw Error("Invalid TrustedResourceUrl format: "+T);return B=T.replace(goog.html.TrustedResourceUrl.FORMAT_MARKER_,function(E,W){if(!Object.prototype.hasOwnProperty.call(_,W))throw Error('Found marker, "'+W+'", in format string, "'+T+'", but no valid label mapping found in args: '+JSON.stringify(_));return E=_[W],E instanceof goog.string.Const?goog.string.Const.unwrap(E):encodeURIComponent(String(E))}),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.TrustedResourceUrl.FORMAT_MARKER_=/%{(\w+)}/g,goog.html.TrustedResourceUrl.BASE_URL_=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,goog.html.TrustedResourceUrl.URL_PARAM_PARSER_=/^([^?#]*)(\?[^#]*)?(#[\s\S]*)?/,goog.html.TrustedResourceUrl.formatWithParams=function(B,_,T,E){return goog.html.TrustedResourceUrl.format(B,_).cloneWithParams(T,E)},goog.html.TrustedResourceUrl.fromConstant=function(B){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(B))},goog.html.TrustedResourceUrl.fromConstants=function(B){for(var _="",T=0;T<B.length;T++)_+=goog.string.Const.unwrap(B[T]);return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(_)},goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(B){var _=new goog.html.TrustedResourceUrl;return _.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY?goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createScriptURL(B):B,goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY&&(_.trustedURL_=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createURL(B)),_},goog.html.TrustedResourceUrl.stringifyParams_=function(B,_,T){if(T==null)return _;if(goog.isString(T))return T?B+encodeURIComponent(T):"";for(var E in T){var W=T[E];W=goog.isArray(W)?W:[W];for(var X=0;X<W.length;X++){var q=W[X];q!=null&&(_||(_=B),_+=(_.length>B.length?"&":"")+encodeURIComponent(E)+"="+encodeURIComponent(String(q)))}}return _},goog.string.internal={},goog.string.internal.startsWith=function(B,_){return B.lastIndexOf(_,0)==0},goog.string.internal.endsWith=function(B,_){var T=B.length-_.length;return 0<=T&&B.indexOf(_,T)==T},goog.string.internal.caseInsensitiveStartsWith=function(B,_){return goog.string.internal.caseInsensitiveCompare(_,B.substr(0,_.length))==0},goog.string.internal.caseInsensitiveEndsWith=function(B,_){return goog.string.internal.caseInsensitiveCompare(_,B.substr(B.length-_.length,_.length))==0},goog.string.internal.caseInsensitiveEquals=function(B,_){return B.toLowerCase()==_.toLowerCase()},goog.string.internal.isEmptyOrWhitespace=function(B){return/^[\s\xa0]*$/.test(B)},goog.string.internal.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(B){return B.trim()}:function(B){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(B)[1]},goog.string.internal.caseInsensitiveCompare=function(B,_){return B=String(B).toLowerCase(),_=String(_).toLowerCase(),B<_?-1:B==_?0:1},goog.string.internal.newLineToBr=function(B,_){return B.replace(/(\r\n|\r|\n)/g,_?"<br />":"<br>")},goog.string.internal.htmlEscape=function(B,_){if(_)B=B.replace(goog.string.internal.AMP_RE_,"&amp;").replace(goog.string.internal.LT_RE_,"&lt;").replace(goog.string.internal.GT_RE_,"&gt;").replace(goog.string.internal.QUOT_RE_,"&quot;").replace(goog.string.internal.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.internal.NULL_RE_,"&#0;");else{if(!goog.string.internal.ALL_RE_.test(B))return B;B.indexOf("&")!=-1&&(B=B.replace(goog.string.internal.AMP_RE_,"&amp;")),B.indexOf("<")!=-1&&(B=B.replace(goog.string.internal.LT_RE_,"&lt;")),B.indexOf(">")!=-1&&(B=B.replace(goog.string.internal.GT_RE_,"&gt;")),B.indexOf('"')!=-1&&(B=B.replace(goog.string.internal.QUOT_RE_,"&quot;")),B.indexOf("'")!=-1&&(B=B.replace(goog.string.internal.SINGLE_QUOTE_RE_,"&#39;")),B.indexOf("\0")!=-1&&(B=B.replace(goog.string.internal.NULL_RE_,"&#0;"))}return B},goog.string.internal.AMP_RE_=/&/g,goog.string.internal.LT_RE_=/</g,goog.string.internal.GT_RE_=/>/g,goog.string.internal.QUOT_RE_=/"/g,goog.string.internal.SINGLE_QUOTE_RE_=/'/g,goog.string.internal.NULL_RE_=/\x00/g,goog.string.internal.ALL_RE_=/[\x00&<>"']/,goog.string.internal.whitespaceEscape=function(B,_){return goog.string.internal.newLineToBr(B.replace(/  /g," &#160;"),_)},goog.string.internal.contains=function(B,_){return B.indexOf(_)!=-1},goog.string.internal.caseInsensitiveContains=function(B,_){return goog.string.internal.contains(B.toLowerCase(),_.toLowerCase())},goog.string.internal.compareVersions=function(B,_){var T=0;B=goog.string.internal.trim(String(B)).split("."),_=goog.string.internal.trim(String(_)).split(".");for(var E=Math.max(B.length,_.length),W=0;T==0&&W<E;W++){var X=B[W]||"",q=_[W]||"";do{if(X=/(\d*)(\D*)(.*)/.exec(X)||["","","",""],q=/(\d*)(\D*)(.*)/.exec(q)||["","","",""],X[0].length==0&&q[0].length==0)break;T=X[1].length==0?0:parseInt(X[1],10);var Y=q[1].length==0?0:parseInt(q[1],10);T=goog.string.internal.compareElements_(T,Y)||goog.string.internal.compareElements_(X[2].length==0,q[2].length==0)||goog.string.internal.compareElements_(X[2],q[2]),X=X[3],q=q[3]}while(T==0)}return T},goog.string.internal.compareElements_=function(B,_){return B<_?-1:B>_?1:0},goog.html.SafeUrl=function(){this.privateDoNotAccessOrElseSafeUrlWrappedValue_="",this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez",goog.html.SafeUrl.prototype.implementsGoogStringTypedString=!0,goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeUrlWrappedValue_.toString()},goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR},goog.DEBUG&&(goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeUrlWrappedValue_+"}"}),goog.html.SafeUrl.unwrap=function(B){return goog.html.SafeUrl.unwrapTrustedURL(B).toString()},goog.html.SafeUrl.unwrapTrustedURL=function(B){return B instanceof goog.html.SafeUrl&&B.constructor===goog.html.SafeUrl&&B.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?B.privateDoNotAccessOrElseSafeUrlWrappedValue_:(goog.asserts.fail("expected object of type SafeUrl, got '"+B+"' of type "+goog.typeOf(B)),"type_error:SafeUrl")},goog.html.SafeUrl.fromConstant=function(B){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(B))},goog.html.SAFE_MIME_TYPE_PATTERN_=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-wav|wav|webm)|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime))(?:;\w+=(?:\w+|"[\w;=]+"))*$/i,goog.html.SafeUrl.isSafeMimeType=function(B){return goog.html.SAFE_MIME_TYPE_PATTERN_.test(B)},goog.html.SafeUrl.fromBlob=function(B){return B=goog.html.SAFE_MIME_TYPE_PATTERN_.test(B.type)?goog.fs.url.createObjectUrl(B):goog.html.SafeUrl.INNOCUOUS_STRING,goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.DATA_URL_PATTERN_=/^data:([^,]*);base64,[a-z0-9+\/]+=*$/i,goog.html.SafeUrl.fromDataUrl=function(B){B=B.replace(/(%0A|%0D)/g,"");var _=B.match(goog.html.DATA_URL_PATTERN_);return _=_&&goog.html.SAFE_MIME_TYPE_PATTERN_.test(_[1]),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(_?B:goog.html.SafeUrl.INNOCUOUS_STRING)},goog.html.SafeUrl.fromTelUrl=function(B){return goog.string.internal.caseInsensitiveStartsWith(B,"tel:")||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.SIP_URL_PATTERN_=/^sip[s]?:[+a-z0-9_.!$%&'*\/=^`{|}~-]+@([a-z0-9-]+\.)+[a-z0-9]{2,63}$/i,goog.html.SafeUrl.fromSipUrl=function(B){return goog.html.SIP_URL_PATTERN_.test(decodeURIComponent(B))||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.SafeUrl.fromFacebookMessengerUrl=function(B){return goog.string.internal.caseInsensitiveStartsWith(B,"fb-messenger://share")||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.SafeUrl.fromWhatsAppUrl=function(B){return goog.string.internal.caseInsensitiveStartsWith(B,"whatsapp://send")||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.SafeUrl.fromSmsUrl=function(B){return goog.string.internal.caseInsensitiveStartsWith(B,"sms:")&&goog.html.SafeUrl.isSmsUrlBodyValid_(B)||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.SafeUrl.isSmsUrlBodyValid_=function(B){var _=B.indexOf("#");if(0<_&&(B=B.substring(0,_)),_=B.match(/[?&]body=/gi),!_)return!0;if(1<_.length)return!1;if(B=B.match(/[?&]body=([^&]*)/)[1],!B)return!0;try{decodeURIComponent(B)}catch{return!1}return/^(?:[a-z0-9\-_.~]|%[0-9a-f]{2})+$/i.test(B)},goog.html.SafeUrl.fromSshUrl=function(B){return goog.string.internal.caseInsensitiveStartsWith(B,"ssh://")||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)},goog.html.SafeUrl.sanitizeChromeExtensionUrl=function(B,_){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^chrome-extension:\/\/([^\/]+)\//,B,_)},goog.html.SafeUrl.sanitizeFirefoxExtensionUrl=function(B,_){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^moz-extension:\/\/([^\/]+)\//,B,_)},goog.html.SafeUrl.sanitizeEdgeExtensionUrl=function(B,_){return goog.html.SafeUrl.sanitizeExtensionUrl_(/^ms-browser-extension:\/\/([^\/]+)\//,B,_)},goog.html.SafeUrl.sanitizeExtensionUrl_=function(B,_,T){return(B=B.exec(_))?(B=B[1],(T instanceof goog.string.Const?[goog.string.Const.unwrap(T)]:T.map(function(E){return goog.string.Const.unwrap(E)})).indexOf(B)==-1&&(_=goog.html.SafeUrl.INNOCUOUS_STRING)):_=goog.html.SafeUrl.INNOCUOUS_STRING,goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(_)},goog.html.SafeUrl.fromTrustedResourceUrl=function(B){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.html.TrustedResourceUrl.unwrap(B))},goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,goog.html.SafeUrl.SAFE_URL_PATTERN=goog.html.SAFE_URL_PATTERN_,goog.html.SafeUrl.sanitize=function(B){return B instanceof goog.html.SafeUrl?B:(B=typeof B=="object"&&B.implementsGoogStringTypedString?B.getTypedStringValue():String(B),goog.html.SAFE_URL_PATTERN_.test(B)||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B))},goog.html.SafeUrl.sanitizeAssertUnchanged=function(B,_){return B instanceof goog.html.SafeUrl?B:(B=typeof B=="object"&&B.implementsGoogStringTypedString?B.getTypedStringValue():String(B),_&&/^data:/i.test(B)&&(_=goog.html.SafeUrl.fromDataUrl(B),_.getTypedStringValue()==B)?_:(goog.asserts.assert(goog.html.SAFE_URL_PATTERN_.test(B),"%s does not match the safe URL pattern",B)||(B=goog.html.SafeUrl.INNOCUOUS_STRING),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(B)))},goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(B){var _=new goog.html.SafeUrl;return _.privateDoNotAccessOrElseSafeUrlWrappedValue_=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY?goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createURL(B):B,_},goog.html.SafeUrl.ABOUT_BLANK=goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse("about:blank"),goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="",this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyle.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyle.fromConstant=function(B){return B=goog.string.Const.unwrap(B),B.length===0?goog.html.SafeStyle.EMPTY:(goog.asserts.assert(goog.string.internal.endsWith(B,";"),"Last character of style string is not ';': "+B),goog.asserts.assert(goog.string.internal.contains(B,":"),`Style string must contain at least one ':', to specify a "name: value" pair: `+B),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(B))},goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_},goog.DEBUG&&(goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"}),goog.html.SafeStyle.unwrap=function(B){return B instanceof goog.html.SafeStyle&&B.constructor===goog.html.SafeStyle&&B.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?B.privateDoNotAccessOrElseSafeStyleWrappedValue_:(goog.asserts.fail("expected object of type SafeStyle, got '"+B+"' of type "+goog.typeOf(B)),"type_error:SafeStyle")},goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(B){return new goog.html.SafeStyle().initSecurityPrivateDoNotAccessOrElse_(B)},goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(B){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_=B,this},goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(""),goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez",goog.html.SafeStyle.create=function(B){var _="",T;for(T in B){if(!/^[-_a-zA-Z0-9]+$/.test(T))throw Error("Name allows only [-_a-zA-Z0-9], got: "+T);var E=B[T];E!=null&&(E=goog.isArray(E)?goog.array.map(E,goog.html.SafeStyle.sanitizePropertyValue_).join(" "):goog.html.SafeStyle.sanitizePropertyValue_(E),_+=T+":"+E+";")}return _?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(_):goog.html.SafeStyle.EMPTY},goog.html.SafeStyle.sanitizePropertyValue_=function(B){if(B instanceof goog.html.SafeUrl)return'url("'+goog.html.SafeUrl.unwrap(B).replace(/</g,"%3c").replace(/[\\"]/g,"\\$&")+'")';if(B=B instanceof goog.string.Const?goog.string.Const.unwrap(B):goog.html.SafeStyle.sanitizePropertyValueString_(String(B)),/[{;}]/.test(B))throw new goog.asserts.AssertionError("Value does not allow [{;}], got: %s.",[B]);return B},goog.html.SafeStyle.sanitizePropertyValueString_=function(B){var _=B.replace(goog.html.SafeStyle.FUNCTIONS_RE_,"$1").replace(goog.html.SafeStyle.FUNCTIONS_RE_,"$1").replace(goog.html.SafeStyle.URL_RE_,"url");if(goog.html.SafeStyle.VALUE_RE_.test(_)){if(goog.html.SafeStyle.COMMENT_RE_.test(B))return goog.asserts.fail("String value disallows comments, got: "+B),goog.html.SafeStyle.INNOCUOUS_STRING;if(!goog.html.SafeStyle.hasBalancedQuotes_(B))return goog.asserts.fail("String value requires balanced quotes, got: "+B),goog.html.SafeStyle.INNOCUOUS_STRING;if(!goog.html.SafeStyle.hasBalancedSquareBrackets_(B))return goog.asserts.fail("String value requires balanced square brackets and one identifier per pair of brackets, got: "+B),goog.html.SafeStyle.INNOCUOUS_STRING}else return goog.asserts.fail("String value allows only "+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+" and simple functions, got: "+B),goog.html.SafeStyle.INNOCUOUS_STRING;return goog.html.SafeStyle.sanitizeUrl_(B)},goog.html.SafeStyle.hasBalancedQuotes_=function(B){for(var _=!0,T=!0,E=0;E<B.length;E++){var W=B.charAt(E);W=="'"&&T?_=!_:W=='"'&&_&&(T=!T)}return _&&T},goog.html.SafeStyle.hasBalancedSquareBrackets_=function(B){for(var _=!0,T=/^[-_a-zA-Z0-9]$/,E=0;E<B.length;E++){var W=B.charAt(E);if(W=="]"){if(_)return!1;_=!0}else if(W=="["){if(!_)return!1;_=!1}else if(!_&&!T.test(W))return!1}return _},goog.html.SafeStyle.VALUE_ALLOWED_CHARS_=`[-,."'%_!# a-zA-Z0-9\\[\\]]`,goog.html.SafeStyle.VALUE_RE_=new RegExp("^"+goog.html.SafeStyle.VALUE_ALLOWED_CHARS_+"+$"),goog.html.SafeStyle.URL_RE_=/\b(url\([ \t\n]*)('[ -&(-\[\]-~]*'|"[ !#-\[\]-~]*"|[!#-&*-\[\]-~]*)([ \t\n]*\))/g,goog.html.SafeStyle.FUNCTIONS_RE_=/\b(hsl|hsla|rgb|rgba|matrix|calc|minmax|fit-content|repeat|(rotate|scale|translate)(X|Y|Z|3d)?)\([-+*/0-9a-z.%\[\], ]+\)/g,goog.html.SafeStyle.COMMENT_RE_=/\/\*/,goog.html.SafeStyle.sanitizeUrl_=function(B){return B.replace(goog.html.SafeStyle.URL_RE_,function(_,T,E,W){var X="";return E=E.replace(/^(['"])(.*)\1$/,function(q,Y,te){return X=Y,te}),_=goog.html.SafeUrl.sanitize(E).getTypedStringValue(),T+X+_+X+W})},goog.html.SafeStyle.concat=function(B){var _="",T=function(E){goog.isArray(E)?goog.array.forEach(E,T):_+=goog.html.SafeStyle.unwrap(E)};return goog.array.forEach(arguments,T),_?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(_):goog.html.SafeStyle.EMPTY},goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="",this.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_},goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=!0,goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeStyleSheet.createRule=function(B,_){if(goog.string.internal.contains(B,"<"))throw Error("Selector does not allow '<', got: "+B);var T=B.replace(/('|")((?!\1)[^\r\n\f\\]|\\[\s\S])*\1/g,"");if(!/^[-_a-zA-Z0-9#.:* ,>+~[\]()=^$|]+$/.test(T))throw Error("Selector allows only [-_a-zA-Z0-9#.:* ,>+~[\\]()=^$|] and strings, got: "+B);if(!goog.html.SafeStyleSheet.hasBalancedBrackets_(T))throw Error("() and [] in selector must be balanced, got: "+B);return _ instanceof goog.html.SafeStyle||(_=goog.html.SafeStyle.create(_)),B=B+"{"+goog.html.SafeStyle.unwrap(_).replace(/</g,"\\3C ")+"}",goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(B)},goog.html.SafeStyleSheet.hasBalancedBrackets_=function(B){for(var _={"(":")","[":"]"},T=[],E=0;E<B.length;E++){var W=B[E];if(_[W])T.push(_[W]);else if(goog.object.contains(_,W)&&T.pop()!=W)return!1}return T.length==0},goog.html.SafeStyleSheet.concat=function(B){var _="",T=function(E){goog.isArray(E)?goog.array.forEach(E,T):_+=goog.html.SafeStyleSheet.unwrap(E)};return goog.array.forEach(arguments,T),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(_)},goog.html.SafeStyleSheet.fromConstant=function(B){return B=goog.string.Const.unwrap(B),B.length===0?goog.html.SafeStyleSheet.EMPTY:(goog.asserts.assert(!goog.string.internal.contains(B,"<"),"Forbidden '<' character in style sheet string: "+B),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(B))},goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_},goog.DEBUG&&(goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"}),goog.html.SafeStyleSheet.unwrap=function(B){return B instanceof goog.html.SafeStyleSheet&&B.constructor===goog.html.SafeStyleSheet&&B.SAFE_STYLE_SHEET_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?B.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_:(goog.asserts.fail("expected object of type SafeStyleSheet, got '"+B+"' of type "+goog.typeOf(B)),"type_error:SafeStyleSheet")},goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(B){return new goog.html.SafeStyleSheet().initSecurityPrivateDoNotAccessOrElse_(B)},goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(B){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=B,this},goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(""),goog.labs={},goog.labs.userAgent={},goog.labs.userAgent.util={},goog.labs.userAgent.util.getNativeUserAgentString_=function(){var B=goog.labs.userAgent.util.getNavigator_();return B&&(B=B.userAgent)?B:""},goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator},goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_(),goog.labs.userAgent.util.setUserAgent=function(B){goog.labs.userAgent.util.userAgent_=B||goog.labs.userAgent.util.getNativeUserAgentString_()},goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_},goog.labs.userAgent.util.matchUserAgent=function(B){var _=goog.labs.userAgent.util.getUserAgent();return goog.string.internal.contains(_,B)},goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(B){var _=goog.labs.userAgent.util.getUserAgent();return goog.string.internal.caseInsensitiveContains(_,B)},goog.labs.userAgent.util.extractVersionTuples=function(B){for(var _=/(\w[\w ]+)\/([^\s]+)\s*(?:\((.*?)\))?/g,T=[],E;E=_.exec(B);)T.push([E[1],E[2],E[3]||void 0]);return T},goog.labs.userAgent.browser={},goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")},goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.browser.matchEdgeHtml_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.browser.matchEdgeChromium_=function(){return goog.labs.userAgent.util.matchUserAgent("Edg/")},goog.labs.userAgent.browser.matchOperaChromium_=function(){return goog.labs.userAgent.util.matchUserAgent("OPR")},goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")||goog.labs.userAgent.util.matchUserAgent("FxiOS")},goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdgeHtml_()||goog.labs.userAgent.browser.matchEdgeChromium_()||goog.labs.userAgent.browser.matchOperaChromium_()||goog.labs.userAgent.browser.matchFirefox_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))},goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")},goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&!goog.labs.userAgent.browser.matchFirefox_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")},goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchEdgeHtml_()},goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())},goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_,goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_,goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdgeHtml_,goog.labs.userAgent.browser.isEdgeChromium=goog.labs.userAgent.browser.matchEdgeChromium_,goog.labs.userAgent.browser.isOperaChromium=goog.labs.userAgent.browser.matchOperaChromium_,goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_,goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_,goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_,goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_,goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_,goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_,goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")},goog.labs.userAgent.browser.getVersion=function(){function B(W){return W=goog.array.find(W,E),T[W]||""}var _=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(_);_=goog.labs.userAgent.util.extractVersionTuples(_);var T={};goog.array.forEach(_,function(W){T[W[0]]=W[1]});var E=goog.partial(goog.object.containsKey,T);return goog.labs.userAgent.browser.isOpera()?B(["Version","Opera"]):goog.labs.userAgent.browser.isEdge()?B(["Edge"]):goog.labs.userAgent.browser.isEdgeChromium()?B(["Edg"]):goog.labs.userAgent.browser.isChrome()?B(["Chrome","CriOS"]):(_=_[2])&&_[1]||""},goog.labs.userAgent.browser.isVersionOrHigher=function(B){return 0<=goog.string.internal.compareVersions(goog.labs.userAgent.browser.getVersion(),B)},goog.labs.userAgent.browser.getIEVersion_=function(B){var _=/rv: *([\d\.]*)/.exec(B);if(_&&_[1])return _[1];_="";var T=/MSIE +([\d\.]+)/.exec(B);if(T&&T[1])if(B=/Trident\/(\d.\d)/.exec(B),T[1]=="7.0")if(B&&B[1])switch(B[1]){case"4.0":_="8.0";break;case"5.0":_="9.0";break;case"6.0":_="10.0";break;case"7.0":_="11.0"}else _="7.0";else _=T[1];return _},goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="",this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_,this.dir_=null},goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=!0,goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_},goog.html.SafeHtml.prototype.implementsGoogStringTypedString=!0,goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_.toString()},goog.DEBUG&&(goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"}),goog.html.SafeHtml.unwrap=function(B){return goog.html.SafeHtml.unwrapTrustedHTML(B).toString()},goog.html.SafeHtml.unwrapTrustedHTML=function(B){return B instanceof goog.html.SafeHtml&&B.constructor===goog.html.SafeHtml&&B.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_?B.privateDoNotAccessOrElseSafeHtmlWrappedValue_:(goog.asserts.fail("expected object of type SafeHtml, got '"+B+"' of type "+goog.typeOf(B)),"type_error:SafeHtml")},goog.html.SafeHtml.htmlEscape=function(B){if(B instanceof goog.html.SafeHtml)return B;var _=typeof B=="object",T=null;return _&&B.implementsGoogI18nBidiDirectionalString&&(T=B.getDirection()),B=_&&B.implementsGoogStringTypedString?B.getTypedStringValue():String(B),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.internal.htmlEscape(B),T)},goog.html.SafeHtml.htmlEscapePreservingNewlines=function(B){return B instanceof goog.html.SafeHtml?B:(B=goog.html.SafeHtml.htmlEscape(B),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.internal.newLineToBr(goog.html.SafeHtml.unwrap(B)),B.getDirection()))},goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(B){return B instanceof goog.html.SafeHtml?B:(B=goog.html.SafeHtml.htmlEscape(B),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.internal.whitespaceEscape(goog.html.SafeHtml.unwrap(B)),B.getDirection()))},goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape,goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/,goog.html.SafeHtml.URL_ATTRIBUTES_={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0},goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_={APPLET:!0,BASE:!0,EMBED:!0,IFRAME:!0,LINK:!0,MATH:!0,META:!0,OBJECT:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.html.SafeHtml.create=function(B,_,T){return goog.html.SafeHtml.verifyTagName(String(B)),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(String(B),_,T)},goog.html.SafeHtml.verifyTagName=function(B){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(B))throw Error("Invalid tag name <"+B+">.");if(B.toUpperCase()in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_)throw Error("Tag name <"+B+"> is not allowed for SafeHtml.")},goog.html.SafeHtml.createIframe=function(B,_,T,E){B&&goog.html.TrustedResourceUrl.unwrap(B);var W={};return W.src=B||null,W.srcdoc=_&&goog.html.SafeHtml.unwrap(_),B=goog.html.SafeHtml.combineAttributes(W,{sandbox:""},T),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",B,E)},goog.html.SafeHtml.createSandboxIframe=function(B,_,T,E){if(!goog.html.SafeHtml.canUseSandboxIframe())throw Error("The browser does not support sandboxed iframes.");var W={};return W.src=B?goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(B)):null,W.srcdoc=_||null,W.sandbox="",B=goog.html.SafeHtml.combineAttributes(W,{},T),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",B,E)},goog.html.SafeHtml.canUseSandboxIframe=function(){return goog.global.HTMLIFrameElement&&"sandbox"in goog.global.HTMLIFrameElement.prototype},goog.html.SafeHtml.createScriptSrc=function(B,_){return goog.html.TrustedResourceUrl.unwrap(B),B=goog.html.SafeHtml.combineAttributes({src:B},{},_),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",B)},goog.html.SafeHtml.createScript=function(B,_){for(var T in _){var E=T.toLowerCase();if(E=="language"||E=="src"||E=="text"||E=="type")throw Error('Cannot set "'+E+'" attribute')}for(T="",B=goog.array.concat(B),E=0;E<B.length;E++)T+=goog.html.SafeScript.unwrap(B[E]);return B=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(T,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("script",_,B)},goog.html.SafeHtml.createStyle=function(B,_){_=goog.html.SafeHtml.combineAttributes({type:"text/css"},{},_);var T="";B=goog.array.concat(B);for(var E=0;E<B.length;E++)T+=goog.html.SafeStyleSheet.unwrap(B[E]);return B=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(T,goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",_,B)},goog.html.SafeHtml.createMetaRefresh=function(B,_){return B=goog.html.SafeUrl.unwrap(goog.html.SafeUrl.sanitize(B)),(goog.labs.userAgent.browser.isIE()||goog.labs.userAgent.browser.isEdge())&&goog.string.internal.contains(B,";")&&(B="'"+B.replace(/'/g,"%27")+"'"),goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("meta",{"http-equiv":"refresh",content:(_||0)+"; url="+B})},goog.html.SafeHtml.getAttrNameAndValue_=function(B,_,T){if(T instanceof goog.string.Const)T=goog.string.Const.unwrap(T);else if(_.toLowerCase()=="style")T=goog.html.SafeHtml.getStyleValue_(T);else{if(/^on/i.test(_))throw Error('Attribute "'+_+'" requires goog.string.Const value, "'+T+'" given.');if(_.toLowerCase()in goog.html.SafeHtml.URL_ATTRIBUTES_)if(T instanceof goog.html.TrustedResourceUrl)T=goog.html.TrustedResourceUrl.unwrap(T);else if(T instanceof goog.html.SafeUrl)T=goog.html.SafeUrl.unwrap(T);else if(goog.isString(T))T=goog.html.SafeUrl.sanitize(T).getTypedStringValue();else throw Error('Attribute "'+_+'" on tag "'+B+'" requires goog.html.SafeUrl, goog.string.Const, or string, value "'+T+'" given.')}return T.implementsGoogStringTypedString&&(T=T.getTypedStringValue()),goog.asserts.assert(goog.isString(T)||goog.isNumber(T),"String or number value expected, got "+typeof T+" with value: "+T),_+'="'+goog.string.internal.htmlEscape(String(T))+'"'},goog.html.SafeHtml.getStyleValue_=function(B){if(!goog.isObject(B))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof B+" given: "+B);return B instanceof goog.html.SafeStyle||(B=goog.html.SafeStyle.create(B)),goog.html.SafeStyle.unwrap(B)},goog.html.SafeHtml.createWithDir=function(B,_,T,E){return _=goog.html.SafeHtml.create(_,T,E),_.dir_=B,_},goog.html.SafeHtml.join=function(B,_){B=goog.html.SafeHtml.htmlEscape(B);var T=B.getDirection(),E=[],W=function(X){goog.isArray(X)?goog.array.forEach(X,W):(X=goog.html.SafeHtml.htmlEscape(X),E.push(goog.html.SafeHtml.unwrap(X)),X=X.getDirection(),T==goog.i18n.bidi.Dir.NEUTRAL?T=X:X!=goog.i18n.bidi.Dir.NEUTRAL&&T!=X&&(T=null))};return goog.array.forEach(_,W),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(E.join(goog.html.SafeHtml.unwrap(B)),T)},goog.html.SafeHtml.concat=function(B){return goog.html.SafeHtml.join(goog.html.SafeHtml.EMPTY,Array.prototype.slice.call(arguments))},goog.html.SafeHtml.concatWithDir=function(B,_){var T=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));return T.dir_=B,T},goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={},goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(B,_){return new goog.html.SafeHtml().initSecurityPrivateDoNotAccessOrElse_(B,_)},goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(B,_){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY?goog.html.trustedtypes.PRIVATE_DO_NOT_ACCESS_OR_ELSE_POLICY.createHTML(B):B,this.dir_=_,this},goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(B,_,T){var E=null,W="<"+B+goog.html.SafeHtml.stringifyAttributes(B,_);return goog.isDefAndNotNull(T)?goog.isArray(T)||(T=[T]):T=[],goog.dom.tags.isVoidTag(B.toLowerCase())?(goog.asserts.assert(!T.length,"Void tag <"+B+"> does not allow content."),W+=">"):(E=goog.html.SafeHtml.concat(T),W+=">"+goog.html.SafeHtml.unwrap(E)+"</"+B+">",E=E.getDirection()),(B=_&&_.dir)&&(E=/^(ltr|rtl|auto)$/i.test(B)?goog.i18n.bidi.Dir.NEUTRAL:null),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(W,E)},goog.html.SafeHtml.stringifyAttributes=function(B,_){var T="";if(_)for(var E in _){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(E))throw Error('Invalid attribute name "'+E+'".');var W=_[E];goog.isDefAndNotNull(W)&&(T+=" "+goog.html.SafeHtml.getAttrNameAndValue_(B,E,W))}return T},goog.html.SafeHtml.combineAttributes=function(B,_,T){var E={},W;for(W in B)goog.asserts.assert(W.toLowerCase()==W,"Must be lower case"),E[W]=B[W];for(W in _)goog.asserts.assert(W.toLowerCase()==W,"Must be lower case"),E[W]=_[W];for(W in T){var X=W.toLowerCase();if(X in B)throw Error('Cannot override "'+X+'" attribute, got "'+W+'" with value "'+T[W]+'"');X in _&&delete E[X],E[W]=T[W]}return E},goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL),goog.html.SafeHtml.BR=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<br>",goog.i18n.bidi.Dir.NEUTRAL),goog.html.uncheckedconversions={},goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract=function(B,_,T){return goog.asserts.assertString(goog.string.Const.unwrap(B),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(B)),"must provide non-empty justification"),goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(_,T||null)},goog.html.uncheckedconversions.safeScriptFromStringKnownToSatisfyTypeContract=function(B,_){return goog.asserts.assertString(goog.string.Const.unwrap(B),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(B)),"must provide non-empty justification"),goog.html.SafeScript.createSafeScriptSecurityPrivateDoNotAccessOrElse(_)},goog.html.uncheckedconversions.safeStyleFromStringKnownToSatisfyTypeContract=function(B,_){return goog.asserts.assertString(goog.string.Const.unwrap(B),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(B)),"must provide non-empty justification"),goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(_)},goog.html.uncheckedconversions.safeStyleSheetFromStringKnownToSatisfyTypeContract=function(B,_){return goog.asserts.assertString(goog.string.Const.unwrap(B),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(B)),"must provide non-empty justification"),goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(_)},goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract=function(B,_){return goog.asserts.assertString(goog.string.Const.unwrap(B),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(B)),"must provide non-empty justification"),goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(_)},goog.html.uncheckedconversions.trustedResourceUrlFromStringKnownToSatisfyTypeContract=function(B,_){return goog.asserts.assertString(goog.string.Const.unwrap(B),"must provide justification"),goog.asserts.assert(!goog.string.internal.isEmptyOrWhitespace(goog.string.Const.unwrap(B)),"must provide non-empty justification"),goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(_)},goog.dom.safe={},goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"},goog.dom.safe.insertAdjacentHtml=function(B,_,T){B.insertAdjacentHTML(_,goog.html.SafeHtml.unwrapTrustedHTML(T))},goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},goog.dom.safe.isInnerHtmlCleanupRecursive_=goog.functions.cacheReturnValue(function(){if(goog.DEBUG&&typeof document>"u")return!1;var B=document.createElement("div"),_=document.createElement("div");return _.appendChild(document.createElement("div")),B.appendChild(_),goog.DEBUG&&!B.firstChild?!1:(_=B.firstChild.firstChild,B.innerHTML=goog.html.SafeHtml.unwrapTrustedHTML(goog.html.SafeHtml.EMPTY),!_.parentElement)}),goog.dom.safe.unsafeSetInnerHtmlDoNotUseOrElse=function(B,_){if(goog.dom.safe.isInnerHtmlCleanupRecursive_())for(;B.lastChild;)B.removeChild(B.lastChild);B.innerHTML=goog.html.SafeHtml.unwrapTrustedHTML(_)},goog.dom.safe.setInnerHtml=function(B,_){if(goog.asserts.ENABLE_ASSERTS){var T=B.tagName.toUpperCase();if(goog.dom.safe.SET_INNER_HTML_DISALLOWED_TAGS_[T])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+B.tagName+".")}goog.dom.safe.unsafeSetInnerHtmlDoNotUseOrElse(B,_)},goog.dom.safe.setOuterHtml=function(B,_){B.outerHTML=goog.html.SafeHtml.unwrapTrustedHTML(_)},goog.dom.safe.setFormElementAction=function(B,_){_=_ instanceof goog.html.SafeUrl?_:goog.html.SafeUrl.sanitizeAssertUnchanged(_),goog.dom.asserts.assertIsHTMLFormElement(B).action=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.setButtonFormAction=function(B,_){_=_ instanceof goog.html.SafeUrl?_:goog.html.SafeUrl.sanitizeAssertUnchanged(_),goog.dom.asserts.assertIsHTMLButtonElement(B).formAction=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.setInputFormAction=function(B,_){_=_ instanceof goog.html.SafeUrl?_:goog.html.SafeUrl.sanitizeAssertUnchanged(_),goog.dom.asserts.assertIsHTMLInputElement(B).formAction=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.setStyle=function(B,_){B.style.cssText=goog.html.SafeStyle.unwrap(_)},goog.dom.safe.documentWrite=function(B,_){B.write(goog.html.SafeHtml.unwrapTrustedHTML(_))},goog.dom.safe.setAnchorHref=function(B,_){goog.dom.asserts.assertIsHTMLAnchorElement(B),_=_ instanceof goog.html.SafeUrl?_:goog.html.SafeUrl.sanitizeAssertUnchanged(_),B.href=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.setImageSrc=function(B,_){if(goog.dom.asserts.assertIsHTMLImageElement(B),!(_ instanceof goog.html.SafeUrl)){var T=/^data:image\//i.test(_);_=goog.html.SafeUrl.sanitizeAssertUnchanged(_,T)}B.src=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.setAudioSrc=function(B,_){if(goog.dom.asserts.assertIsHTMLAudioElement(B),!(_ instanceof goog.html.SafeUrl)){var T=/^data:audio\//i.test(_);_=goog.html.SafeUrl.sanitizeAssertUnchanged(_,T)}B.src=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.setVideoSrc=function(B,_){if(goog.dom.asserts.assertIsHTMLVideoElement(B),!(_ instanceof goog.html.SafeUrl)){var T=/^data:video\//i.test(_);_=goog.html.SafeUrl.sanitizeAssertUnchanged(_,T)}B.src=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.setEmbedSrc=function(B,_){goog.dom.asserts.assertIsHTMLEmbedElement(B),B.src=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(_)},goog.dom.safe.setFrameSrc=function(B,_){goog.dom.asserts.assertIsHTMLFrameElement(B),B.src=goog.html.TrustedResourceUrl.unwrapTrustedURL(_)},goog.dom.safe.setIframeSrc=function(B,_){goog.dom.asserts.assertIsHTMLIFrameElement(B),B.src=goog.html.TrustedResourceUrl.unwrapTrustedURL(_)},goog.dom.safe.setIframeSrcdoc=function(B,_){goog.dom.asserts.assertIsHTMLIFrameElement(B),B.srcdoc=goog.html.SafeHtml.unwrapTrustedHTML(_)},goog.dom.safe.setLinkHrefAndRel=function(B,_,T){goog.dom.asserts.assertIsHTMLLinkElement(B),B.rel=T,goog.string.internal.caseInsensitiveContains(T,"stylesheet")?(goog.asserts.assert(_ instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"'),B.href=goog.html.TrustedResourceUrl.unwrapTrustedURL(_)):B.href=_ instanceof goog.html.TrustedResourceUrl?goog.html.TrustedResourceUrl.unwrapTrustedURL(_):_ instanceof goog.html.SafeUrl?goog.html.SafeUrl.unwrapTrustedURL(_):goog.html.SafeUrl.unwrapTrustedURL(goog.html.SafeUrl.sanitizeAssertUnchanged(_))},goog.dom.safe.setObjectData=function(B,_){goog.dom.asserts.assertIsHTMLObjectElement(B),B.data=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(_)},goog.dom.safe.setScriptSrc=function(B,_){goog.dom.asserts.assertIsHTMLScriptElement(B),B.src=goog.html.TrustedResourceUrl.unwrapTrustedScriptURL(_),(_=goog.getScriptNonce())&&B.setAttribute("nonce",_)},goog.dom.safe.setScriptContent=function(B,_){goog.dom.asserts.assertIsHTMLScriptElement(B),B.text=goog.html.SafeScript.unwrapTrustedScript(_),(_=goog.getScriptNonce())&&B.setAttribute("nonce",_)},goog.dom.safe.setLocationHref=function(B,_){goog.dom.asserts.assertIsLocation(B),_=_ instanceof goog.html.SafeUrl?_:goog.html.SafeUrl.sanitizeAssertUnchanged(_),B.href=goog.html.SafeUrl.unwrapTrustedURL(_)},goog.dom.safe.assignLocation=function(B,_){goog.dom.asserts.assertIsLocation(B),_=_ instanceof goog.html.SafeUrl?_:goog.html.SafeUrl.sanitizeAssertUnchanged(_),B.assign(goog.html.SafeUrl.unwrapTrustedURL(_))},goog.dom.safe.replaceLocation=function(B,_){goog.dom.asserts.assertIsLocation(B),_=_ instanceof goog.html.SafeUrl?_:goog.html.SafeUrl.sanitizeAssertUnchanged(_),B.replace(goog.html.SafeUrl.unwrapTrustedURL(_))},goog.dom.safe.openInWindow=function(B,_,T,E,W){return B=B instanceof goog.html.SafeUrl?B:goog.html.SafeUrl.sanitizeAssertUnchanged(B),(_||goog.global).open(goog.html.SafeUrl.unwrapTrustedURL(B),T?goog.string.Const.unwrap(T):"",E,W)},goog.dom.safe.parseFromStringHtml=function(B,_){return goog.dom.safe.parseFromString(B,_,"text/html")},goog.dom.safe.parseFromString=function(B,_,T){return B.parseFromString(goog.html.SafeHtml.unwrapTrustedHTML(_),T)},goog.dom.safe.createImageFromBlob=function(B){if(!/^image\/.*/g.test(B.type))throw Error("goog.dom.safe.createImageFromBlob only accepts MIME type image/.*.");var _=goog.global.URL.createObjectURL(B);return B=new goog.global.Image,B.onload=function(){goog.global.URL.revokeObjectURL(_)},goog.dom.safe.setImageSrc(B,goog.html.uncheckedconversions.safeUrlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Image blob URL."),_)),B},goog.string.DETECT_DOUBLE_ESCAPING=!1,goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1,goog.string.Unicode={NBSP:""},goog.string.startsWith=goog.string.internal.startsWith,goog.string.endsWith=goog.string.internal.endsWith,goog.string.caseInsensitiveStartsWith=goog.string.internal.caseInsensitiveStartsWith,goog.string.caseInsensitiveEndsWith=goog.string.internal.caseInsensitiveEndsWith,goog.string.caseInsensitiveEquals=goog.string.internal.caseInsensitiveEquals,goog.string.subs=function(B,_){for(var T=B.split("%s"),E="",W=Array.prototype.slice.call(arguments,1);W.length&&1<T.length;)E+=T.shift()+W.shift();return E+T.join("%s")},goog.string.collapseWhitespace=function(B){return B.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},goog.string.isEmptyOrWhitespace=goog.string.internal.isEmptyOrWhitespace,goog.string.isEmptyString=function(B){return B.length==0},goog.string.isEmpty=goog.string.isEmptyOrWhitespace,goog.string.isEmptyOrWhitespaceSafe=function(B){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(B))},goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe,goog.string.isBreakingWhitespace=function(B){return!/[^\t\n\r ]/.test(B)},goog.string.isAlpha=function(B){return!/[^a-zA-Z]/.test(B)},goog.string.isNumeric=function(B){return!/[^0-9]/.test(B)},goog.string.isAlphaNumeric=function(B){return!/[^a-zA-Z0-9]/.test(B)},goog.string.isSpace=function(B){return B==" "},goog.string.isUnicodeChar=function(B){return B.length==1&&" "<=B&&"~">=B||""<=B&&"">=B},goog.string.stripNewlines=function(B){return B.replace(/(\r\n|\r|\n)+/g," ")},goog.string.canonicalizeNewlines=function(B){return B.replace(/(\r\n|\r|\n)/g,`
`)},goog.string.normalizeWhitespace=function(B){return B.replace(/\xa0|\s/g," ")},goog.string.normalizeSpaces=function(B){return B.replace(/\xa0|[ \t]+/g," ")},goog.string.collapseBreakingSpaces=function(B){return B.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")},goog.string.trim=goog.string.internal.trim,goog.string.trimLeft=function(B){return B.replace(/^[\s\xa0]+/,"")},goog.string.trimRight=function(B){return B.replace(/[\s\xa0]+$/,"")},goog.string.caseInsensitiveCompare=goog.string.internal.caseInsensitiveCompare,goog.string.numberAwareCompare_=function(B,_,T){if(B==_)return 0;if(!B)return-1;if(!_)return 1;for(var E=B.toLowerCase().match(T),W=_.toLowerCase().match(T),X=Math.min(E.length,W.length),q=0;q<X;q++){T=E[q];var Y=W[q];if(T!=Y)return B=parseInt(T,10),!isNaN(B)&&(_=parseInt(Y,10),!isNaN(_)&&B-_)?B-_:T<Y?-1:1}return E.length!=W.length?E.length-W.length:B<_?-1:1},goog.string.intAwareCompare=function(B,_){return goog.string.numberAwareCompare_(B,_,/\d+|\D+/g)},goog.string.floatAwareCompare=function(B,_){return goog.string.numberAwareCompare_(B,_,/\d+|\.\d+|\D+/g)},goog.string.numerateCompare=goog.string.floatAwareCompare,goog.string.urlEncode=function(B){return encodeURIComponent(String(B))},goog.string.urlDecode=function(B){return decodeURIComponent(B.replace(/\+/g," "))},goog.string.newLineToBr=goog.string.internal.newLineToBr,goog.string.htmlEscape=function(B,_){return B=goog.string.internal.htmlEscape(B,_),goog.string.DETECT_DOUBLE_ESCAPING&&(B=B.replace(goog.string.E_RE_,"&#101;")),B},goog.string.E_RE_=/e/g,goog.string.unescapeEntities=function(B){return goog.string.contains(B,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(B):goog.string.unescapePureXmlEntities_(B):B},goog.string.unescapeEntitiesWithDocument=function(B,_){return goog.string.contains(B,"&")?goog.string.unescapeEntitiesUsingDom_(B,_):B},goog.string.unescapeEntitiesUsingDom_=function(B,_){var T={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},E=_?_.createElement("div"):goog.global.document.createElement("div");return B.replace(goog.string.HTML_ENTITY_PATTERN_,function(W,X){var q=T[W];return q||(X.charAt(0)=="#"&&(X=+("0"+X.substr(1)),isNaN(X)||(q=String.fromCharCode(X))),q||(goog.dom.safe.setInnerHtml(E,goog.html.uncheckedconversions.safeHtmlFromStringKnownToSatisfyTypeContract(goog.string.Const.from("Single HTML entity."),W+" ")),q=E.firstChild.nodeValue.slice(0,-1)),T[W]=q)})},goog.string.unescapePureXmlEntities_=function(B){return B.replace(/&([^;]+);/g,function(_,T){switch(T){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:return T.charAt(0)!="#"||(T=+("0"+T.substr(1)),isNaN(T))?_:String.fromCharCode(T)}})},goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g,goog.string.whitespaceEscape=function(B,_){return goog.string.newLineToBr(B.replace(/  /g," &#160;"),_)},goog.string.preserveSpaces=function(B){return B.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)},goog.string.stripQuotes=function(B,_){for(var T=_.length,E=0;E<T;E++){var W=T==1?_:_.charAt(E);if(B.charAt(0)==W&&B.charAt(B.length-1)==W)return B.substring(1,B.length-1)}return B},goog.string.truncate=function(B,_,T){return T&&(B=goog.string.unescapeEntities(B)),B.length>_&&(B=B.substring(0,_-3)+"..."),T&&(B=goog.string.htmlEscape(B)),B},goog.string.truncateMiddle=function(B,_,T,E){if(T&&(B=goog.string.unescapeEntities(B)),E&&B.length>_){E>_&&(E=_);var W=B.length-E;B=B.substring(0,_-E)+"..."+B.substring(W)}else B.length>_&&(E=Math.floor(_/2),W=B.length-E,B=B.substring(0,E+_%2)+"..."+B.substring(W));return T&&(B=goog.string.htmlEscape(B)),B},goog.string.specialEscapeChars_={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"\\u003C"},goog.string.jsEscapeCache_={"'":"\\'"},goog.string.quote=function(B){B=String(B);for(var _=['"'],T=0;T<B.length;T++){var E=B.charAt(T),W=E.charCodeAt(0);_[T+1]=goog.string.specialEscapeChars_[E]||(31<W&&127>W?E:goog.string.escapeChar(E))}return _.push('"'),_.join("")},goog.string.escapeString=function(B){for(var _=[],T=0;T<B.length;T++)_[T]=goog.string.escapeChar(B.charAt(T));return _.join("")},goog.string.escapeChar=function(B){if(B in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[B];if(B in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[B]=goog.string.specialEscapeChars_[B];var _=B.charCodeAt(0);if(31<_&&127>_)var T=B;else 256>_?(T="\\x",(16>_||256<_)&&(T+="0")):(T="\\u",4096>_&&(T+="0")),T+=_.toString(16).toUpperCase();return goog.string.jsEscapeCache_[B]=T},goog.string.contains=goog.string.internal.contains,goog.string.caseInsensitiveContains=goog.string.internal.caseInsensitiveContains,goog.string.countOf=function(B,_){return B&&_?B.split(_).length-1:0},goog.string.removeAt=function(B,_,T){var E=B;return 0<=_&&_<B.length&&0<T&&(E=B.substr(0,_)+B.substr(_+T,B.length-_-T)),E},goog.string.remove=function(B,_){return B.replace(_,"")},goog.string.removeAll=function(B,_){return _=new RegExp(goog.string.regExpEscape(_),"g"),B.replace(_,"")},goog.string.replaceAll=function(B,_,T){return _=new RegExp(goog.string.regExpEscape(_),"g"),B.replace(_,T.replace(/\$/g,"$$$$"))},goog.string.regExpEscape=function(B){return String(B).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},goog.string.repeat=String.prototype.repeat?function(B,_){return B.repeat(_)}:function(B,_){return Array(_+1).join(B)},goog.string.padNumber=function(B,_,T){return B=goog.isDef(T)?B.toFixed(T):String(B),T=B.indexOf("."),T==-1&&(T=B.length),goog.string.repeat("0",Math.max(0,_-T))+B},goog.string.makeSafe=function(B){return B==null?"":String(B)},goog.string.buildString=function(B){return Array.prototype.join.call(arguments,"")},goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)},goog.string.compareVersions=goog.string.internal.compareVersions,goog.string.hashCode=function(B){for(var _=0,T=0;T<B.length;++T)_=31*_+B.charCodeAt(T)>>>0;return _},goog.string.uniqueStringCounter_=2147483648*Math.random()|0,goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++},goog.string.toNumber=function(B){var _=Number(B);return _==0&&goog.string.isEmptyOrWhitespace(B)?NaN:_},goog.string.isLowerCamelCase=function(B){return/^[a-z]+([A-Z][a-z]*)*$/.test(B)},goog.string.isUpperCamelCase=function(B){return/^([A-Z][a-z]*)+$/.test(B)},goog.string.toCamelCase=function(B){return String(B).replace(/\-([a-z])/g,function(_,T){return T.toUpperCase()})},goog.string.toSelectorCase=function(B){return String(B).replace(/([A-Z])/g,"-$1").toLowerCase()},goog.string.toTitleCase=function(B,_){return _=goog.isString(_)?goog.string.regExpEscape(_):"\\s",B.replace(new RegExp("(^"+(_?"|["+_+"]+":"")+")([a-z])","g"),function(T,E,W){return E+W.toUpperCase()})},goog.string.capitalize=function(B){return String(B.charAt(0)).toUpperCase()+String(B.substr(1)).toLowerCase()},goog.string.parseInt=function(B){return isFinite(B)&&(B=String(B)),goog.isString(B)?/^\s*-?0x/i.test(B)?parseInt(B,16):parseInt(B,10):NaN},goog.string.splitLimit=function(B,_,T){B=B.split(_);for(var E=[];0<T&&B.length;)E.push(B.shift()),T--;return B.length&&E.push(B.join(_)),E},goog.string.lastComponent=function(B,_){if(_)typeof _=="string"&&(_=[_]);else return B;for(var T=-1,E=0;E<_.length;E++)if(_[E]!=""){var W=B.lastIndexOf(_[E]);W>T&&(T=W)}return T==-1?B:B.slice(T+1)},goog.string.editDistance=function(B,_){var T=[],E=[];if(B==_)return 0;if(!B.length||!_.length)return Math.max(B.length,_.length);for(var W=0;W<_.length+1;W++)T[W]=W;for(W=0;W<B.length;W++){E[0]=W+1;for(var X=0;X<_.length;X++)E[X+1]=Math.min(E[X]+1,T[X+1]+1,T[X]+ +(B[W]!=_[X]));for(X=0;X<T.length;X++)T[X]=E[X]}return E[_.length]},goog.labs.userAgent.engine={},goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")},goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")},goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")},goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()},goog.labs.userAgent.engine.getVersion=function(){var B=goog.labs.userAgent.util.getUserAgent();if(B){B=goog.labs.userAgent.util.extractVersionTuples(B);var _=goog.labs.userAgent.engine.getEngineTuple_(B);if(_)return _[0]=="Gecko"?goog.labs.userAgent.engine.getVersionForKey_(B,"Firefox"):_[1];B=B[0];var T;if(B&&(T=B[2])&&(T=/Trident\/([^\s;]+)/.exec(T)))return T[1]}return""},goog.labs.userAgent.engine.getEngineTuple_=function(B){if(!goog.labs.userAgent.engine.isEdge())return B[1];for(var _=0;_<B.length;_++){var T=B[_];if(T[0]=="Edge")return T}},goog.labs.userAgent.engine.isVersionOrHigher=function(B){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),B)},goog.labs.userAgent.engine.getVersionForKey_=function(B,_){return(B=goog.array.find(B,function(T){return _==T[0]}))&&B[1]||""},goog.labs.userAgent.platform={},goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")},goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")},goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")},goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()},goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")},goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")},goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")},goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")},goog.labs.userAgent.platform.isChromecast=function(){return goog.labs.userAgent.util.matchUserAgent("CrKey")},goog.labs.userAgent.platform.isKaiOS=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("KaiOS")},goog.labs.userAgent.platform.isGo2Phone=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("GAFP")},goog.labs.userAgent.platform.getVersion=function(){var B=goog.labs.userAgent.util.getUserAgent(),_="";return goog.labs.userAgent.platform.isWindows()?(_=/Windows (?:NT|Phone) ([0-9.]+)/,_=(B=_.exec(B))?B[1]:"0.0"):goog.labs.userAgent.platform.isIos()?(_=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/,_=(B=_.exec(B))&&B[1].replace(/_/g,".")):goog.labs.userAgent.platform.isMacintosh()?(_=/Mac OS X ([0-9_.]+)/,_=(B=_.exec(B))?B[1].replace(/_/g,"."):"10"):goog.labs.userAgent.platform.isKaiOS()?(_=/(?:KaiOS)\/(\S+)/i,_=(B=_.exec(B))&&B[1]):goog.labs.userAgent.platform.isAndroid()?(_=/Android\s+([^\);]+)(\)|;)/,_=(B=_.exec(B))&&B[1]):goog.labs.userAgent.platform.isChromeOS()&&(_=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/,_=(B=_.exec(B))&&B[1]),_||""},goog.labs.userAgent.platform.isVersionOrHigher=function(B){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),B)},goog.reflect={},goog.reflect.object=function(B,_){return _},goog.reflect.objectProperty=function(B,_){return B},goog.reflect.sinkValue=function(B){return goog.reflect.sinkValue[" "](B),B},goog.reflect.sinkValue[" "]=goog.nullFunction,goog.reflect.canAccessProperty=function(B,_){try{return goog.reflect.sinkValue(B[_]),!0}catch{}return!1},goog.reflect.cache=function(B,_,T,E){return E=E?E(_):_,Object.prototype.hasOwnProperty.call(B,E)?B[E]:B[E]=T(_)},goog.userAgent={},goog.userAgent.ASSUME_IE=!1,goog.userAgent.ASSUME_EDGE=!1,goog.userAgent.ASSUME_GECKO=!1,goog.userAgent.ASSUME_WEBKIT=!1,goog.userAgent.ASSUME_MOBILE_WEBKIT=!1,goog.userAgent.ASSUME_OPERA=!1,goog.userAgent.ASSUME_ANY_VERSION=!1,goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA,goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()},goog.userAgent.getNavigatorTyped=function(){return goog.global.navigator||null},goog.userAgent.getNavigator=function(){return goog.userAgent.getNavigatorTyped()},goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera(),goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE(),goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge(),goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE,goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko(),goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit(),goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")},goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_(),goog.userAgent.SAFARI=goog.userAgent.WEBKIT,goog.userAgent.determinePlatform_=function(){var B=goog.userAgent.getNavigatorTyped();return B&&B.platform||""},goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_(),goog.userAgent.ASSUME_MAC=!1,goog.userAgent.ASSUME_WINDOWS=!1,goog.userAgent.ASSUME_LINUX=!1,goog.userAgent.ASSUME_X11=!1,goog.userAgent.ASSUME_ANDROID=!1,goog.userAgent.ASSUME_IPHONE=!1,goog.userAgent.ASSUME_IPAD=!1,goog.userAgent.ASSUME_IPOD=!1,goog.userAgent.ASSUME_KAIOS=!1,goog.userAgent.ASSUME_GO2PHONE=!1,goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD,goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh(),goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows(),goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()},goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_(),goog.userAgent.isX11_=function(){var B=goog.userAgent.getNavigatorTyped();return!!B&&goog.string.contains(B.appVersion||"","X11")},goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_(),goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid(),goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone(),goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.IPOD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIpod(),goog.userAgent.IOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD||goog.userAgent.ASSUME_IPOD:goog.labs.userAgent.platform.isIos(),goog.userAgent.KAIOS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_KAIOS:goog.labs.userAgent.platform.isKaiOS(),goog.userAgent.GO2PHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_GO2PHONE:goog.labs.userAgent.platform.isGo2Phone(),goog.userAgent.determineVersion_=function(){var B="",_=goog.userAgent.getVersionRegexResult_();return _&&(B=_?_[1]:""),goog.userAgent.IE&&(_=goog.userAgent.getDocumentMode_(),_!=null&&_>parseFloat(B))?String(_):B},goog.userAgent.getVersionRegexResult_=function(){var B=goog.userAgent.getUserAgentString();if(goog.userAgent.GECKO)return/rv:([^\);]+)(\)|;)/.exec(B);if(goog.userAgent.EDGE)return/Edge\/([\d\.]+)/.exec(B);if(goog.userAgent.IE)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(B);if(goog.userAgent.WEBKIT)return/WebKit\/(\S+)/.exec(B);if(goog.userAgent.OPERA)return/(?:Version)[ \/]?(\S+)/.exec(B)},goog.userAgent.getDocumentMode_=function(){var B=goog.global.document;return B?B.documentMode:void 0},goog.userAgent.VERSION=goog.userAgent.determineVersion_(),goog.userAgent.compare=function(B,_){return goog.string.compareVersions(B,_)},goog.userAgent.isVersionOrHigherCache_={},goog.userAgent.isVersionOrHigher=function(B){return goog.userAgent.ASSUME_ANY_VERSION||goog.reflect.cache(goog.userAgent.isVersionOrHigherCache_,B,function(){return 0<=goog.string.compareVersions(goog.userAgent.VERSION,B)})},goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher,goog.userAgent.isDocumentModeOrHigher=function(B){return Number(goog.userAgent.DOCUMENT_MODE)>=B},goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher,goog.userAgent.DOCUMENT_MODE=function(){if(goog.global.document&&goog.userAgent.IE)return goog.userAgent.getDocumentMode_()}(),goog.userAgent.product={},goog.userAgent.product.ASSUME_FIREFOX=!1,goog.userAgent.product.ASSUME_IPHONE=!1,goog.userAgent.product.ASSUME_IPAD=!1,goog.userAgent.product.ASSUME_ANDROID=!1,goog.userAgent.product.ASSUME_CHROME=!1,goog.userAgent.product.ASSUME_SAFARI=!1,goog.userAgent.product.PRODUCT_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_OPERA||goog.userAgent.product.ASSUME_FIREFOX||goog.userAgent.product.ASSUME_IPHONE||goog.userAgent.product.ASSUME_IPAD||goog.userAgent.product.ASSUME_ANDROID||goog.userAgent.product.ASSUME_CHROME||goog.userAgent.product.ASSUME_SAFARI,goog.userAgent.product.OPERA=goog.userAgent.OPERA,goog.userAgent.product.IE=goog.userAgent.IE,goog.userAgent.product.EDGE=goog.userAgent.EDGE,goog.userAgent.product.FIREFOX=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_FIREFOX:goog.labs.userAgent.browser.isFirefox(),goog.userAgent.product.isIphoneOrIpod_=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpod()},goog.userAgent.product.IPHONE=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPHONE:goog.userAgent.product.isIphoneOrIpod_(),goog.userAgent.product.IPAD=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad(),goog.userAgent.product.ANDROID=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_ANDROID:goog.labs.userAgent.browser.isAndroidBrowser(),goog.userAgent.product.CHROME=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_CHROME:goog.labs.userAgent.browser.isChrome(),goog.userAgent.product.isSafariDesktop_=function(){return goog.labs.userAgent.browser.isSafari()&&!goog.labs.userAgent.platform.isIos()},goog.userAgent.product.SAFARI=goog.userAgent.product.PRODUCT_KNOWN_?goog.userAgent.product.ASSUME_SAFARI:goog.userAgent.product.isSafariDesktop_(),goog.crypt.base64={},goog.crypt.base64.DEFAULT_ALPHABET_COMMON_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",goog.crypt.base64.ENCODED_VALS=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_+"+/=",goog.crypt.base64.ENCODED_VALS_WEBSAFE=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_+"-_.",goog.crypt.base64.Alphabet={DEFAULT:0,NO_PADDING:1,WEBSAFE:2,WEBSAFE_DOT_PADDING:3,WEBSAFE_NO_PADDING:4},goog.crypt.base64.paddingChars_="=.",goog.crypt.base64.isPadding_=function(B){return goog.string.contains(goog.crypt.base64.paddingChars_,B)},goog.crypt.base64.byteToCharMaps_={},goog.crypt.base64.charToByteMap_=null,goog.crypt.base64.ASSUME_NATIVE_SUPPORT_=goog.userAgent.GECKO||goog.userAgent.WEBKIT&&!goog.userAgent.product.SAFARI||goog.userAgent.OPERA,goog.crypt.base64.HAS_NATIVE_ENCODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||typeof goog.global.btoa=="function",goog.crypt.base64.HAS_NATIVE_DECODE_=goog.crypt.base64.ASSUME_NATIVE_SUPPORT_||!goog.userAgent.product.SAFARI&&!goog.userAgent.IE&&typeof goog.global.atob=="function",goog.crypt.base64.encodeByteArray=function(B,_){goog.asserts.assert(goog.isArrayLike(B),"encodeByteArray takes an array as a parameter"),_===void 0&&(_=goog.crypt.base64.Alphabet.DEFAULT),goog.crypt.base64.init_(),_=goog.crypt.base64.byteToCharMaps_[_];for(var T=[],E=0;E<B.length;E+=3){var W=B[E],X=E+1<B.length,q=X?B[E+1]:0,Y=E+2<B.length,te=Y?B[E+2]:0,ne=W>>2;W=(W&3)<<4|q>>4,q=(q&15)<<2|te>>6,te&=63,Y||(te=64,X||(q=64)),T.push(_[ne],_[W],_[q]||"",_[te]||"")}return T.join("")},goog.crypt.base64.encodeString=function(B,_){return goog.crypt.base64.HAS_NATIVE_ENCODE_&&!_?goog.global.btoa(B):goog.crypt.base64.encodeByteArray(goog.crypt.stringToByteArray(B),_)},goog.crypt.base64.decodeString=function(B,_){if(goog.crypt.base64.HAS_NATIVE_DECODE_&&!_)return goog.global.atob(B);var T="";return goog.crypt.base64.decodeStringInternal_(B,function(E){T+=String.fromCharCode(E)}),T},goog.crypt.base64.decodeStringToByteArray=function(B,_){var T=[];return goog.crypt.base64.decodeStringInternal_(B,function(E){T.push(E)}),T},goog.crypt.base64.decodeStringToUint8Array=function(B){goog.asserts.assert(!goog.userAgent.IE||goog.userAgent.isVersionOrHigher("10"),"Browser does not support typed arrays");var _=B.length,T=3*_/4;T%3?T=Math.floor(T):goog.crypt.base64.isPadding_(B[_-1])&&(T=goog.crypt.base64.isPadding_(B[_-2])?T-2:T-1);var E=new Uint8Array(T),W=0;return goog.crypt.base64.decodeStringInternal_(B,function(X){E[W++]=X}),E.subarray(0,W)},goog.crypt.base64.decodeStringInternal_=function(B,_){function T(te){for(;E<B.length;){var ne=B.charAt(E++),ae=goog.crypt.base64.charToByteMap_[ne];if(ae!=null)return ae;if(!goog.string.isEmptyOrWhitespace(ne))throw Error("Unknown base64 encoding at char: "+ne)}return te}goog.crypt.base64.init_();for(var E=0;;){var W=T(-1),X=T(0),q=T(64),Y=T(64);if(Y===64&&W===-1)break;_(W<<2|X>>4),q!=64&&(_(X<<4&240|q>>2),Y!=64&&_(q<<6&192|Y))}},goog.crypt.base64.init_=function(){if(!goog.crypt.base64.charToByteMap_){goog.crypt.base64.charToByteMap_={};for(var B=goog.crypt.base64.DEFAULT_ALPHABET_COMMON_.split(""),_=["+/=","+/","-_=","-_.","-_"],T=0;5>T;T++){var E=B.concat(_[T].split(""));goog.crypt.base64.byteToCharMaps_[T]=E;for(var W=0;W<E.length;W++){var X=E[W],q=goog.crypt.base64.charToByteMap_[X];q===void 0?goog.crypt.base64.charToByteMap_[X]=W:goog.asserts.assert(q===W)}}}},jspb.utils={},jspb.utils.split64Low=0,jspb.utils.split64High=0,jspb.utils.splitUint64=function(B){var _=B>>>0;B=Math.floor((B-_)/jspb.BinaryConstants.TWO_TO_32)>>>0,jspb.utils.split64Low=_,jspb.utils.split64High=B},jspb.utils.splitInt64=function(B){var _=0>B;B=Math.abs(B);var T=B>>>0;B=Math.floor((B-T)/jspb.BinaryConstants.TWO_TO_32),B>>>=0,_&&(B=~B>>>0,T=(~T>>>0)+1,4294967295<T&&(T=0,B++,4294967295<B&&(B=0))),jspb.utils.split64Low=T,jspb.utils.split64High=B},jspb.utils.splitZigzag64=function(B){var _=0>B;B=2*Math.abs(B),jspb.utils.splitUint64(B),B=jspb.utils.split64Low;var T=jspb.utils.split64High;_&&(B==0?T==0?T=B=4294967295:(T--,B=4294967295):B--),jspb.utils.split64Low=B,jspb.utils.split64High=T},jspb.utils.splitFloat32=function(B){var _=0>B?1:0;if(B=_?-B:B,B===0)0<1/B?(jspb.utils.split64High=0,jspb.utils.split64Low=0):(jspb.utils.split64High=0,jspb.utils.split64Low=2147483648);else if(isNaN(B))jspb.utils.split64High=0,jspb.utils.split64Low=2147483647;else if(B>jspb.BinaryConstants.FLOAT32_MAX)jspb.utils.split64High=0,jspb.utils.split64Low=(_<<31|2139095040)>>>0;else if(B<jspb.BinaryConstants.FLOAT32_MIN)B=Math.round(B/Math.pow(2,-149)),jspb.utils.split64High=0,jspb.utils.split64Low=(_<<31|B)>>>0;else{var T=Math.floor(Math.log(B)/Math.LN2);B*=Math.pow(2,-T),B=Math.round(B*jspb.BinaryConstants.TWO_TO_23)&8388607,jspb.utils.split64High=0,jspb.utils.split64Low=(_<<31|T+127<<23|B)>>>0}},jspb.utils.splitFloat64=function(B){var _=0>B?1:0;if(B=_?-B:B,B===0)jspb.utils.split64High=0<1/B?0:2147483648,jspb.utils.split64Low=0;else if(isNaN(B))jspb.utils.split64High=2147483647,jspb.utils.split64Low=4294967295;else if(B>jspb.BinaryConstants.FLOAT64_MAX)jspb.utils.split64High=(_<<31|2146435072)>>>0,jspb.utils.split64Low=0;else if(B<jspb.BinaryConstants.FLOAT64_MIN){var T=B/Math.pow(2,-1074);B=T/jspb.BinaryConstants.TWO_TO_32,jspb.utils.split64High=(_<<31|B)>>>0,jspb.utils.split64Low=T>>>0}else{T=B;var E=0;if(2<=T)for(;2<=T&&1023>E;)E++,T/=2;else for(;1>T&&-1022<E;)T*=2,E--;T=B*Math.pow(2,-E),B=T*jspb.BinaryConstants.TWO_TO_20&1048575,T=T*jspb.BinaryConstants.TWO_TO_52>>>0,jspb.utils.split64High=(_<<31|E+1023<<20|B)>>>0,jspb.utils.split64Low=T}},jspb.utils.splitHash64=function(B){var _=B.charCodeAt(0),T=B.charCodeAt(1),E=B.charCodeAt(2),W=B.charCodeAt(3),X=B.charCodeAt(4),q=B.charCodeAt(5),Y=B.charCodeAt(6);B=B.charCodeAt(7),jspb.utils.split64Low=_+(T<<8)+(E<<16)+(W<<24)>>>0,jspb.utils.split64High=X+(q<<8)+(Y<<16)+(B<<24)>>>0},jspb.utils.joinUint64=function(B,_){return _*jspb.BinaryConstants.TWO_TO_32+(B>>>0)},jspb.utils.joinInt64=function(B,_){var T=_&2147483648;return T&&(B=~B+1>>>0,_=~_>>>0,B==0&&(_=_+1>>>0)),B=jspb.utils.joinUint64(B,_),T?-B:B},jspb.utils.toZigzag64=function(B,_,T){var E=_>>31;return T(B<<1^E,(_<<1|B>>>31)^E)},jspb.utils.joinZigzag64=function(B,_){return jspb.utils.fromZigzag64(B,_,jspb.utils.joinInt64)},jspb.utils.fromZigzag64=function(B,_,T){var E=-(B&1);return T((B>>>1|_<<31)^E,_>>>1^E)},jspb.utils.joinFloat32=function(B,_){_=2*(B>>31)+1;var T=B>>>23&255;return B&=8388607,T==255?B?NaN:1/0*_:T==0?_*Math.pow(2,-149)*B:_*Math.pow(2,T-150)*(B+Math.pow(2,23))},jspb.utils.joinFloat64=function(B,_){var T=2*(_>>31)+1,E=_>>>20&2047;return B=jspb.BinaryConstants.TWO_TO_32*(_&1048575)+B,E==2047?B?NaN:1/0*T:E==0?T*Math.pow(2,-1074)*B:T*Math.pow(2,E-1075)*(B+jspb.BinaryConstants.TWO_TO_52)},jspb.utils.joinHash64=function(B,_){return String.fromCharCode(B>>>0&255,B>>>8&255,B>>>16&255,B>>>24&255,_>>>0&255,_>>>8&255,_>>>16&255,_>>>24&255)},jspb.utils.DIGITS="0123456789abcdef".split(""),jspb.utils.ZERO_CHAR_CODE_=48,jspb.utils.A_CHAR_CODE_=97,jspb.utils.joinUnsignedDecimalString=function(B,_){function T(W,X){return W=W?String(W):"",X?"0000000".slice(W.length)+W:W}if(2097151>=_)return""+jspb.utils.joinUint64(B,_);var E=(B>>>24|_<<8)>>>0&16777215;return _=_>>16&65535,B=(B&16777215)+6777216*E+6710656*_,E+=8147497*_,_*=2,1e7<=B&&(E+=Math.floor(B/1e7),B%=1e7),1e7<=E&&(_+=Math.floor(E/1e7),E%=1e7),T(_,0)+T(E,_)+T(B,1)},jspb.utils.joinSignedDecimalString=function(B,_){var T=_&2147483648;return T&&(B=~B+1>>>0,_=~_+(B==0?1:0)>>>0),B=jspb.utils.joinUnsignedDecimalString(B,_),T?"-"+B:B},jspb.utils.hash64ToDecimalString=function(B,_){jspb.utils.splitHash64(B),B=jspb.utils.split64Low;var T=jspb.utils.split64High;return _?jspb.utils.joinSignedDecimalString(B,T):jspb.utils.joinUnsignedDecimalString(B,T)},jspb.utils.hash64ArrayToDecimalStrings=function(B,_){for(var T=Array(B.length),E=0;E<B.length;E++)T[E]=jspb.utils.hash64ToDecimalString(B[E],_);return T},jspb.utils.decimalStringToHash64=function(B){function _(q,Y){for(var te=0;8>te&&(q!==1||0<Y);te++)Y=q*W[te]+Y,W[te]=Y&255,Y>>>=8}function T(){for(var q=0;8>q;q++)W[q]=~W[q]&255}goog.asserts.assert(0<B.length);var E=!1;B[0]==="-"&&(E=!0,B=B.slice(1));for(var W=[0,0,0,0,0,0,0,0],X=0;X<B.length;X++)_(10,B.charCodeAt(X)-jspb.utils.ZERO_CHAR_CODE_);return E&&(T(),_(1,1)),goog.crypt.byteArrayToString(W)},jspb.utils.splitDecimalString=function(B){jspb.utils.splitHash64(jspb.utils.decimalStringToHash64(B))},jspb.utils.toHexDigit_=function(B){return String.fromCharCode(10>B?jspb.utils.ZERO_CHAR_CODE_+B:jspb.utils.A_CHAR_CODE_-10+B)},jspb.utils.fromHexCharCode_=function(B){return B>=jspb.utils.A_CHAR_CODE_?B-jspb.utils.A_CHAR_CODE_+10:B-jspb.utils.ZERO_CHAR_CODE_},jspb.utils.hash64ToHexString=function(B){var _=Array(18);_[0]="0",_[1]="x";for(var T=0;8>T;T++){var E=B.charCodeAt(7-T);_[2*T+2]=jspb.utils.toHexDigit_(E>>4),_[2*T+3]=jspb.utils.toHexDigit_(E&15)}return _.join("")},jspb.utils.hexStringToHash64=function(B){B=B.toLowerCase(),goog.asserts.assert(B.length==18),goog.asserts.assert(B[0]=="0"),goog.asserts.assert(B[1]=="x");for(var _="",T=0;8>T;T++){var E=jspb.utils.fromHexCharCode_(B.charCodeAt(2*T+2)),W=jspb.utils.fromHexCharCode_(B.charCodeAt(2*T+3));_=String.fromCharCode(16*E+W)+_}return _},jspb.utils.hash64ToNumber=function(B,_){jspb.utils.splitHash64(B),B=jspb.utils.split64Low;var T=jspb.utils.split64High;return _?jspb.utils.joinInt64(B,T):jspb.utils.joinUint64(B,T)},jspb.utils.numberToHash64=function(B){return jspb.utils.splitInt64(B),jspb.utils.joinHash64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.utils.countVarints=function(B,_,T){for(var E=0,W=_;W<T;W++)E+=B[W]>>7;return T-_-E},jspb.utils.countVarintFields=function(B,_,T,E){var W=0;if(E=8*E+jspb.BinaryConstants.WireType.VARINT,128>E)for(;_<T&&B[_++]==E;)for(W++;;){var X=B[_++];if(!(X&128))break}else for(;_<T;){for(X=E;128<X;){if(B[_]!=(X&127|128))return W;_++,X>>=7}if(B[_++]!=X)break;for(W++;X=B[_++],(X&128)!=0;);}return W},jspb.utils.countFixedFields_=function(B,_,T,E,W){var X=0;if(128>E)for(;_<T&&B[_++]==E;)X++,_+=W;else for(;_<T;){for(var q=E;128<q;){if(B[_++]!=(q&127|128))return X;q>>=7}if(B[_++]!=q)break;X++,_+=W}return X},jspb.utils.countFixed32Fields=function(B,_,T,E){return jspb.utils.countFixedFields_(B,_,T,8*E+jspb.BinaryConstants.WireType.FIXED32,4)},jspb.utils.countFixed64Fields=function(B,_,T,E){return jspb.utils.countFixedFields_(B,_,T,8*E+jspb.BinaryConstants.WireType.FIXED64,8)},jspb.utils.countDelimitedFields=function(B,_,T,E){var W=0;for(E=8*E+jspb.BinaryConstants.WireType.DELIMITED;_<T;){for(var X=E;128<X;){if(B[_++]!=(X&127|128))return W;X>>=7}if(B[_++]!=X)break;W++;for(var q=0,Y=1;X=B[_++],q+=(X&127)*Y,Y*=128,(X&128)!=0;);_+=q}return W},jspb.utils.debugBytesToTextFormat=function(B){var _='"';if(B){B=jspb.utils.byteSourceToUint8Array(B);for(var T=0;T<B.length;T++)_+="\\x",16>B[T]&&(_+="0"),_+=B[T].toString(16)}return _+'"'},jspb.utils.debugScalarToTextFormat=function(B){return typeof B=="string"?goog.string.quote(B):B.toString()},jspb.utils.stringToByteArray=function(B){for(var _=new Uint8Array(B.length),T=0;T<B.length;T++){var E=B.charCodeAt(T);if(255<E)throw Error("Conversion error: string contains codepoint outside of byte range");_[T]=E}return _},jspb.utils.byteSourceToUint8Array=function(B){return B.constructor===Uint8Array?B:B.constructor===ArrayBuffer||typeof Buffer<"u"&&B.constructor===Buffer||B.constructor===Array?new Uint8Array(B):B.constructor===String?goog.crypt.base64.decodeStringToUint8Array(B):(goog.asserts.fail("Type not convertible to Uint8Array."),new Uint8Array(0))},jspb.BinaryDecoder=function(B,_,T){this.bytes_=null,this.cursor_=this.end_=this.start_=0,this.error_=!1,B&&this.setBlock(B,_,T)},jspb.BinaryDecoder.instanceCache_=[],jspb.BinaryDecoder.alloc=function(B,_,T){if(jspb.BinaryDecoder.instanceCache_.length){var E=jspb.BinaryDecoder.instanceCache_.pop();return B&&E.setBlock(B,_,T),E}return new jspb.BinaryDecoder(B,_,T)},jspb.BinaryDecoder.prototype.free=function(){this.clear(),100>jspb.BinaryDecoder.instanceCache_.length&&jspb.BinaryDecoder.instanceCache_.push(this)},jspb.BinaryDecoder.prototype.clone=function(){return jspb.BinaryDecoder.alloc(this.bytes_,this.start_,this.end_-this.start_)},jspb.BinaryDecoder.prototype.clear=function(){this.bytes_=null,this.cursor_=this.end_=this.start_=0,this.error_=!1},jspb.BinaryDecoder.prototype.getBuffer=function(){return this.bytes_},jspb.BinaryDecoder.prototype.setBlock=function(B,_,T){this.bytes_=jspb.utils.byteSourceToUint8Array(B),this.start_=_!==void 0?_:0,this.end_=T!==void 0?this.start_+T:this.bytes_.length,this.cursor_=this.start_},jspb.BinaryDecoder.prototype.getEnd=function(){return this.end_},jspb.BinaryDecoder.prototype.setEnd=function(B){this.end_=B},jspb.BinaryDecoder.prototype.reset=function(){this.cursor_=this.start_},jspb.BinaryDecoder.prototype.getCursor=function(){return this.cursor_},jspb.BinaryDecoder.prototype.setCursor=function(B){this.cursor_=B},jspb.BinaryDecoder.prototype.advance=function(B){this.cursor_+=B,goog.asserts.assert(this.cursor_<=this.end_)},jspb.BinaryDecoder.prototype.atEnd=function(){return this.cursor_==this.end_},jspb.BinaryDecoder.prototype.pastEnd=function(){return this.cursor_>this.end_},jspb.BinaryDecoder.prototype.getError=function(){return this.error_||0>this.cursor_||this.cursor_>this.end_},jspb.BinaryDecoder.prototype.readSplitVarint64=function(B){for(var _=128,T=0,E=0,W=0;4>W&&128<=_;W++)_=this.bytes_[this.cursor_++],T|=(_&127)<<7*W;if(128<=_&&(_=this.bytes_[this.cursor_++],T|=(_&127)<<28,E|=(_&127)>>4),128<=_)for(W=0;5>W&&128<=_;W++)_=this.bytes_[this.cursor_++],E|=(_&127)<<7*W+3;if(128>_)return B(T>>>0,E>>>0);goog.asserts.fail("Failed to read varint, encoding is invalid."),this.error_=!0},jspb.BinaryDecoder.prototype.readSplitZigzagVarint64=function(B){return this.readSplitVarint64(function(_,T){return jspb.utils.fromZigzag64(_,T,B)})},jspb.BinaryDecoder.prototype.readSplitFixed64=function(B){var _=this.bytes_,T=this.cursor_;this.cursor_+=8;for(var E=0,W=0,X=T+7;X>=T;X--)E=E<<8|_[X],W=W<<8|_[X+4];return B(E,W)},jspb.BinaryDecoder.prototype.skipVarint=function(){for(;this.bytes_[this.cursor_]&128;)this.cursor_++;this.cursor_++},jspb.BinaryDecoder.prototype.unskipVarint=function(B){for(;128<B;)this.cursor_--,B>>>=7;this.cursor_--},jspb.BinaryDecoder.prototype.readUnsignedVarint32=function(){var B=this.bytes_,_=B[this.cursor_+0],T=_&127;return 128>_?(this.cursor_+=1,goog.asserts.assert(this.cursor_<=this.end_),T):(_=B[this.cursor_+1],T|=(_&127)<<7,128>_?(this.cursor_+=2,goog.asserts.assert(this.cursor_<=this.end_),T):(_=B[this.cursor_+2],T|=(_&127)<<14,128>_?(this.cursor_+=3,goog.asserts.assert(this.cursor_<=this.end_),T):(_=B[this.cursor_+3],T|=(_&127)<<21,128>_?(this.cursor_+=4,goog.asserts.assert(this.cursor_<=this.end_),T):(_=B[this.cursor_+4],T|=(_&15)<<28,128>_?(this.cursor_+=5,goog.asserts.assert(this.cursor_<=this.end_),T>>>0):(this.cursor_+=5,128<=B[this.cursor_++]&&128<=B[this.cursor_++]&&128<=B[this.cursor_++]&&128<=B[this.cursor_++]&&128<=B[this.cursor_++]&&goog.asserts.assert(!1),goog.asserts.assert(this.cursor_<=this.end_),T)))))},jspb.BinaryDecoder.prototype.readSignedVarint32=jspb.BinaryDecoder.prototype.readUnsignedVarint32,jspb.BinaryDecoder.prototype.readUnsignedVarint32String=function(){return this.readUnsignedVarint32().toString()},jspb.BinaryDecoder.prototype.readSignedVarint32String=function(){return this.readSignedVarint32().toString()},jspb.BinaryDecoder.prototype.readZigzagVarint32=function(){var B=this.readUnsignedVarint32();return B>>>1^-(B&1)},jspb.BinaryDecoder.prototype.readUnsignedVarint64=function(){return this.readSplitVarint64(jspb.utils.joinUint64)},jspb.BinaryDecoder.prototype.readUnsignedVarint64String=function(){return this.readSplitVarint64(jspb.utils.joinUnsignedDecimalString)},jspb.BinaryDecoder.prototype.readSignedVarint64=function(){return this.readSplitVarint64(jspb.utils.joinInt64)},jspb.BinaryDecoder.prototype.readSignedVarint64String=function(){return this.readSplitVarint64(jspb.utils.joinSignedDecimalString)},jspb.BinaryDecoder.prototype.readZigzagVarint64=function(){return this.readSplitVarint64(jspb.utils.joinZigzag64)},jspb.BinaryDecoder.prototype.readZigzagVarintHash64=function(){return this.readSplitZigzagVarint64(jspb.utils.joinHash64)},jspb.BinaryDecoder.prototype.readZigzagVarint64String=function(){return this.readSplitZigzagVarint64(jspb.utils.joinSignedDecimalString)},jspb.BinaryDecoder.prototype.readUint8=function(){var B=this.bytes_[this.cursor_+0];return this.cursor_+=1,goog.asserts.assert(this.cursor_<=this.end_),B},jspb.BinaryDecoder.prototype.readUint16=function(){var B=this.bytes_[this.cursor_+0],_=this.bytes_[this.cursor_+1];return this.cursor_+=2,goog.asserts.assert(this.cursor_<=this.end_),B<<0|_<<8},jspb.BinaryDecoder.prototype.readUint32=function(){var B=this.bytes_[this.cursor_+0],_=this.bytes_[this.cursor_+1],T=this.bytes_[this.cursor_+2],E=this.bytes_[this.cursor_+3];return this.cursor_+=4,goog.asserts.assert(this.cursor_<=this.end_),(B<<0|_<<8|T<<16|E<<24)>>>0},jspb.BinaryDecoder.prototype.readUint64=function(){var B=this.readUint32(),_=this.readUint32();return jspb.utils.joinUint64(B,_)},jspb.BinaryDecoder.prototype.readUint64String=function(){var B=this.readUint32(),_=this.readUint32();return jspb.utils.joinUnsignedDecimalString(B,_)},jspb.BinaryDecoder.prototype.readInt8=function(){var B=this.bytes_[this.cursor_+0];return this.cursor_+=1,goog.asserts.assert(this.cursor_<=this.end_),B<<24>>24},jspb.BinaryDecoder.prototype.readInt16=function(){var B=this.bytes_[this.cursor_+0],_=this.bytes_[this.cursor_+1];return this.cursor_+=2,goog.asserts.assert(this.cursor_<=this.end_),(B<<0|_<<8)<<16>>16},jspb.BinaryDecoder.prototype.readInt32=function(){var B=this.bytes_[this.cursor_+0],_=this.bytes_[this.cursor_+1],T=this.bytes_[this.cursor_+2],E=this.bytes_[this.cursor_+3];return this.cursor_+=4,goog.asserts.assert(this.cursor_<=this.end_),B<<0|_<<8|T<<16|E<<24},jspb.BinaryDecoder.prototype.readInt64=function(){var B=this.readUint32(),_=this.readUint32();return jspb.utils.joinInt64(B,_)},jspb.BinaryDecoder.prototype.readInt64String=function(){var B=this.readUint32(),_=this.readUint32();return jspb.utils.joinSignedDecimalString(B,_)},jspb.BinaryDecoder.prototype.readFloat=function(){var B=this.readUint32();return jspb.utils.joinFloat32(B,0)},jspb.BinaryDecoder.prototype.readDouble=function(){var B=this.readUint32(),_=this.readUint32();return jspb.utils.joinFloat64(B,_)},jspb.BinaryDecoder.prototype.readBool=function(){return!!this.bytes_[this.cursor_++]},jspb.BinaryDecoder.prototype.readEnum=function(){return this.readSignedVarint32()},jspb.BinaryDecoder.prototype.readString=function(B){var _=this.bytes_,T=this.cursor_;B=T+B;for(var E=[],W="";T<B;){var X=_[T++];if(128>X)E.push(X);else{if(192>X)continue;if(224>X){var q=_[T++];E.push((X&31)<<6|q&63)}else if(240>X){q=_[T++];var Y=_[T++];E.push((X&15)<<12|(q&63)<<6|Y&63)}else if(248>X){q=_[T++],Y=_[T++];var te=_[T++];X=(X&7)<<18|(q&63)<<12|(Y&63)<<6|te&63,X-=65536,E.push((X>>10&1023)+55296,(X&1023)+56320)}}8192<=E.length&&(W+=String.fromCharCode.apply(null,E),E.length=0)}return W+=goog.crypt.byteArrayToString(E),this.cursor_=T,W},jspb.BinaryDecoder.prototype.readStringWithLength=function(){var B=this.readUnsignedVarint32();return this.readString(B)},jspb.BinaryDecoder.prototype.readBytes=function(B){if(0>B||this.cursor_+B>this.bytes_.length)return this.error_=!0,goog.asserts.fail("Invalid byte length!"),new Uint8Array(0);var _=this.bytes_.subarray(this.cursor_,this.cursor_+B);return this.cursor_+=B,goog.asserts.assert(this.cursor_<=this.end_),_},jspb.BinaryDecoder.prototype.readVarintHash64=function(){return this.readSplitVarint64(jspb.utils.joinHash64)},jspb.BinaryDecoder.prototype.readFixedHash64=function(){var B=this.bytes_,_=this.cursor_,T=B[_+0],E=B[_+1],W=B[_+2],X=B[_+3],q=B[_+4],Y=B[_+5],te=B[_+6];return B=B[_+7],this.cursor_+=8,String.fromCharCode(T,E,W,X,q,Y,te,B)},jspb.BinaryReader=function(B,_,T){this.decoder_=jspb.BinaryDecoder.alloc(B,_,T),this.fieldCursor_=this.decoder_.getCursor(),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID,this.error_=!1,this.readCallbacks_=null},jspb.BinaryReader.instanceCache_=[],jspb.BinaryReader.alloc=function(B,_,T){if(jspb.BinaryReader.instanceCache_.length){var E=jspb.BinaryReader.instanceCache_.pop();return B&&E.decoder_.setBlock(B,_,T),E}return new jspb.BinaryReader(B,_,T)},jspb.BinaryReader.prototype.alloc=jspb.BinaryReader.alloc,jspb.BinaryReader.prototype.free=function(){this.decoder_.clear(),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID,this.error_=!1,this.readCallbacks_=null,100>jspb.BinaryReader.instanceCache_.length&&jspb.BinaryReader.instanceCache_.push(this)},jspb.BinaryReader.prototype.getFieldCursor=function(){return this.fieldCursor_},jspb.BinaryReader.prototype.getCursor=function(){return this.decoder_.getCursor()},jspb.BinaryReader.prototype.getBuffer=function(){return this.decoder_.getBuffer()},jspb.BinaryReader.prototype.getFieldNumber=function(){return this.nextField_},jspb.BinaryReader.prototype.getWireType=function(){return this.nextWireType_},jspb.BinaryReader.prototype.isDelimited=function(){return this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED},jspb.BinaryReader.prototype.isEndGroup=function(){return this.nextWireType_==jspb.BinaryConstants.WireType.END_GROUP},jspb.BinaryReader.prototype.getError=function(){return this.error_||this.decoder_.getError()},jspb.BinaryReader.prototype.setBlock=function(B,_,T){this.decoder_.setBlock(B,_,T),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID},jspb.BinaryReader.prototype.reset=function(){this.decoder_.reset(),this.nextField_=jspb.BinaryConstants.INVALID_FIELD_NUMBER,this.nextWireType_=jspb.BinaryConstants.WireType.INVALID},jspb.BinaryReader.prototype.advance=function(B){this.decoder_.advance(B)},jspb.BinaryReader.prototype.nextField=function(){if(this.decoder_.atEnd())return!1;if(this.getError())return goog.asserts.fail("Decoder hit an error"),!1;this.fieldCursor_=this.decoder_.getCursor();var B=this.decoder_.readUnsignedVarint32(),_=B>>>3;return B&=7,B!=jspb.BinaryConstants.WireType.VARINT&&B!=jspb.BinaryConstants.WireType.FIXED32&&B!=jspb.BinaryConstants.WireType.FIXED64&&B!=jspb.BinaryConstants.WireType.DELIMITED&&B!=jspb.BinaryConstants.WireType.START_GROUP&&B!=jspb.BinaryConstants.WireType.END_GROUP?(goog.asserts.fail("Invalid wire type: %s (at position %s)",B,this.fieldCursor_),this.error_=!0,!1):(this.nextField_=_,this.nextWireType_=B,!0)},jspb.BinaryReader.prototype.unskipHeader=function(){this.decoder_.unskipVarint(this.nextField_<<3|this.nextWireType_)},jspb.BinaryReader.prototype.skipMatchingFields=function(){var B=this.nextField_;for(this.unskipHeader();this.nextField()&&this.getFieldNumber()==B;)this.skipField();this.decoder_.atEnd()||this.unskipHeader()},jspb.BinaryReader.prototype.skipVarintField=function(){this.nextWireType_!=jspb.BinaryConstants.WireType.VARINT?(goog.asserts.fail("Invalid wire type for skipVarintField"),this.skipField()):this.decoder_.skipVarint()},jspb.BinaryReader.prototype.skipDelimitedField=function(){if(this.nextWireType_!=jspb.BinaryConstants.WireType.DELIMITED)goog.asserts.fail("Invalid wire type for skipDelimitedField"),this.skipField();else{var B=this.decoder_.readUnsignedVarint32();this.decoder_.advance(B)}},jspb.BinaryReader.prototype.skipFixed32Field=function(){this.nextWireType_!=jspb.BinaryConstants.WireType.FIXED32?(goog.asserts.fail("Invalid wire type for skipFixed32Field"),this.skipField()):this.decoder_.advance(4)},jspb.BinaryReader.prototype.skipFixed64Field=function(){this.nextWireType_!=jspb.BinaryConstants.WireType.FIXED64?(goog.asserts.fail("Invalid wire type for skipFixed64Field"),this.skipField()):this.decoder_.advance(8)},jspb.BinaryReader.prototype.skipGroup=function(){var B=this.nextField_;do{if(!this.nextField()){goog.asserts.fail("Unmatched start-group tag: stream EOF"),this.error_=!0;break}if(this.nextWireType_==jspb.BinaryConstants.WireType.END_GROUP){this.nextField_!=B&&(goog.asserts.fail("Unmatched end-group tag"),this.error_=!0);break}this.skipField()}while(!0)},jspb.BinaryReader.prototype.skipField=function(){switch(this.nextWireType_){case jspb.BinaryConstants.WireType.VARINT:this.skipVarintField();break;case jspb.BinaryConstants.WireType.FIXED64:this.skipFixed64Field();break;case jspb.BinaryConstants.WireType.DELIMITED:this.skipDelimitedField();break;case jspb.BinaryConstants.WireType.FIXED32:this.skipFixed32Field();break;case jspb.BinaryConstants.WireType.START_GROUP:this.skipGroup();break;default:goog.asserts.fail("Invalid wire encoding for field.")}},jspb.BinaryReader.prototype.registerReadCallback=function(B,_){this.readCallbacks_===null&&(this.readCallbacks_={}),goog.asserts.assert(!this.readCallbacks_[B]),this.readCallbacks_[B]=_},jspb.BinaryReader.prototype.runReadCallback=function(B){return goog.asserts.assert(this.readCallbacks_!==null),B=this.readCallbacks_[B],goog.asserts.assert(B),B(this)},jspb.BinaryReader.prototype.readAny=function(B){this.nextWireType_=jspb.BinaryConstants.FieldTypeToWireType(B);var _=jspb.BinaryConstants.FieldType;switch(B){case _.DOUBLE:return this.readDouble();case _.FLOAT:return this.readFloat();case _.INT64:return this.readInt64();case _.UINT64:return this.readUint64();case _.INT32:return this.readInt32();case _.FIXED64:return this.readFixed64();case _.FIXED32:return this.readFixed32();case _.BOOL:return this.readBool();case _.STRING:return this.readString();case _.GROUP:goog.asserts.fail("Group field type not supported in readAny()");case _.MESSAGE:goog.asserts.fail("Message field type not supported in readAny()");case _.BYTES:return this.readBytes();case _.UINT32:return this.readUint32();case _.ENUM:return this.readEnum();case _.SFIXED32:return this.readSfixed32();case _.SFIXED64:return this.readSfixed64();case _.SINT32:return this.readSint32();case _.SINT64:return this.readSint64();case _.FHASH64:return this.readFixedHash64();case _.VHASH64:return this.readVarintHash64();default:goog.asserts.fail("Invalid field type in readAny()")}return 0},jspb.BinaryReader.prototype.readMessage=function(B,_){goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var T=this.decoder_.getEnd(),E=this.decoder_.readUnsignedVarint32();E=this.decoder_.getCursor()+E,this.decoder_.setEnd(E),_(B,this),this.decoder_.setCursor(E),this.decoder_.setEnd(T)},jspb.BinaryReader.prototype.readGroup=function(B,_,T){goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.START_GROUP),goog.asserts.assert(this.nextField_==B),T(_,this),this.error_||this.nextWireType_==jspb.BinaryConstants.WireType.END_GROUP||(goog.asserts.fail("Group submessage did not end with an END_GROUP tag"),this.error_=!0)},jspb.BinaryReader.prototype.getFieldDecoder=function(){goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var B=this.decoder_.readUnsignedVarint32(),_=this.decoder_.getCursor(),T=_+B;return B=jspb.BinaryDecoder.alloc(this.decoder_.getBuffer(),_,B),this.decoder_.setCursor(T),B},jspb.BinaryReader.prototype.readInt32=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint32()},jspb.BinaryReader.prototype.readInt32String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint32String()},jspb.BinaryReader.prototype.readInt64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint64()},jspb.BinaryReader.prototype.readInt64String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint64String()},jspb.BinaryReader.prototype.readUint32=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint32()},jspb.BinaryReader.prototype.readUint32String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint32String()},jspb.BinaryReader.prototype.readUint64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint64()},jspb.BinaryReader.prototype.readUint64String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readUnsignedVarint64String()},jspb.BinaryReader.prototype.readSint32=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarint32()},jspb.BinaryReader.prototype.readSint64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarint64()},jspb.BinaryReader.prototype.readSint64String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarint64String()},jspb.BinaryReader.prototype.readFixed32=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readUint32()},jspb.BinaryReader.prototype.readFixed64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readUint64()},jspb.BinaryReader.prototype.readFixed64String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readUint64String()},jspb.BinaryReader.prototype.readSfixed32=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readInt32()},jspb.BinaryReader.prototype.readSfixed32String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readInt32().toString()},jspb.BinaryReader.prototype.readSfixed64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readInt64()},jspb.BinaryReader.prototype.readSfixed64String=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readInt64String()},jspb.BinaryReader.prototype.readFloat=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED32),this.decoder_.readFloat()},jspb.BinaryReader.prototype.readDouble=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readDouble()},jspb.BinaryReader.prototype.readBool=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),!!this.decoder_.readUnsignedVarint32()},jspb.BinaryReader.prototype.readEnum=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSignedVarint64()},jspb.BinaryReader.prototype.readString=function(){goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var B=this.decoder_.readUnsignedVarint32();return this.decoder_.readString(B)},jspb.BinaryReader.prototype.readBytes=function(){goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var B=this.decoder_.readUnsignedVarint32();return this.decoder_.readBytes(B)},jspb.BinaryReader.prototype.readVarintHash64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readVarintHash64()},jspb.BinaryReader.prototype.readSintHash64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readZigzagVarintHash64()},jspb.BinaryReader.prototype.readSplitVarint64=function(B){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSplitVarint64(B)},jspb.BinaryReader.prototype.readSplitZigzagVarint64=function(B){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.VARINT),this.decoder_.readSplitVarint64(function(_,T){return jspb.utils.fromZigzag64(_,T,B)})},jspb.BinaryReader.prototype.readFixedHash64=function(){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readFixedHash64()},jspb.BinaryReader.prototype.readSplitFixed64=function(B){return goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.FIXED64),this.decoder_.readSplitFixed64(B)},jspb.BinaryReader.prototype.readPackedField_=function(B){goog.asserts.assert(this.nextWireType_==jspb.BinaryConstants.WireType.DELIMITED);var _=this.decoder_.readUnsignedVarint32();_=this.decoder_.getCursor()+_;for(var T=[];this.decoder_.getCursor()<_;)T.push(B.call(this.decoder_));return T},jspb.BinaryReader.prototype.readPackedInt32=function(){return this.readPackedField_(this.decoder_.readSignedVarint32)},jspb.BinaryReader.prototype.readPackedInt32String=function(){return this.readPackedField_(this.decoder_.readSignedVarint32String)},jspb.BinaryReader.prototype.readPackedInt64=function(){return this.readPackedField_(this.decoder_.readSignedVarint64)},jspb.BinaryReader.prototype.readPackedInt64String=function(){return this.readPackedField_(this.decoder_.readSignedVarint64String)},jspb.BinaryReader.prototype.readPackedUint32=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint32)},jspb.BinaryReader.prototype.readPackedUint32String=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint32String)},jspb.BinaryReader.prototype.readPackedUint64=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint64)},jspb.BinaryReader.prototype.readPackedUint64String=function(){return this.readPackedField_(this.decoder_.readUnsignedVarint64String)},jspb.BinaryReader.prototype.readPackedSint32=function(){return this.readPackedField_(this.decoder_.readZigzagVarint32)},jspb.BinaryReader.prototype.readPackedSint64=function(){return this.readPackedField_(this.decoder_.readZigzagVarint64)},jspb.BinaryReader.prototype.readPackedSint64String=function(){return this.readPackedField_(this.decoder_.readZigzagVarint64String)},jspb.BinaryReader.prototype.readPackedFixed32=function(){return this.readPackedField_(this.decoder_.readUint32)},jspb.BinaryReader.prototype.readPackedFixed64=function(){return this.readPackedField_(this.decoder_.readUint64)},jspb.BinaryReader.prototype.readPackedFixed64String=function(){return this.readPackedField_(this.decoder_.readUint64String)},jspb.BinaryReader.prototype.readPackedSfixed32=function(){return this.readPackedField_(this.decoder_.readInt32)},jspb.BinaryReader.prototype.readPackedSfixed64=function(){return this.readPackedField_(this.decoder_.readInt64)},jspb.BinaryReader.prototype.readPackedSfixed64String=function(){return this.readPackedField_(this.decoder_.readInt64String)},jspb.BinaryReader.prototype.readPackedFloat=function(){return this.readPackedField_(this.decoder_.readFloat)},jspb.BinaryReader.prototype.readPackedDouble=function(){return this.readPackedField_(this.decoder_.readDouble)},jspb.BinaryReader.prototype.readPackedBool=function(){return this.readPackedField_(this.decoder_.readBool)},jspb.BinaryReader.prototype.readPackedEnum=function(){return this.readPackedField_(this.decoder_.readEnum)},jspb.BinaryReader.prototype.readPackedVarintHash64=function(){return this.readPackedField_(this.decoder_.readVarintHash64)},jspb.BinaryReader.prototype.readPackedFixedHash64=function(){return this.readPackedField_(this.decoder_.readFixedHash64)},jspb.BinaryEncoder=function(){this.buffer_=[]},jspb.BinaryEncoder.prototype.length=function(){return this.buffer_.length},jspb.BinaryEncoder.prototype.end=function(){var B=this.buffer_;return this.buffer_=[],B},jspb.BinaryEncoder.prototype.writeSplitVarint64=function(B,_){for(goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(_==Math.floor(_)),goog.asserts.assert(0<=B&&B<jspb.BinaryConstants.TWO_TO_32),goog.asserts.assert(0<=_&&_<jspb.BinaryConstants.TWO_TO_32);0<_||127<B;)this.buffer_.push(B&127|128),B=(B>>>7|_<<25)>>>0,_>>>=7;this.buffer_.push(B)},jspb.BinaryEncoder.prototype.writeSplitFixed64=function(B,_){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(_==Math.floor(_)),goog.asserts.assert(0<=B&&B<jspb.BinaryConstants.TWO_TO_32),goog.asserts.assert(0<=_&&_<jspb.BinaryConstants.TWO_TO_32),this.writeUint32(B),this.writeUint32(_)},jspb.BinaryEncoder.prototype.writeUnsignedVarint32=function(B){for(goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(0<=B&&B<jspb.BinaryConstants.TWO_TO_32);127<B;)this.buffer_.push(B&127|128),B>>>=7;this.buffer_.push(B)},jspb.BinaryEncoder.prototype.writeSignedVarint32=function(B){if(goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(B>=-jspb.BinaryConstants.TWO_TO_31&&B<jspb.BinaryConstants.TWO_TO_31),0<=B)this.writeUnsignedVarint32(B);else{for(var _=0;9>_;_++)this.buffer_.push(B&127|128),B>>=7;this.buffer_.push(1)}},jspb.BinaryEncoder.prototype.writeUnsignedVarint64=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(0<=B&&B<jspb.BinaryConstants.TWO_TO_64),jspb.utils.splitInt64(B),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeSignedVarint64=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(B>=-jspb.BinaryConstants.TWO_TO_63&&B<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitInt64(B),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeZigzagVarint32=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(B>=-jspb.BinaryConstants.TWO_TO_31&&B<jspb.BinaryConstants.TWO_TO_31),this.writeUnsignedVarint32((B<<1^B>>31)>>>0)},jspb.BinaryEncoder.prototype.writeZigzagVarint64=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(B>=-jspb.BinaryConstants.TWO_TO_63&&B<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitZigzag64(B),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeZigzagVarint64String=function(B){this.writeZigzagVarintHash64(jspb.utils.decimalStringToHash64(B))},jspb.BinaryEncoder.prototype.writeZigzagVarintHash64=function(B){var _=this;jspb.utils.splitHash64(B),jspb.utils.toZigzag64(jspb.utils.split64Low,jspb.utils.split64High,function(T,E){_.writeSplitVarint64(T>>>0,E>>>0)})},jspb.BinaryEncoder.prototype.writeUint8=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(0<=B&&256>B),this.buffer_.push(B>>>0&255)},jspb.BinaryEncoder.prototype.writeUint16=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(0<=B&&65536>B),this.buffer_.push(B>>>0&255),this.buffer_.push(B>>>8&255)},jspb.BinaryEncoder.prototype.writeUint32=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(0<=B&&B<jspb.BinaryConstants.TWO_TO_32),this.buffer_.push(B>>>0&255),this.buffer_.push(B>>>8&255),this.buffer_.push(B>>>16&255),this.buffer_.push(B>>>24&255)},jspb.BinaryEncoder.prototype.writeUint64=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(0<=B&&B<jspb.BinaryConstants.TWO_TO_64),jspb.utils.splitUint64(B),this.writeUint32(jspb.utils.split64Low),this.writeUint32(jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeInt8=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(-128<=B&&128>B),this.buffer_.push(B>>>0&255)},jspb.BinaryEncoder.prototype.writeInt16=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(-32768<=B&&32768>B),this.buffer_.push(B>>>0&255),this.buffer_.push(B>>>8&255)},jspb.BinaryEncoder.prototype.writeInt32=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(B>=-jspb.BinaryConstants.TWO_TO_31&&B<jspb.BinaryConstants.TWO_TO_31),this.buffer_.push(B>>>0&255),this.buffer_.push(B>>>8&255),this.buffer_.push(B>>>16&255),this.buffer_.push(B>>>24&255)},jspb.BinaryEncoder.prototype.writeInt64=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(B>=-jspb.BinaryConstants.TWO_TO_63&&B<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitInt64(B),this.writeSplitFixed64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeInt64String=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(+B>=-jspb.BinaryConstants.TWO_TO_63&&+B<jspb.BinaryConstants.TWO_TO_63),jspb.utils.splitHash64(jspb.utils.decimalStringToHash64(B)),this.writeSplitFixed64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeFloat=function(B){goog.asserts.assert(B===1/0||B===-1/0||isNaN(B)||B>=-jspb.BinaryConstants.FLOAT32_MAX&&B<=jspb.BinaryConstants.FLOAT32_MAX),jspb.utils.splitFloat32(B),this.writeUint32(jspb.utils.split64Low)},jspb.BinaryEncoder.prototype.writeDouble=function(B){goog.asserts.assert(B===1/0||B===-1/0||isNaN(B)||B>=-jspb.BinaryConstants.FLOAT64_MAX&&B<=jspb.BinaryConstants.FLOAT64_MAX),jspb.utils.splitFloat64(B),this.writeUint32(jspb.utils.split64Low),this.writeUint32(jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeBool=function(B){goog.asserts.assert(typeof B=="boolean"||typeof B=="number"),this.buffer_.push(B?1:0)},jspb.BinaryEncoder.prototype.writeEnum=function(B){goog.asserts.assert(B==Math.floor(B)),goog.asserts.assert(B>=-jspb.BinaryConstants.TWO_TO_31&&B<jspb.BinaryConstants.TWO_TO_31),this.writeSignedVarint32(B)},jspb.BinaryEncoder.prototype.writeBytes=function(B){this.buffer_.push.apply(this.buffer_,B)},jspb.BinaryEncoder.prototype.writeVarintHash64=function(B){jspb.utils.splitHash64(B),this.writeSplitVarint64(jspb.utils.split64Low,jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeFixedHash64=function(B){jspb.utils.splitHash64(B),this.writeUint32(jspb.utils.split64Low),this.writeUint32(jspb.utils.split64High)},jspb.BinaryEncoder.prototype.writeString=function(B){for(var _=this.buffer_.length,T=0;T<B.length;T++){var E=B.charCodeAt(T);if(128>E)this.buffer_.push(E);else if(2048>E)this.buffer_.push(E>>6|192),this.buffer_.push(E&63|128);else if(65536>E)if(55296<=E&&56319>=E&&T+1<B.length){var W=B.charCodeAt(T+1);56320<=W&&57343>=W&&(E=1024*(E-55296)+W-56320+65536,this.buffer_.push(E>>18|240),this.buffer_.push(E>>12&63|128),this.buffer_.push(E>>6&63|128),this.buffer_.push(E&63|128),T++)}else this.buffer_.push(E>>12|224),this.buffer_.push(E>>6&63|128),this.buffer_.push(E&63|128)}return this.buffer_.length-_},jspb.arith={},jspb.arith.UInt64=function(B,_){this.lo=B,this.hi=_},jspb.arith.UInt64.prototype.cmp=function(B){return this.hi<B.hi||this.hi==B.hi&&this.lo<B.lo?-1:this.hi==B.hi&&this.lo==B.lo?0:1},jspb.arith.UInt64.prototype.rightShift=function(){return new jspb.arith.UInt64((this.lo>>>1|(this.hi&1)<<31)>>>0,this.hi>>>1>>>0)},jspb.arith.UInt64.prototype.leftShift=function(){return new jspb.arith.UInt64(this.lo<<1>>>0,(this.hi<<1|this.lo>>>31)>>>0)},jspb.arith.UInt64.prototype.msb=function(){return!!(this.hi&2147483648)},jspb.arith.UInt64.prototype.lsb=function(){return!!(this.lo&1)},jspb.arith.UInt64.prototype.zero=function(){return this.lo==0&&this.hi==0},jspb.arith.UInt64.prototype.add=function(B){return new jspb.arith.UInt64((this.lo+B.lo&4294967295)>>>0>>>0,((this.hi+B.hi&4294967295)>>>0)+(4294967296<=this.lo+B.lo?1:0)>>>0)},jspb.arith.UInt64.prototype.sub=function(B){return new jspb.arith.UInt64((this.lo-B.lo&4294967295)>>>0>>>0,((this.hi-B.hi&4294967295)>>>0)-(0>this.lo-B.lo?1:0)>>>0)},jspb.arith.UInt64.mul32x32=function(B,_){var T=B&65535;B>>>=16;var E=_&65535,W=_>>>16;for(_=T*E+65536*(T*W&65535)+65536*(B*E&65535),T=B*W+(T*W>>>16)+(B*E>>>16);4294967296<=_;)_-=4294967296,T+=1;return new jspb.arith.UInt64(_>>>0,T>>>0)},jspb.arith.UInt64.prototype.mul=function(B){var _=jspb.arith.UInt64.mul32x32(this.lo,B);return B=jspb.arith.UInt64.mul32x32(this.hi,B),B.hi=B.lo,B.lo=0,_.add(B)},jspb.arith.UInt64.prototype.div=function(B){if(B==0)return[];var _=new jspb.arith.UInt64(0,0),T=new jspb.arith.UInt64(this.lo,this.hi);B=new jspb.arith.UInt64(B,0);for(var E=new jspb.arith.UInt64(1,0);!B.msb();)B=B.leftShift(),E=E.leftShift();for(;!E.zero();)0>=B.cmp(T)&&(_=_.add(E),T=T.sub(B)),B=B.rightShift(),E=E.rightShift();return[_,T]},jspb.arith.UInt64.prototype.toString=function(){for(var B="",_=this;!_.zero();){_=_.div(10);var T=_[0];B=_[1].lo+B,_=T}return B==""&&(B="0"),B},jspb.arith.UInt64.fromString=function(B){for(var _=new jspb.arith.UInt64(0,0),T=new jspb.arith.UInt64(0,0),E=0;E<B.length;E++){if("0">B[E]||"9"<B[E])return null;var W=parseInt(B[E],10);T.lo=W,_=_.mul(10).add(T)}return _},jspb.arith.UInt64.prototype.clone=function(){return new jspb.arith.UInt64(this.lo,this.hi)},jspb.arith.Int64=function(B,_){this.lo=B,this.hi=_},jspb.arith.Int64.prototype.add=function(B){return new jspb.arith.Int64((this.lo+B.lo&4294967295)>>>0>>>0,((this.hi+B.hi&4294967295)>>>0)+(4294967296<=this.lo+B.lo?1:0)>>>0)},jspb.arith.Int64.prototype.sub=function(B){return new jspb.arith.Int64((this.lo-B.lo&4294967295)>>>0>>>0,((this.hi-B.hi&4294967295)>>>0)-(0>this.lo-B.lo?1:0)>>>0)},jspb.arith.Int64.prototype.clone=function(){return new jspb.arith.Int64(this.lo,this.hi)},jspb.arith.Int64.prototype.toString=function(){var B=(this.hi&2147483648)!=0,_=new jspb.arith.UInt64(this.lo,this.hi);return B&&(_=new jspb.arith.UInt64(0,0).sub(_)),(B?"-":"")+_.toString()},jspb.arith.Int64.fromString=function(B){var _=0<B.length&&B[0]=="-";return _&&(B=B.substring(1)),B=jspb.arith.UInt64.fromString(B),B===null?null:(_&&(B=new jspb.arith.UInt64(0,0).sub(B)),new jspb.arith.Int64(B.lo,B.hi))},jspb.BinaryWriter=function(){this.blocks_=[],this.totalLength_=0,this.encoder_=new jspb.BinaryEncoder,this.bookmarks_=[]},jspb.BinaryWriter.prototype.appendUint8Array_=function(B){var _=this.encoder_.end();this.blocks_.push(_),this.blocks_.push(B),this.totalLength_+=_.length+B.length},jspb.BinaryWriter.prototype.beginDelimited_=function(B){return this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),B=this.encoder_.end(),this.blocks_.push(B),this.totalLength_+=B.length,B.push(this.totalLength_),B},jspb.BinaryWriter.prototype.endDelimited_=function(B){var _=B.pop();for(_=this.totalLength_+this.encoder_.length()-_,goog.asserts.assert(0<=_);127<_;)B.push(_&127|128),_>>>=7,this.totalLength_++;B.push(_),this.totalLength_++},jspb.BinaryWriter.prototype.writeSerializedMessage=function(B,_,T){this.appendUint8Array_(B.subarray(_,T))},jspb.BinaryWriter.prototype.maybeWriteSerializedMessage=function(B,_,T){B!=null&&_!=null&&T!=null&&this.writeSerializedMessage(B,_,T)},jspb.BinaryWriter.prototype.reset=function(){this.blocks_=[],this.encoder_.end(),this.totalLength_=0,this.bookmarks_=[]},jspb.BinaryWriter.prototype.getResultBuffer=function(){goog.asserts.assert(this.bookmarks_.length==0);for(var B=new Uint8Array(this.totalLength_+this.encoder_.length()),_=this.blocks_,T=_.length,E=0,W=0;W<T;W++){var X=_[W];B.set(X,E),E+=X.length}return _=this.encoder_.end(),B.set(_,E),E+=_.length,goog.asserts.assert(E==B.length),this.blocks_=[B],B},jspb.BinaryWriter.prototype.getResultBase64String=function(B){return goog.crypt.base64.encodeByteArray(this.getResultBuffer(),B)},jspb.BinaryWriter.prototype.beginSubMessage=function(B){this.bookmarks_.push(this.beginDelimited_(B))},jspb.BinaryWriter.prototype.endSubMessage=function(){goog.asserts.assert(0<=this.bookmarks_.length),this.endDelimited_(this.bookmarks_.pop())},jspb.BinaryWriter.prototype.writeFieldHeader_=function(B,_){goog.asserts.assert(1<=B&&B==Math.floor(B)),this.encoder_.writeUnsignedVarint32(8*B+_)},jspb.BinaryWriter.prototype.writeAny=function(B,_,T){var E=jspb.BinaryConstants.FieldType;switch(B){case E.DOUBLE:this.writeDouble(_,T);break;case E.FLOAT:this.writeFloat(_,T);break;case E.INT64:this.writeInt64(_,T);break;case E.UINT64:this.writeUint64(_,T);break;case E.INT32:this.writeInt32(_,T);break;case E.FIXED64:this.writeFixed64(_,T);break;case E.FIXED32:this.writeFixed32(_,T);break;case E.BOOL:this.writeBool(_,T);break;case E.STRING:this.writeString(_,T);break;case E.GROUP:goog.asserts.fail("Group field type not supported in writeAny()");break;case E.MESSAGE:goog.asserts.fail("Message field type not supported in writeAny()");break;case E.BYTES:this.writeBytes(_,T);break;case E.UINT32:this.writeUint32(_,T);break;case E.ENUM:this.writeEnum(_,T);break;case E.SFIXED32:this.writeSfixed32(_,T);break;case E.SFIXED64:this.writeSfixed64(_,T);break;case E.SINT32:this.writeSint32(_,T);break;case E.SINT64:this.writeSint64(_,T);break;case E.FHASH64:this.writeFixedHash64(_,T);break;case E.VHASH64:this.writeVarintHash64(_,T);break;default:goog.asserts.fail("Invalid field type in writeAny()")}},jspb.BinaryWriter.prototype.writeUnsignedVarint32_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeUnsignedVarint32(_))},jspb.BinaryWriter.prototype.writeSignedVarint32_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint32(_))},jspb.BinaryWriter.prototype.writeUnsignedVarint64_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeUnsignedVarint64(_))},jspb.BinaryWriter.prototype.writeSignedVarint64_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint64(_))},jspb.BinaryWriter.prototype.writeZigzagVarint32_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarint32(_))},jspb.BinaryWriter.prototype.writeZigzagVarint64_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarint64(_))},jspb.BinaryWriter.prototype.writeZigzagVarint64String_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarint64String(_))},jspb.BinaryWriter.prototype.writeZigzagVarintHash64_=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeZigzagVarintHash64(_))},jspb.BinaryWriter.prototype.writeInt32=function(B,_){_!=null&&(goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_31&&_<jspb.BinaryConstants.TWO_TO_31),this.writeSignedVarint32_(B,_))},jspb.BinaryWriter.prototype.writeInt32String=function(B,_){_!=null&&(_=parseInt(_,10),goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_31&&_<jspb.BinaryConstants.TWO_TO_31),this.writeSignedVarint32_(B,_))},jspb.BinaryWriter.prototype.writeInt64=function(B,_){_!=null&&(goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_63&&_<jspb.BinaryConstants.TWO_TO_63),this.writeSignedVarint64_(B,_))},jspb.BinaryWriter.prototype.writeInt64String=function(B,_){_!=null&&(_=jspb.arith.Int64.fromString(_),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSplitVarint64(_.lo,_.hi))},jspb.BinaryWriter.prototype.writeUint32=function(B,_){_!=null&&(goog.asserts.assert(0<=_&&_<jspb.BinaryConstants.TWO_TO_32),this.writeUnsignedVarint32_(B,_))},jspb.BinaryWriter.prototype.writeUint32String=function(B,_){_!=null&&(_=parseInt(_,10),goog.asserts.assert(0<=_&&_<jspb.BinaryConstants.TWO_TO_32),this.writeUnsignedVarint32_(B,_))},jspb.BinaryWriter.prototype.writeUint64=function(B,_){_!=null&&(goog.asserts.assert(0<=_&&_<jspb.BinaryConstants.TWO_TO_64),this.writeUnsignedVarint64_(B,_))},jspb.BinaryWriter.prototype.writeUint64String=function(B,_){_!=null&&(_=jspb.arith.UInt64.fromString(_),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSplitVarint64(_.lo,_.hi))},jspb.BinaryWriter.prototype.writeSint32=function(B,_){_!=null&&(goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_31&&_<jspb.BinaryConstants.TWO_TO_31),this.writeZigzagVarint32_(B,_))},jspb.BinaryWriter.prototype.writeSint64=function(B,_){_!=null&&(goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_63&&_<jspb.BinaryConstants.TWO_TO_63),this.writeZigzagVarint64_(B,_))},jspb.BinaryWriter.prototype.writeSintHash64=function(B,_){_!=null&&this.writeZigzagVarintHash64_(B,_)},jspb.BinaryWriter.prototype.writeSint64String=function(B,_){_!=null&&this.writeZigzagVarint64String_(B,_)},jspb.BinaryWriter.prototype.writeFixed32=function(B,_){_!=null&&(goog.asserts.assert(0<=_&&_<jspb.BinaryConstants.TWO_TO_32),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED32),this.encoder_.writeUint32(_))},jspb.BinaryWriter.prototype.writeFixed64=function(B,_){_!=null&&(goog.asserts.assert(0<=_&&_<jspb.BinaryConstants.TWO_TO_64),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeUint64(_))},jspb.BinaryWriter.prototype.writeFixed64String=function(B,_){_!=null&&(_=jspb.arith.UInt64.fromString(_),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeSplitFixed64(_.lo,_.hi))},jspb.BinaryWriter.prototype.writeSfixed32=function(B,_){_!=null&&(goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_31&&_<jspb.BinaryConstants.TWO_TO_31),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED32),this.encoder_.writeInt32(_))},jspb.BinaryWriter.prototype.writeSfixed64=function(B,_){_!=null&&(goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_63&&_<jspb.BinaryConstants.TWO_TO_63),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeInt64(_))},jspb.BinaryWriter.prototype.writeSfixed64String=function(B,_){_!=null&&(_=jspb.arith.Int64.fromString(_),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeSplitFixed64(_.lo,_.hi))},jspb.BinaryWriter.prototype.writeFloat=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED32),this.encoder_.writeFloat(_))},jspb.BinaryWriter.prototype.writeDouble=function(B,_){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeDouble(_))},jspb.BinaryWriter.prototype.writeBool=function(B,_){_!=null&&(goog.asserts.assert(typeof _=="boolean"||typeof _=="number"),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeBool(_))},jspb.BinaryWriter.prototype.writeEnum=function(B,_){_!=null&&(goog.asserts.assert(_>=-jspb.BinaryConstants.TWO_TO_31&&_<jspb.BinaryConstants.TWO_TO_31),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint32(_))},jspb.BinaryWriter.prototype.writeString=function(B,_){_!=null&&(B=this.beginDelimited_(B),this.encoder_.writeString(_),this.endDelimited_(B))},jspb.BinaryWriter.prototype.writeBytes=function(B,_){_!=null&&(_=jspb.utils.byteSourceToUint8Array(_),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(_.length),this.appendUint8Array_(_))},jspb.BinaryWriter.prototype.writeMessage=function(B,_,T){_!=null&&(B=this.beginDelimited_(B),T(_,this),this.endDelimited_(B))},jspb.BinaryWriter.prototype.writeMessageSet=function(B,_,T){_!=null&&(this.writeFieldHeader_(1,jspb.BinaryConstants.WireType.START_GROUP),this.writeFieldHeader_(2,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSignedVarint32(B),B=this.beginDelimited_(3),T(_,this),this.endDelimited_(B),this.writeFieldHeader_(1,jspb.BinaryConstants.WireType.END_GROUP))},jspb.BinaryWriter.prototype.writeGroup=function(B,_,T){_!=null&&(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.START_GROUP),T(_,this),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.END_GROUP))},jspb.BinaryWriter.prototype.writeFixedHash64=function(B,_){_!=null&&(goog.asserts.assert(_.length==8),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeFixedHash64(_))},jspb.BinaryWriter.prototype.writeVarintHash64=function(B,_){_!=null&&(goog.asserts.assert(_.length==8),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeVarintHash64(_))},jspb.BinaryWriter.prototype.writeSplitFixed64=function(B,_,T){this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.FIXED64),this.encoder_.writeSplitFixed64(_,T)},jspb.BinaryWriter.prototype.writeSplitVarint64=function(B,_,T){this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT),this.encoder_.writeSplitVarint64(_,T)},jspb.BinaryWriter.prototype.writeSplitZigzagVarint64=function(B,_,T){this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.VARINT);var E=this.encoder_;jspb.utils.toZigzag64(_,T,function(W,X){E.writeSplitVarint64(W>>>0,X>>>0)})},jspb.BinaryWriter.prototype.writeRepeatedInt32=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeSignedVarint32_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedInt32String=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeInt32String(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedInt64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeSignedVarint64_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSplitFixed64=function(B,_,T,E){if(_!=null)for(var W=0;W<_.length;W++)this.writeSplitFixed64(B,T(_[W]),E(_[W]))},jspb.BinaryWriter.prototype.writeRepeatedSplitVarint64=function(B,_,T,E){if(_!=null)for(var W=0;W<_.length;W++)this.writeSplitVarint64(B,T(_[W]),E(_[W]))},jspb.BinaryWriter.prototype.writeRepeatedSplitZigzagVarint64=function(B,_,T,E){if(_!=null)for(var W=0;W<_.length;W++)this.writeSplitZigzagVarint64(B,T(_[W]),E(_[W]))},jspb.BinaryWriter.prototype.writeRepeatedInt64String=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeInt64String(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedUint32=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeUnsignedVarint32_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedUint32String=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeUint32String(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedUint64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeUnsignedVarint64_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedUint64String=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeUint64String(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSint32=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeZigzagVarint32_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSint64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeZigzagVarint64_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSint64String=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeZigzagVarint64String_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSintHash64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeZigzagVarintHash64_(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedFixed32=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeFixed32(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedFixed64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeFixed64(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedFixed64String=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeFixed64String(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSfixed32=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeSfixed32(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSfixed64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeSfixed64(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedSfixed64String=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeSfixed64String(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedFloat=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeFloat(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedDouble=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeDouble(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedBool=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeBool(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedEnum=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeEnum(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedString=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeString(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedBytes=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeBytes(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedMessage=function(B,_,T){if(_!=null)for(var E=0;E<_.length;E++){var W=this.beginDelimited_(B);T(_[E],this),this.endDelimited_(W)}},jspb.BinaryWriter.prototype.writeRepeatedGroup=function(B,_,T){if(_!=null)for(var E=0;E<_.length;E++)this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.START_GROUP),T(_[E],this),this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.END_GROUP)},jspb.BinaryWriter.prototype.writeRepeatedFixedHash64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeFixedHash64(B,_[T])},jspb.BinaryWriter.prototype.writeRepeatedVarintHash64=function(B,_){if(_!=null)for(var T=0;T<_.length;T++)this.writeVarintHash64(B,_[T])},jspb.BinaryWriter.prototype.writePackedInt32=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeSignedVarint32(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedInt32String=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeSignedVarint32(parseInt(_[T],10));this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedInt64=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeSignedVarint64(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedSplitFixed64=function(B,_,T,E){if(_!=null){B=this.beginDelimited_(B);for(var W=0;W<_.length;W++)this.encoder_.writeSplitFixed64(T(_[W]),E(_[W]));this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedSplitVarint64=function(B,_,T,E){if(_!=null){B=this.beginDelimited_(B);for(var W=0;W<_.length;W++)this.encoder_.writeSplitVarint64(T(_[W]),E(_[W]));this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedSplitZigzagVarint64=function(B,_,T,E){if(_!=null){B=this.beginDelimited_(B);for(var W=this.encoder_,X=0;X<_.length;X++)jspb.utils.toZigzag64(T(_[X]),E(_[X]),function(q,Y){W.writeSplitVarint64(q>>>0,Y>>>0)});this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedInt64String=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++){var E=jspb.arith.Int64.fromString(_[T]);this.encoder_.writeSplitVarint64(E.lo,E.hi)}this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedUint32=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeUnsignedVarint32(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedUint32String=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeUnsignedVarint32(parseInt(_[T],10));this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedUint64=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeUnsignedVarint64(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedUint64String=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++){var E=jspb.arith.UInt64.fromString(_[T]);this.encoder_.writeSplitVarint64(E.lo,E.hi)}this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedSint32=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeZigzagVarint32(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedSint64=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeZigzagVarint64(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedSint64String=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeZigzagVarintHash64(jspb.utils.decimalStringToHash64(_[T]));this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedSintHash64=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeZigzagVarintHash64(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedFixed32=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(4*_.length),B=0;B<_.length;B++)this.encoder_.writeUint32(_[B])},jspb.BinaryWriter.prototype.writePackedFixed64=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*_.length),B=0;B<_.length;B++)this.encoder_.writeUint64(_[B])},jspb.BinaryWriter.prototype.writePackedFixed64String=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*_.length),B=0;B<_.length;B++){var T=jspb.arith.UInt64.fromString(_[B]);this.encoder_.writeSplitFixed64(T.lo,T.hi)}},jspb.BinaryWriter.prototype.writePackedSfixed32=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(4*_.length),B=0;B<_.length;B++)this.encoder_.writeInt32(_[B])},jspb.BinaryWriter.prototype.writePackedSfixed64=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*_.length),B=0;B<_.length;B++)this.encoder_.writeInt64(_[B])},jspb.BinaryWriter.prototype.writePackedSfixed64String=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*_.length),B=0;B<_.length;B++)this.encoder_.writeInt64String(_[B])},jspb.BinaryWriter.prototype.writePackedFloat=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(4*_.length),B=0;B<_.length;B++)this.encoder_.writeFloat(_[B])},jspb.BinaryWriter.prototype.writePackedDouble=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*_.length),B=0;B<_.length;B++)this.encoder_.writeDouble(_[B])},jspb.BinaryWriter.prototype.writePackedBool=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(_.length),B=0;B<_.length;B++)this.encoder_.writeBool(_[B])},jspb.BinaryWriter.prototype.writePackedEnum=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeEnum(_[T]);this.endDelimited_(B)}},jspb.BinaryWriter.prototype.writePackedFixedHash64=function(B,_){if(_!=null&&_.length)for(this.writeFieldHeader_(B,jspb.BinaryConstants.WireType.DELIMITED),this.encoder_.writeUnsignedVarint32(8*_.length),B=0;B<_.length;B++)this.encoder_.writeFixedHash64(_[B])},jspb.BinaryWriter.prototype.writePackedVarintHash64=function(B,_){if(_!=null&&_.length){B=this.beginDelimited_(B);for(var T=0;T<_.length;T++)this.encoder_.writeVarintHash64(_[T]);this.endDelimited_(B)}},jspb.Map=function(B,_){this.arr_=B,this.valueCtor_=_,this.map_={},this.arrClean=!0,0<this.arr_.length&&this.loadFromArray_()},jspb.Map.prototype.loadFromArray_=function(){for(var B=0;B<this.arr_.length;B++){var _=this.arr_[B],T=_[0];this.map_[T.toString()]=new jspb.Map.Entry_(T,_[1])}this.arrClean=!0},jspb.Map.prototype.toArray=function(){if(this.arrClean){if(this.valueCtor_){var B=this.map_,_;for(_ in B)if(Object.prototype.hasOwnProperty.call(B,_)){var T=B[_].valueWrapper;T&&T.toArray()}}}else{for(this.arr_.length=0,B=this.stringKeys_(),B.sort(),_=0;_<B.length;_++){var E=this.map_[B[_]];(T=E.valueWrapper)&&T.toArray(),this.arr_.push([E.key,E.value])}this.arrClean=!0}return this.arr_},jspb.Map.prototype.toObject=function(B,_){for(var T=this.toArray(),E=[],W=0;W<T.length;W++){var X=this.map_[T[W][0].toString()];this.wrapEntry_(X);var q=X.valueWrapper;q?(goog.asserts.assert(_),E.push([X.key,_(B,q)])):E.push([X.key,X.value])}return E},jspb.Map.fromObject=function(B,_,T){_=new jspb.Map([],_);for(var E=0;E<B.length;E++){var W=B[E][0],X=T(B[E][1]);_.set(W,X)}return _},jspb.Map.ArrayIteratorIterable_=function(B){this.idx_=0,this.arr_=B},jspb.Map.ArrayIteratorIterable_.prototype.next=function(){return this.idx_<this.arr_.length?{done:!1,value:this.arr_[this.idx_++]}:{done:!0,value:void 0}},typeof Symbol<"u"&&(jspb.Map.ArrayIteratorIterable_.prototype[Symbol.iterator]=function(){return this}),jspb.Map.prototype.getLength=function(){return this.stringKeys_().length},jspb.Map.prototype.clear=function(){this.map_={},this.arrClean=!1},jspb.Map.prototype.del=function(B){B=B.toString();var _=this.map_.hasOwnProperty(B);return delete this.map_[B],this.arrClean=!1,_},jspb.Map.prototype.getEntryList=function(){var B=[],_=this.stringKeys_();_.sort();for(var T=0;T<_.length;T++){var E=this.map_[_[T]];B.push([E.key,E.value])}return B},jspb.Map.prototype.entries=function(){var B=[],_=this.stringKeys_();_.sort();for(var T=0;T<_.length;T++){var E=this.map_[_[T]];B.push([E.key,this.wrapEntry_(E)])}return new jspb.Map.ArrayIteratorIterable_(B)},jspb.Map.prototype.keys=function(){var B=[],_=this.stringKeys_();_.sort();for(var T=0;T<_.length;T++)B.push(this.map_[_[T]].key);return new jspb.Map.ArrayIteratorIterable_(B)},jspb.Map.prototype.values=function(){var B=[],_=this.stringKeys_();_.sort();for(var T=0;T<_.length;T++)B.push(this.wrapEntry_(this.map_[_[T]]));return new jspb.Map.ArrayIteratorIterable_(B)},jspb.Map.prototype.forEach=function(B,_){var T=this.stringKeys_();T.sort();for(var E=0;E<T.length;E++){var W=this.map_[T[E]];B.call(_,this.wrapEntry_(W),W.key,this)}},jspb.Map.prototype.set=function(B,_){var T=new jspb.Map.Entry_(B);return this.valueCtor_?(T.valueWrapper=_,T.value=_.toArray()):T.value=_,this.map_[B.toString()]=T,this.arrClean=!1,this},jspb.Map.prototype.wrapEntry_=function(B){return this.valueCtor_?(B.valueWrapper||(B.valueWrapper=new this.valueCtor_(B.value)),B.valueWrapper):B.value},jspb.Map.prototype.get=function(B){if(B=this.map_[B.toString()])return this.wrapEntry_(B)},jspb.Map.prototype.has=function(B){return B.toString()in this.map_},jspb.Map.prototype.serializeBinary=function(B,_,T,E,W){var X=this.stringKeys_();X.sort();for(var q=0;q<X.length;q++){var Y=this.map_[X[q]];_.beginSubMessage(B),T.call(_,1,Y.key),this.valueCtor_?E.call(_,2,this.wrapEntry_(Y),W):E.call(_,2,Y.value),_.endSubMessage()}},jspb.Map.deserializeBinary=function(B,_,T,E,W,X,q){for(;_.nextField()&&!_.isEndGroup();){var Y=_.getFieldNumber();Y==1?X=T.call(_):Y==2&&(B.valueCtor_?(goog.asserts.assert(W),q||(q=new B.valueCtor_),E.call(_,q,W)):q=E.call(_))}goog.asserts.assert(X!=null),goog.asserts.assert(q!=null),B.set(X,q)},jspb.Map.prototype.stringKeys_=function(){var B=this.map_,_=[],T;for(T in B)Object.prototype.hasOwnProperty.call(B,T)&&_.push(T);return _},jspb.Map.Entry_=function(B,_){this.key=B,this.value=_,this.valueWrapper=void 0},jspb.ExtensionFieldInfo=function(B,_,T,E,W){this.fieldIndex=B,this.fieldName=_,this.ctor=T,this.toObjectFn=E,this.isRepeated=W},jspb.ExtensionFieldBinaryInfo=function(B,_,T,E,W,X){this.fieldInfo=B,this.binaryReaderFn=_,this.binaryWriterFn=T,this.binaryMessageSerializeFn=E,this.binaryMessageDeserializeFn=W,this.isPacked=X},jspb.ExtensionFieldInfo.prototype.isMessageType=function(){return!!this.ctor},jspb.Message=function(){},jspb.Message.GENERATE_TO_OBJECT=!0,jspb.Message.GENERATE_FROM_OBJECT=!goog.DISALLOW_TEST_ONLY_CODE,jspb.Message.GENERATE_TO_STRING=!0,jspb.Message.ASSUME_LOCAL_ARRAYS=!1,jspb.Message.SERIALIZE_EMPTY_TRAILING_FIELDS=!0,jspb.Message.SUPPORTS_UINT8ARRAY_=typeof Uint8Array=="function",jspb.Message.prototype.getJsPbMessageId=function(){return this.messageId_},jspb.Message.getIndex_=function(B,_){return _+B.arrayIndexOffset_},jspb.Message.hiddenES6Property_=function(){},jspb.Message.getFieldNumber_=function(B,_){return _-B.arrayIndexOffset_},jspb.Message.initialize=function(B,_,T,E,W,X){if(B.wrappers_=null,_||(_=T?[T]:[]),B.messageId_=T?String(T):void 0,B.arrayIndexOffset_=T===0?-1:0,B.array=_,jspb.Message.initPivotAndExtensionObject_(B,E),B.convertedPrimitiveFields_={},jspb.Message.SERIALIZE_EMPTY_TRAILING_FIELDS||(B.repeatedFields=W),W)for(_=0;_<W.length;_++)T=W[_],T<B.pivot_?(T=jspb.Message.getIndex_(B,T),B.array[T]=B.array[T]||jspb.Message.EMPTY_LIST_SENTINEL_):(jspb.Message.maybeInitEmptyExtensionObject_(B),B.extensionObject_[T]=B.extensionObject_[T]||jspb.Message.EMPTY_LIST_SENTINEL_);if(X&&X.length)for(_=0;_<X.length;_++)jspb.Message.computeOneofCase(B,X[_])},jspb.Message.EMPTY_LIST_SENTINEL_=goog.DEBUG&&Object.freeze?Object.freeze([]):[],jspb.Message.isArray_=function(B){return jspb.Message.ASSUME_LOCAL_ARRAYS?B instanceof Array:Array.isArray(B)},jspb.Message.isExtensionObject_=function(B){return B!==null&&typeof B=="object"&&!jspb.Message.isArray_(B)&&!(jspb.Message.SUPPORTS_UINT8ARRAY_&&B instanceof Uint8Array)},jspb.Message.initPivotAndExtensionObject_=function(B,_){var T=B.array.length,E=-1;if(T&&(E=T-1,T=B.array[E],jspb.Message.isExtensionObject_(T))){B.pivot_=jspb.Message.getFieldNumber_(B,E),B.extensionObject_=T;return}-1<_?(B.pivot_=Math.max(_,jspb.Message.getFieldNumber_(B,E+1)),B.extensionObject_=null):B.pivot_=Number.MAX_VALUE},jspb.Message.maybeInitEmptyExtensionObject_=function(B){var _=jspb.Message.getIndex_(B,B.pivot_);B.array[_]||(B.extensionObject_=B.array[_]={})},jspb.Message.toObjectList=function(B,_,T){for(var E=[],W=0;W<B.length;W++)E[W]=_.call(B[W],T,B[W]);return E},jspb.Message.toObjectExtension=function(B,_,T,E,W){for(var X in T){var q=T[X],Y=E.call(B,q);if(Y!=null){for(var te in q.fieldName)if(q.fieldName.hasOwnProperty(te))break;_[te]=q.toObjectFn?q.isRepeated?jspb.Message.toObjectList(Y,q.toObjectFn,W):q.toObjectFn(W,Y):Y}}},jspb.Message.serializeBinaryExtensions=function(B,_,T,E){for(var W in T){var X=T[W],q=X.fieldInfo;if(!X.binaryWriterFn)throw Error("Message extension present that was generated without binary serialization support");var Y=E.call(B,q);if(Y!=null)if(q.isMessageType())if(X.binaryMessageSerializeFn)X.binaryWriterFn.call(_,q.fieldIndex,Y,X.binaryMessageSerializeFn);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else X.binaryWriterFn.call(_,q.fieldIndex,Y)}},jspb.Message.readBinaryExtension=function(B,_,T,E,W){var X=T[_.getFieldNumber()];if(X){if(T=X.fieldInfo,!X.binaryReaderFn)throw Error("Deserializing extension whose generated code does not support binary format");if(T.isMessageType()){var q=new T.ctor;X.binaryReaderFn.call(_,q,X.binaryMessageDeserializeFn)}else q=X.binaryReaderFn.call(_);T.isRepeated&&!X.isPacked?(_=E.call(B,T))?_.push(q):W.call(B,T,[q]):W.call(B,T,q)}else _.skipField()},jspb.Message.getField=function(B,_){if(_<B.pivot_){_=jspb.Message.getIndex_(B,_);var T=B.array[_];return T===jspb.Message.EMPTY_LIST_SENTINEL_?B.array[_]=[]:T}if(B.extensionObject_)return T=B.extensionObject_[_],T===jspb.Message.EMPTY_LIST_SENTINEL_?B.extensionObject_[_]=[]:T},jspb.Message.getRepeatedField=function(B,_){return jspb.Message.getField(B,_)},jspb.Message.getOptionalFloatingPointField=function(B,_){return B=jspb.Message.getField(B,_),B==null?B:+B},jspb.Message.getBooleanField=function(B,_){return B=jspb.Message.getField(B,_),B==null?B:!!B},jspb.Message.getRepeatedFloatingPointField=function(B,_){var T=jspb.Message.getRepeatedField(B,_);if(B.convertedPrimitiveFields_||(B.convertedPrimitiveFields_={}),!B.convertedPrimitiveFields_[_]){for(var E=0;E<T.length;E++)T[E]=+T[E];B.convertedPrimitiveFields_[_]=!0}return T},jspb.Message.getRepeatedBooleanField=function(B,_){var T=jspb.Message.getRepeatedField(B,_);if(B.convertedPrimitiveFields_||(B.convertedPrimitiveFields_={}),!B.convertedPrimitiveFields_[_]){for(var E=0;E<T.length;E++)T[E]=!!T[E];B.convertedPrimitiveFields_[_]=!0}return T},jspb.Message.bytesAsB64=function(B){return B==null||typeof B=="string"?B:jspb.Message.SUPPORTS_UINT8ARRAY_&&B instanceof Uint8Array?goog.crypt.base64.encodeByteArray(B):(goog.asserts.fail("Cannot coerce to b64 string: "+goog.typeOf(B)),null)},jspb.Message.bytesAsU8=function(B){return B==null||B instanceof Uint8Array?B:typeof B=="string"?goog.crypt.base64.decodeStringToUint8Array(B):(goog.asserts.fail("Cannot coerce to Uint8Array: "+goog.typeOf(B)),null)},jspb.Message.bytesListAsB64=function(B){return jspb.Message.assertConsistentTypes_(B),B.length&&typeof B[0]!="string"?goog.array.map(B,jspb.Message.bytesAsB64):B},jspb.Message.bytesListAsU8=function(B){return jspb.Message.assertConsistentTypes_(B),!B.length||B[0]instanceof Uint8Array?B:goog.array.map(B,jspb.Message.bytesAsU8)},jspb.Message.assertConsistentTypes_=function(B){if(goog.DEBUG&&B&&1<B.length){var _=goog.typeOf(B[0]);goog.array.forEach(B,function(T){goog.typeOf(T)!=_&&goog.asserts.fail("Inconsistent type in JSPB repeated field array. Got "+goog.typeOf(T)+" expected "+_)})}},jspb.Message.getFieldWithDefault=function(B,_,T){return B=jspb.Message.getField(B,_),B??T},jspb.Message.getBooleanFieldWithDefault=function(B,_,T){return B=jspb.Message.getBooleanField(B,_),B??T},jspb.Message.getFloatingPointFieldWithDefault=function(B,_,T){return B=jspb.Message.getOptionalFloatingPointField(B,_),B??T},jspb.Message.getFieldProto3=jspb.Message.getFieldWithDefault,jspb.Message.getMapField=function(B,_,T,E){if(B.wrappers_||(B.wrappers_={}),_ in B.wrappers_)return B.wrappers_[_];var W=jspb.Message.getField(B,_);if(!W){if(T)return;W=[],jspb.Message.setField(B,_,W)}return B.wrappers_[_]=new jspb.Map(W,E)},jspb.Message.setField=function(B,_,T){return goog.asserts.assertInstanceof(B,jspb.Message),_<B.pivot_?B.array[jspb.Message.getIndex_(B,_)]=T:(jspb.Message.maybeInitEmptyExtensionObject_(B),B.extensionObject_[_]=T),B},jspb.Message.setProto3IntField=function(B,_,T){return jspb.Message.setFieldIgnoringDefault_(B,_,T,0)},jspb.Message.setProto3FloatField=function(B,_,T){return jspb.Message.setFieldIgnoringDefault_(B,_,T,0)},jspb.Message.setProto3BooleanField=function(B,_,T){return jspb.Message.setFieldIgnoringDefault_(B,_,T,!1)},jspb.Message.setProto3StringField=function(B,_,T){return jspb.Message.setFieldIgnoringDefault_(B,_,T,"")},jspb.Message.setProto3BytesField=function(B,_,T){return jspb.Message.setFieldIgnoringDefault_(B,_,T,"")},jspb.Message.setProto3EnumField=function(B,_,T){return jspb.Message.setFieldIgnoringDefault_(B,_,T,0)},jspb.Message.setProto3StringIntField=function(B,_,T){return jspb.Message.setFieldIgnoringDefault_(B,_,T,"0")},jspb.Message.setFieldIgnoringDefault_=function(B,_,T,E){return goog.asserts.assertInstanceof(B,jspb.Message),T!==E?jspb.Message.setField(B,_,T):_<B.pivot_?B.array[jspb.Message.getIndex_(B,_)]=null:(jspb.Message.maybeInitEmptyExtensionObject_(B),delete B.extensionObject_[_]),B},jspb.Message.addToRepeatedField=function(B,_,T,E){return goog.asserts.assertInstanceof(B,jspb.Message),_=jspb.Message.getRepeatedField(B,_),E!=null?_.splice(E,0,T):_.push(T),B},jspb.Message.setOneofField=function(B,_,T,E){return goog.asserts.assertInstanceof(B,jspb.Message),(T=jspb.Message.computeOneofCase(B,T))&&T!==_&&E!==void 0&&(B.wrappers_&&T in B.wrappers_&&(B.wrappers_[T]=void 0),jspb.Message.setField(B,T,void 0)),jspb.Message.setField(B,_,E)},jspb.Message.computeOneofCase=function(B,_){for(var T,E,W=0;W<_.length;W++){var X=_[W],q=jspb.Message.getField(B,X);q!=null&&(T=X,E=q,jspb.Message.setField(B,X,void 0))}return T?(jspb.Message.setField(B,T,E),T):0},jspb.Message.getWrapperField=function(B,_,T,E){if(B.wrappers_||(B.wrappers_={}),!B.wrappers_[T]){var W=jspb.Message.getField(B,T);(E||W)&&(B.wrappers_[T]=new _(W))}return B.wrappers_[T]},jspb.Message.getRepeatedWrapperField=function(B,_,T){return jspb.Message.wrapRepeatedField_(B,_,T),_=B.wrappers_[T],_==jspb.Message.EMPTY_LIST_SENTINEL_&&(_=B.wrappers_[T]=[]),_},jspb.Message.wrapRepeatedField_=function(B,_,T){if(B.wrappers_||(B.wrappers_={}),!B.wrappers_[T]){for(var E=jspb.Message.getRepeatedField(B,T),W=[],X=0;X<E.length;X++)W[X]=new _(E[X]);B.wrappers_[T]=W}},jspb.Message.setWrapperField=function(B,_,T){goog.asserts.assertInstanceof(B,jspb.Message),B.wrappers_||(B.wrappers_={});var E=T&&T.toArray();return B.wrappers_[_]=T,jspb.Message.setField(B,_,E)},jspb.Message.setOneofWrapperField=function(B,_,T,E){goog.asserts.assertInstanceof(B,jspb.Message),B.wrappers_||(B.wrappers_={});var W=E&&E.toArray();return B.wrappers_[_]=E,jspb.Message.setOneofField(B,_,T,W)},jspb.Message.setRepeatedWrapperField=function(B,_,T){goog.asserts.assertInstanceof(B,jspb.Message),B.wrappers_||(B.wrappers_={}),T=T||[];for(var E=[],W=0;W<T.length;W++)E[W]=T[W].toArray();return B.wrappers_[_]=T,jspb.Message.setField(B,_,E)},jspb.Message.addToRepeatedWrapperField=function(B,_,T,E,W){jspb.Message.wrapRepeatedField_(B,E,_);var X=B.wrappers_[_];return X||(X=B.wrappers_[_]=[]),T=T||new E,B=jspb.Message.getRepeatedField(B,_),W!=null?(X.splice(W,0,T),B.splice(W,0,T.toArray())):(X.push(T),B.push(T.toArray())),T},jspb.Message.toMap=function(B,_,T,E){for(var W={},X=0;X<B.length;X++)W[_.call(B[X])]=T?T.call(B[X],E,B[X]):B[X];return W},jspb.Message.prototype.syncMapFields_=function(){if(this.wrappers_)for(var B in this.wrappers_){var _=this.wrappers_[B];if(Array.isArray(_))for(var T=0;T<_.length;T++)_[T]&&_[T].toArray();else _&&_.toArray()}},jspb.Message.prototype.toArray=function(){return this.syncMapFields_(),this.array},jspb.Message.GENERATE_TO_STRING&&(jspb.Message.prototype.toString=function(){return this.syncMapFields_(),this.array.toString()}),jspb.Message.prototype.getExtension=function(B){if(this.extensionObject_){this.wrappers_||(this.wrappers_={});var _=B.fieldIndex;if(B.isRepeated){if(B.isMessageType())return this.wrappers_[_]||(this.wrappers_[_]=goog.array.map(this.extensionObject_[_]||[],function(T){return new B.ctor(T)})),this.wrappers_[_]}else if(B.isMessageType())return!this.wrappers_[_]&&this.extensionObject_[_]&&(this.wrappers_[_]=new B.ctor(this.extensionObject_[_])),this.wrappers_[_];return this.extensionObject_[_]}},jspb.Message.prototype.setExtension=function(B,_){this.wrappers_||(this.wrappers_={}),jspb.Message.maybeInitEmptyExtensionObject_(this);var T=B.fieldIndex;return B.isRepeated?(_=_||[],B.isMessageType()?(this.wrappers_[T]=_,this.extensionObject_[T]=goog.array.map(_,function(E){return E.toArray()})):this.extensionObject_[T]=_):B.isMessageType()?(this.wrappers_[T]=_,this.extensionObject_[T]=_&&_.toArray()):this.extensionObject_[T]=_,this},jspb.Message.difference=function(B,_){if(!(B instanceof _.constructor))throw Error("Messages have different types.");var T=B.toArray();_=_.toArray();var E=[],W=0,X=T.length>_.length?T.length:_.length;for(B.getJsPbMessageId()&&(E[0]=B.getJsPbMessageId(),W=1);W<X;W++)jspb.Message.compareFields(T[W],_[W])||(E[W]=_[W]);return new B.constructor(E)},jspb.Message.equals=function(B,_){return B==_||!(!B||!_)&&B instanceof _.constructor&&jspb.Message.compareFields(B.toArray(),_.toArray())},jspb.Message.compareExtensions=function(B,_){B=B||{},_=_||{};var T={},E;for(E in B)T[E]=0;for(E in _)T[E]=0;for(E in T)if(!jspb.Message.compareFields(B[E],_[E]))return!1;return!0},jspb.Message.compareFields=function(B,_){if(B==_)return!0;if(!goog.isObject(B)||!goog.isObject(_))return typeof B=="number"&&isNaN(B)||typeof _=="number"&&isNaN(_)?String(B)==String(_):!1;if(B.constructor!=_.constructor)return!1;if(jspb.Message.SUPPORTS_UINT8ARRAY_&&B.constructor===Uint8Array){if(B.length!=_.length)return!1;for(var T=0;T<B.length;T++)if(B[T]!=_[T])return!1;return!0}if(B.constructor===Array){var E=void 0,W=void 0,X=Math.max(B.length,_.length);for(T=0;T<X;T++){var q=B[T],Y=_[T];if(q&&q.constructor==Object&&(goog.asserts.assert(E===void 0),goog.asserts.assert(T===B.length-1),E=q,q=void 0),Y&&Y.constructor==Object&&(goog.asserts.assert(W===void 0),goog.asserts.assert(T===_.length-1),W=Y,Y=void 0),!jspb.Message.compareFields(q,Y))return!1}return E||W?(E=E||{},W=W||{},jspb.Message.compareExtensions(E,W)):!0}if(B.constructor===Object)return jspb.Message.compareExtensions(B,_);throw Error("Invalid type in JSPB array")},jspb.Message.prototype.cloneMessage=function(){return jspb.Message.cloneMessage(this)},jspb.Message.prototype.clone=function(){return jspb.Message.cloneMessage(this)},jspb.Message.clone=function(B){return jspb.Message.cloneMessage(B)},jspb.Message.cloneMessage=function(B){return new B.constructor(jspb.Message.clone_(B.toArray()))},jspb.Message.copyInto=function(B,_){goog.asserts.assertInstanceof(B,jspb.Message),goog.asserts.assertInstanceof(_,jspb.Message),goog.asserts.assert(B.constructor==_.constructor,"Copy source and target message should have the same type."),B=jspb.Message.clone(B);for(var T=_.toArray(),E=B.toArray(),W=T.length=0;W<E.length;W++)T[W]=E[W];_.wrappers_=B.wrappers_,_.extensionObject_=B.extensionObject_},jspb.Message.clone_=function(B){if(Array.isArray(B)){for(var _=Array(B.length),T=0;T<B.length;T++){var E=B[T];E!=null&&(_[T]=typeof E=="object"?jspb.Message.clone_(goog.asserts.assert(E)):E)}return _}if(jspb.Message.SUPPORTS_UINT8ARRAY_&&B instanceof Uint8Array)return new Uint8Array(B);_={};for(T in B)E=B[T],E!=null&&(_[T]=typeof E=="object"?jspb.Message.clone_(goog.asserts.assert(E)):E);return _},jspb.Message.registerMessageType=function(B,_){_.messageId=B},jspb.Message.messageSetExtensions={},jspb.Message.messageSetExtensionsBinary={},jspb.Export={};var Map=jspb.Map,Message=jspb.Message,BinaryReader=jspb.BinaryReader,BinaryWriter=jspb.BinaryWriter,ExtensionFieldInfo=jspb.ExtensionFieldInfo,ExtensionFieldBinaryInfo=jspb.ExtensionFieldBinaryInfo,exportSymbol=goog.exportSymbol,inherits=goog.inherits,object={extend:goog.object.extend},typeOf=goog.typeOf,googleProtobuf={Map,Message,BinaryReader,BinaryWriter,ExtensionFieldInfo,ExtensionFieldBinaryInfo,exportSymbol,inherits,object,typeOf},generic_collection_pb=createCommonjsModule(function(B,_){var T=googleProtobuf,E={};T.exportSymbol("cn.leancloud.play.proto.GenericCollection",null,E),T.exportSymbol("cn.leancloud.play.proto.GenericCollection.MapEntry",null,E),T.exportSymbol("cn.leancloud.play.proto.GenericCollectionValue",null,E),T.exportSymbol("cn.leancloud.play.proto.GenericCollectionValue.Type",null,E),T.exportSymbol("cn.leancloud.play.proto.GenericCollectionValue.ValueCase",null,E),E.cn.leancloud.play.proto.GenericCollectionValue=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_)},T.inherits(E.cn.leancloud.play.proto.GenericCollectionValue,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.cn.leancloud.play.proto.GenericCollectionValue.displayName="proto.cn.leancloud.play.proto.GenericCollectionValue"),E.cn.leancloud.play.proto.GenericCollection=function(W){googleProtobuf.Message.initialize(this,W,0,-1,E.cn.leancloud.play.proto.GenericCollection.repeatedFields_,null)},T.inherits(E.cn.leancloud.play.proto.GenericCollection,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.cn.leancloud.play.proto.GenericCollection.displayName="proto.cn.leancloud.play.proto.GenericCollection"),E.cn.leancloud.play.proto.GenericCollection.MapEntry=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.cn.leancloud.play.proto.GenericCollection.MapEntry,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.cn.leancloud.play.proto.GenericCollection.MapEntry.displayName="proto.cn.leancloud.play.proto.GenericCollection.MapEntry"),E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_=[[2,3,4,5,6,7,8]],E.cn.leancloud.play.proto.GenericCollectionValue.ValueCase={VALUE_NOT_SET:0,INT_VALUE:2,LONG_INT_VALUE:3,BOOL_VALUE:4,STRING_VALUE:5,BYTES_VALUE:6,FLOAT_VALUE:7,DOUBLE_VALUE:8},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getValueCase=function(){return googleProtobuf.Message.computeOneofCase(this,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0])},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.cn.leancloud.play.proto.GenericCollectionValue.prototype.toObject=function(W){return E.cn.leancloud.play.proto.GenericCollectionValue.toObject(W,this)},E.cn.leancloud.play.proto.GenericCollectionValue.toObject=function(W,X){var q={type:googleProtobuf.Message.getFieldWithDefault(X,1,0),intValue:googleProtobuf.Message.getFieldWithDefault(X,2,0),longIntValue:googleProtobuf.Message.getFieldWithDefault(X,3,0),boolValue:googleProtobuf.Message.getBooleanFieldWithDefault(X,4,!1),stringValue:googleProtobuf.Message.getFieldWithDefault(X,5,""),bytesValue:X.getBytesValue_asB64(),floatValue:googleProtobuf.Message.getFloatingPointFieldWithDefault(X,7,0),doubleValue:googleProtobuf.Message.getFloatingPointFieldWithDefault(X,8,0),objectTypeId:googleProtobuf.Message.getFieldWithDefault(X,9,0)};return W&&(q.$jspbMessageInstance=X),q}),E.cn.leancloud.play.proto.GenericCollectionValue.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.cn.leancloud.play.proto.GenericCollectionValue;return E.cn.leancloud.play.proto.GenericCollectionValue.deserializeBinaryFromReader(q,X)},E.cn.leancloud.play.proto.GenericCollectionValue.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readEnum();W.setType(Y);break;case 2:var Y=X.readInt32();W.setIntValue(Y);break;case 3:var Y=X.readInt64();W.setLongIntValue(Y);break;case 4:var Y=X.readBool();W.setBoolValue(Y);break;case 5:var Y=X.readString();W.setStringValue(Y);break;case 6:var Y=X.readBytes();W.setBytesValue(Y);break;case 7:var Y=X.readFloat();W.setFloatValue(Y);break;case 8:var Y=X.readDouble();W.setDoubleValue(Y);break;case 9:var Y=X.readInt32();W.setObjectTypeId(Y);break;default:X.skipField();break}}return W},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.cn.leancloud.play.proto.GenericCollectionValue.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.cn.leancloud.play.proto.GenericCollectionValue.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getType(),q!==0&&X.writeEnum(1,q),q=googleProtobuf.Message.getField(W,2),q!=null&&X.writeInt32(2,q),q=googleProtobuf.Message.getField(W,3),q!=null&&X.writeInt64(3,q),q=googleProtobuf.Message.getField(W,4),q!=null&&X.writeBool(4,q),q=googleProtobuf.Message.getField(W,5),q!=null&&X.writeString(5,q),q=googleProtobuf.Message.getField(W,6),q!=null&&X.writeBytes(6,q),q=googleProtobuf.Message.getField(W,7),q!=null&&X.writeFloat(7,q),q=googleProtobuf.Message.getField(W,8),q!=null&&X.writeDouble(8,q),q=W.getObjectTypeId(),q!==0&&X.writeInt32(9,q)},E.cn.leancloud.play.proto.GenericCollectionValue.Type={NULL:0,BYTES:1,BYTE:2,SHORT:3,INT:4,LONG:5,BOOL:6,FLOAT:7,DOUBLE:8,OBJECT:9,STRING:10,MAP:11,ARRAY:12},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getType=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setType=function(W){return googleProtobuf.Message.setProto3EnumField(this,1,W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getIntValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setIntValue=function(W){return googleProtobuf.Message.setOneofField(this,2,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.clearIntValue=function(){return googleProtobuf.Message.setOneofField(this,2,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],void 0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.hasIntValue=function(){return googleProtobuf.Message.getField(this,2)!=null},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getLongIntValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setLongIntValue=function(W){return googleProtobuf.Message.setOneofField(this,3,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.clearLongIntValue=function(){return googleProtobuf.Message.setOneofField(this,3,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],void 0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.hasLongIntValue=function(){return googleProtobuf.Message.getField(this,3)!=null},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getBoolValue=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,4,!1)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setBoolValue=function(W){return googleProtobuf.Message.setOneofField(this,4,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.clearBoolValue=function(){return googleProtobuf.Message.setOneofField(this,4,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],void 0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.hasBoolValue=function(){return googleProtobuf.Message.getField(this,4)!=null},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getStringValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,5,"")},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setStringValue=function(W){return googleProtobuf.Message.setOneofField(this,5,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.clearStringValue=function(){return googleProtobuf.Message.setOneofField(this,5,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],void 0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.hasStringValue=function(){return googleProtobuf.Message.getField(this,5)!=null},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getBytesValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,6,"")},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getBytesValue_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getBytesValue())},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getBytesValue_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getBytesValue())},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setBytesValue=function(W){return googleProtobuf.Message.setOneofField(this,6,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.clearBytesValue=function(){return googleProtobuf.Message.setOneofField(this,6,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],void 0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.hasBytesValue=function(){return googleProtobuf.Message.getField(this,6)!=null},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getFloatValue=function(){return googleProtobuf.Message.getFloatingPointFieldWithDefault(this,7,0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setFloatValue=function(W){return googleProtobuf.Message.setOneofField(this,7,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.clearFloatValue=function(){return googleProtobuf.Message.setOneofField(this,7,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],void 0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.hasFloatValue=function(){return googleProtobuf.Message.getField(this,7)!=null},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getDoubleValue=function(){return googleProtobuf.Message.getFloatingPointFieldWithDefault(this,8,0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setDoubleValue=function(W){return googleProtobuf.Message.setOneofField(this,8,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],W)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.clearDoubleValue=function(){return googleProtobuf.Message.setOneofField(this,8,E.cn.leancloud.play.proto.GenericCollectionValue.oneofGroups_[0],void 0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.hasDoubleValue=function(){return googleProtobuf.Message.getField(this,8)!=null},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.getObjectTypeId=function(){return googleProtobuf.Message.getFieldWithDefault(this,9,0)},E.cn.leancloud.play.proto.GenericCollectionValue.prototype.setObjectTypeId=function(W){return googleProtobuf.Message.setProto3IntField(this,9,W)},E.cn.leancloud.play.proto.GenericCollection.repeatedFields_=[1,2],googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.cn.leancloud.play.proto.GenericCollection.prototype.toObject=function(W){return E.cn.leancloud.play.proto.GenericCollection.toObject(W,this)},E.cn.leancloud.play.proto.GenericCollection.toObject=function(W,X){var q={listValueList:googleProtobuf.Message.toObjectList(X.getListValueList(),E.cn.leancloud.play.proto.GenericCollectionValue.toObject,W),mapEntryValueList:googleProtobuf.Message.toObjectList(X.getMapEntryValueList(),E.cn.leancloud.play.proto.GenericCollection.MapEntry.toObject,W)};return W&&(q.$jspbMessageInstance=X),q}),E.cn.leancloud.play.proto.GenericCollection.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.cn.leancloud.play.proto.GenericCollection;return E.cn.leancloud.play.proto.GenericCollection.deserializeBinaryFromReader(q,X)},E.cn.leancloud.play.proto.GenericCollection.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.cn.leancloud.play.proto.GenericCollectionValue;X.readMessage(Y,E.cn.leancloud.play.proto.GenericCollectionValue.deserializeBinaryFromReader),W.addListValue(Y);break;case 2:var Y=new E.cn.leancloud.play.proto.GenericCollection.MapEntry;X.readMessage(Y,E.cn.leancloud.play.proto.GenericCollection.MapEntry.deserializeBinaryFromReader),W.addMapEntryValue(Y);break;default:X.skipField();break}}return W},E.cn.leancloud.play.proto.GenericCollection.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.cn.leancloud.play.proto.GenericCollection.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.cn.leancloud.play.proto.GenericCollection.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getListValueList(),q.length>0&&X.writeRepeatedMessage(1,q,E.cn.leancloud.play.proto.GenericCollectionValue.serializeBinaryToWriter),q=W.getMapEntryValueList(),q.length>0&&X.writeRepeatedMessage(2,q,E.cn.leancloud.play.proto.GenericCollection.MapEntry.serializeBinaryToWriter)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.toObject=function(W){return E.cn.leancloud.play.proto.GenericCollection.MapEntry.toObject(W,this)},E.cn.leancloud.play.proto.GenericCollection.MapEntry.toObject=function(W,X){var q,Y={key:googleProtobuf.Message.getFieldWithDefault(X,1,""),val:(q=X.getVal())&&E.cn.leancloud.play.proto.GenericCollectionValue.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.cn.leancloud.play.proto.GenericCollection.MapEntry.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.cn.leancloud.play.proto.GenericCollection.MapEntry;return E.cn.leancloud.play.proto.GenericCollection.MapEntry.deserializeBinaryFromReader(q,X)},E.cn.leancloud.play.proto.GenericCollection.MapEntry.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readString();W.setKey(Y);break;case 2:var Y=new E.cn.leancloud.play.proto.GenericCollectionValue;X.readMessage(Y,E.cn.leancloud.play.proto.GenericCollectionValue.deserializeBinaryFromReader),W.setVal(Y);break;default:X.skipField();break}}return W},E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.cn.leancloud.play.proto.GenericCollection.MapEntry.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.cn.leancloud.play.proto.GenericCollection.MapEntry.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getKey(),q.length>0&&X.writeString(1,q),q=W.getVal(),q!=null&&X.writeMessage(2,q,E.cn.leancloud.play.proto.GenericCollectionValue.serializeBinaryToWriter)},E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.getKey=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.setKey=function(W){return googleProtobuf.Message.setProto3StringField(this,1,W)},E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.getVal=function(){return googleProtobuf.Message.getWrapperField(this,E.cn.leancloud.play.proto.GenericCollectionValue,2)},E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.setVal=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.clearVal=function(){return this.setVal(void 0)},E.cn.leancloud.play.proto.GenericCollection.MapEntry.prototype.hasVal=function(){return googleProtobuf.Message.getField(this,2)!=null},E.cn.leancloud.play.proto.GenericCollection.prototype.getListValueList=function(){return googleProtobuf.Message.getRepeatedWrapperField(this,E.cn.leancloud.play.proto.GenericCollectionValue,1)},E.cn.leancloud.play.proto.GenericCollection.prototype.setListValueList=function(W){return googleProtobuf.Message.setRepeatedWrapperField(this,1,W)},E.cn.leancloud.play.proto.GenericCollection.prototype.addListValue=function(W,X){return googleProtobuf.Message.addToRepeatedWrapperField(this,1,W,E.cn.leancloud.play.proto.GenericCollectionValue,X)},E.cn.leancloud.play.proto.GenericCollection.prototype.clearListValueList=function(){return this.setListValueList([])},E.cn.leancloud.play.proto.GenericCollection.prototype.getMapEntryValueList=function(){return googleProtobuf.Message.getRepeatedWrapperField(this,E.cn.leancloud.play.proto.GenericCollection.MapEntry,2)},E.cn.leancloud.play.proto.GenericCollection.prototype.setMapEntryValueList=function(W){return googleProtobuf.Message.setRepeatedWrapperField(this,2,W)},E.cn.leancloud.play.proto.GenericCollection.prototype.addMapEntryValue=function(W,X){return googleProtobuf.Message.addToRepeatedWrapperField(this,2,W,E.cn.leancloud.play.proto.GenericCollection.MapEntry,X)},E.cn.leancloud.play.proto.GenericCollection.prototype.clearMapEntryValueList=function(){return this.setMapEntryValueList([])},T.object.extend(_,E)}),_genericCollection$cn=generic_collection_pb.cn.leancloud.play.proto,GenericCollectionValue=_genericCollection$cn.GenericCollectionValue,GenericCollection=_genericCollection$cn.GenericCollection,_typeNameMap={},_typeIdMap={};function registerType(B,_,T,E){if(B===void 0||typeof B!="function")throw new TypeError("type must be a class");if(T===void 0||typeof T!="function")throw new TypeError("serializeMethod must be a function");if(E===void 0||typeof E!="function")throw new TypeError("deserializeMethod must be a function");var W={type:B,typeId:_,serializeMethod:T,deserializeMethod:E},X=B.name;_typeNameMap[X]=W,_typeIdMap[_]=W}function serialize(B){var _=new GenericCollectionValue;if(B===null)_.setType(GenericCollectionValue.Type.NULL);else if(typeof B=="boolean")_.setType(GenericCollectionValue.Type.BOOL),_.setBoolValue(B);else if(typeof B=="number")parseInt(B,10)===B?(_.setType(GenericCollectionValue.Type.INT),_.setIntValue(B)):(_.setType(GenericCollectionValue.Type.DOUBLE),_.setDoubleValue(B));else if(typeof B=="string")_.setType(GenericCollectionValue.Type.STRING),_.setStringValue(B);else if(B instanceof Array){_.setType(GenericCollectionValue.Type.ARRAY);var T=[];B.forEach(function(te){T.push(serialize(te))});var E=new GenericCollection;E.setListValueList(T),_.setBytesValue(E.serializeBinary())}else if(B instanceof Object){var W=B.constructor.name,X=_typeNameMap[W];if(X){_.setType(GenericCollectionValue.Type.OBJECT);var q=X.typeId,Y=X.serializeMethod;_.setObjectTypeId(q),_.setBytesValue(Y(B))}else _.setType(GenericCollectionValue.Type.MAP),_.setBytesValue(serializeObject(B))}else throw new TypeError((typeof B>"u"?"undefined":_typeof(B))+" is not supported");return _}function deserialize(B){var _=null;switch(B.getType()){case GenericCollectionValue.Type.NULL:break;case GenericCollectionValue.Type.BOOL:_=B.getBoolValue();break;case GenericCollectionValue.Type.BYTE:_=B.getByteValue();break;case GenericCollectionValue.Type.SHORT:_=B.getShortValue();break;case GenericCollectionValue.Type.INT:_=B.getIntValue();break;case GenericCollectionValue.Type.LONG:_=B.getLongValue();break;case GenericCollectionValue.Type.FLOAT:_=B.getFloatValue();break;case GenericCollectionValue.Type.DOUBLE:_=B.getDoubleValue();break;case GenericCollectionValue.Type.STRING:_=B.getStringValue();break;case GenericCollectionValue.Type.MAP:{var T=B.getBytesValue();_=deserializeObject(T)}break;case GenericCollectionValue.Type.ARRAY:{var E=B.getBytesValue();_=[];var W=GenericCollection.deserializeBinary(E);W.getListValueList().forEach(function(ne){_.push(deserialize(ne))})}break;case GenericCollectionValue.Type.OBJECT:{var X=B.getObjectTypeId(),q=_typeIdMap[X];if(q){var Y=B.getBytesValue(),te=q.deserializeMethod;_=te(Y)}else throw new TypeError("type id: "+X+" is not supported")}break}return _}function serializeObject(B){if(B===void 0)return null;var _=[];_Object$entries(B).forEach(function(E){var W=_slicedToArray(E,2),X=W[0],q=W[1];if(!(typeof q>"u")){var Y=new GenericCollection.MapEntry;Y.setKey(X),Y.setVal(serialize(q)),_.push(Y)}});var T=new GenericCollection;return T.setMapEntryValueList(_),T.serializeBinary()}function deserializeObject(B){if(B===void 0)return null;var _=GenericCollection.deserializeBinary(B),T={};return _.getMapEntryValueList().forEach(function(E){T[E.getKey()]=deserialize(E.getVal())}),T}var Player=function(){function B(_){_classCallCheck(this,B),this._userId="",this._actorId=0,this._active=!0,this._properties={},this._room=_}return _createClass(B,[{key:"setCustomProperties",value:function(T){var E=this,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=W.expectedValues,q=X===void 0?null:X;return this._room.setPlayerProperties(this.actorId,T,q).then(tap(function(Y){var te=Y.actorId,ne=Y.attr;te===E.actorId&&ne&&E._mergeProperties(ne)}))}},{key:"_init",value:function(T){this._userId=T.getPid(),this._actorId=T.getActorId(),this._active=!T.getInactive(),this._properties=deserializeObject(T.getAttr())}},{key:"_mergeProperties",value:function(T){this._properties=_Object$assign(this._properties,T)}},{key:"userId",get:function(){return this._userId}},{key:"actorId",get:function(){return this._actorId}},{key:"isLocal",get:function(){return this._actorId!==0&&this._room._client.userId===this._userId}},{key:"isMaster",get:function(){return this._actorId!==0&&this._room.masterId===this._actorId}},{key:"isActive",get:function(){return this._active}},{key:"customProperties",get:function(){return this._properties}}]),B}();_objectSap("keys",function(){return function(_){return _objectKeys(_toObject(_))}});var keys$1=_core.Object.keys,keys=createCommonjsModule(function(B){B.exports={default:keys$1,__esModule:!0}}),_Object$keys=unwrapExports(keys),PlayErrorCode={OPEN_WEBSOCKET_ERROR:10001,SEND_MESSAGE_STATE_ERROR:10002,STATE_ERROR:10003},ws=null;typeof WebSocket<"u"?ws=WebSocket:typeof MozWebSocket<"u"?ws=MozWebSocket:typeof commonjsGlobal$1<"u"?ws=commonjsGlobal$1.WebSocket||commonjsGlobal$1.MozWebSocket:typeof window<"u"?ws=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(ws=self.WebSocket||self.MozWebSocket);var browser=ws,adapters={WebSocket:browser};function setAdapters(B){_Object$assign(adapters,B)}var wrappers_pb=createCommonjsModule(function(B,_){var T=googleProtobuf,E=Function("return this")();T.exportSymbol("proto.google.protobuf.BoolValue",null,E),T.exportSymbol("proto.google.protobuf.BytesValue",null,E),T.exportSymbol("proto.google.protobuf.DoubleValue",null,E),T.exportSymbol("proto.google.protobuf.FloatValue",null,E),T.exportSymbol("proto.google.protobuf.Int32Value",null,E),T.exportSymbol("proto.google.protobuf.Int64Value",null,E),T.exportSymbol("proto.google.protobuf.StringValue",null,E),T.exportSymbol("proto.google.protobuf.UInt32Value",null,E),T.exportSymbol("proto.google.protobuf.UInt64Value",null,E);var{proto:W}=E;W.google.protobuf.DoubleValue=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.DoubleValue,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.DoubleValue.displayName="proto.google.protobuf.DoubleValue"),W.google.protobuf.FloatValue=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.FloatValue,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.FloatValue.displayName="proto.google.protobuf.FloatValue"),W.google.protobuf.Int64Value=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.Int64Value,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.Int64Value.displayName="proto.google.protobuf.Int64Value"),W.google.protobuf.UInt64Value=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.UInt64Value,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.UInt64Value.displayName="proto.google.protobuf.UInt64Value"),W.google.protobuf.Int32Value=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.Int32Value,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.Int32Value.displayName="proto.google.protobuf.Int32Value"),W.google.protobuf.UInt32Value=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.UInt32Value,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.UInt32Value.displayName="proto.google.protobuf.UInt32Value"),W.google.protobuf.BoolValue=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.BoolValue,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.BoolValue.displayName="proto.google.protobuf.BoolValue"),W.google.protobuf.StringValue=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.StringValue,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.StringValue.displayName="proto.google.protobuf.StringValue"),W.google.protobuf.BytesValue=function(X){googleProtobuf.Message.initialize(this,X,0,-1,null,null)},T.inherits(W.google.protobuf.BytesValue,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(W.google.protobuf.BytesValue.displayName="proto.google.protobuf.BytesValue"),googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.DoubleValue.prototype.toObject=function(X){return W.google.protobuf.DoubleValue.toObject(X,this)},W.google.protobuf.DoubleValue.toObject=function(X,q){var Y={value:googleProtobuf.Message.getFloatingPointFieldWithDefault(q,1,0)};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.DoubleValue.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.DoubleValue;return W.google.protobuf.DoubleValue.deserializeBinaryFromReader(Y,q)},W.google.protobuf.DoubleValue.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readDouble();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.DoubleValue.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.DoubleValue.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.DoubleValue.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y!==0&&q.writeDouble(1,Y)},W.google.protobuf.DoubleValue.prototype.getValue=function(){return googleProtobuf.Message.getFloatingPointFieldWithDefault(this,1,0)},W.google.protobuf.DoubleValue.prototype.setValue=function(X){return googleProtobuf.Message.setProto3FloatField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.FloatValue.prototype.toObject=function(X){return W.google.protobuf.FloatValue.toObject(X,this)},W.google.protobuf.FloatValue.toObject=function(X,q){var Y={value:googleProtobuf.Message.getFloatingPointFieldWithDefault(q,1,0)};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.FloatValue.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.FloatValue;return W.google.protobuf.FloatValue.deserializeBinaryFromReader(Y,q)},W.google.protobuf.FloatValue.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readFloat();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.FloatValue.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.FloatValue.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.FloatValue.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y!==0&&q.writeFloat(1,Y)},W.google.protobuf.FloatValue.prototype.getValue=function(){return googleProtobuf.Message.getFloatingPointFieldWithDefault(this,1,0)},W.google.protobuf.FloatValue.prototype.setValue=function(X){return googleProtobuf.Message.setProto3FloatField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.Int64Value.prototype.toObject=function(X){return W.google.protobuf.Int64Value.toObject(X,this)},W.google.protobuf.Int64Value.toObject=function(X,q){var Y={value:googleProtobuf.Message.getFieldWithDefault(q,1,0)};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.Int64Value.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.Int64Value;return W.google.protobuf.Int64Value.deserializeBinaryFromReader(Y,q)},W.google.protobuf.Int64Value.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readInt64();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.Int64Value.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.Int64Value.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.Int64Value.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y!==0&&q.writeInt64(1,Y)},W.google.protobuf.Int64Value.prototype.getValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},W.google.protobuf.Int64Value.prototype.setValue=function(X){return googleProtobuf.Message.setProto3IntField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.UInt64Value.prototype.toObject=function(X){return W.google.protobuf.UInt64Value.toObject(X,this)},W.google.protobuf.UInt64Value.toObject=function(X,q){var Y={value:googleProtobuf.Message.getFieldWithDefault(q,1,0)};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.UInt64Value.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.UInt64Value;return W.google.protobuf.UInt64Value.deserializeBinaryFromReader(Y,q)},W.google.protobuf.UInt64Value.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readUint64();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.UInt64Value.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.UInt64Value.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.UInt64Value.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y!==0&&q.writeUint64(1,Y)},W.google.protobuf.UInt64Value.prototype.getValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},W.google.protobuf.UInt64Value.prototype.setValue=function(X){return googleProtobuf.Message.setProto3IntField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.Int32Value.prototype.toObject=function(X){return W.google.protobuf.Int32Value.toObject(X,this)},W.google.protobuf.Int32Value.toObject=function(X,q){var Y={value:googleProtobuf.Message.getFieldWithDefault(q,1,0)};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.Int32Value.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.Int32Value;return W.google.protobuf.Int32Value.deserializeBinaryFromReader(Y,q)},W.google.protobuf.Int32Value.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readInt32();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.Int32Value.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.Int32Value.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.Int32Value.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y!==0&&q.writeInt32(1,Y)},W.google.protobuf.Int32Value.prototype.getValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},W.google.protobuf.Int32Value.prototype.setValue=function(X){return googleProtobuf.Message.setProto3IntField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.UInt32Value.prototype.toObject=function(X){return W.google.protobuf.UInt32Value.toObject(X,this)},W.google.protobuf.UInt32Value.toObject=function(X,q){var Y={value:googleProtobuf.Message.getFieldWithDefault(q,1,0)};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.UInt32Value.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.UInt32Value;return W.google.protobuf.UInt32Value.deserializeBinaryFromReader(Y,q)},W.google.protobuf.UInt32Value.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readUint32();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.UInt32Value.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.UInt32Value.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.UInt32Value.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y!==0&&q.writeUint32(1,Y)},W.google.protobuf.UInt32Value.prototype.getValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},W.google.protobuf.UInt32Value.prototype.setValue=function(X){return googleProtobuf.Message.setProto3IntField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.BoolValue.prototype.toObject=function(X){return W.google.protobuf.BoolValue.toObject(X,this)},W.google.protobuf.BoolValue.toObject=function(X,q){var Y={value:googleProtobuf.Message.getBooleanFieldWithDefault(q,1,!1)};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.BoolValue.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.BoolValue;return W.google.protobuf.BoolValue.deserializeBinaryFromReader(Y,q)},W.google.protobuf.BoolValue.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readBool();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.BoolValue.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.BoolValue.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.BoolValue.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y&&q.writeBool(1,Y)},W.google.protobuf.BoolValue.prototype.getValue=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,1,!1)},W.google.protobuf.BoolValue.prototype.setValue=function(X){return googleProtobuf.Message.setProto3BooleanField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.StringValue.prototype.toObject=function(X){return W.google.protobuf.StringValue.toObject(X,this)},W.google.protobuf.StringValue.toObject=function(X,q){var Y={value:googleProtobuf.Message.getFieldWithDefault(q,1,"")};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.StringValue.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.StringValue;return W.google.protobuf.StringValue.deserializeBinaryFromReader(Y,q)},W.google.protobuf.StringValue.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readString();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.StringValue.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.StringValue.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.StringValue.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue(),Y.length>0&&q.writeString(1,Y)},W.google.protobuf.StringValue.prototype.getValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},W.google.protobuf.StringValue.prototype.setValue=function(X){return googleProtobuf.Message.setProto3StringField(this,1,X)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(W.google.protobuf.BytesValue.prototype.toObject=function(X){return W.google.protobuf.BytesValue.toObject(X,this)},W.google.protobuf.BytesValue.toObject=function(X,q){var Y={value:q.getValue_asB64()};return X&&(Y.$jspbMessageInstance=q),Y}),W.google.protobuf.BytesValue.deserializeBinary=function(X){var q=new googleProtobuf.BinaryReader(X),Y=new W.google.protobuf.BytesValue;return W.google.protobuf.BytesValue.deserializeBinaryFromReader(Y,q)},W.google.protobuf.BytesValue.deserializeBinaryFromReader=function(X,q){for(;q.nextField()&&!q.isEndGroup();){var Y=q.getFieldNumber();switch(Y){case 1:var te=q.readBytes();X.setValue(te);break;default:q.skipField();break}}return X},W.google.protobuf.BytesValue.prototype.serializeBinary=function(){var X=new googleProtobuf.BinaryWriter;return W.google.protobuf.BytesValue.serializeBinaryToWriter(this,X),X.getResultBuffer()},W.google.protobuf.BytesValue.serializeBinaryToWriter=function(X,q){var Y=void 0;Y=X.getValue_asU8(),Y.length>0&&q.writeBytes(1,Y)},W.google.protobuf.BytesValue.prototype.getValue=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},W.google.protobuf.BytesValue.prototype.getValue_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getValue())},W.google.protobuf.BytesValue.prototype.getValue_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getValue())},W.google.protobuf.BytesValue.prototype.setValue=function(X){return googleProtobuf.Message.setProto3BytesField(this,1,X)},T.object.extend(_,W.google.protobuf)}),messages_pb=createCommonjsModule(function(B,_){var T=googleProtobuf,E={};T.object.extend(E,wrappers_pb),T.exportSymbol("game_protobuf_messages.proto.messages.AckCommand",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.AppInfo",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.AppStatistic",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.Body",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.Body.BodyCase",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.Command",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.CommandType",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.CreateRoomRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.CreateRoomResponse",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.DirectCommand",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.ErrorCommand",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.ErrorInfo",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.EventsCommand",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.EventsRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.IntValue",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.InterestGroups",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.JoinLobbyRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.JoinRoomNotification",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.JoinRoomRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.JoinRoomResponse",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.KickMemberRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.KickMemberResponse",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.LeftRoomNotification",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.OpType",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RequestMessage",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RequestMessage.RequestCase",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.ResponseMessage",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.ResponseMessage.ResponseCase",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RoomListCommand",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RoomMember",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RoomNotification",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RoomNotification.NotificationCase",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RoomOptions",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.RoomSystemProperty",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.SessionOpenRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.StatisticCommand",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdateMasterClientNotification",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdateMasterClientRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdateMasterClientResponse",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdatePropertyNotification",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdatePropertyRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdatePropertyResponse",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdateSysPropertyNotification",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdateSysPropertyRequest",null,E),T.exportSymbol("game_protobuf_messages.proto.messages.UpdateSysPropertyResponse",null,E),E.game_protobuf_messages.proto.messages.IntValue=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.IntValue,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.IntValue.displayName="proto.game_protobuf_messages.proto.messages.IntValue"),E.game_protobuf_messages.proto.messages.RoomSystemProperty=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.RoomSystemProperty,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.RoomSystemProperty.displayName="proto.game_protobuf_messages.proto.messages.RoomSystemProperty"),E.game_protobuf_messages.proto.messages.RoomMember=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.RoomMember,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.RoomMember.displayName="proto.game_protobuf_messages.proto.messages.RoomMember"),E.game_protobuf_messages.proto.messages.AppInfo=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.AppInfo,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.AppInfo.displayName="proto.game_protobuf_messages.proto.messages.AppInfo"),E.game_protobuf_messages.proto.messages.ErrorInfo=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.ErrorInfo,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.ErrorInfo.displayName="proto.game_protobuf_messages.proto.messages.ErrorInfo"),E.game_protobuf_messages.proto.messages.RoomOptions=function(W){googleProtobuf.Message.initialize(this,W,0,-1,E.game_protobuf_messages.proto.messages.RoomOptions.repeatedFields_,null)},T.inherits(E.game_protobuf_messages.proto.messages.RoomOptions,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.RoomOptions.displayName="proto.game_protobuf_messages.proto.messages.RoomOptions"),E.game_protobuf_messages.proto.messages.SessionOpenRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.SessionOpenRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.SessionOpenRequest.displayName="proto.game_protobuf_messages.proto.messages.SessionOpenRequest"),E.game_protobuf_messages.proto.messages.CreateRoomRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.CreateRoomRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.CreateRoomRequest.displayName="proto.game_protobuf_messages.proto.messages.CreateRoomRequest"),E.game_protobuf_messages.proto.messages.CreateRoomResponse=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.CreateRoomResponse,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.CreateRoomResponse.displayName="proto.game_protobuf_messages.proto.messages.CreateRoomResponse"),E.game_protobuf_messages.proto.messages.JoinRoomRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.JoinRoomRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.JoinRoomRequest.displayName="proto.game_protobuf_messages.proto.messages.JoinRoomRequest"),E.game_protobuf_messages.proto.messages.JoinRoomResponse=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.JoinRoomResponse,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.JoinRoomResponse.displayName="proto.game_protobuf_messages.proto.messages.JoinRoomResponse"),E.game_protobuf_messages.proto.messages.JoinRoomNotification=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.JoinRoomNotification,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.JoinRoomNotification.displayName="proto.game_protobuf_messages.proto.messages.JoinRoomNotification"),E.game_protobuf_messages.proto.messages.LeftRoomNotification=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.LeftRoomNotification,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.LeftRoomNotification.displayName="proto.game_protobuf_messages.proto.messages.LeftRoomNotification"),E.game_protobuf_messages.proto.messages.KickMemberRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.KickMemberRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.KickMemberRequest.displayName="proto.game_protobuf_messages.proto.messages.KickMemberRequest"),E.game_protobuf_messages.proto.messages.KickMemberResponse=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.KickMemberResponse,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.KickMemberResponse.displayName="proto.game_protobuf_messages.proto.messages.KickMemberResponse"),E.game_protobuf_messages.proto.messages.UpdatePropertyRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdatePropertyRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.displayName="proto.game_protobuf_messages.proto.messages.UpdatePropertyRequest"),E.game_protobuf_messages.proto.messages.UpdatePropertyResponse=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdatePropertyResponse,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.displayName="proto.game_protobuf_messages.proto.messages.UpdatePropertyResponse"),E.game_protobuf_messages.proto.messages.UpdatePropertyNotification=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdatePropertyNotification,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.displayName="proto.game_protobuf_messages.proto.messages.UpdatePropertyNotification"),E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.displayName="proto.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest"),E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.displayName="proto.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse"),E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.displayName="proto.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification"),E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.displayName="proto.game_protobuf_messages.proto.messages.UpdateMasterClientRequest"),E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.displayName="proto.game_protobuf_messages.proto.messages.UpdateMasterClientResponse"),E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.displayName="proto.game_protobuf_messages.proto.messages.UpdateMasterClientNotification"),E.game_protobuf_messages.proto.messages.RoomNotification=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_)},T.inherits(E.game_protobuf_messages.proto.messages.RoomNotification,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.RoomNotification.displayName="proto.game_protobuf_messages.proto.messages.RoomNotification"),E.game_protobuf_messages.proto.messages.DirectCommand=function(W){googleProtobuf.Message.initialize(this,W,0,-1,E.game_protobuf_messages.proto.messages.DirectCommand.repeatedFields_,null)},T.inherits(E.game_protobuf_messages.proto.messages.DirectCommand,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.DirectCommand.displayName="proto.game_protobuf_messages.proto.messages.DirectCommand"),E.game_protobuf_messages.proto.messages.AckCommand=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.AckCommand,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.AckCommand.displayName="proto.game_protobuf_messages.proto.messages.AckCommand"),E.game_protobuf_messages.proto.messages.EventsRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.EventsRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.EventsRequest.displayName="proto.game_protobuf_messages.proto.messages.EventsRequest"),E.game_protobuf_messages.proto.messages.EventsCommand=function(W){googleProtobuf.Message.initialize(this,W,0,-1,E.game_protobuf_messages.proto.messages.EventsCommand.repeatedFields_,null)},T.inherits(E.game_protobuf_messages.proto.messages.EventsCommand,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.EventsCommand.displayName="proto.game_protobuf_messages.proto.messages.EventsCommand"),E.game_protobuf_messages.proto.messages.InterestGroups=function(W){googleProtobuf.Message.initialize(this,W,0,-1,E.game_protobuf_messages.proto.messages.InterestGroups.repeatedFields_,null)},T.inherits(E.game_protobuf_messages.proto.messages.InterestGroups,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.InterestGroups.displayName="proto.game_protobuf_messages.proto.messages.InterestGroups"),E.game_protobuf_messages.proto.messages.JoinLobbyRequest=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.JoinLobbyRequest,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.JoinLobbyRequest.displayName="proto.game_protobuf_messages.proto.messages.JoinLobbyRequest"),E.game_protobuf_messages.proto.messages.RoomListCommand=function(W){googleProtobuf.Message.initialize(this,W,0,-1,E.game_protobuf_messages.proto.messages.RoomListCommand.repeatedFields_,null)},T.inherits(E.game_protobuf_messages.proto.messages.RoomListCommand,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.RoomListCommand.displayName="proto.game_protobuf_messages.proto.messages.RoomListCommand"),E.game_protobuf_messages.proto.messages.AppStatistic=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.AppStatistic,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.AppStatistic.displayName="proto.game_protobuf_messages.proto.messages.AppStatistic"),E.game_protobuf_messages.proto.messages.StatisticCommand=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.StatisticCommand,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.StatisticCommand.displayName="proto.game_protobuf_messages.proto.messages.StatisticCommand"),E.game_protobuf_messages.proto.messages.ErrorCommand=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.ErrorCommand,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.ErrorCommand.displayName="proto.game_protobuf_messages.proto.messages.ErrorCommand"),E.game_protobuf_messages.proto.messages.RequestMessage=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_)},T.inherits(E.game_protobuf_messages.proto.messages.RequestMessage,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.RequestMessage.displayName="proto.game_protobuf_messages.proto.messages.RequestMessage"),E.game_protobuf_messages.proto.messages.ResponseMessage=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_)},T.inherits(E.game_protobuf_messages.proto.messages.ResponseMessage,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.ResponseMessage.displayName="proto.game_protobuf_messages.proto.messages.ResponseMessage"),E.game_protobuf_messages.proto.messages.Body=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,E.game_protobuf_messages.proto.messages.Body.oneofGroups_)},T.inherits(E.game_protobuf_messages.proto.messages.Body,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.Body.displayName="proto.game_protobuf_messages.proto.messages.Body"),E.game_protobuf_messages.proto.messages.Command=function(W){googleProtobuf.Message.initialize(this,W,0,-1,null,null)},T.inherits(E.game_protobuf_messages.proto.messages.Command,googleProtobuf.Message),T.DEBUG&&!COMPILED&&(E.game_protobuf_messages.proto.messages.Command.displayName="proto.game_protobuf_messages.proto.messages.Command"),googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.IntValue.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.IntValue.toObject(W,this)},E.game_protobuf_messages.proto.messages.IntValue.toObject=function(W,X){var q={val:googleProtobuf.Message.getFieldWithDefault(X,1,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.IntValue.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.IntValue;return E.game_protobuf_messages.proto.messages.IntValue.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.IntValue.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setVal(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.IntValue.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.IntValue.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.IntValue.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getVal(),q!==0&&X.writeInt32(1,q)},E.game_protobuf_messages.proto.messages.IntValue.prototype.getVal=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.IntValue.prototype.setVal=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.RoomSystemProperty.toObject(W,this)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.toObject=function(W,X){var q,Y={open:(q=X.getOpen())&&wrappers_pb.BoolValue.toObject(W,q),visible:(q=X.getVisible())&&wrappers_pb.BoolValue.toObject(W,q),expectMembers:googleProtobuf.Message.getFieldWithDefault(X,3,""),maxMembers:googleProtobuf.Message.getFieldWithDefault(X,4,0)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.RoomSystemProperty.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.RoomSystemProperty;return E.game_protobuf_messages.proto.messages.RoomSystemProperty.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new wrappers_pb.BoolValue;X.readMessage(Y,wrappers_pb.BoolValue.deserializeBinaryFromReader),W.setOpen(Y);break;case 2:var Y=new wrappers_pb.BoolValue;X.readMessage(Y,wrappers_pb.BoolValue.deserializeBinaryFromReader),W.setVisible(Y);break;case 3:var Y=X.readString();W.setExpectMembers(Y);break;case 4:var Y=X.readInt32();W.setMaxMembers(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.RoomSystemProperty.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.RoomSystemProperty.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getOpen(),q!=null&&X.writeMessage(1,q,wrappers_pb.BoolValue.serializeBinaryToWriter),q=W.getVisible(),q!=null&&X.writeMessage(2,q,wrappers_pb.BoolValue.serializeBinaryToWriter),q=W.getExpectMembers(),q.length>0&&X.writeString(3,q),q=W.getMaxMembers(),q!==0&&X.writeInt32(4,q)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.getOpen=function(){return googleProtobuf.Message.getWrapperField(this,wrappers_pb.BoolValue,1)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.setOpen=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.clearOpen=function(){return this.setOpen(void 0)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.hasOpen=function(){return googleProtobuf.Message.getField(this,1)!=null},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.getVisible=function(){return googleProtobuf.Message.getWrapperField(this,wrappers_pb.BoolValue,2)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.setVisible=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.clearVisible=function(){return this.setVisible(void 0)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.hasVisible=function(){return googleProtobuf.Message.getField(this,2)!=null},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.getExpectMembers=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,"")},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.setExpectMembers=function(W){return googleProtobuf.Message.setProto3StringField(this,3,W)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.getMaxMembers=function(){return googleProtobuf.Message.getFieldWithDefault(this,4,0)},E.game_protobuf_messages.proto.messages.RoomSystemProperty.prototype.setMaxMembers=function(W){return googleProtobuf.Message.setProto3IntField(this,4,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.RoomMember.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.RoomMember.toObject(W,this)},E.game_protobuf_messages.proto.messages.RoomMember.toObject=function(W,X){var q={pid:googleProtobuf.Message.getFieldWithDefault(X,1,""),actorId:googleProtobuf.Message.getFieldWithDefault(X,2,0),attr:X.getAttr_asB64(),inactive:googleProtobuf.Message.getBooleanFieldWithDefault(X,4,!1)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.RoomMember.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.RoomMember;return E.game_protobuf_messages.proto.messages.RoomMember.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.RoomMember.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readString();W.setPid(Y);break;case 2:var Y=X.readInt32();W.setActorId(Y);break;case 3:var Y=X.readBytes();W.setAttr(Y);break;case 4:var Y=X.readBool();W.setInactive(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.RoomMember.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.RoomMember.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.RoomMember.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getPid(),q.length>0&&X.writeString(1,q),q=W.getActorId(),q!==0&&X.writeInt32(2,q),q=W.getAttr_asU8(),q.length>0&&X.writeBytes(3,q),q=W.getInactive(),q&&X.writeBool(4,q)},E.game_protobuf_messages.proto.messages.RoomMember.prototype.getPid=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.game_protobuf_messages.proto.messages.RoomMember.prototype.setPid=function(W){return googleProtobuf.Message.setProto3StringField(this,1,W)},E.game_protobuf_messages.proto.messages.RoomMember.prototype.getActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,0)},E.game_protobuf_messages.proto.messages.RoomMember.prototype.setActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,2,W)},E.game_protobuf_messages.proto.messages.RoomMember.prototype.getAttr=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,"")},E.game_protobuf_messages.proto.messages.RoomMember.prototype.getAttr_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getAttr())},E.game_protobuf_messages.proto.messages.RoomMember.prototype.getAttr_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getAttr())},E.game_protobuf_messages.proto.messages.RoomMember.prototype.setAttr=function(W){return googleProtobuf.Message.setProto3BytesField(this,3,W)},E.game_protobuf_messages.proto.messages.RoomMember.prototype.getInactive=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,4,!1)},E.game_protobuf_messages.proto.messages.RoomMember.prototype.setInactive=function(W){return googleProtobuf.Message.setProto3BooleanField(this,4,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.AppInfo.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.AppInfo.toObject(W,this)},E.game_protobuf_messages.proto.messages.AppInfo.toObject=function(W,X){var q={appCode:googleProtobuf.Message.getFieldWithDefault(X,1,0),appMsg:googleProtobuf.Message.getFieldWithDefault(X,2,"")};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.AppInfo.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.AppInfo;return E.game_protobuf_messages.proto.messages.AppInfo.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.AppInfo.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setAppCode(Y);break;case 2:var Y=X.readString();W.setAppMsg(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.AppInfo.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.AppInfo.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.AppInfo.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getAppCode(),q!==0&&X.writeInt32(1,q),q=W.getAppMsg(),q.length>0&&X.writeString(2,q)},E.game_protobuf_messages.proto.messages.AppInfo.prototype.getAppCode=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.AppInfo.prototype.setAppCode=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.AppInfo.prototype.getAppMsg=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,"")},E.game_protobuf_messages.proto.messages.AppInfo.prototype.setAppMsg=function(W){return googleProtobuf.Message.setProto3StringField(this,2,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.ErrorInfo.toObject(W,this)},E.game_protobuf_messages.proto.messages.ErrorInfo.toObject=function(W,X){var q,Y={reasonCode:googleProtobuf.Message.getFieldWithDefault(X,1,0),detail:googleProtobuf.Message.getFieldWithDefault(X,2,""),appInfo:(q=X.getAppInfo())&&E.game_protobuf_messages.proto.messages.AppInfo.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.ErrorInfo.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.ErrorInfo;return E.game_protobuf_messages.proto.messages.ErrorInfo.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.ErrorInfo.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setReasonCode(Y);break;case 2:var Y=X.readString();W.setDetail(Y);break;case 3:var Y=new E.game_protobuf_messages.proto.messages.AppInfo;X.readMessage(Y,E.game_protobuf_messages.proto.messages.AppInfo.deserializeBinaryFromReader),W.setAppInfo(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.ErrorInfo.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.ErrorInfo.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getReasonCode(),q!==0&&X.writeInt32(1,q),q=W.getDetail(),q.length>0&&X.writeString(2,q),q=W.getAppInfo(),q!=null&&X.writeMessage(3,q,E.game_protobuf_messages.proto.messages.AppInfo.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.getReasonCode=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.setReasonCode=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.getDetail=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,"")},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.setDetail=function(W){return googleProtobuf.Message.setProto3StringField(this,2,W)},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.getAppInfo=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.AppInfo,3)},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.setAppInfo=function(W){return googleProtobuf.Message.setWrapperField(this,3,W)},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.clearAppInfo=function(){return this.setAppInfo(void 0)},E.game_protobuf_messages.proto.messages.ErrorInfo.prototype.hasAppInfo=function(){return googleProtobuf.Message.getField(this,3)!=null},E.game_protobuf_messages.proto.messages.RoomOptions.repeatedFields_=[10,11,12],googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.RoomOptions.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.RoomOptions.toObject(W,this)},E.game_protobuf_messages.proto.messages.RoomOptions.toObject=function(W,X){var q,Y={cid:googleProtobuf.Message.getFieldWithDefault(X,1,""),visible:(q=X.getVisible())&&wrappers_pb.BoolValue.toObject(W,q),open:(q=X.getOpen())&&wrappers_pb.BoolValue.toObject(W,q),emptyRoomTtl:googleProtobuf.Message.getFieldWithDefault(X,4,0),playerTtl:googleProtobuf.Message.getFieldWithDefault(X,5,0),maxMembers:googleProtobuf.Message.getFieldWithDefault(X,6,0),flag:googleProtobuf.Message.getFieldWithDefault(X,7,0),pluginName:googleProtobuf.Message.getFieldWithDefault(X,8,""),attr:X.getAttr_asB64(),expectMembersList:(q=googleProtobuf.Message.getRepeatedField(X,10))==null?void 0:q,lobbyAttrKeysList:(q=googleProtobuf.Message.getRepeatedField(X,11))==null?void 0:q,membersList:googleProtobuf.Message.toObjectList(X.getMembersList(),E.game_protobuf_messages.proto.messages.RoomMember.toObject,W),memberCount:googleProtobuf.Message.getFieldWithDefault(X,13,0),masterActorId:googleProtobuf.Message.getFieldWithDefault(X,14,0)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.RoomOptions;return E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readString();W.setCid(Y);break;case 2:var Y=new wrappers_pb.BoolValue;X.readMessage(Y,wrappers_pb.BoolValue.deserializeBinaryFromReader),W.setVisible(Y);break;case 3:var Y=new wrappers_pb.BoolValue;X.readMessage(Y,wrappers_pb.BoolValue.deserializeBinaryFromReader),W.setOpen(Y);break;case 4:var Y=X.readInt32();W.setEmptyRoomTtl(Y);break;case 5:var Y=X.readInt32();W.setPlayerTtl(Y);break;case 6:var Y=X.readInt32();W.setMaxMembers(Y);break;case 7:var Y=X.readInt64();W.setFlag(Y);break;case 8:var Y=X.readString();W.setPluginName(Y);break;case 9:var Y=X.readBytes();W.setAttr(Y);break;case 10:var Y=X.readString();W.addExpectMembers(Y);break;case 11:var Y=X.readString();W.addLobbyAttrKeys(Y);break;case 12:var Y=new E.game_protobuf_messages.proto.messages.RoomMember;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomMember.deserializeBinaryFromReader),W.addMembers(Y);break;case 13:var Y=X.readInt32();W.setMemberCount(Y);break;case 14:var Y=X.readInt32();W.setMasterActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.RoomOptions.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.RoomOptions.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getCid(),q.length>0&&X.writeString(1,q),q=W.getVisible(),q!=null&&X.writeMessage(2,q,wrappers_pb.BoolValue.serializeBinaryToWriter),q=W.getOpen(),q!=null&&X.writeMessage(3,q,wrappers_pb.BoolValue.serializeBinaryToWriter),q=W.getEmptyRoomTtl(),q!==0&&X.writeInt32(4,q),q=W.getPlayerTtl(),q!==0&&X.writeInt32(5,q),q=W.getMaxMembers(),q!==0&&X.writeInt32(6,q),q=W.getFlag(),q!==0&&X.writeInt64(7,q),q=W.getPluginName(),q.length>0&&X.writeString(8,q),q=W.getAttr_asU8(),q.length>0&&X.writeBytes(9,q),q=W.getExpectMembersList(),q.length>0&&X.writeRepeatedString(10,q),q=W.getLobbyAttrKeysList(),q.length>0&&X.writeRepeatedString(11,q),q=W.getMembersList(),q.length>0&&X.writeRepeatedMessage(12,q,E.game_protobuf_messages.proto.messages.RoomMember.serializeBinaryToWriter),q=W.getMemberCount(),q!==0&&X.writeInt32(13,q),q=W.getMasterActorId(),q!==0&&X.writeInt32(14,q)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getCid=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setCid=function(W){return googleProtobuf.Message.setProto3StringField(this,1,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getVisible=function(){return googleProtobuf.Message.getWrapperField(this,wrappers_pb.BoolValue,2)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setVisible=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.clearVisible=function(){return this.setVisible(void 0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.hasVisible=function(){return googleProtobuf.Message.getField(this,2)!=null},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getOpen=function(){return googleProtobuf.Message.getWrapperField(this,wrappers_pb.BoolValue,3)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setOpen=function(W){return googleProtobuf.Message.setWrapperField(this,3,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.clearOpen=function(){return this.setOpen(void 0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.hasOpen=function(){return googleProtobuf.Message.getField(this,3)!=null},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getEmptyRoomTtl=function(){return googleProtobuf.Message.getFieldWithDefault(this,4,0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setEmptyRoomTtl=function(W){return googleProtobuf.Message.setProto3IntField(this,4,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getPlayerTtl=function(){return googleProtobuf.Message.getFieldWithDefault(this,5,0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setPlayerTtl=function(W){return googleProtobuf.Message.setProto3IntField(this,5,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getMaxMembers=function(){return googleProtobuf.Message.getFieldWithDefault(this,6,0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setMaxMembers=function(W){return googleProtobuf.Message.setProto3IntField(this,6,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getFlag=function(){return googleProtobuf.Message.getFieldWithDefault(this,7,0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setFlag=function(W){return googleProtobuf.Message.setProto3IntField(this,7,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getPluginName=function(){return googleProtobuf.Message.getFieldWithDefault(this,8,"")},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setPluginName=function(W){return googleProtobuf.Message.setProto3StringField(this,8,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getAttr=function(){return googleProtobuf.Message.getFieldWithDefault(this,9,"")},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getAttr_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getAttr())},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getAttr_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getAttr())},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setAttr=function(W){return googleProtobuf.Message.setProto3BytesField(this,9,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getExpectMembersList=function(){return googleProtobuf.Message.getRepeatedField(this,10)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setExpectMembersList=function(W){return googleProtobuf.Message.setField(this,10,W||[])},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.addExpectMembers=function(W,X){return googleProtobuf.Message.addToRepeatedField(this,10,W,X)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.clearExpectMembersList=function(){return this.setExpectMembersList([])},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getLobbyAttrKeysList=function(){return googleProtobuf.Message.getRepeatedField(this,11)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setLobbyAttrKeysList=function(W){return googleProtobuf.Message.setField(this,11,W||[])},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.addLobbyAttrKeys=function(W,X){return googleProtobuf.Message.addToRepeatedField(this,11,W,X)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.clearLobbyAttrKeysList=function(){return this.setLobbyAttrKeysList([])},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getMembersList=function(){return googleProtobuf.Message.getRepeatedWrapperField(this,E.game_protobuf_messages.proto.messages.RoomMember,12)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setMembersList=function(W){return googleProtobuf.Message.setRepeatedWrapperField(this,12,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.addMembers=function(W,X){return googleProtobuf.Message.addToRepeatedWrapperField(this,12,W,E.game_protobuf_messages.proto.messages.RoomMember,X)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.clearMembersList=function(){return this.setMembersList([])},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getMemberCount=function(){return googleProtobuf.Message.getFieldWithDefault(this,13,0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setMemberCount=function(W){return googleProtobuf.Message.setProto3IntField(this,13,W)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.getMasterActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,14,0)},E.game_protobuf_messages.proto.messages.RoomOptions.prototype.setMasterActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,14,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.SessionOpenRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.toObject=function(W,X){var q={appId:googleProtobuf.Message.getFieldWithDefault(X,1,""),peerId:googleProtobuf.Message.getFieldWithDefault(X,2,""),gameVersion:googleProtobuf.Message.getFieldWithDefault(X,3,""),sdkVersion:googleProtobuf.Message.getFieldWithDefault(X,4,""),protocolVersion:googleProtobuf.Message.getFieldWithDefault(X,5,""),t:googleProtobuf.Message.getFieldWithDefault(X,6,0),n:googleProtobuf.Message.getFieldWithDefault(X,7,""),s:googleProtobuf.Message.getFieldWithDefault(X,8,""),configBitmap:googleProtobuf.Message.getFieldWithDefault(X,9,0),sessionToken:googleProtobuf.Message.getFieldWithDefault(X,10,"")};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.SessionOpenRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.SessionOpenRequest;return E.game_protobuf_messages.proto.messages.SessionOpenRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readString();W.setAppId(Y);break;case 2:var Y=X.readString();W.setPeerId(Y);break;case 3:var Y=X.readString();W.setGameVersion(Y);break;case 4:var Y=X.readString();W.setSdkVersion(Y);break;case 5:var Y=X.readString();W.setProtocolVersion(Y);break;case 6:var Y=X.readInt64();W.setT(Y);break;case 7:var Y=X.readString();W.setN(Y);break;case 8:var Y=X.readString();W.setS(Y);break;case 9:var Y=X.readInt64();W.setConfigBitmap(Y);break;case 10:var Y=X.readString();W.setSessionToken(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.SessionOpenRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.SessionOpenRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getAppId(),q.length>0&&X.writeString(1,q),q=W.getPeerId(),q.length>0&&X.writeString(2,q),q=W.getGameVersion(),q.length>0&&X.writeString(3,q),q=W.getSdkVersion(),q.length>0&&X.writeString(4,q),q=W.getProtocolVersion(),q.length>0&&X.writeString(5,q),q=W.getT(),q!==0&&X.writeInt64(6,q),q=W.getN(),q.length>0&&X.writeString(7,q),q=W.getS(),q.length>0&&X.writeString(8,q),q=W.getConfigBitmap(),q!==0&&X.writeInt64(9,q),q=W.getSessionToken(),q.length>0&&X.writeString(10,q)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getAppId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setAppId=function(W){return googleProtobuf.Message.setProto3StringField(this,1,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getPeerId=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setPeerId=function(W){return googleProtobuf.Message.setProto3StringField(this,2,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getGameVersion=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setGameVersion=function(W){return googleProtobuf.Message.setProto3StringField(this,3,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getSdkVersion=function(){return googleProtobuf.Message.getFieldWithDefault(this,4,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setSdkVersion=function(W){return googleProtobuf.Message.setProto3StringField(this,4,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getProtocolVersion=function(){return googleProtobuf.Message.getFieldWithDefault(this,5,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setProtocolVersion=function(W){return googleProtobuf.Message.setProto3StringField(this,5,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getT=function(){return googleProtobuf.Message.getFieldWithDefault(this,6,0)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setT=function(W){return googleProtobuf.Message.setProto3IntField(this,6,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getN=function(){return googleProtobuf.Message.getFieldWithDefault(this,7,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setN=function(W){return googleProtobuf.Message.setProto3StringField(this,7,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getS=function(){return googleProtobuf.Message.getFieldWithDefault(this,8,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setS=function(W){return googleProtobuf.Message.setProto3StringField(this,8,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getConfigBitmap=function(){return googleProtobuf.Message.getFieldWithDefault(this,9,0)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setConfigBitmap=function(W){return googleProtobuf.Message.setProto3IntField(this,9,W)},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.getSessionToken=function(){return googleProtobuf.Message.getFieldWithDefault(this,10,"")},E.game_protobuf_messages.proto.messages.SessionOpenRequest.prototype.setSessionToken=function(W){return googleProtobuf.Message.setProto3StringField(this,10,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.CreateRoomRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.CreateRoomRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.CreateRoomRequest.toObject=function(W,X){var q,Y={roomOptions:(q=X.getRoomOptions())&&E.game_protobuf_messages.proto.messages.RoomOptions.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.CreateRoomRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.CreateRoomRequest;return E.game_protobuf_messages.proto.messages.CreateRoomRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.CreateRoomRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomOptions;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinaryFromReader),W.setRoomOptions(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.CreateRoomRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.CreateRoomRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.CreateRoomRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getRoomOptions(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RoomOptions.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.CreateRoomRequest.prototype.getRoomOptions=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomOptions,1)},E.game_protobuf_messages.proto.messages.CreateRoomRequest.prototype.setRoomOptions=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.CreateRoomRequest.prototype.clearRoomOptions=function(){return this.setRoomOptions(void 0)},E.game_protobuf_messages.proto.messages.CreateRoomRequest.prototype.hasRoomOptions=function(){return googleProtobuf.Message.getField(this,1)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.CreateRoomResponse.toObject(W,this)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.toObject=function(W,X){var q,Y={roomOptions:(q=X.getRoomOptions())&&E.game_protobuf_messages.proto.messages.RoomOptions.toObject(W,q),addr:googleProtobuf.Message.getFieldWithDefault(X,2,""),roomCreated:googleProtobuf.Message.getBooleanFieldWithDefault(X,3,!1)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.CreateRoomResponse.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.CreateRoomResponse;return E.game_protobuf_messages.proto.messages.CreateRoomResponse.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomOptions;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinaryFromReader),W.setRoomOptions(Y);break;case 2:var Y=X.readString();W.setAddr(Y);break;case 3:var Y=X.readBool();W.setRoomCreated(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.CreateRoomResponse.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.CreateRoomResponse.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getRoomOptions(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RoomOptions.serializeBinaryToWriter),q=W.getAddr(),q.length>0&&X.writeString(2,q),q=W.getRoomCreated(),q&&X.writeBool(3,q)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.getRoomOptions=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomOptions,1)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.setRoomOptions=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.clearRoomOptions=function(){return this.setRoomOptions(void 0)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.hasRoomOptions=function(){return googleProtobuf.Message.getField(this,1)!=null},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.getAddr=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,"")},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.setAddr=function(W){return googleProtobuf.Message.setProto3StringField(this,2,W)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.getRoomCreated=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,3,!1)},E.game_protobuf_messages.proto.messages.CreateRoomResponse.prototype.setRoomCreated=function(W){return googleProtobuf.Message.setProto3BooleanField(this,3,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.JoinRoomRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.toObject=function(W,X){var q,Y={rejoin:googleProtobuf.Message.getBooleanFieldWithDefault(X,1,!1),roomOptions:(q=X.getRoomOptions())&&E.game_protobuf_messages.proto.messages.RoomOptions.toObject(W,q),expectAttr:X.getExpectAttr_asB64(),piggybackPeerId:googleProtobuf.Message.getFieldWithDefault(X,4,""),createOnNotFound:googleProtobuf.Message.getBooleanFieldWithDefault(X,5,!1)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.JoinRoomRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.JoinRoomRequest;return E.game_protobuf_messages.proto.messages.JoinRoomRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readBool();W.setRejoin(Y);break;case 2:var Y=new E.game_protobuf_messages.proto.messages.RoomOptions;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinaryFromReader),W.setRoomOptions(Y);break;case 3:var Y=X.readBytes();W.setExpectAttr(Y);break;case 4:var Y=X.readString();W.setPiggybackPeerId(Y);break;case 5:var Y=X.readBool();W.setCreateOnNotFound(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.JoinRoomRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.JoinRoomRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getRejoin(),q&&X.writeBool(1,q),q=W.getRoomOptions(),q!=null&&X.writeMessage(2,q,E.game_protobuf_messages.proto.messages.RoomOptions.serializeBinaryToWriter),q=W.getExpectAttr_asU8(),q.length>0&&X.writeBytes(3,q),q=W.getPiggybackPeerId(),q.length>0&&X.writeString(4,q),q=W.getCreateOnNotFound(),q&&X.writeBool(5,q)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.getRejoin=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,1,!1)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.setRejoin=function(W){return googleProtobuf.Message.setProto3BooleanField(this,1,W)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.getRoomOptions=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomOptions,2)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.setRoomOptions=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.clearRoomOptions=function(){return this.setRoomOptions(void 0)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.hasRoomOptions=function(){return googleProtobuf.Message.getField(this,2)!=null},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.getExpectAttr=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,"")},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.getExpectAttr_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getExpectAttr())},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.getExpectAttr_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getExpectAttr())},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.setExpectAttr=function(W){return googleProtobuf.Message.setProto3BytesField(this,3,W)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.getPiggybackPeerId=function(){return googleProtobuf.Message.getFieldWithDefault(this,4,"")},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.setPiggybackPeerId=function(W){return googleProtobuf.Message.setProto3StringField(this,4,W)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.getCreateOnNotFound=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,5,!1)},E.game_protobuf_messages.proto.messages.JoinRoomRequest.prototype.setCreateOnNotFound=function(W){return googleProtobuf.Message.setProto3BooleanField(this,5,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.JoinRoomResponse.toObject(W,this)},E.game_protobuf_messages.proto.messages.JoinRoomResponse.toObject=function(W,X){var q,Y={roomOptions:(q=X.getRoomOptions())&&E.game_protobuf_messages.proto.messages.RoomOptions.toObject(W,q),addr:googleProtobuf.Message.getFieldWithDefault(X,2,"")};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.JoinRoomResponse.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.JoinRoomResponse;return E.game_protobuf_messages.proto.messages.JoinRoomResponse.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.JoinRoomResponse.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomOptions;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinaryFromReader),W.setRoomOptions(Y);break;case 2:var Y=X.readString();W.setAddr(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.JoinRoomResponse.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.JoinRoomResponse.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getRoomOptions(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RoomOptions.serializeBinaryToWriter),q=W.getAddr(),q.length>0&&X.writeString(2,q)},E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.getRoomOptions=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomOptions,1)},E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.setRoomOptions=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.clearRoomOptions=function(){return this.setRoomOptions(void 0)},E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.hasRoomOptions=function(){return googleProtobuf.Message.getField(this,1)!=null},E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.getAddr=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,"")},E.game_protobuf_messages.proto.messages.JoinRoomResponse.prototype.setAddr=function(W){return googleProtobuf.Message.setProto3StringField(this,2,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.JoinRoomNotification.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.JoinRoomNotification.toObject(W,this)},E.game_protobuf_messages.proto.messages.JoinRoomNotification.toObject=function(W,X){var q,Y={member:(q=X.getMember())&&E.game_protobuf_messages.proto.messages.RoomMember.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.JoinRoomNotification.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.JoinRoomNotification;return E.game_protobuf_messages.proto.messages.JoinRoomNotification.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.JoinRoomNotification.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomMember;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomMember.deserializeBinaryFromReader),W.setMember(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.JoinRoomNotification.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.JoinRoomNotification.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.JoinRoomNotification.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getMember(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RoomMember.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.JoinRoomNotification.prototype.getMember=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomMember,1)},E.game_protobuf_messages.proto.messages.JoinRoomNotification.prototype.setMember=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.JoinRoomNotification.prototype.clearMember=function(){return this.setMember(void 0)},E.game_protobuf_messages.proto.messages.JoinRoomNotification.prototype.hasMember=function(){return googleProtobuf.Message.getField(this,1)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.LeftRoomNotification.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.LeftRoomNotification.toObject(W,this)},E.game_protobuf_messages.proto.messages.LeftRoomNotification.toObject=function(W,X){var q={actorId:googleProtobuf.Message.getFieldWithDefault(X,1,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.LeftRoomNotification.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.LeftRoomNotification;return E.game_protobuf_messages.proto.messages.LeftRoomNotification.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.LeftRoomNotification.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.LeftRoomNotification.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.LeftRoomNotification.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.LeftRoomNotification.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getActorId(),q!==0&&X.writeInt32(1,q)},E.game_protobuf_messages.proto.messages.LeftRoomNotification.prototype.getActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.LeftRoomNotification.prototype.setActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.KickMemberRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.KickMemberRequest.toObject=function(W,X){var q,Y={targetActorId:googleProtobuf.Message.getFieldWithDefault(X,1,0),appInfo:(q=X.getAppInfo())&&E.game_protobuf_messages.proto.messages.AppInfo.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.KickMemberRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.KickMemberRequest;return E.game_protobuf_messages.proto.messages.KickMemberRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.KickMemberRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setTargetActorId(Y);break;case 2:var Y=new E.game_protobuf_messages.proto.messages.AppInfo;X.readMessage(Y,E.game_protobuf_messages.proto.messages.AppInfo.deserializeBinaryFromReader),W.setAppInfo(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.KickMemberRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.KickMemberRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getTargetActorId(),q!==0&&X.writeInt32(1,q),q=W.getAppInfo(),q!=null&&X.writeMessage(2,q,E.game_protobuf_messages.proto.messages.AppInfo.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.getTargetActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.setTargetActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.getAppInfo=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.AppInfo,2)},E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.setAppInfo=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.clearAppInfo=function(){return this.setAppInfo(void 0)},E.game_protobuf_messages.proto.messages.KickMemberRequest.prototype.hasAppInfo=function(){return googleProtobuf.Message.getField(this,2)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.KickMemberResponse.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.KickMemberResponse.toObject(W,this)},E.game_protobuf_messages.proto.messages.KickMemberResponse.toObject=function(W,X){var q={targetActorId:googleProtobuf.Message.getFieldWithDefault(X,1,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.KickMemberResponse.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.KickMemberResponse;return E.game_protobuf_messages.proto.messages.KickMemberResponse.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.KickMemberResponse.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setTargetActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.KickMemberResponse.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.KickMemberResponse.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.KickMemberResponse.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getTargetActorId(),q!==0&&X.writeInt32(1,q)},E.game_protobuf_messages.proto.messages.KickMemberResponse.prototype.getTargetActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.KickMemberResponse.prototype.setTargetActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.toObject=function(W,X){var q={targetActorId:googleProtobuf.Message.getFieldWithDefault(X,1,0),expectAttr:X.getExpectAttr_asB64(),attr:X.getAttr_asB64()};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdatePropertyRequest;return E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setTargetActorId(Y);break;case 2:var Y=X.readBytes();W.setExpectAttr(Y);break;case 3:var Y=X.readBytes();W.setAttr(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getTargetActorId(),q!==0&&X.writeInt32(1,q),q=W.getExpectAttr_asU8(),q.length>0&&X.writeBytes(2,q),q=W.getAttr_asU8(),q.length>0&&X.writeBytes(3,q)},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.getTargetActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.setTargetActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.getExpectAttr=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,"")},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.getExpectAttr_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getExpectAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.getExpectAttr_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getExpectAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.setExpectAttr=function(W){return googleProtobuf.Message.setProto3BytesField(this,2,W)},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.getAttr=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,"")},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.getAttr_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.getAttr_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.prototype.setAttr=function(W){return googleProtobuf.Message.setProto3BytesField(this,3,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.toObject=function(W,X){var q={attr:X.getAttr_asB64(),actorId:googleProtobuf.Message.getFieldWithDefault(X,2,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdatePropertyResponse;return E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readBytes();W.setAttr(Y);break;case 2:var Y=X.readInt32();W.setActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getAttr_asU8(),q.length>0&&X.writeBytes(1,q),q=W.getActorId(),q!==0&&X.writeInt32(2,q)},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.getAttr=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.getAttr_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.getAttr_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.setAttr=function(W){return googleProtobuf.Message.setProto3BytesField(this,1,W)},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.getActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,0)},E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.prototype.setActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,2,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.toObject=function(W,X){var q={attr:X.getAttr_asB64(),actorId:googleProtobuf.Message.getFieldWithDefault(X,2,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdatePropertyNotification;return E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readBytes();W.setAttr(Y);break;case 2:var Y=X.readInt32();W.setActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getAttr_asU8(),q.length>0&&X.writeBytes(1,q),q=W.getActorId(),q!==0&&X.writeInt32(2,q)},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.getAttr=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.getAttr_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.getAttr_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getAttr())},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.setAttr=function(W){return googleProtobuf.Message.setProto3BytesField(this,1,W)},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.getActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,0)},E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.prototype.setActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,2,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.toObject=function(W,X){var q,Y={expectSysAttr:(q=X.getExpectSysAttr())&&E.game_protobuf_messages.proto.messages.RoomSystemProperty.toObject(W,q),sysAttr:(q=X.getSysAttr())&&E.game_protobuf_messages.proto.messages.RoomSystemProperty.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest;return E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomSystemProperty;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomSystemProperty.deserializeBinaryFromReader),W.setExpectSysAttr(Y);break;case 2:var Y=new E.game_protobuf_messages.proto.messages.RoomSystemProperty;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomSystemProperty.deserializeBinaryFromReader),W.setSysAttr(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getExpectSysAttr(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RoomSystemProperty.serializeBinaryToWriter),q=W.getSysAttr(),q!=null&&X.writeMessage(2,q,E.game_protobuf_messages.proto.messages.RoomSystemProperty.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.getExpectSysAttr=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomSystemProperty,1)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.setExpectSysAttr=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.clearExpectSysAttr=function(){return this.setExpectSysAttr(void 0)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.hasExpectSysAttr=function(){return googleProtobuf.Message.getField(this,1)!=null},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.getSysAttr=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomSystemProperty,2)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.setSysAttr=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.clearSysAttr=function(){return this.setSysAttr(void 0)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.prototype.hasSysAttr=function(){return googleProtobuf.Message.getField(this,2)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.toObject=function(W,X){var q,Y={sysAttr:(q=X.getSysAttr())&&E.game_protobuf_messages.proto.messages.RoomSystemProperty.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse;return E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomSystemProperty;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomSystemProperty.deserializeBinaryFromReader),W.setSysAttr(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getSysAttr(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RoomSystemProperty.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.prototype.getSysAttr=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomSystemProperty,1)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.prototype.setSysAttr=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.prototype.clearSysAttr=function(){return this.setSysAttr(void 0)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.prototype.hasSysAttr=function(){return googleProtobuf.Message.getField(this,1)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.toObject=function(W,X){var q,Y={sysAttr:(q=X.getSysAttr())&&E.game_protobuf_messages.proto.messages.RoomSystemProperty.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification;return E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomSystemProperty;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomSystemProperty.deserializeBinaryFromReader),W.setSysAttr(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getSysAttr(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RoomSystemProperty.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.prototype.getSysAttr=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomSystemProperty,1)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.prototype.setSysAttr=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.prototype.clearSysAttr=function(){return this.setSysAttr(void 0)},E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.prototype.hasSysAttr=function(){return googleProtobuf.Message.getField(this,1)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.toObject=function(W,X){var q={masterActorId:googleProtobuf.Message.getFieldWithDefault(X,1,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest;return E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setMasterActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getMasterActorId(),q!==0&&X.writeInt32(1,q)},E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.prototype.getMasterActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.prototype.setMasterActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.toObject=function(W,X){var q={masterActorId:googleProtobuf.Message.getFieldWithDefault(X,1,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse;return E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setMasterActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getMasterActorId(),q!==0&&X.writeInt32(1,q)},E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.prototype.getMasterActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.prototype.setMasterActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.toObject(W,this)},E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.toObject=function(W,X){var q={masterActorId:googleProtobuf.Message.getFieldWithDefault(X,1,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification;return E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setMasterActorId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getMasterActorId(),q!==0&&X.writeInt32(1,q)},E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.prototype.getMasterActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.prototype.setMasterActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_=[[20,21,22,23,24]],E.game_protobuf_messages.proto.messages.RoomNotification.NotificationCase={NOTIFICATION_NOT_SET:0,JOIN_ROOM:20,UPDATE_PROPERTY:21,UPDATE_SYS_PROPERTY:22,UPDATE_MASTER_CLIENT:23,LEFT_ROOM:24},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getNotificationCase=function(){return googleProtobuf.Message.computeOneofCase(this,E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_[0])},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.RoomNotification.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.RoomNotification.toObject(W,this)},E.game_protobuf_messages.proto.messages.RoomNotification.toObject=function(W,X){var q,Y={initByActor:googleProtobuf.Message.getFieldWithDefault(X,1,0),appInfo:(q=X.getAppInfo())&&E.game_protobuf_messages.proto.messages.AppInfo.toObject(W,q),byMaster:googleProtobuf.Message.getBooleanFieldWithDefault(X,4,!1),joinRoom:(q=X.getJoinRoom())&&E.game_protobuf_messages.proto.messages.JoinRoomNotification.toObject(W,q),updateProperty:(q=X.getUpdateProperty())&&E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.toObject(W,q),updateSysProperty:(q=X.getUpdateSysProperty())&&E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.toObject(W,q),updateMasterClient:(q=X.getUpdateMasterClient())&&E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.toObject(W,q),leftRoom:(q=X.getLeftRoom())&&E.game_protobuf_messages.proto.messages.LeftRoomNotification.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.RoomNotification.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.RoomNotification;return E.game_protobuf_messages.proto.messages.RoomNotification.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.RoomNotification.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setInitByActor(Y);break;case 3:var Y=new E.game_protobuf_messages.proto.messages.AppInfo;X.readMessage(Y,E.game_protobuf_messages.proto.messages.AppInfo.deserializeBinaryFromReader),W.setAppInfo(Y);break;case 4:var Y=X.readBool();W.setByMaster(Y);break;case 20:var Y=new E.game_protobuf_messages.proto.messages.JoinRoomNotification;X.readMessage(Y,E.game_protobuf_messages.proto.messages.JoinRoomNotification.deserializeBinaryFromReader),W.setJoinRoom(Y);break;case 21:var Y=new E.game_protobuf_messages.proto.messages.UpdatePropertyNotification;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.deserializeBinaryFromReader),W.setUpdateProperty(Y);break;case 22:var Y=new E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.deserializeBinaryFromReader),W.setUpdateSysProperty(Y);break;case 23:var Y=new E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.deserializeBinaryFromReader),W.setUpdateMasterClient(Y);break;case 24:var Y=new E.game_protobuf_messages.proto.messages.LeftRoomNotification;X.readMessage(Y,E.game_protobuf_messages.proto.messages.LeftRoomNotification.deserializeBinaryFromReader),W.setLeftRoom(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.RoomNotification.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.RoomNotification.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getInitByActor(),q!==0&&X.writeInt32(1,q),q=W.getAppInfo(),q!=null&&X.writeMessage(3,q,E.game_protobuf_messages.proto.messages.AppInfo.serializeBinaryToWriter),q=W.getByMaster(),q&&X.writeBool(4,q),q=W.getJoinRoom(),q!=null&&X.writeMessage(20,q,E.game_protobuf_messages.proto.messages.JoinRoomNotification.serializeBinaryToWriter),q=W.getUpdateProperty(),q!=null&&X.writeMessage(21,q,E.game_protobuf_messages.proto.messages.UpdatePropertyNotification.serializeBinaryToWriter),q=W.getUpdateSysProperty(),q!=null&&X.writeMessage(22,q,E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification.serializeBinaryToWriter),q=W.getUpdateMasterClient(),q!=null&&X.writeMessage(23,q,E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification.serializeBinaryToWriter),q=W.getLeftRoom(),q!=null&&X.writeMessage(24,q,E.game_protobuf_messages.proto.messages.LeftRoomNotification.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getInitByActor=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setInitByActor=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getAppInfo=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.AppInfo,3)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setAppInfo=function(W){return googleProtobuf.Message.setWrapperField(this,3,W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.clearAppInfo=function(){return this.setAppInfo(void 0)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.hasAppInfo=function(){return googleProtobuf.Message.getField(this,3)!=null},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getByMaster=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,4,!1)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setByMaster=function(W){return googleProtobuf.Message.setProto3BooleanField(this,4,W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getJoinRoom=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.JoinRoomNotification,20)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setJoinRoom=function(W){return googleProtobuf.Message.setOneofWrapperField(this,20,E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.clearJoinRoom=function(){return this.setJoinRoom(void 0)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.hasJoinRoom=function(){return googleProtobuf.Message.getField(this,20)!=null},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getUpdateProperty=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdatePropertyNotification,21)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setUpdateProperty=function(W){return googleProtobuf.Message.setOneofWrapperField(this,21,E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.clearUpdateProperty=function(){return this.setUpdateProperty(void 0)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.hasUpdateProperty=function(){return googleProtobuf.Message.getField(this,21)!=null},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getUpdateSysProperty=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdateSysPropertyNotification,22)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setUpdateSysProperty=function(W){return googleProtobuf.Message.setOneofWrapperField(this,22,E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.clearUpdateSysProperty=function(){return this.setUpdateSysProperty(void 0)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.hasUpdateSysProperty=function(){return googleProtobuf.Message.getField(this,22)!=null},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getUpdateMasterClient=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdateMasterClientNotification,23)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setUpdateMasterClient=function(W){return googleProtobuf.Message.setOneofWrapperField(this,23,E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.clearUpdateMasterClient=function(){return this.setUpdateMasterClient(void 0)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.hasUpdateMasterClient=function(){return googleProtobuf.Message.getField(this,23)!=null},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.getLeftRoom=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.LeftRoomNotification,24)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.setLeftRoom=function(W){return googleProtobuf.Message.setOneofWrapperField(this,24,E.game_protobuf_messages.proto.messages.RoomNotification.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.clearLeftRoom=function(){return this.setLeftRoom(void 0)},E.game_protobuf_messages.proto.messages.RoomNotification.prototype.hasLeftRoom=function(){return googleProtobuf.Message.getField(this,24)!=null},E.game_protobuf_messages.proto.messages.DirectCommand.repeatedFields_=[6],googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.DirectCommand.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.DirectCommand.toObject(W,this)},E.game_protobuf_messages.proto.messages.DirectCommand.toObject=function(W,X){var q,Y={cached:googleProtobuf.Message.getBooleanFieldWithDefault(X,1,!1),eventId:googleProtobuf.Message.getFieldWithDefault(X,2,0),receiverGroup:googleProtobuf.Message.getFieldWithDefault(X,3,0),cachingOption:googleProtobuf.Message.getFieldWithDefault(X,4,0),eventOptions:googleProtobuf.Message.getFieldWithDefault(X,5,0),toActorIdsList:(q=googleProtobuf.Message.getRepeatedField(X,6))==null?void 0:q,msg:X.getMsg_asB64(),timestamp:googleProtobuf.Message.getFieldWithDefault(X,8,0),fromActorId:googleProtobuf.Message.getFieldWithDefault(X,9,0),i:googleProtobuf.Message.getFieldWithDefault(X,10,0),interestGroup:googleProtobuf.Message.getFieldWithDefault(X,11,0)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.DirectCommand.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.DirectCommand;return E.game_protobuf_messages.proto.messages.DirectCommand.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.DirectCommand.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readBool();W.setCached(Y);break;case 2:var Y=X.readInt32();W.setEventId(Y);break;case 3:var Y=X.readInt32();W.setReceiverGroup(Y);break;case 4:var Y=X.readInt32();W.setCachingOption(Y);break;case 5:var Y=X.readInt32();W.setEventOptions(Y);break;case 6:var Y=X.readPackedInt32();W.setToActorIdsList(Y);break;case 7:var Y=X.readBytes();W.setMsg(Y);break;case 8:var Y=X.readInt64();W.setTimestamp(Y);break;case 9:var Y=X.readInt32();W.setFromActorId(Y);break;case 10:var Y=X.readInt32();W.setI(Y);break;case 11:var Y=X.readInt32();W.setInterestGroup(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.DirectCommand.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.DirectCommand.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getCached(),q&&X.writeBool(1,q),q=W.getEventId(),q!==0&&X.writeInt32(2,q),q=W.getReceiverGroup(),q!==0&&X.writeInt32(3,q),q=W.getCachingOption(),q!==0&&X.writeInt32(4,q),q=W.getEventOptions(),q!==0&&X.writeInt32(5,q),q=W.getToActorIdsList(),q.length>0&&X.writePackedInt32(6,q),q=W.getMsg_asU8(),q.length>0&&X.writeBytes(7,q),q=W.getTimestamp(),q!==0&&X.writeInt64(8,q),q=W.getFromActorId(),q!==0&&X.writeInt32(9,q),q=W.getI(),q!==0&&X.writeInt32(10,q),q=W.getInterestGroup(),q!==0&&X.writeInt32(11,q)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getCached=function(){return googleProtobuf.Message.getBooleanFieldWithDefault(this,1,!1)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setCached=function(W){return googleProtobuf.Message.setProto3BooleanField(this,1,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getEventId=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setEventId=function(W){return googleProtobuf.Message.setProto3IntField(this,2,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getReceiverGroup=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setReceiverGroup=function(W){return googleProtobuf.Message.setProto3IntField(this,3,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getCachingOption=function(){return googleProtobuf.Message.getFieldWithDefault(this,4,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setCachingOption=function(W){return googleProtobuf.Message.setProto3IntField(this,4,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getEventOptions=function(){return googleProtobuf.Message.getFieldWithDefault(this,5,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setEventOptions=function(W){return googleProtobuf.Message.setProto3IntField(this,5,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getToActorIdsList=function(){return googleProtobuf.Message.getRepeatedField(this,6)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setToActorIdsList=function(W){return googleProtobuf.Message.setField(this,6,W||[])},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.addToActorIds=function(W,X){return googleProtobuf.Message.addToRepeatedField(this,6,W,X)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.clearToActorIdsList=function(){return this.setToActorIdsList([])},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getMsg=function(){return googleProtobuf.Message.getFieldWithDefault(this,7,"")},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getMsg_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getMsg())},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getMsg_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getMsg())},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setMsg=function(W){return googleProtobuf.Message.setProto3BytesField(this,7,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getTimestamp=function(){return googleProtobuf.Message.getFieldWithDefault(this,8,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setTimestamp=function(W){return googleProtobuf.Message.setProto3IntField(this,8,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getFromActorId=function(){return googleProtobuf.Message.getFieldWithDefault(this,9,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setFromActorId=function(W){return googleProtobuf.Message.setProto3IntField(this,9,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getI=function(){return googleProtobuf.Message.getFieldWithDefault(this,10,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setI=function(W){return googleProtobuf.Message.setProto3IntField(this,10,W)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.getInterestGroup=function(){return googleProtobuf.Message.getFieldWithDefault(this,11,0)},E.game_protobuf_messages.proto.messages.DirectCommand.prototype.setInterestGroup=function(W){return googleProtobuf.Message.setProto3IntField(this,11,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.AckCommand.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.AckCommand.toObject(W,this)},E.game_protobuf_messages.proto.messages.AckCommand.toObject=function(W,X){var q={timestamp:googleProtobuf.Message.getFieldWithDefault(X,1,0),i:googleProtobuf.Message.getFieldWithDefault(X,11,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.AckCommand.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.AckCommand;return E.game_protobuf_messages.proto.messages.AckCommand.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.AckCommand.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt64();W.setTimestamp(Y);break;case 11:var Y=X.readInt32();W.setI(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.AckCommand.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.AckCommand.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.AckCommand.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getTimestamp(),q!==0&&X.writeInt64(1,q),q=W.getI(),q!==0&&X.writeInt32(11,q)},E.game_protobuf_messages.proto.messages.AckCommand.prototype.getTimestamp=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.AckCommand.prototype.setTimestamp=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.AckCommand.prototype.getI=function(){return googleProtobuf.Message.getFieldWithDefault(this,11,0)},E.game_protobuf_messages.proto.messages.AckCommand.prototype.setI=function(W){return googleProtobuf.Message.setProto3IntField(this,11,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.EventsRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.EventsRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.EventsRequest.toObject=function(W,X){var q,Y={msg:X.getMsg_asB64(),actorId:(q=X.getActorId())&&wrappers_pb.Int32Value.toObject(W,q),eventId:(q=X.getEventId())&&wrappers_pb.Int32Value.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.EventsRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.EventsRequest;return E.game_protobuf_messages.proto.messages.EventsRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.EventsRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readBytes();W.setMsg(Y);break;case 2:var Y=new wrappers_pb.Int32Value;X.readMessage(Y,wrappers_pb.Int32Value.deserializeBinaryFromReader),W.setActorId(Y);break;case 3:var Y=new wrappers_pb.Int32Value;X.readMessage(Y,wrappers_pb.Int32Value.deserializeBinaryFromReader),W.setEventId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.EventsRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.EventsRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getMsg_asU8(),q.length>0&&X.writeBytes(1,q),q=W.getActorId(),q!=null&&X.writeMessage(2,q,wrappers_pb.Int32Value.serializeBinaryToWriter),q=W.getEventId(),q!=null&&X.writeMessage(3,q,wrappers_pb.Int32Value.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.getMsg=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.getMsg_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getMsg())},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.getMsg_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getMsg())},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.setMsg=function(W){return googleProtobuf.Message.setProto3BytesField(this,1,W)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.getActorId=function(){return googleProtobuf.Message.getWrapperField(this,wrappers_pb.Int32Value,2)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.setActorId=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.clearActorId=function(){return this.setActorId(void 0)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.hasActorId=function(){return googleProtobuf.Message.getField(this,2)!=null},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.getEventId=function(){return googleProtobuf.Message.getWrapperField(this,wrappers_pb.Int32Value,3)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.setEventId=function(W){return googleProtobuf.Message.setWrapperField(this,3,W)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.clearEventId=function(){return this.setEventId(void 0)},E.game_protobuf_messages.proto.messages.EventsRequest.prototype.hasEventId=function(){return googleProtobuf.Message.getField(this,3)!=null},E.game_protobuf_messages.proto.messages.EventsCommand.repeatedFields_=[1],googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.EventsCommand.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.EventsCommand.toObject(W,this)},E.game_protobuf_messages.proto.messages.EventsCommand.toObject=function(W,X){var q={eventsList:googleProtobuf.Message.toObjectList(X.getEventsList(),E.game_protobuf_messages.proto.messages.DirectCommand.toObject,W)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.EventsCommand.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.EventsCommand;return E.game_protobuf_messages.proto.messages.EventsCommand.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.EventsCommand.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.DirectCommand;X.readMessage(Y,E.game_protobuf_messages.proto.messages.DirectCommand.deserializeBinaryFromReader),W.addEvents(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.EventsCommand.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.EventsCommand.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.EventsCommand.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getEventsList(),q.length>0&&X.writeRepeatedMessage(1,q,E.game_protobuf_messages.proto.messages.DirectCommand.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.EventsCommand.prototype.getEventsList=function(){return googleProtobuf.Message.getRepeatedWrapperField(this,E.game_protobuf_messages.proto.messages.DirectCommand,1)},E.game_protobuf_messages.proto.messages.EventsCommand.prototype.setEventsList=function(W){return googleProtobuf.Message.setRepeatedWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.EventsCommand.prototype.addEvents=function(W,X){return googleProtobuf.Message.addToRepeatedWrapperField(this,1,W,E.game_protobuf_messages.proto.messages.DirectCommand,X)},E.game_protobuf_messages.proto.messages.EventsCommand.prototype.clearEventsList=function(){return this.setEventsList([])},E.game_protobuf_messages.proto.messages.InterestGroups.repeatedFields_=[1,2],googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.InterestGroups.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.InterestGroups.toObject(W,this)},E.game_protobuf_messages.proto.messages.InterestGroups.toObject=function(W,X){var q,Y={disabledGroupsList:(q=googleProtobuf.Message.getRepeatedField(X,1))==null?void 0:q,enabledGroupsList:(q=googleProtobuf.Message.getRepeatedField(X,2))==null?void 0:q};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.InterestGroups.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.InterestGroups;return E.game_protobuf_messages.proto.messages.InterestGroups.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.InterestGroups.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readPackedInt32();W.setDisabledGroupsList(Y);break;case 2:var Y=X.readPackedInt32();W.setEnabledGroupsList(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.InterestGroups.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.InterestGroups.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getDisabledGroupsList(),q.length>0&&X.writePackedInt32(1,q),q=W.getEnabledGroupsList(),q.length>0&&X.writePackedInt32(2,q)},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.getDisabledGroupsList=function(){return googleProtobuf.Message.getRepeatedField(this,1)},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.setDisabledGroupsList=function(W){return googleProtobuf.Message.setField(this,1,W||[])},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.addDisabledGroups=function(W,X){return googleProtobuf.Message.addToRepeatedField(this,1,W,X)},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.clearDisabledGroupsList=function(){return this.setDisabledGroupsList([])},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.getEnabledGroupsList=function(){return googleProtobuf.Message.getRepeatedField(this,2)},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.setEnabledGroupsList=function(W){return googleProtobuf.Message.setField(this,2,W||[])},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.addEnabledGroups=function(W,X){return googleProtobuf.Message.addToRepeatedField(this,2,W,X)},E.game_protobuf_messages.proto.messages.InterestGroups.prototype.clearEnabledGroupsList=function(){return this.setEnabledGroupsList([])},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.JoinLobbyRequest.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.JoinLobbyRequest.toObject(W,this)},E.game_protobuf_messages.proto.messages.JoinLobbyRequest.toObject=function(W,X){var q={lobbyId:googleProtobuf.Message.getFieldWithDefault(X,1,"")};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.JoinLobbyRequest.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.JoinLobbyRequest;return E.game_protobuf_messages.proto.messages.JoinLobbyRequest.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.JoinLobbyRequest.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readString();W.setLobbyId(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.JoinLobbyRequest.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.JoinLobbyRequest.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.JoinLobbyRequest.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getLobbyId(),q.length>0&&X.writeString(1,q)},E.game_protobuf_messages.proto.messages.JoinLobbyRequest.prototype.getLobbyId=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,"")},E.game_protobuf_messages.proto.messages.JoinLobbyRequest.prototype.setLobbyId=function(W){return googleProtobuf.Message.setProto3StringField(this,1,W)},E.game_protobuf_messages.proto.messages.RoomListCommand.repeatedFields_=[1],googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.RoomListCommand.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.RoomListCommand.toObject(W,this)},E.game_protobuf_messages.proto.messages.RoomListCommand.toObject=function(W,X){var q={listList:googleProtobuf.Message.toObjectList(X.getListList(),E.game_protobuf_messages.proto.messages.RoomOptions.toObject,W)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.RoomListCommand.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.RoomListCommand;return E.game_protobuf_messages.proto.messages.RoomListCommand.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.RoomListCommand.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RoomOptions;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomOptions.deserializeBinaryFromReader),W.addList(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.RoomListCommand.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.RoomListCommand.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.RoomListCommand.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getListList(),q.length>0&&X.writeRepeatedMessage(1,q,E.game_protobuf_messages.proto.messages.RoomOptions.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.RoomListCommand.prototype.getListList=function(){return googleProtobuf.Message.getRepeatedWrapperField(this,E.game_protobuf_messages.proto.messages.RoomOptions,1)},E.game_protobuf_messages.proto.messages.RoomListCommand.prototype.setListList=function(W){return googleProtobuf.Message.setRepeatedWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.RoomListCommand.prototype.addList=function(W,X){return googleProtobuf.Message.addToRepeatedWrapperField(this,1,W,E.game_protobuf_messages.proto.messages.RoomOptions,X)},E.game_protobuf_messages.proto.messages.RoomListCommand.prototype.clearListList=function(){return this.setListList([])},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.AppStatistic.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.AppStatistic.toObject(W,this)},E.game_protobuf_messages.proto.messages.AppStatistic.toObject=function(W,X){var q={countOfRooms:googleProtobuf.Message.getFieldWithDefault(X,1,0),countOfPlayersOnRouter:googleProtobuf.Message.getFieldWithDefault(X,2,0),countOfPlayersInRooms:googleProtobuf.Message.getFieldWithDefault(X,3,0),countOfPlayers:googleProtobuf.Message.getFieldWithDefault(X,4,0)};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.AppStatistic.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.AppStatistic;return E.game_protobuf_messages.proto.messages.AppStatistic.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.AppStatistic.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setCountOfRooms(Y);break;case 2:var Y=X.readInt32();W.setCountOfPlayersOnRouter(Y);break;case 3:var Y=X.readInt32();W.setCountOfPlayersInRooms(Y);break;case 4:var Y=X.readInt32();W.setCountOfPlayers(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.AppStatistic.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.AppStatistic.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getCountOfRooms(),q!==0&&X.writeInt32(1,q),q=W.getCountOfPlayersOnRouter(),q!==0&&X.writeInt32(2,q),q=W.getCountOfPlayersInRooms(),q!==0&&X.writeInt32(3,q),q=W.getCountOfPlayers(),q!==0&&X.writeInt32(4,q)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.getCountOfRooms=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.setCountOfRooms=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.getCountOfPlayersOnRouter=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,0)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.setCountOfPlayersOnRouter=function(W){return googleProtobuf.Message.setProto3IntField(this,2,W)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.getCountOfPlayersInRooms=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,0)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.setCountOfPlayersInRooms=function(W){return googleProtobuf.Message.setProto3IntField(this,3,W)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.getCountOfPlayers=function(){return googleProtobuf.Message.getFieldWithDefault(this,4,0)},E.game_protobuf_messages.proto.messages.AppStatistic.prototype.setCountOfPlayers=function(W){return googleProtobuf.Message.setProto3IntField(this,4,W)},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.StatisticCommand.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.StatisticCommand.toObject(W,this)},E.game_protobuf_messages.proto.messages.StatisticCommand.toObject=function(W,X){var q,Y={appStats:(q=X.getAppStats())&&E.game_protobuf_messages.proto.messages.AppStatistic.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.StatisticCommand.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.StatisticCommand;return E.game_protobuf_messages.proto.messages.StatisticCommand.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.StatisticCommand.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.AppStatistic;X.readMessage(Y,E.game_protobuf_messages.proto.messages.AppStatistic.deserializeBinaryFromReader),W.setAppStats(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.StatisticCommand.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.StatisticCommand.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.StatisticCommand.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getAppStats(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.AppStatistic.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.StatisticCommand.prototype.getAppStats=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.AppStatistic,1)},E.game_protobuf_messages.proto.messages.StatisticCommand.prototype.setAppStats=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.StatisticCommand.prototype.clearAppStats=function(){return this.setAppStats(void 0)},E.game_protobuf_messages.proto.messages.StatisticCommand.prototype.hasAppStats=function(){return googleProtobuf.Message.getField(this,1)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.ErrorCommand.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.ErrorCommand.toObject(W,this)},E.game_protobuf_messages.proto.messages.ErrorCommand.toObject=function(W,X){var q,Y={errorInfo:(q=X.getErrorInfo())&&E.game_protobuf_messages.proto.messages.ErrorInfo.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.ErrorCommand.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.ErrorCommand;return E.game_protobuf_messages.proto.messages.ErrorCommand.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.ErrorCommand.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.ErrorInfo;X.readMessage(Y,E.game_protobuf_messages.proto.messages.ErrorInfo.deserializeBinaryFromReader),W.setErrorInfo(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.ErrorCommand.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.ErrorCommand.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.ErrorCommand.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getErrorInfo(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.ErrorInfo.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.ErrorCommand.prototype.getErrorInfo=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.ErrorInfo,1)},E.game_protobuf_messages.proto.messages.ErrorCommand.prototype.setErrorInfo=function(W){return googleProtobuf.Message.setWrapperField(this,1,W)},E.game_protobuf_messages.proto.messages.ErrorCommand.prototype.clearErrorInfo=function(){return this.setErrorInfo(void 0)},E.game_protobuf_messages.proto.messages.ErrorCommand.prototype.hasErrorInfo=function(){return googleProtobuf.Message.getField(this,1)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_=[[20,21,22,23,24,25,26,27,28,54]],E.game_protobuf_messages.proto.messages.RequestMessage.RequestCase={REQUEST_NOT_SET:0,SESSION_OPEN:20,CREATE_ROOM:21,JOIN_ROOM:22,UPDATE_PROPERTY:23,UPDATE_SYS_PROPERTY:24,UPDATE_MASTER_CLIENT:25,KICK_MEMBER:26,EVENTS:27,INTEREST_GROUPS:28,JOIN_LOBBY:54},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getRequestCase=function(){return googleProtobuf.Message.computeOneofCase(this,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0])},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.RequestMessage.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.RequestMessage.toObject(W,this)},E.game_protobuf_messages.proto.messages.RequestMessage.toObject=function(W,X){var q,Y={i:googleProtobuf.Message.getFieldWithDefault(X,1,0),sessionOpen:(q=X.getSessionOpen())&&E.game_protobuf_messages.proto.messages.SessionOpenRequest.toObject(W,q),createRoom:(q=X.getCreateRoom())&&E.game_protobuf_messages.proto.messages.CreateRoomRequest.toObject(W,q),joinRoom:(q=X.getJoinRoom())&&E.game_protobuf_messages.proto.messages.JoinRoomRequest.toObject(W,q),updateProperty:(q=X.getUpdateProperty())&&E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.toObject(W,q),updateSysProperty:(q=X.getUpdateSysProperty())&&E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.toObject(W,q),updateMasterClient:(q=X.getUpdateMasterClient())&&E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.toObject(W,q),kickMember:(q=X.getKickMember())&&E.game_protobuf_messages.proto.messages.KickMemberRequest.toObject(W,q),events:(q=X.getEvents())&&E.game_protobuf_messages.proto.messages.EventsRequest.toObject(W,q),interestGroups:(q=X.getInterestGroups())&&E.game_protobuf_messages.proto.messages.InterestGroups.toObject(W,q),joinLobby:(q=X.getJoinLobby())&&E.game_protobuf_messages.proto.messages.JoinLobbyRequest.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.RequestMessage.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.RequestMessage;return E.game_protobuf_messages.proto.messages.RequestMessage.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.RequestMessage.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setI(Y);break;case 20:var Y=new E.game_protobuf_messages.proto.messages.SessionOpenRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.SessionOpenRequest.deserializeBinaryFromReader),W.setSessionOpen(Y);break;case 21:var Y=new E.game_protobuf_messages.proto.messages.CreateRoomRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.CreateRoomRequest.deserializeBinaryFromReader),W.setCreateRoom(Y);break;case 22:var Y=new E.game_protobuf_messages.proto.messages.JoinRoomRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.JoinRoomRequest.deserializeBinaryFromReader),W.setJoinRoom(Y);break;case 23:var Y=new E.game_protobuf_messages.proto.messages.UpdatePropertyRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.deserializeBinaryFromReader),W.setUpdateProperty(Y);break;case 24:var Y=new E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.deserializeBinaryFromReader),W.setUpdateSysProperty(Y);break;case 25:var Y=new E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.deserializeBinaryFromReader),W.setUpdateMasterClient(Y);break;case 26:var Y=new E.game_protobuf_messages.proto.messages.KickMemberRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.KickMemberRequest.deserializeBinaryFromReader),W.setKickMember(Y);break;case 27:var Y=new E.game_protobuf_messages.proto.messages.EventsRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.EventsRequest.deserializeBinaryFromReader),W.setEvents(Y);break;case 28:var Y=new E.game_protobuf_messages.proto.messages.InterestGroups;X.readMessage(Y,E.game_protobuf_messages.proto.messages.InterestGroups.deserializeBinaryFromReader),W.setInterestGroups(Y);break;case 54:var Y=new E.game_protobuf_messages.proto.messages.JoinLobbyRequest;X.readMessage(Y,E.game_protobuf_messages.proto.messages.JoinLobbyRequest.deserializeBinaryFromReader),W.setJoinLobby(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.RequestMessage.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.RequestMessage.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getI(),q!==0&&X.writeInt32(1,q),q=W.getSessionOpen(),q!=null&&X.writeMessage(20,q,E.game_protobuf_messages.proto.messages.SessionOpenRequest.serializeBinaryToWriter),q=W.getCreateRoom(),q!=null&&X.writeMessage(21,q,E.game_protobuf_messages.proto.messages.CreateRoomRequest.serializeBinaryToWriter),q=W.getJoinRoom(),q!=null&&X.writeMessage(22,q,E.game_protobuf_messages.proto.messages.JoinRoomRequest.serializeBinaryToWriter),q=W.getUpdateProperty(),q!=null&&X.writeMessage(23,q,E.game_protobuf_messages.proto.messages.UpdatePropertyRequest.serializeBinaryToWriter),q=W.getUpdateSysProperty(),q!=null&&X.writeMessage(24,q,E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest.serializeBinaryToWriter),q=W.getUpdateMasterClient(),q!=null&&X.writeMessage(25,q,E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest.serializeBinaryToWriter),q=W.getKickMember(),q!=null&&X.writeMessage(26,q,E.game_protobuf_messages.proto.messages.KickMemberRequest.serializeBinaryToWriter),q=W.getEvents(),q!=null&&X.writeMessage(27,q,E.game_protobuf_messages.proto.messages.EventsRequest.serializeBinaryToWriter),q=W.getInterestGroups(),q!=null&&X.writeMessage(28,q,E.game_protobuf_messages.proto.messages.InterestGroups.serializeBinaryToWriter),q=W.getJoinLobby(),q!=null&&X.writeMessage(54,q,E.game_protobuf_messages.proto.messages.JoinLobbyRequest.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getI=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setI=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getSessionOpen=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.SessionOpenRequest,20)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setSessionOpen=function(W){return googleProtobuf.Message.setOneofWrapperField(this,20,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearSessionOpen=function(){return this.setSessionOpen(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasSessionOpen=function(){return googleProtobuf.Message.getField(this,20)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getCreateRoom=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.CreateRoomRequest,21)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setCreateRoom=function(W){return googleProtobuf.Message.setOneofWrapperField(this,21,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearCreateRoom=function(){return this.setCreateRoom(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasCreateRoom=function(){return googleProtobuf.Message.getField(this,21)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getJoinRoom=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.JoinRoomRequest,22)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setJoinRoom=function(W){return googleProtobuf.Message.setOneofWrapperField(this,22,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearJoinRoom=function(){return this.setJoinRoom(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasJoinRoom=function(){return googleProtobuf.Message.getField(this,22)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getUpdateProperty=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdatePropertyRequest,23)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setUpdateProperty=function(W){return googleProtobuf.Message.setOneofWrapperField(this,23,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearUpdateProperty=function(){return this.setUpdateProperty(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasUpdateProperty=function(){return googleProtobuf.Message.getField(this,23)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getUpdateSysProperty=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdateSysPropertyRequest,24)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setUpdateSysProperty=function(W){return googleProtobuf.Message.setOneofWrapperField(this,24,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearUpdateSysProperty=function(){return this.setUpdateSysProperty(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasUpdateSysProperty=function(){return googleProtobuf.Message.getField(this,24)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getUpdateMasterClient=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdateMasterClientRequest,25)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setUpdateMasterClient=function(W){return googleProtobuf.Message.setOneofWrapperField(this,25,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearUpdateMasterClient=function(){return this.setUpdateMasterClient(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasUpdateMasterClient=function(){return googleProtobuf.Message.getField(this,25)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getKickMember=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.KickMemberRequest,26)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setKickMember=function(W){return googleProtobuf.Message.setOneofWrapperField(this,26,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearKickMember=function(){return this.setKickMember(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasKickMember=function(){return googleProtobuf.Message.getField(this,26)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getEvents=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.EventsRequest,27)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setEvents=function(W){return googleProtobuf.Message.setOneofWrapperField(this,27,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearEvents=function(){return this.setEvents(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasEvents=function(){return googleProtobuf.Message.getField(this,27)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getInterestGroups=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.InterestGroups,28)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setInterestGroups=function(W){return googleProtobuf.Message.setOneofWrapperField(this,28,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearInterestGroups=function(){return this.setInterestGroups(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasInterestGroups=function(){return googleProtobuf.Message.getField(this,28)!=null},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.getJoinLobby=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.JoinLobbyRequest,54)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.setJoinLobby=function(W){return googleProtobuf.Message.setOneofWrapperField(this,54,E.game_protobuf_messages.proto.messages.RequestMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.clearJoinLobby=function(){return this.setJoinLobby(void 0)},E.game_protobuf_messages.proto.messages.RequestMessage.prototype.hasJoinLobby=function(){return googleProtobuf.Message.getField(this,54)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_=[[20,21,22,23,24,25,26,28]],E.game_protobuf_messages.proto.messages.ResponseMessage.ResponseCase={RESPONSE_NOT_SET:0,CREATE_ROOM:20,JOIN_ROOM:21,UPDATE_PROPERTY:22,UPDATE_SYS_PROPERTY:23,UPDATE_MASTER_CLIENT:24,KICK_MEMBER:25,ACK:26,INTEREST_GROUPS:28},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getResponseCase=function(){return googleProtobuf.Message.computeOneofCase(this,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0])},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.ResponseMessage.toObject(W,this)},E.game_protobuf_messages.proto.messages.ResponseMessage.toObject=function(W,X){var q,Y={i:googleProtobuf.Message.getFieldWithDefault(X,1,0),errorInfo:(q=X.getErrorInfo())&&E.game_protobuf_messages.proto.messages.ErrorInfo.toObject(W,q),createRoom:(q=X.getCreateRoom())&&E.game_protobuf_messages.proto.messages.CreateRoomResponse.toObject(W,q),joinRoom:(q=X.getJoinRoom())&&E.game_protobuf_messages.proto.messages.JoinRoomResponse.toObject(W,q),updateProperty:(q=X.getUpdateProperty())&&E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.toObject(W,q),updateSysProperty:(q=X.getUpdateSysProperty())&&E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.toObject(W,q),updateMasterClient:(q=X.getUpdateMasterClient())&&E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.toObject(W,q),kickMember:(q=X.getKickMember())&&E.game_protobuf_messages.proto.messages.KickMemberResponse.toObject(W,q),ack:(q=X.getAck())&&E.game_protobuf_messages.proto.messages.AckCommand.toObject(W,q),interestGroups:(q=X.getInterestGroups())&&E.game_protobuf_messages.proto.messages.InterestGroups.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.ResponseMessage.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.ResponseMessage;return E.game_protobuf_messages.proto.messages.ResponseMessage.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.ResponseMessage.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readInt32();W.setI(Y);break;case 2:var Y=new E.game_protobuf_messages.proto.messages.ErrorInfo;X.readMessage(Y,E.game_protobuf_messages.proto.messages.ErrorInfo.deserializeBinaryFromReader),W.setErrorInfo(Y);break;case 20:var Y=new E.game_protobuf_messages.proto.messages.CreateRoomResponse;X.readMessage(Y,E.game_protobuf_messages.proto.messages.CreateRoomResponse.deserializeBinaryFromReader),W.setCreateRoom(Y);break;case 21:var Y=new E.game_protobuf_messages.proto.messages.JoinRoomResponse;X.readMessage(Y,E.game_protobuf_messages.proto.messages.JoinRoomResponse.deserializeBinaryFromReader),W.setJoinRoom(Y);break;case 22:var Y=new E.game_protobuf_messages.proto.messages.UpdatePropertyResponse;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.deserializeBinaryFromReader),W.setUpdateProperty(Y);break;case 23:var Y=new E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.deserializeBinaryFromReader),W.setUpdateSysProperty(Y);break;case 24:var Y=new E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse;X.readMessage(Y,E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.deserializeBinaryFromReader),W.setUpdateMasterClient(Y);break;case 25:var Y=new E.game_protobuf_messages.proto.messages.KickMemberResponse;X.readMessage(Y,E.game_protobuf_messages.proto.messages.KickMemberResponse.deserializeBinaryFromReader),W.setKickMember(Y);break;case 26:var Y=new E.game_protobuf_messages.proto.messages.AckCommand;X.readMessage(Y,E.game_protobuf_messages.proto.messages.AckCommand.deserializeBinaryFromReader),W.setAck(Y);break;case 28:var Y=new E.game_protobuf_messages.proto.messages.InterestGroups;X.readMessage(Y,E.game_protobuf_messages.proto.messages.InterestGroups.deserializeBinaryFromReader),W.setInterestGroups(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.ResponseMessage.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.ResponseMessage.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getI(),q!==0&&X.writeInt32(1,q),q=W.getErrorInfo(),q!=null&&X.writeMessage(2,q,E.game_protobuf_messages.proto.messages.ErrorInfo.serializeBinaryToWriter),q=W.getCreateRoom(),q!=null&&X.writeMessage(20,q,E.game_protobuf_messages.proto.messages.CreateRoomResponse.serializeBinaryToWriter),q=W.getJoinRoom(),q!=null&&X.writeMessage(21,q,E.game_protobuf_messages.proto.messages.JoinRoomResponse.serializeBinaryToWriter),q=W.getUpdateProperty(),q!=null&&X.writeMessage(22,q,E.game_protobuf_messages.proto.messages.UpdatePropertyResponse.serializeBinaryToWriter),q=W.getUpdateSysProperty(),q!=null&&X.writeMessage(23,q,E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse.serializeBinaryToWriter),q=W.getUpdateMasterClient(),q!=null&&X.writeMessage(24,q,E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse.serializeBinaryToWriter),q=W.getKickMember(),q!=null&&X.writeMessage(25,q,E.game_protobuf_messages.proto.messages.KickMemberResponse.serializeBinaryToWriter),q=W.getAck(),q!=null&&X.writeMessage(26,q,E.game_protobuf_messages.proto.messages.AckCommand.serializeBinaryToWriter),q=W.getInterestGroups(),q!=null&&X.writeMessage(28,q,E.game_protobuf_messages.proto.messages.InterestGroups.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getI=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setI=function(W){return googleProtobuf.Message.setProto3IntField(this,1,W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getErrorInfo=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.ErrorInfo,2)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setErrorInfo=function(W){return googleProtobuf.Message.setWrapperField(this,2,W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearErrorInfo=function(){return this.setErrorInfo(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasErrorInfo=function(){return googleProtobuf.Message.getField(this,2)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getCreateRoom=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.CreateRoomResponse,20)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setCreateRoom=function(W){return googleProtobuf.Message.setOneofWrapperField(this,20,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearCreateRoom=function(){return this.setCreateRoom(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasCreateRoom=function(){return googleProtobuf.Message.getField(this,20)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getJoinRoom=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.JoinRoomResponse,21)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setJoinRoom=function(W){return googleProtobuf.Message.setOneofWrapperField(this,21,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearJoinRoom=function(){return this.setJoinRoom(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasJoinRoom=function(){return googleProtobuf.Message.getField(this,21)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getUpdateProperty=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdatePropertyResponse,22)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setUpdateProperty=function(W){return googleProtobuf.Message.setOneofWrapperField(this,22,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearUpdateProperty=function(){return this.setUpdateProperty(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasUpdateProperty=function(){return googleProtobuf.Message.getField(this,22)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getUpdateSysProperty=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdateSysPropertyResponse,23)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setUpdateSysProperty=function(W){return googleProtobuf.Message.setOneofWrapperField(this,23,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearUpdateSysProperty=function(){return this.setUpdateSysProperty(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasUpdateSysProperty=function(){return googleProtobuf.Message.getField(this,23)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getUpdateMasterClient=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.UpdateMasterClientResponse,24)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setUpdateMasterClient=function(W){return googleProtobuf.Message.setOneofWrapperField(this,24,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearUpdateMasterClient=function(){return this.setUpdateMasterClient(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasUpdateMasterClient=function(){return googleProtobuf.Message.getField(this,24)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getKickMember=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.KickMemberResponse,25)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setKickMember=function(W){return googleProtobuf.Message.setOneofWrapperField(this,25,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearKickMember=function(){return this.setKickMember(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasKickMember=function(){return googleProtobuf.Message.getField(this,25)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getAck=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.AckCommand,26)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setAck=function(W){return googleProtobuf.Message.setOneofWrapperField(this,26,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearAck=function(){return this.setAck(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasAck=function(){return googleProtobuf.Message.getField(this,26)!=null},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.getInterestGroups=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.InterestGroups,28)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.setInterestGroups=function(W){return googleProtobuf.Message.setOneofWrapperField(this,28,E.game_protobuf_messages.proto.messages.ResponseMessage.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.clearInterestGroups=function(){return this.setInterestGroups(void 0)},E.game_protobuf_messages.proto.messages.ResponseMessage.prototype.hasInterestGroups=function(){return googleProtobuf.Message.getField(this,28)!=null},E.game_protobuf_messages.proto.messages.Body.oneofGroups_=[[1,2,3,4,5,50,51,127]],E.game_protobuf_messages.proto.messages.Body.BodyCase={BODY_NOT_SET:0,REQUEST:1,RESPONSE:2,DIRECT:3,ROOM_NOTIFICATION:4,EVENTS:5,STATISTIC:50,ROOM_LIST:51,ERROR:127},E.game_protobuf_messages.proto.messages.Body.prototype.getBodyCase=function(){return googleProtobuf.Message.computeOneofCase(this,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0])},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.Body.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.Body.toObject(W,this)},E.game_protobuf_messages.proto.messages.Body.toObject=function(W,X){var q,Y={request:(q=X.getRequest())&&E.game_protobuf_messages.proto.messages.RequestMessage.toObject(W,q),response:(q=X.getResponse())&&E.game_protobuf_messages.proto.messages.ResponseMessage.toObject(W,q),direct:(q=X.getDirect())&&E.game_protobuf_messages.proto.messages.DirectCommand.toObject(W,q),roomNotification:(q=X.getRoomNotification())&&E.game_protobuf_messages.proto.messages.RoomNotification.toObject(W,q),events:(q=X.getEvents())&&E.game_protobuf_messages.proto.messages.EventsCommand.toObject(W,q),statistic:(q=X.getStatistic())&&E.game_protobuf_messages.proto.messages.StatisticCommand.toObject(W,q),roomList:(q=X.getRoomList())&&E.game_protobuf_messages.proto.messages.RoomListCommand.toObject(W,q),error:(q=X.getError())&&E.game_protobuf_messages.proto.messages.ErrorCommand.toObject(W,q)};return W&&(Y.$jspbMessageInstance=X),Y}),E.game_protobuf_messages.proto.messages.Body.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.Body;return E.game_protobuf_messages.proto.messages.Body.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.Body.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=new E.game_protobuf_messages.proto.messages.RequestMessage;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RequestMessage.deserializeBinaryFromReader),W.setRequest(Y);break;case 2:var Y=new E.game_protobuf_messages.proto.messages.ResponseMessage;X.readMessage(Y,E.game_protobuf_messages.proto.messages.ResponseMessage.deserializeBinaryFromReader),W.setResponse(Y);break;case 3:var Y=new E.game_protobuf_messages.proto.messages.DirectCommand;X.readMessage(Y,E.game_protobuf_messages.proto.messages.DirectCommand.deserializeBinaryFromReader),W.setDirect(Y);break;case 4:var Y=new E.game_protobuf_messages.proto.messages.RoomNotification;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomNotification.deserializeBinaryFromReader),W.setRoomNotification(Y);break;case 5:var Y=new E.game_protobuf_messages.proto.messages.EventsCommand;X.readMessage(Y,E.game_protobuf_messages.proto.messages.EventsCommand.deserializeBinaryFromReader),W.setEvents(Y);break;case 50:var Y=new E.game_protobuf_messages.proto.messages.StatisticCommand;X.readMessage(Y,E.game_protobuf_messages.proto.messages.StatisticCommand.deserializeBinaryFromReader),W.setStatistic(Y);break;case 51:var Y=new E.game_protobuf_messages.proto.messages.RoomListCommand;X.readMessage(Y,E.game_protobuf_messages.proto.messages.RoomListCommand.deserializeBinaryFromReader),W.setRoomList(Y);break;case 127:var Y=new E.game_protobuf_messages.proto.messages.ErrorCommand;X.readMessage(Y,E.game_protobuf_messages.proto.messages.ErrorCommand.deserializeBinaryFromReader),W.setError(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.Body.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.Body.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.Body.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getRequest(),q!=null&&X.writeMessage(1,q,E.game_protobuf_messages.proto.messages.RequestMessage.serializeBinaryToWriter),q=W.getResponse(),q!=null&&X.writeMessage(2,q,E.game_protobuf_messages.proto.messages.ResponseMessage.serializeBinaryToWriter),q=W.getDirect(),q!=null&&X.writeMessage(3,q,E.game_protobuf_messages.proto.messages.DirectCommand.serializeBinaryToWriter),q=W.getRoomNotification(),q!=null&&X.writeMessage(4,q,E.game_protobuf_messages.proto.messages.RoomNotification.serializeBinaryToWriter),q=W.getEvents(),q!=null&&X.writeMessage(5,q,E.game_protobuf_messages.proto.messages.EventsCommand.serializeBinaryToWriter),q=W.getStatistic(),q!=null&&X.writeMessage(50,q,E.game_protobuf_messages.proto.messages.StatisticCommand.serializeBinaryToWriter),q=W.getRoomList(),q!=null&&X.writeMessage(51,q,E.game_protobuf_messages.proto.messages.RoomListCommand.serializeBinaryToWriter),q=W.getError(),q!=null&&X.writeMessage(127,q,E.game_protobuf_messages.proto.messages.ErrorCommand.serializeBinaryToWriter)},E.game_protobuf_messages.proto.messages.Body.prototype.getRequest=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RequestMessage,1)},E.game_protobuf_messages.proto.messages.Body.prototype.setRequest=function(W){return googleProtobuf.Message.setOneofWrapperField(this,1,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearRequest=function(){return this.setRequest(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasRequest=function(){return googleProtobuf.Message.getField(this,1)!=null},E.game_protobuf_messages.proto.messages.Body.prototype.getResponse=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.ResponseMessage,2)},E.game_protobuf_messages.proto.messages.Body.prototype.setResponse=function(W){return googleProtobuf.Message.setOneofWrapperField(this,2,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearResponse=function(){return this.setResponse(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasResponse=function(){return googleProtobuf.Message.getField(this,2)!=null},E.game_protobuf_messages.proto.messages.Body.prototype.getDirect=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.DirectCommand,3)},E.game_protobuf_messages.proto.messages.Body.prototype.setDirect=function(W){return googleProtobuf.Message.setOneofWrapperField(this,3,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearDirect=function(){return this.setDirect(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasDirect=function(){return googleProtobuf.Message.getField(this,3)!=null},E.game_protobuf_messages.proto.messages.Body.prototype.getRoomNotification=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomNotification,4)},E.game_protobuf_messages.proto.messages.Body.prototype.setRoomNotification=function(W){return googleProtobuf.Message.setOneofWrapperField(this,4,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearRoomNotification=function(){return this.setRoomNotification(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasRoomNotification=function(){return googleProtobuf.Message.getField(this,4)!=null},E.game_protobuf_messages.proto.messages.Body.prototype.getEvents=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.EventsCommand,5)},E.game_protobuf_messages.proto.messages.Body.prototype.setEvents=function(W){return googleProtobuf.Message.setOneofWrapperField(this,5,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearEvents=function(){return this.setEvents(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasEvents=function(){return googleProtobuf.Message.getField(this,5)!=null},E.game_protobuf_messages.proto.messages.Body.prototype.getStatistic=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.StatisticCommand,50)},E.game_protobuf_messages.proto.messages.Body.prototype.setStatistic=function(W){return googleProtobuf.Message.setOneofWrapperField(this,50,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearStatistic=function(){return this.setStatistic(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasStatistic=function(){return googleProtobuf.Message.getField(this,50)!=null},E.game_protobuf_messages.proto.messages.Body.prototype.getRoomList=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.RoomListCommand,51)},E.game_protobuf_messages.proto.messages.Body.prototype.setRoomList=function(W){return googleProtobuf.Message.setOneofWrapperField(this,51,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearRoomList=function(){return this.setRoomList(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasRoomList=function(){return googleProtobuf.Message.getField(this,51)!=null},E.game_protobuf_messages.proto.messages.Body.prototype.getError=function(){return googleProtobuf.Message.getWrapperField(this,E.game_protobuf_messages.proto.messages.ErrorCommand,127)},E.game_protobuf_messages.proto.messages.Body.prototype.setError=function(W){return googleProtobuf.Message.setOneofWrapperField(this,127,E.game_protobuf_messages.proto.messages.Body.oneofGroups_[0],W)},E.game_protobuf_messages.proto.messages.Body.prototype.clearError=function(){return this.setError(void 0)},E.game_protobuf_messages.proto.messages.Body.prototype.hasError=function(){return googleProtobuf.Message.getField(this,127)!=null},googleProtobuf.Message.GENERATE_TO_OBJECT&&(E.game_protobuf_messages.proto.messages.Command.prototype.toObject=function(W){return E.game_protobuf_messages.proto.messages.Command.toObject(W,this)},E.game_protobuf_messages.proto.messages.Command.toObject=function(W,X){var q={cmd:googleProtobuf.Message.getFieldWithDefault(X,1,0),op:googleProtobuf.Message.getFieldWithDefault(X,2,0),body:X.getBody_asB64()};return W&&(q.$jspbMessageInstance=X),q}),E.game_protobuf_messages.proto.messages.Command.deserializeBinary=function(W){var X=new googleProtobuf.BinaryReader(W),q=new E.game_protobuf_messages.proto.messages.Command;return E.game_protobuf_messages.proto.messages.Command.deserializeBinaryFromReader(q,X)},E.game_protobuf_messages.proto.messages.Command.deserializeBinaryFromReader=function(W,X){for(;X.nextField()&&!X.isEndGroup();){var q=X.getFieldNumber();switch(q){case 1:var Y=X.readEnum();W.setCmd(Y);break;case 2:var Y=X.readEnum();W.setOp(Y);break;case 3:var Y=X.readBytes();W.setBody(Y);break;default:X.skipField();break}}return W},E.game_protobuf_messages.proto.messages.Command.prototype.serializeBinary=function(){var W=new googleProtobuf.BinaryWriter;return E.game_protobuf_messages.proto.messages.Command.serializeBinaryToWriter(this,W),W.getResultBuffer()},E.game_protobuf_messages.proto.messages.Command.serializeBinaryToWriter=function(W,X){var q=void 0;q=W.getCmd(),q!==0&&X.writeEnum(1,q),q=W.getOp(),q!==0&&X.writeEnum(2,q),q=W.getBody_asU8(),q.length>0&&X.writeBytes(3,q)},E.game_protobuf_messages.proto.messages.Command.prototype.getCmd=function(){return googleProtobuf.Message.getFieldWithDefault(this,1,0)},E.game_protobuf_messages.proto.messages.Command.prototype.setCmd=function(W){return googleProtobuf.Message.setProto3EnumField(this,1,W)},E.game_protobuf_messages.proto.messages.Command.prototype.getOp=function(){return googleProtobuf.Message.getFieldWithDefault(this,2,0)},E.game_protobuf_messages.proto.messages.Command.prototype.setOp=function(W){return googleProtobuf.Message.setProto3EnumField(this,2,W)},E.game_protobuf_messages.proto.messages.Command.prototype.getBody=function(){return googleProtobuf.Message.getFieldWithDefault(this,3,"")},E.game_protobuf_messages.proto.messages.Command.prototype.getBody_asB64=function(){return googleProtobuf.Message.bytesAsB64(this.getBody())},E.game_protobuf_messages.proto.messages.Command.prototype.getBody_asU8=function(){return googleProtobuf.Message.bytesAsU8(this.getBody())},E.game_protobuf_messages.proto.messages.Command.prototype.setBody=function(W){return googleProtobuf.Message.setProto3BytesField(this,3,W)},E.game_protobuf_messages.proto.messages.CommandType={UNKNOWN:0,SESSION:1,CONV:2,DIRECT:3,ERROR:4,LOBBY:5,STATISTIC:6,EVENTS:7,ACK:8,ECHO:9},E.game_protobuf_messages.proto.messages.OpType={NONE:0,OPEN:1,OPENED:2,CLOSE:3,CLOSED:4,START:30,STARTED:31,ADD_RANDOM:32,RANDOM_ADDED:33,MATCH_RANDOM:34,RANDOM_MATCHED:35,ADD:36,ADDED:37,MEMBERS_JOINED:38,MEMBERS_ONLINE:39,REMOVE:40,REMOVED:41,MEMBERS_LEFT:42,MEMBERS_OFFLINE:43,UPDATE_MASTER_CLIENT:44,MASTER_CLIENT_UPDATED:45,MASTER_CLIENT_CHANGED:46,UPDATE:47,UPDATED:48,UPDATED_NOTIFY:49,UPDATE_SYSTEM_PROPERTY:50,SYSTEM_PROPERTY_UPDATED:51,SYSTEM_PROPERTY_UPDATED_NOTIFY:52,OPENED_NOTIFY:53,VISIBLE:54,VISIBLE_NOTIFY:55,UPDATE_PLAYER_PROP:56,PLAYER_PROP_UPDATED:57,PLAYER_PROPS:58,KICK:59,KICKED:60,KICKED_NOTICE:61,UPDATE_INTEREST_GROUPS:62,INTEREST_GROUPS_UPDATED:65,ROOM_LIST:100,FIND_FRIENDS:101,FOUND_FRIENDS:102},T.object.extend(_,E)}),_proto$game_protobuf_$2=messages_pb.game_protobuf_messages.proto.messages,Command=_proto$game_protobuf_$2.Command,Body$1=_proto$game_protobuf_$2.Body,CommandType$2=_proto$game_protobuf_$2.CommandType,OpType$2=_proto$game_protobuf_$2.OpType,CommandTypeSwap=_Object$keys(CommandType$2).reduce(function(B,_){return _Object$assign({},B,_defineProperty({},CommandType$2[_],_))},{}),OpTypeSwap=_Object$keys(OpType$2).reduce(function(B,_){return _Object$assign({},B,_defineProperty({},OpType$2[_],_))},{}),MAX_NO_PONG_TIMES=2,ERROR_EVENT="ERROR_EVENT",DISCONNECT_EVENT="DISCONNECT_EVENT",Connection=function(B){_inherits(_,B);function _(){_classCallCheck(this,_);var T=_possibleConstructorReturn(this,(_.__proto__||_Object$getPrototypeOf(_)).call(this));return T._requests={},T._msgId=0,T._pingTimer=null,T._pongTimer=null,T._isMessageQueueRunning=!1,T._messageQueue=null,T._fsm=new StateMachine({init:"init",final:"closed",transitions:[{name:"connect",from:"init",to:"connecting"},{name:"connected",from:"connecting",to:"connected"},{name:"connectFailed",from:"connecting",to:"init"},{name:"disconnect",from:"connected",to:"disconnected"},{name:"close",from:["init","connecting","connected","disconnected"],to:"closed"}]}),T}return _createClass(_,[{key:"connect",value:function(E,W,X,q,Y){var te=this;return this._userId=q,this._fsm.connect(),new _Promise(function(ne,ae){var le=adapters.WebSocket,ue=te._getMsgId(),ge=te._getFastOpenUrl(W,E,X,q,Y);ge=ge+"&i="+ue,debug("url: "+ge),te._ws=new le(ge,"protobuf.1"),te._ws.binaryType="arraybuffer",te._ws.onopen=function(){if(debug(te._userId+" : "+te._flag+" connection open"),te._fsm.is("closed")){te._ws.onopen=null,te._ws.onmessage=null,te._ws.onclose=null,te._ws.onerror=null,te._ws.close();return}te._connected(),te._fsm.connected()},te._ws.onclose=function(){te._fsm.connectFailed(),ae(new PlayError(PlayErrorCode.OPEN_WEBSOCKET_ERROR,"websocket closed"))},te._ws.onerror=function(ye){te._fsm.connectFailed(),ae(ye)},te._requests[ue]={resolve:ne,reject:ae}})}},{key:"_connected",value:function(){var E=this;this._isMessageQueueRunning=!0,this._messageQueue=[],this._ping(),this._ws.onmessage=function(W){E._pong();var X=Command.deserializeBinary(W.data),q=X.getCmd(),Y=X.getOp(),te=Body$1.deserializeBinary(X.getBody());debug(E._userId+" : "+E._flag+" <- "+CommandTypeSwap[q]+"/"+OpTypeSwap[Y]+": "+_JSON$stringify(te.toObject())),E._isMessageQueueRunning?E._handleCommand(q,Y,te):(debug("[DELAY] "+E._userId+" : "+E._flag+" <- "+CommandTypeSwap[q]+"/"+OpTypeSwap[Y]+": "+_JSON$stringify(te.toObject())),E._messageQueue.push({cmd:q,op:Y,body:te}))},this._ws.onclose=function(){E._stopKeppAlive(),E._fsm.disconnect(),E.emit(DISCONNECT_EVENT)}}},{key:"_handleCommand",value:function(E,W,X){if(X.hasResponse()){var q=X.getResponse(),Y=q.getI();if(this._requests[Y]){var te=this._requests[Y],ne=te.resolve,ae=te.reject,le=q.getErrorInfo();if(le){var ue=le.getReasonCode(),ge=le.getDetail();ae(new PlayError(ue,ge))}else ne({cmd:E,op:W,res:q})}else error("error response: "+_JSON$stringify(q.toObject()))}else this._handleNotification(E,W,X)}},{key:"sendRequest",value:function(E,W,X){var q=this,Y=this._getMsgId();X.setI(Y);var te=new Body$1;return te.setRequest(X),this.sendCommand(E,W,te),new _Promise(function(ne,ae){q._requests[Y]={resolve:ne,reject:ae}})}},{key:"sendCommand",value:function(E,W,X){var q=new Command;q.setCmd(E),q.setOp(W),q.setBody(X.serializeBinary()),debug(this._userId+" : "+this._flag+" -> "+CommandTypeSwap[E]+"/"+OpTypeSwap[W]+": "+_JSON$stringify(X.toObject())),this._ws.send(q.serializeBinary().buffer)}},{key:"close",value:function(){var E=this;if(this._fsm.cannot("close"))throw new Error("no close: "+this._fsm.state);return this._stopKeppAlive(),new _Promise(function(W,X){E._ws?(E._ws.onopen=null,E._ws.onmessage=null,debug(E._userId+" : "+E._flag+" close"),E._ws.onclose=function(){debug(E._userId+" : "+E._flag+" closed"),W()},E._ws.onerror=function(q){X(q)},E._ws.close()):W()})}},{key:"_getFastOpenUrl",value:function(E,W,X,q,Y){throw new Error("must implement the method")}},{key:"_simulateDisconnection",value:function(){return this.close(),this.emit(DISCONNECT_EVENT),_Promise.resolve()}},{key:"_getMsgId",value:function(){return this._msgId+=1,this._msgId}},{key:"_ping",value:function(){var E=this;this._pingTimer&&(clearTimeout(this._pingTimer),this._pingTimer=null),this._pingTimer=setInterval(function(){debug("ping"),E.sendCommand(CommandType$2.ECHO,OpType$2.NONE,new Body$1)},this._getPingDuration())}},{key:"_pong",value:function(){var E=this;this._pongTimer&&(clearTimeout(this._pongTimer),this._pongTimer=null),this._pongTimer=setTimeout(function(){debug("pong timeout"),E._ws.close()},this._getPingDuration()*MAX_NO_PONG_TIMES)}},{key:"_stopKeppAlive",value:function(){this._pingTimer&&(clearTimeout(this._pingTimer),this._pingTimer=null),this._pongTimer&&(clearTimeout(this._pongTimer),this._pongTimer=null)}},{key:"_getPingDuration",value:function(){throw new Error("must implement the method")}},{key:"_handleNotification",value:function(E,W,X){throw new Error("must implement the method")}},{key:"_handleErrorNotify",value:function(E){var W=E.getErrorInfo(),X=W.getReasonCode(),q=W.getDetail();this.emit(ERROR_EVENT,{code:X,detail:q})}},{key:"_handleUnknownMsg",value:function(E,W,X){error("[UNKNOWN COMMAND] "+this._userId+" : "+this._flag+" -> "+E+"/"+W+": "+_JSON$stringify(X.toObject()))}},{key:"_pauseMessageQueue",value:function(){this._isMessageQueueRunning=!1}},{key:"_resumeMessageQueue",value:function(){for(this._isMessageQueueRunning=!0;this._messageQueue.length>0;){var E=this._messageQueue.shift(),W=E.cmd,X=E.op,q=E.body;debug("[DELAY HANDLE] "+this._userId+" : "+this._flag+" <- "+W+"/"+X+": "+_JSON$stringify(q.toObject())),this._handleCommand(W,X,q)}}}]),_}(eventemitter3),$getOwnPropertyDescriptor=_objectGopd.f;_objectSap("getOwnPropertyDescriptor",function(){return function(_,T){return $getOwnPropertyDescriptor(_toIobject(_),T)}});var $Object=_core.Object,getOwnPropertyDescriptor$1=function B(_,T){return $Object.getOwnPropertyDescriptor(_,T)},getOwnPropertyDescriptor=createCommonjsModule(function(B){B.exports={default:getOwnPropertyDescriptor$1,__esModule:!0}});unwrapExports(getOwnPropertyDescriptor);var get=createCommonjsModule(function(B,_){_.__esModule=!0;var T=W(getPrototypeOf),E=W(getOwnPropertyDescriptor);function W(X){return X&&X.__esModule?X:{default:X}}_.default=function X(q,Y,te){q===null&&(q=Function.prototype);var ne=(0,E.default)(q,Y);if(ne===void 0){var ae=(0,T.default)(q);return ae===null?void 0:X(ae,Y,te)}else{if("value"in ne)return ne.value;var le=ne.get;return le===void 0?void 0:le.call(te)}}}),_get=unwrapExports(get),strictUriEncode=B=>encodeURIComponent(B).replace(/[!'()*]/g,_=>`%${_.charCodeAt(0).toString(16).toUpperCase()}`),token="%[a-f0-9]{2}",singleMatcher=new RegExp(token,"gi"),multiMatcher=new RegExp("("+token+")+","gi");function decodeComponents(B,_){try{return decodeURIComponent(B.join(""))}catch{}if(B.length===1)return B;_=_||1;var T=B.slice(0,_),E=B.slice(_);return Array.prototype.concat.call([],decodeComponents(T),decodeComponents(E))}function decode(B){try{return decodeURIComponent(B)}catch{for(var _=B.match(singleMatcher),T=1;T<_.length;T++)B=decodeComponents(_,T).join(""),_=B.match(singleMatcher);return B}}function customDecodeURIComponent(B){for(var _={"%FE%FF":"","%FF%FE":""},T=multiMatcher.exec(B);T;){try{_[T[0]]=decodeURIComponent(T[0])}catch{var E=decode(T[0]);E!==T[0]&&(_[T[0]]=E)}T=multiMatcher.exec(B)}_["%C2"]="";for(var W=Object.keys(_),X=0;X<W.length;X++){var q=W[X];B=B.replace(new RegExp(q,"g"),_[q])}return B}var decodeUriComponent=function(B){if(typeof B!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof B+"`");try{return B=B.replace(/\+/g," "),decodeURIComponent(B)}catch{return customDecodeURIComponent(B)}},splitOnFirst=(B,_)=>{if(!(typeof B=="string"&&typeof _=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(_==="")return[B];const T=B.indexOf(_);return T===-1?[B]:[B.slice(0,T),B.slice(T+_.length)]},filterObj=function(B,_){for(var T={},E=Object.keys(B),W=Array.isArray(_),X=0;X<E.length;X++){var q=E[X],Y=B[q];(W?_.indexOf(q)!==-1:_(q,Y,B))&&(T[q]=Y)}return T},queryString=createCommonjsModule(function(B,_){const T=ye=>ye==null;function E(ye){switch(ye.arrayFormat){case"index":return xe=>(Te,Ae)=>{const Ie=Te.length;return Ae===void 0||ye.skipNull&&Ae===null||ye.skipEmptyString&&Ae===""?Te:Ae===null?[...Te,[q(xe,ye),"[",Ie,"]"].join("")]:[...Te,[q(xe,ye),"[",q(Ie,ye),"]=",q(Ae,ye)].join("")]};case"bracket":return xe=>(Te,Ae)=>Ae===void 0||ye.skipNull&&Ae===null||ye.skipEmptyString&&Ae===""?Te:Ae===null?[...Te,[q(xe,ye),"[]"].join("")]:[...Te,[q(xe,ye),"[]=",q(Ae,ye)].join("")];case"comma":case"separator":return xe=>(Te,Ae)=>Ae==null||Ae.length===0?Te:Te.length===0?[[q(xe,ye),"=",q(Ae,ye)].join("")]:[[Te,q(Ae,ye)].join(ye.arrayFormatSeparator)];default:return xe=>(Te,Ae)=>Ae===void 0||ye.skipNull&&Ae===null||ye.skipEmptyString&&Ae===""?Te:Ae===null?[...Te,q(xe,ye)]:[...Te,[q(xe,ye),"=",q(Ae,ye)].join("")]}}function W(ye){let xe;switch(ye.arrayFormat){case"index":return(Te,Ae,Ie)=>{if(xe=/\[(\d*)\]$/.exec(Te),Te=Te.replace(/\[\d*\]$/,""),!xe){Ie[Te]=Ae;return}Ie[Te]===void 0&&(Ie[Te]={}),Ie[Te][xe[1]]=Ae};case"bracket":return(Te,Ae,Ie)=>{if(xe=/(\[\])$/.exec(Te),Te=Te.replace(/\[\]$/,""),!xe){Ie[Te]=Ae;return}if(Ie[Te]===void 0){Ie[Te]=[Ae];return}Ie[Te]=[].concat(Ie[Te],Ae)};case"comma":case"separator":return(Te,Ae,Ie)=>{const Ve=typeof Ae=="string"&&Ae.includes(ye.arrayFormatSeparator),$e=typeof Ae=="string"&&!Ve&&Y(Ae,ye).includes(ye.arrayFormatSeparator);Ae=$e?Y(Ae,ye):Ae;const We=Ve||$e?Ae.split(ye.arrayFormatSeparator).map(Ue=>Y(Ue,ye)):Ae===null?Ae:Y(Ae,ye);Ie[Te]=We};default:return(Te,Ae,Ie)=>{if(Ie[Te]===void 0){Ie[Te]=Ae;return}Ie[Te]=[].concat(Ie[Te],Ae)}}}function X(ye){if(typeof ye!="string"||ye.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function q(ye,xe){return xe.encode?xe.strict?strictUriEncode(ye):encodeURIComponent(ye):ye}function Y(ye,xe){return xe.decode?decodeUriComponent(ye):ye}function te(ye){return Array.isArray(ye)?ye.sort():typeof ye=="object"?te(Object.keys(ye)).sort((xe,Te)=>Number(xe)-Number(Te)).map(xe=>ye[xe]):ye}function ne(ye){const xe=ye.indexOf("#");return xe!==-1&&(ye=ye.slice(0,xe)),ye}function ae(ye){let xe="";const Te=ye.indexOf("#");return Te!==-1&&(xe=ye.slice(Te)),xe}function le(ye){ye=ne(ye);const xe=ye.indexOf("?");return xe===-1?"":ye.slice(xe+1)}function ue(ye,xe){return xe.parseNumbers&&!Number.isNaN(Number(ye))&&typeof ye=="string"&&ye.trim()!==""?ye=Number(ye):xe.parseBooleans&&ye!==null&&(ye.toLowerCase()==="true"||ye.toLowerCase()==="false")&&(ye=ye.toLowerCase()==="true"),ye}function ge(ye,xe){xe=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},xe),X(xe.arrayFormatSeparator);const Te=W(xe),Ae=Object.create(null);if(typeof ye!="string"||(ye=ye.trim().replace(/^[?#&]/,""),!ye))return Ae;for(const Ie of ye.split("&")){if(Ie==="")continue;let[Ve,$e]=splitOnFirst(xe.decode?Ie.replace(/\+/g," "):Ie,"=");$e=$e===void 0?null:["comma","separator"].includes(xe.arrayFormat)?$e:Y($e,xe),Te(Y(Ve,xe),$e,Ae)}for(const Ie of Object.keys(Ae)){const Ve=Ae[Ie];if(typeof Ve=="object"&&Ve!==null)for(const $e of Object.keys(Ve))Ve[$e]=ue(Ve[$e],xe);else Ae[Ie]=ue(Ve,xe)}return xe.sort===!1?Ae:(xe.sort===!0?Object.keys(Ae).sort():Object.keys(Ae).sort(xe.sort)).reduce((Ie,Ve)=>{const $e=Ae[Ve];return $e&&typeof $e=="object"&&!Array.isArray($e)?Ie[Ve]=te($e):Ie[Ve]=$e,Ie},Object.create(null))}_.extract=le,_.parse=ge,_.stringify=(ye,xe)=>{if(!ye)return"";xe=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},xe),X(xe.arrayFormatSeparator);const Te=$e=>xe.skipNull&&T(ye[$e])||xe.skipEmptyString&&ye[$e]==="",Ae=E(xe),Ie={};for(const $e of Object.keys(ye))Te($e)||(Ie[$e]=ye[$e]);const Ve=Object.keys(Ie);return xe.sort!==!1&&Ve.sort(xe.sort),Ve.map($e=>{const We=ye[$e];return We===void 0?"":We===null?q($e,xe):Array.isArray(We)?We.reduce(Ae($e),[]).join("&"):q($e,xe)+"="+q(We,xe)}).filter($e=>$e.length>0).join("&")},_.parseUrl=(ye,xe)=>{xe=Object.assign({decode:!0},xe);const[Te,Ae]=splitOnFirst(ye,"#");return Object.assign({url:Te.split("?")[0]||"",query:ge(le(ye),xe)},xe&&xe.parseFragmentIdentifier&&Ae?{fragmentIdentifier:Y(Ae,xe)}:{})},_.stringifyUrl=(ye,xe)=>{xe=Object.assign({encode:!0,strict:!0},xe);const Te=ne(ye.url).split("?")[0]||"",Ae=_.extract(ye.url),Ie=_.parse(Ae,{sort:!1}),Ve=Object.assign(Ie,ye.query);let $e=_.stringify(Ve,xe);$e&&($e=`?${$e}`);let We=ae(ye.url);return ye.fragmentIdentifier&&(We=`#${q(ye.fragmentIdentifier,xe)}`),`${Te}${$e}${We}`},_.pick=(ye,xe,Te)=>{Te=Object.assign({parseFragmentIdentifier:!0},Te);const{url:Ae,query:Ie,fragmentIdentifier:Ve}=_.parseUrl(ye,Te);return _.stringifyUrl({url:Ae,query:filterObj(Ie,xe),fragmentIdentifier:Ve},Te)},_.exclude=(ye,xe,Te)=>{const Ae=Array.isArray(xe)?Ie=>!xe.includes(Ie):(Ie,Ve)=>!xe(Ie,Ve);return _.pick(ye,Ae,Te)}});queryString.extract,queryString.parse,queryString.stringify,queryString.parseUrl,queryString.stringifyUrl,queryString.pick,queryString.exclude;var urlJoin=createCommonjsModule(function(B){(function(_,T,E){B.exports?B.exports=E():T[_]=E()})("urljoin",commonjsGlobal$1,function(){function _(T){var E=[];if(T.length===0)return"";if(typeof T[0]!="string")throw new TypeError("Url must be a string. Received "+T[0]);if(T[0].match(/^[^/:]+:\/*$/)&&T.length>1){var W=T.shift();T[0]=W+T[0]}T[0].match(/^file:\/\/\//)?T[0]=T[0].replace(/^([^/:]+):\/*/,"$1:///"):T[0]=T[0].replace(/^([^/:]+):\/*/,"$1://");for(var X=0;X<T.length;X++){var q=T[X];if(typeof q!="string")throw new TypeError("Url must be a string. Received "+q);q!==""&&(X>0&&(q=q.replace(/^[\/]+/,"")),X<T.length-1?q=q.replace(/[\/]+$/,""):q=q.replace(/[\/]+$/,"/"),E.push(q))}var Y=E.join("/");Y=Y.replace(/\/(\?|&|#[^!])/g,"$1");var te=Y.split("?");return Y=te.shift()+(te.length>0?"?":"")+te.join("&"),Y}return function(){var T;return typeof arguments[0]=="object"?T=arguments[0]:T=[].slice.call(arguments),_(T)}})}),BoolValue=messages_pb.BoolValue,_proto$game_protobuf_$1=messages_pb.game_protobuf_messages.proto.messages,CommandType$1=_proto$game_protobuf_$1.CommandType,OpType$1=_proto$game_protobuf_$1.OpType,RequestMessage$1=_proto$game_protobuf_$1.RequestMessage,CreateRoomRequest=_proto$game_protobuf_$1.CreateRoomRequest,JoinRoomRequest=_proto$game_protobuf_$1.JoinRoomRequest,RoomOptions=_proto$game_protobuf_$1.RoomOptions,UpdateSysPropertyRequest=_proto$game_protobuf_$1.UpdateSysPropertyRequest,RoomSystemProperty=_proto$game_protobuf_$1.RoomSystemProperty,UpdateMasterClientRequest=_proto$game_protobuf_$1.UpdateMasterClientRequest,KickMemberRequest=_proto$game_protobuf_$1.KickMemberRequest,AppInfo=_proto$game_protobuf_$1.AppInfo,DirectCommand=_proto$game_protobuf_$1.DirectCommand,Body=_proto$game_protobuf_$1.Body,UpdatePropertyRequest=_proto$game_protobuf_$1.UpdatePropertyRequest,GAME_KEEPALIVE_DURATION=7e3,PLAYER_JOINED_EVENT="PLAYER_JOINED_EVENT",PLAYER_LEFT_EVENT="PLAYER_LEFT_EVENT",MASTER_CHANGED_EVENT="MASTER_CHANGED_EVENT",ROOM_OPEN_CHANGED_EVENT="ROOM_OPEN_CHANGED_EVENT",ROOM_VISIBLE_CHANGED_EVENT="ROOM_VISIBLE_CHANGED_EVENT",ROOM_PROPERTIES_CHANGED_EVENT="ROOM_PROPERTIES_CHANGED_EVENT",ROOM_SYSTEM_PROPERTIES_CHANGED_EVENT="ROOM_SYSTEM_PROPERTIES_CHANGED_EVENT",PLAYER_PROPERTIES_CHANGED_EVENT="PLAYER_PROPERTIES_CHANGED_EVENT",PLAYER_OFFLINE_EVENT="PLAYER_OFFLINE_EVENT",PLAYER_ONLINE_EVENT="PLAYER_ONLINE_EVENT",SEND_CUSTOM_EVENT="SEND_CUSTOM_EVENT",ROOM_KICKED_EVENT="ROOM_KICKED_EVENT",MAX_PLAYER_COUNT=10;function convertToRoomOptions(B,_,T){var E=new RoomOptions;if(B&&E.setCid(B),_){var W=_.open,X=_.visible,q=_.emptyRoomTtl,Y=_.playerTtl,te=_.maxPlayerCount,ne=_.customRoomProperties,ae=_.customRoomPropertyKeysForLobby,le=_.flag,ue=_.pluginName;if(W!==void 0){var ge=new BoolValue;ge.setValue(W),E.setOpen(ge)}if(X!==void 0){var ye=new BoolValue;ye.setValue(X),E.setVisible(ye)}q>0&&E.setEmptyRoomTtl(q),Y>0&&E.setPlayerTtl(Y),te>0&&te<MAX_PLAYER_COUNT&&E.setMaxMembers(te),ne&&E.setAttr(serializeObject(ne)),ae&&E.setLobbyAttrKeysList(ae),le!==void 0&&E.setFlag(le),ue&&E.setPluginName(ue)}return T&&E.setExpectMembersList(T),E}var GameConnection=function(B){_inherits(_,B);function _(){_classCallCheck(this,_);var T=_possibleConstructorReturn(this,(_.__proto__||_Object$getPrototypeOf(_)).call(this));return T._flag="game",T}return _createClass(_,[{key:"createRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X,q,Y){var te,ne,ae,le,ue;return regenerator.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return te=new RequestMessage$1,ne=convertToRoomOptions(X,q,Y),ae=new CreateRoomRequest,ae.setRoomOptions(ne),te.setCreateRoom(ae),ye.next=7,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.START,te);case 7:return le=ye.sent,ue=le.res,ye.abrupt("return",ue.getCreateRoom().getRoomOptions());case 10:case"end":return ye.stop()}},W,this)}));function E(W,X,q){return T.apply(this,arguments)}return E}()},{key:"joinRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X,q,Y){var te,ne,ae,le,ue;return regenerator.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return te=new RequestMessage$1,ne=new JoinRoomRequest,ae=new RoomOptions,ae.setCid(X),q&&ne.setExpectAttr(serializeObject(q)),Y&&ae.setExpectMembersList(Y),ne.setRoomOptions(ae),te.setJoinRoom(ne),ye.next=10,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.ADD,te);case 10:return le=ye.sent,ue=le.res,ye.abrupt("return",ue.getJoinRoom().getRoomOptions());case 13:case"end":return ye.stop()}},W,this)}));function E(W,X,q){return T.apply(this,arguments)}return E}()},{key:"leaveRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){var X;return regenerator.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return X=new RequestMessage$1,Y.next=3,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.REMOVE,X);case 3:case"end":return Y.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"setRoomSystemProps",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y,te,ne;return regenerator.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return q=new RequestMessage$1,Y=new UpdateSysPropertyRequest,Y.setSysAttr(X),q.setUpdateSysProperty(Y),le.next=6,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.UPDATE_SYSTEM_PROPERTY,q);case 6:return te=le.sent,ne=te.res,le.abrupt("return",ne.getUpdateSysProperty().getSysAttr());case 9:case"end":return le.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"setRoomOpen",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y,te;return regenerator.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return q=new RoomSystemProperty,Y=new BoolValue,Y.setValue(X),q.setOpen(Y),ae.next=6,this.setRoomSystemProps(q);case 6:return te=ae.sent,ae.abrupt("return",te.getOpen().getValue());case 8:case"end":return ae.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"setRoomVisible",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y,te;return regenerator.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return q=new RoomSystemProperty,Y=new BoolValue,Y.setValue(X),q.setVisible(Y),ae.next=6,this.setRoomSystemProps(q);case 6:return te=ae.sent,ae.abrupt("return",te.getVisible().getValue());case 8:case"end":return ae.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"setRoomMaxPlayerCount",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y;return regenerator.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return q=new RoomSystemProperty,q.setMaxMembers(X),ne.next=4,this.setRoomSystemProps(q);case 4:return Y=ne.sent,ne.abrupt("return",Y.getMaxMembers());case 6:case"end":return ne.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"setRoomExpectedUserIds",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y;return regenerator.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return q=new RoomSystemProperty,q.setExpectMembers(_JSON$stringify({$set:X})),ne.next=4,this.setRoomSystemProps(q);case 4:return Y=ne.sent,ne.abrupt("return",JSON.parse(Y.getExpectMembers()));case 6:case"end":return ne.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"clearRoomExpectedUserIds",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){var X,q;return regenerator.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return X=new RoomSystemProperty,X.setExpectMembers(_JSON$stringify({$drop:!0})),te.next=4,this.setRoomSystemProps(X);case 4:return q=te.sent,te.abrupt("return",JSON.parse(q.getExpectMembers()));case 6:case"end":return te.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"addRoomExpectedUserIds",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y;return regenerator.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return q=new RoomSystemProperty,q.setExpectMembers(_JSON$stringify({$add:X})),ne.next=4,this.setRoomSystemProps(q);case 4:return Y=ne.sent,ne.abrupt("return",JSON.parse(Y.getExpectMembers()));case 6:case"end":return ne.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"removeRoomExpectedUserIds",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y;return regenerator.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return q=new RoomSystemProperty,q.setExpectMembers(_JSON$stringify({$remove:X})),ne.next=4,this.setRoomSystemProps(q);case 4:return Y=ne.sent,ne.abrupt("return",JSON.parse(Y.getExpectMembers()));case 6:case"end":return ne.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"setMaster",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q,Y,te,ne;return regenerator.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return q=new RequestMessage$1,Y=new UpdateMasterClientRequest,Y.setMasterActorId(X),q.setUpdateMasterClient(Y),le.next=6,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.UPDATE_MASTER_CLIENT,q);case 6:return te=le.sent,ne=te.res,le.abrupt("return",ne.getUpdateMasterClient().getMasterActorId());case 9:case"end":return le.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"kickPlayer",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X,q,Y){var te,ne,ae,le,ue;return regenerator.wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:return te=new RequestMessage$1,ne=new KickMemberRequest,ne.setTargetActorId(X),(q!==null||Y!==null)&&(ae=new AppInfo,ae.setAppCode(q),ae.setAppMsg(Y),ne.setAppInfo(ae)),te.setKickMember(ne),ye.next=7,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.KICK,te);case 7:return le=ye.sent,ue=le.res,ye.abrupt("return",ue.getKickMember().getTargetActorId());case 10:case"end":return ye.stop()}},W,this)}));function E(W,X,q){return T.apply(this,arguments)}return E}()},{key:"sendEvent",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X,q,Y){var te,ne;return regenerator.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:return te=new DirectCommand,te.setEventId(X),q&&te.setMsg(serializeObject(q)),Y?(te.setReceiverGroup(Y.receiverGroup),te.setToActorIdsList(Y.targetActorIds)):te.setReceiverGroup(ReceiverGroup.All),ne=new Body,ne.setDirect(te),le.next=8,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendCommand",this).call(this,CommandType$1.DIRECT,OpType$1.NONE,ne);case 8:case"end":return le.stop()}},W,this)}));function E(W,X,q){return T.apply(this,arguments)}return E}()},{key:"setRoomCustomProperties",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X,q){var Y,te,ne,ae,le;return regenerator.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return Y=new RequestMessage$1,te=new UpdatePropertyRequest,te.setAttr(serializeObject(X)),q&&te.setExpectAttr(serializeObject(q)),Y.setUpdateProperty(te),ge.next=7,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.UPDATE,Y);case 7:return ne=ge.sent,ae=ne.res,le=deserializeObject(ae.getUpdateProperty().getAttr()),ge.abrupt("return",le);case 11:case"end":return ge.stop()}},W,this)}));function E(W,X){return T.apply(this,arguments)}return E}()},{key:"setPlayerCustomProperties",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X,q,Y){var te,ne,ae,le,ue,ge;return regenerator.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return te=new RequestMessage$1,ne=new UpdatePropertyRequest,ne.setTargetActorId(X),ne.setAttr(serializeObject(q)),Y&&ne.setExpectAttr(serializeObject(Y)),te.setUpdateProperty(ne),xe.next=8,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType$1.CONV,OpType$1.UPDATE_PLAYER_PROP,te);case 8:return ae=xe.sent,le=ae.res,ue=le.getUpdateProperty().getActorId(),ge=le.getUpdateProperty().getAttr(),xe.abrupt("return",{actorId:ue,changedProps:ge});case 13:case"end":return xe.stop()}},W,this)}));function E(W,X,q){return T.apply(this,arguments)}return E}()},{key:"_getPingDuration",value:function(){return GAME_KEEPALIVE_DURATION}},{key:"_getFastOpenUrl",value:function(E,W,X,q,Y){var te=queryString.parseUrl(E),ne=te.url,ae=te.query,le=_Object$assign(ae,{appId:W,sdkVersion:version,protocolVersion,gameVersion:X,userId:q,sessionToken:Y});return urlJoin(ne,"session","?"+queryString.stringify(le))}},{key:"_handleNotification",value:function(E,W,X){switch(E){case CommandType$1.CONV:switch(W){case OpType$1.MEMBERS_JOINED:this._handlePlayerJoined(X.getRoomNotification().getJoinRoom());break;case OpType$1.MEMBERS_LEFT:this._handlePlayerLeftMsg(X.getRoomNotification().getLeftRoom());break;case OpType$1.MASTER_CLIENT_CHANGED:this._handleMasterChangedMsg(X.getRoomNotification().getUpdateMasterClient());break;case OpType$1.SYSTEM_PROPERTY_UPDATED_NOTIFY:this._handleRoomSystemPropsChangedMsg(X.getRoomNotification().getUpdateSysProperty());break;case OpType$1.UPDATED_NOTIFY:this._handleRoomPropertiesChangedMsg(X.getRoomNotification().getUpdateProperty());break;case OpType$1.PLAYER_PROPS:this._handlePlayerPropertiesChangedMsg(X.getRoomNotification().getUpdateProperty());break;case OpType$1.MEMBERS_OFFLINE:this._handlePlayerOfflineMsg(X.getRoomNotification());break;case OpType$1.MEMBERS_ONLINE:this._handlePlayerOnlineMsg(X.getRoomNotification());break;case OpType$1.KICKED_NOTICE:this._handleKickedMsg(X.getRoomNotification());break}break;case CommandType$1.EVENTS:break;case CommandType$1.DIRECT:this._handleSendEventMsg(X.getDirect());break;case CommandType$1.ERROR:_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"_handleErrorNotify",this).call(this,X.getError());break}}},{key:"_handlePlayerJoined",value:function(E){this.emit(PLAYER_JOINED_EVENT,E.getMember())}},{key:"_handlePlayerLeftMsg",value:function(E){var W=E.getActorId();this.emit(PLAYER_LEFT_EVENT,W)}},{key:"_handleMasterChangedMsg",value:function(E){var W=E.getMasterActorId();this.emit(MASTER_CHANGED_EVENT,W)}},{key:"_handleRoomPropertiesChangedMsg",value:function(E){var W=deserializeObject(E.getAttr());this.emit(ROOM_PROPERTIES_CHANGED_EVENT,W)}},{key:"_handlePlayerPropertiesChangedMsg",value:function(E){var W=E.getActorId(),X=deserializeObject(E.getAttr());this.emit(PLAYER_PROPERTIES_CHANGED_EVENT,W,X)}},{key:"_handlePlayerOfflineMsg",value:function(E){var W=E.getInitByActor();this.emit(PLAYER_OFFLINE_EVENT,W)}},{key:"_handlePlayerOnlineMsg",value:function(E){var W=E.getJoinRoom(),X=W.getMember(),q=X.getActorId(),Y=deserializeObject(X.getAttr());this.emit(PLAYER_ONLINE_EVENT,q,Y)}},{key:"_handleSendEventMsg",value:function(E){var W=E.getEventId(),X=null;E.getMsg()&&(X=deserializeObject(E.getMsg()));var q=E.getFromActorId();this.emit(SEND_CUSTOM_EVENT,W,X,q)}},{key:"_handleKickedMsg",value:function(E){var W=E.getAppInfo();W?this.emit(ROOM_KICKED_EVENT,{code:W.getAppCode(),msg:W.getAppMsg()}):this.emit(ROOM_KICKED_EVENT)}},{key:"_handleRoomSystemPropsChangedMsg",value:function(E){var W=E.getSysAttr(),X={};W.getOpen()&&(X.open=W.getOpen().getValue()),W.getVisible()&&(X.visible=W.getVisible().getValue()),W.getMaxMembers()&&(X.maxPlayerCount=W.getMaxMembers()),W.getExpectMembers()&&(X.expectedUserIds=JSON.parse(W.getExpectMembers())),this.emit(ROOM_SYSTEM_PROPERTIES_CHANGED_EVENT,X)}}]),_}(Connection),Event={CONNECTED:"connected",CONNECT_FAILED:"connectFailed",DISCONNECTED:"disconnected",LOBBY_JOINED:"lobbyJoined",LOBBY_LEFT:"lobbyLeft",LOBBY_ROOM_LIST_UPDATED:"lobbyRoomListUpdate",ROOM_CREATED:"roomCreated",ROOM_CREATE_FAILED:"roomCreateFailed",ROOM_JOINED:"roomJoined",ROOM_JOIN_FAILED:"roomJoinFailed",PLAYER_ROOM_JOINED:"newPlayerJoinedRoom",PLAYER_ROOM_LEFT:"playerLeftRoom",PLAYER_ACTIVITY_CHANGED:"playerActivityChanged",MASTER_SWITCHED:"masterSwitched",ROOM_SYSTEM_PROPERTIES_CHANGED:"roomSystemPropertiesChanged",ROOM_OPEN_CHANGED:"roomOpenChanged",ROOM_VISIBLE_CHANGED:"roomVisibleChanged",ROOM_LEFT:"roomLeft",ROOM_KICKED:"roomKicked",ROOM_CUSTOM_PROPERTIES_CHANGED:"roomCustomPropertiesChanged",PLAYER_CUSTOM_PROPERTIES_CHANGED:"playerCustomPropertiesChanged",CUSTOM_EVENT:"customEvent",ERROR:"error"},Room=function(){function B(_){var T=this;_classCallCheck(this,B),this._client=_,this._fsm=new StateMachine({init:"init",final:"closed",transitions:[{name:"join",from:"init",to:"joining"},{name:"joined",from:"joining",to:"game"},{name:"joinFailed",from:"joining",to:"init"},{name:"leave",from:"game",to:"leaving"},{name:"leaveFailed",from:"leaving",to:"game"},{name:"disconnect",from:"game",to:"disconnected"},{name:"close",from:["init","joining","game","leaving","disconnected"],to:"closed"}],methods:{onEnterGame:function(){T._lastRoomId=T.name,T._gameConn.on(ERROR_EVENT,function(){var W=_asyncToGenerator(regenerator.mark(function X(q){var Y=q.code,te=q.detail;return regenerator.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:T._gameConn.close(),T._client.emit(Event.ERROR,{code:Y,detail:te});case 2:case"end":return ae.stop()}},X,T)}));return function(X){return W.apply(this,arguments)}}()),T._gameConn.on(PLAYER_JOINED_EVENT,function(W){var X=new Player(T);X._init(W),T._addPlayer(X),T._client.emit(Event.PLAYER_ROOM_JOINED,{newPlayer:X})}),T._gameConn.on(PLAYER_LEFT_EVENT,function(W){var X=T.getPlayer(W);T._removePlayer(W),T._client.emit(Event.PLAYER_ROOM_LEFT,{leftPlayer:X})}),T._gameConn.on(MASTER_CHANGED_EVENT,function(W){var X=null;T._masterActorId=W,W>0&&(X=T.getPlayer(W)),T._client.emit(Event.MASTER_SWITCHED,{newMaster:X})}),T._gameConn.on(ROOM_OPEN_CHANGED_EVENT,function(W){T._open=W,T._client.emit(Event.ROOM_OPEN_CHANGED,{open:W})}),T._gameConn.on(ROOM_VISIBLE_CHANGED_EVENT,function(W){T._visible=W,T._client.emit(Event.ROOM_VISIBLE_CHANGED,{visible:W})}),T._gameConn.on(ROOM_PROPERTIES_CHANGED_EVENT,function(W){T._mergeProperties(W),T._client.emit(Event.ROOM_CUSTOM_PROPERTIES_CHANGED,{changedProps:W})}),T._gameConn.on(ROOM_SYSTEM_PROPERTIES_CHANGED_EVENT,function(W){T._mergeSystemProps(W),T._client.emit(Event.ROOM_SYSTEM_PROPERTIES_CHANGED,{changedProps:W})}),T._gameConn.on(PLAYER_PROPERTIES_CHANGED_EVENT,function(W,X){var q=T.getPlayer(W);q._mergeProperties(X),T._client.emit(Event.PLAYER_CUSTOM_PROPERTIES_CHANGED,{player:q,changedProps:X})}),T._gameConn.on(PLAYER_OFFLINE_EVENT,function(W){var X=T.getPlayer(W);X._active=!1,T._client.emit(Event.PLAYER_ACTIVITY_CHANGED,{player:X})}),T._gameConn.on(PLAYER_ONLINE_EVENT,function(W,X){var q=T.getPlayer(W);q._mergeProperties(X),q._active=!0,T._client.emit(Event.PLAYER_ACTIVITY_CHANGED,{player:q})}),T._gameConn.on(SEND_CUSTOM_EVENT,function(W,X,q){T._client.emit(Event.CUSTOM_EVENT,{eventId:W,eventData:X,senderId:q})}),T._gameConn.on(DISCONNECT_EVENT,function(){T._fsm.disconnect(),T._client.emit(Event.DISCONNECTED)}),T._gameConn.on(ROOM_KICKED_EVENT,function(){var W=_asyncToGenerator(regenerator.mark(function X(q){return regenerator.wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.next=2,T.close();case 2:q?T._client.emit(Event.ROOM_KICKED,q):T._client.emit(Event.ROOM_KICKED);case 3:case"end":return te.stop()}},X,T)}));return function(X){return W.apply(this,arguments)}}())},onExitGame:function(){T._gameConn.removeAllListeners()}}})}return _createClass(B,[{key:"create",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(W,X,q){var Y,te,ne,ae,le,ue,ge,ye,xe,Te,Ae;return regenerator.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:if(!(W!==null&&typeof W!="string")){Ve.next=2;break}throw new TypeError(W+" is not a string");case 2:if(!(X!==null&&!(X instanceof Object))){Ve.next=4;break}throw new TypeError(X+" is not a Object");case 4:if(!(q!==null&&!Array.isArray(q))){Ve.next=6;break}throw new TypeError(q+" is not an Array with string");case 6:return this._fsm.join(),Ve.prev=7,Y=this._client._lobbyService,Ve.next=11,Y.createRoom(W);case 11:return te=Ve.sent,ne=te.cid,ae=te.addr,Ve.next=16,Y.authorize();case 16:return le=Ve.sent,ue=le.sessionToken,this._gameConn=new GameConnection,ge=this._client,ye=ge._appId,xe=ge._gameVersion,Te=ge._userId,Ve.next=22,this._gameConn.connect(ye,ae,xe,Te,ue);case 22:return Ve.next=24,this._gameConn.createRoom(ne,X,q);case 24:Ae=Ve.sent,this._init(Ae),this._fsm.joined(),Ve.next=34;break;case 29:return Ve.prev=29,Ve.t0=Ve.catch(7),Ve.next=33,this.close();case 33:throw Ve.t0;case 34:case"end":return Ve.stop()}},E,this,[[7,29]])}));function T(E,W,X){return _.apply(this,arguments)}return T}()},{key:"join",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(W,X){var q,Y,te,ne,ae,le,ue,ge,ye,xe,Te;return regenerator.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:if(typeof W=="string"){Ie.next=2;break}throw new TypeError(W+" is not a string");case 2:if(!(X!==null&&!Array.isArray(X))){Ie.next=4;break}throw new TypeError(X+" is not an array with string");case 4:return this._fsm.join(),Ie.prev=5,q=this._client._lobbyService,Ie.next=9,q.joinRoom({roomName:W});case 9:return Y=Ie.sent,te=Y.cid,ne=Y.addr,Ie.next=14,q.authorize();case 14:return ae=Ie.sent,le=ae.sessionToken,this._gameConn=new GameConnection,ue=this._client,ge=ue._appId,ye=ue._gameVersion,xe=ue._userId,Ie.next=20,this._gameConn.connect(ge,ne,ye,xe,le);case 20:return Ie.next=22,this._gameConn.joinRoom(te,null,X);case 22:Te=Ie.sent,this._init(Te),this._fsm.joined(),Ie.next=32;break;case 27:return Ie.prev=27,Ie.t0=Ie.catch(5),Ie.next=31,this.close();case 31:throw Ie.t0;case 32:case"end":return Ie.stop()}},E,this,[[5,27]])}));function T(E,W){return _.apply(this,arguments)}return T}()},{key:"joinRandom",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(W,X){var q,Y,te,ne,ae,le,ue,ge,ye,xe,Te;return regenerator.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:if(!(W!=null&&(typeof W>"u"?"undefined":_typeof(W))!=="object")){Ie.next=2;break}throw new TypeError(W+" is not an object");case 2:if(!(X!==null&&!Array.isArray(X))){Ie.next=4;break}throw new TypeError(X+" is not an array with string");case 4:return this._fsm.join(),Ie.prev=5,q=this._client._lobbyService,Ie.next=9,q.joinRandomRoom(W,X);case 9:return Y=Ie.sent,te=Y.cid,ne=Y.addr,Ie.next=14,q.authorize();case 14:return ae=Ie.sent,le=ae.sessionToken,this._gameConn=new GameConnection,ue=this._client,ge=ue._appId,ye=ue._gameVersion,xe=ue._userId,Ie.next=20,this._gameConn.connect(ge,ne,ye,xe,le);case 20:return Ie.next=22,this._gameConn.joinRoom(te,null,X);case 22:Te=Ie.sent,this._init(Te),this._fsm.joined(),Ie.next=32;break;case 27:return Ie.prev=27,Ie.t0=Ie.catch(5),Ie.next=31,this.close();case 31:throw Ie.t0;case 32:case"end":return Ie.stop()}},E,this,[[5,27]])}));function T(E,W){return _.apply(this,arguments)}return T}()},{key:"rejoin",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(W){var X,q,Y,te,ne,ae,le,ue,ge,ye,xe;return regenerator.wrap(function(Ae){for(;;)switch(Ae.prev=Ae.next){case 0:if(typeof W=="string"){Ae.next=2;break}throw new TypeError(W+" is not a string");case 2:return this._fsm.join(),Ae.prev=3,X=this._client._lobbyService,Ae.next=7,X.joinRoom({roomName:W,rejoin:!0});case 7:return q=Ae.sent,Y=q.cid,te=q.addr,Ae.next=12,X.authorize();case 12:return ne=Ae.sent,ae=ne.sessionToken,this._gameConn=new GameConnection,le=this._client,ue=le._appId,ge=le._gameVersion,ye=le._userId,Ae.next=18,this._gameConn.connect(ue,te,ge,ye,ae);case 18:return Ae.next=20,this._gameConn.joinRoom(Y);case 20:xe=Ae.sent,this._init(xe),this._fsm.joined(),Ae.next=30;break;case 25:return Ae.prev=25,Ae.t0=Ae.catch(3),Ae.next=29,this.close();case 29:throw Ae.t0;case 30:case"end":return Ae.stop()}},E,this,[[3,25]])}));function T(E){return _.apply(this,arguments)}return T}()},{key:"joinOrCreate",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(W,X,q){var Y,te,ne,ae,le,ue,ge,ye,xe,Te,Ae,Ie;return regenerator.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:if(typeof W=="string"){$e.next=2;break}throw new TypeError(W+" is not a string");case 2:if(!(X!==null&&!(X instanceof Object))){$e.next=4;break}throw new TypeError(X+" is not a Object");case 4:if(!(q!==null&&!Array.isArray(q))){$e.next=6;break}throw new TypeError(q+" is not an array with string");case 6:return this._fsm.join(),$e.prev=7,Y=this._client._lobbyService,$e.next=11,Y.joinRoom({roomName:W,createOnNotFound:!0});case 11:return te=$e.sent,ne=te.cid,ae=te.addr,le=te.roomCreated,$e.next=17,Y.authorize();case 17:return ue=$e.sent,ge=ue.sessionToken,this._gameConn=new GameConnection,ye=this._client,xe=ye._appId,Te=ye._gameVersion,Ae=ye._userId,$e.next=23,this._gameConn.connect(xe,ae,Te,Ae,ge);case 23:if(Ie=null,!le){$e.next=30;break}return $e.next=27,this._gameConn.createRoom(ne,X,q);case 27:Ie=$e.sent,$e.next=33;break;case 30:return $e.next=32,this._gameConn.joinRoom(ne,null,q);case 32:Ie=$e.sent;case 33:this._init(Ie),this._fsm.joined(),$e.next=42;break;case 37:return $e.prev=37,$e.t0=$e.catch(7),$e.next=41,this.close();case 41:throw $e.t0;case 42:case"end":return $e.stop()}},E,this,[[7,37]])}));function T(E,W,X){return _.apply(this,arguments)}return T}()},{key:"leave",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(){return regenerator.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return this._client._room=null,this._fsm.leave(),X.prev=2,X.next=5,this._gameConn.leaveRoom();case 5:X.next=11;break;case 7:throw X.prev=7,X.t0=X.catch(2),this._fsm.leaveFailed(),X.t0;case 11:return X.next=13,this.close();case 13:case"end":return X.stop()}},E,this,[[2,7]])}));function T(){return _.apply(this,arguments)}return T}()},{key:"close",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(){return regenerator.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(!this._fsm.cannot("close")){X.next=2;break}throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);case 2:if(!this._gameConn){X.next=5;break}return X.next=5,this._gameConn.close();case 5:this._client._room=null,this._fsm.close();case 7:case"end":return X.stop()}},E,this)}));function T(){return _.apply(this,arguments)}return T}()},{key:"setOpen",value:function(T){var E=this;if(typeof T!="boolean")throw new TypeError(T+" is not a boolean value");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.setRoomOpen(T).then(tap(function(W){E._mergeSystemProps({open:W})}))}},{key:"setVisible",value:function(T){var E=this;if(typeof T!="boolean")throw new TypeError(T+" is not a boolean value");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.setRoomVisible(T).then(tap(function(W){E._mergeSystemProps({visible:W})}))}},{key:"setMaxPlayerCount",value:function(T){var E=this;if(typeof T!="number"||T<1)throw new TypeError(T+" is not a positive number");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.setRoomMaxPlayerCount(T).then(tap(function(W){E._mergeSystemProps({maxPlayerCount:W})}))}},{key:"setExpectedUserIds",value:function(T){var E=this;if(!Array.isArray(T))throw new TypeError(T+" is not an array");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.setRoomExpectedUserIds(T).then(tap(function(W){E._mergeSystemProps({expectedUserIds:W})}))}},{key:"clearExpectedUserIds",value:function(){var T=this;if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.clearRoomExpectedUserIds().then(tap(function(E){T._mergeSystemProps({expectedUserIds:E})}))}},{key:"addExpectedUserIds",value:function(T){var E=this;if(!Array.isArray(T))throw new TypeError(T+" is not an array");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.addRoomExpectedUserIds(T).then(tap(function(W){E._mergeSystemProps({expectedUserIds:W})}))}},{key:"removeExpectedUserIds",value:function(T){var E=this;if(!Array.isArray(T))throw new TypeError(T+" is not an array");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.removeRoomExpectedUserIds(T).then(tap(function(W){E._mergeSystemProps({expectedUserIds:W})}))}},{key:"setMaster",value:function(T){var E=this;if(typeof T!="number")throw new TypeError(T+" is not a number");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.setMaster(T).then(tap(function(W){E._masterActorId=W}))}},{key:"sendEvent",value:function(T){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{receiverGroup:ReceiverGroup.All};if(typeof T!="number")throw new TypeError(T+" is not a number");if(T<-128||T>127)throw new TypeError("eventId must be [-128, 127]");if((typeof E>"u"?"undefined":_typeof(E))!=="object")throw new TypeError(E+" is not an object");if(!(W instanceof Object))throw new TypeError(W+" is not a Object");if(W.receiverGroup===void 0&&W.targetActorIds===void 0)throw new TypeError("receiverGroup and targetActorIds are null");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.sendEvent(T,E,W)}},{key:"_init",value:function(T){var E=this;this._name=T.getCid(),this._open=T.getOpen().getValue(),this._visible=T.getVisible().getValue(),this._maxPlayerCount=T.getMaxMembers(),this._masterActorId=T.getMasterActorId(),this._expectedUserIds=T.getExpectMembersList(),this._players={},T.getMembersList().forEach(function(W){var X=new Player(E);X._init(W),E._players[X.actorId]=X,X._userId===E._client._userId&&(E._player=X)}),T.getAttr()?this._properties=deserializeObject(T.getAttr()):this._properties={}}},{key:"getPlayer",value:function(T){if(typeof T!="number")throw new TypeError(T+" is not a number");if(T===0)return null;var E=this._players[T];if(E===null)throw new Error("player with id:"+T+" not found");return E}},{key:"setCustomProperties",value:function(T){var E=this,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=W.expectedValues,q=X===void 0?null:X;if((typeof T>"u"?"undefined":_typeof(T))!=="object")throw new TypeError(T+" is not an object");if(q&&(typeof q>"u"?"undefined":_typeof(q))!=="object")throw new TypeError(q+" is not an object");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.setRoomCustomProperties(T,q).then(tap(function(Y){var te=Y.attr;te&&E._mergeProperties(te)}))}},{key:"setPlayerProperties",value:function(T,E,W){if(typeof T!="number")throw new TypeError(T+" is not a number");if((typeof E>"u"?"undefined":_typeof(E))!=="object")throw new TypeError(E+" is not an object");if(W&&(typeof W>"u"?"undefined":_typeof(W))!=="object")throw new TypeError(W+" is not an object");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.setPlayerCustomProperties(T,E,W)}},{key:"kickPlayer",value:function(T){var E=this,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=W.code,q=X===void 0?null:X,Y=W.msg,te=Y===void 0?null:Y;if(typeof T!="number")throw new TypeError(T+" is not a number");if(q&&typeof q!="number")throw new TypeError(q+" is not a number");if(te&&typeof te!="string")throw new TypeError(te+" is not a string");if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);return this._gameConn.kickPlayer(T,q,te).then(tap(function(ne){E._removePlayer(ne)}))}},{key:"pauseMessageQueue",value:function(){if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);this._gameConn._pauseMessageQueue()}},{key:"resumeMessageQueue",value:function(){if(!this._fsm.is("game"))throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);this._gameConn._resumeMessageQueue()}},{key:"_addPlayer",value:function(T){if(!(T instanceof Player))throw new TypeError(T+" is not a Player");this._players[T.actorId]=T}},{key:"_removePlayer",value:function(T){delete this._players[T]}},{key:"_mergeProperties",value:function(T){this._properties=_Object$assign(this._properties,T)}},{key:"_mergeSystemProps",value:function(T){var E=T.open,W=T.visible,X=T.maxPlayerCount,q=T.expectedUserIds;E!==void 0&&(this._open=E),W!==void 0&&(this._visible=W),X!==void 0&&(this._maxPlayerCount=X),q!==void 0&&(this._expectedUserIds=q)}},{key:"_simulateDisconnection",value:function(){return this._gameConn._simulateDisconnection()}},{key:"name",get:function(){return this._name}},{key:"open",get:function(){return this._open}},{key:"visible",get:function(){return this._visible}},{key:"maxPlayerCount",get:function(){return this._maxPlayerCount}},{key:"master",get:function(){return this.getPlayer(this.masterId)}},{key:"masterId",get:function(){return this._masterActorId}},{key:"expectedUserIds",get:function(){return this._expectedUserIds}},{key:"customProperties",get:function(){return this._properties}},{key:"playerList",get:function(){return _Object$values(this._players)}}]),B}(),LobbyRoom=function(){function B(){_classCallCheck(this,B)}return _createClass(B,[{key:"roomName",get:function(){return this._roomName}},{key:"maxPlayerCount",get:function(){return this._maxPlayerCount}},{key:"expectedUserIds",get:function(){return this._expectedUserIds}},{key:"emptyRoomTtl",get:function(){return this._emptyRoomTtl}},{key:"playerTtl",get:function(){return this._playerTtl}},{key:"playerCount",get:function(){return this._playerCount}},{key:"customRoomProperties",get:function(){return this._customRoomProperties}},{key:"visible",get:function(){return this._visible===!0}},{key:"open",get:function(){return this._open===!0}}]),B}(),_proto$game_protobuf_=messages_pb.game_protobuf_messages.proto.messages,CommandType=_proto$game_protobuf_.CommandType,OpType=_proto$game_protobuf_.OpType,RequestMessage=_proto$game_protobuf_.RequestMessage,LOBBY_KEEPALIVE_DURATION=12e4,ROOM_LIST_UPDATED_EVENT="ROOM_LIST_UPDATED_EVENT";function convertToLobbyRoom(B){var _=new LobbyRoom;return _._roomName=B.getCid(),_._visible=B.getVisible(),_._open=B.getOpen(),_._maxPlayerCount=B.getMaxMembers(),_._expectedUserIds=B.getExpectMembersList(),_._emptyRoomTtl=B.getEmptyRoomTtl(),_._playerTtl=B.getPlayerTtl(),_._playerCount=B.getMemberCount(),_._customRoomProperties=deserializeObject(B.getAttr()),_}var LobbyConnection=function(B){_inherits(_,B);function _(){_classCallCheck(this,_);var T=_possibleConstructorReturn(this,(_.__proto__||_Object$getPrototypeOf(_)).call(this));return T._flag="lobby",T}return _createClass(_,[{key:"joinLobby",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){var X;return regenerator.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(this._fsm.is("connected")){Y.next=2;break}throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);case 2:return X=new RequestMessage,Y.next=5,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType.LOBBY,OpType.ADD,X);case 5:case"end":return Y.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"leaveLobby",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){var X;return regenerator.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(this._fsm.is("connected")){Y.next=2;break}throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);case 2:return X=new RequestMessage,Y.next=5,_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"sendRequest",this).call(this,CommandType.LOBBY,OpType.REMOVE,X);case 5:case"end":return Y.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"_getFastOpenUrl",value:function(E,W,X,q,Y){var te={appId:W,sdkVersion:version,protocolVersion,gameVersion:X,userId:q,sessionToken:Y};return urlJoin(E,"/1/multiplayer/lobby/websocket","?"+queryString.stringify(te))}},{key:"_getPingDuration",value:function(){return LOBBY_KEEPALIVE_DURATION}},{key:"_handleNotification",value:function(E,W,X){switch(E){case CommandType.LOBBY:switch(W){case OpType.ROOM_LIST:this._handleRoomListMsg(X);break;default:_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"_handleUnknownMsg",this).call(this,E,W,X);break}break;case CommandType.STATISTIC:break;case CommandType.ERROR:_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"_handleErrorNotify",this).call(this,X.getError());break;default:_get(_.prototype.__proto__||_Object$getPrototypeOf(_.prototype),"_handleUnknownMsg",this).call(this,E,W,X);break}}},{key:"_handleRoomListMsg",value:function(E){var W=[],X=E.getRoomList().getListList();X.forEach(function(q){var Y=convertToLobbyRoom(q);W.push(Y)}),this.emit(ROOM_LIST_UPDATED_EVENT,W)}}]),_}(Connection),Lobby=function(){function B(_){var T=this;_classCallCheck(this,B),this._client=_,this._fsm=new StateMachine({init:"init",final:"closed",transitions:[{name:"join",from:"init",to:"joining"},{name:"joined",from:"joining",to:"lobby"},{name:"joinFailed",from:"joining",to:"init"},{name:"leave",from:"lobby",to:"leaving"},{name:"close",from:["init","joining","lobby","leaving"],to:"closed"}],methods:{onEnterLobby:function(){T._lobbyConn.on(ROOM_LIST_UPDATED_EVENT,function(W){T._lobbyRoomList=W,T._client.emit(Event.LOBBY_ROOM_LIST_UPDATED)})},onExitLobby:function(){T._lobbyConn.removeAllListeners()}}})}return _createClass(B,[{key:"join",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(){var W,X,q,Y,te,ne,ae,le,ue,ge;return regenerator.wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:if(!this._fsm.cannot("join")){xe.next=2;break}throw new PlayError(PlayErrorCode.STATE_ERROR,"Error state: "+this._fsm.state);case 2:return this._fsm.join(),W=null,xe.prev=4,X=this._client._lobbyService,xe.next=8,X.authorize();case 8:W=xe.sent,xe.next=15;break;case 11:throw xe.prev=11,xe.t0=xe.catch(4),this._fsm.joinFailed(),xe.t0;case 15:return xe.prev=15,q=W,Y=q.url,te=q.sessionToken,ne=this._client,ae=ne._appId,le=ne._gameVersion,ue=ne._userId,this._lobbyConn=new LobbyConnection,ge=Y.replace("https://","wss://").replace("http://","ws://"),debug("lobby url: "+ge),xe.next=23,this._lobbyConn.connect(ae,ge,le,ue,te);case 23:return xe.next=25,this._lobbyConn.joinLobby();case 25:this._fsm.joined(),xe.next=35;break;case 28:if(xe.prev=28,xe.t1=xe.catch(15),!this._lobbyConn){xe.next=33;break}return xe.next=33,this._lobbyConn.close();case 33:throw this._fsm.joinFailed(),xe.t1;case 35:case"end":return xe.stop()}},E,this,[[4,11],[15,28]])}));function T(){return _.apply(this,arguments)}return T}()},{key:"leave",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(){return regenerator.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.prev=0,X.next=3,this._lobbyConn.leaveLobby();case 3:return X.prev=3,X.next=6,this._lobbyConn.close();case 6:return X.finish(3);case 7:case"end":return X.stop()}},E,this,[[0,,3,7]])}));function T(){return _.apply(this,arguments)}return T}()},{key:"close",value:function(){var _=_asyncToGenerator(regenerator.mark(function E(){return regenerator.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:if(!this._fsm.can("close")){X.next=3;break}return X.next=3,this._lobbyConn.close();case 3:case"end":return X.stop()}},E,this)}));function T(){return _.apply(this,arguments)}return T}()}]),B}(),DEFAULT_GAME_VERSION="0.0.1";function isInternationalApp(B){var _=B.slice(-9);return _==="-MdYXbMMI"}var Client=function(B){_inherits(_,B);function _(T){_classCallCheck(this,_);var E=_possibleConstructorReturn(this,(_.__proto__||_Object$getPrototypeOf(_)).call(this));if(typeof T.appId!="string")throw new TypeError(T.appId+" is not a string");if(typeof T.appKey!="string")throw new TypeError(T.appKey+" is not a string");if(typeof T.userId!="string")throw new TypeError(T.userId+" is not a string");if(T.feature!==void 0&&typeof T.feature!="string")throw new TypeError(T.feature+" is not a string");if(T.ssl!==void 0&&typeof T.ssl!="boolean")throw new TypeError(T.ssl+" is not a boolean");if(T.gameVersion!==void 0&&typeof T.gameVersion!="string")throw new TypeError(T.gameVersion+" is not a string");if(T.playServer!==void 0&&typeof T.playServer!="string")throw new TypeError(T.playServer+" is not a string");if(T.playServer===void 0&&!isInternationalApp(T.appId))throw new Error("Please init with your server url.");return E._userId=T.userId,E._appId=T.appId,E._appKey=T.appKey,E._feature=T.feature,T.ssl===!1&&(E._insecure=!0),T.gameVersion?E._gameVersion=T.gameVersion:E._gameVersion=DEFAULT_GAME_VERSION,E._playServer=T.playServer,E}return _createClass(_,[{key:"connect",value:function(){return this._lobbyService=new LobbyService(this),this._lobbyService.authorize()}},{key:"reconnect",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){return regenerator.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return q.abrupt("return",this._lobbyService.authorize());case 1:case"end":return q.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"reconnectAndRejoin",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){return regenerator.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(this.room){q.next=2;break}throw new Error("You have no room.");case 2:return q.abrupt("return",this.rejoinRoom(this.room.name));case 3:case"end":return q.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"close",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){return regenerator.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(!this._lobby){q.next=3;break}return q.next=3,this._lobby.close();case 3:if(!this.room){q.next=6;break}return q.next=6,this.room.close();case 6:this._clear();case 7:case"end":return q.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"joinLobby",value:function(){if(this._lobby)throw new Error("You are already in lobby.");return this._lobby=new Lobby(this),this._lobby.join()}},{key:"leaveLobby",value:function(){if(!this._lobby)throw new Error("You are not in lobby yet");return this._lobby.leave()}},{key:"createRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=X.roomName,Y=q===void 0?null:q,te=X.roomOptions,ne=te===void 0?null:te,ae=X.expectedUserIds,le=ae===void 0?null:ae;return regenerator.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!this.room){ge.next=2;break}throw new Error("You are already in room.");case 2:return this._lobby&&this._lobby.close(),this._room=new Room(this),ge.next=6,this.room.create(Y,ne,le);case 6:return ge.abrupt("return",this.room);case 7:case"end":return ge.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"joinRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y=q.expectedUserIds,te=Y===void 0?null:Y;return regenerator.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(!this.room){ae.next=2;break}throw new Error("You are already in room.");case 2:return this._lobby&&this._lobby.close(),this._room=new Room(this),ae.next=6,this.room.join(X,te);case 6:return ae.abrupt("return",this.room);case 7:case"end":return ae.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"rejoinRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){return regenerator.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return this._lobby&&this._lobby.close(),this._room=new Room(this),Y.next=4,this.room.rejoin(X);case 4:return Y.abrupt("return",this.room);case 5:case"end":return Y.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"joinOrCreateRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(X){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Y=q.roomOptions,te=Y===void 0?null:Y,ne=q.expectedUserIds,ae=ne===void 0?null:ne;return regenerator.wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(!this.room){ue.next=2;break}throw new Error("You are already in room.");case 2:return this._lobby&&this._lobby.close(),this._room=new Room(this),ue.next=6,this.room.joinOrCreate(X,te,ae);case 6:return ue.abrupt("return",this.room);case 7:case"end":return ue.stop()}},W,this)}));function E(W){return T.apply(this,arguments)}return E}()},{key:"joinRandomRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},q=X.matchProperties,Y=q===void 0?null:q,te=X.expectedUserIds,ne=te===void 0?null:te;return regenerator.wrap(function(le){for(;;)switch(le.prev=le.next){case 0:if(!this.room){le.next=2;break}throw new Error("You are already in room.");case 2:return this._lobby&&this._lobby.close(),this._room=new Room(this),le.next=6,this.room.joinRandom(Y,ne);case 6:return le.abrupt("return",this.room);case 7:case"end":return le.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"matchRandom",value:function(E){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=W.matchProperties,q=X===void 0?null:X,Y=W.expectedUserIds,te=Y===void 0?null:Y;return this._lobbyService.matchRandom(E,q,te)}},{key:"setRoomOpen",value:function(E){if(!this.room)throw new Error("You are not in room yet.");return this.room.setOpen(E)}},{key:"setRoomVisible",value:function(E){if(!this.room)throw new Error("You are not in room yet.");return this.room.setVisible(E)}},{key:"setRoomMaxPlayerCount",value:function(E){if(!this.room)throw new Error("You are not in room yet.");return this.room.setMaxPlayerCount(E)}},{key:"setRoomExpectedUserIds",value:function(E){if(!this.room)throw new Error("You are not in room yet.");return this.room.setExpectedUserIds(E)}},{key:"clearRoomExpectedUserIds",value:function(){if(!this.room)throw new Error("You are not in room yet.");return this.room.clearExpectedUserIds()}},{key:"addRoomExpectedUserIds",value:function(E){if(!this.room)throw new Error("You are not in room yet.");return this.room.addExpectedUserIds(E)}},{key:"removeRoomExpectedUserIds",value:function(E){if(!this.room)throw new Error("You are not in room yet.");return this.room.removeExpectedUserIds(E)}},{key:"setMaster",value:function(E){if(!this.room)throw new Error("You are not in room yet.");return this.room.setMaster(E)}},{key:"sendEvent",value:function(E){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{receiverGroup:ReceiverGroup.All};if(!this.room)throw new Error("You are not in room yet.");return this.room.sendEvent(E,W,X)}},{key:"leaveRoom",value:function(){var T=_asyncToGenerator(regenerator.mark(function W(){return regenerator.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:if(this.room){q.next=2;break}throw new Error("You are not in room yet.");case 2:return q.next=4,this.room.leave();case 4:case"end":return q.stop()}},W,this)}));function E(){return T.apply(this,arguments)}return E}()},{key:"kickPlayer",value:function(E){var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},X=W.code,q=X===void 0?null:X,Y=W.msg,te=Y===void 0?null:Y;if(!this.room)throw new Error("You are not in room yet.");return this.room.kickPlayer(E,{code:q,msg:te})}},{key:"pauseMessageQueue",value:function(){if(!this.room)throw new Error("You are not in room yet.");this.room.pauseMessageQueue()}},{key:"resumeMessageQueue",value:function(){if(!this.room)throw new Error("You are not in room yet.");this.room.resumeMessageQueue()}},{key:"_clear",value:function(){this.removeAllListeners(),this._lobbyRoomList=null,this._masterServer=null,this._gameServer=null,this._lobby=null,this._room=null}},{key:"_simulateDisconnection",value:function(){if(!this.room)throw new Error("You are not in room yet.");return this.room._simulateDisconnection()}},{key:"room",get:function(){return this._room}},{key:"player",get:function(){if(!this.room)throw new Error("You are not in room yet.");return this.room._player}},{key:"lobbyRoomList",get:function(){if(!this._lobby)throw new Error("You are not in lobby yet.");return this._lobby._lobbyRoomList}},{key:"userId",get:function(){return this._userId}}]),_}(eventemitter3),CreateRoomFlag={FixedMaster:1,MasterUpdateRoomProperties:2};exports.Client=Client,exports.CreateRoomFlag=CreateRoomFlag,exports.Event=Event,exports.LogLevel=LogLevel,exports.PlayError=PlayError,exports.PlayErrorCode=PlayErrorCode,exports.Player=Player,exports.ReceiverGroup=ReceiverGroup,exports.Room=Room,exports.deserializeObject=deserializeObject,exports.registerType=registerType,exports.serializeObject=serializeObject,exports.setAdapters=setAdapters,exports.setLogger=setLogger,Object.defineProperty(exports,"__esModule",{value:!0})})})(play,play.exports);var playExports=play.exports;class TetrisPlayer{constructor(_={}){this.userId=_.userId,this.actorId=_.actorId||null,this.isMaster=_.isMaster||!1,this.isRobot=_.isRobot||!1,this.customProperties=_.customProperties||{}}static generateUserId(_){const T=Math.floor(Math.random()*100).toString().padStart(2,"0"),E=(Date.now()%100).toString().padStart(2,"0");return`${_}${T}${E}`}static fromJson(_){return new TetrisPlayer({userId:_.userId,isRobot:_.isRobot,customProperties:_.customProperties})}toJson(){return{userId:this.userId,isRobot:this.isRobot,customProperties:this.customProperties}}}const TetrisEvents={PlayerChanged:"playerChanged"},NetEventId={StartGame:1,SyncRobots:2},APP_ID="tQwiRbYg8otBOPgaCK273AnT-gzGzoHsz",APP_KEY="ByK7t7CGtjc4zRip17NiffHI",PLAY_SERVER="https://tqwirbyg.lc-cn-n1-shared.com",GAME_VERSION="1.0.0",NetState={IDLE:"idle",CONNECTING:"connecting",CONNECTED:"connected",JOINING:"joining",IN_ROOM:"in_room"};class TetrisNet{constructor(_){this.game=_,this.client=null,this.state=NetState.IDLE}init(){}async connect(){if(this.state===NetState.IDLE)try{this.state=NetState.CONNECTING,this.client=new playExports.Client({appId:APP_ID,appKey:APP_KEY,playServer:PLAY_SERVER,userId:this.game.userId,gameVersion:GAME_VERSION}),this.setupEventListeners(),await this.client.connect(),this.state===NetState.CONNECTING&&(this.state=NetState.CONNECTED,await this.joinRoom())}catch(_){console.error(":",_),this.state=NetState.IDLE,this.game.Toast("")}}setupEventListeners(){this.client&&(this.client.on("connected",()=>{console.log("")}),this.client.on(playExports.Event.PLAYER_ROOM_JOINED,_=>{console.log(":",_),this.syncPlayerListToLocal()}),this.client.on(playExports.Event.PLAYER_ROOM_LEFT,_=>{console.log(":",_),this.syncPlayerListToLocal()}),this.client.on(playExports.Event.PLAYER_CUSTOM_PROPERTIES_CHANGED,_=>{console.log(":",_),this.syncPlayerListToLocal()}),this.client.on(playExports.Event.CUSTOM_EVENT,_=>{this.handleCustomEvent(_)}),this.client.on(playExports.Event.DISCONNECTED,()=>{console.warn(""),this.state!==NetState.IDLE&&(this.state=NetState.IDLE,this.game.Toast(""))}),this.client.on(playExports.Event.ERROR,_=>{console.error("Play :",_)}))}async joinRoom(){if(!this.client){console.warn("");return}if(this.state!==NetState.CONNECTED){console.warn("");return}try{this.state=NetState.JOINING;const _=await this.client.joinRandomRoom();this.onRoomJoined(_)}catch(_){if(this.state===NetState.JOINING)if(_.code===4301){console.log("");const T={maxPlayerCount:10,playerTtl:120},E=await this.client.createRoom({roomOptions:T});this.onRoomJoined(E)}else console.error(":",_),this.state=NetState.CONNECTED,this.game.Toast("")}}onRoomJoined(_){console.log(""),this.state=NetState.IN_ROOM,this.syncPlayerListToLocal(),this.game.replaceView("TetrisRoomView")}syncPlayerListToLocal(){if(!(!this.client||this.state!==NetState.IN_ROOM))try{const _=this.client.room;if(!_)return;const T=_.playerList||[];this.game.syncFromLean(T)}catch(_){console.error(":",_)}}sendEvent(_,T,E=playExports.ReceiverGroup.All){if(!this.client||this.state!==NetState.IN_ROOM){console.warn("");return}try{const W={receiverGroup:E};this.client.sendEvent(_,T,W)}catch(W){console.error(":",W)}}handleCustomEvent(_){const{eventId:T,eventData:E,senderId:W}=_;console.log(":",T,E,W),T===NetEventId.StartGame?(this.game.GameStartOption.initByMulti(E),this.game.replaceView("TetrisGameView")):T===NetEventId.SyncRobots&&E&&E.robots&&E.robots.forEach(X=>{this.game.players.find(q=>q.userId===X.userId)||this.game.players.push(TetrisPlayer.fromJson(X))})}async leaveRoom(){!this.client||this.state!==NetState.IN_ROOM||(this.state=NetState.CONNECTED,this.client.leaveRoom())}async close(){try{this.client&&(this.state===NetState.IN_ROOM&&await this.client.leaveRoom(),this.client.close()),this.client=null,this.state=NetState.IDLE,console.log("")}catch(_){console.error(":",_)}}}class TetrisStartView extends Container{constructor(_){super(),this.game=_}init(){this.initTitle(),this.singlePlayerButton=new TetrisButton(this.game,"Single Player",()=>{this.game.GameStartOption.initBySingle(),this.game.replaceView("TetrisGameView")}),this.singlePlayerButton.position.set(0,30),this.addChild(this.singlePlayerButton),this.matchPlayerButton=new TetrisButton(this.game,"Match Player",()=>{this.joinMatch()}),this.matchPlayerButton.position.set(0,90),this.addChild(this.matchPlayerButton),this.clickMatchCount=0,this.animationTime=0,this.tagUpdate=this.update.bind(this),this.game.pixi.ticker.add(this.tagUpdate,this)}async joinMatch(){this.clickMatchCount++,this.game.net.state===NetState.IDLE?this.game.net.connect():this.game.net.state===NetState.CONNECTED&&this.game.net.joinRoom(),this.clickMatchCount>=2&&(this.game.net.state===NetState.CONNECTING?this.game.Toast("..."):this.game.net.state===NetState.CONNECTED?this.game.Toast("..."):this.game.net.state===NetState.JOINING&&this.game.Toast("..."))}initTitle(){const E=[{pattern:this.getTPattern(),colorIndex:0},{pattern:this.getEPattern(),colorIndex:1},{pattern:this.getTPattern(),colorIndex:2},{pattern:this.getRPattern(),colorIndex:3},{pattern:this.getIPattern(),colorIndex:4},{pattern:this.getSPattern(),colorIndex:5}];let W=0;E.forEach(ne=>{W+=ne.pattern[0].length*20}),W+=(E.length-1)*5;const X=6,q=8;this.titleTiles=[];for(let ne=0;ne<=X;ne++)this.titleTiles[ne]=[];const Y=-100;let te=-W/2;E.forEach((ne,ae)=>{const le=ne.pattern[0].length*20,ue=ne.pattern.length*20;for(let ge=0;ge<ne.pattern.length;ge++)for(let ye=0;ye<ne.pattern[ge].length;ye++)if(ne.pattern[ge][ye]){const xe="tetris/tile"+(ne.colorIndex+1)+".png",Te=this.game.textures[xe];if(Te){const Ae=new Sprite$1(Te);Ae.anchor.set(.5,.5);const Ie=te+ye*20+20/2,Ve=Y+ge*20+20/2-ue/2;Ae.position.set(Ie,Ve),this.addChild(Ae);const $e=ge,We=(X-$e)/X,Ue=q*We;this.titleTiles[$e].push({sprite:Ae,baseX:Ie,amplitude:Ue})}}te+=le+5})}update(_){this.animationTime+=_;const T=.02;for(let E=0;E<this.titleTiles.length;E++){const W=this.animationTime*T;for(let X=0;X<this.titleTiles[E].length;X++){const q=this.titleTiles[E][X],Y=q.baseX+Math.sin(W)*q.amplitude;q.sprite.position.x=Y}}}getTPattern(){return[[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0],[0,0,1,0,0]]}getEPattern(){return[[1,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,0],[1,0,0,0,0],[1,0,0,0,0],[1,1,1,1,1]]}getRPattern(){return[[1,1,1,1,0],[1,0,0,0,1],[1,0,0,0,1],[1,1,1,1,0],[1,0,1,0,0],[1,0,0,1,0],[1,0,0,0,1]]}getIPattern(){return[[1,1,1],[0,1,0],[0,1,0],[0,1,0],[0,1,0],[0,1,0],[1,1,1]]}getSPattern(){return[[0,1,1,1,1],[1,0,0,0,0],[1,0,0,0,0],[0,1,1,1,0],[0,0,0,0,1],[0,0,0,0,1],[1,1,1,1,0]]}safeRemoveSelf(){this.tagUpdate&&this.game.pixi.ticker.remove(this.tagUpdate,this),this.parent.removeChild(this)}}const TEXT_STYLE=new TextStyle({fontFamily:"Comic Sans MS, Marker Felt, Chalkduster, cursive",fontSize:18,fill:0,align:"center"}),TITLE_STYLE=new TextStyle({fontFamily:"Comic Sans MS, Marker Felt, Chalkduster, cursive",fontSize:32,fill:0,fontWeight:"bold",align:"center"});class TetrisRoomView extends Container{constructor(_){super(),this.game=_,this.playerItems=[],this.isMaster=!1}init(){this.initTitle(),this.initPlayerList(),this.initButtons(),this.onPlayerChangedCallback=this.onPlayerChanged.bind(this),this.game.on(TetrisEvents.PlayerChanged,this.onPlayerChangedCallback),this.updatePlayerList(),this.updateButtons()}initTitle(){this.titleContainer=new Container,this.titleContainer.position.set(0,-200),this.addChild(this.titleContainer);const _=new Text$1("",TITLE_STYLE);_.anchor.set(.5,.5),this.titleContainer.addChild(_)}initPlayerList(){this.playerListContainer=new Container,this.playerListContainer.position.set(0,-50),this.addChild(this.playerListContainer)}updatePlayerList(){this.playerItems.forEach(E=>{var W;(W=E.container)!=null&&W.parent&&E.container.parent.removeChild(E.container)}),this.playerItems=[];const _=this.game.players||[];if(_.length===0){const E=new Text$1("...",TEXT_STYLE);E.anchor.set(.5,.5),this.playerListContainer.addChild(E);return}const T=_.find(E=>E.userId===this.game.userId);this.isMaster=(T==null?void 0:T.isMaster)||!1,_.forEach((E,W)=>{const X=this.createPlayerItem(E,W);this.playerListContainer.addChild(X),this.playerItems.push({container:X,player:E})})}createPlayerItem(_,T){const E=new Container;E.position.set(0,T*50);const W=new Graphics;W.beginFill(0,.5),W.drawRoundedRect(-125,-20,250,40,8),W.endFill(),E.addChild(W);let X=_.isRobot?` ${_.userId}`:_.userId;_.isMaster&&(X=" "+X),_.userId===this.game.userId&&(X+=" ()");const q=new Text$1(X,TEXT_STYLE);return q.anchor.set(.5,.5),E.addChild(q),E}initButtons(){this.buttonContainer=new Container,this.buttonContainer.position.set(0,150),this.addChild(this.buttonContainer),this.startButton=new TetrisButton(this.game,"",()=>{this.startGame()}),this.waitingText=new Text$1("",TEXT_STYLE),this.waitingText.anchor.set(.5,.5),this.updateButtons()}updateButtons(){this.buttonContainer.removeChildren(),this.isMaster?this.buttonContainer.addChild(this.startButton):this.buttonContainer.addChild(this.waitingText)}onPlayerChanged(){this.updatePlayerList(),this.updateButtons()}startGame(){if(!this.isMaster){console.warn("");return}this.game.fillRobotPlayers();const _=Date.now(),T={shapeGeneratorSeed:String(1e3),startTime:String(_)};this.game.net.sendEvent(NetEventId.StartGame,T)}safeRemoveSelf(){this.onPlayerChangedCallback&&this.game.off(TetrisEvents.PlayerChanged,this.onPlayerChangedCallback),this.removeChildren(),this.parent&&this.parent.removeChild(this)}}class TetrisGameStartOption{constructor(){this.singleMode=!0,this.startTime=Date.now(),this.shapeGeneratorSeed=Date.now(),this.frames=[]}get StartTime(){return this.startTime}set StartTime(_){this.startTime=_}get ShapeGeneratorSeed(){return this.shapeGeneratorSeed}set ShapeGeneratorSeed(_){this.shapeGeneratorSeed=_}get SingleMode(){return this.singleMode}set SingleMode(_){this.singleMode=_}get Frames(){return this.frames}AddFrame(_){this.frames.push(_)}initBySingle(){this.ShapeGeneratorSeed=Date.now(),this.StartTime=Date.now(),this.SingleMode=!0}initByMulti(_){this.ShapeGeneratorSeed=_.shapeGeneratorSeed?Number(_.shapeGeneratorSeed):Date.now(),this.StartTime=_.startTime?Number(_.startTime):Date.now(),this.SingleMode=!1}}class TetrisGame{init(_,T){initDom(_,{designWidth:960,designHeight:540,isFullScreen:!1}),this.pixi=createPixi(_,{backgroundAlpha:0}),this.root=new Container,this.pixi.stage.addChild(this.root),this.root.position.set(this.pixi.screen.width/2,this.pixi.screen.height/2),this.uiRoot=new Container,this.root.addChild(this.uiRoot),this.toastRoot=new Container,this.root.addChild(this.toastRoot),this.toasts=[],this.textures=T,this.userId=TetrisPlayer.generateUserId("Player"),this.eventListeners={},this.players=[],this.net=new TetrisNet(this),this.net.init(),this.gameStartOption=new TetrisGameStartOption,this.viewCreators={TetrisStartView,TetrisGameView,TetrisRoomView},this.pixi.ticker.add(this.update,this),this.replaceView("TetrisStartView")}syncFromLean(_){this.players=_.map(T=>new TetrisPlayer(T)),this._notifyPlayerChanged()}fillRobotPlayers(){const _=[],T=2-this.players.length;if(!(T<=0)){for(let E=0;E<T;E++){const W={userId:TetrisPlayer.generateUserId("Robot"),isRobot:!0};_.push(W)}this.net.sendEvent(NetEventId.SyncRobots,{robots:_})}}findPlayer(_){return this.players.find(T=>T.userId===_)||null}getMyPlayer(){return this.findPlayer(this.userId)}getMyPlayerIndex(){return this.players.findIndex(_=>_.userId===this.userId)}_notifyPlayerChanged(){this.emit(TetrisEvents.PlayerChanged,{players:this.players})}get GameStartOption(){return this.gameStartOption}update(_){update()}replaceView(_){this.currentView&&(this.currentView.safeRemoveSelf(),this.currentView=null);let T=this.viewCreators[_];this.currentView=new T(this),this.currentView.init(),this.uiRoot.addChild(this.currentView)}on(_,T){return this.eventListeners[_]||(this.eventListeners[_]=[]),this.eventListeners[_].push(T),T}off(_,T){if(!this.eventListeners[_])return;const E=this.eventListeners[_].indexOf(T);E>-1&&this.eventListeners[_].splice(E,1)}emit(_,T){if(!this.eventListeners[_])return;[...this.eventListeners[_]].forEach(W=>{W(_,T)})}Toast(_){const T=new Container,E=new TextStyle({fontFamily:"Arial",fontSize:24,fill:16777215,align:"center"}),W=new Text$1(_,E);W.anchor.set(.5,.5);const X=40,q=12,Y=Math.max(W.width+X*2,200),te=W.height+q*2,ne=new Graphics;ne.beginFill(0,.7),ne.drawRoundedRect(-Y/2,-te/2,Y,te,8),ne.endFill(),T.addChild(ne),T.addChild(W),T.position.set(0,0),T.alpha=0,this.toastRoot.addChild(T),this.toasts.forEach(ae=>{new Tween(ae).to({y:ae.y-60},200).start()}),this.toasts.push(T),new Tween(T).to({alpha:1},200).onComplete(()=>{setTimeout(()=>{new Tween(T).to({alpha:0,y:T.y-30},300).onComplete(()=>{const ae=this.toasts.indexOf(T);ae>-1&&this.toasts.splice(ae,1),this.toastRoot.removeChild(T)}).start()},2e3)}).start()}}const _hoisted_1$1={class:"game-container"},_sfc_main$1={__name:"TetrisMain",setup(B){const _=ref$1(null),T=ref$1(["tetris/bg_center_up.png","tetris/bg_center.png","tetris/bg_r_1.png","tetris/bg_total.png","tetris/tile1.png","tetris/tile2.png","tetris/tile3.png","tetris/tile4.png","tetris/tile5.png","tetris/tile6.png","tetris/tile7.png","tetris/arrow.png","tetris/circle.png","tetris/button.png"]);let E=new TetrisGame;const W=X=>{E.init(_.value,X),window.game=E};return onUnmounted(()=>{E&&E.net&&E.net.close()}),(X,q)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createVNode(PixiLoader,{textureUrls:T.value,onLoaded:W},null,8,["textureUrls"]),createBaseVNode("canvas",{ref_key:"gameContainer",ref:_},null,512)]))}},_hoisted_1=createBaseVNode("div",{class:"loading"},"...",-1),_hoisted_2={key:1,style:{padding:"24px"}},_hoisted_3={style:{"margin-bottom":"16px"}},_hoisted_4={style:{"text-align":"center",width:"100%"}},_hoisted_5={style:{"font-size":"18px","font-weight":"500","margin-bottom":"8px"}},_hoisted_6=["src"],_sfc_main={__name:"App",setup(B){const _=[{name:"",children:[{id:"CoinKnight",title:"",comp:_sfc_main$d,link:"CoinKnight/index.html",img:"preview/CoinKnight.png"},{id:"FarmMine",title:"",comp:_sfc_main$d,link:"FarmMine/index.html",img:"preview/FarmMine.png"},{id:"jigsaw",title:"",comp:_sfc_main$d,link:"jigsaw/index.html",img:"preview/jigsaw.png"},{id:"BallGame",title:"",comp:_sfc_main$8,img:"preview/BallGame.png"},{id:"GameMatch",title:"GameMatch",comp:_sfc_main$2,img:"preview/GameMatch.png"},{id:"Game2048",title:"Game2048",comp:_sfc_main$4,img:"preview/Game2048.png"},{id:"TankGame",title:"",comp:_sfc_main$e,img:"preview/TankMain.png"},{id:"TetrisMain",title:"",comp:_sfc_main$1,img:"preview/tetris.png"}]},{name:"",children:[{id:"TrigoCalc",title:"",comp:_sfc_main$c,img:"preview/TrigoCalc.png"},{id:"SplitImage",title:"SplitImage",comp:SplitImage,img:"preview/SplitImage.png"}]},{name:"Blender",children:[{id:"d-puzzle",title:"",comp:_sfc_main$9,link:"video/puzzle.mp4"},{id:"d-ice",title:"",comp:_sfc_main$9,link:"video/ice.mp4"},{id:"d-door",title:"",comp:_sfc_main$9,link:"video/door.mp4"}]},{name:"shader",children:[{id:"ShaderFragBase",title:"Shader-",comp:ShaderFragBase},{id:"ShaderImageBase",title:"Shader-",comp:ShaderImageBase}]},{name:"",children:[{id:"CurveRope",title:"(Three)",comp:_sfc_main$6},{id:"CurveRopePixi",title:"(Pixi)",comp:_sfc_main$5}]},{name:"",children:[{id:"ThreeHello",title:"ThreeHello",comp:_sfc_main$7}]}],T=ref$1(window.location.hash.slice(1));window.addEventListener("hashchange",()=>{T.value=window.location.hash.slice(1),document.title="Project:"+T.value});const E=[..._.flatMap(Y=>Y.children)],W=computed(()=>E.find(Y=>Y.id===T.value)),X=computed(()=>{var Y;return(Y=W.value)==null?void 0:Y.comp});function q(Y){window.location.hash=Y.id}return(Y,te)=>X.value?(openBlock(),createBlock(Suspense,{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(X.value),normalizeProps(guardReactiveProps(W.value.link?{link:W.value.link}:{})),null,16))]),fallback:withCtx(()=>[_hoisted_1]),_:1})):(openBlock(),createElementBlock("div",_hoisted_2,[(openBlock(),createElementBlock(Fragment,null,renderList(_,ne=>createBaseVNode("div",{key:ne.name,style:{"margin-top":"32px"}},[createBaseVNode("h2",_hoisted_3,toDisplayString(ne.name),1),createVNode(unref(viewuiplus_minExports.Row),{gutter:16},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(ne.children,ae=>(openBlock(),createBlock(unref(viewuiplus_minExports.Col),{key:ae.id,span:4,xs:12,sm:8,md:6,lg:4,xl:4},{default:withCtx(()=>[ae.img?(openBlock(),createBlock(unref(viewuiplus_minExports.Card),{key:0,bordered:!1,style:{"margin-bottom":"24px",cursor:"pointer","min-height":"220px",padding:"0",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center","box-sizing":"border-box"},onClick:le=>q(ae)},{default:withCtx(()=>[createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,toDisplayString(ae.title),1),ae.img?(openBlock(),createElementBlock("img",{key:0,src:ae.img,alt:"",style:{width:"100%",height:"auto","object-fit":"contain","margin-bottom":"0",border:"2px solid #e5e6eb","border-radius":"16px","box-sizing":"border-box",background:"#fafbfc"}},null,8,_hoisted_6)):createCommentVNode("",!0)])]),_:2},1032,["onClick"])):(openBlock(),createBlock(unref(viewuiplus_minExports.Button),{key:1,long:"",onClick:le=>q(ae),style:{"margin-bottom":"24px","font-size":"16px","min-height":"60px"}},{default:withCtx(()=>[createTextVNode(toDisplayString(ae.title),1)]),_:2},1032,["onClick"]))]),_:2},1024))),128))]),_:2},1024)])),64))]))}};var app=createApp(_sfc_main);app.use(ViewUIPlus);app.use(Yr$1);app.mount("#app")});export default oM();
