window.__require=function e(t,n,a){function o(c,s){if(!n[c]){if(!t[c]){var r=c.split("/");if(r=r[r.length-1],!t[r]){var d="function"==typeof __require&&__require;if(!s&&d)return d(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+c+"'")}c=r}var h=n[c]={exports:{}};t[c][0].call(h.exports,function(e){return o(t[c][1][e]||e)},h,h.exports,e,t,n,a)}return n[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<a.length;c++)o(a[c]);return o}({Border:[function(e,t,n){"use strict";cc._RF.push(t,"b31e3Yz+7RAW4M14DzazqA3","Border"),cc.Class({extends:cc.Component,properties:{},start:function(){this.gameScene=ck.getGameScene()},update:function(){this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.TouchDoor&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead&&this.gameScene.player.getWorldPosition().y<this.getWorldLeftBottom().y&&this.gameScene.player.setDead(!0)},getWorldLeftBottom:function(){var e=new cc.Vec2(-this.node.width/2,-this.node.height/2);return this.node.convertToWorldSpaceAR(e)},getWorldRightBottom:function(){var e=new cc.Vec2(this.node.width/2,-this.node.height/2);return this.node.convertToWorldSpaceAR(e)},getLeftBottomRelativeNodeParent:function(e){var t=this.getWorldLeftBottom();return this.node.parent.convertToNodeSpaceAR(t)},getRightBottomRelativeNodeParent:function(e){var t=this.getWorldRightBottom();return this.node.parent.convertToNodeSpaceAR(t)},width:function(){return this.node.width},height:function(){return this.node.height}}),cc._RF.pop()},{}],Brick:[function(e,t,n){"use strict";cc._RF.push(t,"a837bQZR39DmqyV95L8b6zE","Brick"),cc.Class({extends:cc.Component,properties:{},start:function(){this.gameScene=ck.getGameScene()},onCollisionEnter:function(e,t){if(this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.TouchDoor&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead){var n=e.node.getComponent("Player"),a=e.world.aabb,o=e.world.preAabb.clone(),i=t.world.aabb,c=t.world.preAabb.clone();c.x=i.x,o.x=a.x,cc.Intersection.rectRect(c,o)?n.getHDirection()===ck.PlayerDirection.Left?n.setHDirection(ck.PlayerDirection.Right):n.getHDirection()===ck.PlayerDirection.Right&&n.setHDirection(ck.PlayerDirection.Left):(c.y=i.y,o.y=a.y,cc.Intersection.rectRect(c,o)&&(ck.log("collision","brick.y"),n.getVDirection()===ck.PlayerDirection.Down?(n.putColliderAbovePlatformWorldY(i.yMax),this.resetPlayerDropDown=!0):n.getVDirection()===ck.PlayerDirection.Up&&(n.putColliderUnderWorldY(i.yMin),n.stopJump())))}},onCollisionExit:function(e,t){this.resetPlayerDropDown&&(e.node.getComponent("Player").setNeedDropDown(!0),this.resetPlayerDropDown=!1)}}),cc._RF.pop()},{}],CameraFollowPlayer:[function(e,t,n){"use strict";cc._RF.push(t,"e52cbX0jDxOxZSh1sZG+QRR","CameraFollowPlayer"),cc.Class({extends:cc.Component,properties:{},start:function(){this.gameScene=ck.getGameScene()},update:function(e){if(this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.TouchDoor&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead&&this.gameScene.player){var t=ck.localToLocalSpace(this.gameScene.player.node,this.node.parent),n=this.gameScene.border.getLeftBottomRelativeNodeParent(this.node),a=this.gameScene.border.getRightBottomRelativeNodeParent(this.node);t.x-cc.winSize.width/2<n.x&&(t.x=n.x+cc.winSize.width/2),t.y-cc.winSize.height/2<n.y&&(t.y=n.y+cc.winSize.height/2),t.x+cc.winSize.width/2>a.x&&(t.x=a.x-cc.winSize.width/2),this.node.position=t}}}),cc._RF.pop()},{}],ChooseButton:[function(e,t,n){"use strict";cc._RF.push(t,"286bcJO2pVLwqp3lHkB1xh9","ChooseButton"),cc.Class({extends:cc.Component,properties:{m_label:cc.Label,m_lock:cc.Node},start:function(){},init:function(e,t,n){this.m_label.string=""+e,this.m_lock.active=t,this.index=e,this.locked=t,this.callback=n},onClickButton:function(e){this.locked||this.callback(this.index)}}),cc._RF.pop()},{}],ChooseScene:[function(e,t,n){"use strict";cc._RF.push(t,"c9e19TMMq9ETaajpJpFd1VJ","ChooseScene"),cc.Class({extends:cc.Component,properties:{buttonPrefab:{default:null,type:cc.Prefab},buttonSound:{default:null,type:cc.AudioClip}},start:function(){this.m_buttonNode=cc.find("Canvas/m_buttonNode");for(var e=new cc.Size(120,120),t=0;t<=ck.userData.maxLevel;++t){var n=cc.instantiate(this.buttonPrefab);n.getComponent("ChooseButton").init(t,t>ck.userData.canPlayLevel,this.onClickLevel.bind(this)),n.parent=this.m_buttonNode,n.x=Math.floor(t%4)*e.width,n.y=-Math.floor(t/4)*e.height,ck.log("button",t,n.x,n.y)}},onClickLevel:function(e){cc.audioEngine.play(this.buttonSound),cc.director.loadScene("GameScene",this.onLoadGameScene.bind(this,e))},onLoadGameScene:function(e){ck.getGameScene().startLevel(e)}}),cc._RF.pop()},{}],CoinKnight:[function(e,t,n){"use strict";cc._RF.push(t,"ccdeegGODRLdo5NnDQ/Rs/S","CoinKnight");var a=e("./UserData");window.ck={getGameScene:function(){return cc.find("Canvas").getComponent("GameScene")},setPositionX:function(e,t){e.position=new cc.Vec2(t,e.position.y)},setPositionY:function(e,t){e.position=new cc.Vec2(e.position.x,t)},setScaleX:function(e,t){e.scale=new cc.Vec2(t,e.scale.y)},setScaleY:function(e,t){e.scale=new cc.Vec2(e.scale.x,t)},log:function(){var e=[];e.push("frame=".concat(cc.director.getTotalFrames()," "));for(var t=0;t<arguments.length;++t)null===arguments[t]?e.push("null"):void 0===arguments[t]?e.push("undefined"):e.push(arguments[t].toString());cc.log.apply(null,e)},world:function(e){return e.convertToWorldSpaceAR(new cc.Vec2(0,0))},delayCall:function(e,t,n){cc.tween(e).delay(t).call(n).start()},localToLocalSpace:function(e,t,n){n||(n=new cc.Vec2(0,0));var a=e.convertToWorldSpaceAR(n);return t.convertToNodeSpaceAR(a)},GameState:{Prepare:"Prepare",Gaming:"Gaming",FindDoor:"FindDoor",TouchDoor:"TouchDoor",Finished:"Finished",Dead:"Dead"},PlayerDirection:{Left:"Left",Right:"Right",Up:"Up",Down:"Down"},Event:{GameStateChanged:"GameStateChanged"},userData:new a},cc._RF.pop()},{"./UserData":"UserData"}],Coin:[function(e,t,n){"use strict";cc._RF.push(t,"e779bOnpDVOr6D0Q0jynVIM","Coin"),cc.Class({extends:cc.Component,properties:{},start:function(){this.gameScene=ck.getGameScene()},onCollisionEnter:function(e,t){this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.TouchDoor&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead&&(this.node.removeFromParent(),this.node.getComponent(cc.AudioSource).play(),ck.getGameScene().checkWin())}}),cc._RF.pop()},{}],Door:[function(e,t,n){"use strict";cc._RF.push(t,"12c64NvepVHOLvX4+xz5YQ2","Door"),cc.Class({extends:cc.Component,properties:{image:cc.Node},start:function(){this.image.active=!1,this.gameScene=ck.getGameScene(),this.gameScene.node.on(ck.Event.GameStateChanged,this.onGameStateChanged,this)},onGameStateChanged:function(){var e=this;this.gameScene.data.state==ck.GameState.FindDoor&&(this.node.getComponent(cc.Animation).play("door_appear"),ck.delayCall(this.node,.1,function(){e.image.active=!0}))},onCollisionEnter:function(e,t){this.canCollision&&this.gameScene.data.state==ck.GameState.FindDoor&&(this.node.getComponent(cc.Animation).play("door_disappear"),this.gameScene.data.setState(ck.GameState.TouchDoor))},onAppearFinished:function(){this.canCollision=!0},onDisappearFinished:function(){this.gameScene.data.setWin(!0),this.gameScene.data.setState(ck.GameState.Finished),this.node.active=!1}}),cc._RF.pop()},{}],Fire:[function(e,t,n){"use strict";cc._RF.push(t,"52c4b/gJehKg5uMSyQj0QwJ","Fire"),cc.Class({extends:cc.Component,properties:{},start:function(){this.gameScene=ck.getGameScene()},onCollisionEnter:function(e,t){this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.TouchDoor&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead&&e.node.getComponent("Player").setDead(!0)}}),cc._RF.pop()},{}],GameSceneData:[function(e,t,n){"use strict";cc._RF.push(t,"ef0b8ChC8VJtLHFc8/AgKSM","GameSceneData"),cc.Class({extends:cc.Component,ctor:function(){this.isWin=!1,this.state=ck.GameState.Prepare},init:function(e){this.level=e},setWin:function(e){this.isWin=e},setState:function(e){ck.log("setState",e),this.state=e,this.node.emit(ck.Event.GameStateChanged)}}),cc._RF.pop()},{}],GameScene:[function(e,t,n){"use strict";cc._RF.push(t,"d83ba1ZqLxE1JLlGHZqZlPf","GameScene"),cc.Class({extends:cc.Component,properties:{buttonSound:{type:cc.AudioClip,default:null},jumpSound:{type:cc.AudioClip,default:null},next:{type:cc.Node,default:null}},ctor:function(){},start:function(){cc.director.getCollisionManager().enabled=!0,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(ck.Event.GameStateChanged,this.onGameStateChanged,this)},onTouchStart:function(){this.data&&this.data.state!=ck.GameState.Finished&&this.player.canJump()&&this.player.startJump()},startLevel:function(e){ck.log("startLevel",e),this.mapNode=this.node.getChildByName("New Node").getChildByName("mapNode"),this.clearLevel(),this.data=this.node.addComponent("GameSceneData"),this.data.init(e),this.map=null,this.next.active=!1;var t="map".concat(e);cc.loader.loadRes(t,function(e,t){if(e)return ck.log(e),void cc.director.loadScene("StartScene");this.map=cc.instantiate(t),this.mapNode.addChild(this.map),this.onLoadMapFinished()}.bind(this))},clearLevel:function(){this.data=null,this.mapNode.stopAllActions(),this.mapNode.removeAllChildren(),this.mapNode.position=new cc.Vec3(0,0,0),this.border=null,this.coins=null,this.player=null},onLoadMapFinished:function(){ck.log("\u52a0\u8f09\u7b2c".concat(this.data.level,"\u95dc\u5b8c\u6210")),this.border=this.map.getChildByName("border").getComponent("Border"),this.coins=this.map.getChildByName("coins"),this.player=this.map.getChildByName("player").getComponent("Player");var e=new cc.Rect(0,0,this.border.width(),this.border.height());this.followTag=this.mapNode.runAction(cc.follow(this.player.node,e)),this.data.setState(ck.GameState.Gaming)},onGameStateChanged:function(){this.data.state===ck.GameState.Finished?(this.onGameFinished(),this.showEndDialog()):this.data.state===ck.GameState.Dead&&ck.delayCall(this.node,2,this.onPlayerDead.bind(this))},onGameFinished:function(){this.data.isWin&&this.data.level>=ck.userData.canPlayLevel&&ck.userData.setCanPlayLevel(this.data.level+1)},showEndDialog:function(){this.next.active=!0},onPlayerDead:function(){this.startLevel(this.data.level)},onNextLevel:function(){this.data.level===ck.userData.maxLevel?cc.director.loadScene("StartScene"):this.startLevel(this.data.level+1)},checkWin:function(){this.data.state===ck.GameState.Gaming&&0===this.coins.childrenCount&&this.data.setState(ck.GameState.FindDoor)},onClickBack:function(){cc.audioEngine.play(this.buttonSound),cc.director.loadScene("StartScene")},onDirectPass:function(){this.data.setWin(!0),this.data.setState(ck.GameState.Finished)},onClickNext:function(){cc.audioEngine.play(this.buttonSound),this.onNextLevel()}}),cc._RF.pop()},{}],Map:[function(e,t,n){"use strict";cc._RF.push(t,"0bdddKOlw5DRKSD6Q6K8F4E","Map"),cc.Class({extends:cc.Component,properties:{doorPrefab:cc.Prefab},start:function(){var e=cc.instantiate(this.doorPrefab);this.node.getChildByName("door").addChild(e)}}),cc._RF.pop()},{}],Player:[function(e,t,n){"use strict";cc._RF.push(t,"6d134Jqvg1A362z5BA/OUNl","Player"),cc.Class({extends:cc.Component,properties:{roleAnim:{type:cc.Animation,default:null}},ctor:function(){this.startJumpVelocity=850,this.pullForce=2e3,this.speed=new cc.Vec2(256,0)},onLoad:function(){},start:function(){this.gameScene=ck.getGameScene(),this.roleAnim=cc.find("role1",this.node).getComponent(cc.Animation),this.gameScene.node.on(ck.Event.GameStateChanged,this.onGameStateChanged,this),this.setHDirection(ck.PlayerDirection.Right),this.stopJump(),this.setNeedDropDown(!0)},onPositionChanged:function(){ck.log("onPositionChanged","frame=".concat(cc.director.getTotalFrames()),this.node.position)},onGameStateChanged:function(){this.gameScene.data.state===ck.GameState.TouchDoor&&(ck.log("Player.active = false"),this.node.active=!1)},setDead:function(){this.dead||(this.dead=!0,this.gameScene.data.setState(ck.GameState.Dead),this.getHDirection()===ck.PlayerDirection.Left?(this.roleAnim.stop(),this.node.runAction(cc.sequence([cc.delayTime(.1),cc.spawn([cc.jumpBy(.8,100,-400,200,1),cc.rotateBy(.8,-180)])]))):(this.roleAnim.stop(),this.node.runAction(cc.sequence([cc.delayTime(.1),cc.spawn([cc.jumpBy(.8,-100,-400,200,1),cc.rotateBy(.8,180)])]))),this.speed.x=this.speed.y=0)},setHDirection:function(e){e===ck.PlayerDirection.Left?(this.node.scaleX=-1,this.speed.x=-Math.abs(this.speed.x)):e===ck.PlayerDirection.Right&&(this.node.scaleX=1,this.speed.x=Math.abs(this.speed.x))},getHDirection:function(){return this.speed.x<0?ck.PlayerDirection.Left:this.speed.x>0?ck.PlayerDirection.Right:null},getVDirection:function(){return this.speed.y<0?ck.PlayerDirection.Down:this.speed.y>0?ck.PlayerDirection.Up:null},canJump:function(){return!this.dead&&!this.jumping},startJump:function(){this.speed.y=this.startJumpVelocity,this.jumping=!0,this.setNeedDropDown(!0),cc.audioEngine.play(this.gameScene.jumpSound)},stopJump:function(){this.speed.y=0,this.jumping=!1},putColliderAboveWorldY:function(e){var t=this.node.parent.convertToNodeSpaceAR(new cc.Vec2(0,e)).y;t-=this.node.getComponent(cc.Collider).offset.y,t+=this.node.getComponent(cc.Collider).size.height/2,this.node.y=t},putColliderAbovePlatformWorldY:function(e){this.putColliderAboveWorldY(e),this.stopJump(),this.setNeedDropDown(!1)},getWorldPosition:function(){return this.node.convertToWorldSpaceAR(new cc.Vec2(0,0))},setNeedDropDown:function(e){this.needDropDown=e,ck.log("player.setNeedDropDown",this.needDropDown)},putColliderUnderWorldY:function(e){var t=this.node.parent.convertToNodeSpaceAR(new cc.Vec2(0,e)).y;t+=this.node.getComponent(cc.Collider).offset.y,t-=this.node.getComponent(cc.Collider).size.height/2,t-=1,this.node.y=t},update:function(e){if(this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead){this.needDropDown?this.speed.y-=e*this.pullForce:this.speed.y=0;var t=this.speed.clone().multiplyScalar(e);this.node.position=this.node.position.add(t);var n=this.gameScene.border.getLeftBottomRelativeNodeParent(this.node),a=this.gameScene.border.getRightBottomRelativeNodeParent(this.node);this.node.position.x<n.x&&(this.node.x=a.x,this.node.y+=1),this.node.position.x>a.x&&(this.node.x=n.x,this.node.y+=1)}}}),cc._RF.pop()},{}],StartScene:[function(e,t,n){"use strict";cc._RF.push(t,"36a5exAwEdBzK9/zKPSfbkQ","StartScene"),cc.Class({extends:cc.Component,properties:{buttonSound:{default:null,type:cc.AudioClip}},start:function(){},onClickStart:function(){cc.audioEngine.play(this.buttonSound),cc.director.loadScene("ChooseScene")}}),cc._RF.pop()},{}],Tanhuang:[function(e,t,n){"use strict";cc._RF.push(t,"4b946+jcQRGUrPUlGFUoT3D","Tanhuang"),cc.Class({extends:cc.Component,properties:{},start:function(){this.gameScene=ck.getGameScene()},onCollisionEnter:function(e,t){if(!this.animing&&this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.TouchDoor&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead){var n=e.node.getComponent("Player"),a=e.world.aabb,o=e.world.preAabb.clone(),i=t.world.aabb;t.world.preAabb.clone();cc.Intersection.rectRect(i,a)&&o.yMin>=i.yMax&&(n.putColliderAboveWorldY(i.yMax),n.startJump(),this.animing=!0,this.node.getComponent(cc.Animation).play(),ck.delayCall(this.node,.5,this.onAnimFinished.bind(this)))}},onAnimFinished:function(){this.animing=!1}}),cc._RF.pop()},{}],UserData:[function(e,t,n){"use strict";cc._RF.push(t,"b7e67JYN+ZCb4xbQyLNa5Jf","UserData"),cc.Class({ctor:function(){this.canPlayLevel=0,this.maxLevel=9,this.load()},load:function(){},save:function(){},setCanPlayLevel:function(e){e>this.canPlayLevel&&(this.canPlayLevel=e,this.save())},isLastLevel:function(){return this.canPlayLevel===this.maxLevel}}),cc._RF.pop()},{}],WeakWall:[function(e,t,n){"use strict";cc._RF.push(t,"0d0afYDNbROEoXni1AhYxWB","WeakWall"),cc.Class({extends:cc.Component,properties:{},start:function(){this.gameScene=ck.getGameScene()},onCollisionEnter:function(e,t){if(this.gameScene.data.state!==ck.GameState.Prepare&&this.gameScene.data.state!==ck.GameState.TouchDoor&&this.gameScene.data.state!==ck.GameState.Finished&&this.gameScene.data.state!==ck.GameState.Dead){var n=e.node.getComponent("Player"),a=e.world.aabb,o=(e.world.preAabb.clone(),t.world.aabb);t.world.preAabb.clone();cc.Intersection.rectRect(a,o)&&n.getVDirection()===ck.PlayerDirection.Down&&(ck.log("collision2"),n.putColliderAbovePlatformWorldY(o.yMax),this.resetPlayerDropDown=!0)}},onCollisionExit:function(e,t){this.resetPlayerDropDown&&(e.node.getComponent("Player").setNeedDropDown(!0),this.resetPlayerDropDown=!1)}}),cc._RF.pop()},{}],use_reversed_rotateBy:[function(e,t,n){"use strict";cc._RF.push(t,"9cb3di+eepC14NRnMY0ceVR","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}]},{},["Border","Brick","CameraFollowPlayer","ChooseButton","ChooseScene","Coin","CoinKnight","Door","Fire","GameScene","GameSceneData","Map","Player","StartScene","Tanhuang","UserData","WeakWall","use_reversed_rotateBy"]);